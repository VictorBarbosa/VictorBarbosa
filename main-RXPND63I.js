import{$ as yEe,$a as E0,A as l5,Aa as d5,Ab as ol,B as Aee,Ba as _Ee,Bb as h5,C as hEe,Ca as cC,Cb as OA,D as fR,Da as Sd,Db as Cm,E as u5,Ea as yR,Eb as to,F as go,Fa as DA,Fb as g5,G as Tee,Ga as NA,Gb as UEe,H as Ty,Ha as SEe,Hb as jEe,I as sC,Ia as EEe,Ib as MA,J as dR,Ja as AEe,Jb as Fee,K as kee,Ka as TEe,Kb as VEe,L as Yl,La as kEe,Lb as df,M as pR,Ma as IEe,Mb as WEe,N as w0,Na as DEe,Nb as oc,O as aC,Oa as rc,Ob as GEe,P as ky,Pa as NEe,Pb as Ree,Q as Iee,Qa as vR,Qb as qEe,R as gEe,Ra as Ed,Rb as HEe,S as xEe,Sa as Lt,Sb as dn,T as bEe,Ta as wR,Tb as $A,U as mR,Ua as FEe,Ub as YEe,V as c5,Va as p5,Vb as KEe,W as Iy,Wa as m5,Wb as I0,X as af,Xa as REe,Xb as XEe,Y as Ji,Ya as vn,Yb as ZEe,Z as xi,Za as OEe,Zb as Oee,_ as Fi,_a as MEe,_b as QEe,a as Ze,aa as Ct,ab as FA,b as Qi,ba as Dn,bb as RA,bc as _R,ca as vEe,cb as lf,cc as pC,d as w,da as kn,db as $Ee,e as Ee,ea as Dee,eb as PEe,ec as D0,f as rn,fa as Oe,fb as LEe,fc as PA,g as tc,ga as ut,gb as A0,gc as mC,h as zs,ha as hR,hb as uf,i as te,ia as eo,ib as T0,j as dEe,ja as Nn,jb as Nee,k as v0,ka as pa,kb as Kl,l as pEe,la as gR,lb as CR,m as kA,ma as wEe,mb as fC,n as _ee,na as lC,nb as xo,o as See,oa as C0,ob as jo,p as qn,pa as IA,pb as ma,q as os,qa as _0,qb as k0,r as Ay,ra as S0,rb as BEe,s as of,sa as xR,sb as cf,t as Nt,ta as bR,tb as zEe,u as oC,ua as nc,ub as wm,v as Eee,va as uC,vb as ic,w as mEe,wa as Pr,wb as rl,x as on,xa as Uo,xb as dC,y as cR,ya as f5,yb as ff,z as sf,za as CEe,zb as il}from"./chunk-YQ6G3ARC.js";function Xl(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}var Ry,Sm,Mte=w(()=>{"use strict";Ry=class{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}},Sm=class{refCount(t){return Xl("refCount")}incRef(t){return Xl("incRef")}timerAvailable(){return!0}time(t){return Xl("time")}read(t){return Xl("read")}readSync(t){return Xl("readSync")}readToGPU(t,n){return Xl("readToGPU")}numDataIds(){return Xl("numDataIds")}disposeData(t,n){return Xl("disposeData")}write(t,n,r){return Xl("write")}move(t,n,r,i,o){return Xl("move")}createTensorFromGPUData(t,n,r){return Xl("createTensorFromGPUData")}memory(){return Xl("memory")}floatPrecision(){return Xl("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return Xl("dispose")}}});function Q2e(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,P5(e,t,n)}function qSt(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,P5(e,n,r),P5(t,n,r)}function KA(e,t,n){return Math.max(e,Math.min(t,n))}function HSt(e){return e%2===0?e:e+1}function P5(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function YSt(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function KSt(e,t){let n=Math.random();return t*n+(1-n)*e}function XSt(e,t){let n=0;for(let r=0;r<e.length;r++){let i=Number(e[r])-Number(t[r]);n+=i*i}return n}function L(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Sr(e,t,n=""){L(ha(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function lc(e){L(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Zt(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function ZSt(e){return e.length===0}function $te(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function ha(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function F0(e){return e%1===0}function QSt(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function JSt(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function eEt(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Q2e(t),t}function vC(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function tEt(e,t=i=>0,n,r){return new Promise((i,o)=>{let s=0,a=()=>{if(e()){i();return}s++;let l=t(s);if(n!=null&&s>=n){o();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function nEt(e,t){let n=1,r=-1;for(let o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(e[o]<0)throw Error(`Shapes can not be < 0. Found ${e[o]} at dim ${o}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let i=e.slice();return i[r]=t/n,i}function zi(e,t){let n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),L(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),L(e.every(r=>F0(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function Pte(e,t){let n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||i?null:zi(t,e).sort(),s=0;for(let a=0;a<e.length;++a){if(o!=null){if(o[s]===a&&e[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${e[a]}' is not 1`);(o[s]==null||o[s]>a)&&e[a]===1&&(n.push(e[a]),r.push(a)),o[s]<=a&&s++}e[a]!==1&&(n.push(e[a]),r.push(a))}return{newShape:n,keptDims:r}}function Lte(e,t){return L5(e,t)}function L5(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function Bte(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function zte(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function rEt(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function XA(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function Ute(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function Td(e){return typeof e=="string"||e instanceof String}function J2e(e){return typeof e=="boolean"}function eAe(e){return typeof e=="number"}function Oy(e){return Array.isArray(e)?Oy(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":eAe(e)?"float32":Td(e)?"string":J2e(e)?"bool":"float32"}function Em(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ZA(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Am(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function tAe(e,t,n,r=!1){let i=new Array;if(t.length===1){let o=t[0]*(r?2:1);for(let s=0;s<o;s++)i[s]=n[e+s]}else{let o=t[0],s=t.slice(1),a=s.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<o;l++)i[l]=tAe(e+l*a,s,n,r)}return i}function yC(e,t,n=!1){if(e.length===0)return t[0];let r=e.reduce((i,o)=>i*o)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return tAe(0,e,t,n)}function iEt(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function HR(e,t){let n=QA(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function QA(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function oEt(e,t){let n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return yC(e,new Float32Array(n));if(t==="int32")return yC(e,new Int32Array(n));if(t==="bool")return yC(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function Lr(e){e.forEach(t=>{L(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function sEt(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function aEt(e,t,n){if(t===0)return[];if(t===1)return[e];let r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function wC(e){return e&&e.then&&typeof e.then=="function"}var bo=w(()=>{"use strict";});function uEt(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(cEt(t,r[0],r[1]),r.join("="))),t}function cEt(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function fEt(e,t){let n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function Z(){return B5}function rAe(e){B5=e}var nAe,JA,B5,Vo=w(()=>{"use strict";bo();nAe="tfjsflags",JA=class{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=uEt,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){let i=this.urlFlags[t];Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}getAsync(t){return te(this,null,function*(){return t in this.flags?this.flags[t]:(this.flags[t]=yield this.evaluateFlag(t),this.flags[t])})}get(t){if(t in this.flags)return this.flags[t];let n=this.evaluateFlag(t);if(wC(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let t=this.getQueryParams(this.global.location.search);nAe in t&&t[nAe].split(",").forEach(r=>{let[i,o]=r.split(":");this.urlFlags[i]=fEt(i,o)})}};B5=null});function Vte(){if(jte==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");jte=e}return jte}function dEt(){let e=Vte();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function YR(e,t){let n=dEt();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}var jte,z5=w(()=>{"use strict";});var R0,Tm,km,mf,O0,CC,_C,M0,$0,Im,Dm,Nm,Fm,Rm,P0,SC,L0,EC,B0,z0,AC,My,Wte,TC,kd,Om,Mm,kC,U0,j0,V0,IC,W0,G0,DC,NC,$m,Pm,FC,q0,RC,OC,MC,H0,$C,PC,LC,Y0,eT,tT,nT,Lm,BC,Bm,zC,zm,$y,Um,K0,jm,UC,jC,VC,Vm,Wm,X0,Z0,WC,Py,Gm,Id,GC,qC,qm,Hm,Ym,Q0,Ly,By,HC,Km,Xm,zy,Uy,jy,pEt,Gte,mEt,J0,YC,hEt,ex,Zm,tx,KC,nx,XC,ZC,rx,ix,Qm,ox,Jm,QC,eh,sx,Vy,JC,e_,t_,ax,lx,ux,cx,gEt,th,fx,dx,n_,r_,i_,o_,s_,nh,rh,px,mx,a_,hx,l_,ih,gx,oh,sh,u_,c_,f_,xx,ah,bx,lh,uh,ch,fh,dh,ph,yx,vx,wx,Cx,d_,p_,m_,h_,g_,mh,x_,Wy,b_,y_,v_,w_,hh,gh,xh,Dd,C_,__,Nd,S_,_x,Sx,xEt,Ex,bh,rT,E_,Gy,qy,Hy,q=w(()=>{"use strict";R0="Abs",Tm="Acos",km="Acosh",mf="Add",O0="AddN",CC="All",_C="Any",M0="ArgMax",$0="ArgMin",Im="Asin",Dm="Asinh",Nm="Atan",Fm="Atanh",Rm="Atan2",P0="AvgPool",SC="AvgPoolGrad",L0="AvgPool3D",EC="AvgPool3DGrad",B0="BatchMatMul",z0="BatchToSpaceND",AC="Bincount",My="BitwiseAnd",Wte="BroadcastTo",TC="BroadcastArgs",kd="Cast",Om="Ceil",Mm="ClipByValue",kC="Complex",U0="ComplexAbs",j0="Concat",V0="Conv2D",IC="Conv2DBackpropFilter",W0="Conv2DBackpropInput",G0="Conv3D",DC="Conv3DBackpropFilterV2",NC="Conv3DBackpropInputV2",$m="Cos",Pm="Cosh",FC="Cumprod",q0="Cumsum",RC="CropAndResize",OC="DenseBincount",MC="DepthToSpace",H0="DepthwiseConv2dNative",$C="DepthwiseConv2dNativeBackpropFilter",PC="DepthwiseConv2dNativeBackpropInput",LC="Diag",Y0="Dilation2D",eT="Dilation2DBackpropInput",tT="Dilation2DBackpropFilter",nT="Draw",Lm="RealDiv",BC="Einsum",Bm="Elu",zC="EluGrad",zm="Erf",$y="Equal",Um="Exp",K0="ExpandDims",jm="Expm1",UC="FFT",jC="Fill",VC="FlipLeftRight",Vm="Floor",Wm="FloorDiv",X0="FusedBatchNorm",Z0="GatherV2",WC="GatherNd",Py="Greater",Gm="GreaterEqual",Id="Identity",GC="IFFT",qC="Imag",qm="IsFinite",Hm="IsInf",Ym="IsNan",Q0="LeakyRelu",Ly="Less",By="LessEqual",HC="LinSpace",Km="Log",Xm="Log1p",zy="LogicalAnd",Uy="LogicalNot",jy="LogicalOr",pEt="LogicalXor",Gte="LogSoftmax",mEt="LowerBound",J0="LRN",YC="LRNGrad",hEt="MatrixBandPart",ex="Max",Zm="Maximum",tx="MaxPool",KC="MaxPoolGrad",nx="MaxPool3D",XC="MaxPool3DGrad",ZC="MaxPoolWithArgmax",rx="Mean",ix="Min",Qm="Minimum",ox="MirrorPad",Jm="Mod",QC="Multinomial",eh="Multiply",sx="Neg",Vy="NotEqual",JC="NonMaxSuppressionV3",e_="NonMaxSuppressionV4",t_="NonMaxSuppressionV5",ax="OnesLike",lx="OneHot",ux="Pack",cx="PadV2",gEt="Pool",th="Pow",fx="Prelu",dx="Prod",n_="RaggedGather",r_="RaggedRange",i_="RaggedTensorToTensor",o_="Range",s_="Real",nh="Reciprocal",rh="Relu",px="Reshape",mx="ResizeNearestNeighbor",a_="ResizeNearestNeighborGrad",hx="ResizeBilinear",l_="ResizeBilinearGrad",ih="Relu6",gx="Reverse",oh="Round",sh="Rsqrt",u_="ScatterNd",c_="TensorScatterUpdate",f_="SearchSorted",xx="Select",ah="Selu",bx="Slice",lh="Sin",uh="Sinh",ch="Sign",fh="Sigmoid",dh="Softplus",ph="Sqrt",yx="Sum",vx="SpaceToBatchND",wx="SplitV",Cx="Softmax",d_="SparseFillEmptyRows",p_="SparseReshape",m_="SparseSegmentMean",h_="SparseSegmentSum",g_="SparseToDense",mh="SquaredDifference",x_="Square",Wy="StaticRegexReplace",b_="StridedSlice",y_="StringNGrams",v_="StringSplit",w_="StringToHashBucketFast",hh="Sub",gh="Tan",xh="Tanh",Dd="Tile",C_="TopK",__="Transform",Nd="Transpose",S_="Unique",_x="Unpack",Sx="UnsortedSegmentSum",xEt="UpperBound",Ex="ZerosLike",bh="Step",rT="FromPixels",E_="RotateWithOffset",Gy="_FusedMatMul",qy="FusedConv2D",Hy="FusedDepthwiseConv2D"});function yh(...e){Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(...e)}function bEt(...e){Z().getBool("IS_TEST")||Z().getBool("PROD")||console.log(...e)}var U5=w(()=>{"use strict";Vo();});function A_(e,t){let n=Hte(e,t);return iT.get(n)}function j5(e){return KR.get(e)}function XR(e){let t=iT.entries(),n=[];for(;;){let{done:r,value:i}=t.next();if(r)break;let[o,s]=i,[a]=o.split("_");a===e&&n.push(s)}return n}function oT(e){let{kernelName:t,backendName:n}=e,r=Hte(t,n);iT.has(r)&&yh(`The kernel '${t}' for backend '${n}' is already registered`),iT.set(r,e)}function qte(e){let{kernelName:t}=e;KR.has(t)&&Z().getBool("DEBUG")&&yh(`Overriding the gradient for '${t}'`),KR.set(t,e)}function yEt(e,t){let n=Hte(e,t);if(!iT.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);iT.delete(n)}function vEt(e){if(!KR.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);KR.delete(e)}function wEt(e,t){XR(e).forEach(r=>{let i=Object.assign({},r,{backendName:t});oT(i)})}function Hte(e,t){return`${t}_${e}`}var iT,KR,ZR=w(()=>{"use strict";Vo();z5();U5();iT=YR("kernelRegistry",()=>new Map),KR=YR("gradRegistry",()=>new Map)});function V5(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var Yte=w(()=>{"use strict";});var hAe=Ee((VOn,mAe)=>{"use strict";mAe.exports=Zr;var hf=null;try{hf=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Zr(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}Zr.prototype.__isLong__;Object.defineProperty(Zr.prototype,"__isLong__",{value:!0});function Ql(e){return(e&&e.__isLong__)===!0}Zr.isLong=Ql;var oAe={},sAe={};function k_(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=sAe[e],r)?r:(n=Qr(e,(e|0)<0?-1:0,!0),i&&(sAe[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(r=oAe[e],r)?r:(n=Qr(e,e<0?-1:0,!1),i&&(oAe[e]=n),n))}Zr.fromInt=k_;function gf(e,t){if(isNaN(e))return t?T_:xf;if(t){if(e<0)return T_;if(e>=cAe)return pAe}else{if(e<=-lAe)return Zl;if(e+1>=lAe)return dAe}return e<0?gf(-e,t).neg():Qr(e%aT|0,e/aT|0,t)}Zr.fromNumber=gf;function Qr(e,t,n){return new Zr(e,t,n)}Zr.fromBits=Qr;var W5=Math.pow;function Xte(e,t,n){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return xf;if(typeof t=="number"?(n=t,t=!1):t=!!t,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Xte(e.substring(1),t,n).neg();for(var i=gf(W5(n,8)),o=xf,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),n);if(a<8){var u=gf(W5(n,a));o=o.mul(u).add(gf(l))}else o=o.mul(i),o=o.add(gf(l))}return o.unsigned=t,o}Zr.fromString=Xte;function Fd(e,t){return typeof e=="number"?gf(e,t):typeof e=="string"?Xte(e,t):Qr(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}Zr.fromValue=Fd;var aAe=65536,CEt=1<<24,aT=aAe*aAe,cAe=aT*aT,lAe=cAe/2,uAe=k_(CEt),xf=k_(0);Zr.ZERO=xf;var T_=k_(0,!0);Zr.UZERO=T_;var sT=k_(1);Zr.ONE=sT;var fAe=k_(1,!0);Zr.UONE=fAe;var Kte=k_(-1);Zr.NEG_ONE=Kte;var dAe=Qr(-1,2147483647,!1);Zr.MAX_VALUE=dAe;var pAe=Qr(-1,-1,!0);Zr.MAX_UNSIGNED_VALUE=pAe;var Zl=Qr(0,-2147483648,!1);Zr.MIN_VALUE=Zl;var je=Zr.prototype;je.toInt=function(){return this.unsigned?this.low>>>0:this.low};je.toNumber=function(){return this.unsigned?(this.high>>>0)*aT+(this.low>>>0):this.high*aT+(this.low>>>0)};je.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Zl)){var n=gf(t),r=this.div(n),i=r.mul(n).sub(this);return r.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var o=gf(W5(t,6),this.unsigned),s=this,a="";;){var l=s.div(o),u=s.sub(l.mul(o)).toInt()>>>0,c=u.toString(t);if(s=l,s.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};je.getHighBits=function(){return this.high};je.getHighBitsUnsigned=function(){return this.high>>>0};je.getLowBits=function(){return this.low};je.getLowBitsUnsigned=function(){return this.low>>>0};je.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Zl)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,n=31;n>0&&!(t&1<<n);n--);return this.high!=0?n+33:n+1};je.isZero=function(){return this.high===0&&this.low===0};je.eqz=je.isZero;je.isNegative=function(){return!this.unsigned&&this.high<0};je.isPositive=function(){return this.unsigned||this.high>=0};je.isOdd=function(){return(this.low&1)===1};je.isEven=function(){return(this.low&1)===0};je.equals=function(t){return Ql(t)||(t=Fd(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};je.eq=je.equals;je.notEquals=function(t){return!this.eq(t)};je.neq=je.notEquals;je.ne=je.notEquals;je.lessThan=function(t){return this.comp(t)<0};je.lt=je.lessThan;je.lessThanOrEqual=function(t){return this.comp(t)<=0};je.lte=je.lessThanOrEqual;je.le=je.lessThanOrEqual;je.greaterThan=function(t){return this.comp(t)>0};je.gt=je.greaterThan;je.greaterThanOrEqual=function(t){return this.comp(t)>=0};je.gte=je.greaterThanOrEqual;je.ge=je.greaterThanOrEqual;je.compare=function(t){if(Ql(t)||(t=Fd(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};je.comp=je.compare;je.negate=function(){return!this.unsigned&&this.eq(Zl)?Zl:this.not().add(sT)};je.neg=je.negate;je.add=function(t){Ql(t)||(t=Fd(t));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,s=t.high>>>16,a=t.high&65535,l=t.low>>>16,u=t.low&65535,c=0,f=0,d=0,p=0;return p+=o+u,d+=p>>>16,p&=65535,d+=i+l,f+=d>>>16,d&=65535,f+=r+a,c+=f>>>16,f&=65535,c+=n+s,c&=65535,Qr(d<<16|p,c<<16|f,this.unsigned)};je.subtract=function(t){return Ql(t)||(t=Fd(t)),this.add(t.neg())};je.sub=je.subtract;je.multiply=function(t){if(this.isZero())return xf;if(Ql(t)||(t=Fd(t)),hf){var n=hf.mul(this.low,this.high,t.low,t.high);return Qr(n,hf.get_high(),this.unsigned)}if(t.isZero())return xf;if(this.eq(Zl))return t.isOdd()?Zl:xf;if(t.eq(Zl))return this.isOdd()?Zl:xf;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(uAe)&&t.lt(uAe))return gf(this.toNumber()*t.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,o=this.low>>>16,s=this.low&65535,a=t.high>>>16,l=t.high&65535,u=t.low>>>16,c=t.low&65535,f=0,d=0,p=0,m=0;return m+=s*c,p+=m>>>16,m&=65535,p+=o*c,d+=p>>>16,p&=65535,p+=s*u,d+=p>>>16,p&=65535,d+=i*c,f+=d>>>16,d&=65535,d+=o*u,f+=d>>>16,d&=65535,d+=s*l,f+=d>>>16,d&=65535,f+=r*c+i*u+o*l+s*a,f&=65535,Qr(p<<16|m,f<<16|d,this.unsigned)};je.mul=je.multiply;je.divide=function(t){if(Ql(t)||(t=Fd(t)),t.isZero())throw Error("division by zero");if(hf){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var n=(this.unsigned?hf.div_u:hf.div_s)(this.low,this.high,t.low,t.high);return Qr(n,hf.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?T_:xf;var r,i,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return T_;if(t.gt(this.shru(1)))return fAe;o=T_}else{if(this.eq(Zl)){if(t.eq(sT)||t.eq(Kte))return Zl;if(t.eq(Zl))return sT;var s=this.shr(1);return r=s.div(t).shl(1),r.eq(xf)?t.isNegative()?sT:Kte:(i=this.sub(t.mul(r)),o=r.add(i.div(t)),o)}else if(t.eq(Zl))return this.unsigned?T_:xf;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=xf}for(i=this;i.gte(t);){r=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:W5(2,a-48),u=gf(r),c=u.mul(t);c.isNegative()||c.gt(i);)r-=l,u=gf(r,this.unsigned),c=u.mul(t);u.isZero()&&(u=sT),o=o.add(u),i=i.sub(c)}return o};je.div=je.divide;je.modulo=function(t){if(Ql(t)||(t=Fd(t)),hf){var n=(this.unsigned?hf.rem_u:hf.rem_s)(this.low,this.high,t.low,t.high);return Qr(n,hf.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};je.mod=je.modulo;je.rem=je.modulo;je.not=function(){return Qr(~this.low,~this.high,this.unsigned)};je.and=function(t){return Ql(t)||(t=Fd(t)),Qr(this.low&t.low,this.high&t.high,this.unsigned)};je.or=function(t){return Ql(t)||(t=Fd(t)),Qr(this.low|t.low,this.high|t.high,this.unsigned)};je.xor=function(t){return Ql(t)||(t=Fd(t)),Qr(this.low^t.low,this.high^t.high,this.unsigned)};je.shiftLeft=function(t){return Ql(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Qr(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Qr(0,this.low<<t-32,this.unsigned)};je.shl=je.shiftLeft;je.shiftRight=function(t){return Ql(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?Qr(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Qr(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};je.shr=je.shiftRight;je.shiftRightUnsigned=function(t){if(Ql(t)&&(t=t.toInt()),t&=63,t===0)return this;var n=this.high;if(t<32){var r=this.low;return Qr(r>>>t|n<<32-t,n>>>t,this.unsigned)}else return t===32?Qr(n,0,this.unsigned):Qr(n>>>t-32,0,this.unsigned)};je.shru=je.shiftRightUnsigned;je.shr_u=je.shiftRightUnsigned;je.toSigned=function(){return this.unsigned?Qr(this.low,this.high,!1):this};je.toUnsigned=function(){return this.unsigned?this:Qr(this.low,this.high,!0)};je.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};je.toBytesLE=function(){var t=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};je.toBytesBE=function(){var t=this.high,n=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Zr.fromBytes=function(t,n,r){return r?Zr.fromBytesLE(t,n):Zr.fromBytesBE(t,n)};Zr.fromBytesLE=function(t,n){return new Zr(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,n)};Zr.fromBytesBE=function(t,n){return new Zr(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],n)}});function QR(e){return D_.fromString(e,!0,16)}function Zte(e){return e.xor(e.shru(47))}function bAe(e,t,n){let r=e.slice(t,t+n);return D_.fromBytes(Array.from(r),!0,!0)}function Br(e,t){return bAe(e,t,8)}function gAe(e,t){return bAe(e,t,4)}function Wo(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Yy(e,t,n=QR("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function _Et(e,t,n,r,i,o){i=i.add(e),o=Wo(o.add(i).add(r),21);let s=i;return i=i.add(t),i=i.add(n),o=o.add(Wo(i,44)),[i.add(r),o.add(s)]}function G5(e,t,n,r){return _Et(Br(e,t),Br(e,t+8),Br(e,t+16),Br(e,t+24),n,r)}function SEt(e,t=e.length){if(t>=8){let n=ga.add(t*2),r=Br(e,0).add(ga),i=Br(e,t-8),o=Wo(i,37).mul(n).add(r),s=Wo(r,25).add(i).mul(n);return Yy(o,s,n)}if(t>=4){let n=ga.add(t*2),r=gAe(e,0);return Yy(r.shl(3).add(t),gAe(e,t-4),n)}if(t>0){let n=e[0],r=e[t>>1],i=e[t-1],o=n+(r<<8),s=t+(i<<2);return Zte(ga.mul(o).xor(xAe.mul(s))).mul(ga)}return ga}function EEt(e,t=e.length){let n=ga.add(t*2),r=Br(e,0).mul(I_),i=Br(e,8),o=Br(e,t-8).mul(n),s=Br(e,t-16).mul(ga);return Yy(Wo(r.add(i),43).add(Wo(o,30)).add(s),r.add(Wo(i.add(ga),18)).add(o),n)}function AEt(e,t=e.length){let n=ga.add(t*2),r=Br(e,0).mul(ga),i=Br(e,8),o=Br(e,t-8).mul(n),s=Br(e,t-16).mul(ga),a=Wo(r.add(i),43).add(Wo(o,30)).add(s),l=Yy(a,r.add(Wo(i.add(ga),18)).add(o),n),u=Br(e,16).mul(n),c=Br(e,24),f=a.add(Br(e,t-32)).mul(n),d=l.add(Br(e,t-24)).mul(n);return Yy(Wo(u.add(c),43).add(Wo(f,30)).add(d),u.add(Wo(c.add(r),18)).add(f),n)}function TEt(e,t=e.length){let n=D_.fromNumber(81,!0);if(t<=32)return t<=16?SEt(e,t):EEt(e,t);if(t<=64)return AEt(e,t);let r=n,i=n.mul(I_).add(113),o=Zte(i.mul(ga).add(113)).mul(ga),s=[D_.UZERO,D_.UZERO],a=[D_.UZERO,D_.UZERO];r=r.mul(ga).add(Br(e,0));let l=0,u=(t-1>>6)*64,c=u+(t-1&63)-63;do r=Wo(r.add(i).add(s[0]).add(Br(e,l+8)),37).mul(I_),i=Wo(i.add(s[1]).add(Br(e,l+48)),42).mul(I_),r=r.xor(a[1]),i=i.add(s[0]).add(Br(e,l+40)),o=Wo(o.add(a[0]),33).mul(I_),s=G5(e,l,s[1].mul(I_),r.add(a[0])),a=G5(e,l+32,o.add(a[1]),i.add(Br(e,l+16))),[o,r]=[r,o],l+=64;while(l!==u);let f=I_.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(t-1&63),s[0]=s[0].add(a[0]),a[0]=a[0].add(s[0]),r=Wo(r.add(i).add(s[0]).add(Br(e,l+8)),37).mul(f),i=Wo(i.add(s[1]).add(Br(e,l+48)),42).mul(f),r=r.xor(a[1].mul(9)),i=i.add(s[0].mul(9).add(Br(e,l+40))),o=Wo(o.add(a[0]),33).mul(f),s=G5(e,l,s[1].mul(f),r.add(a[0])),a=G5(e,l+32,o.add(a[1]),i.add(Br(e,l+16))),[o,r]=[r,o],Yy(Yy(s[0],a[0],f).add(Zte(i).mul(xAe)).add(o),Yy(s[1],a[1],f).add(r),f)}var Qte,D_,xAe,I_,ga,yAe=w(()=>{"use strict";Qte=tc(hAe());D_=Qte.default||Qte;xAe=QR("c3a5c85c97cb3127"),I_=QR("b492b66fbe98f273"),ga=QR("9ae16a3b2f90404f")});var A={};rn(A,{arraysEqual:()=>ha,arraysEqualWithNull:()=>$te,assert:()=>L,assertNonNegativeIntegerDimensions:()=>Lr,assertNonNull:()=>lc,assertShapesMatch:()=>Sr,bytesFromStringArray:()=>Ute,bytesPerElement:()=>XA,checkConversionForErrors:()=>Bte,clamp:()=>KA,computeStrides:()=>Am,convertBackendValuesAndArrayBuffer:()=>iEt,createScalarValue:()=>kEt,createShuffledIndices:()=>eEt,decodeString:()=>uT,distSquared:()=>XSt,encodeString:()=>Ky,fetch:()=>DEt,fingerPrint64:()=>TEt,flatten:()=>Rd,getArrayFromDType:()=>L5,getTypedArrayFromDType:()=>Lte,hasEncodingLoss:()=>rEt,hexToLong:()=>QR,indexToLoc:()=>aEt,inferDtype:()=>Oy,inferFromImplicitShape:()=>nEt,isBoolean:()=>J2e,isFunction:()=>Em,isInt:()=>F0,isNumber:()=>eAe,isPromise:()=>wC,isScalarShape:()=>ZSt,isString:()=>Td,isTypedArray:()=>bi,isValidDtype:()=>zte,locToIndex:()=>sEt,makeOnesTypedArray:()=>HR,makeZerosNestedTypedArray:()=>oEt,makeZerosTypedArray:()=>QA,nearestDivisor:()=>ZA,nearestLargerEven:()=>HSt,now:()=>N_,parseAxisParam:()=>zi,randUniform:()=>KSt,repeatedTry:()=>tEt,rightPad:()=>vC,shuffle:()=>Q2e,shuffleCombo:()=>qSt,sizeFromShape:()=>Zt,sizeToSquarishShape:()=>JSt,squeezeShape:()=>Pte,sum:()=>YSt,swap:()=>P5,tanh:()=>QSt,toNestedArray:()=>yC,toTypedArray:()=>lT});function kEt(e,t){return t==="string"?Ky(e):lT([e],t)}function IEt(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function lT(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Rd(e)),Z().getBool("DEBUG")&&Bte(e,t),IEt(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){let n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function N_(){return Z().platform.now()}function DEt(e,t){return Z().platform.fetch(e,t)}function Ky(e,t="utf-8"){return t=t||"utf-8",Z().platform.encode(e,t)}function uT(e,t="utf-8"){return t=t||"utf-8",Z().platform.decode(e,t)}function bi(e){return Z().platform.isTypedArray!=null?Z().platform.isTypedArray(e):V5(e)}function Rd(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||wC(e)||e==null||bi(e)&&n)t.push(e);else if(Array.isArray(e)||bi(e))for(let r=0;r<e.length;++r)Rd(e[r],t,n);else{let r=-1;for(let i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Rd(e[i],t,n)}return t}var ae=w(()=>{"use strict";Vo();Yte();bo();bo();yAe();});function NEt(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){let i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}var q5,Jte,vAe=w(()=>{"use strict";Vo();ae();q5=class{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Jte)}profileKernel(t,n,r){let i,o=()=>{i=r()},s,a=N_();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(o);else{o();for(let u of i)u.dataSync();s=Promise.resolve({kernelMs:N_()-a})}if(Z().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<i.length;u++){let c=i[u];c.data().then(f=>{NEt(f,c.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:s.then(u=>u.kernelMs),extraInfo:s.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(t){let{kernelName:n,outputs:r,timeMs:i,inputs:o,extraInfo:s}=t;r.forEach(a=>{Promise.all([a.data(),i,s]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}};Jte=class{logKernelProfile(t,n,r,i,o,s){let a=typeof i=="number"?vC(`${i}ms`,9):i.error,l=vC(t,25),u=n.rank,c=n.size,f=vC(n.shape.toString(),14),d="";for(let p in o){let m=o[p];if(m!=null){let h=m.shape||n.shape,g=h.length;d+=`${p}: ${g}D ${g>0?h:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${f}	%c${c}	%c${d}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}});function wAe(e,t,n){let r={},i={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){let u=e[l],c=u.inputs;for(let f in c){let d=c[f],p=!1;for(let m=0;m<t.length;m++)if(r[d.id]){u.outputs.forEach(h=>r[h.id]=!0),p=!0,i[u.id]=!0;break}if(p)break}}let o={};o[n.id]=!0;let s={};for(let l=e.length-1;l>=0;l--){let u=e[l],c=u.inputs;for(let f=0;f<u.outputs.length;f++)if(o[u.outputs[f].id]){for(let d in c)o[c[d].id]=!0,s[u.id]=!0;break}}let a=[];for(let l=0;l<e.length;l++){let u=e[l];if(i[u.id]&&s[u.id]){let c={};for(let d in u.inputs){let p=u.inputs[d];r[p.id]&&(c[d]=p)}let f=Object.assign({},u);f.inputs=c,f.outputs=u.outputs,a.push(f)}}return a}function CAe(e,t,n,r){for(let i=t.length-1;i>=0;i--){let o=t[i],s=[];if(o.outputs.forEach(l=>{let u=e[l.id];u!=null?s.push(u):s.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);let a=o.gradient(s);for(let l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);let u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);let c=o.inputs[l];if(!ha(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=u;else{let f=e[c.id];e[c.id]=r(f,u),f.dispose()}}}}var _Ae=w(()=>{"use strict";ae();});function EAe(e,t,n,r){let i=Am(t),o=FEt(e,t,n,i),s=t.length,a=H5(e,t,n,i,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function FEt(e,t,n,r){let i=Zt(t),o=r[r.length-1],s=new Array(o).fill(0),a=t.length,l=n==="complex64"?tO(e):e;if(a>1)for(let u=0;u<i/o;u++){let c=u*o;for(let f=0;f<o;f++)s[f]=Math.max(s[f],eO(l[c+f],0,n).length)}return s}function eO(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(ene))} + ${parseFloat(e[1].toFixed(ene))}j`:Td(e)?r=`'${e}'`:n==="bool"?r=AAe(e):r=parseFloat(e.toFixed(ene)).toString(),vC(r,t)}function AAe(e){return e===0?"false":"true"}function H5(e,t,n,r,i,o=!0){let s=n==="complex64"?2:1,a=t[0],l=t.length;if(l===0){if(n==="complex64"){let h=tO(e);return[eO(h[0],0,n)]}return n==="bool"?[AAe(e[0])]:[e[0].toString()]}if(l===1){if(a>SAe){let g=JR*s,x=Array.from(e.slice(0,g)),b=Array.from(e.slice((a-JR)*s,a*s));return n==="complex64"&&(x=tO(x),b=tO(b)),["["+x.map((y,v)=>eO(y,i[v],n)).join(", ")+", ..., "+b.map((y,v)=>eO(y,i[a-JR+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?tO(e):Array.from(e)).map((g,x)=>eO(g,i[x],n)).join(", ")+"]"]}let u=t.slice(1),c=r.slice(1),f=r[0]*s,d=[];if(a>SAe){for(let h=0;h<JR;h++){let g=h*f,x=g+f;d.push(...H5(e.slice(g,x),u,n,c,i,!1))}d.push("...");for(let h=a-JR;h<a;h++){let g=h*f,x=g+f;d.push(...H5(e.slice(g,x),u,n,c,i,h===a-1))}}else for(let h=0;h<a;h++){let g=h*f,x=g+f;d.push(...H5(e.slice(g,x),u,n,c,i,h===a-1))}let p=l===2?",":"";d[0]="["+(a>0?d[0]+p:"");for(let h=1;h<d.length-1;h++)d[h]=" "+d[h]+p;let m=`,
`;for(let h=2;h<l;h++)m+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":m),d}function tO(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var SAe,JR,ene,TAe=w(()=>{"use strict";ae();SAe=20,JR=3,ene=7});function kAe(e){Od=e}function IAe(e){cT=e}function DAe(e){REt=e}function G(){return YR("Tensor",()=>Kt)}var gn,Od,cT,REt,Kt,vh,le=w(()=>{"use strict";z5();TAe();ae();ae();gn=class{constructor(t,n,r){if(this.dtype=n,this.shape=t.slice(),this.size=Zt(t),r!=null){let i=r.length;L(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||L5(n,this.size),this.strides=Am(t)}set(t,...n){n.length===0&&(n=[0]),L(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);let r=this.locToIndex(n);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(let i of t){if(i<0||i>=this.shape[n]){let o=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];let n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return Od().makeTensor(this.values,this.shape,this.dtype)}},Od=null,cT=null,REt=null;Kt=class{constructor(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Zt(t),this.strides=Am(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return te(this,null,function*(){let t=yield this.data();return cT.buffer(this.shape,this.dtype,t)})}bufferSync(){return cT.buffer(this.shape,this.dtype,this.dataSync())}array(){return te(this,null,function*(){let t=yield this.data();return yC(this.shape,t,this.dtype==="complex64")})}arraySync(){return yC(this.shape,this.dataSync(),this.dtype==="complex64")}data(){return te(this,null,function*(){this.throwIfDisposed();let t=Od().read(this.dataId);if(this.dtype==="string"){let n=yield t;try{return n.map(r=>uT(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t})}dataToGPU(t){return this.throwIfDisposed(),Od().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();let t=Od().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>uT(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){return te(this,null,function*(){this.throwIfDisposed();let t=yield Od().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)})}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Od().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return cT.print(this,t)}clone(){return this.throwIfDisposed(),cT.clone(this)}toString(t=!1){let n=this.dataSync();return EAe(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),cT.cast(this,t)}variable(t=!0,n,r){return this.throwIfDisposed(),Od().makeVariable(this,t,n,r)}};Object.defineProperty(Kt,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});G();vh=class extends Kt{constructor(t,n,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!ha(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Od().disposeTensor(this),this.dataId=t.dataId,Od().incRef(this,null)}dispose(){Od().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(vh,Symbol.hasInstance,{value:e=>e instanceof Kt&&e.assign!=null&&e.assign instanceof Function})});function yi(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return OEt[e][t]}function Xy(e){return yi(e,"int32")}function Y5(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function K5(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}var tne,NAe,FAe,RAe,OAe,OEt,fT=w(()=>{"use strict";tne=function(e){return e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6",e}(tne||{}),NAe=function(e){return e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64",e}(NAe||{}),FAe=function(e){return e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64",e}(FAe||{}),RAe=function(e){return e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64",e}(RAe||{}),OAe=function(e){return e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64",e}(OAe||{}),OEt={float32:RAe,int32:NAe,bool:FAe,complex64:OAe}});var X5={};rn(X5,{assertTypesMatch:()=>nne,getTensorsInContainer:()=>nO,isTensorInList:()=>MEt,makeTypesMatch:()=>Qt});function Qt(e,t){if(e.dtype===t.dtype)return[e,t];let n=yi(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function nne(e,t){L(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function MEt(e,t){return t.some(n=>n.id===e.id)}function nO(e){let t=[];return MAe(e,t,new Set),t}function MAe(e,t,n){if(e==null)return;if(e instanceof Kt){t.push(e);return}if(!$Et(e))return;let r=e;for(let i in r){let o=r[i];n.has(o)||(n.add(o),MAe(o,t,n))}}function $Et(e){return Array.isArray(e)||typeof e=="object"}var zr=w(()=>{"use strict";le();fT();ae();});function rne(e){return e.kernelName!=null}function LEt(e){let t=HR(Zt(e),"float32");return $.makeTensor(t,e,"float32")}function ine(){let e=Vte();if(e._tfengine==null){let t=new JA(e);e._tfengine=new PEt(t)}return rAe(e._tfengine.ENV),kAe(()=>e._tfengine),e._tfengine}function BEt(e,t){let n={a:e,b:t};return $.runKernel(mf,n)}var Z5,PEt,$,ne=w(()=>{"use strict";Mte();Vo();z5();q();ZR();U5();vAe();_Ae();le();zr();ae();ae();Z5=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(let t in this.registeredVariables)this.registeredVariables[t].dispose()}},PEt=(()=>{class e{constructor(n){this.ENV=n,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Z5}ready(){return te(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let n=this.getSortedBackends();for(let r=0;r<n.length;r++){let i=n[r];if(yield this.initializeBackend(i).success){yield this.setBackend(i);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:n,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${n}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(n)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(n){if(!(n in this.registry))if(n in this.registryFactory){let{asyncInit:r}=this.initializeBackend(n);if(r)return null}else return null;return this.registry[n]}findBackendFactory(n){return n in this.registryFactory?this.registryFactory[n].factory:null}registerBackend(n,r,i=1){return n in this.registryFactory?(yh(`${n} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[n]={factory:r,priority:i},!0)}setBackend(n){return te(this,null,function*(){if(this.registryFactory[n]==null)throw new Error(`Backend name '${n}' not found in registry`);if(this.backendName=n,this.registry[n]==null){this.backendInstance=null;let{success:r,asyncInit:i}=this.initializeBackend(n);if(!(i?yield r:r))return!1}return this.backendInstance=this.registry[n],this.setupRegisteredKernels(),this.profiler=new q5(this.backendInstance),!0})}setupRegisteredKernels(){XR(this.backendName).forEach(r=>{r.setupFunc!=null&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(n){XR(n).forEach(i=>{i.disposeFunc!=null&&i.disposeFunc(this.registry[n])})}initializeBackend(n){let r=this.registryFactory[n];if(r==null)throw new Error(`Cannot initialize backend ${n}, no registration found.`);try{let i=r.factory();if(i&&!(i instanceof Sm)&&typeof i.then=="function"){let o=++this.pendingBackendInitId,s=i.then(a=>o<this.pendingBackendInitId?!1:(this.registry[n]=a,this.pendingBackendInit=null,!0)).catch(a=>(o<this.pendingBackendInitId||(this.pendingBackendInit=null,yh(`Initialization of backend ${n} failed`),yh(a.stack||a.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[n]=i,{success:!0,asyncInit:!1}}catch(i){return yh(`Initialization of backend ${n} failed`),yh(i.stack||i.message),{success:!1,asyncInit:!1}}}removeBackend(n){if(!(n in this.registryFactory))throw new Error(`${n} backend not found in registry`);this.backendName===n&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,n in this.registry&&(this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n]),delete this.registryFactory[n],this.backendName===n&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((n,r)=>this.registryFactory[r].priority-this.registryFactory[n].priority)}initializeBackendsAndReturnBest(){let n=this.getSortedBackends();for(let r=0;r<n.length;r++){let i=n[r],{success:o,asyncInit:s}=this.initializeBackend(i);if(s||o)return{name:i,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(n,r){let i=this.state.tensorInfo.get(r),o=i.backend,s=this.readSync(r),a=o.refCount(r);o.disposeData(r,!0),i.backend=n,n.move(r,s,i.shape,i.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(n,r){let i=null;if(r==null){if(typeof n!="function")throw new Error("Please provide a function to tidy()");r=n}else{if(typeof n!="string"&&!(n instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=n}let o;return this.scopedRun(()=>this.startScope(i),()=>this.endScope(o),()=>(o=r(),o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o))}scopedRun(n,r,i){n();try{let o=i();return r(),o}catch(o){throw r(),o}}nextTensorId(){return e.nextTensorId++}nextVariableId(){return e.nextVariableId++}clone(n){let r=$.runKernel(Id,{x:n}),i={x:n},o=a=>({x:()=>{let l="float32",u={x:a},c={dtype:l};return $.runKernel(kd,u,c)}}),s=[];return this.addTapeNode(this.state.activeScope.name,i,[r],o,s,{}),r}runKernel(n,r,i){if(this.backendName==null&&this.backend,!(A_(n,this.backendName)!=null))throw new Error(`Kernel '${n}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:n,inputs:r,attrs:i})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(n,r,i){let o=this.backend.numDataIds(),s=0;i.forEach(u=>{s+=u.dtype==="complex64"?3:1});let a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=o-r-s-a;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${n}'`)}runKernelFunc(n){let r,i=[],o=this.isTapeOn(),s=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let u,c=rne(n)?n.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(rne(n)){let{kernelName:h,inputs:g,attrs:x}=n;this.backendName==null&&this.backend;let b=A_(h,this.backendName);L(b!=null,()=>`Cannot find registered kernel '${h}' for backend '${this.backendName}'`),l=()=>{let y=this.backend.numDataIds();u=b.kernelFunc({inputs:g,attrs:x,backend:this.backend});let v=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,y,v);let C=v.map(_=>_.rank!=null?_:this.makeTensorFromTensorInfo(_));if(o){let _=this.getTensorsForGradient(h,g,C);i=this.saveTensorsForBackwardMode(_)}return C}}else{let{forwardFunc:h}=n,g=x=>{o&&(i=x.map(b=>this.keep(this.clone(b))))};l=()=>{let x=this.backend.numDataIds();u=this.tidy(()=>h(this.backend,g));let b=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,x,b),b}}let{inputs:f,attrs:d}=n,p=rne(n)?null:n.backwardsFunc,m;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?r=l():(m=this.profiler.profileKernel(c,f,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),r=m.outputs)}),o&&this.addTapeNode(c,f,r,p,i,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(f).map(h=>f[h]!=null?f[h].shape:null),outputShapes:r.map(h=>h.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(u)?r:r[0]}saveTensorsForBackwardMode(n){return n.map(i=>this.keep(this.clone(i)))}getTensorsForGradient(n,r,i){let o=j5(n);if(o!=null){let s=o.inputsToSave||[],a=o.outputsToSave||[],l;o.saveAllInputs?(L(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(r).map(c=>r[c])):l=s.map(c=>r[c]);let u=i.filter((c,f)=>a[f]);return l.concat(u)}return[]}makeTensor(n,r,i,o){if(n==null)throw new Error("Values passed to engine.makeTensor() are null");i=i||"float32",o=o||this.backend;let s=n;i==="string"&&Td(n[0])&&(s=n.map(u=>Ky(u)));let a=o.write(s,r,i),l=new Kt(r,i,a,this.nextTensorId());if(this.trackTensor(l,o),i==="string"){let u=this.state.tensorInfo.get(a),c=Ute(s);this.state.numBytes+=c-u.bytes,u.bytes=c}return l}makeTensorFromDataId(n,r,i,o){i=i||"float32";let s={dataId:n,shape:r,dtype:i};return this.makeTensorFromTensorInfo(s,o)}makeTensorFromTensorInfo(n,r){let{dataId:i,shape:o,dtype:s}=n,a=new Kt(o,s,i,this.nextTensorId());return this.trackTensor(a,r),a}makeVariable(n,r=!0,i,o){i=i||this.nextVariableId().toString(),o!=null&&o!==n.dtype&&(n=n.cast(o));let s=new vh(n,r,i,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(n,r){this.state.numTensors++,n.dtype==="string"&&this.state.numStringTensors++;let i=0;n.dtype!=="complex64"&&n.dtype!=="string"&&(i=n.size*XA(n.dtype)),this.state.numBytes+=i,this.state.tensorInfo.has(n.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(n.dataId,{backend:r||this.backend,dtype:n.dtype,shape:n.shape,bytes:i})),n instanceof vh||this.track(n)}incRef(n,r){this.trackTensor(n,r),this.backend.incRef(n.dataId)}removeDataId(n,r){this.state.tensorInfo.has(n)&&this.state.tensorInfo.get(n).backend===r&&(this.state.tensorInfo.delete(n),this.state.numDataBuffers--)}disposeTensor(n){if(!this.state.tensorInfo.has(n.dataId))return;let r=this.state.tensorInfo.get(n.dataId);if(this.state.numTensors--,n.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),n.dtype!=="complex64"&&n.dtype!=="string"){let i=n.size*XA(n.dtype);this.state.numBytes-=i}r.backend.disposeData(n.dataId)&&this.removeDataId(n.dataId,r.backend)}disposeVariables(){for(let n in this.state.registeredVariables){let r=this.state.registeredVariables[n];this.disposeVariable(r)}}disposeVariable(n){this.disposeTensor(n),this.state.registeredVariables[n.name]!=null&&delete this.state.registeredVariables[n.name]}memory(){let n=this.backend.memory();return n.numTensors=this.state.numTensors,n.numDataBuffers=this.state.numDataBuffers,n.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(n.unreliable=!0,n.reasons==null&&(n.reasons=[]),n.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),n}profile(n){return te(this,null,function*(){this.state.profiling=!0;let r=this.state.numBytes,i=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield n(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-i;for(let o of this.state.activeProfile.kernels)o.kernelTimeMs=yield o.kernelTimeMs,o.extraInfo=yield o.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(n,r,i,o,s,a){let l={id:this.state.nextTapeNodeId++,kernelName:n,inputs:r,outputs:i,saved:s},u=j5(n);u!=null&&(o=u.gradFunc),o!=null&&(l.gradient=c=>(c=c.map((f,d)=>{if(f==null){let p=i[d],m=QA(p.size,p.dtype);return this.makeTensor(m,p.shape,p.dtype)}return f}),o(c.length>1?c:c[0],s,a))),this.state.activeTape.push(l)}keep(n){return n.kept=!0,n}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(n){let r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};n&&(r.name=n),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(n){let r=nO(n),i=new Set(r.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){let a=this.state.activeScope.track[s];!a.kept&&!i.has(a.id)&&a.dispose()}let o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(s=>{!s.kept&&s.scopeId===o.id&&this.track(s)})}gradients(n,r,i,o=!1){if(L(r.length>0,()=>"gradients() received an empty list of xs."),i!=null&&i.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${i.dtype}'`);let s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",n));L(s instanceof Kt,()=>"The result y returned by f() must be a tensor.");let a=wAe(this.state.activeTape,r,s);if(!o&&a.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let l={};l[s.id]=i??LEt(s.shape),CAe(l,a,c=>this.tidy(c),BEt);let u=r.map(c=>l[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(let f of c.saved)f.dispose()}),this.state.activeTape=null),{value:s,grads:u}})}customGrad(n){return L(Em(n),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{L(r.every(l=>l instanceof Kt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let i,o={};r.forEach((l,u)=>{o[u]=l});let s=(l,u)=>(i=n(...r,u),L(i.value instanceof Kt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),L(Em(i.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),i.value),a=(l,u)=>{let c=i.gradFunc(l,u),f=Array.isArray(c)?c:[c];L(f.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),L(f.every(p=>p instanceof Kt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let d={};return f.forEach((p,m)=>{d[m]=()=>p}),d};return this.runKernelFunc({forwardFunc:s,backwardsFunc:a,inputs:o})}}readSync(n){return this.state.tensorInfo.get(n).backend.readSync(n)}read(n){return this.state.tensorInfo.get(n).backend.read(n)}readToGPU(n,r){return this.state.tensorInfo.get(n).backend.readToGPU(n,r)}time(n){return te(this,null,function*(){let r=N_(),i=yield this.backend.time(n);return i.wallMs=N_()-r,i})}track(n){return this.state.activeScope!=null&&(n.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(n)),n}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Z5;for(let n in this.registry)this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return e.nextTensorId=0,e.nextVariableId=0,e})();$=ine()});var Ax={};rn(Ax,{isBrowser:()=>sne,isMobile:()=>jEt,mockIsMobile:()=>UEt});function zEt(){return typeof navigator<"u"&&navigator!=null}function UEt(e){one=e}function jEt(e){if(one!==void 0)return one;if(e||zEt()){if(e||(e=navigator),e.product==="ReactNative")return!0;let t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){let n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function sne(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var one,ane=w(()=>{"use strict";});var sl,dT=w(()=>{"use strict";ne();ane();Vo();sl=Z();sl.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});sl.registerFlag("IS_BROWSER",()=>sne());sl.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");sl.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));sl.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));sl.registerFlag("PROD",()=>!1);sl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>sl.getBool("DEBUG"));sl.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);sl.registerFlag("IS_TEST",()=>!1);sl.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>sl.getBool("DEBUG"));sl.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);sl.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);sl.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1)});function ss(e,t){let n=e;if(bi(e))return t==="string"?[]:[e.length];if(Y5(e)){let i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(K5(e))return[e.buffer.size/(t==null?4:XA(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||bi(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Z().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&PAe(e,r,[]),r}function PAe(e,t,n){if(n=n||[],!Array.isArray(e)&&!bi(e)){L(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}L(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),L(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);let r=t.slice(1);for(let i=0;i<e.length;++i)PAe(e[i],r,n.concat(i))}function $Ae(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function D(e,t,n,r="numeric"){if(e instanceof G())return $Ae(r,e.dtype,t,n),e;let i=Oy(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),$Ae(r,i,t,n),e==null||!bi(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){let l=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}let o=ss(e,i);!bi(e)&&!Array.isArray(e)&&(e=[e]);let a=i!=="string"?lT(e,i):Rd(e,[],!0);return $.makeTensor(a,o,i)}function Tx(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((o,s)=>D(o,`${t}[${s}]`,n,r))}var J=w(()=>{"use strict";ne();Vo();le();fT();ae();bo();});function R(e){let t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+lne;let i=(...o)=>{$.startScope(n);try{let s=r(...o);return wC(s)&&console.error("Cannot return a Promise inside of tidy."),$.endScope(s),s}catch(s){throw $.endScope(null),s}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}var lne,X=w(()=>{"use strict";ne();ae();lne="__op"});function VEt(e,t){let n=D(e,"real","complex"),r=D(t,"imag","complex");Sr(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);let i={real:n,imag:r};return $.runKernel(kC,i)}var al,Zy=w(()=>{"use strict";ne();q();J();ae();X();al=R({complex_:VEt})});function xa(e,t,n,r){if(r==null)r=Oy(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(K5(e)||Y5(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return $.backend.createTensorFromGPUData(e,t||n,r)}if(!bi(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Lr(t);let i=Zt(t),o=Zt(n);L(i===o,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${o}`);for(let s=0;s<n.length;++s){let a=n[s],l=s===n.length-1?a!==Zt(t.slice(s)):!0;L(n[s]===t[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!bi(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?lT(e,r):Rd(e,[],!0),$.makeTensor(e,t,r)}var kx=w(()=>{"use strict";ne();fT();ae();});function as(e,t,n){let r=ss(e,n);return xa(e,t,r,n)}var rO=w(()=>{"use strict";J();kx();});var Ix,une=w(()=>{"use strict";Ix={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}});function WEt(e,t){let n=0,r=e.length;for(;n<=r;){let i=Math.floor((r-n)/2)+n,o=t(e[i]);if(o===0)return i;o<0?r=i:n=i+1}return-1}var ls,Qy=w(()=>{"use strict";ae();ls=class e{static join(t){return new e(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>bi(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){let i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let o=n+i.byteLength;this.shards.push({buffer:i,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);let r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);let i=n-t,o=new ArrayBuffer(i),s=new Uint8Array(o),a=0;for(let l=r;l<this.shards.length;l++){let u=this.shards[l],f=t+a-u.start,d=a,m=Math.min(n,u.end)-u.start,h=new Uint8Array(u.buffer,f,m-f);if(s.set(h,d),a+=h.length,n<u.end)break}return o}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let r=WEt(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}});function GEt(){Z().set("PROD",!0)}function qEt(){Z().set("DEBUG",!0)}function HEt(){Z().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function LAe(e){Z().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function YEt(){$.disposeVariables()}function uc(){return $}function pT(){return $.memory()}function KEt(e){return $.profile(e)}function ee(e,t){return $.tidy(e,t)}function _t(e){nO(e).forEach(n=>n.dispose())}function ro(e){return $.keep(e)}function XEt(e){return $.time(e)}function BAe(e){return $.setBackend(e)}function ZEt(){return $.ready()}function cne(){return $.backendName}function QEt(e){$.removeBackend(e)}function JEt(e){return $.findBackend(e)}function e2t(e){return $.findBackendFactory(e)}function iO(e,t,n=1){return $.registerBackend(e,t,n)}function oO(){return $.backend}function t2t(e,t){Z().setPlatform(e,t)}var Jl=w(()=>{"use strict";ne();Vo();le();zr();DAe(LAe)});function jAe(e,t){return te(this,null,function*(){let n=[],r=[],i=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);for(let s=0;s<i.length;++s){let a=i[s],l=Array.isArray(e)?e[s].tensor:e[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);let u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let c=new Promise(f=>te(this,null,function*(){let d=yield l.bytes(),p=d.reduce((g,x)=>g+x.length,0)+Jy*d.length,m=new Uint8Array(p),h=0;for(let g=0;g<d.length;g++){let x=d[g],b=new Uint8Array(new Uint32Array([x.length]).buffer);m.set(b,h),h+=Jy,m.set(x,h),h+=x.length}f(m)}));r.push(c)}else r.push(l.data());t!=null&&(u.group=t),n.push(u)}let o=yield Promise.all(r);return{data:i2t(o),specs:n}})}function Q5(e,t){let n=new ls(e),r={},i=0;for(let o of t){let s=n2t(o,(a,l)=>n.slice(i+a,i+l));r[o.name]=VAe(o,n.slice(i,i+s)),i+=s}return r}function n2t(e,t){let n=Zt(e.shape),r;if("quantization"in e){let i=e.quantization;r=Ix[i.dtype]}else if(e.dtype==="string"){let i=0;for(let o=0;o<n;o++)i+=Jy+new Uint32Array(t(i,i+Jy))[0];return i}else r=Ix[e.dtype];return n*r}function r2t(e,t){return te(this,null,function*(){let n=Zt(e.shape),r;if("quantization"in e){let i=e.quantization;r=Ix[i.dtype]}else if(e.dtype==="string"){let i=0;for(let o=0;o<n;o++)i+=Jy+new Uint32Array(yield t(i,i+Jy))[0];return i}else r=Ix[e.dtype];return n*r})}function VAe(e,t){let n=e.name,r=e.dtype,i=e.shape,o=Zt(i),s,a=0;if("quantization"in e){let l=e.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${e.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${e.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let u=Ix[l.dtype],c=l.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){s=new Float32Array(c.length);for(let f=0;f<c.length;f++){let d=c[f];s[f]=d*l.scale+l.min}}else if(l.dtype==="float16")s=l2t()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);s=new Int32Array(c.length);for(let f=0;f<c.length;f++){let d=c[f];s[f]=Math.round(d*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*u}else if(r==="string"){let l=Zt(e.shape);s=[];for(let u=0;u<l;u++){let c=new Uint32Array(t.slice(a,a+Jy))[0];a+=Jy;let f=new Uint8Array(t.slice(a,a+c));s.push(f),a+=c}}else{let l=Ix[r];if(r==="float32")s=new Float32Array(t);else if(r==="int32")s=new Int32Array(t);else if(r==="bool")s=new Uint8Array(t);else if(r==="complex64"){s=new Float32Array(t);let u=new Float32Array(s.length/2),c=new Float32Array(s.length/2);for(let m=0;m<u.length;m++)u[m]=s[m*2],c[m]=s[m*2+1];let f=as(u,i,"float32"),d=as(c,i,"float32"),p=al(f,d);return f.dispose(),d.dispose(),p}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*l}return as(s,i,r)}function zAe(e,t,n){return te(this,null,function*(){let r=new Uint8Array(t);for(;r.byteLength<n;){let{done:i,value:o}=yield e.read();if(i&&o==null){let a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}let s=new Uint8Array(r.length+o.byteLength);s.set(r,0),s.set(new Uint8Array(o),r.length),r=s}return r.buffer})}function fne(e,t){return te(this,null,function*(){let n={},r=e.getReader(),i=new ArrayBuffer(0);for(let o of t){let s=yield r2t(o,(u,c)=>te(this,null,function*(){return i=yield zAe(r,i,c),i.slice(u,c)}));i=yield zAe(r,i,s);let a=i.slice(0,s);i=i.slice(s);let l=VAe(o,a);if(n[o.name]=l,cne()==="webgpu"){let u=oO();"uploadToGPU"in u&&Zt(l.shape)>=Z().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n})}function i2t(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(o=>{if(t+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});let r=new Uint8Array(t),i=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),i),i+=o.byteLength}),r.buffer}function UAe(e){return dne?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function WAe(e){if(dne)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function GAe(e){if(dne){let r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function qAe(e){return ls.join(e)}function pne(e){let t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);let n=e.split(t);return n[n.length-1]}function J5(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function mne(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}function mT(e,t){return te(this,null,function*(){let n,r;return e.weightsManifest!=null&&([n,r]=yield t(e.weightsManifest)),mne(e,n,r)})}function wh(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:UAe(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:UAe(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new ls(e.weightData).byteLength}}function sO(e){let t=[];for(let n of e)t.push(...n.weights);return t}function o2t(){let e=n=>{let r=n<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function s2t(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function a2t(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function l2t(){let e=o2t(),t=s2t(),n=a2t();return r=>{let i=new ArrayBuffer(4*r.length),o=new Uint32Array(i);for(let s=0;s<r.length;s++){let a=r[s],l=e[n[a>>10]+(a&1023)]+t[a>>10];o[s]=l}return new Float32Array(i)}}var Jy,dne,ev=w(()=>{"use strict";Zy();rO();ae();une();Qy();Jl();Vo();Jl();Jy=4;dne=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u")});var yo,HAe,YAe,KAe,XAe,F_=w(()=>{"use strict";yo=class e{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return e.instance==null&&(e.instance=new e),e.instance}static registerSaveRouter(t){e.getInstance().saveRouters.push(t)}static registerLoadRouter(t){e.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return e.getHandlers(t,"save")}static getLoadHandlers(t,n){return e.getHandlers(t,"load",n)}static getHandlers(t,n,r){let i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(s=>{let a=s(t,r);a!==null&&i.push(a)}),i}},HAe=e=>yo.registerSaveRouter(e),YAe=e=>yo.registerLoadRouter(e),KAe=e=>yo.getSaveHandlers(e),XAe=(e,t)=>yo.getLoadHandlers(e,t)});function ZAe(){if(!Z().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function xne(e){let t=e.result;t.createObjectStore(R_,{keyPath:"modelPath"}),t.createObjectStore(tv,{keyPath:"modelPath"})}function u2t(e){return new O_(e)}function c2t(e){return e.startsWith(O_.URL_SCHEME)?e.slice(O_.URL_SCHEME.length):e}var hne,gne,R_,tv,O_,QAe,e6,bne=w(()=>{"use strict";dT();Vo();ev();F_();Qy();hne="tensorflowjs",gne=1,R_="models_store",tv="model_info_store";O_=(()=>{class e{constructor(n){if(this.indexedDB=ZAe(),n==null||!n)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=n}save(n){return te(this,null,function*(){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,n)})}load(){return te(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(n,r){return new Promise((i,o)=>{let s=this.indexedDB.open(hne,gne);s.onupgradeneeded=()=>xne(s),s.onsuccess=()=>{let a=s.result;if(r==null){let l=a.transaction(R_,"readonly"),c=l.objectStore(R_).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),o(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));i(c.result.modelArtifacts)},c.onerror=f=>(a.close(),o(c.error)),l.oncomplete=()=>a.close()}else{r.weightData=ls.join(r.weightData);let l=wh(r),u=a.transaction(tv,"readwrite"),c=u.objectStore(tv),f;try{f=c.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(p){return o(p)}let d;f.onsuccess=()=>{d=a.transaction(R_,"readwrite");let p=d.objectStore(R_),m;try{m=p.put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:l})}catch(h){return o(h)}m.onsuccess=()=>i({modelArtifactsInfo:l}),m.onerror=h=>{c=u.objectStore(tv);let g=c.delete(this.modelPath);g.onsuccess=()=>(a.close(),o(m.error)),g.onerror=x=>(a.close(),o(m.error))}},f.onerror=p=>(a.close(),o(f.error)),u.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},s.onerror=a=>o(s.error)})}}return e.URL_SCHEME="indexeddb://",e})(),QAe=e=>Z().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(O_.URL_SCHEME)?u2t(e.slice(O_.URL_SCHEME.length)):null;yo.registerSaveRouter(QAe);yo.registerLoadRouter(QAe);e6=class{constructor(){this.indexedDB=ZAe()}listModels(){return te(this,null,function*(){return new Promise((t,n)=>{let r=this.indexedDB.open(hne,gne);r.onupgradeneeded=()=>xne(r),r.onsuccess=()=>{let i=r.result,o=i.transaction(tv,"readonly"),a=o.objectStore(tv).getAll();a.onsuccess=()=>{let l={};for(let u of a.result)l[u.modelPath]=u.modelArtifactsInfo;t(l)},a.onerror=l=>(i.close(),n(a.error)),o.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})})}removeModel(t){return te(this,null,function*(){return t=c2t(t),new Promise((n,r)=>{let i=this.indexedDB.open(hne,gne);i.onupgradeneeded=()=>xne(i),i.onsuccess=()=>{let o=i.result,s=o.transaction(tv,"readwrite"),a=s.objectStore(tv),l=a.get(t),u;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{let c=a.delete(t),f=()=>{u=o.transaction(R_,"readwrite");let p=u.objectStore(R_).delete(t);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=m=>r(l.error)};c.onsuccess=f,c.onerror=d=>(f(),o.close(),r(l.error))}},l.onerror=c=>(o.close(),r(l.error)),s.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},i.onerror=o=>r(i.error)})})}}});function eTe(e){return{info:[hT,e,JAe].join(Dx),topology:[hT,e,f2t].join(Dx),weightSpecs:[hT,e,d2t].join(Dx),weightData:[hT,e,p2t].join(Dx),modelMetadata:[hT,e,m2t].join(Dx)}}function tTe(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function h2t(e){let t=e.split(Dx);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Dx)}function g2t(e){return e.startsWith(M_.URL_SCHEME)?e.slice(M_.URL_SCHEME.length):e}function x2t(e){return new M_(e)}var Dx,hT,JAe,f2t,d2t,p2t,m2t,M_,nTe,t6,yne=w(()=>{"use strict";dT();Vo();ae();ev();Qy();F_();Dx="/",hT="tensorflowjs_models",JAe="info",f2t="model_topology",d2t="weight_specs",p2t="weight_data",m2t="model_metadata";M_=(()=>{class e{constructor(n){if(!Z().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,n==null||!n)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=n,this.keys=eTe(this.modelPath)}save(n){return te(this,null,function*(){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let r=JSON.stringify(n.modelTopology),i=JSON.stringify(n.weightSpecs),o=wh(n),s=ls.join(n.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,i),this.LS.setItem(this.keys.weightData,WAe(s));let a={format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,signature:n.signature!=null?n.signature:void 0,userDefinedMetadata:n.userDefinedMetadata!=null?n.userDefinedMetadata:void 0,modelInitializer:n.modelInitializer!=null?n.modelInitializer:void 0,initializerSignature:n.initializerSignature!=null?n.initializerSignature:void 0,trainingConfig:n.trainingConfig!=null?n.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:o}}catch{throw tTe(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}})}load(){return te(this,null,function*(){let n=JSON.parse(this.LS.getItem(this.keys.info));if(n==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(n.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let r={},i=JSON.parse(this.LS.getItem(this.keys.topology));if(i==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);r.modelTopology=i;let o=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(o==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);r.weightSpecs=o;let s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){let l=JSON.parse(s);r.format=l.format,r.generatedBy=l.generatedBy,r.convertedBy=l.convertedBy,l.signature!=null&&(r.signature=l.signature),l.userDefinedMetadata!=null&&(r.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(r.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(r.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(r.trainingConfig=l.trainingConfig)}let a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return r.weightData=GAe(a),r})}}return e.URL_SCHEME="localstorage://",e})(),nTe=e=>Z().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(M_.URL_SCHEME)?x2t(e.slice(M_.URL_SCHEME.length)):null;yo.registerSaveRouter(nTe);yo.registerLoadRouter(nTe);t6=class{constructor(){L(Z().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),L(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return te(this,null,function*(){let t={},n=hT+Dx,r=Dx+JAe;for(let i=0;i<this.LS.length;++i){let o=this.LS.key(i);if(o.startsWith(n)&&o.endsWith(r)){let s=h2t(o);t[s]=JSON.parse(this.LS.getItem(o))}}return t})}removeModel(t){return te(this,null,function*(){t=g2t(t);let n=eTe(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);let r=JSON.parse(this.LS.getItem(n.info));return tTe(n),r})}}});function n6(e){if(e.indexOf(gT)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Md.getSchemes().join(",")}`);return{scheme:e.split(gT)[0],path:e.split(gT)[1]}}function rTe(e,t,n=!1){return te(this,null,function*(){L(e!==t,()=>`Old path and new path are the same: '${e}'`);let r=yo.getLoadHandlers(e);L(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),L(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);let i=r[0],o=yo.getSaveHandlers(t);L(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),L(o.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let s=o[0],a=n6(e).scheme,l=n6(e).path,u=a===n6(e).scheme,c=yield i.load();n&&u&&(yield Md.getManager(a).removeModel(l));let f=yield s.save(c);return n&&!u&&(yield Md.getManager(a).removeModel(l)),f.modelArtifactsInfo})}function iTe(){return te(this,null,function*(){let e=Md.getSchemes(),t={};for(let n of e){let r=yield Md.getManager(n).listModels();for(let i in r){let o=n+gT+i;t[o]=r[i]}}return t})}function oTe(e){return te(this,null,function*(){let t=n6(e);return Md.getManager(t.scheme).removeModel(t.path)})}function sTe(e,t){return te(this,null,function*(){return rTe(e,t,!1)})}function aTe(e,t){return te(this,null,function*(){return rTe(e,t,!0)})}var gT,Md,vne=w(()=>{"use strict";ae();F_();gT="://",Md=class e{constructor(){this.managers={}}static getInstance(){return e.instance==null&&(e.instance=new e),e.instance}static registerManager(t,n){L(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(gT)&&(t=t.slice(0,t.indexOf(gT))),L(t.length>0,()=>"scheme must not be an empty string.");let r=e.getInstance();L(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){let n=e.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(e.getInstance().managers)}}});var wne,lTe=w(()=>{"use strict";dT();Vo();bne();yne();vne();Yte();wne=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!Z().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();let i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return V5(t)}};if(Z().get("IS_BROWSER")){Z().setPlatform("browser",new wne);try{Md.registerManager(M_.URL_SCHEME,new t6)}catch{}try{Md.registerManager(O_.URL_SCHEME,new e6)}catch{}}});var cTe=Ee((xT,uTe)=>{"use strict";var b2t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},$_=b2t();uTe.exports=xT=$_.fetch;$_.fetch&&(xT.default=$_.fetch.bind($_));xT.Headers=$_.Headers;xT.Request=$_.Request;xT.Response=$_.Response});var fTe=Ee(()=>{"use strict"});var y2t,Cne,_ne,dTe=w(()=>{"use strict";Vo();y2t={importFetch:()=>cTe()},_ne=class{constructor(){this.util=fTe(),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return Z().global.fetch!=null?Z().global.fetch(t,n):(Cne==null&&(Cne=y2t.importFetch()),Cne(t,n))}now(){let t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}};Z().get("IS_NODE")&&!Z().get("IS_BROWSER")&&Z().setPlatform("node",new _ne)});function et(e,t="float32",n){return t=t||"float32",Lr(e),new gn(e,t,n)}var Nx=w(()=>{"use strict";le();ae();});function v2t(e,t){let n=D(e,"x","cast");if(!zte(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:n},i={dtype:t};return $.runKernel(kd,r,i)}var de,sn=w(()=>{"use strict";ne();q();J();ae();X();de=R({cast_:v2t})});function w2t(e){let n={x:D(e,"x","clone","string_or_numeric")};return $.runKernel(Id,n)}var ll,bT=w(()=>{"use strict";ne();q();J();X();ll=R({clone_:w2t})});function r6(e,t=!1){console.log(e.toString(t))}var Sne=w(()=>{"use strict";});var C2t,pTe=w(()=>{"use strict";ne();dT();lTe();dTe();Nx();sn();bT();Sne();le();ine();C2t={buffer:et,cast:de,clone:ll,print:r6};IAe(C2t)});function _2t(e,t){let n=D(e,"a","add"),r=D(t,"b","add");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(mf,i)}var se,Er=w(()=>{"use strict";ne();q();zr();J();X();se=R({add_:_2t})});function S2t(e,t){let n=D(e,"a","floorDiv"),r=D(t,"b","floorDiv");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(Wm,i)}var yT,i6=w(()=>{"use strict";ne();q();zr();J();X();yT=R({floorDiv_:S2t})});function E2t(e,t){let n=D(e,"a","div"),r=D(t,"b","div");if([n,r]=Qt(n,r),n.dtype==="int32"&&r.dtype==="int32")return yT(n,r);let i={a:n,b:r},o={};return $.runKernel(Lm,i,o)}var Fe,Ln=w(()=>{"use strict";ne();q();zr();J();i6();X();Fe=R({div_:E2t})});function A2t(e,t){let n=D(e,"a","mul"),r=D(t,"b","mul");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(eh,i)}var j,ft=w(()=>{"use strict";ne();q();zr();J();X();j=R({mul_:A2t})});function T2t(e){let t=D(e,"x","abs");if(t.dtype==="complex64"){let n={x:t};return $.runKernel(U0,n)}else{let n={x:t};return $.runKernel(R0,n)}}var mr,P_=w(()=>{"use strict";ne();q();J();X();mr=R({abs_:T2t})});function k2t(e){let n={x:D(e,"x","acos")};return $.runKernel(Tm,n)}var o6,mTe=w(()=>{"use strict";ne();q();J();X();o6=R({acos_:k2t})});function I2t(e){let n={x:D(e,"x","acosh")};return $.runKernel(km,n)}var s6,hTe=w(()=>{"use strict";ne();q();J();X();s6=R({acosh_:I2t})});function D2t(e){L(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),L(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);let t=e.map((i,o)=>D(i,`tensors${o}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!ha(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let r=t;return $.runKernel(O0,r)}var gTe,xTe=w(()=>{"use strict";ne();q();J();ae();X();gTe=R({addN_:D2t})});function N2t(e,t=null,n=!1){let i={x:D(e,"x","all","bool")},o={axis:t,keepDims:n};return $.runKernel(CC,i,o)}var vT,Ene=w(()=>{"use strict";ne();q();J();X();vT=R({all_:N2t})});function F2t(e,t=null,n=!1){let i={x:D(e,"x","any","bool")},o={axis:t,keepDims:n};return $.runKernel(_C,i,o)}var L_,Ane=w(()=>{"use strict";ne();q();J();X();L_=R({any_:F2t})});function R2t(e,t=0){let r={x:D(e,"x","argMax")},i={axis:t};return $.runKernel(M0,r,i)}var Ch,Tne=w(()=>{"use strict";ne();q();J();X();Ch=R({argMax_:R2t})});function O2t(e,t=0){let r={x:D(e,"x","argMin")},i={axis:t};return $.runKernel($0,r,i)}var a6,kne=w(()=>{"use strict";ne();q();J();X();a6=R({argMin_:O2t})});function M2t(e){let n={x:D(e,"x","asin")};return $.runKernel(Im,n)}var l6,bTe=w(()=>{"use strict";ne();q();J();X();l6=R({asin_:M2t})});function $2t(e){let n={x:D(e,"x","asinh")};return $.runKernel(Dm,n)}var u6,yTe=w(()=>{"use strict";ne();q();J();X();u6=R({asinh_:$2t})});function P2t(e){let n={x:D(e,"x","atan")};return $.runKernel(Nm,n)}var c6,vTe=w(()=>{"use strict";ne();q();J();X();c6=R({atan_:P2t})});function L2t(e,t){let n=D(e,"a","atan2"),r=D(t,"b","atan2");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(Rm,i)}var f6,Ine=w(()=>{"use strict";ne();q();zr();J();X();f6=R({atan2_:L2t})});function B2t(e){let n={x:D(e,"x","atanh")};return $.runKernel(Fm,n)}var d6,wTe=w(()=>{"use strict";ne();q();J();X();d6=R({atanh_:B2t})});function z2t(e,t,n,r,i="NHWC",o){let s=e[3],a=[...t,s],l=_Te(i);return B_(e,a,n,o,r,null,null,l)}function Nne(e,t,n,r,i,o,s="channelsLast"){let[a,l]=aO(t),u;if(s==="channelsLast")u=[a,l,e[3],e[3]];else if(s==="channelsFirst")u=[a,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return B_(e,u,n,r,i,o,!1,s)}function U2t(e,t,n,r,i,o,s="NDHWC"){let[a,l,u]=Dne(t),c,f;if(s==="NDHWC")f="channelsLast",c=[a,l,u,e[4],e[4]];else if(s==="NCDHW")f="channelsFirst",c=[a,l,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return CTe(e,c,n,r,i,!1,f,o)}function B_(e,t,n,r,i,o,s=!1,a="channelsLast"){let[l,u,c,f]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,f]=e;else if(a==="channelsFirst")[l,f,u,c]=e;else throw new Error(`Unknown dataFormat ${a}`);let[d,p,,m]=t,[h,g]=aO(n),[x,b]=aO(r),y=wT(d,x),v=wT(p,b),{padInfo:C,outHeight:_,outWidth:S}=W2t(i,u,c,h,g,y,v,o,a),E=s?m*f:m,T;return a==="channelsFirst"?T=[l,E,_,S]:a==="channelsLast"&&(T=[l,_,S,E]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:f,outHeight:_,outWidth:S,outChannels:E,padInfo:C,strideHeight:h,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:y,effectiveFilterWidth:v,dilationHeight:x,dilationWidth:b,inShape:e,outShape:T,filterShape:t}}function CTe(e,t,n,r,i,o=!1,s="channelsLast",a){let[l,u,c,f,d]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,u,c,f,d]=e;else if(s==="channelsFirst")[l,d,u,c,f]=e;else throw new Error(`Unknown dataFormat ${s}`);let[p,m,h,,g]=t,[x,b,y]=Dne(n),[v,C,_]=Dne(r),S=wT(p,v),E=wT(m,C),T=wT(h,_),{padInfo:I,outDepth:k,outHeight:O,outWidth:F}=G2t(i,u,c,f,x,b,y,S,E,T,a),B=o?g*d:g,M;return s==="channelsFirst"?M=[l,B,k,O,F]:s==="channelsLast"&&(M=[l,k,O,F,B]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:f,inChannels:d,outDepth:k,outHeight:O,outWidth:F,outChannels:B,padInfo:I,strideDepth:x,strideHeight:b,strideWidth:y,filterDepth:p,filterHeight:m,filterWidth:h,effectiveFilterDepth:S,effectiveFilterHeight:E,effectiveFilterWidth:T,dilationDepth:v,dilationHeight:C,dilationWidth:_,inShape:e,outShape:M,filterShape:t}}function j2t(e,t,n,r,i){r==null&&(r=Fne(e,t,n));let o=e[0],s=e[1],a=lO((o-t+2*r)/n+1,i),l=lO((s-t+2*r)/n+1,i);return[a,l]}function V2t(e,t,n,r,i,o){i==null&&(i=Fne(e,t[0],r[0]));let s=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*i>=t[a]&&(s[a]=lO((e[a]-t[a]+2*i)/r[a]+1,o));return s}function Fne(e,t,n,r=1){let i=wT(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function aO(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Dne(e){return typeof e=="number"?[e,e,e]:e}function wT(e,t){return t<=1?e:e+(e-1)*(t-1)}function W2t(e,t,n,r,i,o,s,a,l){let u,c,f;if(typeof e=="number"){u={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};let p=j2t([t,n],o,r,e,a);c=p[0],f=p[1]}else if(e==="same"){c=Math.ceil(t/r),f=Math.ceil(n/i);let d=Math.max(0,(c-1)*r+o-t),p=Math.max(0,(f-1)*i+s-n),m=Math.floor(d/2),h=d-m,g=Math.floor(p/2),x=p-g;u={top:m,bottom:h,left:g,right:x,type:"SAME"}}else if(e==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-o+1)/r),f=Math.ceil((n-s+1)/i);else if(typeof e=="object"){let d=l==="channelsLast"?e[1][0]:e[2][0],p=l==="channelsLast"?e[1][1]:e[2][1],m=l==="channelsLast"?e[2][0]:e[3][0],h=l==="channelsLast"?e[2][1]:e[3][1];u={top:d,bottom:p,left:m,right:h,type:d===0&&p===0&&m===0&&h===0?"VALID":"EXPLICIT"},c=lO((t-o+d+p)/r+1,a),f=lO((n-s+m+h)/i+1,a)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:u,outHeight:c,outWidth:f}}function G2t(e,t,n,r,i,o,s,a,l,u,c){let f,d,p,m;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};let g=V2t([t,n,r,1],[a,l,u],1,[i,o,s],e,c);d=g[0],p=g[1],m=g[2]}else if(e==="same"){d=Math.ceil(t/i),p=Math.ceil(n/o),m=Math.ceil(r/s);let h=(d-1)*i+a-t,g=(p-1)*o+l-n,x=(m-1)*s+u-r,b=Math.floor(h/2),y=h-b,v=Math.floor(g/2),C=g-v,_=Math.floor(x/2),S=x-_;f={top:v,bottom:C,left:_,right:S,front:b,back:y,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:d,outHeight:p,outWidth:m}}function lO(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function cc(e){let[t,n,r]=aO(e);return t===1&&n===1&&r===1}function Go(e,t){return cc(e)||cc(t)}function _h(e){return aO(e).every(t=>t>0)}function _Te(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function ir(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")L(F0(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{L(F0(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}var io=w(()=>{"use strict";ae();});function q2t(e,t){let r={x:D(e,"x","reshape","string_or_numeric")},i={shape:t};return $.runKernel(px,r,i)}var V,qe=w(()=>{"use strict";ne();q();J();X();V=R({reshape_:q2t})});function H2t(e,t,n,r,i){let o=D(e,"x","avgPool","float32"),s=1;L(Go(n,s),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),ir("avgPool",r,i);let u={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},f=$.runKernel(P0,u,c);return f=de(f,o.dtype),l?V(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var nv,p6=w(()=>{"use strict";ne();q();J();ae();sn();io();X();qe();nv=R({avgPool_:H2t})});function Y2t(e,t,n,r,i,o="NDHWC"){let s=D(e,"x","avgPool3d","float32"),a=s,l=!1;s.rank===4&&(l=!0,a=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),L(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),L(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),L(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),ir("avgPool3d",r,i);let u={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:o},f=$.runKernel(L0,u,c);return f=de(f,a.dtype),l?V(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var m6,STe=w(()=>{"use strict";ne();q();J();ae();sn();io();X();qe();m6=R({avgPool3d_:Y2t})});function K2t(e,t=0){L(e.length>=1,()=>"Pass at least one tensor to concat");let n=Tx(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return ll(n[0]);let r=n,i={axis:t};return $.runKernel(j0,r,i)}var En,dc=w(()=>{"use strict";ne();q();J();ae();bT();X();En=R({concat_:K2t})});function X2t(e,t,n=!1,r=!1){let i=D(e,"a","matMul"),o=D(t,"b","matMul");[i,o]=Qt(i,o);let s={a:i,b:o},a={transposeA:n,transposeB:r};return $.runKernel(B0,s,a)}var Bt,$d=w(()=>{"use strict";ne();q();zr();J();X();Bt=R({matMul_:X2t})});function Z2t(e){let n={x:D(e,"x","sigmoid","float32")};return $.runKernel(fh,n)}var js,CT=w(()=>{"use strict";ne();q();J();X();js=R({sigmoid_:Z2t})});function Q2t(e,t,n){let r=D(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let i={x:r},o={begin:t,size:n};return $.runKernel(bx,i,o)}var Mt,ul=w(()=>{"use strict";ne();q();J();X();Mt=R({slice_:Q2t})});function J2t(e){let n={x:D(e,"x","tanh","float32")};return $.runKernel(xh,n)}var Pd,Rne=w(()=>{"use strict";ne();q();J();X();Pd=R({tanh_:J2t})});function eAt(e,t,n,r,i,o){let s=D(e,"forgetBias","basicLSTMCell"),a=D(t,"lstmKernel","basicLSTMCell"),l=D(n,"lstmBias","basicLSTMCell"),u=D(r,"data","basicLSTMCell"),c=D(i,"c","basicLSTMCell"),f=D(o,"h","basicLSTMCell"),d=En([u,f],1),p=Bt(d,a),m=se(p,l),h=m.shape[0],g=m.shape[1]/4,x=[h,g],b=Mt(m,[0,0],x),y=Mt(m,[0,g],x),v=Mt(m,[0,g*2],x),C=Mt(m,[0,g*3],x),_=se(j(js(b),Pd(y)),j(c,js(se(s,v)))),S=j(Pd(_),js(C));return[_,S]}var ETe,ATe=w(()=>{"use strict";J();Er();dc();$d();ft();X();CT();ul();Rne();ETe=R({basicLSTMCell_:eAt})});function tAt(e,t,n){let r=D(e,"x","batchToSpaceND"),i=t.reduce((a,l)=>a*l);L(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),L(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),L(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);let o={x:r},s={blockShape:t,crops:n};return $.runKernel(z0,o,s)}var rv,uO=w(()=>{"use strict";ne();q();J();ae();X();rv=R({batchToSpaceND_:tAt})});function TTe(e){let t;return e.rank===0||e.rank===1?t=V(e,[1,1,1,e.size]):e.rank===2?t=V(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}var kTe=w(()=>{"use strict";qe()});function nAt(e,t,n,r,i,o){o==null&&(o=.001);let s=D(e,"x","batchNorm"),a=D(t,"mean","batchNorm"),l=D(n,"variance","batchNorm"),u;i!=null&&(u=D(i,"scale","batchNorm"));let c;r!=null&&(c=D(r,"offset","batchNorm")),L(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:TTe(s),scale:u,offset:c,mean:a,variance:l},p={varianceEpsilon:o},m=$.runKernel(X0,d,p);return V(m,s.shape)}var Sh,_T=w(()=>{"use strict";ne();q();J();ae();kTe();X();qe();Sh=R({batchNorm_:nAt})});function rAt(e,t,n,r,i,o){let s=D(e,"x","batchNorm"),a=D(t,"mean","batchNorm"),l=D(n,"variance","batchNorm"),u;i!=null&&(u=D(i,"scale","batchNorm"));let c;return r!=null&&(c=D(r,"offset","batchNorm")),L(s.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`),L(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),L(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&L(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&L(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Sh(s,a,l,c,u,o)}var h6,ITe=w(()=>{"use strict";J();ae();_T();X();h6=R({batchNorm2d_:rAt})});function iAt(e,t,n,r,i,o){let s=D(e,"x","batchNorm"),a=D(t,"mean","batchNorm"),l=D(n,"variance","batchNorm"),u;i!=null&&(u=D(i,"scale","batchNorm"));let c;return r!=null&&(c=D(r,"offset","batchNorm")),L(s.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`),L(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),L(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&L(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&L(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Sh(s,a,l,c,u,o)}var g6,DTe=w(()=>{"use strict";J();ae();_T();X();g6=R({batchNorm3d_:iAt})});function oAt(e,t,n,r,i,o){let s=D(e,"x","batchNorm"),a=D(t,"mean","batchNorm"),l=D(n,"variance","batchNorm"),u;i!=null&&(u=D(i,"scale","batchNorm"));let c;return r!=null&&(c=D(r,"offset","batchNorm")),L(s.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`),L(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),L(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&L(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&L(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Sh(s,a,l,c,u,o)}var x6,NTe=w(()=>{"use strict";J();ae();_T();X();x6=R({batchNorm4d_:oAt})});function sAt(e,t,n){let r=D(e,"x","bincount"),i=D(t,"weights","bincount");L(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),L(n>=0,()=>`size must be non-negative, but got ${n}.`),L(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);let o={x:r,weights:i},s={size:n};return $.runKernel(AC,o,s)}var b6,One=w(()=>{"use strict";ne();q();J();ae();X();b6=R({bincount_:sAt})});function aAt(e,t){let n=D(e,"x","bitwiseAnd"),r=D(t,"y","bitwiseAnd");if(!ha(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);let i={a:n,b:r};return $.runKernel(My,i)}var FTe,RTe=w(()=>{"use strict";ne();q();J();bo();X();FTe=R({bitwiseAnd_:aAt})});function lAt(e,t){let n=D(e,"s0","broadcastArgs","int32"),r=D(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);let i={s0:n,s1:r};return $.runKernel(TC,i)}var OTe,MTe=w(()=>{"use strict";ne();q();J();X();OTe=R({broadcastArgs_:lAt})});function uAt(e,t){let n=D(e,"broadcastTo","x"),r=n.shape;if(Lr(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let u=n.shape.slice();for(;u.length<t.length;)u.unshift(1);n=V(n,u)}let i=n.shape,o=Array.from(t);for(let u=t.length-1;u>=0;u--)if(i[u]===t[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return ll(n);let a={x:n},l={reps:o};return $.runKernel(Dd,a,l)}var Eh,y6=w(()=>{"use strict";ne();q();J();bo();bT();X();qe();Eh=R({broadcastTo_:uAt})});function cAt(e){let n={x:D(e,"x","ceil","float32")};return $.runKernel(Om,n)}var v6,$Te=w(()=>{"use strict";ne();q();J();X();v6=R({ceil_:cAt})});function bf(e,t,n){Lr(e),n=n||Oy(t);let r={shape:e,value:t,dtype:n};return $.runKernel(jC,{},r)}var ST=w(()=>{"use strict";ne();q();ae();bo();});function fAt(e,t,n){let r=D(e,"x","clipByValue");if(L(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return bf(r.shape,t,r.dtype);let i={x:r},o={clipValueMin:t,clipValueMax:n};return $.runKernel(Mm,i,o)}var vo,PTe=w(()=>{"use strict";ne();q();J();ae();ST();X();vo=R({clipByValue_:fAt})});function dAt(e){return En(e,0)}var w6,LTe=w(()=>{"use strict";dc();X();w6=R({concat1d_:dAt})});function pAt(e,t){return En(e,t)}var C6,BTe=w(()=>{"use strict";dc();X();C6=R({concat2d_:pAt})});function mAt(e,t){return En(e,t)}var _6,zTe=w(()=>{"use strict";dc();X();_6=R({concat3d_:mAt})});function hAt(e,t){return En(e,t)}var S6,UTe=w(()=>{"use strict";dc();X();S6=R({concat4d_:hAt})});function gAt(e,t,n,r,i="NHWC",o=[1,1],s){let a=D(e,"x","conv2d","float32"),l=D(t,"filter","conv2d","float32"),u=a,c=!1;a.rank===3&&(c=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),L(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ir("conv2d",r,s);let f=i==="NHWC"?u.shape[3]:u.shape[1];L(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),L(Go(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),L(_h(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),L(_h(n),()=>"Error in conv2D: Strides should be larger than 0.");let d={x:u,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s},m=$.runKernel(V0,d,p);return c?V(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var cl,z_=w(()=>{"use strict";ne();q();J();ae();io();X();qe();cl=R({conv2d_:gAt})});function xAt(e,t,n,r,i="NWC",o=1,s){let a=D(e,"x","conv1d"),l=D(t,"filter","conv1d"),u=a,c=!1;a.rank===2&&(c=!0,u=V(a,[1,a.shape[0],a.shape[1]])),L(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),L(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ir("conv1d",r,s),L(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),L(Go(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),L(_h(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),L(_h(n),()=>"Error in conv1D: Stride should be larger than 0."),L(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);let f=V(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=V(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=cl(d,f,[1,n],r,"NHWC",[1,o],s);return c?V(g,[g.shape[2],g.shape[3]]):V(g,[g.shape[0],g.shape[2],g.shape[3]])}var ET,Mne=w(()=>{"use strict";J();ae();z_();io();X();qe();ET=R({conv1d_:xAt})});function bAt(e,t,n,r,i,o="NHWC",s){L(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,l=t,u=!1;t.rank===3&&(u=!0,l=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),L(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),L(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),L(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let c=o==="NHWC"?a[3]:a[1],f=o==="NHWC"?l.shape[3]:l.shape[1];L(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),L(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),ir("conv2dDerInput",i,s);let d={dy:l,filter:n},p={strides:r,pad:i,dataFormat:o,dimRoundingMode:s,inputShape:a},m=$.runKernel(W0,d,p);return u?V(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var AT,E6=w(()=>{"use strict";ne();q();ae();io();X();qe();AT=R({conv2DBackpropInput_:bAt})});function yAt(e,t,n,r,i,o){let s=D(e,"x","conv2dTranspose"),a=D(t,"filter","conv2dTranspose");return AT(n,s,a,r,i,"NHWC",o)}var TT,$ne=w(()=>{"use strict";J();E6();X();TT=R({conv2dTranspose_:yAt})});function vAt(e,t,n,r,i="NDHWC",o=[1,1,1]){let s=D(e,"x","conv3d"),a=D(t,"filter","conv3d"),l=s,u=!1;s.rank===4&&(u=!0,l=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),L(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),L(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),L(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),L(Go(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),L(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),L(_h(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),L(_h(n),()=>"Error in conv3D: Strides should be larger than 0.");let c={x:l,filter:a},f={strides:n,pad:r,dataFormat:i,dilations:o},d=$.runKernel(G0,c,f);return u?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var A6,jTe=w(()=>{"use strict";ne();q();J();ae();io();X();qe();A6=R({conv3d_:vAt})});function wAt(e,t,n,r,i){L(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,s=t,a=!1;t.rank===4&&(a=!0,s=V(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),o=[1,e[0],e[1],e[2],e[3]]);let l=o[4],u=s.shape[4];L(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),L(s.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`),L(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),L(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),L(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);let c={dy:s,filter:n},f={pad:i,strides:r,inputShape:o},d=$.runKernel(NC,c,f);return a?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var T6,Pne=w(()=>{"use strict";ne();q();ae();X();qe();T6=R({conv3DBackpropInput_:wAt})});function CAt(e,t,n,r,i){let o=D(e,"x","conv3dTranspose"),s=D(t,"filter","conv3dTranspose");return T6(n,o,s,r,i)}var k6,VTe=w(()=>{"use strict";J();Pne();X();k6=R({conv3dTranspose_:CAt})});function _At(e){let n={x:D(e,"x","cos","float32")};return $.runKernel($m,n)}var iv,I6=w(()=>{"use strict";ne();q();J();X();iv=R({cos_:_At})});function SAt(e){let n={x:D(e,"x","cosh","float32")};return $.runKernel(Pm,n)}var kT,Lne=w(()=>{"use strict";ne();q();J();X();kT=R({cosh_:SAt})});function EAt(e,t=0,n=!1,r=!1){let o={x:D(e,"x","cumprod")},s={axis:t,exclusive:n,reverse:r};return $.runKernel(FC,o,s)}var U_,D6=w(()=>{"use strict";ne();q();J();X();U_=R({cumprod_:EAt})});function AAt(e,t=0,n=!1,r=!1){let o={x:D(e,"x","cumsum")},s={axis:t,exclusive:n,reverse:r};return $.runKernel(q0,o,s)}var IT,N6=w(()=>{"use strict";ne();q();J();X();IT=R({cumsum_:AAt})});function TAt(e,t,n,r=!1){let i=D(e,"x","denseBincount"),o=D(t,"weights","denseBincount");L(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),L(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),L(n>=0,()=>`size must be non-negative, but got ${n}.`),L(o.size===i.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${o.shape}.`);let s={x:i,weights:o},a={size:n,binaryOutput:r};return $.runKernel(OC,s,a)}var cO,WTe=w(()=>{"use strict";ne();q();J();ae();X();cO=R({denseBincount_:TAt})});function kAt(e,t,n="NHWC"){let r=D(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],s=n==="NHWC"?r.shape[3]:r.shape[1];L(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),L(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),L(o*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${t} for depthToSpace with input shape
        ${r.shape}`),L(s%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`);let a={x:r},l={blockSize:t,dataFormat:n};return $.runKernel(MC,a,l)}var F6,Bne=w(()=>{"use strict";ne();q();J();ae();X();F6=R({depthToSpace_:kAt})});function IAt(e,t,n,r,i="NHWC",o=[1,1],s){let a=D(e,"x","depthwiseConv2d","float32"),l=D(t,"filter","depthwiseConv2d","float32"),u=a,c=!1;a.rank===3&&(c=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),L(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);let f=i==="NHWC"?u.shape[3]:u.shape[1];L(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),ir("depthwiseConv2d",r,s);let d={x:u,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s},m=$.runKernel(H0,d,p);return c?V(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var Ah,fO=w(()=>{"use strict";ne();q();J();ae();io();X();qe();Ah=R({depthwiseConv2d_:IAt})});function DAt(e){let n={x:D(e,"x","diag")};return $.runKernel(LC,n)}var GTe,qTe=w(()=>{"use strict";ne();q();J();X();GTe=R({diag_:DAt})});function NAt(e,t,n,r,i=[1,1],o="NHWC"){let s=D(e,"x","dilation2d"),a=D(t,"filter","dilation2d");L(s.rank===3||s.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),L(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),L(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=s,u=!1;s.rank===3&&(l=V(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0),L(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);let c={x:l,filter:a},f={strides:n,pad:r,dilations:i},d=$.runKernel(Y0,c,f);return u?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var R6,zne=w(()=>{"use strict";ne();q();J();ae();X();qe();R6=R({dilation2d_:NAt})});var fl={};rn(fl,{assertAndGetBroadcastShape:()=>Ft,getBroadcastDims:()=>HTe,getReductionAxes:()=>Hn});function HTe(e,t){let n=e.length,r=[];for(let i=0;i<n;i++){let o=n-1-i,s=e[o]||1;(t[t.length-1-i]||1)>1&&s===1&&r.unshift(o)}return r}function Hn(e,t){let n=[];for(let r=0;r<t.length;r++){let i=e[e.length-r-1],o=t.length-r-1,s=t[o];(i==null||i===1&&s>1)&&n.unshift(o)}return n}function Ft(e,t){let n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let o=e[e.length-i-1];o==null&&(o=1);let s=t[t.length-i-1];if(s==null&&(s=1),o===1)r[n-i-1]=s;else if(s===1)r[n-i-1]=o;else if(o!==s){let a=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(a)}else r[n-i-1]=o}return r}var hr=w(()=>{"use strict";});function FAt(e,t){let n=D(e,"a","equal","string_or_numeric"),r=D(t,"b","equal","string_or_numeric");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel($y,i)}var Vs,dO=w(()=>{"use strict";ne();q();zr();J();hr();X();Vs=R({equal_:FAt})});function RAt(e,t,n){let r=D(t,"a","where"),i=D(n,"b","where"),o=D(e,"condition","where","bool"),s=Ft(Ft(o.shape,r.shape),i.shape),a=Eh(o,s),l=Eh(r,s),u=Eh(i,s),c={condition:a,t:l,e:u};return $.runKernel(xx,c)}var or,pc=w(()=>{"use strict";ne();q();J();y6();hr();X();or=R({where_:RAt})});function OAt(e){let n={x:D(e,"x","zerosLike")};return $.runKernel(Ex,n)}var lt,Ar=w(()=>{"use strict";ne();q();J();X();lt=R({zerosLike_:OAt})});function MAt(e,t){let n=D(e,"a","div"),r=D(t,"b","div");[n,r]=Qt(n,r);let i=Fe(n,r),o=lt(i),s=Vs(r,o);return or(s,o,i)}var O6,Une=w(()=>{"use strict";zr();J();Ln();dO();X();pc();Ar();O6=R({divNoNan_:MAt})});function $At(e,t){let n=D(e,"t1","dot"),r=D(t,"t2","dot");L((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);let i=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if(L(i===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${o}.`),n.rank===1&&r.rank===1){let s=V(n,[1,-1]),a=V(r,[-1,1]),l=Bt(s,a);return V(l,[])}else if(n.rank===1&&r.rank===2){let s=V(n,[1,-1]),a=V(r,[r.shape[0],r.shape[1]]),l=Bt(s,a);return V(l,[l.size])}else if(n.rank===2&&r.rank===1){let s=V(r,[-1,1]),a=Bt(n,s);return V(a,[a.size])}else{let s=V(r,[r.shape[0],r.shape[1]]);return Bt(n,s)}}var M6,jne=w(()=>{"use strict";J();ae();$d();X();qe();M6=R({dot_:$At})});function PAt(e,...t){let n=t.map((i,o)=>D(i,`tensors${o}`,"einsum")),r={equation:e};return $.runKernel(BC,n,r)}var ov,Vne=w(()=>{"use strict";ne();q();J();X();ov=R({einsum_:PAt})});function LAt(e){let n={x:D(e,"x","elu","float32")};return $.runKernel(Bm,n)}var Th,$6=w(()=>{"use strict";ne();q();J();X();Th=R({elu_:LAt})});function BAt(e,t){let n=D(e,"x","ensureShape","string_or_numeric");if(!$te(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}var YTe,KTe=w(()=>{"use strict";J();bo();X();YTe=R({ensureShape_:BAt})});function zAt(e){let t=D(e,"x","erf");L(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=de(t,"float32"));let n={x:t};return $.runKernel(zm,n)}var DT,XTe=w(()=>{"use strict";ne();q();J();ae();sn();X();DT=R({erf_:zAt})});function Wne(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function ZTe(e,t,n){let r=e.length+t.length,i=[],o=0,s=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?i.push(e[o++]):i.push(t[s++]);return i}function Gne(e,t){let n=[],r=e.length;for(let o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);let i=t.map(o=>e[o]);return[n,i]}function yf(e,t){let n=t.map(r=>1);return ZTe(e,n,t)}function UAt(e,t,n){L(Wne(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function qne(e,t){if(Wne(e,t))return null;let n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function pO(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function jAt(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}var Ld=w(()=>{"use strict";ae();});function VAt(e,t=null,n=!1){let i={x:D(e,"x","max")},o={reductionIndices:t,keepDims:n};return $.runKernel(ex,i,o)}var wo,NT=w(()=>{"use strict";ne();q();J();X();wo=R({max_:VAt})});function WAt(e,t=null,n=!1){let i={x:D(e,"x","min")},o={axis:t,keepDims:n};return $.runKernel(ix,i,o)}var Fx,P6=w(()=>{"use strict";ne();q();J();X();Fx=R({min_:WAt})});function GAt(e,t){let n=D(e,"base","pow"),r=D(t,"exp","pow");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(th,i)}var us,sv=w(()=>{"use strict";ne();q();zr();J();X();us=R({pow_:GAt})});function Pe(e,t){if((bi(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&bi(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return xa(e,[],[],t)}var Tr=w(()=>{"use strict";ae();kx();});function qAt(e){let n={x:D(e,"x","sqrt","float32")};return $.runKernel(ph,n)}var Bn,Bd=w(()=>{"use strict";ne();q();J();X();Bn=R({sqrt_:qAt})});function HAt(e){let t=D(e,"x","square"),n={};return $.runKernel("Square",{x:t},n)}var jt,Ui=w(()=>{"use strict";ne();J();X();jt=R({square_:HAt})});function YAt(e,t=null,n=!1){let r=D(e,"x","sum");r.dtype==="bool"&&(r=de(r,"int32"));let i={x:r},o={axis:t,keepDims:n};return $.runKernel(yx,i,o)}var Me,ni=w(()=>{"use strict";ne();q();J();sn();X();Me=R({sum_:YAt})});function KAt(e,t="euclidean",n=null,r=!1){e=D(e,"x","norm");let i=QTe(e,t,n),o=i.shape;if(r){let s=zi(n,e.shape);o=yf(i.shape,s)}return V(i,o)}function QTe(e,t,n=null){if(e.rank===0)return mr(e);if(e.rank!==1&&n===null)return QTe(V(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Me(mr(e),n);if(t===1/0)return wo(mr(e),n);if(t===-1/0)return Fx(mr(e),n);if(t==="euclidean"||t===2)return Bn(Me(us(mr(e),Pe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return wo(Me(mr(e),n[0]),n[1]-1);if(t===1/0)return wo(Me(mr(e),n[1]),n[0]);if(t===-1/0)return Fx(Me(mr(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Bn(Me(jt(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}var Rx,mO=w(()=>{"use strict";J();ae();P_();Ld();NT();P6();X();sv();qe();Tr();Bd();Ui();ni();Rx=R({norm_:KAt})});function XAt(e,t=null,n=!1){return Rx(e,"euclidean",t,n)}var L6,Yne=w(()=>{"use strict";mO();X();L6=R({euclideanNorm_:XAt})});function ZAt(e){let n={x:D(e,"x","exp")};return $.runKernel(Um,n)}var Jr,kh=w(()=>{"use strict";ne();q();J();X();Jr=R({exp_:ZAt})});function QAt(e,t=0){let n=D(e,"x","expandDims","string_or_numeric");L(t<=n.rank,()=>"Axis must be <= rank of the tensor");let r={input:n},i={dim:t};return $.runKernel(K0,r,i)}var ri,FT=w(()=>{"use strict";ne();q();J();ae();X();ri=R({expandDims_:QAt})});function JAt(e){let n={x:D(e,"x","expm1")};return $.runKernel(jm,n)}var B6,JTe=w(()=>{"use strict";ne();q();J();X();B6=R({expm1_:JAt})});function eTt(e,t){let n=D(e,"x","tile","string_or_numeric");L(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);let r={x:n},i={reps:t};return $.runKernel(Dd,r,i)}var qo,RT=w(()=>{"use strict";ne();q();J();ae();X();qo=R({tile_:eTt})});function tTt(e,t,n,r="float32"){t==null&&(t=e);let i=et([e,t],r),o=e<=t?e:t;for(let a=0;a<o;++a)i.set(1,a,a);let s=V(i.toTensor(),[e,t]);if(n==null)return s;if(n.length===1)return qo(ri(s,0),[n[0],1,1]);if(n.length===2)return qo(ri(ri(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return qo(ri(ri(ri(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}var j_,Kne=w(()=>{"use strict";Nx();FT();X();qe();RT();j_=R({eye_:tTt})});function nTt(e){let n={x:D(e,"x","floor","float32")};return $.runKernel(Vm,n)}var Ih,z6=w(()=>{"use strict";ne();q();J();X();Ih=R({floor_:nTt})});function rTt(e,t,n=0,r=0){let i=D(e,"x","gather"),o=D(t,"indices","gather","int32"),s={x:i,indices:o},a={axis:n,batchDims:r};return $.runKernel(Z0,s,a)}var Dh,hO=w(()=>{"use strict";ne();q();J();X();Dh=R({gather_:rTt})});function iTt(e,t){let n=D(e,"a","greater","string_or_numeric"),r=D(t,"b","greater","string_or_numeric");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(Py,i)}var Ur,Nh=w(()=>{"use strict";ne();q();zr();J();hr();X();Ur=R({greater_:iTt})});function oTt(e,t){let n=D(e,"a","greaterEqual","string_or_numeric"),r=D(t,"b","greaterEqual","string_or_numeric");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(Gm,i)}var ba,V_=w(()=>{"use strict";ne();q();zr();J();hr();X();ba=R({greaterEqual_:oTt})});function sTt(e){let n={input:D(e,"input","imag")};return $.runKernel(qC,n)}var av,gO=w(()=>{"use strict";ne();q();J();X();av=R({imag_:sTt})});function aTt(e){let n={x:D(e,"x","isFinite")};return $.runKernel(qm,n)}var U6,eke=w(()=>{"use strict";ne();q();J();X();U6=R({isFinite_:aTt})});function lTt(e){let n={x:D(e,"x","isInf")};return $.runKernel(Hm,n)}var j6,tke=w(()=>{"use strict";ne();q();J();X();j6=R({isInf_:lTt})});function uTt(e){let n={x:D(e,"x","isNaN")};return $.runKernel(Ym,n)}var V6,nke=w(()=>{"use strict";ne();q();J();X();V6=R({isNaN_:uTt})});function cTt(e,t=.2){let r={x:D(e,"x","leakyRelu")},i={alpha:t};return $.runKernel(Q0,r,i)}var lv,W6=w(()=>{"use strict";ne();q();J();X();lv=R({leakyRelu_:cTt})});function fTt(e,t){let n=D(e,"a","less","string_or_numeric"),r=D(t,"b","less","string_or_numeric");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(Ly,i)}var Ox,xO=w(()=>{"use strict";ne();q();zr();J();hr();X();Ox=R({less_:fTt})});function dTt(e,t){let n=D(e,"a","lessEqual","string_or_numeric"),r=D(t,"b","lessEqual","string_or_numeric");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(By,i)}var eu,uv=w(()=>{"use strict";ne();q();zr();J();hr();X();eu=R({lessEqual_:dTt})});function rke(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let r={start:e,stop:t,num:n};return $.runKernel(HC,{},r)}var ike=w(()=>{"use strict";ne();q();});function pTt(e,t=5,n=1,r=1,i=.5){let o=D(e,"x","localResponseNormalization");L(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),L(F0(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let s=o,a=!1;o.rank===3&&(a=!0,s=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let l={x:s},u={depthRadius:t,bias:n,alpha:r,beta:i},c=$.runKernel(J0,l,u);return a?V(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var G6,Xne=w(()=>{"use strict";ne();q();J();ae();X();qe();G6=R({localResponseNormalization_:pTt})});function mTt(e){let n={x:D(e,"x","log","float32")};return $.runKernel(Km,n)}var Co,OT=w(()=>{"use strict";ne();q();J();X();Co=R({log_:mTt})});function hTt(e){let n={x:D(e,"x","log1p")};return $.runKernel(Xm,n)}var cv,Zne=w(()=>{"use strict";ne();q();J();X();cv=R({log1p_:hTt})});function oke(e){return L(Em(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let r=D(t,"x","tf.grad","string_or_numeric"),i=n!=null?D(n,"dy","tf.grad"):null;return $.tidy(()=>{let{value:o,grads:s}=$.gradients(()=>e(r),[r],i);return i!=null&&Sr(o.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),q6(s),s[0]})}}function ske(e){return L(Em(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{L(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let r=Tx(t,"args","tf.grads","string_or_numeric"),i=n!=null?D(n,"dy","tf.grads"):null;return $.tidy(()=>{let{value:o,grads:s}=$.gradients(()=>e(...r),r,i);return i!=null&&Sr(o.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),q6(s),s})}}function ake(e){return L(Em(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{L(t instanceof Kt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),L(n==null||n instanceof Kt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:r,value:i}=$.gradients(()=>e(t),[t],n);return q6(r),{grad:r[0],value:i}}}function lke(e){return L(Em(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{L(Array.isArray(t)&&t.every(i=>i instanceof Kt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),L(n==null||n instanceof Kt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let r=$.gradients(()=>e(...t),t,n);return n!=null&&Sr(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),q6(r.grads),r}}function bO(e,t){L(Em(e),()=>"The f passed in variableGrads(f) must be a function"),L(t==null||Array.isArray(t)&&t.every(u=>u instanceof vh),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=t!=null;if(!n){t=[];for(let u in $.registeredVariables)t.push($.registeredVariables[u])}let r=n?t.filter(u=>!u.trainable):null,i=t.length;t=t.filter(u=>u.trainable),L(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);let o=!0,{value:s,grads:a}=$.gradients(e,t,null,o);L(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),L(s.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);let l={};return t.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r?.forEach(u=>l[u.name]=null),{value:s,grads:l}}function Ws(e){return $.customGrad(e)}function q6(e){if(e.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Mx=w(()=>{"use strict";ne();le();J();ae();});function gTt(e){let n={x:D(e,"x","neg")};return $.runKernel(sx,n)}var qt,_o=w(()=>{"use strict";ne();q();J();X();qt=R({neg_:gTt})});function xTt(e){let n={x:D(e,"x","softplus")};return $.runKernel(dh,n)}var zd,Qne=w(()=>{"use strict";ne();q();J();X();zd=R({softplus_:xTt})});function bTt(e){let t=D(e,"x","logSigmoid");return Ws(r=>({value:qt(zd(qt(r))),gradFunc:s=>j(s,js(qt(r)))}))(t)}var H6,uke=w(()=>{"use strict";Mx();J();ft();_o();X();CT();Qne();H6=R({logSigmoid_:bTt})});function yTt(e,t){let n=D(e,"a","sub"),r=D(t,"b","sub");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(hh,i)}var De,Yn=w(()=>{"use strict";ne();q();zr();J();X();De=R({sub_:yTt})});function vTt(e,t=-1){let n=D(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Ws((i,o)=>{let a=wo(i,t,!0),l=De(i,a),u=De(de(l,"float32"),Co(Me(Jr(l),t,!0)));return o([u]),{value:u,gradFunc:(f,d)=>{let[p]=d,m=!0,h=Jr(p);return De(f,j(Me(f,t,m),h))}}})(n)}var MT,cke=w(()=>{"use strict";Mx();J();sn();kh();OT();NT();ft();X();Yn();ni();MT=R({logSoftmax_:vTt})});function wTt(e,t=null,n=!1){let r=D(e,"x","logSumExp"),i=zi(t,r.shape),o=wo(r,i,!0),s=De(r,o),a=Jr(s),l=Me(a,i),u=Co(l),c=se(V(o,u.shape),u);if(n){let f=yf(c.shape,i);return V(c,f)}return c}var fv,Y6=w(()=>{"use strict";J();ae();Er();Ld();kh();OT();NT();X();qe();Yn();ni();fv=R({logSumExp_:wTt})});function CTt(e,t){let n=D(e,"a","logicalAnd","bool"),r=D(t,"b","logicalAnd","bool");Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(zy,i)}var cs,W_=w(()=>{"use strict";ne();q();J();hr();X();cs=R({logicalAnd_:CTt})});function _Tt(e){let n={x:D(e,"x","logicalNot","bool")};return $.runKernel(Uy,n)}var dv,yO=w(()=>{"use strict";ne();q();J();X();dv=R({logicalNot_:_Tt})});function STt(e,t){let n=D(e,"a","logicalOr","bool"),r=D(t,"b","logicalOr","bool");Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(jy,i)}var $T,K6=w(()=>{"use strict";ne();q();J();hr();X();$T=R({logicalOr_:STt})});function ETt(e,t){let n=D(e,"a","logicalXor","bool"),r=D(t,"b","logicalXor","bool");return Ft(n.shape,r.shape),cs($T(e,t),dv(cs(e,t)))}var X6,Jne=w(()=>{"use strict";J();hr();W_();yO();K6();X();X6=R({logicalXor_:ETt})});function ATt(e,t,n="left"){let r=D(e,"sortedSequence","searchSorted"),i=D(t,"values","searchSorted"),o=r.shape[r.shape.length-1],s=i.shape[i.shape.length-1],a=V(r,[-1,o]),l=V(i,[-1,s]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Zt(l.shape)>=Z6)throw new Error(`values tensor size must less than ${Z6}`);if(a.shape[1]>=Z6)throw new Error(`trailing dim_size must less than ${Z6} for int32 output type, was ${a.shape[1]}`);let u={sortedSequence:a,values:l},c={side:n};return $.runKernel(f_,u,c)}var Z6,vO,Q6=w(()=>{"use strict";ne();q();J();bo();X();qe();Z6=2147483648;vO=R({searchSorted_:ATt})});function fke(e,t){return vO(e,t,"left")}var dke=w(()=>{"use strict";Q6();});function TTt(e,t,n,r,i){let o=D(e,"x","maxPool"),s=1,a=o,l=!1;o.rank===3&&(l=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),L(Go(n,s),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),ir("maxPool",r,i);let u={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},f=$.runKernel(tx,u,c);return l?V(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var pv,J6=w(()=>{"use strict";ne();q();J();ae();io();X();qe();pv=R({maxPool_:TTt})});function kTt(e,t=[1,1,1],n,r,i,o="NDHWC"){let s=D(e,"x","maxPool3d"),a=s,l=!1;s.rank===4&&(l=!0,a=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),L(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),L(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),ir("maxPool3d",r,i);let u={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:o},f=$.runKernel(nx,u,c);return l?V(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var e8,pke=w(()=>{"use strict";ne();q();J();ae();io();X();qe();e8=R({maxPool3d_:kTt})});function ITt(e,t,n,r,i=!1){let s={x:D(e,"x","maxPoolWithArgmax")},a={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},l=$.runKernel(ZC,s,a);return{result:l[0],indexes:l[1]}}var mke,hke=w(()=>{"use strict";ne();q();J();X();mke=R({maxPoolWithArgmax_:ITt})});function DTt(e,t){let n=D(e,"a","maximum"),r=D(t,"b","maximum");[n,r]=Qt(n,r),n.dtype==="bool"&&(n=de(n,"int32"),r=de(r,"int32")),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(Zm,i)}var dl,wO=w(()=>{"use strict";ne();q();zr();J();hr();sn();X();dl=R({maximum_:DTt})});function NTt(e,t=null,n=!1){let i={x:D(e,"x","mean")},o={axis:t,keepDims:n};return $.runKernel(rx,i,o)}var sr,CO=w(()=>{"use strict";ne();q();J();X();sr=R({mean_:NTt})});function ar(e,t="float32"){if(Lr(e),t==="complex64"){let r=ar(e,"float32"),i=ar(e,"float32");return al(r,i)}let n=QA(Zt(e),t);return $.makeTensor(n,e,t)}var PT=w(()=>{"use strict";ne();ae();Zy();});function vi(e,t="float32"){if(Lr(e),t==="complex64"){let r=vi(e,"float32"),i=ar(e,"float32");return al(r,i)}let n=HR(Zt(e),t);return $.makeTensor(n,e,t)}var G_=w(()=>{"use strict";ne();ae();bo();Zy();PT();});function gke(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=D(e,"x","meshgrid",e instanceof Kt?e.dtype:"float32");if(t===void 0)return[r];let i=D(t,"y","meshgrid",t instanceof Kt?t.dtype:"float32"),o=Zt(r.shape),s=Zt(i.shape);return n==="xy"?(r=V(r,[1,-1]),i=V(i,[-1,1]),[Bt(vi([s,1],r.dtype),r),Bt(i,vi([1,o],i.dtype))]):(r=V(r,[-1,1]),i=V(i,[1,-1]),[Bt(r,vi([1,s],r.dtype)),Bt(vi([o,1],i.dtype),i)])}var xke=w(()=>{"use strict";$d();G_();qe();le();J();bo();});function FTt(e,t){let n=D(e,"a","minimum"),r=D(t,"b","minimum");[n,r]=Qt(n,r),n.dtype==="bool"&&(n=de(n,"int32"),r=de(r,"int32")),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(Qm,i)}var mc,_O=w(()=>{"use strict";ne();q();zr();J();hr();sn();X();mc=R({minimum_:FTt})});function RTt(e,t,n){L(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let r=D(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");L(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let i=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)L(t[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),L(t[a][0]>=0&&t[a][0]<=r.shape[a]-i&&t[a][1]>=0&&t[a][1]<=r.shape[a]-i,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`);let o={paddings:t,mode:n},s={x:r};return $.runKernel(ox,s,o)}var t8,ere=w(()=>{"use strict";ne();q();J();ae();X();t8=R({mirrorPad_:RTt})});function OTt(e,t){let n=D(e,"a","mod"),r=D(t,"b","mod");[n,r]=Qt(n,r);let i={a:n,b:r};return $.runKernel(Jm,i)}var n8,tre=w(()=>{"use strict";ne();q();zr();J();X();n8=R({mod_:OTt})});function MTt(e,t=null,n=!1){e=D(e,"x","moments");let r=zi(t,e.shape),i=sr(e,r,n),o=i.shape;n||(o=yf(i.shape,r));let s=jt(De(de(e,"float32"),V(i,o))),a=sr(s,r,n);return{mean:i,variance:a}}var q_,bke=w(()=>{"use strict";J();ae();Ld();sn();CO();X();qe();Ui();Yn();q_=R({moments_:MTt})});function $Tt(e,t,n,r){let i=D(t,"data","multiRNNCell"),o=Tx(n,"c","multiRNNCell"),s=Tx(r,"h","multiRNNCell"),a=i,l=[];for(let f=0;f<e.length;f++){let d=e[f](a,o[f],s[f]);l.push(d[0]),l.push(d[1]),a=d[1]}let u=[],c=[];for(let f=0;f<l.length;f+=2)u.push(l[f]),c.push(l[f+1]);return[u,c]}var yke,vke=w(()=>{"use strict";J();X();yke=R({multiRNNCell_:$Tt})});function PTt(e,t,n,r=!1){let i=D(e,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();let l={logits:s===1?V(i,[1,-1]):i},u={numSamples:t,seed:n,normalized:r},c=$.runKernel(QC,l,u);return s===1?V(c,[c.size]):c}var wke,Cke=w(()=>{"use strict";ne();q();J();X();qe();wke=R({multinomial_:PTt})});function LTt(e,t){let n=D(e,"a","notEqual","string_or_numeric"),r=D(t,"b","notEqual","string_or_numeric");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r};return $.runKernel(Vy,i)}var Ud,r8=w(()=>{"use strict";ne();q();zr();J();hr();X();Ud=R({notEqual_:LTt})});function BTt(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let s={indices:D(e,"indices","oneHot","int32")},a={dtype:i,depth:t,onValue:n,offValue:r};return $.runKernel(lx,s,a)}var Fh,i8=w(()=>{"use strict";ne();q();J();X();Fh=R({oneHot_:BTt})});function zTt(e){let n={x:D(e,"x","onesLike")};return $.runKernel(ax,n)}var oo,_ke=w(()=>{"use strict";ne();q();J();X();oo=R({onesLike_:zTt})});function UTt(e,t){let n=D(e,"v1","outerProduct"),r=D(t,"v2","outerProduct");L(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);let i=V(n,[-1,1]),o=V(r,[1,-1]);return Bt(i,o)}var Ske,Eke=w(()=>{"use strict";J();ae();$d();X();qe();Ske=R({outerProduct_:UTt})});function jTt(e,t,n=0){let r=D(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let i={paddings:t,constantValue:n},o={x:r};return $.runKernel(cx,o,i)}var ya,mv=w(()=>{"use strict";ne();q();J();X();ya=R({pad_:jTt})});function VTt(e,t,n=0){return L(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),ya(e,[t],n)}var Ake,Tke=w(()=>{"use strict";ae();X();mv();Ake=R({pad1d_:VTt})});function WTt(e,t,n=0){return L(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ya(e,t,n)}var kke,Ike=w(()=>{"use strict";ae();X();mv();kke=R({pad2d_:WTt})});function GTt(e,t,n=0){return L(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ya(e,t,n)}var Dke,Nke=w(()=>{"use strict";ae();X();mv();Dke=R({pad3d_:GTt})});function qTt(e,t,n=0){return L(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ya(e,t,n)}var Fke,Rke=w(()=>{"use strict";ae();X();mv();Fke=R({pad4d_:qTt})});function HTt(e,t,n){let r=D(e,"x","spaceToBatchND");L(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),L(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),L(r.shape.reduce((s,a,l)=>l>0&&l<=t.length?s&&(a+n[l-1][0]+n[l-1][1])%t[l-1]===0:s,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);let i={x:r},o={blockShape:t,paddings:n};return $.runKernel(vx,i,o)}var hv,SO=w(()=>{"use strict";ne();q();J();ae();X();hv=R({spaceToBatchND_:HTt})});function YTt(e,t,n,r,i,o,s){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");let a=D(e,"x","maxPool"),l=a,u=!1;a.rank===3&&(u=!0,l=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(Go(o,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${i}'`);let c=Nne(l.shape,t,o,i,r),f=[c.dilationHeight,c.dilationWidth],d;r==="same"?d=XTt([c.filterHeight,c.filterWidth],f):d=[[0,0],[0,0]];let p=f[0]===1&&f[1]===1,[m,h]=KTt([c.inHeight,c.inWidth],f,d),g=p?r:"valid",x=p?l:hv(l,f,m),y=(n==="avg"?()=>nv(x,t,o,g,s):()=>pv(x,t,o,g,s))(),v=p?y:rv(y,f,h);return u?V(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function KTt(e,t,n){let r=n.map(c=>c[0]),i=n.map(c=>c[1]),o=e.concat(r,i),s=t.map((c,f)=>(c-o[f]%c)%c),a=i.map((c,f)=>c+s[f]),l=t.map((c,f)=>[r[f],a[f]]),u=t.map((c,f)=>[0,s[f]]);return[l,u]}function XTt(e,t){let r=e.map((s,a)=>s+(s-1)*(t[a]-1)).map(s=>s-1),i=r.map(s=>Math.floor(s/2)),o=r.map((s,a)=>s-i[a]);return r.map((s,a)=>[i[a],o[a]])}var o8,nre=w(()=>{"use strict";J();ae();p6();uO();io();J6();X();qe();SO();o8=R({pool_:YTt})});function ZTt(e,t){let n=D(e,"x","prelu"),r=D(t,"alpha","prelu"),i={x:n,alpha:r};return $.runKernel(fx,i)}var gv,s8=w(()=>{"use strict";ne();q();J();X();gv=R({prelu_:ZTt})});function QTt(e,t=null,n=!1){let r=D(e,"x","prod");r.dtype==="bool"&&(r=de(r,"int32"));let i={x:r},o={axis:t,keepDims:n};return $.runKernel(dx,i,o)}var a8,rre=w(()=>{"use strict";ne();q();J();sn();X();a8=R({prod_:QTt})});function JTt(e,t,n,r){let i=e.map((c,f)=>D(c,`tensors${f}`,"raggedGather","int32")),o=D(t,"paramsDenseValues","raggedGather"),s=D(n,"indices","raggedGather","int32"),a={paramsNestedSplits:i,paramsDenseValues:o,indices:s},l={outputRaggedRank:r},u=$.runKernel(n_,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}var Oke,Mke=w(()=>{"use strict";ne();q();J();X();Oke=R({raggedGather_:JTt})});function ekt(e,t,n){let r=D(e,"starts","raggedRange"),i=D(t,"limits","raggedRange",r.dtype),o=D(n,"deltas","raggedRange",r.dtype),s={starts:r,limits:i,deltas:o},a=$.runKernel(r_,s);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}var $ke,Pke=w(()=>{"use strict";ne();q();J();X();$ke=R({raggedRange_:ekt})});function tkt(e,t,n,r,i){let o=D(e,"shape","raggedTensorToTensor","int32"),s=D(t,"values","raggedTensorToTensor"),a=D(n,"defaultValue","raggedTensorToTensor",s.dtype),l=r.map((f,d)=>D(f,`tensors${d}`,"raggedTensorToTensor","int32")),u={shape:o,values:s,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:i};return $.runKernel(i_,u,c)}var Lke,Bke=w(()=>{"use strict";ne();q();J();X();Lke=R({raggedTensorToTensor_:tkt})});function nkt(e,t,n){Lr(e);let r=Zt(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<r;o++)i[o]=t();return $.makeTensor(i,e,n)}var zke,Uke=w(()=>{"use strict";ne();ae();bo();X();zke=R({rand_:nkt})});var Vke=Ee((jke,ire)=>{"use strict";(function(e,t,n){function r(a){var l=this,u=s();l.next=function(){var c=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=c-(l.c=c|0)},l.c=1,l.s0=u(" "),l.s1=u(" "),l.s2=u(" "),l.s0-=u(a),l.s0<0&&(l.s0+=1),l.s1-=u(a),l.s1<0&&(l.s1+=1),l.s2-=u(a),l.s2<0&&(l.s2+=1),u=null}function i(a,l){return l.c=a.c,l.s0=a.s0,l.s1=a.s1,l.s2=a.s2,l}function o(a,l){var u=new r(a),c=l&&l.state,f=u.next;return f.int32=function(){return u.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}function s(){var a=4022871197,l=function(u){u=String(u);for(var c=0;c<u.length;c++){a+=u.charCodeAt(c);var f=.02519603282416938*a;a=f>>>0,f-=a,f*=a,a=f>>>0,f-=a,a+=f*4294967296}return(a>>>0)*23283064365386963e-26};return l}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.alea=o})(jke,typeof ire=="object"&&ire,typeof define=="function"&&define)});var Gke=Ee((Wke,ore)=>{"use strict";(function(e,t,n){function r(s){var a=this,l="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var c=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^c^c>>>8},s===(s|0)?a.x=s:l+=s;for(var u=0;u<l.length+64;u++)a.x^=l.charCodeAt(u)|0,a.next()}function i(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a}function o(s,a){var l=new r(s),u=a&&a.state,c=function(){return(l.next()>>>0)/4294967296};return c.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,p=(f+d)/(1<<21);while(p===0);return p},c.int32=l.next,c.quick=c,u&&(typeof u=="object"&&i(u,l),c.state=function(){return i(l,{})}),c}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xor128=o})(Wke,typeof ore=="object"&&ore,typeof define=="function"&&define)});var Hke=Ee((qke,sre)=>{"use strict";(function(e,t,n){function r(s){var a=this,l="";a.next=function(){var c=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(c^c<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,s===(s|0)?a.x=s:l+=s;for(var u=0;u<l.length+64;u++)a.x^=l.charCodeAt(u)|0,u==l.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function i(s,a){return a.x=s.x,a.y=s.y,a.z=s.z,a.w=s.w,a.v=s.v,a.d=s.d,a}function o(s,a){var l=new r(s),u=a&&a.state,c=function(){return(l.next()>>>0)/4294967296};return c.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,p=(f+d)/(1<<21);while(p===0);return p},c.int32=l.next,c.quick=c,u&&(typeof u=="object"&&i(u,l),c.state=function(){return i(l,{})}),c}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xorwow=o})(qke,typeof sre=="object"&&sre,typeof define=="function"&&define)});var Kke=Ee((Yke,are)=>{"use strict";(function(e,t,n){function r(s){var a=this;a.next=function(){var u=a.x,c=a.i,f,d,p;return f=u[c],f^=f>>>7,d=f^f<<24,f=u[c+1&7],d^=f^f>>>10,f=u[c+3&7],d^=f^f>>>3,f=u[c+4&7],d^=f^f<<7,f=u[c+7&7],f=f^f<<13,d^=f^f<<9,u[c]=d,a.i=c+1&7,d};function l(u,c){var f,d,p=[];if(c===(c|0))d=p[0]=c;else for(c=""+c,f=0;f<c.length;++f)p[f&7]=p[f&7]<<15^c.charCodeAt(f)+p[f+1&7]<<13;for(;p.length<8;)p.push(0);for(f=0;f<8&&p[f]===0;++f);for(f==8?d=p[7]=-1:d=p[f],u.x=p,u.i=0,f=256;f>0;--f)u.next()}l(a,s)}function i(s,a){return a.x=s.x.slice(),a.i=s.i,a}function o(s,a){s==null&&(s=+new Date);var l=new r(s),u=a&&a.state,c=function(){return(l.next()>>>0)/4294967296};return c.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,p=(f+d)/(1<<21);while(p===0);return p},c.int32=l.next,c.quick=c,u&&(u.x&&i(u,l),c.state=function(){return i(l,{})}),c}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xorshift7=o})(Yke,typeof are=="object"&&are,typeof define=="function"&&define)});var Zke=Ee((Xke,lre)=>{"use strict";(function(e,t,n){function r(s){var a=this;a.next=function(){var u=a.w,c=a.X,f=a.i,d,p;return a.w=u=u+1640531527|0,p=c[f+34&127],d=c[f=f+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=c[f]=p^d,a.i=f,p+(u^u>>>16)|0};function l(u,c){var f,d,p,m,h,g=[],x=128;for(c===(c|0)?(d=c,c=null):(c=c+"\0",d=0,x=Math.max(x,c.length)),p=0,m=-32;m<x;++m)c&&(d^=c.charCodeAt((m+32)%c.length)),m===0&&(h=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,m>=0&&(h=h+1640531527|0,f=g[m&127]^=d+h,p=f==0?p+1:0);for(p>=128&&(g[(c&&c.length||0)&127]=-1),p=127,m=4*128;m>0;--m)d=g[p+34&127],f=g[p=p+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,g[p]=d^f;u.w=h,u.X=g,u.i=p}l(a,s)}function i(s,a){return a.i=s.i,a.w=s.w,a.X=s.X.slice(),a}function o(s,a){s==null&&(s=+new Date);var l=new r(s),u=a&&a.state,c=function(){return(l.next()>>>0)/4294967296};return c.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,p=(f+d)/(1<<21);while(p===0);return p},c.int32=l.next,c.quick=c,u&&(u.X&&i(u,l),c.state=function(){return i(l,{})}),c}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.xor4096=o})(Xke,typeof lre=="object"&&lre,typeof define=="function"&&define)});var Jke=Ee((Qke,ure)=>{"use strict";(function(e,t,n){function r(s){var a=this,l="";a.next=function(){var c=a.b,f=a.c,d=a.d,p=a.a;return c=c<<25^c>>>7^f,f=f-d|0,d=d<<24^d>>>8^p,p=p-c|0,a.b=c=c<<20^c>>>12^f,a.c=f=f-d|0,a.d=d<<16^f>>>16^p,a.a=p-c|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,s===Math.floor(s)?(a.a=s/4294967296|0,a.b=s|0):l+=s;for(var u=0;u<l.length+20;u++)a.b^=l.charCodeAt(u)|0,a.next()}function i(s,a){return a.a=s.a,a.b=s.b,a.c=s.c,a.d=s.d,a}function o(s,a){var l=new r(s),u=a&&a.state,c=function(){return(l.next()>>>0)/4294967296};return c.double=function(){do var f=l.next()>>>11,d=(l.next()>>>0)/4294967296,p=(f+d)/(1<<21);while(p===0);return p},c.int32=l.next,c.quick=c,u&&(typeof u=="object"&&i(u,l),c.state=function(){return i(l,{})}),c}t&&t.exports?t.exports=o:n&&n.amd?n(function(){return o}):this.tychei=o})(Qke,typeof ure=="object"&&ure,typeof define=="function"&&define)});var eIe=Ee(()=>{"use strict"});var nIe=Ee((tIe,l8)=>{"use strict";(function(e,t,n){var r=256,i=6,o=52,s="random",a=n.pow(r,i),l=n.pow(2,o),u=l*2,c=r-1,f;function d(y,v,C){var _=[];v=v==!0?{entropy:!0}:v||{};var S=g(h(v.entropy?[y,b(t)]:y??x(),3),_),E=new p(_),T=function(){for(var I=E.g(i),k=a,O=0;I<l;)I=(I+O)*r,k*=r,O=E.g(1);for(;I>=u;)I/=2,k/=2,O>>>=1;return(I+O)/k};return T.int32=function(){return E.g(4)|0},T.quick=function(){return E.g(4)/4294967296},T.double=T,g(b(E.S),t),(v.pass||C||function(I,k,O,F){return F&&(F.S&&m(F,E),I.state=function(){return m(E,{})}),O?(n[s]=I,k):I})(T,S,"global"in v?v.global:this==n,v.state)}function p(y){var v,C=y.length,_=this,S=0,E=_.i=_.j=0,T=_.S=[];for(C||(y=[C++]);S<r;)T[S]=S++;for(S=0;S<r;S++)T[S]=T[E=c&E+y[S%C]+(v=T[S])],T[E]=v;(_.g=function(I){for(var k,O=0,F=_.i,B=_.j,M=_.S;I--;)k=M[F=c&F+1],O=O*r+M[c&(M[F]=M[B=c&B+k])+(M[B]=k)];return _.i=F,_.j=B,O})(r)}function m(y,v){return v.i=y.i,v.j=y.j,v.S=y.S.slice(),v}function h(y,v){var C=[],_=typeof y,S;if(v&&_=="object")for(S in y)try{C.push(h(y[S],v-1))}catch{}return C.length?C:_=="string"?y:y+"\0"}function g(y,v){for(var C=y+"",_,S=0;S<C.length;)v[c&S]=c&(_^=v[c&S]*19)+C.charCodeAt(S++);return b(v)}function x(){try{var y;return f&&(y=f.randomBytes)?y=y(r):(y=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(y)),b(y)}catch{var v=e.navigator,C=v&&v.plugins;return[+new Date,e,C,e.screen,b(t)]}}function b(y){return String.fromCharCode.apply(0,y)}if(g(n.random(),t),typeof l8=="object"&&l8.exports){l8.exports=d;try{f=eIe()}catch{}}else typeof define=="function"&&define.amd?define(function(){return d}):n["seed"+s]=d})(typeof self<"u"?self:tIe,[],Math)});var EO=Ee((DWn,rIe)=>{"use strict";var rkt=Vke(),ikt=Gke(),okt=Hke(),skt=Kke(),akt=Zke(),lkt=Jke(),H_=nIe();H_.alea=rkt;H_.xor128=ikt;H_.xorwow=okt;H_.xorshift7=skt;H_.xor4096=akt;H_.tychei=lkt;rIe.exports=H_});var pre={};rn(pre,{TEST_EPSILON_FLOAT16:()=>iIe,createVideoElement:()=>gkt,encodeStrings:()=>oIe,expectArrayBuffersEqual:()=>hkt,expectArraysClose:()=>ckt,expectArraysEqual:()=>dkt,expectNumbersClose:()=>pkt,expectPromiseToFail:()=>fkt,expectValuesInRange:()=>mkt,play:()=>xkt,testEpsilon:()=>fre});function ckt(e,t,n){return n==null&&(n=fre()),cre(e,t,(r,i)=>dre(r,i,n))}function fre(){return $.backend.floatPrecision()===32?ukt:iIe}function cre(e,t,n){let r=!0;if((bi(e)||bi(t))&&(r=!1),bi(e)&&bi(t)&&(r=!0),r){let s=e.constructor.name,a=t.constructor.name;if(s!==a)throw new Error(`Arrays are of different type. Actual: ${s}. Expected: ${a}`)}if(Array.isArray(e)&&Array.isArray(t)){let s=ss(e),a=ss(t);if(!ha(s,a))throw new Error(`Arrays have different shapes. Actual: [${s}]. Expected: [${a}]`)}let i=bi(e)?e:Rd(e),o=bi(t)?t:Rd(t);if(i.length!==o.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${o.length}.
Actual:   ${i}.
Expected: ${o}.`);for(let s=0;s<o.length;++s){let a=i[s],l=o[s];if(!n(a,l))throw new Error(`Arrays differ: actual[${s}] = ${a}, expected[${s}] = ${l}.
Actual:   ${i}.
Expected: ${o}.`)}typeof expect<"u"&&expect().nothing()}function fkt(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function dkt(e,t){let n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Td(e)||Td(e[0])||Td(t)||Td(t[0])?cre(e,n,(r,i)=>r==i):cre(e,t,(r,i)=>dre(r,i,0))}function pkt(e,t,n){if(n==null&&(n=fre()),!dre(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function dre(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function mkt(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function hkt(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${n[i]} instead`)}function oIe(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?oIe(n):e[t]=Ky(n)}return e}function gkt(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}function xkt(e){return te(this,null,function*(){yield e.play(),"requestVideoFrameCallback"in e&&(yield new Promise(t=>{e.requestVideoFrameCallback(t)}))})}var ukt,iIe,sIe=w(()=>{"use strict";ne();J();ae();ukt=.001,iIe=.1});var f8,Y_,u8,c8,AO=w(()=>{"use strict";f8=tc(EO());Y_=class{constructor(t,n,r,i,o){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let s=o||Math.random();this.random=f8.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){let i=this.nextVal;return this.nextVal=NaN,i}let t,n,r=!1;for(;!r;){let i,o,s;do i=2*this.random()-1,o=2*this.random()-1,s=i*i+o*o;while(s>=1||s===0);let a=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*i*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}},u8=class{constructor(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;let o=i||Math.random();this.randu=f8.alea(o.toString()),this.randn=new Y_(0,1,r,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,r,i,o,s;for(;;){do i=this.randn.nextValue(),s=1+this.c*i;while(s<=0);if(s*=s*s,t=i*i,n=1-.331*t*t,r=.5*t+this.d*(1-s+Math.log(s)),o=this.randu(),o<n||Math.log(o)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}},c8=class{constructor(t=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=f8.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}});function bkt(e,t,n=1,r="float32",i){if(Lr(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);let o=new u8(t,n,r,i),s=et(e,r);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}var aIe,lIe=w(()=>{"use strict";bo();Nx();X();AO();aIe=R({randomGamma_:bkt})});function ykt(e,t=0,n=1,r,i){if(Lr(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let o=new Y_(t,n,r,!1,i),s=et(e,r);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}var K_,mre=w(()=>{"use strict";bo();Nx();X();AO();K_=R({randomNormal_:ykt})});function vkt(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return K_(e,0,1,t,n)}var uIe,cIe=w(()=>{"use strict";X();mre();uIe=R({randomStandardNormal_:vkt})});function wkt(e,t=0,n=1,r="float32",i){Lr(e);let o=et(e,r),s=new c8(t,n,null,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}var tu,d8=w(()=>{"use strict";bo();Nx();X();AO();tu=R({randomUniform_:wkt})});function Ckt(e,t,n,r){return tu(e,t,n,"int32",r)}var fIe,dIe=w(()=>{"use strict";X();d8();fIe=R({randomUniformInt_:Ckt})});function Rh(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");let i={start:e,stop:t,step:n,dtype:r};return $.runKernel(o_,{},i)}var p8=w(()=>{"use strict";ne();q();});function _kt(e){let n={input:D(e,"input","real")};return $.runKernel(s_,n)}var $x,TO=w(()=>{"use strict";ne();q();J();X();$x=R({real_:_kt})});function Skt(e){let n={x:D(e,"x","reciprocal")};return $.runKernel(nh,n)}var m8,pIe=w(()=>{"use strict";ne();q();J();X();m8=R({reciprocal_:Skt})});function Ekt(e){let n={x:D(e,"x","relu")};return $.runKernel(rh,n)}var Ho,LT=w(()=>{"use strict";ne();q();J();X();Ho=R({relu_:Ekt})});function Akt(e){let n={x:D(e,"x","relu6")};return $.runKernel(ih,n)}var BT,h8=w(()=>{"use strict";ne();q();J();X();BT=R({relu6_:Akt})});function Tkt(e,t){let r={x:D(e,"x","reverse")},i={dims:t};return $.runKernel(gx,r,i)}var ji,Px=w(()=>{"use strict";ne();q();J();X();ji=R({reverse_:Tkt})});function kkt(e){let t=D(e,"x","reverse");return L(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),ji(t,0)}var mIe,hIe=w(()=>{"use strict";J();ae();X();Px();mIe=R({reverse1d_:kkt})});function Ikt(e,t){let n=D(e,"x","reverse");return L(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),ji(n,t)}var gIe,xIe=w(()=>{"use strict";J();ae();X();Px();gIe=R({reverse2d_:Ikt})});function Dkt(e,t){let n=D(e,"x","reverse");return L(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),ji(n,t)}var bIe,yIe=w(()=>{"use strict";J();ae();X();Px();bIe=R({reverse3d_:Dkt})});function Nkt(e,t){let n=D(e,"x","reverse");return L(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),ji(n,t)}var vIe,wIe=w(()=>{"use strict";J();ae();X();Px();vIe=R({reverse4d_:Nkt})});function Fkt(e){let n={x:D(e,"x","round")};return $.runKernel(oh,n)}var zT,hre=w(()=>{"use strict";ne();q();J();X();zT=R({round_:Fkt})});function Rkt(e){let n={x:D(e,"x","rsqrt","float32")};return $.runKernel(sh,n)}var UT,gre=w(()=>{"use strict";ne();q();J();X();UT=R({rsqrt_:Rkt})});function Okt(e){let n={x:D(e,"x","selu")};return $.runKernel(ah,n)}var jT,xre=w(()=>{"use strict";ne();q();J();X();jT=R({selu_:Okt})});function Mkt(e,t,n,r,i,o=[1,1],s="NHWC"){let a=D(e,"x","separableConv2d"),l=D(t,"depthwiseFilter","separableConv2d"),u=D(n,"pointwiseFilter","separableConv2d"),c=a,f=!1;if(a.rank===3&&(f=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),L(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),L(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),L(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),L(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);let d=l.shape[2],p=l.shape[3];L(u.shape[2]===d*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*p}, but got ${u.shape[2]}.`);let m=Ah(c,l,r,i,s,o),g=cl(m,u,1,"valid",s);return f?V(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var VT,bre=w(()=>{"use strict";J();ae();z_();fO();X();qe();VT=R({separableConv2d_:Mkt})});function $kt(e,t){return te(this,null,function*(){let n=D(e,"x","setdiff1d"),r=D(t,"y","setdiff1d");L(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),L(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),L(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);let i=yield n.data(),o=yield r.data(),s=new Set(o),a=0;for(let c=0;c<i.length;c++)s.has(i[c])||a++;let l=new gn([a],n.dtype),u=new gn([a],"int32");for(let c=0,f=0;c<i.length;c++)s.has(i[c])||(l.values[f]=i[c],u.values[f]=c,f++);return[l.toTensor(),u.toTensor()]})}var CIe,_Ie=w(()=>{"use strict";le();J();ae();CIe=$kt});function Pkt(e){let n={x:D(e,"x","sign")};return $.runKernel(ch,n)}var g8,SIe=w(()=>{"use strict";ne();q();J();X();g8=R({sign_:Pkt})});function Lkt(e){let n={x:D(e,"x","sin","float32")};return $.runKernel(lh,n)}var WT,yre=w(()=>{"use strict";ne();q();J();X();WT=R({sin_:Lkt})});function Bkt(e){let n={x:D(e,"x","sinh")};return $.runKernel(uh,n)}var GT,vre=w(()=>{"use strict";ne();q();J();X();GT=R({sinh_:Bkt})});function zkt(e,t,n){let r=D(e,"x","slice1d");return L(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Mt(r,[t],[n])}var qT,EIe=w(()=>{"use strict";J();ae();X();ul();qT=R({slice1d_:zkt})});function Ukt(e,t,n){let r=D(e,"x","slice2d");return L(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Mt(r,t,n)}var kO,AIe=w(()=>{"use strict";J();ae();X();ul();kO=R({slice2d_:Ukt})});function jkt(e,t,n){let r=D(e,"x","slice3d");return L(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Mt(r,t,n)}var HT,TIe=w(()=>{"use strict";J();ae();X();ul();HT=R({slice3d_:jkt})});function Vkt(e,t,n){let r=D(e,"x","slice4d");return L(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Mt(r,t,n)}var X_,kIe=w(()=>{"use strict";J();ae();X();ul();X_=R({slice4d_:Vkt})});function Wkt(e,t=-1){let n=D(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let r={logits:n},i={dim:t};return $.runKernel(Cx,r,i)}var xv,IIe=w(()=>{"use strict";ne();q();J();X();xv=R({softmax_:Wkt})});function Gkt(e){L(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);let t={input:e};return $.runKernel(UC,t)}var bv,x8=w(()=>{"use strict";ne();q();ae();X();bv=R({fft_:Gkt})});function qkt(e){L(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);let t={input:e};return $.runKernel(GC,t)}var Lx,b8=w(()=>{"use strict";ne();q();ae();X();Lx=R({ifft_:qkt})});function Hkt(e){let t=e.shape[e.shape.length-1],n=e.size/t,r;if(t<=2){let i=V(e,[n,t]);r=Lx(i)}else{let i=[n,2*(t-1)],o=V($x(e),[n,t]),s=V(av(e),[n,t]),a=ji(Mt(o,[0,1],[n,t-2]),1),l=j(ji(Mt(s,[0,1],[n,t-2]),1),Pe(-1)),u=En([o,a],1),c=En([s,l],1),f=V(al(u,c),[i[0],i[1]]);r=Lx(f)}if(r=$x(r),e.rank===3&&e.shape[0]!==0){let i=r,o=e.shape[0];r=V(r,[o,r.shape[0]/o,r.shape[1]]),i.dispose()}return r}var YT,wre=w(()=>{"use strict";Zy();dc();gO();ft();X();TO();qe();Px();Tr();ul();b8();YT=R({irfft_:Hkt})});function Ykt(e,t,n=0){let i={x:D(e,"x","split")},o={numOrSizeSplits:t,axis:n};return $.runKernel(wx,i,o)}var Vi,Z_=w(()=>{"use strict";ne();q();J();X();Vi=R({split_:Ykt})});function Kkt(e,t){L(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1],r=e.size/n,i;if(t!=null&&t<n){let m=e.shape.map(g=>0),h=e.shape.map(g=>g);h[e.shape.length-1]=t,i=Mt(e,m,h),n=t}else if(t!=null&&t>n){let m=e.shape.map(h=>h);m[e.shape.length-1]=t-n,i=En([e,ar(m)],e.shape.length-1),n=t}else i=e;let o=lt(i),s=V(al(i,o),[r,n]),a=bv(s),l=Math.floor(n/2)+1,u=$x(a),c=av(a),f=Vi(u,[l,n-l],u.shape.length-1),d=Vi(c,[l,n-l],c.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=l,V(al(f[0],d[0]),p)}var yv,y8=w(()=>{"use strict";ae();Zy();dc();gO();X();TO();qe();ul();Z_();PT();Ar();x8();yv=R({rfft_:Kkt})});function Xkt(e,t){let n=D(e,"a","squaredDifference"),r=D(t,"b","squaredDifference");[n,r]=Qt(n,r),Ft(n.shape,r.shape);let i={a:n,b:r},o={};return $.runKernel(mh,i,o)}var KT,v8=w(()=>{"use strict";ne();q();zr();J();hr();X();KT=R({squaredDifference_:Xkt})});function Zkt(e,t){let n=D(e,"x","squeeze","string_or_numeric");return V(n,Pte(n.shape,t).newShape)}var nu,IO=w(()=>{"use strict";J();ae();X();qe();nu=R({squeeze_:Zkt})});function Qkt(e,t=0){let n=Tx(e,"tensors","stack","string_or_numeric");L(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&L(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let r=n,i={axis:t};return $.runKernel(ux,r,i)}var Ri,vv=w(()=>{"use strict";ne();q();J();ae();X();Ri=R({stack_:Qkt})});function Jkt(e,t=0){let r={x:D(e,"x","step")},i={alpha:t};return $.runKernel(bh,r,i)}var vf,XT=w(()=>{"use strict";ne();q();J();X();vf=R({step_:Jkt})});function eIt(e,t,n,r,i=0,o=0,s=0,a=0,l=0){let c={x:D(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:r,beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:l};return $.runKernel(b_,c,f)}var w8,DIe=w(()=>{"use strict";ne();q();J();X();w8=R({stridedSlice_:eIt})});function tIt(e){let n={x:D(e,"x","tan","float32")};return $.runKernel(gh,n)}var C8,NIe=w(()=>{"use strict";ne();q();J();X();C8=R({tan_:tIt})});function xr(e,t){lc(e);let n=ss(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return xa(e,null,n,t)}var wv=w(()=>{"use strict";J();ae();kx();});function jd(e,t,n){if(lc(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=ss(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return xa(e,t,r,n)}var _8=w(()=>{"use strict";J();ae();kx();});function S8(e,t,n){if(lc(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let r=ss(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return xa(e,t,r,n)}var Cre=w(()=>{"use strict";J();ae();kx();});function FIe(e,t,n){if(lc(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let r=ss(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return xa(e,t,r,n)}var RIe=w(()=>{"use strict";J();ae();kx();});function OIe(e,t,n){if(lc(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let r=ss(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return xa(e,t,r,n)}var MIe=w(()=>{"use strict";J();ae();kx();});function $Ie(e,t,n){if(lc(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let r=ss(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,xa(e,t,r,n)}var PIe=w(()=>{"use strict";J();ae();kx();});var DO={};rn(DO,{calculateShapes:()=>LIe,validateInput:()=>ZT,validateUpdateShape:()=>_re});function _re(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(o+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(o+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(o+` update.rank != ${i+e.length-r}`);for(let s=0;s<i;++s)if(n.shape[s]!==t.shape[s])throw new Error(o+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let s=0;s<n.rank-i;++s)if(n.shape[s+i]!==e[s+r])throw new Error(o+` updates.shape[${s+i}] (${n.shape[s+i]}) != shape[${s+i}] (${e[s+i]})`)}function ZT(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}_re(n,t,e)}function LIe(e,t,n){let r=t.shape.length,i=r>1?t.shape[r-1]:1,o=n.length,s=1;for(let f=i;f<o;++f)s*=n[f];let a=i<1?1:i,l=Zt(t.shape)/a,u=[...Am(n.slice(0,i)),1],c=Zt(n);return{sliceRank:i,numUpdates:l,sliceSize:s,strides:u,outputSize:c}}var NO=w(()=>{"use strict";ae()});function nIt(e,t,n){let r=D(e,"tensor","tensorScatterupdate"),i=D(t,"indices","tensorScatterupdate","int32"),o=D(n,"updates","tensorScatterupdate");if(ZT(o,i,r.shape),r.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${o.dtype}.`);let s={tensor:r,indices:i,updates:o},a={};return $.runKernel(c_,s,a)}var BIe,zIe=w(()=>{"use strict";ne();q();J();X();NO();BIe=R({tensorScatterUpdate_:nIt})});function rIt(e,t=1,n=!0){let r=D(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);let o={x:r},s={k:t,sorted:n},[a,l]=$.runKernel(C_,o,s);return{values:a,indices:l}}var E8,Sre=w(()=>{"use strict";ne();q();J();X();E8=R({topk_:rIt})});function iIt(e,t=0,n=1,r,i){if(Lr(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let o=new Y_(t,n,r,!0,i),s=et(e,r);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}var QT,UIe=w(()=>{"use strict";bo();Nx();X();AO();QT=R({truncatedNormal_:iIt})});function oIt(e,t=0){let n=D(e,"x","unique","string_or_numeric");L(n.rank>0,()=>"The input tensor must be at least 1D");let r={x:n},i={axis:t},[o,s]=$.runKernel(S_,r,i);return{values:o,indices:s}}var A8,Ere=w(()=>{"use strict";ne();q();J();ae();X();A8=R({unique_:oIt})});function sIt(e,t,n){let r=D(e,"x","unsortedSegmentSum"),i=D(t,"segmentIds","unsortedSegmentSum","int32");L(F0(n),()=>"numSegments must be of dtype int");let o={x:r,segmentIds:i},s={numSegments:n};return $.runKernel(Sx,o,s)}var JT,T8=w(()=>{"use strict";ne();q();J();ae();X();JT=R({unsortedSegmentSum_:sIt})});function aIt(e,t=0){let n=D(e,"x","unstack","string_or_numeric");L(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);let r={value:n},i={axis:t};return $.runKernel(_x,r,i)}var fs,ek=w(()=>{"use strict";ne();q();J();ae();X();fs=R({unstack_:aIt})});function jIe(e,t){return vO(e,t,"right")}var VIe=w(()=>{"use strict";Q6();});function k8(e,t=!0,n,r){return $.makeVariable(e,t,n,r)}var WIe=w(()=>{"use strict";ne();});function I8(e,t){let n=[];for(let o=0;o<t.length;o++)t[o]&&n.push(o);let r=et(e,"int32"),i=et([n.length,e.length],"int32");for(let o=0;o<n.length;o++){let s=r.indexToLoc(n[o]),a=o*e.length;i.values.set(s,a)}return i.toTensor()}var Are=w(()=>{"use strict";Nx();});function lIt(e){return te(this,null,function*(){let t=D(e,"condition","whereAsync","bool"),n=yield t.data(),r=I8(t.shape,n);return e!==t&&t.dispose(),r})}var D8,Tre=w(()=>{"use strict";Are();J();D8=lIt});function uIt(e,t,n){return te(this,null,function*(){let r=D(e,"tensor","boolMask"),i=D(t,"mask","boolMask","bool"),o=n??0,s=i.rank,a=r.shape;L(s>0,()=>"mask cannot be scalar"),Sr(a.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let h=o;h<o+s;h++)l*=a[h];let u=a.slice(0,o).concat([l],a.slice(o+s)),c=V(r,u),f=V(i,[-1]),d=yield D8(f),p=nu(d,[1]),m=Dh(c,p,o);return e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),c.dispose(),f.dispose(),d.dispose(),m})}var cIt,GIe=w(()=>{"use strict";J();ae();hO();qe();IO();Tre();cIt=uIt});function fIt(e,t,n){let r=D(e,"x","transpose");if(t==null&&(t=r.shape.map((s,a)=>a).reverse()),L(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(s=>{L(s>=0&&s<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();let i={x:r},o={perm:t};return r.dtype==="complex64"?ee(()=>{let s=$x(r),a=av(r);return s=$.runKernel(Nd,{x:s},o),a=$.runKernel(Nd,{x:a},o),n&&(a=qt(a)),al(s,a)}):$.runKernel(Nd,i,o)}var zt,Bx=w(()=>{"use strict";ne();Jl();q();J();ae();Zy();gO();_o();X();TO();zt=R({transpose_:fIt})});function dIt(e,t,n,r,i=!0){let o=D(e,"v","movingAverage"),s=D(t,"x","movingAverage"),a=D(n,"decay","movingAverage");nne(o,s),L(ha(o.shape,s.shape),()=>"Shape mismatch in v and x");let l=Pe(1),u=De(l,a),c=j(De(s,o),u);if(i){L(r!=null,()=>"When using zeroDebias: true, step is required.");let f=D(r,"step","movingAverage");c=Fe(c,De(l,us(a,f)))}return se(o,c)}var pIt,qIe=w(()=>{"use strict";zr();J();ae();Er();Ln();ft();X();sv();Tr();Yn();pIt=R({movingAverage_:dIt})});function mIt(e,t,n){Lr(n);let r=D(e,"indices","scatterND","int32"),i=D(t,"updates","scatterND");ZT(i,r,n);let o={indices:r,updates:i},s={shape:n};return $.runKernel(u_,o,s)}var hIt,HIe=w(()=>{"use strict";ne();q();J();bo();X();NO();hIt=R({scatterND_:mIt})});function YIe(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let i=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);let s=t.size;if(!(t.rank===0||t.rank===1&&s===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var KIe=w(()=>{"use strict"});function xIt(e,t,n,r=0){Lr(n);let i=D(e,"sparseIndices","sparseToDense","int32"),o=D(t,"sparseValues","sparseToDense","string_or_numeric"),s=D(r,"defaultValue","sparseToDense",o.dtype);YIe(i,o,n,s);let a={sparseIndices:i,sparseValues:o,defaultValue:s},l={outputShape:n};return $.runKernel(g_,a,l)}var bIt,XIe=w(()=>{"use strict";ne();q();KIe();J();bo();X();bIt=R({sparseToDense_:xIt})});function yIt(e,t){let n=D(t,"indices","gatherND","int32"),i={params:D(e,"x","gatherND","string_or_numeric"),indices:n};return $.runKernel(WC,i)}var vIt,ZIe=w(()=>{"use strict";ne();q();J();X();vIt=R({gatherND_:yIt})});function QIe(e,t){if(t==null)return e.shape.slice();if(ha(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}var JIe=w(()=>{"use strict";ae();});function wIt(e,t,n,r){let i=D(e,"x","dropout");if(L(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),L(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Kt?i.clone():i;let o=QIe(i,n),s=1-t,a=Fe(Ih(se(tu(o,0,1,"float32",r),s)),s);return j(i,a)}var kre,eDe=w(()=>{"use strict";le();J();ae();Er();Ln();JIe();z6();ft();X();d8();kre=R({dropout_:wIt})});function Ire(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function FO(e,t,n){let r=1-e%2,i=new Float32Array(e);for(let o=0;o<e;++o){let s=2*Math.PI*o/(e+r-1);i[o]=t-n*Math.cos(s)}return xr(i,"float32")}var RO=w(()=>{"use strict";wv();});function CIt(e,t,n=1){return te(this,null,function*(){let r=D(e,"predictions","inTopK"),i=D(t,"targets","inTopK");L(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),L(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),Sr(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let o=r.shape[r.shape.length-1];L(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);let s=yield r.data(),a=yield i.data(),[l,u]=[s.length/o,o],c=Lte("bool",l);for(let f=0;f<l;f++){let d=f*u,p=s.subarray(d,d+u),m=[];for(let h=0;h<p.length;h++)m.push({value:p[h],index:h});m.sort((h,g)=>g.value-h.value),c[f]=0;for(let h=0;h<n;h++)if(m[h].index===a[f]){c[f]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),as(c,i.shape,"bool")})}var _It,tDe=w(()=>{"use strict";J();ae();rO();_It=CIt});function SIt(e,t,n,r,i,o="NHWC",s){let a=e;e.rank===3&&(a=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=V(t,[1,t.shape[0],t.shape[1],t.shape[2]])),L(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),L(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),L(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];L(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),L(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),ir("conv2dDerFilter",i,s);let f={x:a,dy:l},d={strides:r,pad:i,dataFormat:o,dimRoundingMode:s,filterShape:n};return $.runKernel(IC,f,d)}var tk,N8=w(()=>{"use strict";ne();q();ae();io();X();qe();tk=R({conv2DBackpropFilter_:SIt})});function Q_(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return j(e,vf(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function J_(e,t){let n=t,r=Hn(e.shape,t.shape);return r.length>0&&(n=Me(n,r)),V(n,e.shape)}function eS(e,t,n,r){if(t==="linear")return e;if(t==="relu")return Ho(e);if(t==="elu")return Th(e);if(t==="relu6")return BT(e);if(t==="prelu")return gv(e,n);if(t==="leakyrelu")return lv(e,r);if(t==="sigmoid")return js(e);throw new Error(`Unknown fused activation ${t}.`)}var tS,nk=w(()=>{"use strict";hr();$6();W6();ft();s8();LT();h8();qe();CT();XT();ni();tS=(e,t)=>!(e>0)||t==="linear"});function EIt({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",tS($.state.gradientDepth,l)===!1){L(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let _=cl(e,t,n,r,i,o,s);return a!=null&&(_=se(_,a)),eS(_,l,u,c)}let f=D(e,"x","conv2d","float32"),d=D(t,"filter","conv2d","float32"),p=f,m=!1;f.rank===3&&(m=!0,p=V(f,[1,f.shape[0],f.shape[1],f.shape[2]])),L(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),L(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),ir("fused conv2d",r,s);let h=i==="NHWC"?p.shape[3]:p.shape[1];L(d.shape[2]===h,()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${d.shape[2]}.`),L(Go(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let g=B_(p.shape,d.shape,n,o,r,s),x;a!=null&&(x=D(a,"bias","fused conv2d"),[x]=Qt(x,f),i==="NHWC"?Ft(g.outShape,x.shape):(L(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),L(x.shape.length===0||x.shape[0]===g.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let b;if(u!=null){let _=u.shape;if(L(_.length<=1||_.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${_.length}.`),_.length===1)L(_[0]===1||_[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the number of output channels (${g.outChannels}).`);else if(_.length===3)try{Ft(_,g.outShape)}catch{let E=`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(E)}b=D(u,"prelu weights","fused conv2d")}let y=(_,S)=>{L(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);let[E,T,I,k]=S,O=Q_(_,I,l);L(cc(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);let F=AT(T.shape,O,E,n,r),B=tk(T,O,E.shape,n,r),M=[F,B];if(k!=null){let z=J_(k,O);M.push(z)}return M},v={x:p,filter:d,bias:x,preluActivationWeights:b},C={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return a==null?Ws((S,E,T)=>{let I=$.runKernel(qy,v,C);return T([E,S,I]),m&&(I=V(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:y}})(p,d):Ws((S,E,T,I)=>{let k=$.runKernel(qy,v,C);return I([E,S,k,T]),m&&(k=V(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:y}})(p,d,x)}var nDe,rDe=w(()=>{"use strict";ne();Mx();q();zr();J();ae();Er();hr();z_();N8();E6();io();nk();X();qe();nDe=R({fusedConv2d_:EIt})});function AIt(e,t,n,r,i,o=[1,1],s){let a=e;e.rank===3&&(a=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={x:a,dy:l},c={strides:r,pad:i,dimRoundingMode:s,dilations:o,filterShape:n};return $.runKernel($C,u,c)}var F8,Dre=w(()=>{"use strict";ne();q();X();qe();F8=R({depthwiseConv2dNativeBackpropFilter_:AIt})});function TIt(e,t,n,r,i,o=[1,1],s){let a=t,l=!1;t.rank===3&&(l=!0,a=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u={dy:a,filter:n},c={strides:r,pad:i,dimRoundingMode:s,dilations:o,inputShape:e},f=$.runKernel(PC,u,c);return l?V(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var R8,Nre=w(()=>{"use strict";ne();q();X();qe();R8=R({depthwiseConv2dNativeBackpropInput_:TIt})});function kIt({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(tS($.state.gradientDepth,l)===!1){let C=Ah(e,t,n,r,i,o,s);return a!=null&&(C=se(C,a)),eS(C,l,u,c)}let f=D(e,"x","depthwiseConv2d","float32"),d=D(t,"filter","depthwiseConv2d","float32"),p=f,m=!1;f.rank===3&&(m=!0,p=V(f,[1,f.shape[0],f.shape[1],f.shape[2]])),L(p.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),L(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),L(p.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),o==null&&(o=[1,1]),L(Go(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),ir("fused depthwiseConv2d",r,s);let h=B_(p.shape,d.shape,n,o,r,s,!0),g;a!=null&&(g=D(a,"bias","fused conv2d"),[g]=Qt(g,f),Ft(h.outShape,g.shape));let x;u!=null&&(x=D(u,"prelu weights","fused depthwiseConv2d"));let b=(C,_)=>{L(cc(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);let[S,E,T,I]=_,k=Q_(C,T,l),O=R8(E.shape,k,S,n,r,o,s),F=F8(E,k,S.shape,n,r,o,s);if(I!=null){let B=J_(g,k);return[O,F,B]}return[O,F]},y={x:p,filter:d,bias:g,preluActivationWeights:x},v={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return a==null?Ws((_,S,E)=>{let T=$.runKernel(Hy,y,v);return E([S,_,T]),m&&(T=V(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:b}})(p,d):Ws((_,S,E,T)=>{let I=$.runKernel(Hy,y,v);return T([S,_,I,E]),m&&(I=V(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:b}})(p,d,g)}var iDe,oDe=w(()=>{"use strict";ne();Mx();q();zr();J();ae();Er();hr();io();fO();Dre();Nre();nk();X();qe();iDe=R({fusedDepthwiseConv2d_:kIt})});function IIt({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:a=.2}){if(tS($.state.gradientDepth,o)===!1){let k=Bt(e,t,n,r);return i!=null&&(k=se(k,i)),eS(k,o,s,a)}let l=D(e,"a","fused matMul"),u=D(t,"b","fused matMul");[l,u]=Qt(l,u);let c=n?l.shape[l.rank-2]:l.shape[l.rank-1],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),h=u.shape.slice(0,-2),g=Zt(m),x=Zt(h);L(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);let y=Ft(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([d,p]),v=n?V(l,[g,c,d]):V(l,[g,d,c]),C=r?V(u,[x,p,f]):V(u,[x,f,p]),_;i!=null&&(_=D(i,"bias","fused matMul"),[_]=Qt(_,l),Ft(y,_.shape));let S;s!=null&&(S=D(s,"prelu weights","fused matMul"));let E=(k,O)=>{let[F,B,M,z]=O,W=Q_(V(k,M.shape),M,o),H,Q;if(!n&&!r?(H=Bt(W,B,!1,!0),Q=Bt(F,W,!0,!1)):!n&&r?(H=Bt(W,B,!1,!1),Q=Bt(W,F,!0,!1)):n&&!r?(H=Bt(B,W,!1,!0),Q=Bt(F,W,!1,!1)):(H=Bt(B,W,!0,!0),Q=Bt(W,F,!0,!0)),i!=null){let re=J_(z,W);return[H,Q,re]}else return[H,Q]},T={a:v,b:C,bias:_,preluActivationWeights:S},I={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};return i==null?Ws((O,F,B)=>{let M=$.runKernel(Gy,T,I);return B([O,F,M]),{value:V(M,y),gradFunc:E}})(v,C):Ws((O,F,B,M)=>{let z=$.runKernel(Gy,T,I);return M([O,F,z,B]),{value:V(z,y),gradFunc:E}})(v,C,_)}var sDe,aDe=w(()=>{"use strict";ne();Mx();q();zr();J();ae();Er();hr();nk();$d();X();qe();sDe=R({fusedMatMul_:IIt})});var Cv={};rn(Cv,{conv2d:()=>nDe,depthwiseConv2d:()=>iDe,matMul:()=>sDe});var lDe=w(()=>{"use strict";rDe();oDe();aDe();});function DIt(e){return FO(e,.54,.46)}var uDe,cDe=w(()=>{"use strict";X();RO();uDe=R({hammingWindow_:DIt})});function NIt(e){return FO(e,.5,.5)}var O8,Fre=w(()=>{"use strict";X();RO();O8=R({hannWindow_:NIt})});function FIt(e,t,n,r=!1,i=0){let o=0,s=[];for(;o+t<=e.size;)s.push(Mt(e,o,t)),o+=n;if(r)for(;o<e.size;){let a=o+t-e.size,l=En([Mt(e,o,t-a),bf([a],i)]);s.push(l),o+=n}return s.length===0?jd([],[0,t]):V(En(s),[s.length,t])}var M8,Rre=w(()=>{"use strict";dc();ST();X();qe();ul();_8();M8=R({frame_:FIt})});function RIt(e,t,n,r,i=O8){r==null&&(r=Ire(t));let o=M8(e,t,n),s=j(o,i(t));return yv(s,r)}var fDe,dDe=w(()=>{"use strict";ft();X();RO();y8();Rre();Fre();fDe=R({stft_:RIt})});function OIt(e,t,n,r,i="bilinear",o=0){let s=D(e,"image","cropAndResize"),a=D(t,"boxes","cropAndResize","float32"),l=D(n,"boxInd","cropAndResize","int32"),u=a.shape[0];L(s.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),L(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),L(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),L(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),L(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),L(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);let c={image:s,boxes:a,boxInd:l},f={method:i,extrapolationValue:o,cropSize:r};return $.runKernel(RC,c,f)}var pDe,mDe=w(()=>{"use strict";ne();q();J();ae();X();pDe=R({cropAndResize_:OIt})});function MIt(e){let t=D(e,"image","flipLeftRight","float32");L(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let n={image:t};return $.runKernel(VC,n,{})}var hDe,gDe=w(()=>{"use strict";ne();q();J();ae();X();hDe=R({flipLeftRight_:MIt})});function $It(e){let t=D(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];L(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),L(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,qo(t,i)}var xDe,bDe=w(()=>{"use strict";J();ae();X();RT();xDe=R({grayscaleToRGB_:$It})});function PIt(e){let t=D(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];L(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),L(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);let i=t.dtype,o=de(t,"float32"),s=xr([.2989,.587,.114]),a;switch(t.rank){case 2:a=ov("ij,j->i",o,s);break;case 3:a=ov("ijk,k->ij",o,s);break;case 4:a=ov("ijkl,l->ijk",o,s);break;case 5:a=ov("ijklm,m->ijkl",o,s);break;case 6:a=ov("ijklmn,n->ijklm",o,s);break;default:throw new Error("Not a valid tensor rank.")}return a=ri(a,-1),de(a,i)}var yDe,vDe=w(()=>{"use strict";J();ae();sn();Vne();FT();X();wv();yDe=R({rgbToGrayscale_:PIt})});function LIt(e,t,n=0,r=.5){let i=D(e,"image","rotateWithOffset","float32");L(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);let o={image:i},s={radians:t,fillValue:n,center:r};return $.runKernel(E_,o,s)}var wDe,CDe=w(()=>{"use strict";ne();q();J();ae();X();wDe=R({rotateWithOffset_:LIt})});function wf(e,t,n,r,i,o){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),o==null&&(o=0);let s=e.shape[0];return n=Math.min(n,s),L(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),L(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),L(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),L(t.rank===1,()=>"scores must be a 1D tensor"),L(t.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`),L(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var nS=w(()=>{"use strict";ae();});function BIt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){let o=D(e,"boxes","nonMaxSuppression","float32"),s=D(t,"scores","nonMaxSuppression","float32"),a=wf(o,s,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;let l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return $.runKernel(JC,{boxes:o,scores:s},l)}var _De,SDe=w(()=>{"use strict";ne();q();J();nS();X();_De=R({nonMaxSuppression_:BIt})});function EDe(e,t,n){let r=zIt(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function zIt(e,t,n){return jIt(e,t,n||UIt)}function UIt(e,t){return e>t?1:e<t?-1:0}function jIt(e,t,n){let r=0,i=e.length,o=0,s=!1;for(;r<i;){o=r+(i-r>>>1);let a=n(t,e[o]);a>0?r=o+1:(i=o,s=!a)}return s?r:-r-1}var ADe=w(()=>{"use strict";});function $8(e,t,n,r,i){return Ore(e,t,n,r,i,0)}function P8(e,t,n,r,i,o){return Ore(e,t,n,r,i,0,!1,o,!0)}function L8(e,t,n,r,i,o){return Ore(e,t,n,r,i,o,!0)}function Ore(e,t,n,r,i,o,s=!1,a=!1,l=!1){let u=[];for(let g=0;g<t.length;g++)t[g]>i&&u.push({score:t[g],boxIndex:g,suppressBeginIndex:0});u.sort(TDe);let c=o>0?-.5/o:0,f=[],d=[];for(;f.length<n&&u.length>0;){let g=u.pop(),{score:x,boxIndex:b,suppressBeginIndex:y}=g;if(x<i)break;let v=!1;for(let C=f.length-1;C>=y;--C){let _=VIt(e,b,f[C]);if(_>=r){v=!0;break}if(g.score=g.score*WIt(r,c,_),g.score<=i)break}g.suppressBeginIndex=f.length,v||(g.score===x?(f.push(b),d.push(g.score)):g.score>i&&EDe(u,g,TDe))}let p=f.length,m=n-p;a&&m>0&&(f.push(...new Array(m).fill(0)),d.push(...new Array(m).fill(0)));let h={selectedIndices:f};return s&&(h.selectedScores=d),l&&(h.validOutputs=p),h}function VIt(e,t,n){let r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),p=(a-o)*(l-s),m=(f-u)*(d-c);if(p<=0||m<=0)return 0;let h=Math.max(o,u),g=Math.max(s,c),x=Math.min(a,f),b=Math.min(l,d),y=Math.max(x-h,0)*Math.max(b-g,0);return y/(p+m-y)}function WIt(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function TDe(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}var OO=w(()=>{"use strict";ADe();});function GIt(o,s,a){return te(this,arguments,function*(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){let l=D(e,"boxes","nonMaxSuppressionAsync"),u=D(t,"scores","nonMaxSuppressionAsync"),c=wf(l,u,n,r,i);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold;let f=yield Promise.all([l.data(),u.data()]),d=f[0],p=f[1],{selectedIndices:m}=$8(d,p,n,r,i);return l!==e&&l.dispose(),u!==t&&u.dispose(),xr(m,"int32")})}var kDe,IDe=w(()=>{"use strict";OO();J();nS();wv();kDe=GIt});function qIt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){let s=D(e,"boxes","nonMaxSuppression"),a=D(t,"scores","nonMaxSuppression"),l=wf(s,a,n,r,i,o);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma;let u={boxes:s,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o},f=$.runKernel(t_,u,c);return{selectedIndices:f[0],selectedScores:f[1]}}var DDe,NDe=w(()=>{"use strict";ne();q();J();nS();X();DDe=R({nonMaxSuppressionWithScore_:qIt})});function HIt(s,a,l){return te(this,arguments,function*(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){let u=D(e,"boxes","nonMaxSuppressionAsync"),c=D(t,"scores","nonMaxSuppressionAsync"),f=wf(u,c,n,r,i,o);n=f.maxOutputSize,r=f.iouThreshold,i=f.scoreThreshold,o=f.softNmsSigma;let d=yield Promise.all([u.data(),c.data()]),p=d[0],m=d[1],{selectedIndices:h,selectedScores:g}=L8(p,m,n,r,i,o);return u!==e&&u.dispose(),c!==t&&c.dispose(),{selectedIndices:xr(h,"int32"),selectedScores:xr(g)}})}var FDe,RDe=w(()=>{"use strict";OO();J();nS();wv();FDe=HIt});function YIt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){let s=D(e,"boxes","nonMaxSuppression"),a=D(t,"scores","nonMaxSuppression"),l=wf(s,a,n,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,d={boxes:s,scores:a},p={maxOutputSize:u,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:o},m=$.runKernel(e_,d,p);return{selectedIndices:m[0],validOutputs:m[1]}}var ODe,MDe=w(()=>{"use strict";ne();q();J();nS();X();ODe=R({nonMaxSuppressionPadded_:YIt})});function KIt(s,a,l){return te(this,arguments,function*(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){let u=D(e,"boxes","nonMaxSuppressionAsync"),c=D(t,"scores","nonMaxSuppressionAsync"),f=wf(u,c,n,r,i,null),d=f.maxOutputSize,p=f.iouThreshold,m=f.scoreThreshold,[h,g]=yield Promise.all([u.data(),c.data()]),{selectedIndices:x,validOutputs:b}=P8(h,g,d,p,m,o);return u!==e&&u.dispose(),c!==t&&c.dispose(),{selectedIndices:xr(x,"int32"),validOutputs:Pe(b,"int32")}})}var $De,PDe=w(()=>{"use strict";OO();J();nS();Tr();wv();$De=KIt});function XIt(e,t,n=!1,r=!1){let i=D(e,"images","resizeBilinear");L(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),L(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),L(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=i,s=!1;i.rank===3&&(s=!0,o=V(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let[]=t,a={images:o},l={alignCorners:n,halfPixelCenters:r,size:t},u=$.runKernel(hx,a,l);return s?V(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var B8,Mre=w(()=>{"use strict";ne();q();J();ae();X();qe();B8=R({resizeBilinear_:XIt})});function ZIt(e,t,n=!1,r=!1){let i=D(e,"images","resizeNearestNeighbor");L(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),L(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),L(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),L(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=i,s=!1;i.rank===3&&(s=!0,o=V(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let[]=t,a={images:o},l={alignCorners:n,halfPixelCenters:r,size:t},u=$.runKernel(mx,a,l);return s?V(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var z8,$re=w(()=>{"use strict";ne();q();J();ae();X();qe();z8=R({resizeNearestNeighbor_:ZIt})});function QIt(e,t="binary",n=!1,r=.5){let i=D(e,"image","threshold"),o=.2989,s=.587,a=.114,l=i.shape[0]*i.shape[1],u=j(xr([r]),255),c,f,d,p;if(L(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),L(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),L(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),L(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[c,f,d]=Vi(i,[1,1,1],-1);let g=j(c,o),x=j(f,s),b=j(d,a);p=se(se(g,x),b)}else p=e;if(t==="otsu"){let g=b6(de(zT(p),"int32"),as([]),256);u=JIt(g,l)}let m=n?eu(p,u):Ur(p,u);return de(j(m,255),"int32")}function JIt(e,t){let n=xr([-1]),r=xr([0]),i=xr([0]),o,s,a,l,u,c;for(let f=0;f<e.size-1;f++){o=Mt(e,0,f+1),s=Mt(e,f+1),u=Fe(Me(o),t),c=Fe(Me(s),t);let d=Me(j(o,Rh(0,o.size)));a=Fe(d,Me(o));let p=bf(s.shape,o.size),m=se(Rh(0,s.size),p),h=j(s,m);l=Fe(Me(h),Me(s));let g=De(a,l),x=De(a,l),b=j(u,c);i=j(j(b,g),x);let y=Ur(i,r);r=or(y,i,r),n=or(y,xr([f]),n)}return n}var LDe,BDe=w(()=>{"use strict";wv();X();sn();Z_();One();uv();Nh();ni();Er();ft();Ln();Yn();hre();pc();ST();ul();p8();rO();ae();J();LDe=R({threshold_:QIt})});function eDt(e,t,n="nearest",r="constant",i=0,o){let s=D(e,"image","transform","float32"),a=D(t,"transforms","transform","float32");L(s.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),L(a.rank===2&&(a.shape[0]===s.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),L(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);let l={image:s,transforms:a},u={interpolation:n,fillMode:r,fillValue:i,outputShape:o};return $.runKernel(__,l,u)}var zDe,UDe=w(()=>{"use strict";ne();q();J();ae();X();zDe=R({transform_:eDt})});function tDt(e,t,n){let r=D(e,"a","bandPart");L(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let i=r.shape,[o,s]=r.shape.slice(-2),a,l;typeof t=="number"?(L(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),L(t<=o,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${o}).`),a=D(t<0?o:t,"numLower","bandPart")):(L(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=or(Ox(t,0),o,mc(t,o))),typeof n=="number"?(L(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),L(n<=s,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`),l=D(n<0?s:n,"numUpper","bandPart")):(L(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=or(Ox(n,0),s,mc(n,s)));let u=V(Rh(0,o,1,"int32"),[-1,1]),c=Rh(0,s,1,"int32"),f=De(u,c),d=cs(eu(f,a),ba(f,qt(l))),p=ar([o,s],r.dtype);return V(Ri(fs(V(r,[-1,o,s])).map(m=>or(d,m,p))),i)}var jDe,VDe=w(()=>{"use strict";J();ae();V_();xO();uv();W_();_O();_o();X();p8();qe();vv();Yn();ek();pc();PT();jDe=R({bandPart_:tDt})});function nDt(e){let t;if(Array.isArray(e)){t=!1,L(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let i=e[0].shape[0];for(let o=1;o<e.length;++o)L(e[o].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[o].shape[0]} vs. ${i})`)}else t=!0,e=Vi(e,e.shape[0],0).map(i=>nu(i,[0]));L(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let n=[],r=e;for(let i=0;i<e.length;++i)n.push($.tidy(()=>{let o=r[i];if(i>0)for(let s=0;s<i;++s){let a=j(Me(j(n[s],o)),n[s]);o=De(o,a)}return Fe(o,Rx(o,"euclidean"))}));return t?Ri(n,0):n}var WDe,GDe=w(()=>{"use strict";ne();ae();Ln();ft();mO();X();Z_();IO();vv();Yn();ni();WDe=R({gramSchmidt_:nDt})});function rDt(e,t=!1){if(L(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return qDe(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((l,u)=>l*u),r=fs(V(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],o=[];r.forEach(l=>{let[u,c]=qDe(l,t);i.push(u),o.push(c)});let s=V(Ri(i,0),e.shape),a=V(Ri(o,0),e.shape);return[s,a]}}function qDe(e,t=!1){return $.tidy(()=>{L(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],i=j_(n),o=ll(e),s=jd([[1]],[1,1]),a=ll(s),l=n>=r?r:n;for(let u=0;u<l;++u){let c=o,f=a,d=i;[a,o,i]=$.tidy(()=>{let p=Mt(o,[u,u],[n-u,1]),m=Rx(p),h=Mt(o,[u,u],[1,1]),g=or(Ur(h,0),jd([[-1]]),jd([[1]])),x=De(h,j(g,m)),b=Fe(p,x);b.shape[0]===1?a=ll(s):a=En([s,Mt(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);let y=qt(Fe(Bt(g,x),m)),v=Mt(o,[u,0],[n-u,r]),C=j(y,a),_=zt(a);if(u===0)o=De(v,Bt(C,Bt(_,v)));else{let T=De(v,Bt(C,Bt(_,v)));o=En([Mt(o,[0,0],[u,r]),T],0)}let S=zt(C),E=Mt(i,[0,u],[n,i.shape[1]-u]);if(u===0)i=De(E,Bt(Bt(E,a),S));else{let T=De(E,Bt(Bt(E,a),S));i=En([Mt(i,[0,0],[n,u]),T],1)}return[a,o,i]}),_t([c,f,d])}return!t&&n>r&&(i=Mt(i,[0,0],[n,r]),o=Mt(o,[0,0],[r,r])),[i,o]})}var HDe,YDe=w(()=>{"use strict";ne();Jl();ae();bT();dc();Ln();Kne();Nh();$d();ft();_o();mO();X();qe();ul();vv();Yn();_8();Bx();ek();pc();HDe=R({qr_:rDt})});var ii,Vd=w(()=>{"use strict";ii=function(e){return e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS",e}(ii||{})});function iDt(e,t,n=ii.SUM_BY_NONZERO_WEIGHTS){let r=D(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=D(t,"weights","computeWeightedLoss"));let o=i==null?r:j(r,i);if(n===ii.NONE)return o;if(n===ii.SUM)return Me(o);if(n===ii.MEAN){if(i==null)return sr(o);{let s=r.size/i.size,a=Fe(Me(o),Me(i));return s>1?Fe(a,Pe(s)):a}}if(n===ii.SUM_BY_NONZERO_WEIGHTS){if(i==null)return Fe(Me(o),Pe(r.size));{let s=j(i,vi(r.shape)),a=de(Me(Ud(s,Pe(0))),"float32");return Fe(Me(o),a)}}throw Error(`Unknown reduction: ${n}`)}var ds,Oh=w(()=>{"use strict";J();sn();Ln();Vd();CO();ft();r8();G_();X();Tr();ni();ds=R({computeWeightedLoss_:iDt})});function oDt(e,t,n,r=ii.SUM_BY_NONZERO_WEIGHTS){let i=D(e,"labels","absoluteDifference"),o=D(t,"predictions","absoluteDifference"),s=null;n!=null&&(s=D(n,"weights","absoluteDifference")),Sr(i.shape,o.shape,"Error in absoluteDifference: ");let a=mr(De(i,o));return ds(a,s,r)}var KDe,XDe=w(()=>{"use strict";J();ae();P_();Vd();X();Yn();Oh();KDe=R({absoluteDifference_:oDt})});function sDt(e,t,n,r,i=ii.SUM_BY_NONZERO_WEIGHTS){let o=D(e,"labels","cosineDistance"),s=D(t,"predictions","cosineDistance"),a=null;r!=null&&(a=D(r,"weights","cosineDistance")),Sr(o.shape,s.shape,"Error in cosineDistance: ");let l=Pe(1),u=De(l,Me(j(o,s),n,!0));return ds(u,a,i)}var ZDe,QDe=w(()=>{"use strict";J();ae();Vd();ft();X();Tr();Yn();ni();Oh();ZDe=R({cosineDistance_:sDt})});function aDt(e,t,n,r=ii.SUM_BY_NONZERO_WEIGHTS){let i=D(e,"labels","hingeLoss"),o=D(t,"predictions","hingeLoss"),s=null;n!=null&&(s=D(n,"weights","hingeLoss")),Sr(i.shape,o.shape,"Error in hingeLoss: ");let a=Pe(1);i=De(j(Pe(2),i),a);let l=Ho(De(a,j(i,o)));return ds(l,s,r)}var JDe,eNe=w(()=>{"use strict";J();ae();Vd();ft();X();LT();Tr();Yn();Oh();JDe=R({hingeLoss_:aDt})});function lDt(e,t,n,r=1,i=ii.SUM_BY_NONZERO_WEIGHTS){let o=D(e,"labels","huberLoss"),s=D(t,"predictions","huberLoss"),a=null;n!=null&&(a=D(n,"weights","huberLoss")),Sr(o.shape,s.shape,"Error in huberLoss: ");let l=Pe(r),u=mr(De(s,o)),c=mc(u,l),f=De(u,c),d=se(j(Pe(.5),jt(c)),j(l,f));return ds(d,a,i)}var tNe,nNe=w(()=>{"use strict";J();ae();P_();Er();Vd();_O();ft();X();Tr();Ui();Yn();Oh();tNe=R({huberLoss_:lDt})});function uDt(e,t,n,r=1e-7,i=ii.SUM_BY_NONZERO_WEIGHTS){let o=D(e,"labels","logLoss"),s=D(t,"predictions","logLoss"),a=null;n!=null&&(a=D(n,"weights","logLoss")),Sr(o.shape,s.shape,"Error in logLoss: ");let l=Pe(1),u=Pe(r),c=qt(j(o,Co(se(s,u)))),f=j(De(l,o),Co(se(De(l,s),u))),d=De(c,f);return ds(d,a,i)}var rNe,iNe=w(()=>{"use strict";J();ae();Er();OT();Vd();ft();_o();X();Tr();Yn();Oh();rNe=R({logLoss_:uDt})});function cDt(e,t,n,r=ii.SUM_BY_NONZERO_WEIGHTS){let i=D(e,"labels","meanSquaredError"),o=D(t,"predictions","meanSquaredError"),s=null;n!=null&&(s=D(n,"weights","meanSquaredError")),Sr(i.shape,o.shape,"Error in meanSquaredError: ");let a=KT(i,o);return ds(a,s,r)}var oNe,sNe=w(()=>{"use strict";J();ae();Vd();X();v8();Oh();oNe=R({meanSquaredError_:cDt})});function fDt(e,t){let n=D(e,"labels","sigmoidCrossEntropyWithLogits"),r=D(t,"logits","sigmoidCrossEntropyWithLogits");Sr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let i=Ho(r),o=j(r,n),s=cv(Jr(qt(mr(r))));return se(De(i,o),s)}function dDt(e,t,n,r=0,i=ii.SUM_BY_NONZERO_WEIGHTS){let o=D(e,"multiClassLabels","sigmoidCrossEntropy"),s=D(t,"logits","sigmoidCrossEntropy"),a=null;if(n!=null&&(a=D(n,"weights","sigmoidCrossEntropy")),Sr(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){let u=Pe(r),c=Pe(1),f=Pe(.5);o=se(j(o,De(c,u)),j(f,u))}let l=fDt(o,s);return ds(l,a,i)}var aNe,lNe=w(()=>{"use strict";J();ae();P_();Er();kh();Zne();Vd();ft();_o();X();LT();Tr();Yn();Oh();aNe=R({sigmoidCrossEntropy_:dDt})});function pDt(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Ws((i,o,s)=>{let l=fv(o,[n],!0),u=De(de(o,"float32"),l);s([i,u]);let c=qt(j(u,i));return{value:Me(c,[n]),gradFunc:(p,m)=>{let[h,g]=m,x=yf(p.shape,[n]);return[j(V(p,x),De(de(h,"float32"),Jr(g))),j(V(p,x),De(Jr(g),de(h,"float32")))]}}})(e,t)}function mDt(e,t,n,r=0,i=ii.SUM_BY_NONZERO_WEIGHTS){let o=D(e,"onehotLabels","softmaxCrossEntropy"),s=D(t,"logits","softmaxCrossEntropy"),a=null;if(n!=null&&(a=D(n,"weights","softmaxCrossEntropy")),Sr(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){let u=Pe(r),c=Pe(1),f=Pe(o.shape[1]);o=se(j(o,De(c,u)),Fe(u,f))}let l=pDt(o,s);return ds(l,a,i)}var uNe,cNe=w(()=>{"use strict";Mx();J();ae();Er();Ld();sn();Ln();kh();Y6();Vd();ft();_o();X();qe();Tr();Yn();ni();Oh();uNe=R({softmaxCrossEntropy_:mDt})});function hDt(e,t,n,r){let i=D(e,"indices","sparseFillEmptyRows","int32"),o=D(t,"values","sparseFillEmptyRows"),s=D(n,"denseShape","sparseFillEmptyRows","int32"),a=D(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(s.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);let l={indices:i,values:o,denseShape:s,defaultValue:a},u=$.runKernel(d_,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}var fNe,dNe=w(()=>{"use strict";ne();q();J();X();fNe=R({sparseFillEmptyRows_:hDt})});function gDt(e,t,n){let r=D(e,"inputIndices","sparseReshape","int32"),i=D(t,"inputShape","sparseReshape","int32"),o=D(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);let s={inputIndices:r,inputShape:i,newShape:o},a=$.runKernel(p_,s);return{outputIndices:a[0],outputShape:a[1]}}var pNe,mNe=w(()=>{"use strict";ne();q();J();X();pNe=R({sparseReshape_:gDt})});function xDt(e,t,n){let r=D(e,"data","sparseSegmentMean"),i=D(t,"indices","sparseSegmentMean","int32"),o=D(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);let s={data:r,indices:i,segmentIds:o};return $.runKernel(m_,s)}var hNe,gNe=w(()=>{"use strict";ne();q();J();X();hNe=R({sparseSegmentMean_:xDt})});function bDt(e,t,n){let r=D(e,"data","sparseSegmentSum"),i=D(t,"indices","sparseSegmentSum","int32"),o=D(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);let s={data:r,indices:i,segmentIds:o};return $.runKernel(h_,s)}var xNe,bNe=w(()=>{"use strict";ne();q();J();X();xNe=R({sparseSegmentSum_:bDt})});function yDt(e,t,n,r,i,o,s,a){let l=D(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);let u=D(t,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let c={separator:n,nGramWidths:r,leftPad:i,rightPad:o,padWidth:s,preserveShortSequences:a},f={data:l,dataSplits:u},d=$.runKernel(y_,f,c);return{nGrams:d[0],nGramsSplits:d[1]}}var yNe,vNe=w(()=>{"use strict";ne();q();J();X();yNe=R({stringNGrams_:yDt})});function vDt(e,t,n=!0){let r=D(e,"input","stringSplit","string"),i=D(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);let o={skipEmpty:n},s={input:r,delimiter:i},a=$.runKernel(v_,s,o);return{indices:a[0],values:a[1],shape:a[2]}}var wNe,CNe=w(()=>{"use strict";ne();q();J();X();wNe=R({stringSplit_:vDt})});function wDt(e,t){let n=D(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let i={input:n};return $.runKernel(w_,i,r)}var _Ne,SNe=w(()=>{"use strict";ne();q();J();X();_Ne=R({stringToHashBucketFast_:wDt})});function CDt(e,t,n,r=!0){let i=D(e,"input","staticRegexReplace","string"),o={pattern:t,rewrite:n,replaceGlobal:r};return $.runKernel(Wy,{x:i},o)}var ENe,ANe=w(()=>{"use strict";ne();q();J();X();ENe=R({staticRegexReplace_:CDt})});var _Dt,SDt,pl,Pre,EDt,ADt,TDt,kt=w(()=>{"use strict";P_();mTe();hTe();Er();xTe();Ene();Ane();Tne();kne();bTe();yTe();vTe();Ine();wTe();p6();STe();ATe();uO();_T();ITe();DTe();NTe();One();RTe();MTe();y6();Nx();sn();$Te();PTe();bT();Zy();dc();LTe();BTe();zTe();UTe();Mne();z_();$ne();jTe();VTe();I6();Lne();D6();N6();WTe();Bne();fO();qTe();zne();Ln();Une();jne();Vne();$6();KTe();dO();XTe();Yne();kh();FT();JTe();Kne();ST();z6();i6();hO();Nh();V_();gO();eke();tke();nke();W6();xO();uv();ike();Xne();OT();Zne();uke();cke();Y6();W_();yO();K6();Jne();dke();$d();NT();J6();pke();hke();wO();CO();xke();P6();_O();ere();tre();bke();ft();vke();Cke();_o();r8();i8();G_();_ke();Eke();mv();Tke();Ike();Nke();Rke();nre();sv();s8();Sne();rre();Mke();Pke();Bke();Uke();lIe();mre();cIe();d8();dIe();p8();TO();pIe();LT();h8();qe();Px();hIe();xIe();yIe();wIe();hre();gre();Tr();xre();bre();_Ie();CT();SIe();yre();vre();ul();EIe();AIe();TIe();kIe();IIe();Qne();SO();x8();b8();wre();y8();Z_();Bd();Ui();v8();IO();vv();XT();DIe();Yn();ni();NIe();Rne();rO();wv();_8();Cre();RIe();MIe();PIe();zIe();RT();Sre();UIe();Ere();T8();ek();VIe();WIe();pc();Tre();PT();Ar();GIe();Bx();mO();qIe();HIe();Q6();XIe();ZIe();eDe();RO();tDe();X();y8();x8();b8();wre();lDe();cDe();Fre();Rre();dDe();mDe();gDe();bDe();vDe();CDe();SDe();IDe();NDe();RDe();MDe();PDe();Mre();$re();BDe();UDe();VDe();GDe();YDe();XDe();Oh();QDe();eNe();nNe();iNe();sNe();lNe();cNe();dNe();mNe();gNe();bNe();vNe();CNe();SNe();ANe();_Dt={fft:bv,ifft:Lx,rfft:yv,irfft:YT},SDt={hammingWindow:uDe,hannWindow:O8,frame:M8,stft:fDe},pl={flipLeftRight:hDe,grayscaleToRGB:xDe,resizeNearestNeighbor:z8,resizeBilinear:B8,rgbToGrayscale:yDe,rotateWithOffset:wDe,cropAndResize:pDe,nonMaxSuppression:_De,nonMaxSuppressionAsync:kDe,nonMaxSuppressionWithScore:DDe,nonMaxSuppressionWithScoreAsync:FDe,nonMaxSuppressionPadded:ODe,nonMaxSuppressionPaddedAsync:$De,threshold:LDe,transform:zDe},Pre={bandPart:jDe,gramSchmidt:WDe,qr:HDe},EDt={absoluteDifference:KDe,computeWeightedLoss:ds,cosineDistance:ZDe,hingeLoss:JDe,huberLoss:tNe,logLoss:rNe,meanSquaredError:oNe,sigmoidCrossEntropy:aNe,softmaxCrossEntropy:uNe},ADt={sparseFillEmptyRows:fNe,sparseReshape:pNe,sparseSegmentMean:hNe,sparseSegmentSum:xNe},TDt={stringNGrams:yNe,stringSplit:wNe,stringToHashBucketFast:_Ne,staticRegexReplace:ENe}});var fe={};rn(fe,{Serializable:()=>MO,SerializationMap:()=>U8,getRegisteredName:()=>IDt,registerClass:()=>Bre});function Bre(e,t,n){L(e.className!=null,()=>"Class being registered does not have the static className property defined."),L(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),L(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);let r=n,i=t+">"+r;return U8.register(e),kDt.set(i,e),Lre.set(e,i),e}function IDt(e){return Lre.has(e)?Lre.get(e):e.className}var kDt,Lre,MO,U8,j8=w(()=>{"use strict";ae();kDt=new Map,Lre=new Map,MO=class{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}},U8=class e{constructor(){this.classNameMap={}}static getMap(){return e.instance==null&&(e.instance=new e),e.instance}static register(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}});var Yo,_v=w(()=>{"use strict";Jl();Mx();kt();j8();Yo=class extends MO{minimize(t,n=!1,r){let{value:i,grads:o}=this.computeGradients(t,r);if(r!=null){let s=r.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(s)}else this.applyGradients(o);return _t(o),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return bO(t,n)}dispose(){this.iterations_!=null&&_t(this.iterations_)}saveIterations(){return te(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Pe(this.iterations_,"int32")}})}getWeights(){return te(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(t){return te(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(t){return te(this,null,function*(){return this.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})}};Object.defineProperty(Yo,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null})});var Sv,V8=w(()=>{"use strict";ne();Jl();Er();Ln();ft();kt();Ui();Ar();_v();Sv=class extends Yo{static get className(){return"Adadelta"}constructor(t,n,r=null){super(),this.learningRate=t,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=$.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{let o=$.registeredVariables[r],s=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:ee(()=>lt(o).variable(s))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:ee(()=>lt(o).variable(s))});let a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;let l=this.accumulatedGrads[i].variable,u=this.accumulatedUpdates[i].variable;ee(()=>{let c=se(j(l,this.rho),j(jt(a),1-this.rho)),f=j(Fe(Bn(se(u,this.epsilon)),Bn(se(l,this.epsilon))),a),d=se(j(u,this.rho),j(jt(f),1-this.rho));l.assign(c),u.assign(d);let p=se(j(f,-this.learningRate),o);o.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(_t(this.accumulatedGrads.map(t=>t.variable)),_t(this.accumulatedUpdates.map(t=>t.variable)))}getWeights(){return te(this,null,function*(){let t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return te(this,null,function*(){t=yield this.extractIterations(t);let n=t.length/2,r=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}});var Ev,W8=w(()=>{"use strict";ne();Jl();Er();Ln();ST();ft();Bd();Ui();_v();Ev=class extends Yo{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{let o=$.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:ee(()=>bf(o.shape,this.initialAccumulatorValue).variable(!1))});let s=Array.isArray(t)?t[i].tensor:t[r];if(s==null)return;let a=this.accumulatedGrads[i].variable;ee(()=>{let l=se(a,jt(s));a.assign(l);let u=se(j(Fe(s,Bn(se(l,$.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&_t(this.accumulatedGrads.map(t=>t.variable))}getWeights(){return te(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))})}setWeights(t){return te(this,null,function*(){t=yield this.extractIterations(t);let n=!1;this.accumulatedGrads=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}});var Av,G8=w(()=>{"use strict";ne();Jl();Er();Ln();ft();sv();Tr();Bd();Ui();Yn();Ar();_v();Av=class extends Yo{static get className(){return"Adam"}constructor(t,n,r,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ee(()=>{this.accBeta1=Pe(n).variable(),this.accBeta2=Pe(r).variable()}),i==null&&(this.epsilon=$.backend.epsilon())}applyGradients(t){let n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);ee(()=>{let r=De(1,this.accBeta1),i=De(1,this.accBeta2);n.forEach((o,s)=>{let a=$.registeredVariables[o],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${o}/m`,variable:ee(()=>lt(a).variable(l))}),this.accumulatedSecondMoment[s]==null&&(this.accumulatedSecondMoment[s]={originalName:`${o}/v`,variable:ee(()=>lt(a).variable(l))});let u=Array.isArray(t)?t[s].tensor:t[o];if(u==null)return;let c=this.accumulatedFirstMoment[s].variable,f=this.accumulatedSecondMoment[s].variable,d=se(j(c,this.beta1),j(u,1-this.beta1)),p=se(j(f,this.beta2),j(jt(u),1-this.beta2)),m=Fe(d,r),h=Fe(p,i);c.assign(d),f.assign(p);let g=se(j(Fe(m,se(Bn(h),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(j(this.accBeta1,this.beta1)),this.accBeta2.assign(j(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&_t(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&_t(this.accumulatedSecondMoment.map(t=>t.variable))}getWeights(){return te(this,null,function*(){let t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return te(this,null,function*(){t=yield this.extractIterations(t),ee(()=>{this.accBeta1.assign(us(this.beta1,this.iterations_+1)),this.accBeta2.assign(us(this.beta2,this.iterations_+1))});let n=t.length/2,r=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}});var Tv,q8=w(()=>{"use strict";ne();Jl();P_();Er();Ln();wO();ft();Tr();Yn();Ar();_v();Tv=class extends Yo{static get className(){return"Adamax"}constructor(t,n,r,i=null,o=0){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ee(()=>{this.iteration=Pe(0).variable(),this.accBeta1=Pe(n).variable()}),i==null&&(this.epsilon=$.backend.epsilon())}applyGradients(t){let n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);ee(()=>{let r=De(1,this.accBeta1),i=Fe(-this.learningRate,se(j(this.iteration,this.decay),1));n.forEach((o,s)=>{let a=$.registeredVariables[o],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${o}/m`,variable:lt(a).variable(l)}),this.accumulatedWeightedInfNorm[s]==null&&(this.accumulatedWeightedInfNorm[s]={originalName:`${o}/v`,variable:lt(a).variable(l)});let u=Array.isArray(t)?t[s].tensor:t[o];if(u==null)return;let c=this.accumulatedFirstMoment[s].variable,f=this.accumulatedWeightedInfNorm[s].variable,d=se(j(c,this.beta1),j(u,1-this.beta1)),p=j(f,this.beta2),m=mr(u),h=dl(p,m);c.assign(d),f.assign(h);let g=se(j(Fe(i,r),Fe(d,se(h,this.epsilon))),a);a.assign(g)}),this.iteration.assign(se(this.iteration,1)),this.accBeta1.assign(j(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&_t(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&_t(this.accumulatedWeightedInfNorm.map(t=>t.variable))}getWeights(){return te(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(t){return te(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}});var Mh,$O=w(()=>{"use strict";ne();Jl();Er();ft();Tr();_v();Mh=class extends Yo{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{let o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;let s=$.registeredVariables[r];ee(()=>{let a=se(j(this.c,o),s);s.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=ro(Pe(-t))}dispose(){this.c.dispose()}getWeights(){return te(this,null,function*(){return[yield this.saveIterations()]})}setWeights(t){return te(this,null,function*(){if(t=yield this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}});var kv,H8=w(()=>{"use strict";ne();Jl();Er();ft();Tr();Ar();$O();kv=class extends Mh{static get className(){return"Momentum"}constructor(t,n,r=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Pe(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{let o=$.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:ee(()=>lt(o).variable(!1))});let s=this.accumulations[i].variable,a=Array.isArray(t)?t[i].tensor:t[r];a!=null&&ee(()=>{let l,u=se(j(this.m,s),a);this.useNesterov?l=se(j(this.c,se(a,j(u,this.m))),o):l=se(j(this.c,u),o),s.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&_t(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}getWeights(){return te(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))})}setWeights(t){return te(this,null,function*(){t=yield this.extractIterations(t);let n=!1;this.accumulations=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}});var Iv,Y8=w(()=>{"use strict";ne();Jl();Er();Ln();ft();Bd();Ui();Yn();Ar();_v();Iv=class extends Yo{static get className(){return"RMSProp"}constructor(t,n=.9,r=0,i=null,o=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,i==null&&(this.epsilon=$.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{let o=$.registeredVariables[r],s=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:ee(()=>lt(o).variable(s))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:ee(()=>lt(o).variable(s))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:ee(()=>lt(o).variable(s))});let a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;let l=this.accumulatedMeanSquares[i].variable,u=this.accumulatedMoments[i].variable;ee(()=>{let c=se(j(l,this.decay),j(jt(a),1-this.decay));if(this.centered){let f=this.accumulatedMeanGrads[i].variable,d=se(j(f,this.decay),j(a,1-this.decay)),p=Fe(j(a,this.learningRate),Bn(De(c,se(jt(d),this.epsilon)))),m=se(j(u,this.momentum),p);l.assign(c),f.assign(d),u.assign(m);let h=De(o,m);o.assign(h)}else{let f=se(j(l,this.decay),j(jt(a),1-this.decay)),d=se(j(u,this.momentum),Fe(j(a,this.learningRate),Bn(se(f,this.epsilon))));l.assign(f),u.assign(d);let p=De(o,d);o.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&_t(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&_t(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&_t(this.accumulatedMoments.map(t=>t.variable))}getWeights(){return te(this,null,function*(){let t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return te(this,null,function*(){t=yield this.extractIterations(t);let n=this.centered?t.length/3:t.length/2,r=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}});function TNe(){for(let e of DDt)Bre(e)}var DDt,kNe=w(()=>{"use strict";V8();W8();G8();q8();H8();Y8();$O();j8();DDt=[Sv,Ev,Av,Tv,kv,Iv,Mh]});function INe(e){return new Promise(t=>setTimeout(t)).then(e)}function MDt(e="model"){return new zre(e)}function DNe(e){return new Ure(e)}var NDt,FDt,RDt,zre,Ure,ODt,NNe=w(()=>{"use strict";dT();Vo();ev();F_();Qy();NDt="model",FDt=".json",RDt=".weights.bin";zre=(()=>{class e{constructor(n){if(!Z().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");n.startsWith(e.URL_SCHEME)&&(n=n.slice(e.URL_SCHEME.length)),(n==null||n.length===0)&&(n=NDt),this.modelJsonFileName=n+FDt,this.weightDataFileName=n+RDt}save(n){return te(this,null,function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let r=ls.join(n.weightData),i=window.URL.createObjectURL(new Blob([r],{type:"application/octet-stream"}));if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let o=[{paths:["./"+this.weightDataFileName],weights:n.weightSpecs}],s=J5(n,o),a=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),l=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(l.download=this.modelJsonFileName,l.href=a,yield INe(()=>l.dispatchEvent(new MouseEvent("click"))),n.weightData!=null){let u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=i,yield INe(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:wh(n)}}})}}return e.URL_SCHEME="downloads://",e})(),Ure=class{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}load(){return te(this,null,function*(){return new Promise((t,n)=>{let r=new FileReader;r.onload=i=>{let o=JSON.parse(i.target.result),s=o.modelTopology;if(s==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:s});return}let l=mT(o,u=>this.loadWeights(u));t(l)},r.onerror=i=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})})}loadWeights(t){let n=[],r=[];for(let s of t)n.push(...s.weights),r.push(...s.paths);let i=this.checkManifestAndWeightFiles(t),o=r.map(s=>this.loadWeightsFile(s,i[s]));return Promise.all(o).then(s=>[n,s])}loadWeightsFile(t,n){return new Promise((r,i)=>{let o=new FileReader;o.onload=s=>{let a=s.target.result;r(a)},o.onerror=s=>i(`Failed to weights data from file of path '${t}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){let n=[],r=this.weightsFiles.map(o=>pne(o.name)),i={};for(let o of t)o.paths.forEach(s=>{let a=pne(s);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);i[s]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}},ODt=e=>Z().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(zre.URL_SCHEME)?MDt(e.slice(zre.URL_SCHEME.length)):null;yo.registerSaveRouter(ODt)});function jre(e,t,n,r){s(e),n=n??0,r=r??1,a(n,r);let i=0,o=l=>(l.then(u=>{let c=n+ ++i/e.length*(r-n);return t(c),u}),l);function s(l){L(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){L(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),L(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),L(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(e.map(o))}var FNe=w(()=>{"use strict";ae();});function Vre(e,t){return te(this,null,function*(){t==null&&(t={});let n=t.fetchFunc==null?Z().platform.fetch:t.fetchFunc,r=e.map(f=>n(f,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?yield Promise.all(r):yield jre(r,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?yield Promise.all(a):yield jre(a,t.onProgress,.5,1)})}function RNe(e,t){var n;let r=t.fetchFunc==null?Z().platform.fetch:t.fetchFunc,i=0,o;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:s=>te(this,null,function*(){for(var a;i<e.length;){o||(o=(yield r(e[i],t.requestInit,{isBinary:!0})).body.getReader());let{done:l,value:u}=yield o.read();if(l){i++,o=void 0,(a=t.onProgress)===null||a===void 0||a.call(t,i/e.length);continue}s.enqueue(u);return}s.close()})})}function ONe(e,t="",n,r){return te(this,null,function*(){return Wre(s=>Vre(s,{requestInit:r}))(e,t,n)})}function Wre(e){return(t,n="",r)=>te(this,null,function*(){let i=t.map(()=>!1),o={},s=r!=null?r.map(()=>!1):[],a=[];if(t.forEach((p,m)=>{let h=0;p.weights.forEach(g=>{let x="quantization"in g?g.quantization.dtype:g.dtype,b=Ix[x]*Zt(g.shape),y=()=>{i[m]=!0,o[m]==null&&(o[m]=[]),o[m].push({manifestEntry:g,groupOffset:h,sizeBytes:b})};r!=null?r.forEach((v,C)=>{v===g.name&&(y(),s[C]=!0)}):y(),a.push(g.name),h+=b})}),!s.every(p=>p)){let p=r.filter((m,h)=>!s[h]);throw new Error(`Could not find weights in manifest with names: ${p.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}let l=i.reduce((p,m,h)=>(m&&p.push(h),p),[]),u=[];l.forEach(p=>{t[p].paths.forEach(m=>{let h=n+(n.endsWith("/")?"":"/")+m;u.push(h)})});let c=yield e(u),f={},d=0;return l.forEach(p=>{let m=t[p].paths.length,h=new ls(c.slice(d,d+m));o[p].forEach(x=>{let b=h.slice(x.groupOffset,x.groupOffset+x.sizeBytes),y=Q5(b,[x.manifestEntry]);for(let v in y)f[v]=y[v]}),d+=m}),f})}var Gre=w(()=>{"use strict";Vo();ae();Qy();ev();FNe();une();});function LDt(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}function K8(e){return e.match(MNe.URL_SCHEME_REGEX)!=null}function X8(e,t){return new MNe(e,t)}function PNe(e,t){return X8(e,t)}var $Dt,PDt,MNe,$Ne,LNe=w(()=>{"use strict";Vo();ae();ev();Qy();F_();Gre();$Dt="application/octet-stream",PDt="application/json",MNe=(()=>{class e{constructor(n,r){if(this.DEFAULT_METHOD="POST",r==null&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.weightUrlConverter=r.weightUrlConverter,r.fetchFunc!=null?(L(typeof r.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=r.fetchFunc):this.fetch=Z().platform.fetch,L(n!=null&&n.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(n)&&L(n.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${n.length}).`),this.path=n,r.requestInit!=null&&r.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{},this.loadOptions=r}save(n){return te(this,null,function*(){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let r=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);r.body=new FormData;let i=[{paths:["./model.weights.bin"],weights:n.weightSpecs}],o=J5(n,i);if(r.body.append("model.json",new Blob([JSON.stringify(o)],{type:PDt}),"model.json"),n.weightData!=null){let a=ls.join(n.weightData);r.body.append("model.weights.bin",new Blob([a],{type:$Dt}),"model.weights.bin")}let s=yield this.fetch(this.path,r);if(s.ok)return{modelArtifactsInfo:wh(n),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)})}loadModelJSON(){return te(this,null,function*(){let n=yield this.fetch(this.path,this.requestInit);if(!n.ok)throw new Error(`Request to ${this.path} failed with status code ${n.status}. Please verify this URL points to the model JSON of the model to load.`);let r;try{r=yield n.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}let i=r.modelTopology,o=r.weightsManifest;if(i==null&&o==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return r})}load(){return te(this,null,function*(){if(this.loadOptions.streamWeights)return this.loadStream();let n=yield this.loadModelJSON();return mT(n,r=>this.loadWeights(r))})}loadStream(){return te(this,null,function*(){let n=yield this.loadModelJSON(),r=yield this.getWeightUrls(n.weightsManifest),i=sO(n.weightsManifest),o=()=>RNe(r,this.loadOptions);return Object.assign(Object.assign({},n),{weightSpecs:i,getWeightStream:o})})}getWeightUrls(n){return te(this,null,function*(){let r=Array.isArray(this.path)?this.path[1]:this.path,[i,o]=LDt(r),s=this.weightPathPrefix||i,a=[],l=[];for(let u of n)for(let c of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(c)):a.push(s+c+o);return this.weightUrlConverter&&a.push(...yield Promise.all(l)),a})}loadWeights(n){return te(this,null,function*(){let r=yield this.getWeightUrls(n),i=sO(n),o=yield Vre(r,this.loadOptions);return[i,o]})}}return e.URL_SCHEME_REGEX=/^https?:\/\//,e})();$Ne=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>K8(r)):n=K8(e),n)return X8(e,t)}return null};yo.registerSaveRouter($Ne);yo.registerLoadRouter($Ne)});function BNe(e,t,n,r){let i=arguments;return new qre(Hre(...i))}function Hre(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new PO(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new PO({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new PO({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function zNe(e){return new Z8(e)}function UNe(e){return new Z8(e)}var PO,Z8,qre,jNe=w(()=>{"use strict";PO=class{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}},Z8=class{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}},qre=class{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}});var $h={};rn($h,{CompositeArrayBuffer:()=>ls,browserFiles:()=>DNe,browserHTTPRequest:()=>PNe,concatenateArrayBuffers:()=>qAe,copyModel:()=>sTe,decodeWeights:()=>Q5,decodeWeightsStream:()=>fne,encodeWeights:()=>jAe,fromMemory:()=>BNe,fromMemorySync:()=>Hre,getLoadHandlers:()=>XAe,getModelArtifactsForJSON:()=>mT,getModelArtifactsForJSONSync:()=>mne,getModelArtifactsInfoForJSON:()=>wh,getSaveHandlers:()=>KAe,getWeightSpecs:()=>sO,http:()=>X8,isHTTPScheme:()=>K8,listModels:()=>iTe,loadWeights:()=>ONe,moveModel:()=>aTe,registerLoadRouter:()=>YAe,registerSaveRouter:()=>HAe,removeModel:()=>oTe,weightsLoaderFactory:()=>Wre,withSaveHandler:()=>zNe,withSaveHandlerSync:()=>UNe});var VNe=w(()=>{"use strict";bne();yne();NNe();LNe();ev();jNe();F_();Gre();Qy();vne();});function BDt(e,t,n){let r=D(e,"labels","confusionMatrix"),i=D(t,"predictions","confusionMatrix");L(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),L(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),L(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),L(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),L(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);let o=Fh(de(r,"int32"),n),s=Fh(de(i,"int32"),n),a=zt(o),l=Bt(a,s);return de(l,"int32")}var WNe,GNe=w(()=>{"use strict";J();ae();sn();$d();i8();X();Bx();WNe=R({confusionMatrix_:BDt})});var Yre={};rn(Yre,{confusionMatrix:()=>WNe});var qNe=w(()=>{"use strict";GNe();});var Q8={};rn(Q8,{draw:()=>HDt,fromPixels:()=>YDt,fromPixelsAsync:()=>WDt,toPixels:()=>qDt});function YNe(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,o=!1,s=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)o=!0;else if(e.getContext!=null)s=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(A_(rT,$.backendName)!=null){let m={pixels:e},h={numChannels:t};return $.runKernel(rT,m,h)}let[u,c]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],f;if(s)f=e.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)f=e.data;else if(o||i||a){if(rS==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")rS=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else rS=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});rS.canvas.width=u,rS.canvas.height=c,rS.drawImage(e,0,0,u,c),f=rS.getImageData(0,0,u,c).data}let d;if(t===4)d=new Int32Array(f);else{let m=u*c;d=new Int32Array(m*t);for(let h=0;h<m;h++)for(let g=0;g<t;++g)d[h*t+g]=f[h*4+g]}return S8(d,[c,u,t],"int32")}function zDt(e){return e!=null&&e.data instanceof Uint8Array}function UDt(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function jDt(e){return e!=null&&e.width!==0&&e.height!==0}function VDt(e){return UDt()&&!(e instanceof ImageBitmap)&&jDt(e)&&!zDt(e)}function WDt(e,t=3){return te(this,null,function*(){let n=null;if(Z().getBool("WRAP_TO_IMAGEBITMAP")&&VDt(e)){let r;try{r=yield createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return YNe(n,t)})}function KNe(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function GDt(e){let t=e?.alpha||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}function qDt(e,t){return te(this,null,function*(){let n=D(e,"img","toPixels");if(!(e instanceof Kt)){let u=n;n=de(u,"int32"),u.dispose()}KNe(n);let[r,i]=n.shape.slice(0,2),o=n.rank===2?1:n.shape[2],s=yield n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){let c=[0,0,0,255];for(let d=0;d<o;d++){let p=s[u*o+d];if(n.dtype==="float32"){if(p<0||p>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${p}.`)}else if(n.dtype==="int32"&&(p<0||p>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${p}.`);o===1?(c[0]=p*a,c[1]=p*a,c[2]=p*a):c[d]=p*a}let f=u*4;l[f+0]=Math.round(c[0]),l[f+1]=Math.round(c[1]),l[f+2]=Math.round(c[2]),l[f+3]=Math.round(c[3])}if(t!=null){HNe||A_(nT,$.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),HNe=!0),t.width=i,t.height=r;let u=t.getContext("2d"),c=new ImageData(l,i,r);u.putImageData(c,0,0)}return n!==e&&n.dispose(),l})}function HDt(e,t,n){let r=D(e,"img","draw");if(!(e instanceof Kt)){let s=r;r=de(s,"int32"),s.dispose()}KNe(r),GDt(n?.imageOptions);let i={image:r},o={canvas:t,options:n};$.runKernel(nT,i,o)}var rS,HNe,YDt,XNe=w(()=>{"use strict";ne();Vo();q();ZR();le();J();sn();X();Cre();HNe=!1;YDt=R({fromPixels_:YNe})});var Kre={};rn(Kre,{prepareAndValidate:()=>ZNe});function ZNe(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(Zt(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let i=t.shape,o=i[i.length-1],s=1;for(let f=0;f<i.length-1;++f)s*=i[f];let a=e.shape,l=i.slice();l.pop();let u=1;for(let f=o;f<n;++f)u*=a[f],l.push(a[f]);let c=[...Am(e.shape).map(f=>f/u),1].slice(0,o);return[l,s,u,c]}var Xre=w(()=>{"use strict";ae()});var so={};rn(so,{assertParamsValid:()=>XDt,computeFlatOffset:()=>tNt,computeOutShape:()=>QDt,getNormalizedAxes:()=>JDt,isSliceContinous:()=>eNt,maskToAxes:()=>ZDt,parseSliceParams:()=>Qre,sliceInfo:()=>nNt,startForAxis:()=>oFe,startIndicesWithElidedDims:()=>nFe,stopForAxis:()=>sFe,stopIndicesWithElidedDims:()=>rFe,stridesForAxis:()=>iFe,stridesWithElidedDims:()=>JNe});function XDt(e,t,n){let r=e.shape.length;L(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),L(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)L(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function ZDt(e){let t=[],n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function QDt(e,t,n){let r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function JNe(e,t,n,r){let i=[...e];for(let o=i.length;o<r.length;o++)i.push(1);for(let o=0;o<n;o++)o===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function eFe(e,t,n){return n<=e?n:n-(t-1)}function tFe(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function JDt(e,t,n,r,i,o,s,a,l){let u=e.length,c=new Array(u),f=new Array(u),d=new Array(u);if(t.length&&n>0){let p=t[0],m=n+1;c=nFe(s,p,m,r,e),f=rFe(a,p,m,i,e),d=JNe(o,p,m,e)}else for(let p=0;p<u;p++)c[p]=oFe(s,r,o,e,p,l),f[p]=sFe(a,i,o,e,p,l),d[p]=iFe(o,p,l);return{begin:c,end:f,strides:d}}function nFe(e,t,n,r,i){let o=[...i],s=tFe(n,t);for(let a=0;a<o.length;a++)if(s.indexOf(a)>-1)o[a]=0;else{let l=eFe(t,n,a),u=r[l];e&1<<l&&(u=0),o[a]=u}return o}function rFe(e,t,n,r,i){let o=[...i],s=tFe(n,t);for(let a=0;a<o.length;a++)if(s.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{let l=eFe(t,n,a),u=r[l];e&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){let l=i[a];o[a]<0&&(o[a]+=l),o[a]=KA(0,o[a],i[a])}return o}function iFe(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function oFe(e,t,n,r,i,o){let s=t[i],a=n[i]||1;(e&1<<i||o&1<<i||s==null)&&(a>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);let l=r[i];return s<0&&(s+=l),s=KA(0,s,l-1),s}function sFe(e,t,n,r,i,o){let s=t[i],a=n[i]||1;(e&1<<i||o&1<<i||s==null)&&(a>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);let l=r[i];return s<0&&(s+=l),a>0?s=KA(0,s,l):s=KA(-1,s,l-1),s}function eNt(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function tNt(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function Qre(e,t,n){let r,i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(s=>{L(s!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(i).fill(-1):typeof n=="number"?o=[n,...new Array(i-1).fill(-1)]:n.length<i?o=n.concat(new Array(i-n.length).fill(-1)):o=n,o=o.map((s,a)=>s>=0?s:(L(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${a}.`),e.shape[a]-r[a])),[r,o]}function nNt(e,t,n,r,i,o,s,a,l){let u;if(r==null?(u=new Array(t.length),u.fill(1)):u=r,s!=null&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1,f={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:l};for(let y=0;y<f.dims;y++)c&&1<<y&a&&f.numAddAxisAfterEllipsis++,1<<y&s&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);let d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};rNt(f,d);let p=!0,m=!0,h=!0,g=[],x=[];for(let y=0;y<e.length;++y){if(d.strides[y]===0)throw Error(`strides[${y}] must be non-zero`);let v=!!(d.shrinkAxisMask&1<<y),C=e[y];if(C===-1){g.push(v?1:-1);continue}let _=[d.beginMask&1<<y,d.endMask&1<<y],S=[d.strides[y]>0?0:-1,d.strides[y]>0?C:C-1];if(v&&d.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");h=h&&d.strides[y]===1;let E=!!(d.beginMask&1<<y&&d.endMask&1<<y);if(d.beginValid&&d.endValid){if(v){let O=d.begin[y]<0?C+d.begin[y]:d.begin[y];if(d.begin[y]=O,d.end[y]=d.begin[y]+1,O<0||O>=C)throw Error(`slice index ${d.begin[y]} of dimension ${y} out of bounds.`)}else d.begin[y]=QNe(d.begin[y],0,d.strides[y],C,_,S),d.end[y]=QNe(d.end[y],1,d.strides[y],C,_,S);let k=d.strides[y]===1&&d.begin[y]===0&&d.end[y]===C;p=p&&k,m=m&&(y===0&&d.strides[y]===1||k)}else p=p&&d.strides[y]===1&&E,m=m&&(y===0&&d.strides[y]===1||E);let T,I=!1;if(d.beginValid&&d.endValid?(T=d.end[y]-d.begin[y],I=!0):v?(T=1,I=!0):E&&C>=0&&(d.strides[y]<0?T=-C:T=C,I=!0),I){let k;T===0||T<0!=d.strides[y]<0?k=0:k=Math.trunc(T/d.strides[y])+(T%d.strides[y]!==0?1:0),g.push(k)}else g.push(-1)}for(let y=0;y<d.finalShapeGatherIndices.length;++y){let v=d.finalShapeGatherIndices[y];v>=0?x.push(g[v]):v===Zre&&x.push(1)}return{finalShapeSparse:x.filter((y,v)=>d.finalShapeGatherIndices[v]!==Zre),finalShape:x,isIdentity:p,sliceDim0:m,isSimpleSlice:h,begin:d.begin,end:d.end,strides:d.strides}}function rNt(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(Zre),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(KDt),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function QNe(e,t,n,r,i,o){if(i[t])return n>0?o[t]:o[t+1&1];{let s=e<0?r+e:e;return s<o[0]?o[0]:s>o[1]?o[1]:s}}var Zre,KDt,J8=w(()=>{"use strict";ae();Zre=-2,KDt=-1});var Jre,aFe=w(()=>{"use strict";Jre="4.19.0"});var rk,eie=w(()=>{"use strict";V8();W8();G8();q8();H8();Y8();$O();rk=class{static sgd(t){return new Mh(t)}static momentum(t,n,r=!1){return new kv(t,n,r)}static rmsprop(t,n=.9,r=0,i=null,o=!1){return new Iv(t,n,r,i,o)}static adam(t=.001,n=.9,r=.999,i=null){return new Av(t,n,r,i)}static adadelta(t=.001,n=.95,r=null){return new Sv(t,n,r)}static adamax(t=.002,n=.9,r=.999,i=null,o=0){return new Tv(t,n,r,i,o)}static adagrad(t,n=.1){return new Ev(t,n)}}});var Cf,lFe=w(()=>{"use strict";eie();Cf=rk});function ik(){return new Promise(e=>iNt(()=>e()))}var iNt,uFe=w(()=>{"use strict";iNt=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e()});function oNt(e,t){let n=e[0].length;e.forEach((i,o)=>{L(i.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),L(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((i,o)=>{for(let s=0;s<n;s++)L(s===t||i[s]===r[s],()=>`Error in concat${n}D: Shape of tensors[${o}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function sNt(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var cFe=w(()=>{"use strict";ae();});var fFe=w(()=>{"use strict";});function aNt(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){let o=n[i],s=r[r.length-n.length+i],a=r[s];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${o} but shape[${i+e}] = ${a}`)}else r[s]=o}return r}function lNt(e){let t={FIRST_DIM_SIZE:zx.FIRST_DIM_SIZE,VALUE_ROWIDS:zx.VALUE_ROWIDS,ROW_LENGTHS:zx.ROW_LENGTHS,ROW_SPLITS:zx.ROW_SPLITS,ROW_LIMITS:zx.ROW_LIMITS,ROW_STARTS:zx.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function uNt(e){return e.length===0?0:e[0]===zx.FIRST_DIM_SIZE?e.length-1:e.length}function cNt(e,t){if(e==null||t==null)return;let n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){let o=e[i],s=t[i+1];if(o>=0&&s>=0&&o!==1&&o!==s)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${o} but ragged tensor input.flatValues.shape[${i-e.length}] = ${s}`)}}var zx,dFe=w(()=>{"use strict";zx=function(e){return e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS",e}(zx||{})});function fNt(e){return e<=eU?e:ZA(e,Math.floor(Math.sqrt(e)))}var eU,tie=w(()=>{"use strict";ae();eU=30});function dNt(e,t,n){let r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}var pFe=w(()=>{"use strict";});function pNt(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);let o=t.length;for(let s=0;s<o;++s)i=i.concat([e[s+1]/t[s],t[s]]);i=i.concat(e.slice(o+1))}return i}function mNt(e,t,n=!0){let r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{let i=[],o=[];for(let s=1;s<e;++s)s>=t*2+1||s%2===1?o.push(s):i.push(s);r.push(...i),r.push(0),r.push(...o)}return r}function hNt(e,t,n,r=!0){let i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let o=1;o<e.length;++o)o<=t.length?r?i.push(t[o-1]*e[o]):i.push(e[o]/t[o-1]):i.push(e[o]);return i}function gNt(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function xNt(e,t,n){let r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var mFe=w(()=>{"use strict";});var nie,rie,iie=w(()=>{"use strict";nie=1.7580993408473768,rie=1.0507009873554805});var bNt,yNt,vNt,wNt,CNt,_Nt,hFe=w(()=>{"use strict";bNt=.3275911,yNt=.254829592,vNt=-.284496736,wNt=1.421413741,CNt=-1.453152027,_Nt=1.061405429});function SNt(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function ENt(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function ANt(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function TNt(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function kNt(e,t){let n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function INt(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function DNt(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){let o=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}function NNt(e,t,n){let r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),o=Math.sin(r);return{real:i,imag:o}}var gFe=w(()=>{"use strict";});function RNt(e,t){e=e.replace(/\s/g,"");let n=(e.length-e.replace(FNt,"").length)/oie.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${oie}").`);let[r,i]=e.split(oie);L(r.indexOf(bFe)===-1,()=>`The ellipsis notation ("${bFe}") is not supported yet.`);let o=r.split(xFe),s=o.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let a=[];for(let d=0;d<i.length;++d){let p=i[d];if(!o.some(m=>m.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);a.indexOf(p)===-1&&a.push(p)}for(let d=0;d<r.length;++d){let p=r[d];a.indexOf(p)===-1&&p!==xFe&&a.push(p)}let l=new Array(o.length);for(let d=0;d<s;++d){if(new Set(o[d].split("")).size!==o[d].length)throw new Error(`Found duplicate axes in input component ${o[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let p=0;p<o[d].length;++p)l[d].push(a.indexOf(o[d][p]))}let u=a.length,c=i.length,f=[];for(let d=c;d<u;++d)f.push(d);return{allDims:a,summedDims:f,idDims:l}}function ONt(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;let r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function MNt(e,t,n){let r=new Array(e);for(let i=0;i<n.length;++i){let o=n[i].shape;for(let s=0;s<t[i].length;++s)r[t[i][s]]===void 0?r[t[i][s]]=o[s]:L(r[t[i][s]]===o[s],()=>`Expected dimension ${r[t[i][s]]} at axis ${s} of input shaped ${JSON.stringify(o)}, but got dimension ${o[s]}`)}}function $Nt(e,t){let n=e,r=[],i=0;e.length===0&&n.push(-1),i=e.length+1;for(let s=0;s<i;++s)r.push([]);let o=[];for(let s=0;s<n.length;++s){let a=n[s],l=LNt(t,a);for(let u of l)o.indexOf(u)===-1&&(r[s].push(u),o.push(u))}return{path:n,steps:r}}function PNt(e){return e.every((t,n)=>t===n)}function LNt(e,t){let n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}var oie,FNt,xFe,bFe,yFe=w(()=>{"use strict";bo();oie="->",FNt=/->/g,xFe=",",bFe="..."});function BNt(e,t,n=0){let r=[];if(typeof t=="number")L(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{let i=t.reduce((s,a)=>(a===-1&&(s+=1),s),0);L(i<=1,()=>"There should be only one negative value in split array.");let o=t.indexOf(-1);if(o!==-1){let s=t.reduce((a,l)=>l>0?a+l:a);t[o]=e.shape[n]-s}L(e.shape[n]===t.reduce((s,a)=>s+a),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}var vFe=w(()=>{"use strict";ae()});function zNt(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function UNt(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function jNt(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}var wFe=w(()=>{"use strict";});function VNt(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function WNt(e,t){return`size ${e} must be non-negative, not ${t}`}function GNt(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function qNt(e,t){let n=Zt(e),r=Zt(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function HNt(e,t){let n=Zt(e),r=Zt(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}var CFe=w(()=>{"use strict";ae();});function YNt(){return"segment ids must be >= 0"}function KNt(){return"segment ids are not increasing"}function XNt(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function ZNt(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var _Fe=w(()=>{"use strict";});var sie={};rn(sie,{collectGatherOpShapeInfo:()=>eFt,computeOutShape:()=>JNt,segOpComputeOptimalWindowSize:()=>QNt});function QNt(e,t){let n=!1,r;for(e<=eU?(r=e,n=!0):r=ZA(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=ZA(e,r+1);return r}function JNt(e,t,n){let r=[],i=e.length;for(let o=0;o<i;o++)o!==t?r.push(e[o]):r.push(n);return r}function eFt(e,t,n,r){let i=t.shape.length,o=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let f=0;f<r;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);let s=e.shape[n],a=[],l=1,u=1,c=1;for(let f=0;f<r;++f)a.push(e.shape[f]),l*=e.shape[f];for(let f=r;f<n;f++)a.push(e.shape[f]),u*=e.shape[f];for(let f=r;f<i;f++)a.push(t.shape[f]);for(let f=n+1;f<o;f++)a.push(e.shape[f]),c*=e.shape[f];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:s,outputShape:a}}var SFe=w(()=>{"use strict";ae();tie();});var P={};rn(P,{ERF_A1:()=>yNt,ERF_A2:()=>vNt,ERF_A3:()=>wNt,ERF_A4:()=>CNt,ERF_A5:()=>_Nt,ERF_P:()=>bNt,PARALLELIZE_THRESHOLD:()=>eU,RowPartitionType:()=>zx,SELU_SCALE:()=>rie,SELU_SCALEALPHA:()=>nie,applyActivation:()=>eS,assertAndGetBroadcastShape:()=>Ft,assertAxesAreInnerMostDims:()=>UAt,assertParamsConsistent:()=>oNt,assignToTypedArray:()=>INt,axesAreInnerMostDims:()=>Wne,calculateShapes:()=>LIe,checkEinsumDimSizes:()=>MNt,checkPadOnDimRoundingMode:()=>ir,combineLocations:()=>ZTe,combineRaggedTensorToTensorShapes:()=>aNt,complexWithEvenIndex:()=>ANt,complexWithOddIndex:()=>TNt,computeConv2DInfo:()=>B_,computeConv3DInfo:()=>CTe,computeDefaultPad:()=>Fne,computeDilation2DInfo:()=>z2t,computeOptimalWindowSize:()=>fNt,computeOutAndReduceShapes:()=>Gne,computeOutShape:()=>sNt,computePool2DInfo:()=>Nne,computePool3DInfo:()=>U2t,convertConv2DDataFormat:()=>_Te,decodeEinsumEquation:()=>RNt,eitherStridesOrDilationsAreOne:()=>Go,expandShapeToKeepDim:()=>yf,exponent:()=>NNt,exponents:()=>DNt,fromStringArrayToUint8:()=>nFt,fromUint8ToStringArray:()=>tFt,getAxesPermutation:()=>qne,getBroadcastDims:()=>HTe,getComplexWithIndex:()=>kNt,getEinsumComputePath:()=>$Nt,getEinsumPermutation:()=>ONt,getFusedBiasGradient:()=>J_,getFusedDyActivation:()=>Q_,getImageCenter:()=>dNt,getInnerMostAxes:()=>jAt,getPermuted:()=>mNt,getRaggedRank:()=>uNt,getReductionAxes:()=>Hn,getReshaped:()=>pNt,getReshapedPermuted:()=>hNt,getRowPartitionTypesHelper:()=>lNt,getSliceBeginCoords:()=>gNt,getSliceSize:()=>xNt,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>zNt,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>UNt,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>jNt,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>GNt,getSparseReshapeInputOutputMismatchErrorMessage:()=>HNt,getSparseReshapeInputOutputMultipleErrorMessage:()=>qNt,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>VNt,getSparseReshapeNegativeOutputDimErrorMessage:()=>WNt,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>ZNt,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>YNt,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>KNt,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>XNt,getUndoAxesPermutation:()=>pO,isIdentityPermutation:()=>PNt,log:()=>bEt,mergeRealAndImagArrays:()=>SNt,prepareAndValidate:()=>ZNe,prepareSplitSize:()=>BNt,segment_util:()=>sie,shouldFuse:()=>tS,slice_util:()=>so,splitRealAndImagArrays:()=>ENt,stridesOrDilationsArePositive:()=>_h,tupleValuesAreOne:()=>cc,upcastType:()=>yi,validateDefaultValueShape:()=>cNt,validateInput:()=>ZT,validateUpdateShape:()=>_re,warn:()=>yh});function tFt(e){try{return e.map(t=>uT(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function nFt(e){return e.map(t=>Ky(t))}var EFe=w(()=>{"use strict";ae();Ld();hr();cFe();io();nk();fFe();dFe();tie();J8();fT();pFe();mFe();Xre();NO();iie();nk();hFe();U5();gFe();yFe();vFe();wFe();CFe();_Fe();SFe();});var Ko={};rn(Ko,{nonMaxSuppressionV3Impl:()=>$8,nonMaxSuppressionV4Impl:()=>P8,nonMaxSuppressionV5Impl:()=>L8,whereImpl:()=>I8});var AFe=w(()=>{"use strict";OO();Are();});var aie=w(()=>{"use strict";VNe();qNe();hr();XNe();Xre();NO();J8();j8();zr();sIe();ae();aFe();V8();W8();G8();q8();H8();_v();eie();Y8();$O();le();fT();kt();Vd();lFe();Jl();ZR();Mx();Vo();uFe();EFe();ane();AFe();Mte();q();});var br={};rn(br,{Abs:()=>R0,Acos:()=>Tm,Acosh:()=>km,AdadeltaOptimizer:()=>Sv,AdagradOptimizer:()=>Ev,AdamOptimizer:()=>Av,AdamaxOptimizer:()=>Tv,Add:()=>mf,AddN:()=>O0,All:()=>CC,Any:()=>_C,ArgMax:()=>M0,ArgMin:()=>$0,Asin:()=>Im,Asinh:()=>Dm,Atan:()=>Nm,Atan2:()=>Rm,Atanh:()=>Fm,AvgPool:()=>P0,AvgPool3D:()=>L0,AvgPool3DGrad:()=>EC,AvgPoolGrad:()=>SC,BatchMatMul:()=>B0,BatchToSpaceND:()=>z0,Bincount:()=>AC,BitwiseAnd:()=>My,BroadcastArgs:()=>TC,BroadcastTo:()=>Wte,Cast:()=>kd,Ceil:()=>Om,ClipByValue:()=>Mm,Complex:()=>kC,ComplexAbs:()=>U0,Concat:()=>j0,Conv2D:()=>V0,Conv2DBackpropFilter:()=>IC,Conv2DBackpropInput:()=>W0,Conv3D:()=>G0,Conv3DBackpropFilterV2:()=>DC,Conv3DBackpropInputV2:()=>NC,Cos:()=>$m,Cosh:()=>Pm,CropAndResize:()=>RC,Cumprod:()=>FC,Cumsum:()=>q0,DataStorage:()=>Ry,DenseBincount:()=>OC,DepthToSpace:()=>MC,DepthwiseConv2dNative:()=>H0,DepthwiseConv2dNativeBackpropFilter:()=>$C,DepthwiseConv2dNativeBackpropInput:()=>PC,Diag:()=>LC,Dilation2D:()=>Y0,Dilation2DBackpropFilter:()=>tT,Dilation2DBackpropInput:()=>eT,Draw:()=>nT,ENV:()=>B5,Einsum:()=>BC,Elu:()=>Bm,EluGrad:()=>zC,Environment:()=>JA,Equal:()=>$y,Erf:()=>zm,Exp:()=>Um,ExpandDims:()=>K0,Expm1:()=>jm,FFT:()=>UC,Fill:()=>jC,FlipLeftRight:()=>VC,Floor:()=>Vm,FloorDiv:()=>Wm,FromPixels:()=>rT,FusedBatchNorm:()=>X0,FusedConv2D:()=>qy,FusedDepthwiseConv2D:()=>Hy,GatherNd:()=>WC,GatherV2:()=>Z0,Greater:()=>Py,GreaterEqual:()=>Gm,IFFT:()=>GC,Identity:()=>Id,Imag:()=>qC,IsFinite:()=>qm,IsInf:()=>Hm,IsNan:()=>Ym,KernelBackend:()=>Sm,LRN:()=>J0,LRNGrad:()=>YC,LeakyRelu:()=>Q0,Less:()=>Ly,LessEqual:()=>By,LinSpace:()=>HC,Log:()=>Km,Log1p:()=>Xm,LogSoftmax:()=>Gte,LogicalAnd:()=>zy,LogicalNot:()=>Uy,LogicalOr:()=>jy,LogicalXor:()=>pEt,LowerBound:()=>mEt,MatrixBandPart:()=>hEt,Max:()=>ex,MaxPool:()=>tx,MaxPool3D:()=>nx,MaxPool3DGrad:()=>XC,MaxPoolGrad:()=>KC,MaxPoolWithArgmax:()=>ZC,Maximum:()=>Zm,Mean:()=>rx,Min:()=>ix,Minimum:()=>Qm,MirrorPad:()=>ox,Mod:()=>Jm,MomentumOptimizer:()=>kv,Multinomial:()=>QC,Multiply:()=>eh,Neg:()=>sx,NonMaxSuppressionV3:()=>JC,NonMaxSuppressionV4:()=>e_,NonMaxSuppressionV5:()=>t_,NotEqual:()=>Vy,OP_SCOPE_SUFFIX:()=>lne,OneHot:()=>lx,OnesLike:()=>ax,Optimizer:()=>Yo,OptimizerConstructors:()=>rk,Pack:()=>ux,PadV2:()=>cx,Pool:()=>gEt,Pow:()=>th,Prelu:()=>fx,Prod:()=>dx,RMSPropOptimizer:()=>Iv,RaggedGather:()=>n_,RaggedRange:()=>r_,RaggedTensorToTensor:()=>i_,Range:()=>o_,Rank:()=>tne,Real:()=>s_,RealDiv:()=>Lm,Reciprocal:()=>nh,Reduction:()=>ii,Relu:()=>rh,Relu6:()=>ih,Reshape:()=>px,ResizeBilinear:()=>hx,ResizeBilinearGrad:()=>l_,ResizeNearestNeighbor:()=>mx,ResizeNearestNeighborGrad:()=>a_,Reverse:()=>gx,RotateWithOffset:()=>E_,Round:()=>oh,Rsqrt:()=>sh,SGDOptimizer:()=>Mh,ScatterNd:()=>u_,SearchSorted:()=>f_,Select:()=>xx,Selu:()=>ah,Sigmoid:()=>fh,Sign:()=>ch,Sin:()=>lh,Sinh:()=>uh,Slice:()=>bx,Softmax:()=>Cx,Softplus:()=>dh,SpaceToBatchND:()=>vx,SparseFillEmptyRows:()=>d_,SparseReshape:()=>p_,SparseSegmentMean:()=>m_,SparseSegmentSum:()=>h_,SparseToDense:()=>g_,SplitV:()=>wx,Sqrt:()=>ph,Square:()=>x_,SquaredDifference:()=>mh,StaticRegexReplace:()=>Wy,Step:()=>bh,StridedSlice:()=>b_,StringNGrams:()=>y_,StringSplit:()=>v_,StringToHashBucketFast:()=>w_,Sub:()=>hh,Sum:()=>yx,Tan:()=>gh,Tanh:()=>xh,Tensor:()=>Kt,TensorBuffer:()=>gn,TensorScatterUpdate:()=>c_,Tile:()=>Dd,TopK:()=>C_,Transform:()=>__,Transpose:()=>Nd,Unique:()=>S_,Unpack:()=>_x,UnsortedSegmentSum:()=>Sx,UpperBound:()=>xEt,Variable:()=>vh,ZerosLike:()=>Ex,_FusedMatMul:()=>Gy,abs:()=>mr,acos:()=>o6,acosh:()=>s6,add:()=>se,addN:()=>gTe,all:()=>vT,any:()=>L_,argMax:()=>Ch,argMin:()=>a6,asin:()=>l6,asinh:()=>u6,atan:()=>c6,atan2:()=>f6,atanh:()=>d6,avgPool:()=>nv,avgPool3d:()=>m6,backend:()=>oO,backend_util:()=>P,basicLSTMCell:()=>ETe,batchNorm:()=>Sh,batchNorm2d:()=>h6,batchNorm3d:()=>g6,batchNorm4d:()=>x6,batchToSpaceND:()=>rv,bincount:()=>b6,bitwiseAnd:()=>FTe,booleanMaskAsync:()=>cIt,broadcastArgs:()=>OTe,broadcastTo:()=>Eh,broadcast_util:()=>fl,browser:()=>Q8,buffer:()=>et,cast:()=>de,ceil:()=>v6,clipByValue:()=>vo,clone:()=>ll,complex:()=>al,concat:()=>En,concat1d:()=>w6,concat2d:()=>C6,concat3d:()=>_6,concat4d:()=>S6,conv1d:()=>ET,conv2d:()=>cl,conv2dTranspose:()=>TT,conv3d:()=>A6,conv3dTranspose:()=>k6,copyRegisteredKernels:()=>wEt,cos:()=>iv,cosh:()=>kT,cosineWindow:()=>FO,cumprod:()=>U_,cumsum:()=>IT,customGrad:()=>Ws,denseBincount:()=>cO,deprecationWarn:()=>LAe,depthToSpace:()=>F6,depthwiseConv2d:()=>Ah,device_util:()=>Ax,diag:()=>GTe,dilation2d:()=>R6,disableDeprecationWarnings:()=>HEt,dispose:()=>_t,disposeVariables:()=>YEt,div:()=>Fe,divNoNan:()=>O6,dot:()=>M6,dropout:()=>kre,einsum:()=>ov,elu:()=>Th,enableDebugMode:()=>qEt,enableProdMode:()=>GEt,enclosingPowerOfTwo:()=>Ire,engine:()=>uc,ensureShape:()=>YTe,env:()=>Z,equal:()=>Vs,erf:()=>DT,euclideanNorm:()=>L6,exp:()=>Jr,expandDims:()=>ri,expm1:()=>B6,eye:()=>j_,fft:()=>bv,fill:()=>bf,findBackend:()=>JEt,findBackendFactory:()=>e2t,floor:()=>Ih,floorDiv:()=>yT,fused:()=>Cv,gather:()=>Dh,gatherND:()=>vIt,gather_util:()=>Kre,getBackend:()=>cne,getGradient:()=>j5,getKernel:()=>A_,getKernelsForBackend:()=>XR,grad:()=>oke,grads:()=>ske,greater:()=>Ur,greaterEqual:()=>ba,ifft:()=>Lx,imag:()=>av,image:()=>pl,inTopKAsync:()=>_It,io:()=>$h,irfft:()=>YT,isFinite:()=>U6,isInf:()=>j6,isNaN:()=>V6,keep:()=>ro,kernel_impls:()=>Ko,leakyRelu:()=>lv,less:()=>Ox,lessEqual:()=>eu,linalg:()=>Pre,linspace:()=>rke,localResponseNormalization:()=>G6,log:()=>Co,log1p:()=>cv,logSigmoid:()=>H6,logSoftmax:()=>MT,logSumExp:()=>fv,logicalAnd:()=>cs,logicalNot:()=>dv,logicalOr:()=>$T,logicalXor:()=>X6,losses:()=>EDt,lowerBound:()=>fke,matMul:()=>Bt,math:()=>Yre,max:()=>wo,maxPool:()=>pv,maxPool3d:()=>e8,maxPoolWithArgmax:()=>mke,maximum:()=>dl,mean:()=>sr,memory:()=>pT,meshgrid:()=>gke,min:()=>Fx,minimum:()=>mc,mirrorPad:()=>t8,mod:()=>n8,moments:()=>q_,movingAverage:()=>pIt,mul:()=>j,multiRNNCell:()=>yke,multinomial:()=>wke,neg:()=>qt,nextFrame:()=>ik,norm:()=>Rx,notEqual:()=>Ud,oneHot:()=>Fh,ones:()=>vi,onesLike:()=>oo,op:()=>R,outerProduct:()=>Ske,pad:()=>ya,pad1d:()=>Ake,pad2d:()=>kke,pad3d:()=>Dke,pad4d:()=>Fke,pool:()=>o8,pow:()=>us,prelu:()=>gv,print:()=>r6,prod:()=>a8,profile:()=>KEt,raggedGather:()=>Oke,raggedRange:()=>$ke,raggedTensorToTensor:()=>Lke,rand:()=>zke,randomGamma:()=>aIe,randomNormal:()=>K_,randomStandardNormal:()=>uIe,randomUniform:()=>tu,randomUniformInt:()=>fIe,range:()=>Rh,ready:()=>ZEt,real:()=>$x,reciprocal:()=>m8,registerBackend:()=>iO,registerGradient:()=>qte,registerKernel:()=>oT,relu:()=>Ho,relu6:()=>BT,removeBackend:()=>QEt,reshape:()=>V,reverse:()=>ji,reverse1d:()=>mIe,reverse2d:()=>gIe,reverse3d:()=>bIe,reverse4d:()=>vIe,rfft:()=>yv,round:()=>zT,rsqrt:()=>UT,scalar:()=>Pe,scatterND:()=>hIt,scatter_util:()=>DO,searchSorted:()=>vO,selu:()=>jT,separableConv2d:()=>VT,serialization:()=>fe,setBackend:()=>BAe,setPlatform:()=>t2t,setdiff1dAsync:()=>CIe,sigmoid:()=>js,sign:()=>g8,signal:()=>SDt,sin:()=>WT,sinh:()=>GT,slice:()=>Mt,slice1d:()=>qT,slice2d:()=>kO,slice3d:()=>HT,slice4d:()=>X_,slice_util:()=>so,softmax:()=>xv,softplus:()=>zd,spaceToBatchND:()=>hv,sparse:()=>ADt,sparseToDense:()=>bIt,spectral:()=>_Dt,split:()=>Vi,sqrt:()=>Bn,square:()=>jt,squaredDifference:()=>KT,squeeze:()=>nu,stack:()=>Ri,step:()=>vf,stridedSlice:()=>w8,string:()=>TDt,sub:()=>De,sum:()=>Me,sumOutType:()=>Xy,tan:()=>C8,tanh:()=>Pd,tensor:()=>as,tensor1d:()=>xr,tensor2d:()=>jd,tensor3d:()=>S8,tensor4d:()=>FIe,tensor5d:()=>OIe,tensor6d:()=>$Ie,tensorScatterUpdate:()=>BIe,tensor_util:()=>X5,test_util:()=>pre,tidy:()=>ee,tile:()=>qo,time:()=>XEt,topk:()=>E8,train:()=>Cf,transpose:()=>zt,truncatedNormal:()=>QT,unique:()=>A8,unregisterGradient:()=>vEt,unregisterKernel:()=>yEt,unsortedSegmentSum:()=>JT,unstack:()=>fs,upcastType:()=>yi,upperBound:()=>jIe,util:()=>A,valueAndGrad:()=>ake,valueAndGrads:()=>lke,variable:()=>k8,variableGrads:()=>bO,version_core:()=>Jre,where:()=>or,whereAsync:()=>D8,zeros:()=>ar,zerosLike:()=>lt});var N=w(()=>{"use strict";pTe();kNe();aie();TNe()});var TFe=w(()=>{"use strict";kt();le();G().prototype.abs=function(){return this.throwIfDisposed(),mr(this)}});var kFe=w(()=>{"use strict";kt();le();G().prototype.acos=function(){return this.throwIfDisposed(),o6(this)}});var IFe=w(()=>{"use strict";kt();le();G().prototype.acosh=function(){return this.throwIfDisposed(),s6(this)}});var DFe=w(()=>{"use strict";Er();le();G().prototype.add=function(e){return this.throwIfDisposed(),se(this,e)}});var NFe=w(()=>{"use strict";Ene();le();G().prototype.all=function(e,t){return this.throwIfDisposed(),vT(this,e,t)}});var FFe=w(()=>{"use strict";Ane();le();G().prototype.any=function(e,t){return this.throwIfDisposed(),L_(this,e,t)}});var RFe=w(()=>{"use strict";Tne();le();G().prototype.argMax=function(e){return this.throwIfDisposed(),Ch(this,e)}});var OFe=w(()=>{"use strict";kne();le();G().prototype.argMin=function(e){return this.throwIfDisposed(),a6(this,e)}});var MFe=w(()=>{"use strict";qe();le();ae();G().prototype.asScalar=function(){return this.throwIfDisposed(),L(this.size===1,()=>"The array must have only 1 element."),V(this,[])}});var $Fe=w(()=>{"use strict";kt();le();G().prototype.asType=function(e){return this.throwIfDisposed(),de(this,e)}});var PFe=w(()=>{"use strict";qe();le();G().prototype.as1D=function(){return this.throwIfDisposed(),V(this,[this.size])}});var LFe=w(()=>{"use strict";qe();le();G().prototype.as2D=function(e,t){return this.throwIfDisposed(),V(this,[e,t])}});var BFe=w(()=>{"use strict";qe();le();G().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),V(this,[e,t,n])}});var zFe=w(()=>{"use strict";qe();le();G().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),V(this,[e,t,n,r])}});var UFe=w(()=>{"use strict";qe();le();G().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),V(this,[e,t,n,r,i])}});var jFe=w(()=>{"use strict";kt();le();G().prototype.asin=function(){return this.throwIfDisposed(),l6(this)}});var VFe=w(()=>{"use strict";kt();le();G().prototype.asinh=function(){return this.throwIfDisposed(),u6(this)}});var WFe=w(()=>{"use strict";kt();le();G().prototype.atan=function(){return this.throwIfDisposed(),c6(this)}});var GFe=w(()=>{"use strict";Ine();le();G().prototype.atan2=function(e){return this.throwIfDisposed(),f6(this,e)}});var qFe=w(()=>{"use strict";kt();le();G().prototype.atanh=function(){return this.throwIfDisposed(),d6(this)}});var HFe=w(()=>{"use strict";p6();le();G().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),nv(this,e,t,n,r)}});var YFe=w(()=>{"use strict";uO();le();G().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),rv(this,e,t)}});var KFe=w(()=>{"use strict";_T();le();G().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),Sh(this,e,t,n,r,i)}});var XFe=w(()=>{"use strict";y6();le();G().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Eh(this,e)}});var ZFe=w(()=>{"use strict";kt();le();G().prototype.cast=function(e){return this.throwIfDisposed(),de(this,e)}});var QFe=w(()=>{"use strict";kt();le();G().prototype.ceil=function(){return this.throwIfDisposed(),v6(this)}});var JFe=w(()=>{"use strict";kt();le();G().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),vo(this,e,t)}});var eRe=w(()=>{"use strict";dc();le();G().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Kt&&(e=[e]),En([this,...e],t)}});var tRe=w(()=>{"use strict";Mne();le();G().prototype.conv1d=function(e,t,n,r,i,o){return this.throwIfDisposed(),ET(this,e,t,n,r,i,o)}});var nRe=w(()=>{"use strict";$ne();le();G().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),TT(this,e,t,n,r,i)}});var rRe=w(()=>{"use strict";z_();le();G().prototype.conv2d=function(e,t,n,r,i,o){return this.throwIfDisposed(),cl(this,e,t,n,r,i,o)}});var iRe=w(()=>{"use strict";kt();le();G().prototype.cos=function(){return this.throwIfDisposed(),iv(this)}});var oRe=w(()=>{"use strict";kt();le();G().prototype.cosh=function(){return this.throwIfDisposed(),kT(this)}});var sRe=w(()=>{"use strict";D6();le();G().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),U_(this,e,t,n)}});var aRe=w(()=>{"use strict";N6();le();G().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),IT(this,e,t,n)}});var lRe=w(()=>{"use strict";Bne();le();G().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),F6(this,e,t)}});var uRe=w(()=>{"use strict";fO();le();G().prototype.depthwiseConv2d=function(e,t,n,r,i,o){return this.throwIfDisposed(),Ah(this,e,t,n,r,i,o)}});var cRe=w(()=>{"use strict";zne();le();G().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),R6(this,e,t,n,r,i)}});var fRe=w(()=>{"use strict";Une();le();G().prototype.divNoNan=function(e){return this.throwIfDisposed(),O6(this,e)}});var dRe=w(()=>{"use strict";Ln();le();G().prototype.div=function(e){return this.throwIfDisposed(),Fe(this,e)}});var pRe=w(()=>{"use strict";jne();le();G().prototype.dot=function(e){return this.throwIfDisposed(),M6(this,e)}});var mRe=w(()=>{"use strict";$6();le();G().prototype.elu=function(){return this.throwIfDisposed(),Th(this)}});var hRe=w(()=>{"use strict";dO();le();G().prototype.equal=function(e){return this.throwIfDisposed(),Vs(this,e)}});var gRe=w(()=>{"use strict";kt();le();G().prototype.erf=function(){return this.throwIfDisposed(),DT(this)}});var xRe=w(()=>{"use strict";Yne();le();G().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),L6(this,e,t)}});var bRe=w(()=>{"use strict";kt();le();G().prototype.exp=function(){return this.throwIfDisposed(),Jr(this)}});var yRe=w(()=>{"use strict";FT();le();G().prototype.expandDims=function(e){return this.throwIfDisposed(),ri(this,e)}});var vRe=w(()=>{"use strict";kt();le();G().prototype.expm1=function(){return this.throwIfDisposed(),B6(this)}});var wRe=w(()=>{"use strict";kt();le();G().prototype.fft=function(){return this.throwIfDisposed(),bv(this)}});var CRe=w(()=>{"use strict";qe();le();G().prototype.flatten=function(){return this.throwIfDisposed(),V(this,[this.size])}});var _Re=w(()=>{"use strict";kt();le();G().prototype.floor=function(){return this.throwIfDisposed(),Ih(this)}});var SRe=w(()=>{"use strict";i6();le();G().prototype.floorDiv=function(e){return this.throwIfDisposed(),yT(this,e)}});var ERe=w(()=>{"use strict";hO();le();G().prototype.gather=function(e,t,n){return this.throwIfDisposed(),Dh(this,e,t,n)}});var ARe=w(()=>{"use strict";V_();le();G().prototype.greaterEqual=function(e){return this.throwIfDisposed(),ba(this,e)}});var TRe=w(()=>{"use strict";Nh();le();G().prototype.greater=function(e){return this.throwIfDisposed(),Ur(this,e)}});var kRe=w(()=>{"use strict";kt();le();G().prototype.ifft=function(){return this.throwIfDisposed(),Lx(this)}});var IRe=w(()=>{"use strict";kt();le();G().prototype.irfft=function(){return this.throwIfDisposed(),YT(this)}});var DRe=w(()=>{"use strict";kt();le();G().prototype.isFinite=function(){return this.throwIfDisposed(),U6(this)}});var NRe=w(()=>{"use strict";kt();le();G().prototype.isInf=function(){return this.throwIfDisposed(),j6(this)}});var FRe=w(()=>{"use strict";kt();le();G().prototype.isNaN=function(){return this.throwIfDisposed(),V6(this)}});var RRe=w(()=>{"use strict";W6();le();G().prototype.leakyRelu=function(e){return this.throwIfDisposed(),lv(this,e)}});var ORe=w(()=>{"use strict";uv();le();G().prototype.lessEqual=function(e){return this.throwIfDisposed(),eu(this,e)}});var MRe=w(()=>{"use strict";xO();le();G().prototype.less=function(e){return this.throwIfDisposed(),Ox(this,e)}});var $Re=w(()=>{"use strict";Xne();le();G().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),G6(this,e,t,n,r)}});var PRe=w(()=>{"use strict";kt();le();G().prototype.logSigmoid=function(){return this.throwIfDisposed(),H6(this)}});var LRe=w(()=>{"use strict";kt();le();G().prototype.logSoftmax=function(e){return this.throwIfDisposed(),MT(this,e)}});var BRe=w(()=>{"use strict";Y6();le();G().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),fv(this,e,t)}});var zRe=w(()=>{"use strict";kt();le();G().prototype.log=function(){return this.throwIfDisposed(),Co(this)}});var URe=w(()=>{"use strict";kt();le();G().prototype.log1p=function(){return this.throwIfDisposed(),cv(this)}});var jRe=w(()=>{"use strict";W_();le();G().prototype.logicalAnd=function(e){return this.throwIfDisposed(),cs(this,e)}});var VRe=w(()=>{"use strict";yO();le();G().prototype.logicalNot=function(){return this.throwIfDisposed(),dv(this)}});var WRe=w(()=>{"use strict";K6();le();G().prototype.logicalOr=function(e){return this.throwIfDisposed(),$T(this,e)}});var GRe=w(()=>{"use strict";Jne();le();G().prototype.logicalXor=function(e){return this.throwIfDisposed(),X6(this,e)}});var qRe=w(()=>{"use strict";$d();le();G().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Bt(this,e,t,n)}});var HRe=w(()=>{"use strict";J6();le();G().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),pv(this,e,t,n,r)}});var YRe=w(()=>{"use strict";NT();le();G().prototype.max=function(e,t){return this.throwIfDisposed(),wo(this,e,t)}});var KRe=w(()=>{"use strict";wO();le();G().prototype.maximum=function(e){return this.throwIfDisposed(),dl(this,e)}});var XRe=w(()=>{"use strict";CO();le();G().prototype.mean=function(e,t){return this.throwIfDisposed(),sr(this,e,t)}});var ZRe=w(()=>{"use strict";P6();le();G().prototype.min=function(e,t){return this.throwIfDisposed(),Fx(this,e,t)}});var QRe=w(()=>{"use strict";_O();le();G().prototype.minimum=function(e){return this.throwIfDisposed(),mc(this,e)}});var JRe=w(()=>{"use strict";ere();le();G().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),t8(this,e,t)}});var eOe=w(()=>{"use strict";tre();le();G().prototype.mod=function(e){return this.throwIfDisposed(),n8(this,e)}});var tOe=w(()=>{"use strict";ft();le();G().prototype.mul=function(e){return this.throwIfDisposed(),j(this,e)}});var nOe=w(()=>{"use strict";kt();le();G().prototype.neg=function(){return this.throwIfDisposed(),qt(this)}});var rOe=w(()=>{"use strict";kt();le();G().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Rx(this,e,t,n)}});var iOe=w(()=>{"use strict";r8();le();G().prototype.notEqual=function(e){return this.throwIfDisposed(),Ud(this,e)}});var oOe=w(()=>{"use strict";i8();le();G().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),Fh(this,e,t,n)}});var sOe=w(()=>{"use strict";kt();le();G().prototype.onesLike=function(){return this.throwIfDisposed(),oo(this)}});var aOe=w(()=>{"use strict";mv();le();G().prototype.pad=function(e,t){return this.throwIfDisposed(),ya(this,e,t)}});var lOe=w(()=>{"use strict";nre();le();G().prototype.pool=function(e,t,n,r,i,o){return this.throwIfDisposed(),o8(this,e,t,n,r,i,o)}});var uOe=w(()=>{"use strict";sv();le();G().prototype.pow=function(e){return this.throwIfDisposed(),us(this,e)}});var cOe=w(()=>{"use strict";s8();le();G().prototype.prelu=function(e){return this.throwIfDisposed(),gv(this,e)}});var fOe=w(()=>{"use strict";rre();le();G().prototype.prod=function(e,t){return this.throwIfDisposed(),a8(this,e,t)}});var dOe=w(()=>{"use strict";kt();le();G().prototype.reciprocal=function(){return this.throwIfDisposed(),m8(this)}});var pOe=w(()=>{"use strict";LT();le();G().prototype.relu=function(){return this.throwIfDisposed(),Ho(this)}});var mOe=w(()=>{"use strict";h8();le();G().prototype.relu6=function(){return this.throwIfDisposed(),BT(this)}});var hOe=w(()=>{"use strict";qe();le();G().prototype.reshapeAs=function(e){return this.throwIfDisposed(),V(this,e.shape)}});var gOe=w(()=>{"use strict";qe();le();G().prototype.reshape=function(e){return this.throwIfDisposed(),V(this,e)}});var xOe=w(()=>{"use strict";Mre();le();G().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),B8(this,e,t,n)}});var bOe=w(()=>{"use strict";$re();le();G().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),z8(this,e,t,n)}});var yOe=w(()=>{"use strict";Px();le();G().prototype.reverse=function(e){return this.throwIfDisposed(),ji(this,e)}});var vOe=w(()=>{"use strict";kt();le();G().prototype.rfft=function(){return this.throwIfDisposed(),yv(this)}});var wOe=w(()=>{"use strict";kt();le();G().prototype.round=function(){return this.throwIfDisposed(),zT(this)}});var COe=w(()=>{"use strict";kt();le();G().prototype.rsqrt=function(){return this.throwIfDisposed(),UT(this)}});var _Oe=w(()=>{"use strict";xre();le();G().prototype.selu=function(){return this.throwIfDisposed(),jT(this)}});var SOe=w(()=>{"use strict";bre();le();G().prototype.separableConv2d=function(e,t,n,r,i,o){return this.throwIfDisposed(),VT(this,e,t,n,r,i,o)}});var EOe=w(()=>{"use strict";kt();le();G().prototype.sigmoid=function(){return this.throwIfDisposed(),js(this)}});var AOe=w(()=>{"use strict";kt();le();G().prototype.sign=function(){return this.throwIfDisposed(),g8(this)}});var TOe=w(()=>{"use strict";kt();le();G().prototype.sin=function(){return this.throwIfDisposed(),WT(this)}});var kOe=w(()=>{"use strict";kt();le();G().prototype.sinh=function(){return this.throwIfDisposed(),GT(this)}});var IOe=w(()=>{"use strict";kt();le();G().prototype.slice=function(e,t){return this.throwIfDisposed(),Mt(this,e,t)}});var DOe=w(()=>{"use strict";kt();le();G().prototype.softmax=function(e){return this.throwIfDisposed(),xv(this,e)}});var NOe=w(()=>{"use strict";kt();le();G().prototype.softplus=function(){return this.throwIfDisposed(),zd(this)}});var FOe=w(()=>{"use strict";SO();le();G().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),hv(this,e,t)}});var ROe=w(()=>{"use strict";Z_();le();G().prototype.split=function(e,t){return this.throwIfDisposed(),Vi(this,e,t)}});var OOe=w(()=>{"use strict";kt();le();G().prototype.sqrt=function(){return this.throwIfDisposed(),Bn(this)}});var MOe=w(()=>{"use strict";kt();le();G().prototype.square=function(){return this.throwIfDisposed(),jt(this)}});var $Oe=w(()=>{"use strict";v8();le();G().prototype.squaredDifference=function(e){return this.throwIfDisposed(),KT(this,e)}});var POe=w(()=>{"use strict";IO();le();G().prototype.squeeze=function(e){return this.throwIfDisposed(),nu(this,e)}});var LOe=w(()=>{"use strict";vv();le();G().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof Kt?[this,e]:[this,...e];return Ri(n,t)}});var BOe=w(()=>{"use strict";kt();le();G().prototype.step=function(e){return this.throwIfDisposed(),vf(this,e)}});var zOe=w(()=>{"use strict";kt();le();G().prototype.stridedSlice=function(e,t,n,r,i,o,s,a){return this.throwIfDisposed(),w8(this,e,t,n,r,i,o,s,a)}});var UOe=w(()=>{"use strict";Yn();le();G().prototype.sub=function(e){return this.throwIfDisposed(),De(this,e)}});var jOe=w(()=>{"use strict";ni();le();G().prototype.sum=function(e,t){return this.throwIfDisposed(),Me(this,e,t)}});var VOe=w(()=>{"use strict";kt();le();G().prototype.tan=function(){return this.throwIfDisposed(),C8(this)}});var WOe=w(()=>{"use strict";kt();le();G().prototype.tanh=function(){return this.throwIfDisposed(),Pd(this)}});var GOe=w(()=>{"use strict";RT();le();G().prototype.tile=function(e){return this.throwIfDisposed(),qo(this,e)}});var qOe=w(()=>{"use strict";kt();le();G().prototype.toBool=function(){return this.throwIfDisposed(),de(this,"bool")}});var HOe=w(()=>{"use strict";kt();le();G().prototype.toFloat=function(){return this.throwIfDisposed(),de(this,"float32")}});var YOe=w(()=>{"use strict";kt();le();G().prototype.toInt=function(){return this.throwIfDisposed(),de(this,"int32")}});var KOe=w(()=>{"use strict";Sre();le();G().prototype.topk=function(e,t){return this.throwIfDisposed(),E8(this,e,t)}});var XOe=w(()=>{"use strict";Bx();le();G().prototype.transpose=function(e){return this.throwIfDisposed(),zt(this,e)}});var ZOe=w(()=>{"use strict";Ere();le();G().prototype.unique=function(e){return this.throwIfDisposed(),A8(this,e)}});var QOe=w(()=>{"use strict";T8();le();G().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),JT(this,e,t)}});var JOe=w(()=>{"use strict";ek();le();G().prototype.unstack=function(e){return this.throwIfDisposed(),fs(this,e)}});var eMe=w(()=>{"use strict";pc();le();G().prototype.where=function(e,t){return this.throwIfDisposed(),or(e,this,t)}});var tMe=w(()=>{"use strict";kt();le();G().prototype.zerosLike=function(){return this.throwIfDisposed(),lt(this)}});var rFt={};var lie=w(()=>{"use strict";TFe();kFe();IFe();DFe();NFe();FFe();RFe();OFe();MFe();$Fe();PFe();LFe();BFe();zFe();UFe();jFe();VFe();WFe();GFe();qFe();HFe();YFe();KFe();XFe();ZFe();QFe();JFe();eRe();tRe();nRe();rRe();iRe();oRe();sRe();aRe();lRe();uRe();cRe();fRe();dRe();pRe();mRe();hRe();gRe();xRe();bRe();yRe();vRe();wRe();CRe();_Re();SRe();ERe();ARe();TRe();kRe();IRe();DRe();NRe();FRe();RRe();ORe();MRe();$Re();PRe();LRe();BRe();zRe();URe();jRe();VRe();WRe();GRe();qRe();HRe();YRe();KRe();XRe();ZRe();QRe();JRe();eOe();tOe();nOe();rOe();iOe();oOe();sOe();aOe();lOe();uOe();cOe();fOe();dOe();pOe();mOe();hOe();gOe();xOe();bOe();yOe();vOe();wOe();COe();_Oe();SOe();EOe();AOe();TOe();kOe();IOe();DOe();NOe();FOe();ROe();OOe();MOe();$Oe();POe();LOe();BOe();zOe();UOe();jOe();VOe();WOe();GOe();qOe();HOe();YOe();KOe();XOe();ZOe();QOe();JOe();eMe();tMe();});function nU(e,t){return oFt.call(e,t)}function rU(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)nU(e,i)&&r.push(i);return r}function Gs(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function iU(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function Ph(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function LO(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function tU(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(tU(e[t]))return!0}else if(typeof e=="object"){for(var r=rU(e),i=r.length,o=0;o<i;o++)if(tU(e[r[o]]))return!0}}return!1}function nMe(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var iFt,oFt,BO,zO=w(()=>{"use strict";iFt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),oFt=Object.prototype.hasOwnProperty;BO=function(e){iFt(t,e);function t(n,r,i,o,s){var a=this.constructor,l=e.call(this,nMe(n,{name:r,index:i,operation:o,tree:s}))||this;return l.name=r,l.index=i,l.operation=o,l.tree=s,Object.setPrototypeOf(l,a.prototype),l.message=nMe(n,{name:r,index:i,operation:o,tree:s}),l}return t}(Error)});var uie={};rn(uie,{JsonPatchError:()=>Wi,_areEquals:()=>UO,applyOperation:()=>iS,applyPatch:()=>sk,applyReducer:()=>lFt,deepClone:()=>sFt,getValueByPointer:()=>oU,validate:()=>rMe,validator:()=>sU});function oU(e,t){if(t=="")return e;var n={op:"_get",path:t};return iS(e,n),n.value}function iS(e,t,n,r,i,o){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):sU(t,0)),t.path===""){var s={newDocument:e};if(t.op==="add")return s.newDocument=t.value,s;if(t.op==="replace")return s.newDocument=t.value,s.removed=e,s;if(t.op==="move"||t.op==="copy")return s.newDocument=oU(e,t.from),t.op==="move"&&(s.removed=e),s;if(t.op==="test"){if(s.test=UO(e,t.value),s.test===!1)throw new Wi("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}else{if(t.op==="remove")return s.removed=e,s.newDocument=null,s;if(t.op==="_get")return t.value=e,s;if(n)throw new Wi("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}}else{r||(e=Gs(e));var a=t.path||"",l=a.split("/"),u=e,c=1,f=l.length,d=void 0,p=void 0,m=void 0;for(typeof n=="function"?m=n:m=sU;;){if(p=l[c],p&&p.indexOf("~")!=-1&&(p=LO(p)),i&&(p=="__proto__"||p=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(u[p]===void 0?d=l.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&m(t,0,e,d)),c++,Array.isArray(u)){if(p==="-")p=u.length;else{if(n&&!iU(p))throw new Wi("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);iU(p)&&(p=~~p)}if(c>=f){if(n&&t.op==="add"&&p>u.length)throw new Wi("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var s=aFt[t.op].call(t,u,p,e);if(s.test===!1)throw new Wi("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){var s=ok[t.op].call(t,u,p,e);if(s.test===!1)throw new Wi("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(u=u[p],n&&c<f&&(!u||typeof u!="object"))throw new Wi("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function sk(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Wi("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Gs(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=iS(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function lFt(e,t,n){var r=iS(e,t);if(r.test===!1)throw new Wi("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function sU(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Wi("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(ok[e.op]){if(typeof e.path!="string")throw new Wi("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Wi('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Wi("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Wi("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&tU(e.value))throw new Wi("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new Wi("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Wi("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var s={op:"_get",path:e.from,value:void 0},a=rMe([s],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new Wi("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Wi("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function rMe(e,t,n){try{if(!Array.isArray(e))throw new Wi("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)sk(Gs(t),Gs(e),n||!0);else{n=n||sU;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Wi)return i;throw i}}function UO(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,o,s;if(n&&r){if(o=e.length,o!=t.length)return!1;for(i=o;i--!==0;)if(!UO(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(o=a.length,o!==Object.keys(t).length)return!1;for(i=o;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;i--!==0;)if(s=a[i],!UO(e[s],t[s]))return!1;return!0}return e!==e&&t!==t}var Wi,sFt,ok,aFt,aU=w(()=>{"use strict";zO();Wi=BO,sFt=Gs,ok={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=oU(n,this.path);r&&(r=Gs(r));var i=iS(n,{op:"remove",path:this.from}).removed;return iS(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=oU(n,this.from);return iS(n,{op:"add",path:this.path,value:Gs(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:UO(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},aFt={add:function(e,t,n){return iU(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:ok.move,copy:ok.copy,test:ok.test,_get:ok._get}});var pie={};rn(pie,{compare:()=>gFt,generate:()=>cie,observe:()=>hFt,unobserve:()=>mFt});function fFt(e){return fie.get(e)}function dFt(e,t){return e.observers.get(t)}function pFt(e,t){e.observers.delete(t.callback)}function mFt(e,t){t.unobserve()}function hFt(e,t){var n=[],r,i=fFt(e);if(!i)i=new uFt(e),fie.set(e,i);else{var o=dFt(i,t);r=o&&o.observer}if(r)return r;if(r={},i.value=Gs(e),t){r.callback=t,r.next=null;var s=function(){cie(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){cie(r),clearTimeout(r.next),pFt(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new cFt(t,r)),r}function cie(e,t){t===void 0&&(t=!1);var n=fie.get(e.object);die(n.value,e.object,e.patches,"",t),e.patches.length&&sk(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function die(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=rU(t),s=rU(e),a=!1,l=!1,u=s.length-1;u>=0;u--){var c=s[u],f=e[c];if(nU(t,c)&&!(t[c]===void 0&&f!==void 0&&Array.isArray(t)===!1)){var d=t[c];typeof f=="object"&&f!=null&&typeof d=="object"&&d!=null&&Array.isArray(f)===Array.isArray(d)?die(f,d,n,r+"/"+Ph(c),i):f!==d&&(a=!0,i&&n.push({op:"test",path:r+"/"+Ph(c),value:Gs(f)}),n.push({op:"replace",path:r+"/"+Ph(c),value:Gs(d)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Ph(c),value:Gs(f)}),n.push({op:"remove",path:r+"/"+Ph(c)}),l=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),a=!0)}if(!(!l&&o.length==s.length))for(var u=0;u<o.length;u++){var c=o[u];!nU(e,c)&&t[c]!==void 0&&n.push({op:"add",path:r+"/"+Ph(c),value:Gs(t[c])})}}}function gFt(e,t,n){n===void 0&&(n=!1);var r=[];return die(e,t,r,"",n),r}var fie,uFt,cFt,mie=w(()=>{"use strict";zO();aU();fie=new WeakMap,uFt=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),cFt=function(){function e(t,n){this.callback=t,this.observer=n}return e}()});var Fyr,iMe=w(()=>{"use strict";aU();mie();zO();aU();mie();zO();Fyr=Object.assign({},uie,pie,{JsonPatchError:BO,deepClone:Gs,escapePathComponent:Ph,unescapePathComponent:LO})});var sMe=Ee((Pyr,oMe)=>{"use strict";var xFt=/("(?:[^\\"]|\\.)*")|[:,]/g;oMe.exports=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function s(a,l,u){var c,f,d,p,m,h,g,x,b,y,v,C;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),v=JSON.stringify(a,o),v===void 0)return v;if(g=i-l.length-u,v.length<=g&&(b=v.replace(xFt,function(_,S){return S||_+" "}),b.length<=g))return b;if(o!=null&&(a=JSON.parse(v),o=void 0),typeof a=="object"&&a!==null){if(x=l+r,d=[],f=0,Array.isArray(a))for(y="[",c="]",g=a.length;f<g;f++)d.push(s(a[f],x,f===g-1?0:1)||"null");else for(y="{",c="}",h=Object.keys(a),g=h.length;f<g;f++)p=h[f],m=JSON.stringify(p)+": ",C=s(a[p],x,m.length+(f===g-1?0:1)),C!==void 0&&d.push(m+C);if(d.length>0)return[y,r+d.join(`,
`+x),c].join(`
`+l)}return v}(t,"",0)}});var jO=Ee((Lyr,aMe)=>{"use strict";var bFt="2.0.0",yFt=Number.MAX_SAFE_INTEGER||9007199254740991,vFt=16,wFt=250,CFt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];aMe.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:vFt,MAX_SAFE_BUILD_LENGTH:wFt,MAX_SAFE_INTEGER:yFt,RELEASE_TYPES:CFt,SEMVER_SPEC_VERSION:bFt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var VO=Ee((Byr,lMe)=>{"use strict";var _Ft=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};lMe.exports=_Ft});var ak=Ee((Ux,uMe)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:hie,MAX_SAFE_BUILD_LENGTH:SFt,MAX_LENGTH:EFt}=jO(),AFt=VO();Ux=uMe.exports={};var TFt=Ux.re=[],kFt=Ux.safeRe=[],it=Ux.src=[],ot=Ux.t={},IFt=0,gie="[a-zA-Z0-9-]",DFt=[["\\s",1],["\\d",EFt],[gie,SFt]],NFt=e=>{for(let[t,n]of DFt)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e},un=(e,t,n)=>{let r=NFt(t),i=IFt++;AFt(e,i,t),ot[e]=i,it[i]=t,TFt[i]=new RegExp(t,n?"g":void 0),kFt[i]=new RegExp(r,n?"g":void 0)};un("NUMERICIDENTIFIER","0|[1-9]\\d*");un("NUMERICIDENTIFIERLOOSE","\\d+");un("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${gie}*`);un("MAINVERSION",`(${it[ot.NUMERICIDENTIFIER]})\\.(${it[ot.NUMERICIDENTIFIER]})\\.(${it[ot.NUMERICIDENTIFIER]})`);un("MAINVERSIONLOOSE",`(${it[ot.NUMERICIDENTIFIERLOOSE]})\\.(${it[ot.NUMERICIDENTIFIERLOOSE]})\\.(${it[ot.NUMERICIDENTIFIERLOOSE]})`);un("PRERELEASEIDENTIFIER",`(?:${it[ot.NUMERICIDENTIFIER]}|${it[ot.NONNUMERICIDENTIFIER]})`);un("PRERELEASEIDENTIFIERLOOSE",`(?:${it[ot.NUMERICIDENTIFIERLOOSE]}|${it[ot.NONNUMERICIDENTIFIER]})`);un("PRERELEASE",`(?:-(${it[ot.PRERELEASEIDENTIFIER]}(?:\\.${it[ot.PRERELEASEIDENTIFIER]})*))`);un("PRERELEASELOOSE",`(?:-?(${it[ot.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${it[ot.PRERELEASEIDENTIFIERLOOSE]})*))`);un("BUILDIDENTIFIER",`${gie}+`);un("BUILD",`(?:\\+(${it[ot.BUILDIDENTIFIER]}(?:\\.${it[ot.BUILDIDENTIFIER]})*))`);un("FULLPLAIN",`v?${it[ot.MAINVERSION]}${it[ot.PRERELEASE]}?${it[ot.BUILD]}?`);un("FULL",`^${it[ot.FULLPLAIN]}$`);un("LOOSEPLAIN",`[v=\\s]*${it[ot.MAINVERSIONLOOSE]}${it[ot.PRERELEASELOOSE]}?${it[ot.BUILD]}?`);un("LOOSE",`^${it[ot.LOOSEPLAIN]}$`);un("GTLT","((?:<|>)?=?)");un("XRANGEIDENTIFIERLOOSE",`${it[ot.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);un("XRANGEIDENTIFIER",`${it[ot.NUMERICIDENTIFIER]}|x|X|\\*`);un("XRANGEPLAIN",`[v=\\s]*(${it[ot.XRANGEIDENTIFIER]})(?:\\.(${it[ot.XRANGEIDENTIFIER]})(?:\\.(${it[ot.XRANGEIDENTIFIER]})(?:${it[ot.PRERELEASE]})?${it[ot.BUILD]}?)?)?`);un("XRANGEPLAINLOOSE",`[v=\\s]*(${it[ot.XRANGEIDENTIFIERLOOSE]})(?:\\.(${it[ot.XRANGEIDENTIFIERLOOSE]})(?:\\.(${it[ot.XRANGEIDENTIFIERLOOSE]})(?:${it[ot.PRERELEASELOOSE]})?${it[ot.BUILD]}?)?)?`);un("XRANGE",`^${it[ot.GTLT]}\\s*${it[ot.XRANGEPLAIN]}$`);un("XRANGELOOSE",`^${it[ot.GTLT]}\\s*${it[ot.XRANGEPLAINLOOSE]}$`);un("COERCEPLAIN",`(^|[^\\d])(\\d{1,${hie}})(?:\\.(\\d{1,${hie}}))?(?:\\.(\\d{1,${hie}}))?`);un("COERCE",`${it[ot.COERCEPLAIN]}(?:$|[^\\d])`);un("COERCEFULL",it[ot.COERCEPLAIN]+`(?:${it[ot.PRERELEASE]})?(?:${it[ot.BUILD]})?(?:$|[^\\d])`);un("COERCERTL",it[ot.COERCE],!0);un("COERCERTLFULL",it[ot.COERCEFULL],!0);un("LONETILDE","(?:~>?)");un("TILDETRIM",`(\\s*)${it[ot.LONETILDE]}\\s+`,!0);Ux.tildeTrimReplace="$1~";un("TILDE",`^${it[ot.LONETILDE]}${it[ot.XRANGEPLAIN]}$`);un("TILDELOOSE",`^${it[ot.LONETILDE]}${it[ot.XRANGEPLAINLOOSE]}$`);un("LONECARET","(?:\\^)");un("CARETTRIM",`(\\s*)${it[ot.LONECARET]}\\s+`,!0);Ux.caretTrimReplace="$1^";un("CARET",`^${it[ot.LONECARET]}${it[ot.XRANGEPLAIN]}$`);un("CARETLOOSE",`^${it[ot.LONECARET]}${it[ot.XRANGEPLAINLOOSE]}$`);un("COMPARATORLOOSE",`^${it[ot.GTLT]}\\s*(${it[ot.LOOSEPLAIN]})$|^$`);un("COMPARATOR",`^${it[ot.GTLT]}\\s*(${it[ot.FULLPLAIN]})$|^$`);un("COMPARATORTRIM",`(\\s*)${it[ot.GTLT]}\\s*(${it[ot.LOOSEPLAIN]}|${it[ot.XRANGEPLAIN]})`,!0);Ux.comparatorTrimReplace="$1$2$3";un("HYPHENRANGE",`^\\s*(${it[ot.XRANGEPLAIN]})\\s+-\\s+(${it[ot.XRANGEPLAIN]})\\s*$`);un("HYPHENRANGELOOSE",`^\\s*(${it[ot.XRANGEPLAINLOOSE]})\\s+-\\s+(${it[ot.XRANGEPLAINLOOSE]})\\s*$`);un("STAR","(<|>)?=?\\s*\\*");un("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");un("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var lU=Ee((zyr,cMe)=>{"use strict";var FFt=Object.freeze({loose:!0}),RFt=Object.freeze({}),OFt=e=>e?typeof e!="object"?FFt:e:RFt;cMe.exports=OFt});var xie=Ee((Uyr,pMe)=>{"use strict";var fMe=/^[0-9]+$/,dMe=(e,t)=>{let n=fMe.test(e),r=fMe.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},MFt=(e,t)=>dMe(t,e);pMe.exports={compareIdentifiers:dMe,rcompareIdentifiers:MFt}});var va=Ee((jyr,xMe)=>{"use strict";var uU=VO(),{MAX_LENGTH:mMe,MAX_SAFE_INTEGER:cU}=jO(),{safeRe:hMe,t:gMe}=ak(),$Ft=lU(),{compareIdentifiers:lk}=xie(),bie=class e{constructor(t,n){if(n=$Ft(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>mMe)throw new TypeError(`version is longer than ${mMe} characters`);uU("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;let r=t.trim().match(n.loose?hMe[gMe.LOOSE]:hMe[gMe.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>cU||this.major<0)throw new TypeError("Invalid major version");if(this.minor>cU||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>cU||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<cU)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(uU("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if(typeof t=="string"&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),lk(this.major,t.major)||lk(this.minor,t.minor)||lk(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{let r=this.prerelease[n],i=t.prerelease[n];if(uU("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return lk(r,i)}while(++n)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let n=0;do{let r=this.build[n],i=t.build[n];if(uU("build compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return lk(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let o=[n,i];r===!1&&(o=[n]),lk(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};xMe.exports=bie});var oS=Ee((Vyr,yMe)=>{"use strict";var bMe=va(),PFt=(e,t,n=!1)=>{if(e instanceof bMe)return e;try{return new bMe(e,t)}catch(r){if(!n)return null;throw r}};yMe.exports=PFt});var wMe=Ee((Wyr,vMe)=>{"use strict";var LFt=oS(),BFt=(e,t)=>{let n=LFt(e,t);return n?n.version:null};vMe.exports=BFt});var _Me=Ee((Gyr,CMe)=>{"use strict";var zFt=oS(),UFt=(e,t)=>{let n=zFt(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};CMe.exports=UFt});var AMe=Ee((qyr,EMe)=>{"use strict";var SMe=va(),jFt=(e,t,n,r,i)=>{typeof n=="string"&&(i=r,r=n,n=void 0);try{return new SMe(e instanceof SMe?e.version:e,n).inc(t,r,i).version}catch{return null}};EMe.exports=jFt});var IMe=Ee((Hyr,kMe)=>{"use strict";var TMe=oS(),VFt=(e,t)=>{let n=TMe(e,null,!0),r=TMe(t,null,!0),i=n.compare(r);if(i===0)return null;let o=i>0,s=o?n:r,a=o?r:n,l=!!s.prerelease.length;if(!!a.prerelease.length&&!l)return!a.patch&&!a.minor?"major":s.patch?"patch":s.minor?"minor":"major";let c=l?"pre":"";return n.major!==r.major?c+"major":n.minor!==r.minor?c+"minor":n.patch!==r.patch?c+"patch":"prerelease"};kMe.exports=VFt});var NMe=Ee((Yyr,DMe)=>{"use strict";var WFt=va(),GFt=(e,t)=>new WFt(e,t).major;DMe.exports=GFt});var RMe=Ee((Kyr,FMe)=>{"use strict";var qFt=va(),HFt=(e,t)=>new qFt(e,t).minor;FMe.exports=HFt});var MMe=Ee((Xyr,OMe)=>{"use strict";var YFt=va(),KFt=(e,t)=>new YFt(e,t).patch;OMe.exports=KFt});var PMe=Ee((Zyr,$Me)=>{"use strict";var XFt=oS(),ZFt=(e,t)=>{let n=XFt(e,t);return n&&n.prerelease.length?n.prerelease:null};$Me.exports=ZFt});var _f=Ee((Qyr,BMe)=>{"use strict";var LMe=va(),QFt=(e,t,n)=>new LMe(e,n).compare(new LMe(t,n));BMe.exports=QFt});var UMe=Ee((Jyr,zMe)=>{"use strict";var JFt=_f(),eRt=(e,t,n)=>JFt(t,e,n);zMe.exports=eRt});var VMe=Ee((evr,jMe)=>{"use strict";var tRt=_f(),nRt=(e,t)=>tRt(e,t,!0);jMe.exports=nRt});var fU=Ee((tvr,GMe)=>{"use strict";var WMe=va(),rRt=(e,t,n)=>{let r=new WMe(e,n),i=new WMe(t,n);return r.compare(i)||r.compareBuild(i)};GMe.exports=rRt});var HMe=Ee((nvr,qMe)=>{"use strict";var iRt=fU(),oRt=(e,t)=>e.sort((n,r)=>iRt(n,r,t));qMe.exports=oRt});var KMe=Ee((rvr,YMe)=>{"use strict";var sRt=fU(),aRt=(e,t)=>e.sort((n,r)=>sRt(r,n,t));YMe.exports=aRt});var WO=Ee((ivr,XMe)=>{"use strict";var lRt=_f(),uRt=(e,t,n)=>lRt(e,t,n)>0;XMe.exports=uRt});var dU=Ee((ovr,ZMe)=>{"use strict";var cRt=_f(),fRt=(e,t,n)=>cRt(e,t,n)<0;ZMe.exports=fRt});var yie=Ee((svr,QMe)=>{"use strict";var dRt=_f(),pRt=(e,t,n)=>dRt(e,t,n)===0;QMe.exports=pRt});var vie=Ee((avr,JMe)=>{"use strict";var mRt=_f(),hRt=(e,t,n)=>mRt(e,t,n)!==0;JMe.exports=hRt});var pU=Ee((lvr,e3e)=>{"use strict";var gRt=_f(),xRt=(e,t,n)=>gRt(e,t,n)>=0;e3e.exports=xRt});var mU=Ee((uvr,t3e)=>{"use strict";var bRt=_f(),yRt=(e,t,n)=>bRt(e,t,n)<=0;t3e.exports=yRt});var wie=Ee((cvr,n3e)=>{"use strict";var vRt=yie(),wRt=vie(),CRt=WO(),_Rt=pU(),SRt=dU(),ERt=mU(),ARt=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return vRt(e,n,r);case"!=":return wRt(e,n,r);case">":return CRt(e,n,r);case">=":return _Rt(e,n,r);case"<":return SRt(e,n,r);case"<=":return ERt(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};n3e.exports=ARt});var i3e=Ee((fvr,r3e)=>{"use strict";var TRt=va(),kRt=oS(),{safeRe:hU,t:gU}=ak(),IRt=(e,t)=>{if(e instanceof TRt)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(t.includePrerelease?hU[gU.COERCEFULL]:hU[gU.COERCE]);else{let l=t.includePrerelease?hU[gU.COERCERTLFULL]:hU[gU.COERCERTL],u;for(;(u=l.exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||u.index+u[0].length!==n.index+n[0].length)&&(n=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(n===null)return null;let r=n[2],i=n[3]||"0",o=n[4]||"0",s=t.includePrerelease&&n[5]?`-${n[5]}`:"",a=t.includePrerelease&&n[6]?`+${n[6]}`:"";return kRt(`${r}.${i}.${o}${s}${a}`,t)};r3e.exports=IRt});var s3e=Ee((dvr,o3e)=>{"use strict";var Cie=class{constructor(){this.max=1e3,this.map=new Map}get(t){let n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(t,n)}return this}};o3e.exports=Cie});var Sf=Ee((pvr,c3e)=>{"use strict";var _ie=class e{constructor(t,n){if(n=NRt(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof Sie)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!l3e(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&LRt(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){let r=((this.options.includePrerelease&&$Rt)|(this.options.loose&&PRt))+":"+t,i=a3e.get(r);if(i)return i;let o=this.options.loose,s=o?ru[ml.HYPHENRANGELOOSE]:ru[ml.HYPHENRANGE];t=t.replace(s,YRt(this.options.includePrerelease)),oi("hyphen replace",t),t=t.replace(ru[ml.COMPARATORTRIM],RRt),oi("comparator trim",t),t=t.replace(ru[ml.TILDETRIM],ORt),oi("tilde trim",t),t=t.replace(ru[ml.CARETTRIM],MRt),oi("caret trim",t);let a=t.split(" ").map(f=>BRt(f,this.options)).join(" ").split(/\s+/).map(f=>HRt(f,this.options));o&&(a=a.filter(f=>(oi("loose invalid filter",f,this.options),!!f.match(ru[ml.COMPARATORLOOSE])))),oi("range list",a);let l=new Map,u=a.map(f=>new Sie(f,this.options));for(let f of u){if(l3e(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");let c=[...l.values()];return a3e.set(r,c),c}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(r=>u3e(r,n)&&t.set.some(i=>u3e(i,n)&&r.every(o=>i.every(s=>o.intersects(s,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new FRt(t,this.options)}catch{return!1}for(let n=0;n<this.set.length;n++)if(KRt(this.set[n],t,this.options))return!0;return!1}};c3e.exports=_ie;var DRt=s3e(),a3e=new DRt,NRt=lU(),Sie=GO(),oi=VO(),FRt=va(),{safeRe:ru,t:ml,comparatorTrimReplace:RRt,tildeTrimReplace:ORt,caretTrimReplace:MRt}=ak(),{FLAG_INCLUDE_PRERELEASE:$Rt,FLAG_LOOSE:PRt}=jO(),l3e=e=>e.value==="<0.0.0-0",LRt=e=>e.value==="",u3e=(e,t)=>{let n=!0,r=e.slice(),i=r.pop();for(;n&&r.length;)n=r.every(o=>i.intersects(o,t)),i=r.pop();return n},BRt=(e,t)=>(oi("comp",e,t),e=jRt(e,t),oi("caret",e),e=zRt(e,t),oi("tildes",e),e=WRt(e,t),oi("xrange",e),e=qRt(e,t),oi("stars",e),e),hl=e=>!e||e.toLowerCase()==="x"||e==="*",zRt=(e,t)=>e.trim().split(/\s+/).map(n=>URt(n,t)).join(" "),URt=(e,t)=>{let n=t.loose?ru[ml.TILDELOOSE]:ru[ml.TILDE];return e.replace(n,(r,i,o,s,a)=>{oi("tilde",e,r,i,o,s,a);let l;return hl(i)?l="":hl(o)?l=`>=${i}.0.0 <${+i+1}.0.0-0`:hl(s)?l=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:a?(oi("replaceTilde pr",a),l=`>=${i}.${o}.${s}-${a} <${i}.${+o+1}.0-0`):l=`>=${i}.${o}.${s} <${i}.${+o+1}.0-0`,oi("tilde return",l),l})},jRt=(e,t)=>e.trim().split(/\s+/).map(n=>VRt(n,t)).join(" "),VRt=(e,t)=>{oi("caret",e,t);let n=t.loose?ru[ml.CARETLOOSE]:ru[ml.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,o,s,a,l)=>{oi("caret",e,i,o,s,a,l);let u;return hl(o)?u="":hl(s)?u=`>=${o}.0.0${r} <${+o+1}.0.0-0`:hl(a)?o==="0"?u=`>=${o}.${s}.0${r} <${o}.${+s+1}.0-0`:u=`>=${o}.${s}.0${r} <${+o+1}.0.0-0`:l?(oi("replaceCaret pr",l),o==="0"?s==="0"?u=`>=${o}.${s}.${a}-${l} <${o}.${s}.${+a+1}-0`:u=`>=${o}.${s}.${a}-${l} <${o}.${+s+1}.0-0`:u=`>=${o}.${s}.${a}-${l} <${+o+1}.0.0-0`):(oi("no pr"),o==="0"?s==="0"?u=`>=${o}.${s}.${a}${r} <${o}.${s}.${+a+1}-0`:u=`>=${o}.${s}.${a}${r} <${o}.${+s+1}.0-0`:u=`>=${o}.${s}.${a} <${+o+1}.0.0-0`),oi("caret return",u),u})},WRt=(e,t)=>(oi("replaceXRanges",e,t),e.split(/\s+/).map(n=>GRt(n,t)).join(" ")),GRt=(e,t)=>{e=e.trim();let n=t.loose?ru[ml.XRANGELOOSE]:ru[ml.XRANGE];return e.replace(n,(r,i,o,s,a,l)=>{oi("xRange",e,r,i,o,s,a,l);let u=hl(o),c=u||hl(s),f=c||hl(a),d=f;return i==="="&&d&&(i=""),l=t.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(s=0),a=0,i===">"?(i=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",c?o=+o+1:s=+s+1),i==="<"&&(l="-0"),r=`${i+o}.${s}.${a}${l}`):c?r=`>=${o}.0.0${l} <${+o+1}.0.0-0`:f&&(r=`>=${o}.${s}.0${l} <${o}.${+s+1}.0-0`),oi("xRange return",r),r})},qRt=(e,t)=>(oi("replaceStars",e,t),e.trim().replace(ru[ml.STAR],"")),HRt=(e,t)=>(oi("replaceGTE0",e,t),e.trim().replace(ru[t.includePrerelease?ml.GTE0PRE:ml.GTE0],"")),YRt=e=>(t,n,r,i,o,s,a,l,u,c,f,d)=>(hl(r)?n="":hl(i)?n=`>=${r}.0.0${e?"-0":""}`:hl(o)?n=`>=${r}.${i}.0${e?"-0":""}`:s?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,hl(u)?l="":hl(c)?l=`<${+u+1}.0.0-0`:hl(f)?l=`<${u}.${+c+1}.0-0`:d?l=`<=${u}.${c}.${f}-${d}`:e?l=`<${u}.${c}.${+f+1}-0`:l=`<=${l}`,`${n} ${l}`.trim()),KRt=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(oi(e[r].semver),e[r].semver!==Sie.ANY&&e[r].semver.prerelease.length>0){let i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}});var GO=Ee((mvr,g3e)=>{"use strict";var qO=Symbol("SemVer ANY"),Tie=class e{static get ANY(){return qO}constructor(t,n){if(n=f3e(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),Aie("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===qO?this.value="":this.value=this.operator+this.semver.version,Aie("comp",this)}parse(t){let n=this.options.loose?d3e[p3e.COMPARATORLOOSE]:d3e[p3e.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new m3e(r[2],this.options.loose):this.semver=qO}toString(){return this.value}test(t){if(Aie("Comparator.test",t,this.options.loose),this.semver===qO||t===qO)return!0;if(typeof t=="string")try{t=new m3e(t,this.options)}catch{return!1}return Eie(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new h3e(t.value,n).test(this.value):t.operator===""?t.value===""?!0:new h3e(this.value,n).test(t.semver):(n=f3e(n),n.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!n.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||Eie(this.semver,"<",t.semver,n)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||Eie(this.semver,">",t.semver,n)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};g3e.exports=Tie;var f3e=lU(),{safeRe:d3e,t:p3e}=ak(),Eie=wie(),Aie=VO(),m3e=va(),h3e=Sf()});var HO=Ee((hvr,x3e)=>{"use strict";var XRt=Sf(),ZRt=(e,t,n)=>{try{t=new XRt(t,n)}catch{return!1}return t.test(e)};x3e.exports=ZRt});var y3e=Ee((gvr,b3e)=>{"use strict";var QRt=Sf(),JRt=(e,t)=>new QRt(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));b3e.exports=JRt});var w3e=Ee((xvr,v3e)=>{"use strict";var eOt=va(),tOt=Sf(),nOt=(e,t,n)=>{let r=null,i=null,o=null;try{o=new tOt(t,n)}catch{return null}return e.forEach(s=>{o.test(s)&&(!r||i.compare(s)===-1)&&(r=s,i=new eOt(r,n))}),r};v3e.exports=nOt});var _3e=Ee((bvr,C3e)=>{"use strict";var rOt=va(),iOt=Sf(),oOt=(e,t,n)=>{let r=null,i=null,o=null;try{o=new iOt(t,n)}catch{return null}return e.forEach(s=>{o.test(s)&&(!r||i.compare(s)===1)&&(r=s,i=new rOt(r,n))}),r};C3e.exports=oOt});var A3e=Ee((yvr,E3e)=>{"use strict";var kie=va(),sOt=Sf(),S3e=WO(),aOt=(e,t)=>{e=new sOt(e,t);let n=new kie("0.0.0");if(e.test(n)||(n=new kie("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){let i=e.set[r],o=null;i.forEach(s=>{let a=new kie(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!o||S3e(a,o))&&(o=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),o&&(!n||S3e(n,o))&&(n=o)}return n&&e.test(n)?n:null};E3e.exports=aOt});var k3e=Ee((vvr,T3e)=>{"use strict";var lOt=Sf(),uOt=(e,t)=>{try{return new lOt(e,t).range||"*"}catch{return null}};T3e.exports=uOt});var xU=Ee((wvr,F3e)=>{"use strict";var cOt=va(),N3e=GO(),{ANY:fOt}=N3e,dOt=Sf(),pOt=HO(),I3e=WO(),D3e=dU(),mOt=mU(),hOt=pU(),gOt=(e,t,n,r)=>{e=new cOt(e,r),t=new dOt(t,r);let i,o,s,a,l;switch(n){case">":i=I3e,o=mOt,s=D3e,a=">",l=">=";break;case"<":i=D3e,o=hOt,s=I3e,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(pOt(e,t,r))return!1;for(let u=0;u<t.set.length;++u){let c=t.set[u],f=null,d=null;if(c.forEach(p=>{p.semver===fOt&&(p=new N3e(">=0.0.0")),f=f||p,d=d||p,i(p.semver,f.semver,r)?f=p:s(p.semver,d.semver,r)&&(d=p)}),f.operator===a||f.operator===l||(!d.operator||d.operator===a)&&o(e,d.semver))return!1;if(d.operator===l&&s(e,d.semver))return!1}return!0};F3e.exports=gOt});var O3e=Ee((Cvr,R3e)=>{"use strict";var xOt=xU(),bOt=(e,t,n)=>xOt(e,t,">",n);R3e.exports=bOt});var $3e=Ee((_vr,M3e)=>{"use strict";var yOt=xU(),vOt=(e,t,n)=>yOt(e,t,"<",n);M3e.exports=vOt});var B3e=Ee((Svr,L3e)=>{"use strict";var P3e=Sf(),wOt=(e,t,n)=>(e=new P3e(e,n),t=new P3e(t,n),e.intersects(t,n));L3e.exports=wOt});var U3e=Ee((Evr,z3e)=>{"use strict";var COt=HO(),_Ot=_f();z3e.exports=(e,t,n)=>{let r=[],i=null,o=null,s=e.sort((c,f)=>_Ot(c,f,n));for(let c of s)COt(c,t,n)?(o=c,i||(i=c)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);let a=[];for(let[c,f]of r)c===f?a.push(c):!f&&c===s[0]?a.push("*"):f?c===s[0]?a.push(`<=${f}`):a.push(`${c} - ${f}`):a.push(`>=${c}`);let l=a.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return l.length<u.length?l:t}});var H3e=Ee((Avr,q3e)=>{"use strict";var j3e=Sf(),Die=GO(),{ANY:Iie}=Die,YO=HO(),Nie=_f(),SOt=(e,t,n={})=>{if(e===t)return!0;e=new j3e(e,n),t=new j3e(t,n);let r=!1;e:for(let i of e.set){for(let o of t.set){let s=AOt(i,o,n);if(r=r||s!==null,s)continue e}if(r)return!1}return!0},EOt=[new Die(">=0.0.0-0")],V3e=[new Die(">=0.0.0")],AOt=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Iie){if(t.length===1&&t[0].semver===Iie)return!0;n.includePrerelease?e=EOt:e=V3e}if(t.length===1&&t[0].semver===Iie){if(n.includePrerelease)return!0;t=V3e}let r=new Set,i,o;for(let p of e)p.operator===">"||p.operator===">="?i=W3e(i,p,n):p.operator==="<"||p.operator==="<="?o=G3e(o,p,n):r.add(p.semver);if(r.size>1)return null;let s;if(i&&o){if(s=Nie(i.semver,o.semver,n),s>0)return null;if(s===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let p of r){if(i&&!YO(p,String(i),n)||o&&!YO(p,String(o),n))return null;for(let m of t)if(!YO(p,String(m),n))return!1;return!0}let a,l,u,c,f=o&&!n.includePrerelease&&o.semver.prerelease.length?o.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&o.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(let p of t){if(c=c||p.operator===">"||p.operator===">=",u=u||p.operator==="<"||p.operator==="<=",i){if(d&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===d.major&&p.semver.minor===d.minor&&p.semver.patch===d.patch&&(d=!1),p.operator===">"||p.operator===">="){if(a=W3e(i,p,n),a===p&&a!==i)return!1}else if(i.operator===">="&&!YO(i.semver,String(p),n))return!1}if(o){if(f&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===f.major&&p.semver.minor===f.minor&&p.semver.patch===f.patch&&(f=!1),p.operator==="<"||p.operator==="<="){if(l=G3e(o,p,n),l===p&&l!==o)return!1}else if(o.operator==="<="&&!YO(o.semver,String(p),n))return!1}if(!p.operator&&(o||i)&&s!==0)return!1}return!(i&&u&&!o&&s!==0||o&&c&&!i&&s!==0||d||f)},W3e=(e,t,n)=>{if(!e)return t;let r=Nie(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},G3e=(e,t,n)=>{if(!e)return t;let r=Nie(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};q3e.exports=SOt});var Z3e=Ee((Tvr,X3e)=>{"use strict";var Fie=ak(),Y3e=jO(),TOt=va(),K3e=xie(),kOt=oS(),IOt=wMe(),DOt=_Me(),NOt=AMe(),FOt=IMe(),ROt=NMe(),OOt=RMe(),MOt=MMe(),$Ot=PMe(),POt=_f(),LOt=UMe(),BOt=VMe(),zOt=fU(),UOt=HMe(),jOt=KMe(),VOt=WO(),WOt=dU(),GOt=yie(),qOt=vie(),HOt=pU(),YOt=mU(),KOt=wie(),XOt=i3e(),ZOt=GO(),QOt=Sf(),JOt=HO(),eMt=y3e(),tMt=w3e(),nMt=_3e(),rMt=A3e(),iMt=k3e(),oMt=xU(),sMt=O3e(),aMt=$3e(),lMt=B3e(),uMt=U3e(),cMt=H3e();X3e.exports={parse:kOt,valid:IOt,clean:DOt,inc:NOt,diff:FOt,major:ROt,minor:OOt,patch:MOt,prerelease:$Ot,compare:POt,rcompare:LOt,compareLoose:BOt,compareBuild:zOt,sort:UOt,rsort:jOt,gt:VOt,lt:WOt,eq:GOt,neq:qOt,gte:HOt,lte:YOt,cmp:KOt,coerce:XOt,Comparator:ZOt,Range:QOt,satisfies:JOt,toComparators:eMt,maxSatisfying:tMt,minSatisfying:nMt,minVersion:rMt,validRange:iMt,outside:oMt,gtr:sMt,ltr:aMt,intersects:lMt,simplifyRange:uMt,subset:cMt,SemVer:TOt,re:Fie.re,src:Fie.src,tokens:Fie.t,SEMVER_SPEC_VERSION:Y3e.SEMVER_SPEC_VERSION,RELEASE_TYPES:Y3e.RELEASE_TYPES,compareIdentifiers:K3e.compareIdentifiers,rcompareIdentifiers:K3e.rcompareIdentifiers}});function hc(e,t,n){return e.fields=t||[],e.fname=n,e}function si(e){return e==null?null:e.fname}function Xo(e){return e==null?null:e.fields}function J3e(e){return e.length===1?fMt(e[0]):dMt(e)}function Se(e){throw Error(e)}function XO(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a),o+=e.substring(++a,++a),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||Se("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&Se("Access path missing closing bracket: "+e),r&&Se("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function Wd(e,t,n){let r=XO(e);return e=r.length===1?r[0]:e,hc((n&&n.get||J3e)(r),[e],t||e)}function bU(e,t,n){let r=[t].concat([].slice.call(n));console[e].apply(console,r)}function mMt(e,t){let n=e||e$e;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=t$e&&bU(t||"error","ERROR",arguments),this},warn(){return n>=n$e&&bU(t||"warn","WARN",arguments),this},info(){return n>=r$e&&bU(t||"log","INFO",arguments),this},debug(){return n>=i$e&&bU(t||"log","DEBUG",arguments),this}}}function tn(e){return e===Object(e)}function uk(...e){return e.reduce((t,n)=>{for(let r in n)if(r==="signals")t.signals=hMt(t.signals,n.signals);else{let i=r==="legend"?{layout:1}:r==="style"?!0:null;ZO(t,r,n[r],i)}return t},{})}function ZO(e,t,n,r){if(!Q3e(t))return;let i,o;if(tn(n)&&!Vt(n)){o=tn(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?ZO(o,i,n[i]):Q3e(i)&&(o[i]=n[i])}else e[t]=n}function hMt(e,t){if(e==null)return t;let n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function Fn(e){return e[e.length-1]}function qd(e){return e==null||e===""?null:+e}function wU(e,t,n,r){let i=n(e[0]),o=n(Fn(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function gMt(e,t){return wU(e,t,qd,gl)}function xMt(e,t){var n=Math.sign(e[0]);return wU(e,t,s$e(n),o$e(n))}function bMt(e,t,n){return wU(e,t,vU(n),vU(1/n))}function yMt(e,t,n){return wU(e,t,a$e(n),l$e(n))}function CU(e,t,n,r,i){let o=r(e[0]),s=r(Fn(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function Rie(e,t,n){return CU(e,t,n,qd,gl)}function Oie(e,t,n){let r=Math.sign(e[0]);return CU(e,t,n,s$e(r),o$e(r))}function _U(e,t,n,r){return CU(e,t,n,vU(r),vU(1/r))}function Mie(e,t,n,r){return CU(e,t,n,a$e(r),l$e(r))}function vMt(e){return 1+~~(new Date(e).getMonth()/3)}function wMt(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Rt(e){return e!=null?Vt(e)?e:[e]:[]}function CMt(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function wn(e){return typeof e=="function"}function $ie(e,t,n){n=n||{},t=Rt(t)||[];let r=[],i=[],o={},s=n.comparator||SMt;return Rt(e).forEach((a,l)=>{a!=null&&(r.push(t[l]===_Mt?-1:1),i.push(a=wn(a)?a:Wd(a,null,n)),(Xo(a)||[]).forEach(u=>o[u]=1))}),i.length===0?null:hc(s(i,r),Object.keys(o))}function ps(e){return wn(e)?e:()=>e}function Pie(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Jt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Hd(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function Lie(e,t){let n=e.length,r=-1,i,o,s,a,l;if(t==null){for(;++r<n;)if(o=e[r],o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=l=r;++r<n;)o=e[r],o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,l=r))}else{for(;++r<n;)if(o=t(e[r],r,e),o!=null&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=l=r;++r<n;)o=t(e[r],r,e),o!=null&&(i>o&&(i=o,a=r),s<o&&(s=o,l=r))}return[a,l]}function Dt(e,t){return TMt.call(e,t)}function Dv(e){let t={},n;function r(o){return Dt(t,o)&&t[o]!==yU}let i={size:0,empty:0,object:t,has:r,get(o){return r(o)?t[o]:void 0},set(o,s){return r(o)||(++i.size,t[o]===yU&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=yU),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){let o={},s=0;for(let a in t){let l=t[a];l!==yU&&(!n||!n(l))&&(o[a]=l,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function kMt(e,t,n,r,i,o){if(!n&&n!==0)return o;let s=+n,a=e[0],l=Fn(e),u;l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);let c=Math.abs(l-t);return u<c&&u<=s?r:c<=s?i:o}function $e(e,t,n){let r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Jt(r,n)}function IMt(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function Bie(e){return typeof e=="boolean"}function JO(e){return Object.prototype.toString.call(e)==="[object Date]"}function zie(e){return e&&wn(e[Symbol.iterator])}function zh(e){return typeof e=="number"}function DMt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function zn(e){return typeof e=="string"}function Uie(e,t,n){e&&(e=t?Rt(e).map(a=>a.replace(/\\(.)/g,"$1")):Rt(e));let r=e&&e.length,i=n&&n.get||J3e,o=a=>i(t?[a]:XO(a)),s;if(!r)s=function(){return""};else if(r===1){let a=o(e[0]);s=function(l){return""+a(l)}}else{let a=e.map(o);s=function(l){let u=""+a[0](l),c=0;for(;++c<r;)u+="|"+a[c](l);return u}}return hc(s,e,"key")}function NMt(e,t){let n=e[0],r=Fn(e),i=+t;return i?i===1?r:n+i*(r-n):n}function jie(e){e=+e||FMt;let t,n,r,i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>Dt(t,s)||Dt(n,s),get:s=>Dt(t,s)?t[s]:Dt(n,s)?o(s,n[s]):void 0,set:(s,a)=>Dt(t,s)?t[s]=a:o(s,a)}}function Vie(e,t,n,r){let i=t.length,o=n.length;if(!o)return t;if(!i)return n;let s=r||new t.constructor(i+o),a=0,l=0,u=0;for(;a<i&&l<o;++u)s[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<i;++a,++u)s[u]=t[a];for(;l<o;++l,++u)s[u]=n[l];return s}function KO(e,t){let n="";for(;--t>=0;)n+=e;return n}function RMt(e,t,n,r){let i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?KO(i,s)+o:r==="center"?KO(i,~~(s/2))+o+KO(i,Math.ceil(s/2)):o+KO(i,s)}function sS(e){return e&&Fn(e)-e[0]||0}function Ot(e){return Vt(e)?"["+e.map(Ot)+"]":tn(e)||zn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Wie(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}function Gie(e,t){return t=t||OMt,e==null||e===""?null:t(e)}function qie(e){return e==null||e===""?null:e+""}function wa(e){let t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function MMt(e,t,n,r){let i=r??"\u2026",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function $Mt(e,t,n){if(e)if(t){let r=e.length;for(let i=0;i<r;++i){let o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var fMt,dMt,pMt,gl,Gd,Lh,Bh,jx,e$e,t$e,n$e,r$e,i$e,Vt,Q3e,o$e,s$e,a$e,l$e,vU,_Mt,QO,SMt,EMt,AMt,TMt,yU,FMt,OMt,ao=w(()=>{"use strict";fMt=e=>function(t){return t[e]},dMt=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};pMt=Wd("id"),gl=hc(e=>e,[],"identity"),Gd=hc(()=>0,[],"zero"),Lh=hc(()=>1,[],"one"),Bh=hc(()=>!0,[],"true"),jx=hc(()=>!1,[],"false");e$e=0,t$e=1,n$e=2,r$e=3,i$e=4;Vt=Array.isArray;Q3e=e=>e!=="__proto__";o$e=e=>t=>e*Math.exp(t),s$e=e=>t=>Math.log(e*t),a$e=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),l$e=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,vU=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);_Mt="descending";QO=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),SMt=(e,t)=>e.length===1?EMt(e[0],t[0]):AMt(e,t,e.length),EMt=(e,t)=>function(n,r){return QO(e(n),e(r))*t},AMt=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=QO(o(r),o(i));return s*t[a]});TMt=Object.prototype.hasOwnProperty;yU={};FMt=1e4;OMt=e=>zh(e)||JO(e)?e:Date.parse(e)});function ck(e,t,n){return e.fields=t||[],e.fname=n,e}function PMt(e){return e.length===1?LMt(e[0]):BMt(e)}function So(e){throw Error(e)}function zMt(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||So("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&So("Access path missing closing bracket: "+e),r&&So("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function Hie(e,t,n){let r=zMt(e);return e=r.length===1?r[0]:e,ck((n&&n.get||PMt)(r),[e],t||e)}function VMt(e,t,n){let r=[t].concat([].slice.call(n));console[e].apply(console,r)}function u$e(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:VMt,r=e||WMt;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=Yie&&n(t||"error","ERROR",arguments),this},warn(){return r>=GMt&&n(t||"warn","WARN",arguments),this},info(){return r>=qMt&&n(t||"log","INFO",arguments),this},debug(){return r>=HMt&&n(t||"log","DEBUG",arguments),this}}}function tM(e){return e===Object(e)}function Kie(e){return e==null||e===""?null:+e}function dk(e){return e!=null?Ef(e)?e:[e]:[]}function gc(e){return typeof e=="function"}function nM(e){return gc(e)?e:()=>e}function c$e(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Uh(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function pk(e,t){return YMt.call(e,t)}function Xie(e,t,n){let r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Uh(r,n)}function KMt(e){return Object.prototype.toString.call(e)==="[object Date]"}function f$e(e){return e&&gc(e[Symbol.iterator])}function XMt(e){return typeof e=="number"}function EU(e){return typeof e=="string"}function AU(e){return Ef(e)?"["+e.map(AU)+"]":tM(e)||EU(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function d$e(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}function p$e(e,t){return t=t||ZMt,e==null||e===""?null:t(e)}function m$e(e){return e==null||e===""?null:e+""}function Nv(e,t,n){if(e)if(t){let r=e.length;for(let i=0;i<r;++i){let o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var LMt,BMt,eM,fk,UMt,jMt,SU,Ivr,WMt,Yie,GMt,qMt,HMt,Ef,YMt,ZMt,rM=w(()=>{"use strict";LMt=e=>function(t){return t[e]},BMt=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};eM=Hie("id"),fk=ck(e=>e,[],"identity"),UMt=ck(()=>0,[],"zero"),jMt=ck(()=>1,[],"one"),SU=ck(()=>!0,[],"true"),Ivr=ck(()=>!1,[],"false");WMt=0,Yie=1,GMt=2,qMt=3,HMt=4;Ef=Array.isArray;YMt=Object.prototype.hasOwnProperty;ZMt=e=>XMt(e)||KMt(e)?e:Date.parse(e)});function x$e(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function QMt(e,t){var n=x$e(e);return function(r,i){return t(n(r),i,e)}}function g$e(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function iu(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function JMt(e){return e<0?"-"+iu(-e,6):e>9999?"+"+iu(e,6):iu(e,4)}function e3t(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":JMt(e.getUTCFullYear(),4)+"-"+iu(e.getUTCMonth()+1,2)+"-"+iu(e.getUTCDate(),2)+(i?"T"+iu(t,2)+":"+iu(n,2)+":"+iu(r,2)+"."+iu(i,3)+"Z":r?"T"+iu(t,2)+":"+iu(n,2)+":"+iu(r,2)+"Z":n||t?"T"+iu(t,2)+":"+iu(n,2)+"Z":"")}function eoe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var p,m,h=i(f,function(g,x){if(p)return p(g,x-1);m=g,p=d?QMt(g,d):x$e(g)});return h.columns=m||[],h}function i(f,d){var p=[],m=f.length,h=0,g=0,x,b=m<=0,y=!1;f.charCodeAt(m-1)===iM&&--m,f.charCodeAt(m-1)===Jie&&--m;function v(){if(b)return Zie;if(y)return y=!1,h$e;var _,S=h,E;if(f.charCodeAt(S)===Qie){for(;h++<m&&f.charCodeAt(h)!==Qie||f.charCodeAt(++h)===Qie;);return(_=h)>=m?b=!0:(E=f.charCodeAt(h++))===iM?y=!0:E===Jie&&(y=!0,f.charCodeAt(h)===iM&&++h),f.slice(S+1,_-1).replace(/""/g,'"')}for(;h<m;){if((E=f.charCodeAt(_=h++))===iM)y=!0;else if(E===Jie)y=!0,f.charCodeAt(h)===iM&&++h;else if(E!==n)continue;return f.slice(S,_)}return b=!0,f.slice(S,m)}for(;(x=v())!==Zie;){for(var C=[];x!==h$e&&x!==Zie;)C.push(x),x=v();d&&(C=d(C,g++))==null||p.push(C)}return p}function o(f,d){return f.map(function(p){return d.map(function(m){return c(p[m])}).join(e)})}function s(f,d){return d==null&&(d=g$e(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=g$e(f)),o(f,d).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?e3t(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}var h$e,Zie,Qie,iM,Jie,b$e=w(()=>{"use strict";h$e={},Zie={},Qie=34,iM=10,Jie=13});var y$e=w(()=>{"use strict";b$e()});function toe(e){return e}var noe=w(()=>{"use strict"});function TU(e){if(e==null)return toe;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;u<c;)f[u]=a[u],++u;return f}}var kU=w(()=>{"use strict";noe()});var roe=w(()=>{"use strict";kU()});function v$e(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}var w$e=w(()=>{"use strict"});function aS(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return C$e(e,n)})}:C$e(e,t)}function C$e(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,o=IU(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:o}:r==null?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function IU(e,t){var n=TU(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],p=0,m=d.length;p<m;++p)f.push(n(d[p],p));c<0&&v$e(f,m)}function o(c){return n(c)}function s(c){for(var f=[],d=0,p=c.length;d<p;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(a)}function u(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=l(c.arcs);break;case"MultiPolygon":d=c.arcs.map(l);break;default:return null}return{type:f,coordinates:d}}return u(t)}var DU=w(()=>{"use strict";w$e();kU()});function ioe(e,t){var n={},r={},i={},o=[],s=-1;t.forEach(function(u,c){var f=e.arcs[u<0?~u:u],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=u,t[c]=d)}),t.forEach(function(u){var c=a(u),f=c[0],d=c[1],p,m;if(p=i[f])if(delete i[p.end],p.push(u),p.end=d,m=r[d]){delete r[m.start];var h=m===p?p:p.concat(m);r[h.start=p.start]=i[h.end=m.end]=h}else r[p.start]=i[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(u),p.start=f,m=i[f]){delete i[m.end];var g=m===p?p:m.concat(p);r[g.start=m.start]=i[g.end=p.end]=g}else r[p.start]=i[p.end]=p;else p=[u],r[p.start=f]=i[p.end=d]=p});function a(u){var c=e.arcs[u<0?~u:u],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=c[c.length-1],u<0?[d,f]:[f,d]}function l(u,c){for(var f in u){var d=u[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),o.push(d)}}return l(i,r),l(r,i),t.forEach(function(u){n[u<0?~u:u]||o.push([u])}),o}var ooe=w(()=>{"use strict"});function lS(e){return IU(e,_$e.apply(this,arguments))}function _$e(e,t,n){var r,i,o;if(arguments.length>1)r=t3t(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:ioe(e,r)}}function t3t(e,t,n){var r=[],i=[],o;function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function l(f){f.forEach(a)}function u(f){f.forEach(l)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":l(f.arcs);break;case"MultiPolygon":u(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}var S$e=w(()=>{"use strict";DU();ooe()});var E$e=w(()=>{"use strict";DU();ooe()});var A$e=w(()=>{"use strict"});var T$e=w(()=>{"use strict";A$e()});var soe=w(()=>{"use strict";noe()});var k$e=w(()=>{"use strict";roe();soe()});var NU=w(()=>{"use strict";roe();DU();S$e();E$e();T$e();k$e();kU();soe()});function aoe({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):n}function I$e({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function D$e({_intern:e,_key:t},n){let r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function N$e(e){return e!==null&&typeof e=="object"?e.valueOf():e}var jh,Vh,oM=w(()=>{"use strict";jh=class extends Map{constructor(t,n=N$e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(let[r,i]of t)this.set(r,i)}get(t){return super.get(aoe(this,t))}has(t){return super.has(aoe(this,t))}set(t,n){return super.set(I$e(this,t),n)}delete(t){return super.delete(D$e(this,t))}},Vh=class extends Set{constructor(t,n=N$e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(let r of t)this.add(r)}has(t){return super.has(aoe(this,t))}add(t){return super.add(I$e(this,t))}delete(t){return super.delete(D$e(this,t))}}});function F$e(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=i3t?10:o>=o3t?5:o>=s3t?2:1,a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?F$e(e,t,n*2):[a,l,u]}function loe(e,t,n){return t=+t,e=+e,n=+n,F$e(e,t,n)[2]}function uoe(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?loe(t,e,n):loe(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}var i3t,o3t,s3t,R$e=w(()=>{"use strict";i3t=Math.sqrt(50),o3t=Math.sqrt(10),s3t=Math.sqrt(2)});var O$e=w(()=>{"use strict";R$e()});function M$e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function uS(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var sM=w(()=>{"use strict"});function Wh(e){return e=uS(Math.abs(e)),e?e[1]:NaN}var aM=w(()=>{"use strict";sM()});function $$e(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}var P$e=w(()=>{"use strict"});function L$e(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var B$e=w(()=>{"use strict"});function Vx(e){if(!(t=a3t.exec(e)))throw new Error("invalid format: "+e);var t;return new FU({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function FU(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}var a3t,coe=w(()=>{"use strict";a3t=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Vx.prototype=FU.prototype;FU.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function z$e(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var U$e=w(()=>{"use strict"});function j$e(e,t){var n=uS(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(foe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+uS(e,Math.max(0,t+o-1))[0]}var foe,doe=w(()=>{"use strict";sM()});function poe(e,t){var n=uS(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var V$e=w(()=>{"use strict";sM()});var moe,W$e=w(()=>{"use strict";sM();doe();V$e();moe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:M$e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>poe(e*100,t),r:poe,s:j$e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)}});function hoe(e){return e}var G$e=w(()=>{"use strict"});function lM(e){var t=e.grouping===void 0||e.thousands===void 0?hoe:$$e(q$e.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?hoe:L$e(q$e.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=Vx(f);var d=f.fill,p=f.align,m=f.sign,h=f.symbol,g=f.zero,x=f.width,b=f.comma,y=f.precision,v=f.trim,C=f.type;C==="n"?(b=!0,C="g"):moe[C]||(y===void 0&&(y=12),v=!0,C="g"),(g||d==="0"&&p==="=")&&(g=!0,d="0",p="=");var _=h==="$"?n:h==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",S=h==="$"?r:/[%p]/.test(C)?s:"",E=moe[C],T=/[defgprs%]/.test(C);y=y===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function I(k){var O=_,F=S,B,M,z;if(C==="c")F=E(k)+F,k="";else{k=+k;var W=k<0||1/k<0;if(k=isNaN(k)?l:E(Math.abs(k),y),v&&(k=z$e(k)),W&&+k==0&&m!=="+"&&(W=!1),O=(W?m==="("?m:a:m==="-"||m==="("?"":m)+O,F=(C==="s"?H$e[8+foe/3]:"")+F+(W&&m==="("?")":""),T){for(B=-1,M=k.length;++B<M;)if(z=k.charCodeAt(B),48>z||z>57){F=(z===46?i+k.slice(B+1):k.slice(B))+F,k=k.slice(0,B);break}}}b&&!g&&(k=t(k,1/0));var H=O.length+k.length+F.length,Q=H<x?new Array(x-H+1).join(d):"";switch(b&&g&&(k=t(Q+k,Q.length?x-F.length:1/0),Q=""),p){case"<":k=O+k+F+Q;break;case"=":k=O+Q+k+F;break;case"^":k=Q.slice(0,H=Q.length>>1)+O+k+F+Q.slice(H);break;default:k=Q+O+k+F;break}return o(k)}return I.toString=function(){return f+""},I}function c(f,d){var p=u((f=Vx(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(Wh(d)/3)))*3,h=Math.pow(10,-m),g=H$e[8+m/3];return function(x){return p(h*x)+g}}return{format:u,formatPrefix:c}}var q$e,H$e,goe=w(()=>{"use strict";aM();P$e();B$e();coe();U$e();W$e();doe();G$e();q$e=Array.prototype.map,H$e=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function xoe(e){return RU=lM(e),OU=RU.format,MU=RU.formatPrefix,RU}var RU,OU,MU,Y$e=w(()=>{"use strict";goe();xoe({thousands:",",grouping:[3],currency:["$",""]})});function boe(e){return Math.max(0,-Wh(Math.abs(e)))}var K$e=w(()=>{"use strict";aM()});function yoe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Wh(t)/3)))*3-Wh(Math.abs(e)))}var X$e=w(()=>{"use strict";aM()});function voe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Wh(t)-Wh(e))+1}var Z$e=w(()=>{"use strict";aM()});var Q$e=w(()=>{"use strict";Y$e();goe();coe();K$e();X$e();Z$e()});function jr(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{let s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{let l=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return l;let u;do l.push(u=new Date(+o)),t(o,a),e(o);while(u<o&&o<s);return l},i.filter=o=>jr(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(woe.setTime(+o),Coe.setTime(+s),e(woe),e(Coe),Math.floor(n(woe,Coe))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}var woe,Coe,Wx=w(()=>{"use strict";woe=new Date,Coe=new Date});var Gx,J$e,ePe=w(()=>{"use strict";Wx();Gx=jr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Gx.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?jr(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Gx);J$e=Gx.range});var cS,tPe,nPe=w(()=>{"use strict";Wx();cS=jr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),tPe=cS.range});var $U,l3t,PU,u3t,rPe=w(()=>{"use strict";Wx();$U=jr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),l3t=$U.range,PU=jr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),u3t=PU.range});var LU,c3t,BU,f3t,iPe=w(()=>{"use strict";Wx();LU=jr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),c3t=LU.range,BU=jr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),f3t=BU.range});var Gh,d3t,qh,p3t,oPe,m3t,sPe=w(()=>{"use strict";Wx();Gh=jr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),d3t=Gh.range,qh=jr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),p3t=qh.range,oPe=jr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),m3t=oPe.range});function fS(e){return jr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}function dS(e){return jr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/6048e5)}var Fv,hk,aPe,lPe,Rv,uPe,cPe,fPe,g3t,x3t,b3t,y3t,v3t,w3t,Ov,gk,dPe,pPe,Mv,mPe,hPe,gPe,C3t,_3t,S3t,E3t,A3t,T3t,xPe=w(()=>{"use strict";Wx();Fv=fS(0),hk=fS(1),aPe=fS(2),lPe=fS(3),Rv=fS(4),uPe=fS(5),cPe=fS(6),fPe=Fv.range,g3t=hk.range,x3t=aPe.range,b3t=lPe.range,y3t=Rv.range,v3t=uPe.range,w3t=cPe.range;Ov=dS(0),gk=dS(1),dPe=dS(2),pPe=dS(3),Mv=dS(4),mPe=dS(5),hPe=dS(6),gPe=Ov.range,C3t=gk.range,_3t=dPe.range,S3t=pPe.range,E3t=Mv.range,A3t=mPe.range,T3t=hPe.range});var uM,k3t,cM,I3t,bPe=w(()=>{"use strict";Wx();uM=jr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),k3t=uM.range,cM=jr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),I3t=cM.range});var Yd,D3t,Kd,N3t,yPe=w(()=>{"use strict";Wx();Yd=jr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Yd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:jr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});D3t=Yd.range,Kd=jr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Kd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:jr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});N3t=Kd.range});var Aoe=w(()=>{"use strict";ePe();nPe();rPe();iPe();sPe();xPe();bPe();yPe()});function Ioe(e){return pS.setFullYear(e),pS.setMonth(0),pS.setDate(1),pS.setHours(0,0,0,0),pS}function R3t(e){return Gh.count(Ioe(e.getFullYear())-1,e)}function vPe(e){return Fv.count(Ioe(e.getFullYear())-1,e)}function Toe(e){return Ioe(e).getDay()}function O3t(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return qh.count(t-1,e)}function wPe(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return Ov.count(t-1,e)}function koe(e){return pS.setTime(Date.UTC(e,0,1)),pS.getUTCDay()}function xk(e,t,n){return t+e*7-(n+6)%7}function SPe(e){return M3t[e]}function EPe(e){return $3t[e]}var xl,Jd,xc,ou,Xd,Hh,bk,Zd,Qd,Yh,qx,F3t,zwr,Uwr,pS,jwr,Vwr,Wwr,Gwr,M3t,$3t,fM,dM,pM,zU,P3t,CPe,L3t,B3t,mM,hM,gM,z3t,U3t,_Pe,j3t,qwr,APe=w(()=>{"use strict";rM();Aoe();xl="year",Jd="quarter",xc="month",ou="week",Xd="date",Hh="day",bk="dayofyear",Zd="hours",Qd="minutes",Yh="seconds",qx="milliseconds",F3t=[xl,Jd,xc,ou,Xd,Hh,bk,Zd,Qd,Yh,qx],zwr=F3t.reduce((e,t,n)=>(e[t]=1+n,e),{}),Uwr={[xl]:"%Y ",[Jd]:"Q%q ",[xc]:"%b ",[Xd]:"%d ",[ou]:"W%U ",[Hh]:"%a ",[bk]:"%j ",[Zd]:"%H:00",[Qd]:"00:%M",[Yh]:":%S",[qx]:".%L",[`${xl}-${xc}`]:"%Y-%m ",[`${xl}-${xc}-${Xd}`]:"%Y-%m-%d ",[`${Zd}-${Qd}`]:"%H:%M"},pS=new Date;jwr={[xl]:e=>e.getFullYear(),[Jd]:e=>Math.floor(e.getMonth()/3),[xc]:e=>e.getMonth(),[Xd]:e=>e.getDate(),[Zd]:e=>e.getHours(),[Qd]:e=>e.getMinutes(),[Yh]:e=>e.getSeconds(),[qx]:e=>e.getMilliseconds(),[bk]:e=>R3t(e),[ou]:e=>vPe(e),[ou+Hh]:(e,t)=>xk(vPe(e),e.getDay(),Toe(t)),[Hh]:(e,t)=>xk(1,e.getDay(),Toe(t))},Vwr={[Jd]:e=>3*e,[ou]:(e,t)=>xk(e,0,Toe(t))},Wwr={[xl]:e=>e.getUTCFullYear(),[Jd]:e=>Math.floor(e.getUTCMonth()/3),[xc]:e=>e.getUTCMonth(),[Xd]:e=>e.getUTCDate(),[Zd]:e=>e.getUTCHours(),[Qd]:e=>e.getUTCMinutes(),[Yh]:e=>e.getUTCSeconds(),[qx]:e=>e.getUTCMilliseconds(),[bk]:e=>O3t(e),[ou]:e=>wPe(e),[Hh]:(e,t)=>xk(1,e.getUTCDay(),koe(t)),[ou+Hh]:(e,t)=>xk(wPe(e),e.getUTCDay(),koe(t))},Gwr={[Jd]:e=>3*e,[ou]:(e,t)=>xk(e,0,koe(t))},M3t={[xl]:Yd,[Jd]:uM.every(3),[xc]:uM,[ou]:Fv,[Xd]:Gh,[Hh]:Gh,[bk]:Gh,[Zd]:LU,[Qd]:$U,[Yh]:cS,[qx]:Gx},$3t={[xl]:Kd,[Jd]:cM.every(3),[xc]:cM,[ou]:Ov,[Xd]:qh,[Hh]:qh,[bk]:qh,[Zd]:BU,[Qd]:PU,[Yh]:cS,[qx]:Gx};fM=1e3,dM=fM*60,pM=dM*60,zU=pM*24,P3t=zU*7,CPe=zU*30,L3t=zU*365,B3t=[xl,xc,Xd,Zd,Qd,Yh,qx],mM=B3t.slice(0,-1),hM=mM.slice(0,-1),gM=hM.slice(0,-1),z3t=gM.slice(0,-1),U3t=[xl,ou],_Pe=[xl,xc],j3t=[xl],qwr=[[mM,1,fM],[mM,5,5*fM],[mM,15,15*fM],[mM,30,30*fM],[hM,1,dM],[hM,5,5*dM],[hM,15,15*dM],[hM,30,30*dM],[gM,1,pM],[gM,3,3*pM],[gM,6,6*pM],[gM,12,12*pM],[z3t,1,zU],[U3t,1,P3t],[_Pe,1,CPe],[_Pe,3,3*CPe],[j3t,1,L3t]]});function Doe(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Noe(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xM(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function yk(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,u=bM(i),c=yM(i),f=bM(o),d=yM(o),p=bM(s),m=yM(s),h=bM(a),g=yM(a),x=bM(l),b=yM(l),y={a:W,A:H,b:Q,B:re,c:null,d:FPe,e:FPe,f:f$t,g:w$t,G:_$t,H:l$t,I:u$t,j:c$t,L:PPe,m:d$t,M:p$t,p:oe,q:me,Q:MPe,s:$Pe,S:m$t,u:h$t,U:g$t,V:x$t,w:b$t,W:y$t,x:null,X:null,y:v$t,Y:C$t,Z:S$t,"%":OPe},v={a:ge,A:ye,b:ve,B:Ne,c:null,d:RPe,e:RPe,f:k$t,g:L$t,G:z$t,H:E$t,I:A$t,j:T$t,L:BPe,m:I$t,M:D$t,p:Ge,q:nt,Q:MPe,s:$Pe,S:N$t,u:F$t,U:R$t,V:O$t,w:M$t,W:$$t,x:null,X:null,y:P$t,Y:B$t,Z:U$t,"%":OPe},C={a:I,A:k,b:O,B:F,c:B,d:DPe,e:DPe,f:i$t,g:IPe,G:kPe,H:NPe,I:NPe,j:e$t,L:r$t,m:J3t,M:t$t,p:T,q:Q3t,Q:s$t,s:a$t,S:n$t,u:H3t,U:Y3t,V:K3t,w:q3t,W:X3t,x:M,X:z,y:IPe,Y:kPe,Z:Z3t,"%":o$t};y.x=_(n,y),y.X=_(r,y),y.c=_(t,y),v.x=_(n,v),v.X=_(r,v),v.c=_(t,v);function _(Y,ie){return function(ue){var U=[],Ue=-1,ke=0,Xe=Y.length,Ye,Pt,yn;for(ue instanceof Date||(ue=new Date(+ue));++Ue<Xe;)Y.charCodeAt(Ue)===37&&(U.push(Y.slice(ke,Ue)),(Pt=TPe[Ye=Y.charAt(++Ue)])!=null?Ye=Y.charAt(++Ue):Pt=Ye==="e"?" ":"0",(yn=ie[Ye])&&(Ye=yn(ue,Pt)),U.push(Ye),ke=Ue+1);return U.push(Y.slice(ke,Ue)),U.join("")}}function S(Y,ie){return function(ue){var U=xM(1900,void 0,1),Ue=E(U,Y,ue+="",0),ke,Xe;if(Ue!=ue.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(ie&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(ke=Noe(xM(U.y,0,1)),Xe=ke.getUTCDay(),ke=Xe>4||Xe===0?gk.ceil(ke):gk(ke),ke=qh.offset(ke,(U.V-1)*7),U.y=ke.getUTCFullYear(),U.m=ke.getUTCMonth(),U.d=ke.getUTCDate()+(U.w+6)%7):(ke=Doe(xM(U.y,0,1)),Xe=ke.getDay(),ke=Xe>4||Xe===0?hk.ceil(ke):hk(ke),ke=Gh.offset(ke,(U.V-1)*7),U.y=ke.getFullYear(),U.m=ke.getMonth(),U.d=ke.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),Xe="Z"in U?Noe(xM(U.y,0,1)).getUTCDay():Doe(xM(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(Xe+5)%7:U.w+U.U*7-(Xe+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,Noe(U)):Doe(U)}}function E(Y,ie,ue,U){for(var Ue=0,ke=ie.length,Xe=ue.length,Ye,Pt;Ue<ke;){if(U>=Xe)return-1;if(Ye=ie.charCodeAt(Ue++),Ye===37){if(Ye=ie.charAt(Ue++),Pt=C[Ye in TPe?ie.charAt(Ue++):Ye],!Pt||(U=Pt(Y,ue,U))<0)return-1}else if(Ye!=ue.charCodeAt(U++))return-1}return U}function T(Y,ie,ue){var U=u.exec(ie.slice(ue));return U?(Y.p=c.get(U[0].toLowerCase()),ue+U[0].length):-1}function I(Y,ie,ue){var U=p.exec(ie.slice(ue));return U?(Y.w=m.get(U[0].toLowerCase()),ue+U[0].length):-1}function k(Y,ie,ue){var U=f.exec(ie.slice(ue));return U?(Y.w=d.get(U[0].toLowerCase()),ue+U[0].length):-1}function O(Y,ie,ue){var U=x.exec(ie.slice(ue));return U?(Y.m=b.get(U[0].toLowerCase()),ue+U[0].length):-1}function F(Y,ie,ue){var U=h.exec(ie.slice(ue));return U?(Y.m=g.get(U[0].toLowerCase()),ue+U[0].length):-1}function B(Y,ie,ue){return E(Y,t,ie,ue)}function M(Y,ie,ue){return E(Y,n,ie,ue)}function z(Y,ie,ue){return E(Y,r,ie,ue)}function W(Y){return s[Y.getDay()]}function H(Y){return o[Y.getDay()]}function Q(Y){return l[Y.getMonth()]}function re(Y){return a[Y.getMonth()]}function oe(Y){return i[+(Y.getHours()>=12)]}function me(Y){return 1+~~(Y.getMonth()/3)}function ge(Y){return s[Y.getUTCDay()]}function ye(Y){return o[Y.getUTCDay()]}function ve(Y){return l[Y.getUTCMonth()]}function Ne(Y){return a[Y.getUTCMonth()]}function Ge(Y){return i[+(Y.getUTCHours()>=12)]}function nt(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ie=_(Y+="",y);return ie.toString=function(){return Y},ie},parse:function(Y){var ie=S(Y+="",!1);return ie.toString=function(){return Y},ie},utcFormat:function(Y){var ie=_(Y+="",v);return ie.toString=function(){return Y},ie},utcParse:function(Y){var ie=S(Y+="",!0);return ie.toString=function(){return Y},ie}}}function Kn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function G3t(e){return e.replace(W3t,"\\$&")}function bM(e){return new RegExp("^(?:"+e.map(G3t).join("|")+")","i")}function yM(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function q3t(e,t,n){var r=ms.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function H3t(e,t,n){var r=ms.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Y3t(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function K3t(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function X3t(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function kPe(e,t,n){var r=ms.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function IPe(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Z3t(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Q3t(e,t,n){var r=ms.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function J3t(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function DPe(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function e$t(e,t,n){var r=ms.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function NPe(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function t$t(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function n$t(e,t,n){var r=ms.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function r$t(e,t,n){var r=ms.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function i$t(e,t,n){var r=ms.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function o$t(e,t,n){var r=V3t.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function s$t(e,t,n){var r=ms.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function a$t(e,t,n){var r=ms.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function FPe(e,t){return Kn(e.getDate(),t,2)}function l$t(e,t){return Kn(e.getHours(),t,2)}function u$t(e,t){return Kn(e.getHours()%12||12,t,2)}function c$t(e,t){return Kn(1+Gh.count(Yd(e),e),t,3)}function PPe(e,t){return Kn(e.getMilliseconds(),t,3)}function f$t(e,t){return PPe(e,t)+"000"}function d$t(e,t){return Kn(e.getMonth()+1,t,2)}function p$t(e,t){return Kn(e.getMinutes(),t,2)}function m$t(e,t){return Kn(e.getSeconds(),t,2)}function h$t(e){var t=e.getDay();return t===0?7:t}function g$t(e,t){return Kn(Fv.count(Yd(e)-1,e),t,2)}function LPe(e){var t=e.getDay();return t>=4||t===0?Rv(e):Rv.ceil(e)}function x$t(e,t){return e=LPe(e),Kn(Rv.count(Yd(e),e)+(Yd(e).getDay()===4),t,2)}function b$t(e){return e.getDay()}function y$t(e,t){return Kn(hk.count(Yd(e)-1,e),t,2)}function v$t(e,t){return Kn(e.getFullYear()%100,t,2)}function w$t(e,t){return e=LPe(e),Kn(e.getFullYear()%100,t,2)}function C$t(e,t){return Kn(e.getFullYear()%1e4,t,4)}function _$t(e,t){var n=e.getDay();return e=n>=4||n===0?Rv(e):Rv.ceil(e),Kn(e.getFullYear()%1e4,t,4)}function S$t(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Kn(t/60|0,"0",2)+Kn(t%60,"0",2)}function RPe(e,t){return Kn(e.getUTCDate(),t,2)}function E$t(e,t){return Kn(e.getUTCHours(),t,2)}function A$t(e,t){return Kn(e.getUTCHours()%12||12,t,2)}function T$t(e,t){return Kn(1+qh.count(Kd(e),e),t,3)}function BPe(e,t){return Kn(e.getUTCMilliseconds(),t,3)}function k$t(e,t){return BPe(e,t)+"000"}function I$t(e,t){return Kn(e.getUTCMonth()+1,t,2)}function D$t(e,t){return Kn(e.getUTCMinutes(),t,2)}function N$t(e,t){return Kn(e.getUTCSeconds(),t,2)}function F$t(e){var t=e.getUTCDay();return t===0?7:t}function R$t(e,t){return Kn(Ov.count(Kd(e)-1,e),t,2)}function zPe(e){var t=e.getUTCDay();return t>=4||t===0?Mv(e):Mv.ceil(e)}function O$t(e,t){return e=zPe(e),Kn(Mv.count(Kd(e),e)+(Kd(e).getUTCDay()===4),t,2)}function M$t(e){return e.getUTCDay()}function $$t(e,t){return Kn(gk.count(Kd(e)-1,e),t,2)}function P$t(e,t){return Kn(e.getUTCFullYear()%100,t,2)}function L$t(e,t){return e=zPe(e),Kn(e.getUTCFullYear()%100,t,2)}function B$t(e,t){return Kn(e.getUTCFullYear()%1e4,t,4)}function z$t(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Mv(e):Mv.ceil(e),Kn(e.getUTCFullYear()%1e4,t,4)}function U$t(){return"+0000"}function OPe(){return"%"}function MPe(e){return+e}function $Pe(e){return Math.floor(+e/1e3)}var TPe,ms,V3t,W3t,Foe=w(()=>{"use strict";Aoe();TPe={"-":"",_:" ",0:"0"},ms=/^\s*\d+/,V3t=/^%/,W3t=/[\\^$*+?|[\]().{}]/g});function Roe(e){return vk=yk(e),UU=vk.format,jU=vk.parse,VU=vk.utcFormat,WU=vk.utcParse,vk}var vk,UU,jU,VU,WU,UPe=w(()=>{"use strict";Foe();Roe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})});var jPe=w(()=>{"use strict";UPe();Foe()});function vM(e){let t={};return n=>t[n]||(t[n]=e(n))}function j$t(e,t){return n=>{let r=e(n),i=r.indexOf(t);if(i<0)return r;let o=V$t(r,i),s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function V$t(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function qPe(e){let t=vM(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){let i=Vx(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return j$t(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=Vx(s??",f");let a=uoe(r,i,o),l=Math.max(Math.abs(r),Math.abs(i)),u;if(s.precision==null)switch(s.type){case"s":return isNaN(u=yoe(a,l))||(s.precision=u),n(s,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=voe(a,l))||(s.precision=u-(s.type==="e"));break}case"f":case"%":{isNaN(u=boe(a))||(s.precision=u-(s.type==="%")*2);break}}return t(s)}}}function W$t(){return Ooe=qPe({format:OU,formatPrefix:MU})}function G$t(e){return qPe(lM(e))}function VPe(e){return arguments.length?Ooe=G$t(e):Ooe}function WPe(e,t,n){n=n||{},tM(n)||So(`Invalid time multi-format specifier: ${n}`);let r=t(Yh),i=t(Qd),o=t(Zd),s=t(Xd),a=t(ou),l=t(xc),u=t(Jd),c=t(xl),f=e(n[qx]||".%L"),d=e(n[Yh]||":%S"),p=e(n[Qd]||"%I:%M"),m=e(n[Zd]||"%I %p"),h=e(n[Xd]||n[Hh]||"%a %d"),g=e(n[ou]||"%b %d"),x=e(n[xc]||"%B"),b=e(n[Jd]||"%B"),y=e(n[xl]||"%Y");return v=>(r(v)<v?f:i(v)<v?d:o(v)<v?p:s(v)<v?m:l(v)<v?a(v)<v?h:g:c(v)<v?u(v)<v?x:b:y)(v)}function HPe(e){let t=vM(e.format),n=vM(e.utcFormat);return{timeFormat:r=>EU(r)?t(r):WPe(t,SPe,r),utcFormat:r=>EU(r)?n(r):WPe(n,EPe,r),timeParse:vM(e.parse),utcParse:vM(e.utcParse)}}function q$t(){return Moe=HPe({format:UU,parse:jU,utcFormat:VU,utcParse:WU})}function H$t(e){return HPe(yk(e))}function GU(e){return arguments.length?Moe=H$t(e):Moe}function YPe(e,t){let n=arguments.length;return n&&n!==2&&So("defaultLocale expects either zero or two arguments."),n?GPe(VPe(e),GU(t)):GPe(VPe(),GU())}var Ooe,Moe,GPe,$oe=w(()=>{"use strict";O$e();Q$e();APe();rM();jPe();W$t();q$t();GPe=(e,t)=>Uh({},e,t)});function Z$t(e,t){return n=>({options:n||{},sanitize:J$t,load:Q$t,fileAccess:!!t,file:ePt(t),http:nPt(e)})}function Q$t(e,t){return te(this,null,function*(){let n=yield this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)})}function J$t(e,t){return te(this,null,function*(){t=Uh({},this.options,t);let n=this.fileAccess,r={href:null},i,o,s,a=K$t.test(e.replace(X$t,""));(e==null||typeof e!="string"||!a)&&So("Sanitize failure, invalid URI: "+AU(e));let l=Y$t.test(e);return(s=t.baseURL)&&!l&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(KPe))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(KPe.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r})}function ePt(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):tPt}function tPt(){return te(this,null,function*(){So("No file system access.")})}function nPt(e){return e?function(t,n){return te(this,null,function*(){let r=Uh({},this.options.http,n),i=n&&n.response,o=yield e(t,r);return o.ok?gc(o[i])?o[i]():o.text():So(o.status+""+o.statusText)})}:rPt}function rPt(){return te(this,null,function*(){So("No HTTP fetch method available.")})}function uPt(e,t){if(!e||!e.length)return"unknown";let n=e.length,r=qU.length,i=qU.map((o,s)=>s+1);for(let o=0,s=0,a,l;o<n;++o)for(l=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&iPt(l)&&!qU[a](l)&&(i[a]=0,++s,s===qU.length))return"string";return lPt[i.reduce((o,s)=>o===0?s:o,0)-1]}function cPt(e,t){return t.reduce((n,r)=>(n[r]=uPt(e,r),n),{})}function ZPe(e){let t=function(n,r){let i={delimiter:e};return Loe(n,r?Uh(r,i):i)};return t.responseType="text",t}function Loe(e,t){return t.header&&(e=t.header.map(AU).join(t.delimiter)+`
`+e),eoe(t.delimiter).parse(e+"")}function fPt(e){return typeof Buffer=="function"&&gc(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Boe(e,t){let n=t&&t.property?Hie(t.property):fk;return tM(e)&&!fPt(e)?dPt(n(e),t):n(JSON.parse(e))}function dPt(e,t){return!Ef(e)&&f$e(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function JPe(e,t){let n,r,i,o;return e=Boe(e,t),t&&t.feature?(n=aS,i=t.feature):t&&t.mesh?(n=lS,i=t.mesh,o=pPt[t.filter]):So("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):So("Invalid TopoJSON object: "+i),r&&r.features||[r]}function eLe(e,t){return arguments.length>1?(Poe[e]=t,this):pk(Poe,e)?Poe[e]:null}function tLe(e){let t=eLe(e);return t&&t.responseType||"text"}function nLe(e,t,n,r){t=t||{};let i=eLe(t.type||"json");return i||So("Unknown data format type: "+t.type),e=i(e,t),t.parse&&mPt(e,t.parse,n,r),pk(e,"columns")&&delete e.columns,e}function mPt(e,t,n,r){if(!e.length)return;let i=GU();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,l,u,c,f;t==="auto"&&(t=cPt(e,o)),o=Object.keys(t);let d=o.map(p=>{let m=t[p],h,g;if(m&&(m.startsWith("date:")||m.startsWith("utc:")))return h=m.split(/:(.+)?/,2),g=h[1],(g[0]==="'"&&g[g.length-1]==="'"||g[0]==='"'&&g[g.length-1]==='"')&&(g=g.slice(1,-1)),(h[0]==="utc"?r:n)(g);if(!XPe[m])throw Error("Illegal format pattern: "+p+":"+m);return XPe[m]});for(l=0,c=e.length,f=o.length;l<c;++l)for(s=e[l],u=0;u<f;++u)a=o[u],s[a]=d[u](s[a])}var Y$t,K$t,X$t,KPe,iPt,oPt,sPt,QPe,aPt,XPe,qU,lPt,pPt,Poe,rLe,iLe=w(()=>{"use strict";rM();y$e();NU();$oe();Y$t=/^(data:|([A-Za-z]+:)?\/\/)/,K$t=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,X$t=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,KPe="file://";iPt=e=>e!=null&&e===e,oPt=e=>e==="true"||e==="false"||e===!0||e===!1,sPt=e=>!Number.isNaN(Date.parse(e)),QPe=e=>!Number.isNaN(+e)&&!(e instanceof Date),aPt=e=>QPe(e)&&Number.isInteger(+e),XPe={boolean:d$e,integer:Kie,number:Kie,date:p$e,string:m$e,unknown:fk},qU=[oPt,aPt,QPe,sPt],lPt=["boolean","integer","number","date"];Loe.responseType="text";Boe.responseType="json";pPt={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};JPe.responseType="json";Poe={dsv:Loe,csv:ZPe(","),tsv:ZPe("	"),json:Boe,topojson:JPe};rLe=Z$t(typeof fetch<"u"&&fetch,null)});function XU(e){let t=e||fk,n=[],r={};return n.add=i=>{let o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{let o=t(i);if(r[o]){r[o]=0;let s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}function _M(e,t){return te(this,null,function*(){try{yield t(e)}catch(n){e.error(n)}})}function mS(e){return!!(e&&bt(e))}function bt(e){return e[fLe]}function dLe(e,t){return e[fLe]=t,e}function Cn(e){let t=e===Object(e)?e:{data:e};return bt(t)?t:dLe(t,hPt++)}function ZU(e){return hS(e,Cn({}))}function hS(e,t){for(let n in e)t[n]=e[n];return t}function QU(e,t){return dLe(t,bt(e))}function Xh(e,t){return e?t?(n,r)=>e(n,r)||bt(t(n))-bt(t(r)):(n,r)=>e(n,r)||bt(n)-bt(r):null}function Uoe(e){return e&&e.constructor===Xx}function Xx(){let e=[],t=[],n=[],r=[],i=[],o=null,s=!1;return{constructor:Xx,insert(a){let l=dk(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){let l=gc(a)?r:t,u=dk(a),c=u.length;for(let f=0;f<c;++f)l.push(u[f]);return this},modify(a,l,u){let c={field:l,value:nM(u)};return gc(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return gc(a)?i.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,l){let u={},c={},f,d,p,m,h,g;for(f=0,d=l.length;f<d;++f)u[bt(l[f])]=1;for(f=0,d=t.length;f<d;++f)h=t[f],u[bt(h)]=-1;for(f=0,d=r.length;f<d;++f)m=r[f],l.forEach(b=>{m(b)&&(u[bt(b)]=-1)});for(f=0,d=e.length;f<d;++f)h=e[f],g=bt(h),u[g]?u[g]=1:a.add.push(Cn(e[f]));for(f=0,d=l.length;f<d;++f)h=l[f],u[bt(h)]<0&&a.rem.push(h);function x(b,y,v){v?b[y]=v(b):a.encode=y,s||(c[bt(b)]=b)}for(f=0,d=n.length;f<d;++f)p=n[f],h=p.tuple,m=p.field,g=u[bt(h)],g>0&&(x(h,m,p.value),a.modifies(m));for(f=0,d=i.length;f<d;++f)p=i[f],m=p.filter,l.forEach(b=>{m(b)&&u[bt(b)]>0&&x(b,p.field,p.value)}),a.modifies(p.field);if(s)a.mod=t.length||r.length?l.filter(b=>u[bt(b)]>0):l.slice();else for(g in c)a.mod.push(c[g]);return(o||o==null&&(t.length||r.length))&&a.clean(!0),a}}}function SM(){Object.defineProperty(this,YU,{writable:!0,value:{}})}function yr(e,t,n,r){this.id=++gPt,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function oLe(e){return function(t){let n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}function wPt(e,t,n,r){let i=1,o;return e instanceof yr?o=e:e&&e.prototype instanceof yr?o=new e:gc(e)?o=new yr(null,e):(i=0,o=new yr(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o}function CPt(e,t){let n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}function Ck(e,t,n){this.id=++_Pt,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function $v(e,t,n){return new Ck(e,t,n)}function SPt(e,t,n,r){let i=this,o=$v(n,r),s=function(u){u.dataflow=i;try{o.receive(u)}catch(c){i.error(c)}finally{i.run()}},a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=dk(e);let l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,s);return o}function EPt(e,t){let n=this.locale();return nLe(e,t,n.timeParse,n.utcParse)}function APt(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}function TPt(e,t){return te(this,null,function*(){let n=this,r=0,i;try{i=yield n.loader().load(e,{context:"dataflow",response:tLe(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}})}function kPt(e,t,n){return te(this,null,function*(){let r=this,i=r._pending||IPt(r);i.requests+=1;let o=yield r.request(t,n);return r.pulse(e,r.changeset().remove(SU).insert(o.data||[])),i.done(),o})}function IPt(e){let t,n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}function NPt(e,t,n,r,i){return(e instanceof yr?RPt:FPt)(this,e,t,n,r,i),this}function FPt(e,t,n,r,i,o){let s=Uh({},o,DPt),a,l;gc(n)||(n=nM(n)),r===void 0?a=u=>e.touch(n(u)):gc(r)?(l=new yr(null,r,i,!1),a=u=>{l.evaluate(u);let c=n(u),f=l.value;Uoe(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=u=>e.update(n(u),r,s),t.apply(a)}function RPt(e,t,n,r,i,o){if(r===void 0)t.targets().add(n);else{let s=o||{},a=new yr(null,OPt(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function OPt(e,t){return t=gc(t)?t:nM(t),e?function(n,r){let i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function MPt(e){e.rank=++this._rank}function $Pt(e){let t=[e],n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&So("Cycle detected in dataflow graph.")}function Yx(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function zoe(e,t){let n=[];return Nv(e,t,r=>n.push(r)),n}function cLe(e,t){let n={};return e.visit(t,r=>{n[bt(r)]=1}),r=>n[bt(r)]?null:r}function HU(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}function JU(e,t,n,r){let i=this,o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s of n)if(s.stamp===t){if(s.fields){let a=i.fields||(i.fields={});for(let l in s.fields)a[l]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function LPt(e,t,n){return te(this,null,function*(){let r=this,i=[];if(r._pulse)return pLe(r);if(r._pending&&(yield r._pending),t&&(yield _M(r,t)),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;let o=++r._clock;r._pulse=new Yx(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=XU(eM);let s=0,a,l,u;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}l=a.run(r._getPulse(a,e)),l.then?l=yield l:l.async&&(i.push(l.async),l=KU),l!==KU&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s}}catch(c){r._heap.clear(),u=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){let c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)yield _M(r,c[f].callback)}return n&&(yield _M(r,n)),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r})}function BPt(e,t,n){return te(this,null,function*(){for(;this._running;)yield this._running;let r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running})}function zPt(e,t,n){return this._pulse?pLe(this):(this.evaluate(e,t,n),this)}function UPt(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function pLe(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function jPt(e,t){let n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function VPt(e,t){let n=e.source,r=this._clock;return n&&Ef(n)?new JU(this,r,n.map(i=>i.pulse),t):this._input[e.id]||WPt(this._pulse,n&&n.pulse)}function WPt(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==KU&&(e.source=t.source),e)}function GPt(e,t){let n=t||joe;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function qPt(e,t,n){let r=n||joe;return(e.set(t)||r.force)&&this.touch(e,r),this}function HPt(e,t,n){this.touch(e,n||joe);let r=new Yx(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function YPt(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),mLe(t,0,t.length-1,e)),pop:()=>{let n=t.pop(),r;return t.length?(r=t[0],t[0]=n,KPt(t,0,e)):r=n,r}}}function mLe(e,t,n,r){let i,o,s=e[n];for(;n>t;){if(o=n-1>>1,i=e[o],r(s,i)<0){e[n]=i,n=o;continue}break}return e[n]=s}function KPt(e,t,n){let r=t,i=e.length,o=e[t],s=(t<<1)+1,a;for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],t=s,s=(t<<1)+1;return e[t]=o,mLe(e,r,t,n)}function Lv(){this.logger(u$e()),this.logLevel(Yie),this._clock=0,this._rank=0,this._locale=YPe();try{this._loader=rLe()}catch{}this._touched=XU(eM),this._input={},this._pulse=null,this._heap=YPt((e,t)=>e.qrank-t.qrank),this._postrun=[]}function CM(e){return function(){return this._log[e].apply(this,arguments)}}function ce(e,t){yr.call(this,e,null,t)}function ej(e){let t=Voe(e);return t&&t.Definition||null}function Voe(e){return e=e&&e.toLowerCase(),pk(Kx,e)?Kx[e]:null}var fLe,hPt,YU,gPt,xPt,bPt,yPt,vPt,_Pt,DPt,KU,Kh,Pv,Hx,PPt,sLe,wk,aLe,wM,lLe,uLe,joe,Kx,hs=w(()=>{"use strict";rM();iLe();$oe();fLe=Symbol("vega_id"),hPt=1;YU="_:mod:_";SM.prototype={set(e,t,n,r){let i=this,o=i[e],s=i[YU];return t!=null&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=Ef(n)?1+n.length:-1),i},modified(e,t){let n=this[YU];if(arguments.length){if(Ef(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(let r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[YU]={},this}};gPt=0,xPt="pulse",bPt=new SM,yPt=1,vPt=2;yr.prototype={targets(){return this._targets||(this._targets=XU(eM))},set(e){return this.value!==e?(this.value=e,1):0},skip:oLe(yPt),modified:oLe(vPt),parameters(e,t,n){t=t!==!1;let r=this._argval=this._argval||new SM,i=this._argops=this._argops||[],o=[],s,a,l,u,c=(f,d,p)=>{p instanceof yr?(p!==this&&(t&&p.targets().add(this),o.push(p)),i.push({op:p,name:f,index:d})):r.set(f,d,p)};for(s in e)if(a=e[s],s===xPt)dk(a).forEach(f=>{f instanceof yr?f!==this&&(f.targets().add(this),o.push(f)):So("Pulse parameters must be operator instances.")}),this.source=a;else if(Ef(a))for(r.set(s,-1,Array(l=a.length)),u=0;u<l;++u)c(s,u,a[u]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){let t=this._argval||bPt,n=this._argops,r,i,o,s;if(n){let a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){let e=this._argops,t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){let t=this._update;if(t){let n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};_Pt=0;Ck.prototype={_filter:SU,_apply:fk,targets(){return this._targets||(this._targets=XU(eM))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){let t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){let t=$v(e);return this.targets().add(t),t},apply(e){let t=$v(null,e);return this.targets().add(t),t},merge(){let e=$v();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{let n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){let t=$v();return this.targets().add($v(null,null,c$e(e,n=>{let r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add($v(null,null,()=>n=!0)),t.targets().add($v(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=SU,this._targets=null}};DPt={skip:!0};KU={},Kh=1,Pv=2,Hx=4,PPt=Kh|Pv,sLe=Kh|Hx,wk=Kh|Pv|Hx,aLe=8,wM=16,lLe=32,uLe=64;Yx.prototype={StopPropagation:KU,ADD:Kh,REM:Pv,MOD:Hx,ADD_REM:PPt,ADD_MOD:sLe,ALL:wk,REFLOW:aLe,SOURCE:wM,NO_SOURCE:lLe,NO_FIELDS:uLe,fork(e){return new Yx(this.dataflow).init(this,e)},clone(){let e=this.fork(wk);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(wk|wM)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Yx(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){let n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&uLe)&&(n.fields=e.fields),t&Kh?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Pv?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Hx?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&lLe?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){let t=e||wk;return t&Kh&&this.add.length||t&Pv&&this.rem.length||t&Hx&&this.mod.length},reflow(e){if(e)return this.fork(wk).reflow();let t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Hx,cLe(this,Kh))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){let t=this.fields||(this.fields={});return Ef(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){let n=this.fields;return(t||this.mod.length)&&n?arguments.length?Ef(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){let n=this;return e&Kh&&(n.addF=HU(n.addF,t)),e&Pv&&(n.remF=HU(n.remF,t)),e&Hx&&(n.modF=HU(n.modF,t)),e&wM&&(n.srcF=HU(n.srcF,t)),n},materialize(e){e=e||wk;let t=this;return e&Kh&&t.addF&&(t.add=zoe(t.add,t.addF),t.addF=null),e&Pv&&t.remF&&(t.rem=zoe(t.rem,t.remF),t.remF=null),e&Hx&&t.modF&&(t.mod=zoe(t.mod,t.modF),t.modF=null),e&wM&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){let n=this,r=t;if(e&wM)return Nv(n.source,n.srcF,r),n;e&Kh&&Nv(n.add,n.addF,r),e&Pv&&Nv(n.rem,n.remF,r),e&Hx&&Nv(n.mod,n.modF,r);let i=n.source;if(e&aLe&&i){let o=n.add.length+n.mod.length;o===i.length||(o?Nv(i,cLe(n,sLe),r):Nv(i,n.srcF,r))}return n}};Xie(JU,Yx,{fork(e){let t=new Yx(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){let t=this,n=t.fields;return n&&t.changes&t.MOD?Ef(e)?e.some(r=>n[r]):n[e]:0},filter(){So("MultiPulse does not support filtering.")},materialize(){So("MultiPulse does not support materialization.")},visit(e,t){let n=this,r=n.pulses,i=r.length,o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});joe={skip:!1,force:!1};Lv.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:CM("error"),warn:CM("warn"),info:CM("info"),debug:CM("debug"),logLevel:CM("level"),cleanThreshold:1e4,add:wPt,connect:CPt,rank:MPt,rerank:$Pt,pulse:HPt,touch:GPt,update:qPt,changeset:Xx,ingest:APt,parse:EPt,preload:kPt,request:TPt,events:SPt,on:NPt,evaluate:LPt,run:zPt,runAsync:BPt,runAfter:UPt,_enqueue:jPt,_getPulse:VPt};Xie(ce,yr,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){let t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});Kx={}});function Af(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var EM=w(()=>{"use strict"});function Zh(e){let t=e,n=e;e.length===1&&(t=(s,a)=>e(s)-a,n=XPt(e));function r(s,a,l,u){for(l==null&&(l=0),u==null&&(u=s.length);l<u;){let c=l+u>>>1;n(s[c],a)<0?l=c+1:u=c}return l}function i(s,a,l,u){for(l==null&&(l=0),u==null&&(u=s.length);l<u;){let c=l+u>>>1;n(s[c],a)>0?u=c:l=c+1}return l}function o(s,a,l,u){l==null&&(l=0),u==null&&(u=s.length);let c=r(s,a,l,u-1);return c>l&&t(s[c-1],a)>-t(s[c],a)?c-1:c}return{left:r,center:o,right:i}}function XPt(e){return(t,n)=>Af(e(t),n)}var Woe=w(()=>{"use strict";EM()});function tj(e){return e===null?NaN:+e}function*hLe(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}var Goe=w(()=>{"use strict"});var gLe,gS,qoe,ZPt,ep,xLe=w(()=>{"use strict";EM();Woe();Goe();gLe=Zh(Af),gS=gLe.right,qoe=gLe.left,ZPt=Zh(tj).center,ep=gS});function Hoe(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}var bLe=w(()=>{"use strict"});function nj(e,t){let n=Hoe(e,t);return n&&Math.sqrt(n)}var yLe=w(()=>{"use strict";bLe()});var wi,vLe=w(()=>{"use strict";wi=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let n=this._partials,r=0;for(let i=0;i<this._n&&i<32;i++){let o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){let t=this._partials,n=this._n,r,i,o,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=s+i,i==r-s&&(s=r))}return s}}});function Yoe(e,t){return Array.from(t,n=>e[n])}var wLe=w(()=>{"use strict"});function _k(e,t,n){var r,i=-1,o,s,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),(a=rj(e,t,n))===0||!isFinite(a))return[];if(a>0){let l=Math.round(e/a),u=Math.round(t/a);for(l*a<e&&++l,u*a>t&&--u,s=new Array(o=u-l+1);++i<o;)s[i]=(l+i)*a}else{a=-a;let l=Math.round(e*a),u=Math.round(t*a);for(l/a<e&&++l,u/a>t&&--u,s=new Array(o=u-l+1);++i<o;)s[i]=(l+i)/a}return r&&s.reverse(),s}function rj(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Koe?10:o>=Xoe?5:o>=Zoe?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Koe?10:o>=Xoe?5:o>=Zoe?2:1)}function bl(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Koe?i*=10:o>=Xoe?i*=5:o>=Zoe&&(i*=2),t<e?-i:i}var Koe,Xoe,Zoe,CLe=w(()=>{"use strict";Koe=Math.sqrt(50),Xoe=Math.sqrt(10),Zoe=Math.sqrt(2)});function Tf(e,t){let n;if(t===void 0)for(let r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}var Qoe=w(()=>{"use strict"});function xS(e,t){let n;if(t===void 0)for(let r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}var Joe=w(()=>{"use strict"});function ij(e,t,n=0,r=e.length-1,i=Af){for(;r>n;){if(r-n>600){let l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),p=Math.max(n,Math.floor(t-u*f/l+d)),m=Math.min(r,Math.floor(t+(l-u)*f/l+d));ij(e,t,p,m,i)}let o=e[t],s=n,a=r;for(AM(e,n,t),i(e[r],o)>0&&AM(e,n,r);s<a;){for(AM(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}i(e[n],o)===0?AM(e,n,a):(++a,AM(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function AM(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}var _Le=w(()=>{"use strict";EM()});function bS(e,t,n){if(e=Float64Array.from(hLe(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return xS(e);if(t>=1)return Tf(e);var r,i=(r-1)*t,o=Math.floor(i),s=Tf(ij(e,o).subarray(0,o+1)),a=xS(e.subarray(o+1));return s+(a-s)*(i-o)}}function TM(e,t,n=tj){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}var ese=w(()=>{"use strict";Qoe();Joe();_Le();Goe()});function oj(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}var SLe=w(()=>{"use strict"});function kM(e,t){return bS(e,.5,t)}var ELe=w(()=>{"use strict";ese()});function*QPt(e){for(let t of e)yield*dEe(t)}function Sk(e){return Array.from(QPt(e))}var ALe=w(()=>{"use strict"});function Eo(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}var TLe=w(()=>{"use strict"});function Ek(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}var kLe=w(()=>{"use strict"});var kr=w(()=>{"use strict";xLe();EM();Woe();yLe();vLe();Qoe();SLe();ELe();ALe();Joe();wLe();ese();TLe();kLe();CLe()});function*NLe(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function sj(e,t,n){let r=Float64Array.from(NLe(e,n));return r.sort(Af),t.map(i=>TM(r,i))}function aj(e,t){return sj(e,[.25,.5,.75],t)}function lj(e,t){let n=e.length,r=nj(e,t),i=aj(e,t),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function tse(e){let t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2],o=e.extent[0],s=e.extent[1],a,l,u,c,f,d,p=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=p/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(p)/r)-l));Math.ceil(p/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=u&&p/c<=t&&(a=c)}c=Math.log(a);let m=c>=0?0:~~(-c/r)+1,h=Math.pow(n,-m-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/a+h)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}function JPt(e){bc=e}function nse(e,t,n,r){if(!e.length)return[void 0,void 0];let i=Float64Array.from(NLe(e,r)),o=i.length,s=t,a,l,u,c;for(u=0,c=Array(s);u<s;++u){for(a=0,l=0;l<o;++l)a+=i[~~(bc()*o)];c[u]=a/o}return c.sort(Af),[bS(c,n/2),bS(c,1-n/2)]}function rse(e,t,n,r){r=r||(d=>d);let i=e.length,o=new Float64Array(i),s=0,a=1,l=r(e[0]),u=l,c=l+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(u=(l+u)/2;s<a;++s)o[s]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;s<a;++s)o[s]=u;return n?eLt(o,t+t/4):o}function eLt(e,t){let n=e.length,r=0,i=1,o,s;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}function tLt(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function nLt(e,t){t==null&&(t=e,e=0);let n,r,i,o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample(){return n+Math.floor(i*bc())},pdf(s){return s===Math.floor(s)&&s>=n&&s<r?1/i:0},cdf(s){let a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf(s){return s>=0&&s<=1?n-1+Math.floor(s*i):NaN}};return o.min(e).max(t)}function DM(e,t){e=e||0,t=t??1;let n=0,r=0,i,o;if(IM===IM)n=IM,IM=NaN;else{do n=bc()*2-1,r=bc()*2-1,i=n*n+r*r;while(i===0||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,IM=r*o}return e+n*t}function uj(e,t,n){n=n??1;let r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*FLe)}function NM(e,t,n){t=t||0,n=n??1;let r=(e-t)/n,i=Math.abs(r),o;if(i>37)o=0;else{let s=Math.exp(-i*i/2),a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o=o/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function FM(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*rLt*iLt(2*e-1)}function iLt(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function cj(e,t){let n,r,i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>DM(n,r),pdf:o=>uj(o,n,r),cdf:o=>NM(o,n,r),icdf:o=>FM(o,n,r)};return i.mean(e).stdev(t)}function fj(e,t){let n=cj(),r=0,i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=lj(e)),i):t},sample(){return e[~~(bc()*r)]+t*n.sample()},pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function dj(e,t){return e=e||0,t=t??1,Math.exp(e+DM()*t)}function pj(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;let r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*FLe*e)}function mj(e,t,n){return NM(Math.log(e),t,n)}function hj(e,t,n){return Math.exp(FM(e,t,n))}function ise(e,t){let n,r,i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=o??1,i):r},sample:()=>dj(n,r),pdf:o=>pj(o,n,r),cdf:o=>mj(o,n,r),icdf:o=>hj(o,n,r)};return i.mean(e).stdev(t)}function ose(e,t){let n=0,r;function i(s){let a=[],l=0,u;for(u=0;u<n;++u)l+=a[u]=s[u]==null?1:+s[u];for(u=0;u<n;++u)a[u]/=l;return a}let o={weights(s){return arguments.length?(r=i(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){let s=bc(),a=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(s<l){a=e[u];break}return a.sample()},pdf(s){let a=0,l=0;for(;l<n;++l)a+=r[l]*e[l].pdf(s);return a},cdf(s){let a=0,l=0;for(;l<n;++l)a+=r[l]*e[l].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function gj(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*bc()}function xj(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function bj(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function yj(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function sse(e,t){let n,r,i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=o??1,i):r},sample:()=>gj(n,r),pdf:o=>xj(o,n,r),cdf:o=>bj(o,n,r),icdf:o=>yj(o,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function RM(e,t,n,r){let i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function vj(e,t,n,r){e=e.filter(p=>{let m=t(p),h=n(p);return m!=null&&(m=+m)>=m&&h!=null&&(h=+h)>=h}),r&&e.sort((p,m)=>t(p)-t(m));let i=e.length,o=new Float64Array(i),s=new Float64Array(i),a=0,l=0,u=0,c,f,d;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,l+=(c-l)/a,u+=(f-u)/a;for(a=0;a<i;++a)o[a]-=l,s[a]-=u;return[o,s,l,u]}function OM(e,t,n,r){let i=-1,o,s;for(let a of e)o=t(a),s=n(a),o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s&&r(o,s,++i)}function Ak(e,t,n,r,i){let o=0,s=0;return OM(e,t,n,(a,l)=>{let u=l-i(a),c=l-r;o+=u*u,s+=c*c}),1-o/s}function wj(e,t,n){let r=0,i=0,o=0,s=0,a=0;OM(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});let l=RM(r,i,o,s),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:Ak(e,t,n,i,u)}}function ase(e,t,n){let r=0,i=0,o=0,s=0,a=0;OM(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});let l=RM(r,i,o,s),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:Ak(e,t,n,i,u)}}function lse(e,t,n){let[r,i,o,s]=vj(e,t,n),a=0,l=0,u=0,c=0,f=0,d,p,m;OM(e,t,n,(b,y)=>{d=r[f++],p=Math.log(y),m=d*y,a+=(y*p-a)/f,l+=(m-l)/f,u+=(m*p-u)/f,c+=(d*m-c)/f});let[h,g]=RM(l/s,a/s,u/s,c/s),x=b=>Math.exp(h+g*(b-o));return{coef:[Math.exp(h-g*o),g],predict:x,rSquared:Ak(e,t,n,s,x)}}function use(e,t,n){let r=0,i=0,o=0,s=0,a=0,l=0;OM(e,t,n,(f,d)=>{let p=Math.log(f),m=Math.log(d);++l,r+=(p-r)/l,i+=(m-i)/l,o+=(p*m-o)/l,s+=(p*p-s)/l,a+=(d-a)/l});let u=RM(r,i,o,s),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:Ak(e,t,n,a,c)}}function Cj(e,t,n){let[r,i,o,s]=vj(e,t,n),a=r.length,l=0,u=0,c=0,f=0,d=0,p,m,h,g;for(p=0;p<a;)m=r[p],h=i[p++],g=m*m,l+=(g-l)/p,u+=(g*m-u)/p,c+=(g*g-c)/p,f+=(m*h-f)/p,d+=(g*h-d)/p;let x=c-l*l,b=l*x-u*u,y=(d*l-f*u)/b,v=(f*x-d*u)/b,C=-y*l,_=S=>(S=S-o,y*S*S+v*S+C+s);return{coef:[C-v*o+y*o*o+s,v-2*y*o,y],predict:_,rSquared:Ak(e,t,n,s,_)}}function cse(e,t,n,r){if(r===1)return wj(e,t,n);if(r===2)return Cj(e,t,n);let[i,o,s,a]=vj(e,t,n),l=i.length,u=[],c=[],f=r+1,d,p,m,h,g;for(d=0;d<f;++d){for(m=0,h=0;m<l;++m)h+=Math.pow(i[m],d)*o[m];for(u.push(h),g=new Float64Array(f),p=0;p<f;++p){for(m=0,h=0;m<l;++m)h+=Math.pow(i[m],d+p);g[p]=h}c.push(g)}c.push(u);let x=sLt(c),b=y=>{y-=s;let v=a+x[0]+x[1]*y+x[2]*y*y;for(d=3;d<f;++d)v+=x[d]*Math.pow(y,d);return v};return{coef:oLt(f,x,-s,a),predict:b,rSquared:Ak(e,t,n,a,b)}}function oLt(e,t,n,r){let i=Array(e),o,s,a,l;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],l=1,i[o]+=a,s=1;s<=o;++s)l*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*l;return i[0]+=r,i}function sLt(e){let t=e.length-1,n=[],r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}function fse(e,t,n,r){let[i,o,s,a]=vj(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let p=-1;++p<=ILe;){let m=[0,u-1];for(let g=0;g<l;++g){let x=i[g],b=m[0],y=m[1],v=x-i[b]>i[y]-x?b:y,C=0,_=0,S=0,E=0,T=0,I=1/Math.abs(i[v]-x||1);for(let F=b;F<=y;++F){let B=i[F],M=o[F],z=aLt(Math.abs(x-B)*I)*d[F],W=B*z;C+=z,_+=W,S+=M*z,E+=M*W,T+=B*W}let[k,O]=RM(_/C,S/C,E/C,T/C);c[g]=k+O*x,f[g]=Math.abs(o[g]-c[g]),lLt(i,g+1,m)}if(p===ILe)break;let h=kM(f);if(Math.abs(h)<DLe)break;for(let g=0,x,b;g<l;++g)x=f[g]/(6*h),d[g]=x>=1?DLe:(b=1-x*x)*b}return uLt(i,c,s,a)}function aLt(e){return(e=1-e*e*e)*e*e}function lLt(e,t,n){let r=e[t],i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}function uLt(e,t,n,r){let i=e.length,o=[],s=0,a=0,l=[],u;for(;s<i;++s)u=e[s]+n,l[0]===u?l[1]+=(t[s]-l[1])/++a:(a=0,l[1]+=r,l=[u,t[s]],o.push(l));return l[1]+=r,o}function Tk(e,t,n,r){n=n||25,r=Math.max(n,r||200);let i=h=>[h,e(h)],o=t[0],s=t[1],a=s-o,l=a/r,u=[i(o)],c=[];if(n===r){for(let h=1;h<r;++h)u.push(i(o+h/n*a));return u.push(i(s)),u}else{c.push(i(s));for(let h=n;--h>0;)c.push(i(o+h/n*a))}let f=u[0],d=c[c.length-1],p=1/a,m=fLt(f[1],c);for(;d;){let h=i((f[0]+d[0])/2);h[0]-f[0]>=l&&dLt(f,h,d,p,m)>cLt?c.push(h):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function fLt(e,t){let n=e,r=e,i=t.length;for(let o=0;o<i;++o){let s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}function dLt(e,t,n,r,i){let o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}var bc,FLe,rLt,IM,ILe,DLe,cLt,kk=w(()=>{"use strict";kr();bc=Math.random;FLe=Math.sqrt(2*Math.PI),rLt=Math.SQRT2,IM=NaN;ILe=2,DLe=1e-12;cLt=.5*Math.PI/180});function Un(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=function(o,s){return t(o=new Date(+o),s==null?1:Math.floor(s)),o},i.range=function(o,s,a){var l=[],u;if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return l;do l.push(u=new Date(+o)),t(o,a),e(o);while(u<o&&o<s);return l},i.filter=function(o){return Un(function(s){if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},function(s,a){if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););})},n&&(i.count=function(o,s){return dse.setTime(+o),pse.setTime(+s),e(dse),e(pse),Math.floor(n(dse,pse))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(s){return r(s)%o===0}:function(s){return i.count(0,s)%o===0}):i}),i}var dse,pse,yl=w(()=>{"use strict";dse=new Date,pse=new Date});var _j,Bv,RLe,mse=w(()=>{"use strict";yl();_j=Un(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});_j.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Un(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):_j};Bv=_j,RLe=_j.range});var OLe,vl,MLe,hse=w(()=>{"use strict";yl();OLe=Un(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*1e3)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),vl=OLe,MLe=OLe.range});var $Le,vS,pLt,gse=w(()=>{"use strict";yl();$Le=Un(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},function(e,t){e.setTime(+e+t*6e4)},function(e,t){return(t-e)/6e4},function(e){return e.getMinutes()}),vS=$Le,pLt=$Le.range});var PLe,CS,mLt,xse=w(()=>{"use strict";yl();PLe=Un(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},function(e,t){e.setTime(+e+t*36e5)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),CS=PLe,mLt=PLe.range});var LLe,yc,hLt,yse=w(()=>{"use strict";yl();LLe=Un(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),yc=LLe,hLt=LLe.range});function _S(e){return Un(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5})}var kf,Ik,zLe,ULe,zv,jLe,VLe,WLe,gLt,xLt,bLt,yLt,vLt,wLt,vse=w(()=>{"use strict";yl();kf=_S(0),Ik=_S(1),zLe=_S(2),ULe=_S(3),zv=_S(4),jLe=_S(5),VLe=_S(6),WLe=kf.range,gLt=Ik.range,xLt=zLe.range,bLt=ULe.range,yLt=zv.range,vLt=jLe.range,wLt=VLe.range});var GLe,Uv,CLt,wse=w(()=>{"use strict";yl();GLe=Un(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),Uv=GLe,CLt=GLe.range});var Cse,vc,_Lt,_se=w(()=>{"use strict";yl();Cse=Un(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Cse.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Un(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};vc=Cse,_Lt=Cse.range});var qLe,SS,SLt,Sse=w(()=>{"use strict";yl();qLe=Un(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*6e4)},function(e,t){return(t-e)/6e4},function(e){return e.getUTCMinutes()}),SS=qLe,SLt=qLe.range});var HLe,ES,ELt,Ese=w(()=>{"use strict";yl();HLe=Un(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*36e5)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),ES=HLe,ELt=HLe.range});var YLe,wc,ALt,Ase=w(()=>{"use strict";yl();YLe=Un(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),wc=YLe,ALt=YLe.range});function AS(e){return Un(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/6048e5})}var If,Dk,KLe,XLe,jv,ZLe,QLe,JLe,TLt,kLt,ILt,DLt,NLt,FLt,Tse=w(()=>{"use strict";yl();If=AS(0),Dk=AS(1),KLe=AS(2),XLe=AS(3),jv=AS(4),ZLe=AS(5),QLe=AS(6),JLe=If.range,TLt=Dk.range,kLt=KLe.range,ILt=XLe.range,DLt=jv.range,NLt=ZLe.range,FLt=QLe.range});var eBe,Vv,RLt,kse=w(()=>{"use strict";yl();eBe=Un(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),Vv=eBe,RLt=eBe.range});var Ise,Cc,OLt,Dse=w(()=>{"use strict";yl();Ise=Un(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Ise.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Un(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};Cc=Ise,OLt=Ise.range});function nBe(e,t,n,r,i,o){let s=[[vl,1,1e3],[vl,5,5*1e3],[vl,15,15*1e3],[vl,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[r,1,864e5],[r,2,2*864e5],[n,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function a(u,c,f){let d=c<u;d&&([u,c]=[c,u]);let p=f&&typeof f.range=="function"?f:l(u,c,f),m=p?p.range(u,+c+1):[];return d?m.reverse():m}function l(u,c,f){let d=Math.abs(c-u)/f,p=Zh(([,,g])=>g).right(s,d);if(p===s.length)return e.every(bl(u/31536e6,c/31536e6,f));if(p===0)return Bv.every(Math.max(bl(u,c,f),1));let[m,h]=s[d/s[p-1][2]<s[p][2]/d?p-1:p];return m.every(h)}return[a,l]}var Nse,Fse,Rse,Ose,rBe=w(()=>{"use strict";kr();mse();hse();gse();xse();yse();vse();wse();_se();Sse();Ese();Ase();Tse();kse();Dse();[Nse,Fse]=nBe(Cc,Vv,If,wc,ES,SS),[Rse,Ose]=nBe(vc,Uv,kf,yc,CS,vS)});var MM=w(()=>{"use strict";mse();hse();gse();xse();yse();vse();wse();_se();Sse();Ese();Ase();Tse();kse();Dse();rBe()});function Ej(e){let t=Rt(e).slice(),n={};return t.length||Se("Missing time unit."),t.forEach(i=>{Dt(Mse,i)?n[i]=1:Se("Invalid time unit: ".concat(i,"."))}),(n[Ao]||n[qs]?1:0)+(n[wl]||n[Hs]||n[Cl]?1:0)+(n[Jh]?1:0)>1&&Se("Incompatible time units: ".concat(e)),t.sort((i,o)=>Mse[i]-Mse[o]),t}function Use(e,t){let n=Jt({},$Lt,t),r=Ej(e),i=r.length,o="",s=0,a,l;for(s=0;s<i;)for(a=r.length;a>s;--a)if(l=r.slice(s,a).join("-"),n[l]!=null){o+=n[l],s=a;break}return o.trim()}function jse(e){return TS.setFullYear(e),TS.setMonth(0),TS.setDate(1),TS.setHours(0,0,0,0),TS}function Vse(e){return sBe(new Date(e))}function Wse(e){return $se(new Date(e))}function sBe(e){return yc.count(jse(e.getFullYear())-1,e)}function $se(e){return kf.count(jse(e.getFullYear())-1,e)}function Pse(e){return jse(e).getDay()}function PLt(e,t,n,r,i,o,s){if(0<=e&&e<100){let a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function Gse(e){return aBe(new Date(e))}function qse(e){return Lse(new Date(e))}function aBe(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return wc.count(t-1,e)}function Lse(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return If.count(t-1,e)}function Bse(e){return TS.setTime(Date.UTC(e,0,1)),TS.getUTCDay()}function LLt(e,t,n,r,i,o,s){if(0<=e&&e<100){let a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function lBe(e,t,n,r,i){let o=t||1,s=Fn(e),a=(x,b,y)=>(y=y||x,BLt(n[y],r[y],x===s&&o,b)),l=new Date,u=wa(e),c=u[gs]?a(gs):ps(2012),f=u[Hs]?a(Hs):u[wl]?a(wl):Gd,d=u[Ao]&&u[qs]?a(qs,1,Ao+qs):u[Ao]?a(Ao,1):u[qs]?a(qs,1):u[Cl]?a(Cl,1):u[Jh]?a(Jh,1):Lh,p=u[su]?a(su):Gd,m=u[au]?a(au):Gd,h=u[_c]?a(_c):Gd,g=u[Df]?a(Df):Gd;return function(x){l.setTime(+x);let b=c(l);return i(b,f(l),d(l,b),p(l),m(l),h(l),g(l))}}function BLt(e,t,n,r){let i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}function Nk(e,t,n){return t+e*7-(n+6)%7}function Hse(e,t){return lBe(e,t||1,zLt,ULt,PLt)}function Yse(e,t){return lBe(e,t||1,jLt,VLt,LLt)}function Zx(e){return WLt[e]}function Qx(e){return GLt[e]}function uBe(e,t,n){return e?e.offset(t,n):void 0}function Kse(e,t,n){return uBe(Zx(e),t,n)}function Xse(e,t,n){return uBe(Qx(e),t,n)}function cBe(e,t,n,r){return e?e.range(t,n,r):void 0}function Zse(e,t,n,r){return cBe(Zx(e),t,n,r)}function Qse(e,t,n,r){return cBe(Qx(e),t,n,r)}function Jse(e){let t=e.extent,n=e.maxbins||40,r=Math.abs(sS(t))/n,i=Zh(a=>a[2]).right($M,r),o,s;return i===$M.length?(o=dBe,s=bl(t[0]/zse,t[1]/zse,n)):i?(i=$M[r/$M[i-1][2]<$M[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=fBe,s=Math.max(bl(t[0],t[1],n),1)),{units:o,step:s}}var gs,wl,Hs,Ao,Cl,qs,Jh,su,au,_c,Df,Sj,Mse,$Lt,TS,zLt,ULt,jLt,VLt,WLt,GLt,PM,LM,BM,Aj,qLt,iBe,zse,fBe,zM,UM,jM,HLt,YLt,oBe,dBe,$M,Fk=w(()=>{"use strict";ao();MM();kr();gs="year",wl="quarter",Hs="month",Ao="week",Cl="date",qs="day",Jh="dayofyear",su="hours",au="minutes",_c="seconds",Df="milliseconds",Sj=[gs,wl,Hs,Ao,Cl,qs,Jh,su,au,_c,Df],Mse=Sj.reduce((e,t,n)=>(e[t]=1+n,e),{});$Lt={[gs]:"%Y ",[wl]:"Q%q ",[Hs]:"%b ",[Cl]:"%d ",[Ao]:"W%U ",[qs]:"%a ",[Jh]:"%j ",[su]:"%H:00",[au]:"00:%M",[_c]:":%S",[Df]:".%L",["".concat(gs,"-").concat(Hs)]:"%Y-%m ",["".concat(gs,"-").concat(Hs,"-").concat(Cl)]:"%Y-%m-%d ",["".concat(su,"-").concat(au)]:"%H:%M"};TS=new Date;zLt={[gs]:e=>e.getFullYear(),[wl]:e=>Math.floor(e.getMonth()/3),[Hs]:e=>e.getMonth(),[Cl]:e=>e.getDate(),[su]:e=>e.getHours(),[au]:e=>e.getMinutes(),[_c]:e=>e.getSeconds(),[Df]:e=>e.getMilliseconds(),[Jh]:e=>sBe(e),[Ao]:e=>$se(e),[Ao+qs]:(e,t)=>Nk($se(e),e.getDay(),Pse(t)),[qs]:(e,t)=>Nk(1,e.getDay(),Pse(t))},ULt={[wl]:e=>3*e,[Ao]:(e,t)=>Nk(e,0,Pse(t))};jLt={[gs]:e=>e.getUTCFullYear(),[wl]:e=>Math.floor(e.getUTCMonth()/3),[Hs]:e=>e.getUTCMonth(),[Cl]:e=>e.getUTCDate(),[su]:e=>e.getUTCHours(),[au]:e=>e.getUTCMinutes(),[_c]:e=>e.getUTCSeconds(),[Df]:e=>e.getUTCMilliseconds(),[Jh]:e=>aBe(e),[Ao]:e=>Lse(e),[qs]:(e,t)=>Nk(1,e.getUTCDay(),Bse(t)),[Ao+qs]:(e,t)=>Nk(Lse(e),e.getUTCDay(),Bse(t))},VLt={[wl]:e=>3*e,[Ao]:(e,t)=>Nk(e,0,Bse(t))};WLt={[gs]:vc,[wl]:Uv.every(3),[Hs]:Uv,[Ao]:kf,[Cl]:yc,[qs]:yc,[Jh]:yc,[su]:CS,[au]:vS,[_c]:vl,[Df]:Bv},GLt={[gs]:Cc,[wl]:Vv.every(3),[Hs]:Vv,[Ao]:If,[Cl]:wc,[qs]:wc,[Jh]:wc,[su]:ES,[au]:SS,[_c]:vl,[Df]:Bv};PM=1e3,LM=PM*60,BM=LM*60,Aj=BM*24,qLt=Aj*7,iBe=Aj*30,zse=Aj*365,fBe=[gs,Hs,Cl,su,au,_c,Df],zM=fBe.slice(0,-1),UM=zM.slice(0,-1),jM=UM.slice(0,-1),HLt=jM.slice(0,-1),YLt=[gs,Ao],oBe=[gs,Hs],dBe=[gs],$M=[[zM,1,PM],[zM,5,5*PM],[zM,15,15*PM],[zM,30,30*PM],[UM,1,LM],[UM,5,5*LM],[UM,15,15*LM],[UM,30,30*LM],[jM,1,BM],[jM,3,3*BM],[jM,6,6*BM],[jM,12,12*BM],[HLt,1,Aj],[YLt,1,qLt],[oBe,1,iBe],[oBe,3,3*iBe],[dBe,1,zse]]});var kae={};rn(kae,{aggregate:()=>Wv,bin:()=>iae,collect:()=>oae,compare:()=>vBe,countpattern:()=>sae,cross:()=>aae,density:()=>lae,dotbin:()=>cae,expression:()=>EBe,extent:()=>fae,facet:()=>kj,field:()=>ABe,filter:()=>pae,flatten:()=>mae,fold:()=>hae,formula:()=>gae,generate:()=>TBe,impute:()=>xae,joinaggregate:()=>bae,kde:()=>yae,key:()=>kBe,load:()=>IBe,lookup:()=>vae,multiextent:()=>DBe,multivalues:()=>NBe,params:()=>FBe,pivot:()=>wae,prefacet:()=>RBe,project:()=>Cae,proxy:()=>OBe,quantile:()=>_ae,relay:()=>MBe,sample:()=>Sae,sequence:()=>Eae,sieve:()=>$Be,subflow:()=>dae,timeunit:()=>Aae,tupleindex:()=>LBe,values:()=>BBe,window:()=>Tae});function KLt(e){return t=>{let n=e.length,r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function nae(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:KLt(e)}function hBe(e,t,n){return n||e+(t?"_"+t:"")}function ZLt(e,t){return n=>Jt({name:e,out:n||e},XLt,t)}function gBe(e,t){return VM[e](t)}function xBe(e,t){return e.idx-t.idx}function QLt(e){let t={};e.forEach(r=>t[r.name]=r);let n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=VM[i]())})};return e.forEach(n),Object.values(t).sort(xBe)}function JLt(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function eBt(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function tBt(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function nBt(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function bBe(e,t){let n=t||gl,r=QLt(e),i=e.slice().sort(xBe);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=JLt,o.prototype.add=eBt,o.prototype.rem=tBt,o.prototype.set=nBt,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function rae(e){this._key=e?Wd(e):bt,this.reset()}function Wv(e){ce.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function iae(e){ce.call(this,null,e)}function yBe(e,t,n){let r=e,i=t||[],o=n||[],s={},a=0;return{add:l=>o.push(l),remove:l=>s[r(l)]=++a,size:()=>i.length,data:(l,u)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),u&&l&&i.sort(l),o.length&&(i=l?Vie(l,i,o.sort(l)):i.concat(o),o=[]),i)}}function oae(e){ce.call(this,[],e)}function vBe(e){yr.call(this,null,iBt,e)}function iBt(e){return this.value&&!e.modified()?this.value:$ie(e.fields,e.orders)}function sae(e){ce.call(this,null,e)}function oBt(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}function aae(e){ce.call(this,null,e)}function sBt(e,t,n,r){for(var i=[],o={},s=e.length,a=0,l,u;a<s;++a)for(o[t]=u=e[a],l=0;l<s;++l)o[n]=e[l],r(o)&&(i.push(Cn(o)),o={},o[t]=u);return i}function wBe(e,t){let n=e[mBe];Dt(pBe,n)||Se("Unknown distribution function: "+n);let r=pBe[n]();for(let i in e)i===lBt?r.data((e.from||t()).map(e[i])):i===aBt?r[i](e[i].map(o=>wBe(o,t))):typeof r[i]===mBe&&r[i](e[i]);return r}function lae(e){ce.call(this,null,e)}function cBt(e){return()=>e.materialize(e.SOURCE).source}function _Be(e,t){return e?e.map((n,r)=>t[r]||si(n)):null}function uae(e,t,n){let r=[],i=f=>f(l),o,s,a,l,u,c;if(t==null)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)l=e[s],u=t.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}function cae(e){ce.call(this,null,e)}function EBe(e){yr.call(this,null,dBt,e),this.modified(!0)}function dBt(e){let t=e.expr;return this.value&&!e.modified("expr")?this.value:hc(n=>t(n,e),Xo(t),si(t))}function fae(e){ce.call(this,[void 0,void 0],e)}function dae(e,t){yr.call(this,e),this.parent=t,this.count=0}function kj(e){ce.call(this,{},e),this._keys=Dv();let t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}function ABe(e){yr.call(this,null,pBt,e)}function pBt(e){return this.value&&!e.modified()?this.value:Vt(e.name)?Rt(e.name).map(t=>Wd(t)):Wd(e.name,e.as)}function pae(e){ce.call(this,Dv(),e)}function mae(e){ce.call(this,[],e)}function hae(e){ce.call(this,[],e)}function gae(e){ce.call(this,null,e)}function TBe(e){ce.call(this,[],e)}function xae(e){ce.call(this,[],e)}function hBt(e){var t=e.method||Tj.value,n;if(Tj[t]==null)Se("Unrecognized imputation method: "+t);else return t===Tj.value?(n=e.value!==void 0?e.value:0,()=>n):Tj[t]}function gBt(e){let t=e.field;return n=>n?t(n):NaN}function xBt(e,t,n,r){var i=x=>x(g),o=[],s=r?r.slice():[],a={},l={},u,c,f,d,p,m,h,g;for(s.forEach((x,b)=>a[x]=b+1),d=0,h=e.length;d<h;++d)g=e[d],m=n(g),p=a[m]||(a[m]=s.push(m)),c=(u=t?t.map(i):mBt)+"",(f=l[c])||(f=l[c]=[],o.push(f),f.values=u),f[p-1]=g;return o.domain=s,o}function bae(e){Wv.call(this,e)}function yae(e){ce.call(this,null,e)}function kBe(e){yr.call(this,null,bBt,e)}function bBt(e){return this.value&&!e.modified()?this.value:Uie(e.fields,e.flat)}function IBe(e){ce.call(this,[],e),this._pending=null}function yBt(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function tae(e,t,n){n.forEach(Cn);let r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function vae(e){ce.call(this,{},e)}function DBe(e){yr.call(this,null,vBt,e)}function vBt(e){if(this.value&&!e.modified())return this.value;let t=e.extents,n=t.length,r=1/0,i=-1/0,o,s;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function NBe(e){yr.call(this,null,wBt,e)}function wBt(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function FBe(e){ce.call(this,null,e)}function wae(e){Wv.call(this,e)}function CBt(e,t){let n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",o=Xo(n).concat(Xo(r)),s=SBt(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>_Bt(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}function _Bt(e,t,n,r){return hc(i=>t(i)===e?n(i):NaN,r,e+"")}function SBt(e,t,n){let r={},i=[];return n.visit(n.SOURCE,o=>{let s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(QO),t?i.slice(0,t):i}function RBe(e){kj.call(this,e)}function Cae(e){ce.call(this,null,e)}function EBt(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}function OBe(e){ce.call(this,null,e)}function _ae(e){ce.call(this,null,e)}function MBe(e){ce.call(this,null,e)}function Sae(e){ce.call(this,[],e),this.count=0}function Eae(e){ce.call(this,null,e)}function $Be(e){ce.call(this,null,e),this.modified(!0)}function Aae(e){ce.call(this,null,e)}function LBe(e){ce.call(this,Dv(),e)}function BBe(e){ce.call(this,null,e)}function TBt(e,t,n,r){let i=WM[e](t,n);return{init:i.init||Gd,update:function(o,s){s[r]=i.next(o)}}}function kBt(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}function zBe(e){let t=Rt(e.ops),n=Rt(e.fields),r=Rt(e.params),i=Rt(e.as),o=this.outputs=[],s=this.windows=[],a={},l={},u=[],c=[],f=!0;function d(p){Rt(Xo(p)).forEach(m=>a[m]=1)}d(e.sort),t.forEach((p,m)=>{let h=n[m],g=si(h),x=hBe(p,g,i[m]);if(d(h),o.push(x),Dt(WM,p))s.push(TBt(p,n[m],r[m],x));else{if(h==null&&p!=="count"&&Se("Null aggregate field specified."),p==="count"){u.push(x);return}f=!1;let b=l[g];b||(b=l[g]=[],b.field=h,c.push(b)),b.push(gBe(p,x))}}),(u.length||c.length)&&(this.cell=DBt(c,u,f)),this.inputs=Object.keys(a)}function DBt(e,t,n){e=e.map(l=>bBe(l,l.field));let r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new rae;return r.add=function(l){if(r.num+=1,!n){a&&a.add(l);for(let u=0;u<i;++u)o[u].add(o[u].get(l),l)}},r.rem=function(l){if(r.num-=1,!n){a&&a.rem(l);for(let u=0;u<i;++u)o[u].rem(o[u].get(l),l)}},r.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=r.num;if(!n)for(u=0,c=o.length;u<c;++u)o[u].set(l)},r.init=function(){r.num=0,a&&a.reset();for(let l=0;l<i;++l)o[l].init()},r}function Tae(e){ce.call(this,{},e),this._mlen=0,this._mods=[]}function NBt(e,t,n,r){let i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),l=a.length,u=o?Zh(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||ps(-1)};t.init();for(let f=0;f<l;++f)FBt(c,s,f,l),o&&RBt(c,u),t.update(c,a[f])}function FBt(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function RBt(e,t){let n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}var eae,XLt,VM,GM,Ys,rBt,pBe,aBt,mBe,lBt,CBe,uBt,SBe,fBt,Tj,mBt,ABt,PBe,WM,IBt,UBe,jBe=w(()=>{"use strict";ao();hs();kk();kr();Fk();eae=()=>{},XLt={init:eae,add:eae,rem:eae,idx:0},VM={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},GM=Object.keys(VM);GM.forEach(e=>{VM[e]=ZLt(e,VM[e])});Ys=rae.prototype;Ys.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ys.add=function(e){this._add.push(e)};Ys.rem=function(e){this._rem.push(e)};Ys.values=function(){if(this._get=null,this._rem.length===0)return this._add;let e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={},a,l,u;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,l=0;a<r;++a)s[n(u=e[a])]?s[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o};Ys.distinct=function(e){let t=this.values(),n={},r=t.length,i=0,o;for(;--r>=0;)o=e(t[r])+"",Dt(n,o)||(n[o]=1,++i);return i};Ys.extent=function(e){if(this._get!==e||!this._ext){let t=this.values(),n=Lie(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ys.argmin=function(e){return this.extent(e)[0]||{}};Ys.argmax=function(e){return this.extent(e)[1]||{}};Ys.min=function(e){let t=this.extent(e)[0];return t!=null?e(t):void 0};Ys.max=function(e){let t=this.extent(e)[1];return t!=null?e(t):void 0};Ys.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=aj(this.values(),e),this._get=e),this._q};Ys.q1=function(e){return this.quartile(e)[0]};Ys.q2=function(e){return this.quartile(e)[1]};Ys.q3=function(e){return this.quartile(e)[2]};Ys.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=nse(this.values(),1e3,.05,e),this._get=e),this._ci};Ys.ci0=function(e){return this.ci(e)[0]};Ys.ci1=function(e){return this.ci(e)[1]};Wv.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:GM},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};$e(Wv,ce,{transform(e,t){let n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){let e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let l,u,c,f;for(l in a)for(c=a[l].tuple,u=0;u<i;++u)r[u][f=c[n[u]]]=f}o(e._prev),o(t);function s(a,l,u){let c=n[u],f=r[u++];for(let d in f){let p=a?a+"|"+d:d;l[c]=f[d],u<i?s(p,l,u):t[p]||e.cell(p,l)}}s("",{},0)},init(e){let t=this._inputs=[],n=this._outputs=[],r={};function i(g){let x=Rt(Xo(g)),b=x.length,y=0,v;for(;y<b;++y)r[v=x[y]]||(r[v]=1,t.push(v))}this._dims=Rt(e.groupby),this._dnames=this._dims.map(g=>{let x=si(g);return i(g),n.push(x),x}),this.cellkey=e.key?e.key:nae(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];let o=e.fields||[null],s=e.ops||["count"],a=e.as||[],l=o.length,u={},c,f,d,p,m,h;for(l!==s.length&&Se("Unmatched number of fields and aggregate ops."),h=0;h<l;++h){if(c=o[h],f=s[h],c==null&&f!=="count"&&Se("Null aggregate field specified."),p=si(c),m=hBe(f,p,a[h]),n.push(m),f==="count"){this._counts.push(m);continue}d=u[p],d||(i(c),d=u[p]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(gBe(f,m))}return this._measures=this._measures.map(g=>bBe(g,g.field)),{}},cellkey:nae(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){let n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){let r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new rae),n},newtuple(e,t){let n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?QU(t.tuple,o):Cn(o)},clean(){let e=this.value;for(let t in e)e[t].num===0&&delete e[t]},add(e){let t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);let r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){let t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);let r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){let t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){let r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){let t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod,l,u,c,f;if(r)for(u in r)l=r[u],(!i||l.num)&&s.push(l.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(l.num===0&&i?s:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});rBt=1e-14;iae.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};$e(iae,ce,{transform(e,t){let n=e.interval!==!1,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],l=s[1],u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(Xo(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{let f=r(c);c[a]=f,c[l]=f==null?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;let t=e.field,n=tse(e),r=n.step,i=n.start,o=i+Math.ceil((n.stop-i)/r)*r,s,a;(s=e.anchor)!=null&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);let l=function(u){let c=qd(t(u));return c==null?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(rBt+(c-i)/r))};return l.start=i,l.stop=n.stop,l.step=r,this.value=hc(l,Xo(t),e.name||"bin_"+si(t))}});oae.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};$e(oae,ce,{transform(e,t){let n=t.fork(t.ALL),r=yBe(bt,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Xh(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});$e(vBe,yr);sae.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};$e(sae,ce,{transform(e,t){let n=f=>d=>{for(var p=oBt(a(d),e.case,o)||[],m,h=0,g=p.length;h<g;++h)s.test(m=p[h])||f(m)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,l=e.as||["text","count"],u=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){let n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS),a,l,u;for(a in n)l=r[a],u=n[a]||0,!l&&u?(r[a]=l=Cn({}),l[i]=a,l[o]=u,s.add.push(l)):u===0?(l&&s.rem.push(l),n[a]=null,r[a]=null):l[o]!==u&&(l[o]=u,s.mod.push(l));return s.modifies(t)}});aae.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};$e(aae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter"),a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=sBt(a,i,o,e.filter||Bh)):n.mod=a,n.source=this.value,n.modifies(r)}});pBe={kde:fj,mixture:ose,normal:cj,lognormal:ise,uniform:sse},aBt="distributions",mBe="function",lBt="field";CBe=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],uBt={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:CBe},{name:"weights",type:"number",array:!0}]};lae.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:CBe.concat(uBt)},{name:"as",type:"string",array:!0,default:["value","density"]}]};$e(lae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=wBe(e.distribution,cBt(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200,s=e.method||"pdf";s!=="pdf"&&s!=="cdf"&&Se("Invalid density method: "+s),!e.extent&&!r.data&&Se("Missing density extent parameter."),s=r[s];let a=e.as||["value","density"],l=e.extent||Hd(r.data()),u=Tk(s,l,i,o).map(c=>{let f={};return f[a[0]]=c[0],f[a[1]]=c[1],Cn(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});SBe="bin";cae.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:SBe}]};fBt=(e,t)=>sS(Hd(e,t))/30;$e(cae,ce,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;let n=t.materialize(t.SOURCE).source,r=uae(t.source,e.groupby,gl),i=e.smooth||!1,o=e.field,s=e.step||fBt(n,o),a=Xh((m,h)=>o(m)-o(h)),l=e.as||SBe,u=r.length,c=1/0,f=-1/0,d=0,p;for(;d<u;++d){let m=r[d].sort(a);p=-1;for(let h of rse(m,s,i,o))h<c&&(c=h),h>f&&(f=h),m[++p][l]=h}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(l)}});$e(EBe,yr);fae.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};$e(fae,ce,{transform(e,t){let n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field"),o=n[0],s=n[1];if((i||o==null)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{let l=qd(r(a));l!=null&&(l<o&&(o=l),l>s&&(s=l))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=si(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}});$e(dae,yr,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});$e(kj,ce,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){let i=this.value,o=Dt(i,e)&&i[e],s,a;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new dae(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){let e=this.value,t=0;for(let n in e)if(e[n].count===0){let r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){let n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){let t=this._targets,n=t.length,r=e?e.length:0,i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){let n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=l=>this.subflow(l,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{let u=bt(l),c=o.get(u);c!==void 0&&(o.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{let u=r(l);o.set(bt(l),u),a(u).add(l)}),s||t.modified(r.fields)?t.visit(t.MOD,l=>{let u=bt(l),c=o.get(u),f=r(l);c===f?a(f).mod(l):(o.set(u,f),a(c).rem(l),a(f).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(o.get(bt(l))).mod(l)}),s&&t.visit(t.REFLOW,l=>{let u=bt(l),c=o.get(u),f=r(l);c!==f&&(o.set(u,f),a(c).rem(l),a(f).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});$e(ABe,yr);pae.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};$e(pae,ce,{transform(e,t){let n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,l=e.expr,u=!0;t.visit(t.REM,f=>{let d=bt(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{l(f,e)?o.push(f):r.set(bt(f),1)});function c(f){let d=bt(f),p=l(f,e),m=r.get(d);p&&m?(r.delete(d),o.push(f)):!p&&!m?(r.set(d,1),s.push(f)):u&&p&&!m&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});mae.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};$e(mae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.fields,i=_Be(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{let l=r.map(m=>m(a)),u=l.reduce((m,h)=>Math.max(m,h.length),0),c=0,f,d,p;for(;c<u;++c){for(d=ZU(a),f=0;f<s;++f)d[i[f]]=(p=l[f][c])==null?null:p;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}});hae.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};$e(hae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(si),o=e.as||["key","value"],s=o[0],a=o[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,f;c<l;++c)f=ZU(u),f[s]=i[c],f[a]=r[c](u),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});gae.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};$e(gae,ce,{transform(e,t){let n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}});$e(TBe,ce,{transform(e,t){let n=t.fork(t.ALL),r=e.generator,i=this.value,o=e.size-i.length,s,a,l;if(o>0){for(s=[];--o>=0;)s.push(l=Cn(r(e))),i.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});Tj={value:"value",median:kM,mean:oj,min:xS,max:Tf},mBt=[];xae.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};$e(xae,ce,{transform(e,t){var n=t.fork(t.ALL),r=hBt(e),i=gBt(e),o=si(e.field),s=si(e.key),a=(e.groupby||[]).map(si),l=xBt(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,f=l.domain.length,d,p,m,h,g,x,b,y,v,C;for(g=0,y=l.length;g<y;++g)for(d=l[g],m=d.values,p=NaN,b=0;b<f;++b)if(d[b]==null){for(h=l.domain[b],C={_impute:!0},x=0,v=m.length;x<v;++x)C[a[x]]=m[x];C[s]=h,C[o]=Number.isNaN(p)?p=r(d,i):p,u.push(Cn(C))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});bae.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:GM},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};$e(bae,Wv,{transform(e,t){let n=this,r=e.modified(),i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{Jt(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){let e=this._adds,t=this._mods,n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});yae.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};$e(yae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=t.materialize(t.SOURCE).source,i=uae(r,e.groupby,e.field),o=(e.groupby||[]).map(si),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[],c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&Se("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=Hd(r,e.field)),f=d=e.steps||d),i.forEach(p=>{let m=fj(p,s)[a],h=e.counts?p.length:1,g=c||Hd(p);Tk(m,g,f,d).forEach(x=>{let b={};for(let y=0;y<o.length;++y)b[o[y]]=p.dims[y];b[l[0]]=x[0],b[l[1]]=x[1]*h,u.push(Cn(b))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});$e(kBe,yr);$e(IBe,ce,{transform(e,t){let n=t.dataflow;return this._pending?tae(this,t,this._pending):yBt(e)?t.StopPropagation:e.values?tae(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=Rt(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>tae(this,t,Rt(r.data)))}});vae.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};$e(vae,ce,{transform(e,t){let n=e.fields,r=e.index,i=e.values,o=e.default==null?null:e.default,s=e.modified(),a=n.length,l=s?t.SOURCE:t.ADD,u=t,c=e.as,f,d,p;return i?(d=i.length,a>1&&!c&&Se('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&Se('The "as" parameter has too few output field names.'),c=c||i.map(si),f=function(m){for(var h=0,g=0,x,b;h<a;++h)if(b=r.get(n[h](m)),b==null)for(x=0;x<d;++x,++g)m[c[g]]=o;else for(x=0;x<d;++x,++g)m[c[g]]=i[x](b)}):(c||Se("Missing output field names."),f=function(m){for(var h=0,g;h<a;++h)g=r.get(n[h](m)),m[c[h]]=g??o}),s?u=t.reflow(!0):(p=n.some(m=>t.modified(m.fields)),l|=p?t.MOD:0),t.visit(l,f),u.modifies(c)}});$e(DBe,yr);$e(NBe,yr);$e(FBe,ce,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});wae.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:GM,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};$e(wae,Wv,{_transform:Wv.prototype.transform,transform(e,t){return this._transform(CBt(e,t),t)}});$e(RBe,kj,{transform(e,t){let n=e.subflow,r=e.field,i=o=>this.subflow(bt(o),n,t,o);return(e.modified("field")||r&&t.modified(Xo(r)))&&Se("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{let s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{let s=i(o);r(o).forEach(a=>s.add(Cn(a)))}),t.visit(t.REM,o=>{let s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});Cae.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};$e(Cae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.fields,i=_Be(e.fields,e.as||[]),o=r?(a,l)=>EBt(a,l,r,i):hS,s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{let l=bt(a);n.rem.push(s[l]),s[l]=null}),t.visit(t.ADD,a=>{let l=o(a,Cn({}));s[bt(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[bt(a)]))}),n}});$e(OBe,ce,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});_ae.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};ABt=1e-14;$e(_ae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;let i=t.materialize(t.SOURCE).source,o=uae(i,e.groupby,e.field),s=(e.groupby||[]).map(si),a=[],l=e.step||.01,u=e.probs||Eo(l/2,1-ABt,l),c=u.length;return o.forEach(f=>{let d=sj(f,u);for(let p=0;p<c;++p){let m={};for(let h=0;h<s.length;++h)m[s[h]]=f.dims[h];m[r[0]]=u[p],m[r[1]]=d[p],a.push(Cn(m))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});$e(MBe,ce,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{let o=bt(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{let o=ZU(i);r[bt(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{let o=r[bt(i)];for(let s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}});Sae.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};$e(Sae,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[bt(f)]=1,c),{}),s=this.value,a=this.count,l=0;function u(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*bc()),d<s.length&&d>=l&&(f=s[d],o[bt(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{let f=bt(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>o[bt(c)]!==-1)),(t.rem.length||r)&&s.length<i&&t.source&&(l=a=s.length,t.visit(t.SOURCE,c=>{o[bt(c)]||u(c)}),l=-1),r&&s.length>i){let c=s.length-i;for(let f=0;f<c;++f)o[bt(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[bt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=s.filter(c=>!o[bt(c)])),this.count=a,this.value=n.source=s,n}});Eae.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};$e(Eae,ce,{transform(e,t){if(this.value&&!e.modified())return;let n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Eo(e.start,e.stop,e.step||1).map(i=>{let o={};return o[r]=i,Cn(o)}),n.add=t.add.concat(this.value),n}});$e($Be,ce,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});PBe=["unit0","unit1"];Aae.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Sj,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:PBe}]};$e(Aae,ce,{transform(e,t){let n=e.field,r=e.interval!==!1,i=e.timezone==="utc",o=this._floor(e,t),s=(i?Qx:Zx)(o.unit).offset,a=e.as||PBe,l=a[0],u=a[1],c=o.step,f=o.start||1/0,d=o.stop||-1/0,p=t.ADD;return(e.modified()||t.modified(Xo(n)))&&(t=t.reflow(!0),p=t.SOURCE,f=1/0,d=-1/0),t.visit(p,m=>{let h=n(m),g,x;h==null?(m[l]=null,r&&(m[u]=null)):(m[l]=g=x=o(h),r&&(m[u]=x=s(g,c)),g<f&&(f=g),x>d&&(d=x))}),o.start=f,o.stop=d,t.modifies(r?a:l)},_floor(e,t){let n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:Jse({extent:e.extent||Hd(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Ej(r),s=this.value||{},a=(n?Yse:Hse)(o,i);return a.unit=Fn(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}});$e(LBe,ce,{transform(e,t){let n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a),s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});$e(BBe,ce,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Xh(e.sort)):t.source).map(e.field))}});WM={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){let e=WM.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{let n=t.data,r=t.compare,i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Se("ntile num must be greater than zero.");let n=WM.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{let r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{let r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Se("nth_value nth must be greater than zero."),{next:n=>{let r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{let r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{let i=r.data;return r.index<=n?t:(n=kBt(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};IBt=Object.keys(WM);UBe=zBe.prototype;UBe.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};UBe.update=function(e,t){let n=this.cell,r=this.windows,i=e.data,o=r&&r.length,s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)};Tae.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:IBt.concat(GM)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};$e(Tae,ce,{transform(e,t){this.stamp=t.stamp;let n=e.modified(),r=Xh(e.sort),i=nae(e.groupby),o=a=>this.group(i(a)),s=this.state;(!s||n)&&(s=this.state=new zBe(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)NBt(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=yBe(bt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}})});function Rk(e,t,n){return e.fields=t||[],e.fname=n,e}function OBt(e){return e.length===1?MBt(e[0]):$Bt(e)}function Ca(e){throw Error(e)}function PBt(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||Ca("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&Ca("Access path missing closing bracket: "+e),r&&Ca("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function Iae(e,t,n){let r=PBt(e);return e=r.length===1?r[0]:e,Rk((n&&n.get||OBt)(r),[e],t||e)}function Jx(e){return e===Object(e)}function lu(e){return e[e.length-1]}function Nae(e){return e==null||e===""?null:+e}function Ok(e){return e!=null?_l(e)?e:[e]:[]}function Gv(e){return typeof e=="function"}function eb(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Nf(e,t){return zBt.call(e,t)}function tb(e,t,n){let r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),eb(r,n)}function WBe(e){return e&&Gv(e[Symbol.iterator])}function Mk(e){return typeof e=="string"}function GBe(e){e=+e||UBt;let t,n,r,i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>Nf(t,s)||Nf(n,s),get:s=>Nf(t,s)?t[s]:Nf(n,s)?o(s,n[s]):void 0,set:(s,a)=>Nf(t,s)?t[s]=a:o(s,a)}}function Ij(e){return _l(e)?"["+e.map(Ij)+"]":Jx(e)||Mk(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function qM(e){let t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}var MBt,$Bt,DSr,VBe,LBt,BBt,Dae,NSr,_l,zBt,UBt,kS=w(()=>{"use strict";MBt=e=>function(t){return t[e]},$Bt=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};DSr=Iae("id"),VBe=Rk(e=>e,[],"identity"),LBt=Rk(()=>0,[],"zero"),BBt=Rk(()=>1,[],"one"),Dae=Rk(()=>!0,[],"true"),NSr=Rk(()=>!1,[],"false"),_l=Array.isArray;zBt=Object.prototype.hasOwnProperty;UBt=1e4});function Rn(e){return function(){return e}}var HM=w(()=>{"use strict"});function HBe(e){return e>1?0:e<-1?Hv:Math.acos(e)}function Rae(e){return e>=1?YM:e<=-1?-YM:Math.asin(e)}var Fae,Ks,qv,qBe,Dj,tp,nb,xs,Hv,YM,Nj,Fj=w(()=>{"use strict";Fae=Math.abs,Ks=Math.atan2,qv=Math.cos,qBe=Math.max,Dj=Math.min,tp=Math.sin,nb=Math.sqrt,xs=1e-12,Hv=Math.PI,YM=Hv/2,Nj=2*Hv});function YBe(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function VBt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return YBe;let n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}function KM(){return new DS}var Oae,Mae,IS,jBt,DS,KBe=w(()=>{"use strict";Oae=Math.PI,Mae=2*Oae,IS=1e-6,jBt=Mae-IS;DS=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?YBe:VBt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+s}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,l=r-t,u=i-n,c=s-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>IS)if(!(Math.abs(f*l-u*c)>IS)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-s,m=i-a,h=l*l+u*u,g=p*p+m*m,x=Math.sqrt(h),b=Math.sqrt(d),y=o*Math.tan((Oae-Math.acos((h+d-g)/(2*x*b)))/2),v=y/b,C=y/x;Math.abs(v-1)>IS&&this._append`L${t+v*c},${n+v*f}`,this._append`A${o},${o},0,0,${+(f*p>c*m)},${this._x1=t+C*l},${this._y1=n+C*u}`}}arc(t,n,r,i,o,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),l=r*Math.sin(i),u=t+a,c=n+l,f=1^s,d=s?i-o:o-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>IS||Math.abs(this._y1-c)>IS)&&this._append`L${u},${c}`,r&&(d<0&&(d=d%Mae+Mae),d>jBt?this._append`A${r},${r},0,1,${f},${t-a},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:d>IS&&this._append`A${r},${r},0,${+(d>=Oae)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};KM.prototype=DS.prototype});var $ae=w(()=>{"use strict";KBe()});function Yv(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{let r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new DS(t)}var XM=w(()=>{"use strict";$ae()});function WBt(e){return e.innerRadius}function GBt(e){return e.outerRadius}function qBt(e){return e.startAngle}function HBt(e){return e.endAngle}function YBt(e){return e&&e.padAngle}function KBt(e,t,n,r,i,o,s,a){var l=n-e,u=r-t,c=s-i,f=a-o,d=f*l-c*u;if(!(d*d<xs))return d=(c*(t-o)-f*(e-i))/d,[e+d*l,t+d*u]}function Rj(e,t,n,r,i,o,s){var a=e-n,l=t-r,u=(s?o:-o)/nb(a*a+l*l),c=u*l,f=-u*a,d=e+c,p=t+f,m=n+c,h=r+f,g=(d+m)/2,x=(p+h)/2,b=m-d,y=h-p,v=b*b+y*y,C=i-o,_=d*h-m*p,S=(y<0?-1:1)*nb(qBe(0,C*C*v-_*_)),E=(_*y-b*S)/v,T=(-_*b-y*S)/v,I=(_*y+b*S)/v,k=(-_*b+y*S)/v,O=E-g,F=T-x,B=I-g,M=k-x;return O*O+F*F>B*B+M*M&&(E=I,T=k),{cx:E,cy:T,x01:-c,y01:-f,x11:E*(i/C-1),y11:T*(i/C-1)}}function Pae(){var e=WBt,t=GBt,n=Rn(0),r=null,i=qBt,o=HBt,s=YBt,a=null,l=Yv(u);function u(){var c,f,d=+e.apply(this,arguments),p=+t.apply(this,arguments),m=i.apply(this,arguments)-YM,h=o.apply(this,arguments)-YM,g=Fae(h-m),x=h>m;if(a||(a=c=l()),p<d&&(f=p,p=d,d=f),!(p>xs))a.moveTo(0,0);else if(g>Nj-xs)a.moveTo(p*qv(m),p*tp(m)),a.arc(0,0,p,m,h,!x),d>xs&&(a.moveTo(d*qv(h),d*tp(h)),a.arc(0,0,d,h,m,x));else{var b=m,y=h,v=m,C=h,_=g,S=g,E=s.apply(this,arguments)/2,T=E>xs&&(r?+r.apply(this,arguments):nb(d*d+p*p)),I=Dj(Fae(p-d)/2,+n.apply(this,arguments)),k=I,O=I,F,B;if(T>xs){var M=Rae(T/d*tp(E)),z=Rae(T/p*tp(E));(_-=M*2)>xs?(M*=x?1:-1,v+=M,C-=M):(_=0,v=C=(m+h)/2),(S-=z*2)>xs?(z*=x?1:-1,b+=z,y-=z):(S=0,b=y=(m+h)/2)}var W=p*qv(b),H=p*tp(b),Q=d*qv(C),re=d*tp(C);if(I>xs){var oe=p*qv(y),me=p*tp(y),ge=d*qv(v),ye=d*tp(v),ve;if(g<Hv)if(ve=KBt(W,H,ge,ye,oe,me,Q,re)){var Ne=W-ve[0],Ge=H-ve[1],nt=oe-ve[0],Y=me-ve[1],ie=1/tp(HBe((Ne*nt+Ge*Y)/(nb(Ne*Ne+Ge*Ge)*nb(nt*nt+Y*Y)))/2),ue=nb(ve[0]*ve[0]+ve[1]*ve[1]);k=Dj(I,(d-ue)/(ie-1)),O=Dj(I,(p-ue)/(ie+1))}else k=O=0}S>xs?O>xs?(F=Rj(ge,ye,W,H,p,O,x),B=Rj(oe,me,Q,re,p,O,x),a.moveTo(F.cx+F.x01,F.cy+F.y01),O<I?a.arc(F.cx,F.cy,O,Ks(F.y01,F.x01),Ks(B.y01,B.x01),!x):(a.arc(F.cx,F.cy,O,Ks(F.y01,F.x01),Ks(F.y11,F.x11),!x),a.arc(0,0,p,Ks(F.cy+F.y11,F.cx+F.x11),Ks(B.cy+B.y11,B.cx+B.x11),!x),a.arc(B.cx,B.cy,O,Ks(B.y11,B.x11),Ks(B.y01,B.x01),!x))):(a.moveTo(W,H),a.arc(0,0,p,b,y,!x)):a.moveTo(W,H),!(d>xs)||!(_>xs)?a.lineTo(Q,re):k>xs?(F=Rj(Q,re,oe,me,d,-k,x),B=Rj(W,H,ge,ye,d,-k,x),a.lineTo(F.cx+F.x01,F.cy+F.y01),k<I?a.arc(F.cx,F.cy,k,Ks(F.y01,F.x01),Ks(B.y01,B.x01),!x):(a.arc(F.cx,F.cy,k,Ks(F.y01,F.x01),Ks(F.y11,F.x11),!x),a.arc(0,0,d,Ks(F.cy+F.y11,F.cx+F.x11),Ks(B.cy+B.y11,B.cx+B.x11),x),a.arc(B.cx,B.cy,k,Ks(B.y11,B.x11),Ks(B.y01,B.x01),!x))):a.arc(0,0,d,C,v,x)}if(a.closePath(),c)return a=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Hv/2;return[qv(f)*c,tp(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Rn(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Rn(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Rn(+c),u):i},u.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Rn(+c),u):o},u.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Rn(+c),u):s},u.context=function(c){return arguments.length?(a=c??null,u):a},u}var XBe=w(()=>{"use strict";HM();Fj();XM()});function Oj(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}var GSr,Lae=w(()=>{"use strict";GSr=Array.prototype.slice});function ZBe(e){this._context=e}function NS(e){return new ZBe(e)}var Mj=w(()=>{"use strict";ZBe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}}});function $j(e){return e[0]}function Pj(e){return e[1]}var Bae=w(()=>{"use strict"});function ZM(e,t){var n=Rn(!0),r=null,i=NS,o=null,s=Yv(a);e=typeof e=="function"?e:e===void 0?$j:Rn(e),t=typeof t=="function"?t:t===void 0?Pj:Rn(t);function a(l){var u,c=(l=Oj(l)).length,f,d=!1,p;for(r==null&&(o=i(p=s())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(f,u,l),+t(f,u,l));if(p)return o=null,p+""||null}return a.x=function(l){return arguments.length?(e=typeof l=="function"?l:Rn(+l),a):e},a.y=function(l){return arguments.length?(t=typeof l=="function"?l:Rn(+l),a):t},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Rn(!!l),a):n},a.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),a):i},a.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),a):r},a}var zae=w(()=>{"use strict";Lae();HM();Mj();XM();Bae()});function Lj(e,t,n){var r=null,i=Rn(!0),o=null,s=NS,a=null,l=Yv(u);e=typeof e=="function"?e:e===void 0?$j:Rn(+e),t=typeof t=="function"?t:t===void 0?Rn(0):Rn(+t),n=typeof n=="function"?n:n===void 0?Pj:Rn(+n);function u(f){var d,p,m,h=(f=Oj(f)).length,g,x=!1,b,y=new Array(h),v=new Array(h);for(o==null&&(a=s(b=l())),d=0;d<=h;++d){if(!(d<h&&i(g=f[d],d,f))===x)if(x=!x)p=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),m=d-1;m>=p;--m)a.point(y[m],v[m]);a.lineEnd(),a.areaEnd()}x&&(y[d]=+e(g,d,f),v[d]=+t(g,d,f),a.point(r?+r(g,d,f):y[d],n?+n(g,d,f):v[d]))}if(b)return a=null,b+""||null}function c(){return ZM().defined(i).curve(s).context(o)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Rn(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Rn(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Rn(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Rn(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Rn(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Rn(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Rn(!!f),u):i},u.curve=function(f){return arguments.length?(s=f,o!=null&&(a=s(o)),u):s},u.context=function(f){return arguments.length?(f==null?o=a=null:a=s(o=f),u):o},u}var QBe=w(()=>{"use strict";Lae();HM();Mj();zae();XM();Bae()});var JBe,eze=w(()=>{"use strict";Fj();JBe={draw(e,t){let n=nb(t/Hv);e.moveTo(n,0),e.arc(0,0,n,0,Nj)}}});function Bj(e,t){let n=null,r=Yv(i);e=typeof e=="function"?e:Rn(e||JBe),t=typeof t=="function"?t:Rn(t===void 0?64:+t);function i(){let o;if(n||(n=o=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Rn(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Rn(+o),i):t},i.context=function(o){return arguments.length?(n=o??null,i):n},i}var tze=w(()=>{"use strict";HM();XM();eze()});function Ff(){}var QM=w(()=>{"use strict"});function $k(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function JM(e){this._context=e}function Uae(e){return new JM(e)}var e3=w(()=>{"use strict";JM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$k(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$k(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function nze(e){this._context=e}function jae(e){return new nze(e)}var rze=w(()=>{"use strict";QM();e3();nze.prototype={areaStart:Ff,areaEnd:Ff,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$k(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function ize(e){this._context=e}function Vae(e){return new ize(e)}var oze=w(()=>{"use strict";e3();ize.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:$k(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function sze(e,t){this._basis=new JM(e),this._beta=t}var Wae,aze=w(()=>{"use strict";e3();sze.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,l;++a<=n;)l=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+l*o),this._beta*t[a]+(1-this._beta)*(i+l*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};Wae=function e(t){function n(r){return t===1?new JM(r):new sze(r,t)}return n.beta=function(r){return e(+r)},n}(.85)});function Pk(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function zj(e,t){this._context=e,this._k=(1-t)/6}var Gae,t3=w(()=>{"use strict";zj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Pk(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Pk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Gae=function e(t){function n(r){return new zj(r,t)}return n.tension=function(r){return e(+r)},n}(0)});function Uj(e,t){this._context=e,this._k=(1-t)/6}var qae,Hae=w(()=>{"use strict";QM();t3();Uj.prototype={areaStart:Ff,areaEnd:Ff,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Pk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};qae=function e(t){function n(r){return new Uj(r,t)}return n.tension=function(r){return e(+r)},n}(0)});function jj(e,t){this._context=e,this._k=(1-t)/6}var Yae,Kae=w(()=>{"use strict";t3();jj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Pk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Yae=function e(t){function n(r){return new jj(r,t)}return n.tension=function(r){return e(+r)},n}(0)});function n3(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>xs){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>xs){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function lze(e,t){this._context=e,this._alpha=t}var Xae,Vj=w(()=>{"use strict";Fj();t3();lze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:n3(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Xae=function e(t){function n(r){return t?new lze(r,t):new zj(r,0)}return n.alpha=function(r){return e(+r)},n}(.5)});function uze(e,t){this._context=e,this._alpha=t}var Zae,cze=w(()=>{"use strict";Hae();QM();Vj();uze.prototype={areaStart:Ff,areaEnd:Ff,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:n3(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Zae=function e(t){function n(r){return t?new uze(r,t):new Uj(r,0)}return n.alpha=function(r){return e(+r)},n}(.5)});function fze(e,t){this._context=e,this._alpha=t}var Qae,dze=w(()=>{"use strict";Kae();Vj();fze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:n3(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Qae=function e(t){function n(r){return t?new fze(r,t):new jj(r,0)}return n.alpha=function(r){return e(+r)},n}(.5)});function pze(e){this._context=e}function Jae(e){return new pze(e)}var mze=w(()=>{"use strict";QM();pze.prototype={areaStart:Ff,areaEnd:Ff,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}}});function hze(e){return e<0?-1:1}function gze(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(hze(o)+hze(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function xze(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function ele(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function Wj(e){this._context=e}function bze(e){this._context=new yze(e)}function yze(e){this._context=e}function tle(e){return new Wj(e)}function nle(e){return new bze(e)}var vze=w(()=>{"use strict";Wj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ele(this,this._t0,xze(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ele(this,xze(this,n=gze(this,e,t)),n);break;default:ele(this,this._t0,n=gze(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};(bze.prototype=Object.create(Wj.prototype)).point=function(e,t){Wj.prototype.point.call(this,t,e)};yze.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}}});function Cze(e){this._context=e}function wze(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function rle(e){return new Cze(e)}var _ze=w(()=>{"use strict";Cze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=wze(e),i=wze(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}}});function Gj(e,t){this._context=e,this._t=t}function ile(e){return new Gj(e,.5)}function ole(e){return new Gj(e,0)}function sle(e){return new Gj(e,1)}var Sze=w(()=>{"use strict";Gj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}}});var Eze=w(()=>{"use strict";XBe();QBe();zae();tze();rze();oze();e3();aze();Hae();Kae();t3();cze();dze();Vj();mze();Mj();vze();_ze();Sze()});function uu(e,t){if(typeof document<"u"&&document.createElement){let n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}var qj,Lk=w(()=>{"use strict";qj=()=>typeof Image<"u"?Image:null});function kze(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function ZBt(e,t){var n=kze(e);return function(r,i){return t(n(r),i,e)}}function Tze(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function cu(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function QBt(e){return e<0?"-"+cu(-e,6):e>9999?"+"+cu(e,6):cu(e,4)}function JBt(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":QBt(e.getUTCFullYear(),4)+"-"+cu(e.getUTCMonth()+1,2)+"-"+cu(e.getUTCDate(),2)+(i?"T"+cu(t,2)+":"+cu(n,2)+":"+cu(r,2)+"."+cu(i,3)+"Z":r?"T"+cu(t,2)+":"+cu(n,2)+":"+cu(r,2)+"Z":n||t?"T"+cu(t,2)+":"+cu(n,2)+"Z":"")}function cle(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var p,m,h=i(f,function(g,x){if(p)return p(g,x-1);m=g,p=d?ZBt(g,d):kze(g)});return h.columns=m||[],h}function i(f,d){var p=[],m=f.length,h=0,g=0,x,b=m<=0,y=!1;f.charCodeAt(m-1)===r3&&--m,f.charCodeAt(m-1)===ule&&--m;function v(){if(b)return ale;if(y)return y=!1,Aze;var _,S=h,E;if(f.charCodeAt(S)===lle){for(;h++<m&&f.charCodeAt(h)!==lle||f.charCodeAt(++h)===lle;);return(_=h)>=m?b=!0:(E=f.charCodeAt(h++))===r3?y=!0:E===ule&&(y=!0,f.charCodeAt(h)===r3&&++h),f.slice(S+1,_-1).replace(/""/g,'"')}for(;h<m;){if((E=f.charCodeAt(_=h++))===r3)y=!0;else if(E===ule)y=!0,f.charCodeAt(h)===r3&&++h;else if(E!==n)continue;return f.slice(S,_)}return b=!0,f.slice(S,m)}for(;(x=v())!==ale;){for(var C=[];x!==Aze&&x!==ale;)C.push(x),x=v();d&&(C=d(C,g++))==null||p.push(C)}return p}function o(f,d){return f.map(function(p){return d.map(function(m){return c(p[m])}).join(e)})}function s(f,d){return d==null&&(d=Tze(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=Tze(f)),o(f,d).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?JBt(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}var Aze,ale,lle,r3,ule,Ize=w(()=>{"use strict";Aze={},ale={},lle=34,r3=10,ule=13});var Dze=w(()=>{"use strict";Ize()});function eg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}var Hj=w(()=>{"use strict"});function fle(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}var Nze=w(()=>{"use strict"});function FS(e){let t,n,r;e.length!==2?(t=eg,n=(a,l)=>eg(e(a),l),r=(a,l)=>e(a)-l):(t=e===eg||e===fle?e:ezt,n=e,r=e);function i(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{let f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}function o(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{let f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function s(a,l,u=0,c=a.length){let f=i(a,l,u,c-1);return f>u&&r(a[f-1],l)>-r(a[f],l)?f-1:f}return{left:i,center:s,right:o}}function ezt(){return 0}var dle=w(()=>{"use strict";Hj();Nze()});function i3(e){return e===null?NaN:+e}var ple=w(()=>{"use strict"});var Fze,o3,tzt,nzt,np,Rze=w(()=>{"use strict";Hj();dle();ple();Fze=FS(eg),o3=Fze.right,tzt=Fze.left,nzt=FS(i3).center,np=o3});function Yj(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=rzt?10:o>=izt?5:o>=ozt?2:1,a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?Yj(e,t,n*2):[a,l,u]}function RS(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];let r=t<e,[i,o,s]=r?Yj(t,e,n):Yj(e,t,n);if(!(o>=i))return[];let a=o-i+1,l=new Array(a);if(r)if(s<0)for(let u=0;u<a;++u)l[u]=(o-u)/-s;else for(let u=0;u<a;++u)l[u]=(o-u)*s;else if(s<0)for(let u=0;u<a;++u)l[u]=(i+u)/-s;else for(let u=0;u<a;++u)l[u]=(i+u)*s;return l}function s3(e,t,n){return t=+t,e=+e,n=+n,Yj(e,t,n)[2]}function Kv(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?s3(t,e,n):s3(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}var rzt,izt,ozt,Oze=w(()=>{"use strict";rzt=Math.sqrt(50),izt=Math.sqrt(10),ozt=Math.sqrt(2)});function mle(e,t,n=i3){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}var Mze=w(()=>{"use strict";ple()});function Kj(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}var $ze=w(()=>{"use strict"});var Rf=w(()=>{"use strict";Rze();Hj();dle();Mze();$ze();Oze();oM()});function Pze(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function OS(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var a3=w(()=>{"use strict"});function tg(e){return e=OS(Math.abs(e)),e?e[1]:NaN}var l3=w(()=>{"use strict";a3()});function Lze(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}var Bze=w(()=>{"use strict"});function zze(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Uze=w(()=>{"use strict"});function Sc(e){if(!(t=szt.exec(e)))throw new Error("invalid format: "+e);var t;return new Xj({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Xj(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}var szt,hle=w(()=>{"use strict";szt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Sc.prototype=Xj.prototype;Xj.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function jze(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Vze=w(()=>{"use strict"});function Wze(e,t){var n=OS(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(gle=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+OS(e,Math.max(0,t+o-1))[0]}var gle,xle=w(()=>{"use strict";a3()});function ble(e,t){var n=OS(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Gze=w(()=>{"use strict";a3()});var yle,qze=w(()=>{"use strict";a3();xle();Gze();yle={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Pze,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ble(e*100,t),r:ble,s:Wze,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)}});function vle(e){return e}var Hze=w(()=>{"use strict"});function wle(e){var t=e.grouping===void 0||e.thousands===void 0?vle:Lze(Yze.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?vle:zze(Yze.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=Sc(f);var d=f.fill,p=f.align,m=f.sign,h=f.symbol,g=f.zero,x=f.width,b=f.comma,y=f.precision,v=f.trim,C=f.type;C==="n"?(b=!0,C="g"):yle[C]||(y===void 0&&(y=12),v=!0,C="g"),(g||d==="0"&&p==="=")&&(g=!0,d="0",p="=");var _=h==="$"?n:h==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",S=h==="$"?r:/[%p]/.test(C)?s:"",E=yle[C],T=/[defgprs%]/.test(C);y=y===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function I(k){var O=_,F=S,B,M,z;if(C==="c")F=E(k)+F,k="";else{k=+k;var W=k<0||1/k<0;if(k=isNaN(k)?l:E(Math.abs(k),y),v&&(k=jze(k)),W&&+k==0&&m!=="+"&&(W=!1),O=(W?m==="("?m:a:m==="-"||m==="("?"":m)+O,F=(C==="s"?Kze[8+gle/3]:"")+F+(W&&m==="("?")":""),T){for(B=-1,M=k.length;++B<M;)if(z=k.charCodeAt(B),48>z||z>57){F=(z===46?i+k.slice(B+1):k.slice(B))+F,k=k.slice(0,B);break}}}b&&!g&&(k=t(k,1/0));var H=O.length+k.length+F.length,Q=H<x?new Array(x-H+1).join(d):"";switch(b&&g&&(k=t(Q+k,Q.length?x-F.length:1/0),Q=""),p){case"<":k=O+k+F+Q;break;case"=":k=O+Q+k+F;break;case"^":k=Q.slice(0,H=Q.length>>1)+O+k+F+Q.slice(H);break;default:k=Q+O+k+F;break}return o(k)}return I.toString=function(){return f+""},I}function c(f,d){var p=u((f=Sc(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(tg(d)/3)))*3,h=Math.pow(10,-m),g=Kze[8+m/3];return function(x){return p(h*x)+g}}return{format:u,formatPrefix:c}}var Yze,Kze,Xze=w(()=>{"use strict";l3();Bze();Uze();hle();Vze();qze();xle();Hze();Yze=Array.prototype.map,Kze=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function Cle(e){return Zj=wle(e),Xv=Zj.format,Bk=Zj.formatPrefix,Zj}var Zj,Xv,Bk,Zze=w(()=>{"use strict";Xze();Cle({thousands:",",grouping:[3],currency:["$",""]})});function u3(e){return Math.max(0,-tg(Math.abs(e)))}var Qze=w(()=>{"use strict";l3()});function c3(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(tg(t)/3)))*3-tg(Math.abs(e)))}var Jze=w(()=>{"use strict";l3()});function f3(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,tg(t)-tg(e))+1}var e4e=w(()=>{"use strict";l3()});var Qj=w(()=>{"use strict";Zze();hle();Qze();Jze();e4e()});function Vr(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{let s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{let l=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return l;let u;do l.push(u=new Date(+o)),t(o,a),e(o);while(u<o&&o<s);return l},i.filter=o=>Vr(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(_le.setTime(+o),Sle.setTime(+s),e(_le),e(Sle),Math.floor(n(_le,Sle))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}var _le,Sle,rb=w(()=>{"use strict";_le=new Date,Sle=new Date});var rp,t4e,Ele=w(()=>{"use strict";rb();rp=Vr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);rp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vr(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):rp);t4e=rp.range});var _a,n4e,Ale=w(()=>{"use strict";rb();_a=Vr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),n4e=_a.range});var Zv,azt,Qv,lzt,Tle=w(()=>{"use strict";rb();Zv=Vr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),azt=Zv.range,Qv=Vr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),lzt=Qv.range});var Jv,uzt,e1,czt,kle=w(()=>{"use strict";rb();Jv=Vr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),uzt=Jv.range,e1=Vr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),czt=e1.range});var fu,fzt,Of,dzt,Jj,pzt,Ile=w(()=>{"use strict";rb();fu=Vr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),fzt=fu.range,Of=Vr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),dzt=Of.range,Jj=Vr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),pzt=Jj.range});function PS(e){return Vr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}function LS(e){return Vr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/6048e5)}var Mf,zk,i4e,o4e,t1,s4e,a4e,l4e,mzt,hzt,gzt,xzt,bzt,yzt,$f,Uk,u4e,c4e,n1,f4e,d4e,p4e,vzt,wzt,Czt,_zt,Szt,Ezt,Dle=w(()=>{"use strict";rb();Mf=PS(0),zk=PS(1),i4e=PS(2),o4e=PS(3),t1=PS(4),s4e=PS(5),a4e=PS(6),l4e=Mf.range,mzt=zk.range,hzt=i4e.range,gzt=o4e.range,xzt=t1.range,bzt=s4e.range,yzt=a4e.range;$f=LS(0),Uk=LS(1),u4e=LS(2),c4e=LS(3),n1=LS(4),f4e=LS(5),d4e=LS(6),p4e=$f.range,vzt=Uk.range,wzt=u4e.range,Czt=c4e.range,_zt=n1.range,Szt=f4e.range,Ezt=d4e.range});var ib,Azt,ob,Tzt,Nle=w(()=>{"use strict";rb();ib=Vr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),Azt=ib.range,ob=Vr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),Tzt=ob.range});var Sl,kzt,El,Izt,Fle=w(()=>{"use strict";rb();Sl=Vr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Sl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});kzt=Sl.range,El=Vr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());El.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Izt=El.range});function h4e(e,t,n,r,i,o){let s=[[_a,1,1e3],[_a,5,5*1e3],[_a,15,15*1e3],[_a,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[r,1,864e5],[r,2,2*864e5],[n,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function a(u,c,f){let d=c<u;d&&([u,c]=[c,u]);let p=f&&typeof f.range=="function"?f:l(u,c,f),m=p?p.range(u,+c+1):[];return d?m.reverse():m}function l(u,c,f){let d=Math.abs(c-u)/f,p=FS(([,,g])=>g).right(s,d);if(p===s.length)return e.every(Kv(u/31536e6,c/31536e6,f));if(p===0)return rp.every(Math.max(Kv(u,c,f),1));let[m,h]=s[d/s[p-1][2]<s[p][2]/d?p-1:p];return m.every(h)}return[a,l]}var Rle,Ole,Mle,$le,g4e=w(()=>{"use strict";Rf();Ele();Ale();Tle();kle();Ile();Dle();Nle();Fle();[Rle,Ole]=h4e(El,ob,$f,Jj,e1,Qv),[Mle,$le]=h4e(Sl,ib,Mf,fu,Jv,Zv)});var p3=w(()=>{"use strict";Ele();Ale();Tle();kle();Ile();Dle();Nle();Fle();g4e()});function Ble(e){return BS.setFullYear(e),BS.setMonth(0),BS.setDate(1),BS.setHours(0,0,0,0),BS}function Ozt(e){return fu.count(Ble(e.getFullYear())-1,e)}function x4e(e){return Mf.count(Ble(e.getFullYear())-1,e)}function Ple(e){return Ble(e).getDay()}function Mzt(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return Of.count(t-1,e)}function b4e(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return $f.count(t-1,e)}function Lle(e){return BS.setTime(Date.UTC(e,0,1)),BS.getUTCDay()}function jk(e,t,n){return t+e*7-(n+6)%7}function zle(e){return $zt[e]}function Ule(e){return Pzt[e]}var Al,ap,Ec,du,ip,rg,Vk,op,sp,ig,sb,Rzt,cTr,fTr,BS,dTr,pTr,mTr,hTr,$zt,Pzt,m3,h3,g3,e7,Lzt,y4e,Bzt,zzt,x3,b3,y3,Uzt,jzt,v4e,Vzt,gTr,jle=w(()=>{"use strict";kS();p3();Al="year",ap="quarter",Ec="month",du="week",ip="date",rg="day",Vk="dayofyear",op="hours",sp="minutes",ig="seconds",sb="milliseconds",Rzt=[Al,ap,Ec,du,ip,rg,Vk,op,sp,ig,sb],cTr=Rzt.reduce((e,t,n)=>(e[t]=1+n,e),{}),fTr={[Al]:"%Y ",[ap]:"Q%q ",[Ec]:"%b ",[ip]:"%d ",[du]:"W%U ",[rg]:"%a ",[Vk]:"%j ",[op]:"%H:00",[sp]:"00:%M",[ig]:":%S",[sb]:".%L",[`${Al}-${Ec}`]:"%Y-%m ",[`${Al}-${Ec}-${ip}`]:"%Y-%m-%d ",[`${op}-${sp}`]:"%H:%M"},BS=new Date;dTr={[Al]:e=>e.getFullYear(),[ap]:e=>Math.floor(e.getMonth()/3),[Ec]:e=>e.getMonth(),[ip]:e=>e.getDate(),[op]:e=>e.getHours(),[sp]:e=>e.getMinutes(),[ig]:e=>e.getSeconds(),[sb]:e=>e.getMilliseconds(),[Vk]:e=>Ozt(e),[du]:e=>x4e(e),[du+rg]:(e,t)=>jk(x4e(e),e.getDay(),Ple(t)),[rg]:(e,t)=>jk(1,e.getDay(),Ple(t))},pTr={[ap]:e=>3*e,[du]:(e,t)=>jk(e,0,Ple(t))},mTr={[Al]:e=>e.getUTCFullYear(),[ap]:e=>Math.floor(e.getUTCMonth()/3),[Ec]:e=>e.getUTCMonth(),[ip]:e=>e.getUTCDate(),[op]:e=>e.getUTCHours(),[sp]:e=>e.getUTCMinutes(),[ig]:e=>e.getUTCSeconds(),[sb]:e=>e.getUTCMilliseconds(),[Vk]:e=>Mzt(e),[du]:e=>b4e(e),[rg]:(e,t)=>jk(1,e.getUTCDay(),Lle(t)),[du+rg]:(e,t)=>jk(b4e(e),e.getUTCDay(),Lle(t))},hTr={[ap]:e=>3*e,[du]:(e,t)=>jk(e,0,Lle(t))},$zt={[Al]:Sl,[ap]:ib.every(3),[Ec]:ib,[du]:Mf,[ip]:fu,[rg]:fu,[Vk]:fu,[op]:Jv,[sp]:Zv,[ig]:_a,[sb]:rp},Pzt={[Al]:El,[ap]:ob.every(3),[Ec]:ob,[du]:$f,[ip]:Of,[rg]:Of,[Vk]:Of,[op]:e1,[sp]:Qv,[ig]:_a,[sb]:rp};m3=1e3,h3=m3*60,g3=h3*60,e7=g3*24,Lzt=e7*7,y4e=e7*30,Bzt=e7*365,zzt=[Al,Ec,ip,op,sp,ig,sb],x3=zzt.slice(0,-1),b3=x3.slice(0,-1),y3=b3.slice(0,-1),Uzt=y3.slice(0,-1),jzt=[Al,du],v4e=[Al,Ec],Vzt=[Al],gTr=[[x3,1,m3],[x3,5,5*m3],[x3,15,15*m3],[x3,30,30*m3],[b3,1,h3],[b3,5,5*h3],[b3,15,15*h3],[b3,30,30*h3],[y3,1,g3],[y3,3,3*g3],[y3,6,6*g3],[y3,12,12*g3],[Uzt,1,e7],[jzt,1,Lzt],[v4e,1,y4e],[v4e,3,3*y4e],[Vzt,1,Bzt]]});function Vle(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Wle(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function v3(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function t7(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,u=w3(i),c=C3(i),f=w3(o),d=C3(o),p=w3(s),m=C3(s),h=w3(a),g=C3(a),x=w3(l),b=C3(l),y={a:W,A:H,b:Q,B:re,c:null,d:A4e,e:A4e,f:d4t,g:C4t,G:S4t,H:u4t,I:c4t,j:f4t,L:N4e,m:p4t,M:m4t,p:oe,q:me,Q:I4e,s:D4e,S:h4t,u:g4t,U:x4t,V:b4t,w:y4t,W:v4t,x:null,X:null,y:w4t,Y:_4t,Z:E4t,"%":k4e},v={a:ge,A:ye,b:ve,B:Ne,c:null,d:T4e,e:T4e,f:I4t,g:B4t,G:U4t,H:A4t,I:T4t,j:k4t,L:R4e,m:D4t,M:N4t,p:Ge,q:nt,Q:I4e,s:D4e,S:F4t,u:R4t,U:O4t,V:M4t,w:$4t,W:P4t,x:null,X:null,y:L4t,Y:z4t,Z:j4t,"%":k4e},C={a:I,A:k,b:O,B:F,c:B,d:S4e,e:S4e,f:o4t,g:_4e,G:C4e,H:E4e,I:E4e,j:t4t,L:i4t,m:e4t,M:n4t,p:T,q:Jzt,Q:a4t,s:l4t,S:r4t,u:Yzt,U:Kzt,V:Xzt,w:Hzt,W:Zzt,x:M,X:z,y:_4e,Y:C4e,Z:Qzt,"%":s4t};y.x=_(n,y),y.X=_(r,y),y.c=_(t,y),v.x=_(n,v),v.X=_(r,v),v.c=_(t,v);function _(Y,ie){return function(ue){var U=[],Ue=-1,ke=0,Xe=Y.length,Ye,Pt,yn;for(ue instanceof Date||(ue=new Date(+ue));++Ue<Xe;)Y.charCodeAt(Ue)===37&&(U.push(Y.slice(ke,Ue)),(Pt=w4e[Ye=Y.charAt(++Ue)])!=null?Ye=Y.charAt(++Ue):Pt=Ye==="e"?" ":"0",(yn=ie[Ye])&&(Ye=yn(ue,Pt)),U.push(Ye),ke=Ue+1);return U.push(Y.slice(ke,Ue)),U.join("")}}function S(Y,ie){return function(ue){var U=v3(1900,void 0,1),Ue=E(U,Y,ue+="",0),ke,Xe;if(Ue!=ue.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(ie&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(ke=Wle(v3(U.y,0,1)),Xe=ke.getUTCDay(),ke=Xe>4||Xe===0?Uk.ceil(ke):Uk(ke),ke=Of.offset(ke,(U.V-1)*7),U.y=ke.getUTCFullYear(),U.m=ke.getUTCMonth(),U.d=ke.getUTCDate()+(U.w+6)%7):(ke=Vle(v3(U.y,0,1)),Xe=ke.getDay(),ke=Xe>4||Xe===0?zk.ceil(ke):zk(ke),ke=fu.offset(ke,(U.V-1)*7),U.y=ke.getFullYear(),U.m=ke.getMonth(),U.d=ke.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),Xe="Z"in U?Wle(v3(U.y,0,1)).getUTCDay():Vle(v3(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(Xe+5)%7:U.w+U.U*7-(Xe+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,Wle(U)):Vle(U)}}function E(Y,ie,ue,U){for(var Ue=0,ke=ie.length,Xe=ue.length,Ye,Pt;Ue<ke;){if(U>=Xe)return-1;if(Ye=ie.charCodeAt(Ue++),Ye===37){if(Ye=ie.charAt(Ue++),Pt=C[Ye in w4e?ie.charAt(Ue++):Ye],!Pt||(U=Pt(Y,ue,U))<0)return-1}else if(Ye!=ue.charCodeAt(U++))return-1}return U}function T(Y,ie,ue){var U=u.exec(ie.slice(ue));return U?(Y.p=c.get(U[0].toLowerCase()),ue+U[0].length):-1}function I(Y,ie,ue){var U=p.exec(ie.slice(ue));return U?(Y.w=m.get(U[0].toLowerCase()),ue+U[0].length):-1}function k(Y,ie,ue){var U=f.exec(ie.slice(ue));return U?(Y.w=d.get(U[0].toLowerCase()),ue+U[0].length):-1}function O(Y,ie,ue){var U=x.exec(ie.slice(ue));return U?(Y.m=b.get(U[0].toLowerCase()),ue+U[0].length):-1}function F(Y,ie,ue){var U=h.exec(ie.slice(ue));return U?(Y.m=g.get(U[0].toLowerCase()),ue+U[0].length):-1}function B(Y,ie,ue){return E(Y,t,ie,ue)}function M(Y,ie,ue){return E(Y,n,ie,ue)}function z(Y,ie,ue){return E(Y,r,ie,ue)}function W(Y){return s[Y.getDay()]}function H(Y){return o[Y.getDay()]}function Q(Y){return l[Y.getMonth()]}function re(Y){return a[Y.getMonth()]}function oe(Y){return i[+(Y.getHours()>=12)]}function me(Y){return 1+~~(Y.getMonth()/3)}function ge(Y){return s[Y.getUTCDay()]}function ye(Y){return o[Y.getUTCDay()]}function ve(Y){return l[Y.getUTCMonth()]}function Ne(Y){return a[Y.getUTCMonth()]}function Ge(Y){return i[+(Y.getUTCHours()>=12)]}function nt(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ie=_(Y+="",y);return ie.toString=function(){return Y},ie},parse:function(Y){var ie=S(Y+="",!1);return ie.toString=function(){return Y},ie},utcFormat:function(Y){var ie=_(Y+="",v);return ie.toString=function(){return Y},ie},utcParse:function(Y){var ie=S(Y+="",!0);return ie.toString=function(){return Y},ie}}}function Xn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function qzt(e){return e.replace(Gzt,"\\$&")}function w3(e){return new RegExp("^(?:"+e.map(qzt).join("|")+")","i")}function C3(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Hzt(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Yzt(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Kzt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Xzt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Zzt(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function C4e(e,t,n){var r=bs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function _4e(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Qzt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Jzt(e,t,n){var r=bs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function e4t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function S4e(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function t4t(e,t,n){var r=bs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function E4e(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function n4t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function r4t(e,t,n){var r=bs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function i4t(e,t,n){var r=bs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function o4t(e,t,n){var r=bs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function s4t(e,t,n){var r=Wzt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function a4t(e,t,n){var r=bs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function l4t(e,t,n){var r=bs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function A4e(e,t){return Xn(e.getDate(),t,2)}function u4t(e,t){return Xn(e.getHours(),t,2)}function c4t(e,t){return Xn(e.getHours()%12||12,t,2)}function f4t(e,t){return Xn(1+fu.count(Sl(e),e),t,3)}function N4e(e,t){return Xn(e.getMilliseconds(),t,3)}function d4t(e,t){return N4e(e,t)+"000"}function p4t(e,t){return Xn(e.getMonth()+1,t,2)}function m4t(e,t){return Xn(e.getMinutes(),t,2)}function h4t(e,t){return Xn(e.getSeconds(),t,2)}function g4t(e){var t=e.getDay();return t===0?7:t}function x4t(e,t){return Xn(Mf.count(Sl(e)-1,e),t,2)}function F4e(e){var t=e.getDay();return t>=4||t===0?t1(e):t1.ceil(e)}function b4t(e,t){return e=F4e(e),Xn(t1.count(Sl(e),e)+(Sl(e).getDay()===4),t,2)}function y4t(e){return e.getDay()}function v4t(e,t){return Xn(zk.count(Sl(e)-1,e),t,2)}function w4t(e,t){return Xn(e.getFullYear()%100,t,2)}function C4t(e,t){return e=F4e(e),Xn(e.getFullYear()%100,t,2)}function _4t(e,t){return Xn(e.getFullYear()%1e4,t,4)}function S4t(e,t){var n=e.getDay();return e=n>=4||n===0?t1(e):t1.ceil(e),Xn(e.getFullYear()%1e4,t,4)}function E4t(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Xn(t/60|0,"0",2)+Xn(t%60,"0",2)}function T4e(e,t){return Xn(e.getUTCDate(),t,2)}function A4t(e,t){return Xn(e.getUTCHours(),t,2)}function T4t(e,t){return Xn(e.getUTCHours()%12||12,t,2)}function k4t(e,t){return Xn(1+Of.count(El(e),e),t,3)}function R4e(e,t){return Xn(e.getUTCMilliseconds(),t,3)}function I4t(e,t){return R4e(e,t)+"000"}function D4t(e,t){return Xn(e.getUTCMonth()+1,t,2)}function N4t(e,t){return Xn(e.getUTCMinutes(),t,2)}function F4t(e,t){return Xn(e.getUTCSeconds(),t,2)}function R4t(e){var t=e.getUTCDay();return t===0?7:t}function O4t(e,t){return Xn($f.count(El(e)-1,e),t,2)}function O4e(e){var t=e.getUTCDay();return t>=4||t===0?n1(e):n1.ceil(e)}function M4t(e,t){return e=O4e(e),Xn(n1.count(El(e),e)+(El(e).getUTCDay()===4),t,2)}function $4t(e){return e.getUTCDay()}function P4t(e,t){return Xn(Uk.count(El(e)-1,e),t,2)}function L4t(e,t){return Xn(e.getUTCFullYear()%100,t,2)}function B4t(e,t){return e=O4e(e),Xn(e.getUTCFullYear()%100,t,2)}function z4t(e,t){return Xn(e.getUTCFullYear()%1e4,t,4)}function U4t(e,t){var n=e.getUTCDay();return e=n>=4||n===0?n1(e):n1.ceil(e),Xn(e.getUTCFullYear()%1e4,t,4)}function j4t(){return"+0000"}function k4e(){return"%"}function I4e(e){return+e}function D4e(e){return Math.floor(+e/1e3)}var w4e,bs,Wzt,Gzt,M4e=w(()=>{"use strict";p3();w4e={"-":"",_:" ",0:"0"},bs=/^\s*\d+/,Wzt=/^%/,Gzt=/[\\^$*+?|[\]().{}]/g});function Gle(e){return Wk=t7(e),Gk=Wk.format,n7=Wk.parse,qk=Wk.utcFormat,r7=Wk.utcParse,Wk}var Wk,Gk,n7,qk,r7,$4e=w(()=>{"use strict";M4e();Gle({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})});var i7=w(()=>{"use strict";$4e()});function _3(e){let t={};return n=>t[n]||(t[n]=e(n))}function V4t(e,t){return n=>{let r=e(n),i=r.indexOf(t);if(i<0)return r;let o=W4t(r,i),s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function W4t(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function G4t(e){let t=_3(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){let i=Sc(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return V4t(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=Sc(s??",f");let a=Kv(r,i,o),l=Math.max(Math.abs(r),Math.abs(i)),u;if(s.precision==null)switch(s.type){case"s":return isNaN(u=c3(a,l))||(s.precision=u),n(s,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=f3(a,l))||(s.precision=u-(s.type==="e"));break}case"f":case"%":{isNaN(u=u3(a))||(s.precision=u-(s.type==="%")*2);break}}return t(s)}}}function H4t(){return q4t=G4t({format:Xv,formatPrefix:Bk})}function P4e(e,t,n){n=n||{},Jx(n)||Ca(`Invalid time multi-format specifier: ${n}`);let r=t(ig),i=t(sp),o=t(op),s=t(ip),a=t(du),l=t(Ec),u=t(ap),c=t(Al),f=e(n[sb]||".%L"),d=e(n[ig]||":%S"),p=e(n[sp]||"%I:%M"),m=e(n[op]||"%I %p"),h=e(n[ip]||n[rg]||"%a %d"),g=e(n[du]||"%b %d"),x=e(n[Ec]||"%B"),b=e(n[ap]||"%B"),y=e(n[Al]||"%Y");return v=>(r(v)<v?f:i(v)<v?d:o(v)<v?p:s(v)<v?m:l(v)<v?a(v)<v?h:g:c(v)<v?u(v)<v?x:b:y)(v)}function Y4t(e){let t=_3(e.format),n=_3(e.utcFormat);return{timeFormat:r=>Mk(r)?t(r):P4e(t,zle,r),utcFormat:r=>Mk(r)?n(r):P4e(n,Ule,r),timeParse:_3(e.parse),utcParse:_3(e.utcParse)}}function X4t(){return K4t=Y4t({format:Gk,parse:n7,utcFormat:qk,utcParse:r7})}var q4t,K4t,L4e=w(()=>{"use strict";Rf();Qj();jle();kS();i7();H4t();X4t()});function e5t(e,t){return n=>({options:n||{},sanitize:n5t,load:t5t,fileAccess:!!t,file:r5t(t),http:o5t(e)})}function t5t(e,t){return te(this,null,function*(){let n=yield this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)})}function n5t(e,t){return te(this,null,function*(){t=eb({},this.options,t);let n=this.fileAccess,r={href:null},i,o,s,a=Q4t.test(e.replace(J4t,""));(e==null||typeof e!="string"||!a)&&Ca("Sanitize failure, invalid URI: "+Ij(e));let l=Z4t.test(e);return(s=t.baseURL)&&!l&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(B4e))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(B4e.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r})}function r5t(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):i5t}function i5t(){return te(this,null,function*(){Ca("No file system access.")})}function o5t(e){return e?function(t,n){return te(this,null,function*(){let r=eb({},this.options.http,n),i=n&&n.response,o=yield e(t,r);return o.ok?Gv(o[i])?o[i]():o.text():Ca(o.status+""+o.statusText)})}:s5t}function s5t(){return te(this,null,function*(){Ca("No HTTP fetch method available.")})}function z4e(e){let t=function(n,r){let i={delimiter:e};return qle(n,r?eb(r,i):i)};return t.responseType="text",t}function qle(e,t){return t.header&&(e=t.header.map(Ij).join(t.delimiter)+`
`+e),cle(t.delimiter).parse(e+"")}function a5t(e){return typeof Buffer=="function"&&Gv(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Hle(e,t){let n=t&&t.property?Iae(t.property):VBe;return Jx(e)&&!a5t(e)?l5t(n(e),t):n(JSON.parse(e))}function l5t(e,t){return!_l(e)&&WBe(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function U4e(e,t){let n,r,i,o;return e=Hle(e,t),t&&t.feature?(n=aS,i=t.feature):t&&t.mesh?(n=lS,i=t.mesh,o=u5t[t.filter]):Ca("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):Ca("Invalid TopoJSON object: "+i),r&&r.features||[r]}var Z4t,Q4t,J4t,B4e,u5t,LTr,Yle,j4e=w(()=>{"use strict";kS();Dze();NU();L4e();Z4t=/^(data:|([A-Za-z]+:)?\/\/)/,Q4t=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,J4t=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,B4e="file://";qle.responseType="text";Hle.responseType="json";u5t={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};U4e.responseType="json";LTr={dsv:qle,csv:z4e(","),tsv:z4e("	"),json:Hle,topojson:U4e},Yle=e5t(typeof fetch<"u"&&fetch,null)});function To(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function og(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var Ac=w(()=>{"use strict"});function zS(){var e=new jh,t=[],n=[],r=Kle;function i(o){let s=e.get(o);if(s===void 0){if(r!==Kle)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new jh;for(let s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return zS(t,n).unknown(r)},To.apply(i,arguments),i}var Kle,V4e=w(()=>{"use strict";Rf();Ac();Kle=Symbol("implicit")});function ab(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function r1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}var o7=w(()=>{"use strict"});function lg(){}function G4e(){return this.rgb().formatHex()}function x5t(){return Z4e(this).formatHsl()}function q4e(){return this.rgb().formatRgb()}function pu(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=c5t.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?H4e(t):n===3?new Zo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?s7(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?s7(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=f5t.exec(e))?new Zo(t[1],t[2],t[3],1):(t=d5t.exec(e))?new Zo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=p5t.exec(e))?s7(t[1],t[2],t[3],t[4]):(t=m5t.exec(e))?s7(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=h5t.exec(e))?X4e(t[1],t[2]/100,t[3]/100,1):(t=g5t.exec(e))?X4e(t[1],t[2]/100,t[3]/100,t[4]):W4e.hasOwnProperty(e)?H4e(W4e[e]):e==="transparent"?new Zo(NaN,NaN,NaN,0):null}function H4e(e){return new Zo(e>>16&255,e>>8&255,e&255,1)}function s7(e,t,n,r){return r<=0&&(e=t=n=NaN),new Zo(e,t,n,r)}function E3(e){return e instanceof lg||(e=pu(e)),e?(e=e.rgb(),new Zo(e.r,e.g,e.b,e.opacity)):new Zo}function ko(e,t,n,r){return arguments.length===1?E3(e):new Zo(e,t,n,r??1)}function Zo(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Y4e(){return"#"+Xle(this.r)+Xle(this.g)+Xle(this.b)}function K4e(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Xle(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function X4e(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new sg(e,t,n,r)}function Z4e(e){if(e instanceof sg)return new sg(e.h,e.s,e.l,e.opacity);if(e instanceof lg||(e=pu(e)),!e)return new sg;if(e instanceof sg)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new sg(s,a,l,e.opacity)}function Tc(e,t,n,r){return arguments.length===1?Z4e(e):new sg(e,t,n,r??1)}function sg(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Zle(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var i1,US,Hk,S3,ag,c5t,f5t,d5t,p5t,m5t,h5t,g5t,W4e,a7=w(()=>{"use strict";o7();i1=.7,US=1/i1,Hk="\\s*([+-]?\\d+)\\s*",S3="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ag="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c5t=/^#([0-9a-f]{3,8})$/,f5t=new RegExp("^rgb\\("+[Hk,Hk,Hk]+"\\)$"),d5t=new RegExp("^rgb\\("+[ag,ag,ag]+"\\)$"),p5t=new RegExp("^rgba\\("+[Hk,Hk,Hk,S3]+"\\)$"),m5t=new RegExp("^rgba\\("+[ag,ag,ag,S3]+"\\)$"),h5t=new RegExp("^hsl\\("+[S3,ag,ag]+"\\)$"),g5t=new RegExp("^hsla\\("+[S3,ag,ag,S3]+"\\)$"),W4e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ab(lg,pu,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:G4e,formatHex:G4e,formatHsl:x5t,formatRgb:q4e,toString:q4e});ab(Zo,ko,r1(lg,{brighter:function(e){return e=e==null?US:Math.pow(US,e),new Zo(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?i1:Math.pow(i1,e),new Zo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Y4e,formatHex:Y4e,formatRgb:K4e,toString:K4e}));ab(sg,Tc,r1(lg,{brighter:function(e){return e=e==null?US:Math.pow(US,e),new sg(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?i1:Math.pow(i1,e),new sg(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Zo(Zle(e>=240?e-240:e+120,i,r),Zle(e,i,r),Zle(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}))});var l7,u7,Qle=w(()=>{"use strict";l7=Math.PI/180,u7=180/Math.PI});function r5e(e){if(e instanceof ug)return new ug(e.l,e.a,e.b,e.opacity);if(e instanceof lb)return i5e(e);e instanceof Zo||(e=E3(e));var t=nue(e.r),n=nue(e.g),r=nue(e.b),i=Jle((.2225045*t+.7168786*n+.0606169*r)/J4e),o,s;return t===n&&n===r?o=s=i:(o=Jle((.4360747*t+.3850649*n+.1430804*r)/Q4e),s=Jle((.0139322*t+.0971045*n+.7141733*r)/e5e)),new ug(116*i-16,500*(o-i),200*(i-s),e.opacity)}function mu(e,t,n,r){return arguments.length===1?r5e(e):new ug(e,t,n,r??1)}function ug(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Jle(e){return e>b5t?Math.pow(e,1/3):e/n5e+t5e}function eue(e){return e>Yk?e*e*e:n5e*(e-t5e)}function tue(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nue(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function y5t(e){if(e instanceof lb)return new lb(e.h,e.c,e.l,e.opacity);if(e instanceof ug||(e=r5e(e)),e.a===0&&e.b===0)return new lb(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*u7;return new lb(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function kc(e,t,n,r){return arguments.length===1?y5t(e):new lb(e,t,n,r??1)}function lb(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function i5e(e){if(isNaN(e.h))return new ug(e.l,0,0,e.opacity);var t=e.h*l7;return new ug(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}var c7,Q4e,J4e,e5e,t5e,Yk,n5e,b5t,o5e=w(()=>{"use strict";o7();a7();Qle();c7=18,Q4e=.96422,J4e=1,e5e=.82521,t5e=4/29,Yk=6/29,n5e=3*Yk*Yk,b5t=Yk*Yk*Yk;ab(ug,mu,r1(lg,{brighter:function(e){return new ug(this.l+c7*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new ug(this.l-c7*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Q4e*eue(t),e=J4e*eue(e),n=e5e*eue(n),new Zo(tue(3.1338561*t-1.6168667*e-.4906146*n),tue(-.9787684*t+1.9161415*e+.033454*n),tue(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));ab(lb,kc,r1(lg,{brighter:function(e){return new lb(this.h,this.c,this.l+c7*(e??1),this.opacity)},darker:function(e){return new lb(this.h,this.c,this.l-c7*(e??1),this.opacity)},rgb:function(){return i5e(this).rgb()}}))});function v5t(e){if(e instanceof jS)return new jS(e.h,e.s,e.l,e.opacity);e instanceof Zo||(e=E3(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(l5e*r+s5e*t-a5e*n)/(l5e+s5e-a5e),o=r-i,s=(A3*(n-i)-iue*o)/f7,a=Math.sqrt(s*s+o*o)/(A3*i*(1-i)),l=a?Math.atan2(s,o)*u7-120:NaN;return new jS(l<0?l+360:l,a,i,e.opacity)}function Pf(e,t,n,r){return arguments.length===1?v5t(e):new jS(e,t,n,r??1)}function jS(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}var u5e,rue,iue,f7,A3,s5e,a5e,l5e,c5e=w(()=>{"use strict";o7();a7();Qle();u5e=-.14861,rue=1.78277,iue=-.29227,f7=-.90649,A3=1.97294,s5e=A3*f7,a5e=A3*rue,l5e=rue*iue-f7*u5e;ab(jS,Pf,r1(lg,{brighter:function(e){return e=e==null?US:Math.pow(US,e),new jS(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?i1:Math.pow(i1,e),new jS(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*l7,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Zo(255*(t+n*(u5e*r+rue*i)),255*(t+n*(iue*r+f7*i)),255*(t+n*(A3*r)),this.opacity)}}))});var lo=w(()=>{"use strict";a7();o5e();c5e()});function oue(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function d7(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return oue((n-r/t)*t,s,i,o,a)}}var p7=w(()=>{"use strict"});function m7(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return oue((n-r/t)*t,i,o,s,a)}}var sue=w(()=>{"use strict";p7()});var Kk,aue=w(()=>{"use strict";Kk=e=>()=>e});function f5e(e,t){return function(n){return e+n*t}}function w5t(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function o1(e,t){var n=t-e;return n?f5e(e,n>180||n<-180?n-360*Math.round(n/360):n):Kk(isNaN(e)?t:e)}function d5e(e){return(e=+e)==1?Ci:function(t,n){return n-t?w5t(t,n,e):Kk(isNaN(t)?n:t)}}function Ci(e,t){var n=t-e;return n?f5e(e,n):Kk(isNaN(e)?t:e)}var VS=w(()=>{"use strict";aue()});function p5e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=ko(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(l){return a.r=r(l),a.g=i(l),a.b=o(l),a+""}}}var T3,m5e,h5e,lue=w(()=>{"use strict";lo();p7();sue();VS();T3=function e(t){var n=d5e(t);function r(i,o){var s=n((i=ko(i)).r,(o=ko(o)).r),a=n(i.g,o.g),l=n(i.b,o.b),u=Ci(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);m5e=p5e(d7),h5e=p5e(m7)});function Xk(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function h7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var g7=w(()=>{"use strict"});function g5e(e,t){return(h7(t)?Xk:uue)(e,t)}function uue(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=hu(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}var cue=w(()=>{"use strict";k3();g7()});function x7(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}var fue=w(()=>{"use strict"});function Sa(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var I3=w(()=>{"use strict"});function b7(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=hu(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var due=w(()=>{"use strict";k3()});function C5t(e){return function(){return e}}function _5t(e){return function(t){return e(t)+""}}function y7(e,t){var n=mue.lastIndex=pue.lastIndex=0,r,i,o,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=mue.exec(e))&&(i=pue.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:Sa(r,i)})),n=pue.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?_5t(l[0].x):C5t(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}var mue,pue,hue=w(()=>{"use strict";I3();mue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pue=new RegExp(mue.source,"g")});function hu(e,t){var n=typeof t,r;return t==null||n==="boolean"?Kk(t):(n==="number"?Sa:n==="string"?(r=pu(t))?(t=r,T3):y7:t instanceof pu?T3:t instanceof Date?x7:h7(t)?Xk:Array.isArray(t)?uue:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?b7:Sa)(e,t)}var k3=w(()=>{"use strict";lo();lue();cue();fue();I3();due();hue();aue();g7()});function x5e(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var b5e=w(()=>{"use strict"});function y5e(e,t){var n=o1(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}var v5e=w(()=>{"use strict";VS()});function s1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var w5e=w(()=>{"use strict"});function gue(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*C5e,skewX:Math.atan(l)*C5e,scaleX:s,scaleY:a}}var C5e,v7,_5e=w(()=>{"use strict";C5e=180/Math.PI,v7={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1}});function S5e(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?v7:gue(t.a,t.b,t.c,t.d,t.e,t.f)}function E5e(e){return e==null?v7:(w7||(w7=document.createElementNS("http://www.w3.org/2000/svg","g")),w7.setAttribute("transform",e),(e=w7.transform.baseVal.consolidate())?(e=e.matrix,gue(e.a,e.b,e.c,e.d,e.e,e.f)):v7)}var w7,A5e=w(()=>{"use strict";_5e()});function T5e(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,d,p,m){if(u!==f||c!==d){var h=p.push("translate(",null,t,null,n);m.push({i:h-4,x:Sa(u,f)},{i:h-2,x:Sa(c,d)})}else(f||d)&&p.push("translate("+f+t+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Sa(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(u,c,f,d){u!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Sa(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,d,p,m){if(u!==f||c!==d){var h=p.push(i(p)+"scale(",null,",",null,")");m.push({i:h-4,x:Sa(u,f)},{i:h-2,x:Sa(c,d)})}else(f!==1||d!==1)&&p.push(i(p)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),a(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(p){for(var m=-1,h=d.length,g;++m<h;)f[(g=d[m]).i]=g.x(p);return f.join("")}}}var k5e,I5e,D5e=w(()=>{"use strict";I3();A5e();k5e=T5e(S5e,"px, ","px)","deg)"),I5e=T5e(E5e,", ",")",")")});function N5e(e){return((e=Math.exp(e))+1/e)/2}function E5t(e){return((e=Math.exp(e))-1/e)/2}function A5t(e){return((e=Math.exp(2*e))-1)/(e+1)}var S5t,F5e,R5e=w(()=>{"use strict";S5t=1e-12;F5e=function e(t,n,r){function i(o,s){var a=o[0],l=o[1],u=o[2],c=s[0],f=s[1],d=s[2],p=c-a,m=f-l,h=p*p+m*m,g,x;if(h<S5t)x=Math.log(d/u)/t,g=function(S){return[a+S*p,l+S*m,u*Math.exp(t*S*x)]};else{var b=Math.sqrt(h),y=(d*d-u*u+r*h)/(2*u*n*b),v=(d*d-u*u-r*h)/(2*d*n*b),C=Math.log(Math.sqrt(y*y+1)-y),_=Math.log(Math.sqrt(v*v+1)-v);x=(_-C)/t,g=function(S){var E=S*x,T=N5e(C),I=u/(n*b)*(T*A5t(t*E+C)-E5t(C));return[a+I*p,l+I*m,u*T/N5e(t*E+C)]}}return g.duration=x*1e3*t/Math.SQRT2,g}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,l=a*a;return e(s,a,l)},i}(Math.SQRT2,2,4)});function O5e(e){return function(t,n){var r=e((t=Tc(t)).h,(n=Tc(n)).h),i=Ci(t.s,n.s),o=Ci(t.l,n.l),s=Ci(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var M5e,$5e,P5e=w(()=>{"use strict";lo();VS();M5e=O5e(o1),$5e=O5e(Ci)});function xue(e,t){var n=Ci((e=mu(e)).l,(t=mu(t)).l),r=Ci(e.a,t.a),i=Ci(e.b,t.b),o=Ci(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}var L5e=w(()=>{"use strict";lo();VS()});function B5e(e){return function(t,n){var r=e((t=kc(t)).h,(n=kc(n)).h),i=Ci(t.c,n.c),o=Ci(t.l,n.l),s=Ci(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var z5e,U5e,j5e=w(()=>{"use strict";lo();VS();z5e=B5e(o1),U5e=B5e(Ci)});function V5e(e){return function t(n){n=+n;function r(i,o){var s=e((i=Pf(i)).h,(o=Pf(o)).h),a=Ci(i.s,o.s),l=Ci(i.l,o.l),u=Ci(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}var W5e,G5e,q5e=w(()=>{"use strict";lo();VS();W5e=V5e(o1),G5e=V5e(Ci)});function WS(e,t){t===void 0&&(t=e,e=hu);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}var H5e=w(()=>{"use strict";k3()});function Y5e(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var K5e=w(()=>{"use strict"});var bue={};rn(bue,{interpolate:()=>hu,interpolateArray:()=>g5e,interpolateBasis:()=>d7,interpolateBasisClosed:()=>m7,interpolateCubehelix:()=>W5e,interpolateCubehelixLong:()=>G5e,interpolateDate:()=>x7,interpolateDiscrete:()=>x5e,interpolateHcl:()=>z5e,interpolateHclLong:()=>U5e,interpolateHsl:()=>M5e,interpolateHslLong:()=>$5e,interpolateHue:()=>y5e,interpolateLab:()=>xue,interpolateNumber:()=>Sa,interpolateNumberArray:()=>Xk,interpolateObject:()=>b7,interpolateRgb:()=>T3,interpolateRgbBasis:()=>m5e,interpolateRgbBasisClosed:()=>h5e,interpolateRound:()=>s1,interpolateString:()=>y7,interpolateTransformCss:()=>k5e,interpolateTransformSvg:()=>I5e,interpolateZoom:()=>F5e,piecewise:()=>WS,quantize:()=>Y5e});var D3=w(()=>{"use strict";k3();cue();p7();sue();fue();b5e();v5e();I3();g7();due();w5e();hue();D5e();R5e();lue();P5e();L5e();j5e();q5e();H5e();K5e()});function yue(e){return function(){return e}}var X5e=w(()=>{"use strict"});function Zk(e){return+e}var vue=w(()=>{"use strict"});function Xs(e){return e}function wue(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:yue(isNaN(t)?NaN:.5)}function T5t(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function k5t(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=wue(i,r),o=n(s,o)):(r=wue(r,i),o=n(o,s)),function(a){return o(r(a))}}function I5t(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=wue(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var l=np(e,a,1,r)-1;return o[l](i[l](a))}}function cg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function GS(){var e=Z5e,t=Z5e,n=hu,r,i,o,s=Xs,a,l,u;function c(){var d=Math.min(e.length,t.length);return s!==Xs&&(s=T5t(e[0],e[d-1])),a=d>2?I5t:k5t,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?o:(l||(l=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((u||(u=a(t,e.map(r),Sa)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Zk),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=s1,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Xs,c()):s!==Xs},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,p){return r=d,i=p,c()}}function N3(){return GS()(Xs,Xs)}var Z5e,a1=w(()=>{"use strict";Rf();D3();X5e();vue();Z5e=[0,1]});function Qk(e,t,n,r){var i=Kv(e,t,n),o;switch(r=Sc(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=c3(i,s))&&(r.precision=o),Bk(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=f3(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=u3(i))&&(r.precision=o-(r.type==="%")*2);break}}return Xv(r)}var Cue=w(()=>{"use strict";Rf();Qj()});function Ic(e){var t=e.domain;return e.ticks=function(n){var r=t();return RS(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Qk(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],l,u,c=10;for(a<s&&(u=s,s=a,a=u,u=i,i=o,o=u);c-- >0;){if(u=s3(s,a,n),u===l)return r[i]=s,r[o]=a,t(r);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;l=u}return e},e}function F3(){var e=N3();return e.copy=function(){return cg(e,F3())},To.apply(e,arguments),Ic(e)}var l1=w(()=>{"use strict";Rf();a1();Ac();Cue()});function R3(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Zk),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return R3(e).unknown(t)},e=arguments.length?Array.from(e,Zk):[0,1],Ic(n)}var Q5e=w(()=>{"use strict";l1();vue()});function O3(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}var _ue=w(()=>{"use strict"});function J5e(e){return Math.log(e)}function e6e(e){return Math.exp(e)}function D5t(e){return-Math.log(-e)}function N5t(e){return-Math.exp(-e)}function F5t(e){return isFinite(e)?+("1e"+e):e<0?0:e}function R5t(e){return e===10?F5t:e===Math.E?Math.exp:t=>Math.pow(e,t)}function O5t(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function t6e(e){return(t,n)=>-e(-t,n)}function M3(e){let t=e(J5e,e6e),n=t.domain,r=10,i,o;function s(){return i=O5t(r),o=R5t(r),n()[0]<0?(i=t6e(i),o=t6e(o),e(D5t,N5t)):e(J5e,e6e),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{let l=n(),u=l[0],c=l[l.length-1],f=c<u;f&&([u,c]=[c,u]);let d=i(u),p=i(c),m,h,g=a==null?10:+a,x=[];if(!(r%1)&&p-d<g){if(d=Math.floor(d),p=Math.ceil(p),u>0){for(;d<=p;++d)for(m=1;m<r;++m)if(h=d<0?m/o(-d):m*o(d),!(h<u)){if(h>c)break;x.push(h)}}else for(;d<=p;++d)for(m=r-1;m>=1;--m)if(h=d>0?m/o(-d):m*o(d),!(h<u)){if(h>c)break;x.push(h)}x.length*2<g&&(x=RS(u,c,g))}else x=RS(d,p,Math.min(p-d,g)).map(o);return f?x.reverse():x},t.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Sc(l)).precision==null&&(l.trim=!0),l=Xv(l)),a===1/0)return l;let u=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(O3(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function $3(){let e=M3(GS()).domain([1,10]);return e.copy=()=>cg(e,$3()).base(e.base()),To.apply(e,arguments),e}var C7=w(()=>{"use strict";Rf();Qj();_ue();a1();Ac()});function n6e(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function r6e(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function P3(e){var t=1,n=e(n6e(t),r6e(t));return n.constant=function(r){return arguments.length?e(n6e(t=+r),r6e(t)):t},Ic(n)}function L3(){var e=P3(GS());return e.copy=function(){return cg(e,L3()).constant(e.constant())},To.apply(e,arguments)}var _7=w(()=>{"use strict";l1();a1();Ac()});function i6e(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function M5t(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $5t(e){return e<0?-e*e:e*e}function B3(e){var t=e(Xs,Xs),n=1;function r(){return n===1?e(Xs,Xs):n===.5?e(M5t,$5t):e(i6e(n),i6e(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Ic(t)}function Jk(){var e=B3(GS());return e.copy=function(){return cg(e,Jk()).exponent(e.exponent())},To.apply(e,arguments),e}function Sue(){return Jk.apply(null,arguments).exponent(.5)}var S7=w(()=>{"use strict";l1();a1();Ac()});function z3(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=mle(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[np(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(eg),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return z3().domain(e).range(t).unknown(r)},To.apply(o,arguments)}var o6e=w(()=>{"use strict";Rf();Ac()});function U3(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(l){return l!=null&&l<=l?i[np(r,l,0,n)]:o}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},s.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,a()):i.slice()},s.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},s.unknown=function(l){return arguments.length&&(o=l),s},s.thresholds=function(){return r.slice()},s.copy=function(){return U3().domain([e,t]).range(i).unknown(o)},To.apply(Ic(s),arguments)}var s6e=w(()=>{"use strict";Rf();l1();Ac()});function j3(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[np(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return j3().domain(e).range(t).unknown(n)},To.apply(i,arguments)}var a6e=w(()=>{"use strict";Rf();Ac()});function P5t(e){return new Date(e)}function L5t(e){return e instanceof Date?+e:+new Date(+e)}function E7(e,t,n,r,i,o,s,a,l,u){var c=N3(),f=c.invert,d=c.domain,p=u(".%L"),m=u(":%S"),h=u("%I:%M"),g=u("%I %p"),x=u("%a %d"),b=u("%b %d"),y=u("%B"),v=u("%Y");function C(_){return(l(_)<_?p:a(_)<_?m:s(_)<_?h:o(_)<_?g:r(_)<_?i(_)<_?x:b:n(_)<_?y:v)(_)}return c.invert=function(_){return new Date(f(_))},c.domain=function(_){return arguments.length?d(Array.from(_,L5t)):d().map(P5t)},c.ticks=function(_){var S=d();return e(S[0],S[S.length-1],_??10)},c.tickFormat=function(_,S){return S==null?C:u(S)},c.nice=function(_){var S=d();return(!_||typeof _.range!="function")&&(_=t(S[0],S[S.length-1],_??10)),_?d(O3(S,_)):c},c.copy=function(){return cg(c,E7(e,t,n,r,i,o,s,a,l,u))},c}function A7(){return To.apply(E7(Mle,$le,Sl,ib,Mf,fu,Jv,Zv,_a,Gk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var Eue=w(()=>{"use strict";p3();i7();a1();Ac();_ue()});function T7(){return To.apply(E7(Rle,Ole,El,ob,$f,Of,e1,Qv,_a,qk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}var l6e=w(()=>{"use strict";p3();i7();Eue();Ac()});function k7(){var e=0,t=1,n,r,i,o,s=Xs,a=!1,l;function u(f){return f==null||isNaN(f=+f)?l:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(a=!!f,u):a},u.interpolator=function(f){return arguments.length?(s=f,u):s};function c(f){return function(d){var p,m;return arguments.length?([p,m]=d,s=f(p,m),u):[s(0),s(1)]}}return u.range=c(hu),u.rangeRound=c(s1),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function ub(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function eI(){var e=Ic(k7()(Xs));return e.copy=function(){return ub(e,eI())},og.apply(e,arguments)}function I7(){var e=M3(k7()).domain([1,10]);return e.copy=function(){return ub(e,I7()).base(e.base())},og.apply(e,arguments)}function D7(){var e=P3(k7());return e.copy=function(){return ub(e,D7()).constant(e.constant())},og.apply(e,arguments)}function V3(){var e=B3(k7());return e.copy=function(){return ub(e,V3()).exponent(e.exponent())},og.apply(e,arguments)}function Aue(){return V3.apply(null,arguments).exponent(.5)}var Tue=w(()=>{"use strict";D3();a1();Ac();l1();C7();_7();S7()});function N7(){var e=0,t=.5,n=1,r=1,i,o,s,a,l,u=Xs,c,f=!1,d;function p(h){return isNaN(h=+h)?d:(h=.5+((h=+c(h))-o)*(r*h<r*o?a:l),u(f?Math.max(0,Math.min(1,h)):h))}p.domain=function(h){return arguments.length?([e,t,n]=h,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,p):[e,t,n]},p.clamp=function(h){return arguments.length?(f=!!h,p):f},p.interpolator=function(h){return arguments.length?(u=h,p):u};function m(h){return function(g){var x,b,y;return arguments.length?([x,b,y]=g,u=WS(h,[x,b,y]),p):[u(0),u(.5),u(1)]}}return p.range=m(hu),p.rangeRound=m(s1),p.unknown=function(h){return arguments.length?(d=h,p):d},function(h){return c=h,i=h(e),o=h(t),s=h(n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,p}}function W3(){var e=Ic(N7()(Xs));return e.copy=function(){return ub(e,W3())},og.apply(e,arguments)}function F7(){var e=M3(N7()).domain([.1,1,10]);return e.copy=function(){return ub(e,F7()).base(e.base())},og.apply(e,arguments)}function R7(){var e=P3(N7());return e.copy=function(){return ub(e,R7()).constant(e.constant())},og.apply(e,arguments)}function G3(){var e=B3(N7());return e.copy=function(){return ub(e,G3()).exponent(e.exponent())},og.apply(e,arguments)}function kue(){return G3.apply(null,arguments).exponent(.5)}var u6e=w(()=>{"use strict";D3();a1();Ac();l1();C7();Tue();_7();S7()});var Iue=w(()=>{"use strict";Q5e();l1();C7();_7();V4e();S7();o6e();s6e();a6e();Eue();l6e();Tue();u6e();Cue()});function Io(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}var lp=w(()=>{"use strict"});var q3,c6e=w(()=>{"use strict";lp();q3=Io("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf")});var H3,f6e=w(()=>{"use strict";lp();H3=Io("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666")});var Y3,d6e=w(()=>{"use strict";lp();Y3=Io("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666")});var K3,p6e=w(()=>{"use strict";lp();K3=Io("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0")});var X3,m6e=w(()=>{"use strict";lp();X3=Io("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928")});var Z3,h6e=w(()=>{"use strict";lp();Z3=Io("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2")});var Q3,g6e=w(()=>{"use strict";lp();Q3=Io("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc")});var J3,x6e=w(()=>{"use strict";lp();J3=Io("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999")});var e$,b6e=w(()=>{"use strict";lp();e$=Io("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3")});var t$,y6e=w(()=>{"use strict";lp();t$=Io("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f")});function Due(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function O7(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return Due((n-r/t)*t,s,i,o,a)}}var M7=w(()=>{"use strict"});function $7(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return Due((n-r/t)*t,i,o,s,a)}}var Nue=w(()=>{"use strict";M7()});var tI,Fue=w(()=>{"use strict";tI=e=>()=>e});function v6e(e,t){return function(n){return e+n*t}}function z5t(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function u1(e,t){var n=t-e;return n?v6e(e,n>180||n<-180?n-360*Math.round(n/360):n):tI(isNaN(e)?t:e)}function w6e(e){return(e=+e)==1?_i:function(t,n){return n-t?z5t(t,n,e):tI(isNaN(t)?n:t)}}function _i(e,t){var n=t-e;return n?v6e(e,n):tI(isNaN(e)?t:e)}var qS=w(()=>{"use strict";Fue()});function C6e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=ko(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(l){return a.r=r(l),a.g=i(l),a.b=o(l),a+""}}}var n$,_6e,S6e,Rue=w(()=>{"use strict";lo();M7();Nue();qS();n$=function e(t){var n=w6e(t);function r(i,o){var s=n((i=ko(i)).r,(o=ko(o)).r),a=n(i.g,o.g),l=n(i.b,o.b),u=_i(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);_6e=C6e(O7),S6e=C6e($7)});function nI(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function P7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var L7=w(()=>{"use strict"});function E6e(e,t){return(P7(t)?nI:Oue)(e,t)}function Oue(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=Ea(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}var Mue=w(()=>{"use strict";r$();L7()});function B7(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}var $ue=w(()=>{"use strict"});function Aa(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var i$=w(()=>{"use strict"});function z7(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ea(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Pue=w(()=>{"use strict";r$()});function U5t(e){return function(){return e}}function j5t(e){return function(t){return e(t)+""}}function U7(e,t){var n=Bue.lastIndex=Lue.lastIndex=0,r,i,o,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Bue.exec(e))&&(i=Lue.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:Aa(r,i)})),n=Lue.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?j5t(l[0].x):U5t(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}var Bue,Lue,zue=w(()=>{"use strict";i$();Bue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Lue=new RegExp(Bue.source,"g")});function Ea(e,t){var n=typeof t,r;return t==null||n==="boolean"?tI(t):(n==="number"?Aa:n==="string"?(r=pu(t))?(t=r,n$):U7:t instanceof pu?n$:t instanceof Date?B7:P7(t)?nI:Array.isArray(t)?Oue:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?z7:Aa)(e,t)}var r$=w(()=>{"use strict";lo();Rue();Mue();$ue();i$();Pue();zue();Fue();L7()});function A6e(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var T6e=w(()=>{"use strict"});function k6e(e,t){var n=u1(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}var I6e=w(()=>{"use strict";qS()});function fg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var D6e=w(()=>{"use strict"});function Uue(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*N6e,skewX:Math.atan(l)*N6e,scaleX:s,scaleY:a}}var N6e,j7,F6e=w(()=>{"use strict";N6e=180/Math.PI,j7={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1}});function R6e(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?j7:Uue(t.a,t.b,t.c,t.d,t.e,t.f)}function O6e(e){return e==null?j7:(V7||(V7=document.createElementNS("http://www.w3.org/2000/svg","g")),V7.setAttribute("transform",e),(e=V7.transform.baseVal.consolidate())?(e=e.matrix,Uue(e.a,e.b,e.c,e.d,e.e,e.f)):j7)}var V7,M6e=w(()=>{"use strict";F6e()});function $6e(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,d,p,m){if(u!==f||c!==d){var h=p.push("translate(",null,t,null,n);m.push({i:h-4,x:Aa(u,f)},{i:h-2,x:Aa(c,d)})}else(f||d)&&p.push("translate("+f+t+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Aa(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(u,c,f,d){u!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Aa(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,d,p,m){if(u!==f||c!==d){var h=p.push(i(p)+"scale(",null,",",null,")");m.push({i:h-4,x:Aa(u,f)},{i:h-2,x:Aa(c,d)})}else(f!==1||d!==1)&&p.push(i(p)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),a(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(p){for(var m=-1,h=d.length,g;++m<h;)f[(g=d[m]).i]=g.x(p);return f.join("")}}}var P6e,L6e,B6e=w(()=>{"use strict";i$();M6e();P6e=$6e(R6e,"px, ","px)","deg)"),L6e=$6e(O6e,", ",")",")")});function z6e(e){return((e=Math.exp(e))+1/e)/2}function W5t(e){return((e=Math.exp(e))-1/e)/2}function G5t(e){return((e=Math.exp(2*e))-1)/(e+1)}var V5t,U6e,j6e=w(()=>{"use strict";V5t=1e-12;U6e=function e(t,n,r){function i(o,s){var a=o[0],l=o[1],u=o[2],c=s[0],f=s[1],d=s[2],p=c-a,m=f-l,h=p*p+m*m,g,x;if(h<V5t)x=Math.log(d/u)/t,g=function(S){return[a+S*p,l+S*m,u*Math.exp(t*S*x)]};else{var b=Math.sqrt(h),y=(d*d-u*u+r*h)/(2*u*n*b),v=(d*d-u*u-r*h)/(2*d*n*b),C=Math.log(Math.sqrt(y*y+1)-y),_=Math.log(Math.sqrt(v*v+1)-v);x=(_-C)/t,g=function(S){var E=S*x,T=z6e(C),I=u/(n*b)*(T*G5t(t*E+C)-W5t(C));return[a+I*p,l+I*m,u*T/z6e(t*E+C)]}}return g.duration=x*1e3*t/Math.SQRT2,g}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,l=a*a;return e(s,a,l)},i}(Math.SQRT2,2,4)});function V6e(e){return function(t,n){var r=e((t=Tc(t)).h,(n=Tc(n)).h),i=_i(t.s,n.s),o=_i(t.l,n.l),s=_i(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var W6e,G6e,q6e=w(()=>{"use strict";lo();qS();W6e=V6e(u1),G6e=V6e(_i)});function jue(e,t){var n=_i((e=mu(e)).l,(t=mu(t)).l),r=_i(e.a,t.a),i=_i(e.b,t.b),o=_i(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}var H6e=w(()=>{"use strict";lo();qS()});function Y6e(e){return function(t,n){var r=e((t=kc(t)).h,(n=kc(n)).h),i=_i(t.c,n.c),o=_i(t.l,n.l),s=_i(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var K6e,X6e,Z6e=w(()=>{"use strict";lo();qS();K6e=Y6e(u1),X6e=Y6e(_i)});function Q6e(e){return function t(n){n=+n;function r(i,o){var s=e((i=Pf(i)).h,(o=Pf(o)).h),a=_i(i.s,o.s),l=_i(i.l,o.l),u=_i(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}var J6e,e8e,t8e=w(()=>{"use strict";lo();qS();J6e=Q6e(u1),e8e=Q6e(_i)});function HS(e,t){t===void 0&&(t=e,e=Ea);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}var n8e=w(()=>{"use strict";r$()});function r8e(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var i8e=w(()=>{"use strict"});var Vue={};rn(Vue,{interpolate:()=>Ea,interpolateArray:()=>E6e,interpolateBasis:()=>O7,interpolateBasisClosed:()=>$7,interpolateCubehelix:()=>J6e,interpolateCubehelixLong:()=>e8e,interpolateDate:()=>B7,interpolateDiscrete:()=>A6e,interpolateHcl:()=>K6e,interpolateHclLong:()=>X6e,interpolateHsl:()=>W6e,interpolateHslLong:()=>G6e,interpolateHue:()=>k6e,interpolateLab:()=>jue,interpolateNumber:()=>Aa,interpolateNumberArray:()=>nI,interpolateObject:()=>z7,interpolateRgb:()=>n$,interpolateRgbBasis:()=>_6e,interpolateRgbBasisClosed:()=>S6e,interpolateRound:()=>fg,interpolateString:()=>U7,interpolateTransformCss:()=>P6e,interpolateTransformSvg:()=>L6e,interpolateZoom:()=>U6e,piecewise:()=>HS,quantize:()=>r8e});var YS=w(()=>{"use strict";r$();Mue();M7();Nue();$ue();T6e();I6e();i$();L7();Pue();D6e();zue();B6e();j6e();Rue();q6e();H6e();Z6e();t8e();n8e();i8e()});var Wue=w(()=>{"use strict";c6e();f6e();d6e();p6e();m6e();h6e();g6e();x6e();b6e();y6e()});function H5t(e,t,n){let r=e-t+n*2;return e?r>0?r:1:0}function J5t(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function e6t(e){return function(t){let n=e.range(),r=t[0],i=t[1],o=-1,s,a,l,u;for(i<r&&(a=r,r=i,i=a),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(o<0&&(o=l),s=l);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Que(){let e=zS().unknown(void 0),t=e.domain,n=e.range,r=[0,1],i,o,s=!1,a=0,l=0,u=.5;delete e.unknown;function c(){let f=t().length,d=r[1]<r[0],p=r[1-d],m=H5t(f,a,l),h=r[d-0];i=(p-h)/(m||1),s&&(i=Math.floor(i)),h+=(p-h-i*(f-a))*u,o=i*(1-a),s&&(h=Math.round(h),o=Math.round(o));let g=Kj(f).map(x=>h+i*x);return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),a=l,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;let d=r[1]<r[0],p=d?n().reverse():n(),m=p.length-1,h=+f[0],g=+f[1],x,b,y;if(!(h!==h||g!==g)&&(g<h&&(y=h,h=g,g=y),!(g<p[0]||h>r[1-d])))return x=Math.max(0,o3(p,h)-1),b=h===g?x:o3(p,g)-1,h-p[x]>o+1e-10&&++x,d&&(y=x,x=m-b,b=m-y),x>b?void 0:t().slice(x,b+1)},e.invert=function(f){let d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return Que().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(l).align(u)},c()}function u8e(e){let t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return u8e(t())},e}function t6t(){return u8e(Que().paddingInner(1))}function r6t(e){return n6t.call(e,Nae)}function c8e(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(np(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=r6t(r),n):e.slice()},n.range=function(r){return arguments.length?(t=i6t.call(r),n):t.slice()},n.tickFormat=function(r,i){return Qk(e[0],lu(e),r??10,i)},n.copy=function(){return c8e().domain(n.domain()).range(n.range())},n}function s6t(e){return e[o6t]=!0,e}function a6t(e,t,n){let r=function(){let o=t();return o.invertRange||(o.invertRange=o.invert?J5t(o):o.invertExtent?e6t(o):void 0),o.type=e,s6t(o)};return r.metadata=qM(Ok(n)),r}function ei(e,t,n){return arguments.length>1?(G7.set(e,a6t(e,t,n)),this):l6t(e)?G7.get(e):void 0}function l6t(e){return G7.has(e)}function q7(e,t){let n=G7.get(e);return n&&n.metadata[t]}function Jue(e){return q7(e,l$)}function u6t(e){return q7(e,u$)}function c6t(e){return q7(e,c1)}function f6t(e){return q7(e,Zue)}function d6t(e,t,n){return WS(p6t(t||"rgb",n),e)}function p6t(e,t){let n=bue[m6t(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function m6t(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function f8e(e){if(_l(e))return e;let t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function d8e(e,t){for(let n in e)x6t(n,t(e[n]))}function x6t(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(o8e[e]=t,this):o8e[e]}function _6t(e,t,n){let r=e.range(),i=r[0],o=lu(r),s=w6t;if(i>o&&(r=o,o=i,i=r,s=C6t),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){let a=[t[0],lu(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function p8e(e,t){return e.bins?_6t(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function S6t(e,t,n,r,i,o){let s=t.type,a=v6t;if(s===o$||i===o$)a=e.timeFormat(r);else if(s===s$||i===s$)a=e.utcFormat(r);else if(c6t(s)){let l=e.formatFloat(r);if(o||t.bins)a=l;else{let u=m8e(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){let l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(a=e.format(r));return a}function m8e(e,t,n){let r=p8e(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/o));return u*i<i-.5&&(u*=i),u<=s};return n?r.filter(a):a}function E6t(e,t){return e.bins?k6t(e.bins):e.type===c1?m8e(e,t,!0):Gue[e.type]?T6t(e[Gue[e.type]]()):p8e(e,t)}function A6t(e,t,n){let r=t[h8e[t.type]](),i=r.length,o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function T6t(e){let t=[-1/0].concat(e);return t.max=1/0,t}function k6t(e){let t=e.slice(0,-1);return t.max=lu(e),t}function D6t(e,t,n,r,i,o,s){let a=h8e[t.type]&&o!==o$&&o!==s$?A6t(e,t,i):S6t(e,t,n,i,o,s);return r===b6t&&I6t(t)?N6t(a):r===y6t?F6t(a):R6t(a)}function O6t(e,t,n,r){let i=r||t.type;return Mk(n)&&f6t(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===o$?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===s$?e.utcFormat("%A, %d %B %Y, %X UTC"):D6t(e,t,5,null,n,r,!0)}function ece(e,t,n){n=n||{};let r=Math.max(3,n.maxlen||7),i=O6t(e,t,n.format,n.formatType);if(u6t(t.type)){let o=E6t(t).slice(1).map(i),s=o.length;return`${s} boundar${s===1?"y":"ies"}: ${o.join(", ")}`}else if(Jue(t.type)){let o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return`${s} value${s===1?"":"s"}: ${a}`}else{let o=t.domain();return`values from ${i(o[0])} to ${i(lu(o))}`}}var Y5t,que,c1,Hue,Yue,Kue,o$,s$,rI,a$,W7,Xue,l8e,K5t,X5t,Z5t,Q5t,ys,l$,u$,up,Zue,n6t,i6t,G7,o6t,h6t,g6t,o8e,b6t,y6t,v6t,w6t,C6t,Gue,h8e,I6t,N6t,s8e,F6t,R6t,a8e,g8e=w(()=>{"use strict";kS();Rf();Iue();Iue();D3();Wue();jle();Y5t="identity",que="linear",c1="log",Hue="pow",Yue="sqrt",Kue="symlog",o$="time",s$="utc",rI="sequential",a$="diverging",W7="quantile",Xue="quantize",l8e="threshold",K5t="ordinal",X5t="point",Z5t="band",Q5t="bin-ordinal",ys="continuous",l$="discrete",u$="discretizing",up="interpolating",Zue="temporal";n6t=Array.prototype.map;i6t=Array.prototype.slice;G7=new Map,o6t=Symbol("vega_scale");ei(Y5t,R3);ei(que,F3,ys);ei(c1,$3,[ys,c1]);ei(Hue,Jk,ys);ei(Yue,Sue,ys);ei(Kue,L3,ys);ei(o$,A7,[ys,Zue]);ei(s$,T7,[ys,Zue]);ei(rI,eI,[ys,up]);ei(`${rI}-${que}`,eI,[ys,up]);ei(`${rI}-${c1}`,I7,[ys,up,c1]);ei(`${rI}-${Hue}`,V3,[ys,up]);ei(`${rI}-${Yue}`,Aue,[ys,up]);ei(`${rI}-${Kue}`,D7,[ys,up]);ei(`${a$}-${que}`,W3,[ys,up]);ei(`${a$}-${c1}`,F7,[ys,up,c1]);ei(`${a$}-${Hue}`,G3,[ys,up]);ei(`${a$}-${Yue}`,kue,[ys,up]);ei(`${a$}-${Kue}`,R7,[ys,up]);ei(W7,z3,[u$,W7]);ei(Xue,U3,u$);ei(l8e,j3,u$);ei(Q5t,c8e,[l$,u$]);ei(K5t,zS,l$);ei(Z5t,Que,l$);ei(X5t,t6t,l$);h6t={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},g6t={accent:H3,category10:q3,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Y3,observable10:K3,paired:X3,pastel1:Z3,pastel2:Q3,set1:J3,set2:e$,set3:t$,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};o8e={};d8e(g6t,f8e);d8e(h6t,e=>d6t(f8e(e)));b6t="symbol",y6t="discrete",v6t=e=>_l(e)?e.map(t=>String(t)):String(e),w6t=(e,t)=>e[1]-t[1],C6t=(e,t)=>t[1]-e[1];Gue={[W7]:"quantiles",[Xue]:"thresholds",[l8e]:"domain"},h8e={[W7]:"quantiles",[Xue]:"domain"};I6t=e=>Gue[e.type]||e.bins;N6t=e=>(t,n,r)=>{let i=s8e(r[n+1],s8e(r.max,1/0)),o=a8e(t,e),s=a8e(i,e);return o&&s?o+" \u2013 "+s:s?"< "+s:"\u2265 "+o},s8e=(e,t)=>e??t,F6t=e=>(t,n)=>n?e(t):null,R6t=e=>t=>e(t),a8e=(e,t)=>Number.isFinite(e)?t(e):null});function Cce(e){return e&&e.gradient}function B8e(e,t,n){let r=e.gradient,i=e.id,o=r==="radial"?n9:"";return i||(i=e.id="gradient_"+M6t++,r==="radial"?(e.x1=dg(e.x1,.5),e.y1=dg(e.y1,.5),e.r1=dg(e.r1,0),e.x2=dg(e.x2,.5),e.y2=dg(e.y2,.5),e.r2=dg(e.r2,.5),o=n9):(e.x1=dg(e.x1,0),e.y1=dg(e.y1,0),e.x2=dg(e.x2,1),e.y2=dg(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function dg(e,t){return e??t}function z8e(e,t,n){var r=Nf(x8e,e)&&x8e[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}function U8e(e){let t=[];return(e.match(P6t)||[]).forEach(r=>{let i=r[0],o=i.toLowerCase(),s=$6t[o],a=U6t(o,s,r.slice(1).trim()),l=a.length;if(l<s||l&&l%s!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,s)]),l!==s){o==="m"&&(i=i==="M"?"L":"l");for(let u=s;u<l;u+=s)t.push([i,...a.slice(u,u+s)])}}),t}function U6t(e,t,n){let r=[];for(let i=0;t&&i<n.length;)for(let o=0;o<t;++o){let s=e==="a"&&(o===3||o===4)?z6t:L6t,a=n.slice(i).match(s);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);let l=n.slice(i).match(B6t);l!==null&&(i+=l[0].length)}return r}function V6t(e,t,n,r,i,o,s,a,l){let u=j8e.call(arguments);if(tce[u])return tce[u];let c=s*g1,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);let p=d*(a-e)*.5+f*(l-t)*.5,m=d*(l-t)*.5-f*(a-e)*.5,h=p*p/(n*n)+m*m/(r*r);h>1&&(h=Math.sqrt(h),n*=h,r*=h);let g=d/n,x=f/n,b=-f/r,y=d/r,v=g*a+x*l,C=b*a+y*l,_=g*e+x*t,S=b*e+y*t,T=1/((_-v)*(_-v)+(S-C)*(S-C))-.25;T<0&&(T=0);let I=Math.sqrt(T);o==i&&(I=-I);let k=.5*(v+_)-I*(S-C),O=.5*(C+S)+I*(_-v),F=Math.atan2(C-O,v-k),M=Math.atan2(S-O,_-k)-F;M<0&&o===1?M+=pg:M>0&&o===0&&(M-=pg);let z=Math.ceil(Math.abs(M/(KS+.001))),W=[];for(let H=0;H<z;++H){let Q=F+H*M/z,re=F+(H+1)*M/z;W[H]=[k,O,Q,re,n,r,f,d]}return tce[u]=W}function W6t(e){let t=j8e.call(e);if(nce[t])return nce[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7];let c=u*s,f=-l*a,d=l*s,p=u*a,m=Math.cos(i),h=Math.sin(i),g=Math.cos(o),x=Math.sin(o),b=.5*(o-i),y=Math.sin(b*.5),v=8/3*y*y/Math.sin(b),C=n+m-v*h,_=r+h+v*m,S=n+g,E=r+x,T=S+v*x,I=E-v*g;return nce[t]=[c*C+f*_,d*C+p*_,c*T+f*I,d*T+p*I,c*S+f*E,d*S+p*E]}function G6t(e,t,n){let r=Lf[0]=e[0];if(r==="a"||r==="A")Lf[1]=t*e[1],Lf[2]=n*e[2],Lf[3]=e[3],Lf[4]=e[4],Lf[5]=e[5],Lf[6]=t*e[6],Lf[7]=n*e[7];else if(r==="h"||r==="H")Lf[1]=t*e[1];else if(r==="v"||r==="V")Lf[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Lf[i]=(i%2==1?t:n)*e[i];return Lf}function lce(e,t,n,r,i,o){var s,a=null,l=0,u=0,c=0,f=0,d,p,m,h,g=0,x=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var b=0,y=t.length;b<y;++b){switch(s=t[b],(i!==1||o!==1)&&(s=G6t(s,i,o)),s[0]){case"l":l+=s[1],u+=s[2],e.lineTo(l+n,u+r);break;case"L":l=s[1],u=s[2],e.lineTo(l+n,u+r);break;case"h":l+=s[1],e.lineTo(l+n,u+r);break;case"H":l=s[1],e.lineTo(l+n,u+r);break;case"v":u+=s[1],e.lineTo(l+n,u+r);break;case"V":u=s[1],e.lineTo(l+n,u+r);break;case"m":l+=s[1],u+=s[2],g=l,x=u,e.moveTo(l+n,u+r);break;case"M":l=s[1],u=s[2],g=l,x=u,e.moveTo(l+n,u+r);break;case"c":d=l+s[5],p=u+s[6],c=l+s[3],f=u+s[4],e.bezierCurveTo(l+s[1]+n,u+s[2]+r,c+n,f+r,d+n,p+r),l=d,u=p;break;case"C":l=s[5],u=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,l+n,u+r);break;case"s":d=l+s[3],p=u+s[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+s[1]+n,u+s[2]+r,d+n,p+r),c=l+s[1],f=u+s[2],l=d,u=p;break;case"S":d=s[3],p=s[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,p+r),l=d,u=p,c=s[1],f=s[2];break;case"q":d=l+s[3],p=u+s[4],c=l+s[1],f=u+s[2],e.quadraticCurveTo(c+n,f+r,d+n,p+r),l=d,u=p;break;case"Q":d=s[3],p=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,p+r),l=d,u=p,c=s[1],f=s[2];break;case"t":d=l+s[1],p=u+s[2],a[0].match(/[QqTt]/)===null?(c=l,f=u):a[0]==="t"?(c=2*l-m,f=2*u-h):a[0]==="q"&&(c=2*l-c,f=2*u-f),m=c,h=f,e.quadraticCurveTo(c+n,f+r,d+n,p+r),l=d,u=p,c=l+s[1],f=u+s[2];break;case"T":d=s[1],p=s[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,d+n,p+r),l=d,u=p;break;case"a":b8e(e,l+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+l+n,s[7]+u+r]),l+=s[6],u+=s[7];break;case"A":b8e(e,l+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),l=s[6],u=s[7];break;case"z":case"Z":l=g,u=x,e.closePath();break}a=s}}function b8e(e,t,n,r){let i=V6t(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){let s=W6t(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}function q6t(e){return Nf(v8e,e)?v8e[e]:H6t(e)}function H6t(e){if(!Nf(rce,e)){let t=U8e(e);rce[e]={draw:function(n,r){lce(n,t,0,0,Math.sqrt(r)/2)}}}return rce[e]}function Y6t(e){return e.x}function K6t(e){return e.y}function X6t(e){return e.width}function Z6t(e){return e.height}function cb(e){return typeof e=="function"?e:()=>+e}function H7(e,t,n){return Math.max(t,Math.min(e,n))}function Q6t(){var e=Y6t,t=K6t,n=X6t,r=Z6t,i=cb(0),o=i,s=i,a=i,l=null;function u(c,f,d){var p,m=f??+e.call(this,c),h=d??+t.call(this,c),g=+n.call(this,c),x=+r.call(this,c),b=Math.min(g,x)/2,y=H7(+i.call(this,c),0,b),v=H7(+o.call(this,c),0,b),C=H7(+s.call(this,c),0,b),_=H7(+a.call(this,c),0,b);if(l||(l=p=KM()),y<=0&&v<=0&&C<=0&&_<=0)l.rect(m,h,g,x);else{var S=m+g,E=h+x;l.moveTo(m+y,h),l.lineTo(S-v,h),l.bezierCurveTo(S-f1*v,h,S,h+f1*v,S,h+v),l.lineTo(S,E-_),l.bezierCurveTo(S,E-f1*_,S-f1*_,E,S-_,E),l.lineTo(m+C,E),l.bezierCurveTo(m+f1*C,E,m,E-f1*C,m,E-C),l.lineTo(m,h+y),l.bezierCurveTo(m,h+f1*y,m+f1*y,h,m+y,h),l.closePath()}if(p)return l=null,p+""||null}return u.x=function(c){return arguments.length?(e=cb(c),u):e},u.y=function(c){return arguments.length?(t=cb(c),u):t},u.width=function(c){return arguments.length?(n=cb(c),u):n},u.height=function(c){return arguments.length?(r=cb(c),u):r},u.cornerRadius=function(c,f,d,p){return arguments.length?(i=cb(c),o=f!=null?cb(f):i,a=d!=null?cb(d):i,s=p!=null?cb(p):o,u):i},u.context=function(c){return arguments.length?(l=c??null,u):l},u}function J6t(){var e,t,n,r,i=null,o,s,a,l;function u(f,d,p){let m=p/2;if(o){var h=a-d,g=f-s;if(h||g){var x=Math.hypot(h,g),b=(h/=x)*l,y=(g/=x)*l,v=Math.atan2(g,h);i.moveTo(s-b,a-y),i.lineTo(f-h*m,d-g*m),i.arc(f,d,m,v-Math.PI,v),i.lineTo(s+b,a+y),i.arc(s,a,l,v,v+Math.PI)}else i.arc(f,d,m,0,pg);i.closePath()}else o=1;s=f,a=d,l=m}function c(f){var d,p=f.length,m,h=!1,g;for(i==null&&(i=g=KM()),d=0;d<=p;++d)!(d<p&&r(m=f[d],d,f))===h&&(h=!h)&&(o=0),h&&u(+e(m,d,f),+t(m,d,f),+n(m,d,f));if(g)return i=null,g+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function w$(e,t){return e??t}function _ce(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function S8t(e,t){return x8t.context(e)(t)}function E8t(e,t){let n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?y8t:b8t).curve(z8e(r,n.orient,n.tension)).context(e)(t)}function A8t(e,t){let n=t[0],r=n.interpolate||"linear";return v8t.curve(z8e(r,n.orient,n.tension)).context(e)(t)}function lI(e,t,n,r){return w8t.context(e)(t,n,r)}function T8t(e,t){return(t.mark.shape||t.shape).context(e)(t)}function k8t(e,t){return C8t.context(e)(t)}function I8t(e,t){return _8t.context(e)(t)}function Sce(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+D8t++),s=i.clipping[o]||(i.clipping[o]={id:o});return Gv(r)?s.path=r(null):_ce(n)?s.path=lI(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function gu(e){this.clear(),e&&this.union(e)}function b9(e){this.mark=e,this.bounds=this.bounds||new gu}function Ece(e){b9.call(this,e),this.items=this.items||[]}function w8e(e){e._pending+=1}function c$(e){e._pending-=1}function db(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){let r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?N8t(t,r):0))}return e}function N8t(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}function v9(e,t){return y9=e,t?(QS=t*g1,cce=dce=Math.cos(QS),X7=Math.sin(QS),fce=-X7):(cce=dce=1,QS=X7=fce=0),R8t}function S8e(e,t,n,r){let i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function E8e(e,t,n,r,i){let o=r-e+3*t-3*n,s=e+n-2*t,a=e-t,l=0,u=0,c;Math.abs(o)>j6t?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),l=(-s+c)/o,u=(-s-c)/o)):l=.5*a/s,0<l&&l<1&&i(A8e(l,e,t,n,r)),0<u&&u<1&&i(A8e(u,e,t,n,r))}function A8e(e,t,n,r,i){let o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}function V8e(e){return function(t,n){if(!h1)return!0;e(h1,t),pce.clear().union(t.bounds).intersect(n).round();let{x1:r,y1:i,x2:o,y2:s}=pce;for(let a=i;a<=s;++a)for(let l=r;l<=o;++l)if(h1.isPointInPath(l,a))return!0;return!1}}function W8e(e,t){return t.contains(e.x||0,e.y||0)}function G8e(e,t){let n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(pce.set(n,r,n+i,r+o))}function O8t(e,t){let n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return d$(t,n,r,i,o)}function d$(e,t,n,r,i){let{x1:o,y1:s,x2:a,y2:l}=e,u=r-t,c=i-n,f=0,d=1,p,m,h,g;for(g=0;g<4;++g){if(g===0&&(p=-u,m=-(o-t)),g===1&&(p=u,m=a-t),g===2&&(p=-c,m=-(s-n)),g===3&&(p=c,m=l-n),Math.abs(p)<1e-10&&m<0)return!1;if(h=m/p,p<0){if(h>d)return!1;h>f&&(f=h)}else if(p>0){if(h<f)return!1;h<d&&(d=h)}}return!0}function oI(e,t){e.globalCompositeOperation=t.blend||"source-over"}function cp(e,t){return e??t}function T8e(e,t){let n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function M8t(e,t,n){let r=n.width(),i=n.height(),o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+cp(t.x1,.5)*r,n.y1+cp(t.y1,.5)*i,Math.max(r,i)*cp(t.r1,0),n.x1+cp(t.x2,.5)*r,n.y1+cp(t.y2,.5)*i,Math.max(r,i)*cp(t.r2,.5));else{let s=cp(t.x1,0),a=cp(t.y1,0),l=cp(t.x2,1),u=cp(t.y2,0);if(s===l||a===u||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+l*r,n.y1+u*i);else{let c=uu(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=T8e(f.createLinearGradient(s,a,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return T8e(o,t.stops)}function q8e(e,t,n){return Cce(n)?M8t(e,n,t.bounds):n}function r9(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=q8e(e,t,t.fill),!0):!1}function sI(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=q8e(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||$8t),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function P8t(e,t){return e.zindex-t.zindex||e.index-t.index}function H8e(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(P8t)}function mg(e,t){var n=e.items,r,i;if(!n||!n.length)return;let o=H8e(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function mce(e,t){var n=e.items,r,i;if(!n||!n.length)return null;let o=H8e(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function Ace(e){return function(t,n,r){mg(n,i=>{(!r||r.intersects(i.bounds))&&Y8e(e,t,i,i)})}}function L8t(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&Y8e(e,t,n.items[0],n.items)}}function Y8e(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(oI(t,n),n.fill&&r9(t,n,i)&&t.fill(),n.stroke&&sI(t,n,i)&&t.stroke()))}function w9(e){return e=e||Dae,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,mce(n,a=>{let l=a.bounds;if(!(l&&!l.contains(o,s)||!l)&&e(t,a,r,i,o,s))return a})}}function S$(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,l=s.stroke&&n.isPointInStroke,u,c;return l&&(u=s.strokeWidth,c=s.strokeCap,n.lineWidth=u??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||l&&n.isPointInStroke(i,o)}}function Tce(e){return w9(S$(e))}function eE(e,t){return"translate("+e+","+t+")"}function kce(e){return"rotate("+e+")"}function B8t(e,t){return"scale("+e+","+t+")"}function K8e(e){return eE(e.x||0,e.y||0)}function z8t(e){return eE(e.x||0,e.y||0)+(e.angle?" "+kce(e.angle):"")}function U8t(e){return eE(e.x||0,e.y||0)+(e.angle?" "+kce(e.angle):"")+(e.scaleX||e.scaleY?" "+B8t(e.scaleX||1,e.scaleY||1):"")}function Ice(e,t,n){function r(s,a){s("transform",z8t(a)),s("d",t(null,a))}function i(s,a){return t(v9(s,a.angle),a),db(s,a).translate(a.x||0,a.y||0)}function o(s,a){var l=a.x||0,u=a.y||0,c=a.angle||0;s.translate(l,u),c&&s.rotate(c*=g1),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:Ace(o),pick:Tce(o),isect:n||V8e(o)}}function V8t(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function W8t(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function G8t(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function Dce(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(v9(l),c),db(l,c[0]))}function o(l,u){l.beginPath(),t(l,u)}let s=S$(o);function a(l,u,c,f,d,p){var m=u.items,h=u.bounds;return!m||!m.length||h&&!h.contains(d,p)?null:(c*=l.pixelRatio,f*=l.pixelRatio,s(l,m,c,f)?m[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:L8t(o),pick:a,isect:W8e,tip:n}}function H8t(e,t){var n=t.clip;e.save(),Gv(n)?(e.beginPath(),n(e),e.clip()):X8e(e,t.group)}function X8e(e,t){e.beginPath(),_ce(t)?lI(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Z8e(e){let t=cp(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Y8t(e,t){e("transform",K8e(t))}function Q8e(e,t){let n=Z8e(t);e("d",lI(null,t,n,n))}function K8t(e,t){e("class","background"),e("aria-hidden",!0),Q8e(e,t)}function X8t(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Q8e(e,t):e("d","")}function Z8t(e,t,n){let r=t.clip?Sce(n,t,t):null;e("clip-path",r)}function Q8t(e,t){if(!t.clip&&t.items){let n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),db(e,t),e.translate(t.x||0,t.y||0)}function x$(e,t,n,r){let i=Z8e(t);e.beginPath(),lI(e,t,(n||0)+i,(r||0)+i)}function nUt(e,t,n,r){mg(t,i=>{let o=i.x||0,s=i.y||0,a=i.strokeForeground,l=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&l&&(x$(e,i,o,s),oI(e,i),i.fill&&r9(e,i,l)&&e.fill(),i.stroke&&!a&&sI(e,i,l)&&e.stroke()),e.save(),e.translate(o,s),i.clip&&X8e(e,i),n&&n.translate(-o,-s),mg(i,u=>{(u.marktype==="group"||r==null||r.includes(u.marktype))&&this.draw(e,u,n,r)}),n&&n.translate(o,s),e.restore(),a&&i.stroke&&l&&(x$(e,i,o,s),oI(e,i),sI(e,i,l)&&e.stroke())})}function rUt(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;let s=n*e.pixelRatio,a=r*e.pixelRatio;return mce(t,l=>{let u,c,f,d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;let p=c+(l.width||0),m=f+(l.height||0),h=l.clip;if(h&&(i<c||i>p||o<f||o>m))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,h&&_ce(l)&&!tUt(e,l,s,a))return e.restore(),null;let g=l.strokeForeground,x=t.interactive!==!1;return x&&g&&l.stroke&&eUt(e,l,s,a)?(e.restore(),l):(u=mce(l,b=>iUt(b,c,f)?this.pick(b,n,r,c,f):null),!u&&x&&(l.fill||!g&&l.stroke)&&J8t(e,l,s,a)&&(u=l),e.restore(),u||null)})}function iUt(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}function Nce(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Fce(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Rce(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function C9(e,t){return e==="center"?t/2:e==="right"?t:0}function _9(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function sUt(e,t,n){let r=Nce(t,n),i=Fce(t,r),o=Rce(t,r),s=(t.x||0)-C9(t.align,i),a=(t.y||0)-_9(t.baseline,o),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,b$["xmlns:xlink"],"xlink:href"),e("transform",eE(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function aUt(e,t){let n=t.image,r=Fce(t,n),i=Rce(t,n),o=(t.x||0)-C9(t.align,r),s=(t.y||0)-_9(t.baseline,i);return e.set(o,s,o+r,s+i)}function lUt(e,t,n){mg(t,r=>{if(n&&!n.intersects(r.bounds))return;let i=Nce(r,this),o=Fce(r,i),s=Rce(r,i);if(o===0||s===0)return;let a=(r.x||0)-C9(r.align,o),l=(r.y||0)-_9(r.baseline,s),u,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,l+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(oI(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,l,o,s))})}function fUt(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",U8t(t)),e("d",t.path)}function Q7(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*g1,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=U8e(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),lce(e,l,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):lce(e,l,r,i,o,s)}function dUt(e,t){return Q7(v9(e,t.angle),t)?e.set(0,0,0,0):db(e,t,!0)}function mUt(e,t){e("d",lI(null,t))}function hUt(e,t){var n,r;return db(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function k8e(e,t){e.beginPath(),lI(e,t)}function xUt(e,t){e("transform",K8e(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function bUt(e,t){var n,r;return db(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function J8e(e,t,n){var r,i,o,s;return t.stroke&&sI(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function yUt(e,t,n){mg(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&J8e(e,r,i)&&(oI(e,r),e.stroke())}})}function vUt(e,t,n,r){return e.isPointInStroke?J8e(e,t,1)&&e.isPointInStroke(n,r):!1}function eUe(e){tE.width=e&&h1?Oce:i9}function i9(e,t){return tUe(x1(e,t),pb(e))}function tUe(e,t){return~~(.8*e.length*t)}function Oce(e,t){return pb(e)<=0||!(t=x1(e,t))?0:nUe(t,$ce(e))}function nUe(e,t){let n=`(${t}) ${e}`,r=I8e.get(n);return r===void 0&&(h1.font=t,r=h1.measureText(e).width,I8e.set(n,r)),r}function pb(e){return e.fontSize!=null?+e.fontSize||0:11}function nE(e){return e.lineHeight!=null?e.lineHeight:pb(e)+2}function SUt(e){return _l(e)?e.length>1?e:e[0]:e}function E$(e){return SUt(e.lineBreak&&e.text&&!_l(e.text)?e.text.split(e.lineBreak):e.text)}function Mce(e){let t=E$(e);return(_l(t)?t.length-1:0)*nE(e)}function x1(e,t){let n=t==null?"":(t+"").trim();return e.limit>0&&n.length?AUt(e,n):n}function EUt(e){if(tE.width===Oce){let t=$ce(e);return n=>nUe(n,t)}else if(tE.width===i9){let t=pb(e);return n=>tUe(n,t)}else return t=>tE.width(e,t)}function AUt(e,t){var n=+e.limit,r=EUt(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",o=e.dir==="rtl",s=0,a=t.length,l;if(n-=r(i),o){for(;s<a;)l=s+a>>>1,r(t.slice(l))>n?s=l+1:a=l;return i+t.slice(s)}else{for(;s<a;)l=1+(s+a>>>1),r(t.slice(0,l))<n?s=l:a=l-1;return t.slice(0,s)+i}}function S9(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function $ce(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pb(e)+"px "+S9(e,t)}function Pce(e){var t=e.baseline,n=pb(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*nE(e):t==="line-bottom"?.29*n-.5*nE(e):0)}function E9(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-KS,t+=r*Math.cos(i),n+=r*Math.sin(i)),m$.x1=t,m$.y1=n,m$}function kUt(e,t){var n=t.dx||0,r=(t.dy||0)+Pce(t),i=E9(t),o=i.x1,s=i.y1,a=t.angle||0,l;e("text-anchor",TUt[t.align]||"start"),a?(l=eE(o,s)+" "+kce(a),(n||r)&&(l+=" "+eE(n,r))):l=eE(o+n,s+r),e("transform",l)}function Lce(e,t,n){var r=tE.height(t),i=t.align,o=E9(t),s=o.x1,a=o.y1,l=t.dx||0,u=(t.dy||0)+Pce(t)-Math.round(.8*r),c=E$(t),f;if(_l(c)?(r+=nE(t)*(c.length-1),f=c.reduce((d,p)=>Math.max(d,tE.width(t,p)),0)):f=tE.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=s,u+=a,l+f,u+r),t.angle&&!n)e.rotate(t.angle*g1,s,a);else if(n===2)return e.rotatedPoints(t.angle*g1,s,a);return e}function IUt(e,t,n){mg(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=$ce(r),e.textAlign=r.align||"left",o=E9(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*g1),s=a=0),s+=r.dx||0,a+=(r.dy||0)+Pce(r),c=E$(r),oI(e,r),_l(c))for(u=nE(r),l=0;l<c.length;++l)f=x1(r,c[l]),r.fill&&r9(e,r,i)&&e.fillText(f,s,a),r.stroke&&sI(e,r,i)&&e.strokeText(f,s,a),a+=u;else f=x1(r,c),r.fill&&r9(e,r,i)&&e.fillText(f,s,a),r.stroke&&sI(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function DUt(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=E9(t),a=s.x1,l=s.y1,u=Lce(m$,t,1),c=-t.angle*g1,f=Math.cos(c),d=Math.sin(c),p=f*i-d*o+(a-f*a+d*l),m=d*i+f*o+(l-d*a-f*l);return u.contains(p,m)}function NUt(e,t){let n=Lce(m$,e,2);return d$(t,n[0],n[1],n[2],n[3])||d$(t,n[0],n[1],n[4],n[5])||d$(t,n[4],n[5],n[6],n[7])||d$(t,n[2],n[3],n[6],n[7])}function JS(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function rUe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function vs(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=JS(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function fp(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function iUe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function oUe(e,t){let n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function OUt(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=b1[i.marktype]).tip){for(s=oUe(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}function MUt(e,t,n,r){e.element().setAttribute("title",r||"")}function D8e(e,t){WUt(t).forEach(n=>GUt(e,n))}function GUt(e,t){let n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function p$(e,t,n){t.forEach(r=>e.fire(r,n))}function N8e(e,t,n){return function(r){let i=this._active,o=this.pickEvent(r);o===i?p$(this,e,r):((!i||!i.exit)&&p$(this,n,r),this._active=o,p$(this,t,r),p$(this,e,r))}}function F8e(e){return function(t){p$(this,e,t),this._active=null}}function qUt(){return typeof window<"u"&&window.devicePixelRatio||1}function HUt(e,t,n,r,i,o){let s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),l=s?qUt():i;e.width=t*l,e.height=n*l;for(let u in o)a[u]=o[u];return s&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function KUt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}function hUe(e,t){let n=t.aria===!1;if(e(dUe,n||void 0),n||t.description==null)for(let r in O8e)e(O8e[r],void 0);else{let r=t.mark.marktype;e(Bce,t.description),e(zce,t.ariaRole||(r==="group"?pUe:jce)),e(Uce,t.ariaRoleDescription||`${r} mark`)}}function gUe(e){return e.aria===!1?{[dUe]:!0}:XUt[e.role]?null:R8e[e.role]?QUt(e,R8e[e.role]):ZUt(e)}function ZUt(e){let t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return mUe(n?pUe:jce,`${t} mark container`,e.description)}function QUt(e,t){try{let n=e.items[0],r=t.caption||(()=>"");return mUe(t.role||jce,t.desc,n.description||r(n))}catch{return null}}function M8e(e){return Ok(e.text).join(" ")}function JUt(e){let t=e.datum,n=e.orient,r=t.title?xUe(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Jue(a)?"discrete":a} scale with ${ece(s,o,e)}`}function ejt(e){let t=e.datum,n=t.title?xUe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,l=s.dataflow.locale();return njt(r)+(n?` titled '${n}'`:"")+` for ${tjt(o)} with ${ece(l,a,e)}`}function xUe(e){try{return Ok(lu(e.items).items[0].text).join(" ")}catch{return null}}function tjt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+lu(e)}function njt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function yUe(){let e="",t="",n="",r=[],i=()=>t=n="",o=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},s=(l,u)=>(u!=null&&(t+=` ${l}="${rjt(u)}"`),a),a={open(l){o(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(let d of c)for(let p in d)s(p,d[p]);return a},close(){let l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),a},attr:s,text:l=>(n+=bUe(l),a),toString:()=>e};return a}function vUe(e,t){if(e.open(t.tagName),t.hasAttributes()){let n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){let n=t.childNodes;for(let r of n)r.nodeType===3?e.text(r.nodeValue):vUe(e,r)}return e.close()}function P8e(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function ojt(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=vs(e,n++,"pattern",Qo);m1(s,{id:n9+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=vs(s,0,"rect",Qo),m1(s,{width:1,height:1,fill:`url(${CUe()}#${t.id})`}),e=vs(e,n++,"radialGradient",Qo),m1(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=vs(e,n++,"linearGradient",Qo),m1(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=vs(e,r,"stop",Qo),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return fp(e,r),n}function sjt(e,t,n){let r;return e=vs(e,n,"clipPath",Qo),e.setAttribute("id",t.id),t.path?(r=vs(e,0,"path",Qo),r.setAttribute("d",t.path)):(r=vs(e,0,"rect",Qo),m1(r,{x:0,y:0,width:t.width,height:t.height})),fp(e,1),n+1}function ajt(e,t,n,r){t=t.lastChild.previousSibling;let i,o=0;mg(n,s=>{i=e.mark(t,s,i,r),++o}),fp(t,1+o)}function L8e(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=JS(s,r,Qo),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){let a=JS(s,"path",Qo);o.appendChild(a),a.__data__=e;let l=JS(s,"g",Qo);o.appendChild(l),l.__data__=e;let u=JS(s,"path",Qo);o.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(o.ownerSVGElement!==i||ljt(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function ljt(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}function g$(e,t,n){t!==Ta[e]&&(n?cjt(fb,e,t,n):Tl(fb,e,t),Ta[e]=t)}function t9(e,t,n){n!==Ta[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Ta[t]=n)}function m1(e,t){for(let n in t)Tl(e,n,t[n])}function Tl(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function cjt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function CUe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function fjt(e,t,n,r,i){let o;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=S9(t),e["font-size"]=pb(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(let s in p9){let a=t[s],l=p9[s];a==="transparent"&&(l==="fill"||l==="stroke")||a!=null&&(Cce(a)&&(a=B8e(a,i.gradient,"")),e[l]=a)}for(let s in m9){let a=t[s];a!=null&&(o=o||[],o.push(`${m9[s]}: ${a};`))}return o&&(e.style=o.join(" ")),e}function _Ue(e){let t=e.clip;if(Gv(t))t(v9(ace.clear()));else if(t)ace.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(ace)}var M6t,n9,x8e,$6t,P6t,L6t,B6t,z6t,g1,j6t,KS,pg,iI,tce,nce,j8e,Lf,y8e,v8e,rce,f1,C$,_$,e8t,t8t,n8t,r8t,i8t,o8t,s8t,a8t,l8t,u8t,c8t,f8t,d8t,p8t,m8t,h8t,x9,g8t,x8t,b8t,y8t,v8t,w8t,C8t,_8t,D8t,uce,F8t,y9,Y7,K7,QS,cce,X7,fce,dce,p1,Z7,C8e,_8e,XS,ZS,ice,oce,R8t,h1,pce,$8t,j8t,q8t,J8t,eUt,tUt,oUt,b$,uUt,cUt,pUt,gUt,wUt,CUt,_Ut,I8e,tE,TUt,m$,FUt,RUt,b1,o9,aI,$Ut,PUt,LUt,sUe,J7,aUe,hce,BUt,s9,e9,lUe,gce,zUt,uUe,a9,cUe,l9,UUt,jUt,fUe,u9,c9,f9,VUt,xce,h$,bce,d9,WUt,y$,YUt,yce,sce,dUe,Bce,zce,Uce,pUe,jce,mUe,XUt,R8e,O8e,bUe,rjt,ijt,p9,m9,wUe,f$,$8e,Qo,h9,fb,Ta,ujt,vce,d1,g9,wce,djt,pjt,mjt,hjt,gjt,v$,ace,SUe=w(()=>{"use strict";kS();Eze();$ae();Lk();j4e();g8e();M6t=0,n9="p_";x8e={basis:{curve:Uae},"basis-closed":{curve:jae},"basis-open":{curve:Vae},bundle:{curve:Wae,tension:"beta",value:.85},cardinal:{curve:Gae,tension:"tension",value:0},"cardinal-open":{curve:Yae,tension:"tension",value:0},"cardinal-closed":{curve:qae,tension:"tension",value:0},"catmull-rom":{curve:Xae,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Zae,tension:"alpha",value:.5},"catmull-rom-open":{curve:Qae,tension:"alpha",value:.5},linear:{curve:NS},"linear-closed":{curve:Jae},monotone:{horizontal:nle,vertical:tle},natural:{curve:rle},step:{curve:ile},"step-after":{curve:sle},"step-before":{curve:ole}};$6t={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},P6t=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,L6t=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,B6t=/^((\s+,?\s*)|(,\s*))/,z6t=/^[01]/;g1=Math.PI/180,j6t=1e-14,KS=Math.PI/2,pg=Math.PI*2,iI=Math.sqrt(3)/2,tce={},nce={},j8e=[].join;Lf=["l",0,0,0,0,0,0,0];y8e=.5773502691896257,v8e={circle:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,pg)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=iI*n,i=r-n*y8e,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=iI*n,i=r-n*y8e;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=iI*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=iI*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=iI*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=iI*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};rce={};f1=.448084975506;C$=e=>e.x||0,_$=e=>e.y||0,e8t=e=>e.width||0,t8t=e=>e.height||0,n8t=e=>(e.x||0)+(e.width||0),r8t=e=>(e.y||0)+(e.height||0),i8t=e=>e.startAngle||0,o8t=e=>e.endAngle||0,s8t=e=>e.padAngle||0,a8t=e=>e.innerRadius||0,l8t=e=>e.outerRadius||0,u8t=e=>e.cornerRadius||0,c8t=e=>w$(e.cornerRadiusTopLeft,e.cornerRadius)||0,f8t=e=>w$(e.cornerRadiusTopRight,e.cornerRadius)||0,d8t=e=>w$(e.cornerRadiusBottomRight,e.cornerRadius)||0,p8t=e=>w$(e.cornerRadiusBottomLeft,e.cornerRadius)||0,m8t=e=>w$(e.size,64),h8t=e=>e.size||1,x9=e=>e.defined!==!1,g8t=e=>q6t(e.shape||"circle"),x8t=Pae().startAngle(i8t).endAngle(o8t).padAngle(s8t).innerRadius(a8t).outerRadius(l8t).cornerRadius(u8t),b8t=Lj().x(C$).y1(_$).y0(r8t).defined(x9),y8t=Lj().y(_$).x1(C$).x0(n8t).defined(x9),v8t=ZM().x(C$).y(_$).defined(x9),w8t=Q6t().x(C$).y(_$).width(e8t).height(t8t).cornerRadius(c8t,f8t,d8t,p8t),C8t=Bj().type(g8t).size(m8t),_8t=J6t().x(C$).y(_$).defined(x9).size(h8t);D8t=1;gu.prototype={clone(){return new gu(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){let r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*r-l*i+u,l*r+a*i+c,a*r-l*s+u,l*r+a*s+c,a*o-l*i+u,l*o+a*i+c,a*o-l*s+u,l*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};tb(Ece,b9);uce=class{constructor(t){this._pending=0,this._loader=t||Yle()}pending(){return this._pending}sanitizeURL(t){let n=this;return w8e(n),n._loader.sanitize(t,{context:"href"}).then(r=>(c$(n),r)).catch(()=>(c$(n),null))}loadImage(t){let n=this,r=qj();return w8e(n),n._loader.sanitize(t,{context:"image"}).then(i=>{let o=i.href;if(!o||!r)throw{url:o};let s=new r,a=Nf(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>c$(n),s.onerror=()=>c$(n),s.src=o,s}).catch(i=>(c$(n),{complete:!1,width:0,height:0,src:i&&i.url||""}))}ready(){let t=this;return new Promise(n=>{function r(i){t.pending()?setTimeout(()=>{r(!0)},10):n(i)}r(!1)})}};F8t=pg-1e-8,p1=(e,t)=>y9.add(e,t),Z7=(e,t)=>p1(Y7=e,K7=t),C8e=e=>p1(e,y9.y1),_8e=e=>p1(y9.x1,e),XS=(e,t)=>cce*e+fce*t,ZS=(e,t)=>X7*e+dce*t,ice=(e,t)=>p1(XS(e,t),ZS(e,t)),oce=(e,t)=>Z7(XS(e,t),ZS(e,t));R8t={beginPath(){},closePath(){},moveTo:oce,lineTo:oce,rect(e,t,n,r){QS?(ice(e+n,t),ice(e+n,t+r),ice(e,t+r),oce(e,t)):(p1(e+n,t+r),Z7(e,t))},quadraticCurveTo(e,t,n,r){let i=XS(e,t),o=ZS(e,t),s=XS(n,r),a=ZS(n,r);S8e(Y7,i,s,C8e),S8e(K7,o,a,_8e),Z7(s,a)},bezierCurveTo(e,t,n,r,i,o){let s=XS(e,t),a=ZS(e,t),l=XS(n,r),u=ZS(n,r),c=XS(i,o),f=ZS(i,o);E8e(Y7,s,l,c,C8e),E8e(K7,a,u,f,_8e),Z7(c,f)},arc(e,t,n,r,i,o){if(r+=QS,i+=QS,Y7=n*Math.cos(i)+e,K7=n*Math.sin(i)+t,Math.abs(i-r)>F8t)p1(e-n,t-n),p1(e+n,t+n);else{let s=u=>p1(n*Math.cos(u)+e,n*Math.sin(u)+t),a,l;if(s(r),s(i),i!==r)if(r=r%pg,r<0&&(r+=pg),i=i%pg,i<0&&(i+=pg),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=pg,a=r-r%KS,l=0;l<4&&a>i;++l,a-=KS)s(a);else for(a=r-r%KS+KS,l=0;l<4&&a<i;++l,a=a+KS)s(a)}}};h1=(h1=uu(1,1))?h1.getContext("2d"):null,pce=new gu;$8t=[];j8t=Ice("arc",S8t);q8t=Dce("area",E8t,V8t);J8t=S$(x$),eUt=S$(x$,!1),tUt=S$(x$,!0);oUt={type:"group",tag:"g",nested:!1,attr:Y8t,bound:Q8t,draw:nUt,pick:rUt,isect:G8e,content:Z8t,background:K8t,foreground:X8t},b$={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};uUt={type:"image",tag:"image",nested:!1,attr:sUt,bound:aUt,draw:lUt,pick:w9(),isect:Dae,get:Nce,xOffset:C9,yOffset:_9},cUt=Dce("line",A8t,W8t);pUt={type:"path",tag:"path",nested:!1,attr:fUt,bound:dUt,draw:Ace(Q7),pick:Tce(Q7),isect:V8e(Q7)};gUt={type:"rect",tag:"path",nested:!1,attr:mUt,bound:hUt,draw:Ace(k8e),pick:Tce(k8e),isect:G8e};wUt={type:"rule",tag:"line",nested:!1,attr:xUt,bound:bUt,draw:yUt,pick:w9(vUt),isect:O8t},CUt=Ice("shape",T8t),_Ut=Ice("symbol",k8t,W8e),I8e=GBe(),tE={height:pb,measureWidth:Oce,estimateWidth:i9,width:i9,canvas:eUe};eUe(!0);TUt={left:"start",center:"middle",right:"end"},m$=new gu;FUt={type:"text",tag:"text",nested:!1,attr:kUt,bound:Lce,draw:IUt,pick:w9(DUt),isect:NUt},RUt=Dce("trail",I8t,G8t),b1={arc:j8t,area:q8t,group:oUt,image:uUt,line:cUt,path:pUt,rect:gUt,rule:wUt,shape:CUt,symbol:_Ut,text:FUt,trail:RUt};o9=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||Yle(),this._tooltip=n||MUt}initialize(t,n,r){return this._el=t,this._obj=r||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,r){for(let i=t?t.length:0;--i>=0;)if(t[i].type===n&&(!r||t[i].handler===r))return i;return-1}handlers(t){let n=this._handlers,r=[];if(t)r.push(...n[this.eventName(t)]);else for(let i in n)r.push(...n[i]);return r}eventName(t){let n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,r){this._loader.sanitize(r,{context:"href"}).then(i=>{let o=new MouseEvent(t.type,t),s=JS(null,"a");for(let a in i)s.setAttribute(a,i[a]);s.dispatchEvent(o)}).catch(()=>{})}handleTooltip(t,n,r){if(n&&n.tooltip!=null){n=OUt(n,t,this.canvas(),this._origin);let i=r&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,i)}}getItemBoundingClientRect(t){let n=this.canvas();if(!n)return;let r=n.getBoundingClientRect(),i=this._origin,o=t.bounds,s=o.width(),a=o.height(),l=o.x1+i[0]+r.left,u=o.y1+i[1]+r.top;for(;t.mark&&(t=t.mark.group);)l+=t.x||0,u+=t.y||0;return{x:l,y:u,width:s,height:a,left:l,top:u,right:l+s,bottom:u+a}}};aI=class{constructor(t){this._el=null,this._bgcolor=null,this._loader=new uce(t)}initialize(t,n,r,i,o){return this._el=t,this.resize(n,r,i,o)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,r,i){return this._width=t,this._height=n,this._origin=r||[0,0],this._scale=i||1,this}dirty(){}render(t,n){let r=this;return r._call=function(){r._render(t,n)},r._call(),r._call=null,r}_render(){}renderAsync(t,n){let r=this.render(t,n);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(t,n){var r=this,i=r._loader[t](n);if(!r._ready){let o=r._call;r._ready=r._loader.ready().then(s=>{s&&o(),r._ready=null})}return i}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}},$Ut="keydown",PUt="keypress",LUt="keyup",sUe="dragenter",J7="dragleave",aUe="dragover",hce="pointerdown",BUt="pointerup",s9="pointermove",e9="pointerout",lUe="pointerover",gce="mousedown",zUt="mouseup",uUe="mousemove",a9="mouseout",cUe="mouseover",l9="click",UUt="dblclick",jUt="wheel",fUe="mousewheel",u9="touchstart",c9="touchmove",f9="touchend",VUt=[$Ut,PUt,LUt,sUe,J7,aUe,hce,BUt,s9,e9,lUe,gce,zUt,uUe,a9,cUe,l9,UUt,jUt,fUe,u9,c9,f9],xce=s9,h$=a9,bce=l9,d9=class extends o9{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=VUt,this.pointermove=N8e([s9,uUe],[lUe,cUe],[e9,a9]),this.dragover=N8e([aUe],[sUe],[J7]),this.pointerout=F8e([e9,a9]),this.dragleave=F8e([J7])}initialize(t,n,r){return this._canvas=t&&rUe(t,"canvas"),[l9,gce,hce,s9,e9,J7].forEach(i=>D8e(this,i)),super.initialize(t,n,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(fUe,t)}pointerdown(t){this._down=this._active,this.fire(hce,t)}mousedown(t){this._down=this._active,this.fire(gce,t)}click(t){this._down===this._active&&(this.fire(l9,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(u9,t,!0)}touchmove(t){this.fire(c9,t,!0)}touchend(t){this.fire(f9,t,!0),this._touch=null}fire(t,n,r){let i=r?this._touch:this._active,o=this._handlers[t];if(n.vegaType=t,t===bce&&i&&i.href?this.handleHref(n,i,i.href):(t===xce||t===h$)&&this.handleTooltip(n,i,t!==h$),o)for(let s=0,a=o.length;s<a;++s)o[s].handler.call(this._obj,n,i)}on(t,n){let r=this.eventName(t),i=this._handlers;return this._handlerIndex(i[r],t,n)<0&&(D8e(this,t),(i[r]||(i[r]=[])).push({type:t,handler:n})),this}off(t,n){let r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&i.splice(o,1),this}pickEvent(t){let n=oUe(t,this._canvas),r=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-r[0],n[1]-r[1])}pick(t,n,r,i,o){let s=this.context();return b1[t.marktype].pick.call(this,s,t,n,r,i,o)}},WUt=e=>e===u9||e===c9||e===f9?[u9,c9,f9]:[e];y$=class extends aI{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new gu,this._tempb=new gu}initialize(t,n,r,i,o,s){return this._options=s||{},this._canvas=this._options.externalContext?null:uu(1,1,this._options.type),t&&this._canvas&&(fp(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,r,i,o)}resize(t,n,r,i){if(super.resize(t,n,r,i),this._canvas)HUt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{let o=this._options.externalContext;o||Ca("CanvasRenderer is missing a valid canvas or context"),o.scale(this._scale,this._scale),o.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){let n=this._tempb.clear().union(t.bounds),r=t.mark.group;for(;r;)n.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(n)}_render(t,n){let r=this.context(),i=this._origin,o=this._width,s=this._height,a=this._dirty,l=YUt(i,o,s);r.save();let u=this._redraw||a.empty()?(this._redraw=!1,l.expand(1)):KUt(r,l.intersect(a),i);return this.clear(-i[0],-i[1],o,s),this.draw(r,t,u,n),r.restore(),a.clear(),this}draw(t,n,r,i){if(n.marktype!=="group"&&i!=null&&!i.includes(n.marktype))return;let o=b1[n.marktype];n.clip&&H8t(t,n),o.draw.call(this,t,n,r,i),n.clip&&t.restore()}clear(t,n,r,i){let o=this._options,s=this.context();o.type!=="pdf"&&!o.externalContext&&s.clearRect(t,n,r,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(t,n,r,i))}},YUt=(e,t,n)=>new gu().set(0,0,t,n).translate(-e[0],-e[1]);yce=class extends o9{constructor(t,n){super(t,n);let r=this;r._hrefHandler=sce(r,(i,o)=>{o&&o.href&&r.handleHref(i,o,o.href)}),r._tooltipHandler=sce(r,(i,o)=>{r.handleTooltip(i,o,i.type!==h$)})}initialize(t,n,r){let i=this._svg;return i&&(i.removeEventListener(bce,this._hrefHandler),i.removeEventListener(xce,this._tooltipHandler),i.removeEventListener(h$,this._tooltipHandler)),this._svg=i=t&&rUe(t,"svg"),i&&(i.addEventListener(bce,this._hrefHandler),i.addEventListener(xce,this._tooltipHandler),i.addEventListener(h$,this._tooltipHandler)),super.initialize(t,n,r)}canvas(){return this._svg}on(t,n){let r=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[r],t,n)<0){let s={type:t,handler:n,listener:sce(this,n)};(i[r]||(i[r]=[])).push(s),this._svg&&this._svg.addEventListener(r,s.listener)}return this}off(t,n){let r=this.eventName(t),i=this._handlers[r],o=this._handlerIndex(i,t,n);return o>=0&&(this._svg&&this._svg.removeEventListener(r,i[o].listener),i.splice(o,1)),this}},sce=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)},dUe="aria-hidden",Bce="aria-label",zce="role",Uce="aria-roledescription",pUe="graphics-object",jce="graphics-symbol",mUe=(e,t,n)=>({[zce]:e,[Uce]:t,[Bce]:n||void 0}),XUt=qM(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),R8e={axis:{desc:"axis",caption:JUt},legend:{desc:"legend",caption:ejt},"title-text":{desc:"title",caption:e=>`Title text '${M8e(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${M8e(e)}'`}},O8e={ariaRole:zce,ariaRoleDescription:Uce,description:Bce};bUe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),rjt=e=>bUe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");ijt=e=>vUe(yUe(),e)+"";p9={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},m9={blend:"mix-blend-mode"},wUe={fill:"none","stroke-miterlimit":10},f$=0,$8e="http://www.w3.org/2000/xmlns/",Qo=b$.xmlns,h9=class extends aI{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,r,i,o){return this._defs={},this._clearDefs(),t&&(this._svg=vs(t,0,"svg",Qo),this._svg.setAttributeNS($8e,"xmlns",Qo),this._svg.setAttributeNS($8e,"xmlns:xlink",b$["xmlns:xlink"]),this._svg.setAttribute("version",b$.version),this._svg.setAttribute("class","marks"),fp(t,1),this._root=vs(this._svg,f$,"g",Qo),m1(this._root,wUe),fp(this._svg,f$+1)),this.background(this._bgcolor),super.initialize(t,n,r,i,o)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svg&&(m1(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){let t=this._svg,n=this._bgcolor;if(!t)return null;let r;n&&(t.removeAttribute("style"),r=vs(t,f$,"rect",Qo),m1(r,{width:this._width,height:this._height,fill:n}));let i=ijt(t);return n&&(t.removeChild(r),this._svg.style.setProperty("background-color",n)),i}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),fp(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;let t=this._dirty;if(!t.length||!this._dirtyID)return!0;let n=++this._dirtyID,r,i,o,s,a,l,u;for(a=0,l=t.length;a<l;++a)if(r=t[a],i=r.mark,i.marktype!==o&&(o=i.marktype,s=b1[o]),i.zdirty&&i.dirty!==n&&(this._dirtyAll=!1,P8e(r,n),i.items.forEach(c=>{c.dirty=n})),!i.zdirty){if(r.exit){s.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(s,u._svg,u)):r._svg&&(u=r._svg.parentNode,u&&u.removeChild(r._svg)),r._svg=null;continue}r=s.nested?i.items[0]:r,r._update!==n&&(!r._svg||!r._svg.ownerSVGElement?(this._dirtyAll=!1,P8e(r,n)):this._update(s,r._svg,r),r._update=n)}return!this._dirtyAll}mark(t,n,r,i){if(!this.isDirty(n))return n._svg;let o=this._svg,s=n.marktype,a=b1[s],l=n.interactive===!1?"none":null,u=a.tag==="g",c=L8e(n,t,r,"g",o);if(s!=="group"&&i!=null&&!i.includes(s))return fp(c,0),n._svg;c.setAttribute("class",iUe(n));let f=gUe(n);for(let h in f)Tl(c,h,f[h]);u||Tl(c,"pointer-events",l),Tl(c,"clip-path",n.clip?Sce(this,n,n.group):null);let d=null,p=0,m=h=>{let g=this.isDirty(h),x=L8e(h,c,d,a.tag,o);g&&(this._update(a,x,h),u&&ajt(this,x,h,i)),d=x,++p};return a.nested?n.items.length&&m(n.items[0]):mg(n,m),fp(c,p),c}_update(t,n,r){fb=n,Ta=n.__values__,hUe(g$,r),t.attr(g$,r,this);let i=ujt[t.type];i&&i.call(this,t,n,r),fb&&this.style(fb,r)}style(t,n){if(n!=null){for(let r in p9){let i=r==="font"?S9(n):n[r];if(i===Ta[r])continue;let o=p9[r];i==null?t.removeAttribute(o):(Cce(i)&&(i=B8e(i,this._defs.gradient,CUe())),t.setAttribute(o,i+"")),Ta[r]=i}for(let r in m9)t9(t,m9[r],n[r])}}defs(){let t=this._svg,n=this._defs,r=n.el,i=0;for(let o in n.gradient)r||(n.el=r=vs(t,f$+1,"defs",Qo)),i=ojt(r,n.gradient[o],i);for(let o in n.clipping)r||(n.el=r=vs(t,f$+1,"defs",Qo)),i=sjt(r,n.clipping[o],i);r&&(i===0?(t.removeChild(r),n.el=null):fp(r,i))}_clearDefs(){let t=this._defs;t.gradient={},t.clipping={}}};fb=null,Ta=null,ujt={group(e,t,n){let r=fb=t.childNodes[2];Ta=r.__values__,e.foreground(g$,n,this),Ta=t.__values__,fb=t.childNodes[1],e.content(g$,n,this);let i=fb=t.childNodes[0];e.background(g$,n,this);let o=n.mark.interactive===!1?"none":null;if(o!==Ta.events&&(Tl(r,"pointer-events",o),Tl(i,"pointer-events",o),Ta.events=o),n.strokeForeground&&n.stroke){let s=n.fill;Tl(r,"display",null),this.style(i,n),Tl(i,"stroke",null),s&&(n.fill=null),Ta=r.__values__,this.style(r,n),s&&(n.fill=s),fb=null}else Tl(r,"display","none")},image(e,t,n){n.smooth===!1?(t9(t,"image-rendering","optimizeSpeed"),t9(t,"image-rendering","pixelated")):t9(t,"image-rendering",null)},text(e,t,n){let r=E$(n),i,o,s,a;_l(r)?(o=r.map(l=>x1(n,l)),i=o.join(`
`),i!==Ta.text&&(fp(t,0),s=t.ownerDocument,a=nE(n),o.forEach((l,u)=>{let c=JS(s,"tspan",Qo);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Ta.text=i)):(o=x1(n,r),o!==Ta.text&&(t.textContent=o,Ta.text=o)),Tl(t,"font-family",S9(n)),Tl(t,"font-size",pb(n)+"px"),Tl(t,"font-style",n.fontStyle),Tl(t,"font-variant",n.fontVariant),Tl(t,"font-weight",n.fontWeight)}};vce=class extends aI{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){let n=yUe();n.open("svg",eb({},b$,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));let r=this._bgcolor;return r&&r!=="transparent"&&r!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:r}).close(),n.open("g",wUe,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){let r=b1[n.marktype],i=r.tag,o=[hUe,r.attr];t.open("g",{class:iUe(n),"clip-path":n.clip?Sce(this,n,n.group):null},gUe(n),{"pointer-events":i!=="g"&&n.interactive===!1?"none":null});let s=a=>{let l=this.href(a);if(l&&t.open("a",l),t.open(i,this.attr(n,a,o,i!=="g"?i:null)),i==="text"){let u=E$(a);if(_l(u)){let c={x:0,dy:nE(a)};for(let f=0;f<u.length;++f)t.open("tspan",f?c:null).text(x1(a,u[f])).close()}else t.text(x1(a,u))}else if(i==="g"){let u=a.strokeForeground,c=a.fill,f=a.stroke;u&&f&&(a.stroke=null),t.open("path",this.attr(n,a,r.background,"bgrect")).close(),t.open("g",this.attr(n,a,r.content)),mg(a,d=>this.mark(t,d)),t.close(),u&&f?(c&&(a.fill=null),a.stroke=f,t.open("path",this.attr(n,a,r.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,r.foreground,"bgfore")).close()}t.close(),l&&t.close()};return r.nested?n.items&&n.items.length&&s(n.items[0]):mg(n,s),t.close()}href(t){let n=t.href,r;if(n){if(r=this._hrefs&&this._hrefs[n])return r;this.sanitizeURL(n).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[n]=i})}return null}attr(t,n,r,i){let o={},s=(a,l,u,c)=>{o[c||a]=l};return Array.isArray(r)?r.forEach(a=>a(s,n,this)):r(s,n,this),i&&fjt(o,n,t,i,this._defs),o}defs(t){let n=this._defs.gradient,r=this._defs.clipping;if(Object.keys(n).length+Object.keys(r).length!==0){t.open("defs");for(let o in n){let s=n[o],a=s.stops;s.gradient==="radial"?(t.open("pattern",{id:n9+o,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+o+")"}).close(),t.close(),t.open("radialGradient",{id:o,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):t.open("linearGradient",{id:o,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let l=0;l<a.length;++l)t.open("stop",{offset:a[l].offset,"stop-color":a[l].color}).close();t.close()}for(let o in r){let s=r[o];t.open("clipPath",{id:o}),s.path?t.open("path",{d:s.path}).close():t.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),t.close()}t.close()}}};d1={svgMarkTypes:["text"],svgOnTop:!0,debug:!1},g9=class extends aI{constructor(t){super(t),this._svgRenderer=new h9(t),this._canvasRenderer=new y$(t)}initialize(t,n,r,i,o){this._root_el=vs(t,0,"div");let s=vs(this._root_el,0,"div"),a=vs(this._root_el,1,"div");return this._root_el.style.position="relative",d1.debug||(s.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=d1.svgOnTop?a:s,this._canvasEl=d1.svgOnTop?s:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,r,i,o),this._svgRenderer.initialize(this._svgEl,n,r,i,o),super.initialize(t,n,r,i,o)}dirty(t){return d1.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){let i=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(o=>!d1.svgMarkTypes.includes(o));this._svgRenderer.render(t,d1.svgMarkTypes),this._canvasRenderer.render(t,i)}resize(t,n,r,i){return super.resize(t,n,r,i),this._svgRenderer.resize(t,n,r,i),this._canvasRenderer.resize(t,n,r,i),this}background(t){return d1.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}},wce=class extends d9{constructor(t,n){super(t,n)}initialize(t,n,r){let i=vs(vs(t,0,"div"),d1.svgOnTop?0:1,"div");return super.initialize(i,n,r)}},djt="canvas",pjt="hybrid",mjt="png",hjt="svg",gjt="none",v$={};v$[djt]=v$[mjt]={renderer:y$,headless:y$,handler:d9};v$[hjt]={renderer:h9,headless:vce,handler:yce};v$[pjt]={renderer:g9,headless:g9,handler:wce};v$[gjt]={};ace=new gu});var Qce={};rn(Qce,{bound:()=>VUe,identifier:()=>Zce,mark:()=>WUe,overlap:()=>GUe,render:()=>HUe,viewlayout:()=>KUe});function VUe(e){ce.call(this,null,e)}function T9(e,t,n){return t(e.bounds.clear(),e,n)}function Zce(e){ce.call(this,0,e)}function kjt(e){return e._signals[EUe]||(e._signals[EUe]=e.add(0))}function WUe(e){ce.call(this,null,e)}function Ijt(e){let t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function GUe(e){ce.call(this,null,e)}function HUe(e){ce.call(this,null,e)}function cI(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Fjt(e){var t=e.items[0].orient;return t===dp||t===pp}function Rjt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Ojt(e,t,n,r){var i=t.items[0],o=i.datum,s=i.translate!=null?i.translate:.5,a=i.orient,l=Rjt(o),u=i.range,c=i.offset,f=i.position,d=i.minExtent,p=i.maxExtent,m=o.title&&i.items[l[2]].items[0],h=i.titlePadding,g=i.bounds,x=m&&Mce(m),b=0,y=0,v,C;switch(ka.clear().union(g),g.clear(),(v=l[0])>-1&&g.union(i.items[v].bounds),(v=l[1])>-1&&g.union(i.items[v].bounds),a){case fI:b=f||0,y=-c,C=Math.max(d,Math.min(p,-g.y1)),g.add(0,-C).add(u,0),m&&k9(e,m,C,h,x,0,-1,g);break;case dp:b=-c,y=f||0,C=Math.max(d,Math.min(p,-g.x1)),g.add(-C,0).add(0,u),m&&k9(e,m,C,h,x,1,-1,g);break;case pp:b=n+c,y=f||0,C=Math.max(d,Math.min(p,g.x2)),g.add(0,0).add(C,u),m&&k9(e,m,C,h,x,1,1,g);break;case w1:b=f||0,y=r+c,C=Math.max(d,Math.min(p,g.y2)),g.add(0,0).add(u,C),m&&k9(e,m,C,h,0,0,1,g);break;default:b=i.x,y=i.y}return db(g.translate(b,y),i),cI(i,"x",b+s)|cI(i,"y",y+s)&&(i.bounds=ka,e.dirty(i),i.bounds=g,e.dirty(i)),i.mark.bounds.clear().union(g)}function k9(e,t,n,r,i,o,s,a){let l=t.bounds;if(t.auto){let u=s*(n+i+r),c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=u):f=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-f)),e.dirty(t)}a.union(l)}function Mjt(e){var t=e.items,n=t.length,r=0,i,o;let s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],o=i.items,i.marktype===D9)switch(i.role){case qce:case Yce:case Hce:break;case OUe:s.rowheaders.push(...o);break;case MUe:s.rowfooters.push(...o);break;case PUe:s.colheaders.push(...o);break;case LUe:s.colfooters.push(...o);break;case $Ue:s.rowtitle=o[0];break;case BUe:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}function $jt(e){return new gu().set(0,0,e.width||0,e.height||0)}function Pjt(e){let t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Si(e,t,n){let r=Jx(e)?e[t]:e;return r??(n!==void 0?n:0)}function FUe(e){return e<0?Math.ceil(-e):0}function YUe(e,t,n){var r=!n.nodirty,i=n.bounds===Xce?$jt:Pjt,o=ka.set(0,0,0,0),s=Si(n.align,y1),a=Si(n.align,v1),l=Si(n.padding,y1),u=Si(n.padding,v1),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,p=Array(d),m=Array(c),h=0,g=Array(d),x=Array(f),b=0,y=Array(d),v=Array(d),C=Array(d),_,S,E,T,I,k,O,F,B,M,z;for(S=0;S<c;++S)m[S]=0;for(S=0;S<f;++S)x[S]=0;for(S=0;S<d;++S)k=t[S],I=C[S]=i(k),k.x=k.x||0,y[S]=0,k.y=k.y||0,v[S]=0,E=S%c,T=~~(S/c),h=Math.max(h,O=Math.ceil(I.x2)),b=Math.max(b,F=Math.ceil(I.y2)),m[E]=Math.max(m[E],O),x[T]=Math.max(x[T],F),p[S]=l+FUe(I.x1),g[S]=u+FUe(I.y1),r&&e.dirty(t[S]);for(S=0;S<d;++S)S%c===0&&(p[S]=0),S<c&&(g[S]=0);if(s===Wce)for(E=1;E<c;++E){for(z=0,S=E;S<d;S+=c)z<p[S]&&(z=p[S]);for(S=E;S<d;S+=c)p[S]=z+m[E-1]}else if(s===A9){for(z=0,S=0;S<d;++S)S%c&&z<p[S]&&(z=p[S]);for(S=0;S<d;++S)S%c&&(p[S]=z+h)}else for(s=!1,E=1;E<c;++E)for(S=E;S<d;S+=c)p[S]+=m[E-1];if(a===Wce)for(T=1;T<f;++T){for(z=0,S=T*c,_=S+c;S<_;++S)z<g[S]&&(z=g[S]);for(S=T*c;S<_;++S)g[S]=z+x[T-1]}else if(a===A9){for(z=0,S=c;S<d;++S)z<g[S]&&(z=g[S]);for(S=c;S<d;++S)g[S]=z+b}else for(a=!1,T=1;T<f;++T)for(S=T*c,_=S+c;S<_;++S)g[S]+=x[T-1];for(B=0,S=0;S<d;++S)B=p[S]+(S%c?B:0),y[S]+=B-t[S].x;for(E=0;E<c;++E)for(M=0,S=E;S<d;S+=c)M+=g[S],v[S]+=M-t[S].y;if(s&&Si(n.center,y1)&&f>1)for(S=0;S<d;++S)I=s===A9?h:m[S%c],B=I-C[S].x2-t[S].x-y[S],B>0&&(y[S]+=B/2);if(a&&Si(n.center,v1)&&c!==1)for(S=0;S<d;++S)I=a===A9?b:x[~~(S/c)],M=I-C[S].y2-t[S].y-v[S],M>0&&(v[S]+=M/2);for(S=0;S<d;++S)o.union(C[S].translate(y[S],v[S]));switch(B=Si(n.anchor,wjt),M=Si(n.anchor,Cjt),Si(n.anchor,y1)){case kl:B-=o.width();break;case Vce:B-=o.width()/2}switch(Si(n.anchor,v1)){case kl:M-=o.height();break;case Vce:M-=o.height()/2}for(B=Math.round(B),M=Math.round(M),o.clear(),S=0;S<d;++S)t[S].mark.bounds.clear();for(S=0;S<d;++S)k=t[S],k.x+=y[S]+=B,k.y+=v[S]+=M,o.union(k.mark.bounds.union(k.bounds.translate(y[S],v[S]))),r&&e.dirty(k);return o}function Ljt(e,t,n){var r=Mjt(t),i=r.marks,o=n.bounds===Xce?Bjt:zjt,s=n.offset,a=n.columns||i.length,l=a<=0?1:Math.ceil(i.length/a),u=l*a,c,f,d,p,m,h,g;let x=YUe(e,i,n);x.empty()&&x.set(0,0,0,0),r.rowheaders&&(h=Si(n.headerBand,v1,null),c=I9(e,r.rowheaders,i,a,l,-Si(s,"rowHeader"),DUe,0,o,"x1",0,a,1,h)),r.colheaders&&(h=Si(n.headerBand,y1,null),f=I9(e,r.colheaders,i,a,a,-Si(s,"columnHeader"),DUe,1,o,"y1",0,1,a,h)),r.rowfooters&&(h=Si(n.footerBand,v1,null),d=I9(e,r.rowfooters,i,a,l,Si(s,"rowFooter"),NUe,0,o,"x2",a-1,a,1,h)),r.colfooters&&(h=Si(n.footerBand,y1,null),p=I9(e,r.colfooters,i,a,a,Si(s,"columnFooter"),NUe,1,o,"y2",u-a,1,a,h)),r.rowtitle&&(m=Si(n.titleAnchor,v1),g=Si(s,"rowTitle"),g=m===kl?d+g:c-g,h=Si(n.titleBand,v1,.5),RUe(e,r.rowtitle,g,0,x,h)),r.coltitle&&(m=Si(n.titleAnchor,y1),g=Si(s,"columnTitle"),g=m===kl?p+g:f-g,h=Si(n.titleBand,y1,.5),RUe(e,r.coltitle,g,1,x,h))}function Bjt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function zjt(e,t){return e.bounds[t]}function I9(e,t,n,r,i,o,s,a,l,u,c,f,d,p){var m=n.length,h=0,g=0,x,b,y,v,C,_,S,E,T;if(!m)return h;for(x=c;x<m;x+=f)n[x]&&(h=s(h,l(n[x],u)));if(!t.length)return h;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),h+=o,b=0,v=t.length;b<v;++b)e.dirty(t[b]),t[b].mark.bounds.clear();for(x=c,b=0,v=t.length;b<v;++b,x+=f){for(_=t[b],C=_.mark.bounds,y=x;y>=0&&(S=n[y])==null;y-=d);a?(E=p==null?S.x:Math.round(S.bounds.x1+p*S.bounds.width()),T=h):(E=h,T=p==null?S.y:Math.round(S.bounds.y1+p*S.bounds.height())),C.union(_.bounds.translate(E-(_.x||0),T-(_.y||0))),_.x=E,_.y=T,e.dirty(_),g=s(g,C[u])}return g}function RUe(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function Ujt(e,t){let n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function jjt(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function Vjt(e,t,n,r,i,o,s){let a=Ujt(n,t),l=jjt(e,a("offset",0)),u=a("anchor",Gce),c=u===kl?1:u===Vce?.5:0,f={align:Wce,bounds:a("bounds",Xce),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case dp:f.anchor={x:Math.floor(r.x1)-l,column:kl,y:c*(s||r.height()+2*r.y1),row:u};break;case pp:f.anchor={x:Math.ceil(r.x2)+l,y:c*(s||r.height()+2*r.y1),row:u};break;case fI:f.anchor={y:Math.floor(i.y1)-l,row:kl,x:c*(o||i.width()+2*i.x1),column:u};break;case w1:f.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case xjt:f.anchor={x:l,y:l};break;case bjt:f.anchor={x:o-l,y:l,column:kl};break;case yjt:f.anchor={x:l,y:s-l,row:kl};break;case vjt:f.anchor={x:o-l,y:s-l,column:kl,row:kl};break}return f}function Wjt(e,t){var n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y,l,u;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),qjt(e,n,n.items[0].items[0]),o=Gjt(n,o),l=2*n.padding,u=2*n.padding,o.empty()||(l=Math.ceil(o.width()+l),u=Math.ceil(o.height()+u)),r.type===Ajt&&Hjt(n.items[0].items[0].items[0].items),i!==Kce&&(n.x=s=0,n.y=a=0),n.width=l,n.height=u,db(o.set(s,a,s+l,a+u),n),n.mark.bounds.clear().union(o),n}function Gjt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function qjt(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(!t.datum.title)(i||o)&&A$(e,n,i,o);else{var s=t.items[1].items[0],a=s.anchor,l=t.titlePadding||0,u=r-s.x,c=r-s.y;switch(s.orient){case dp:i+=Math.ceil(s.bounds.width())+l;break;case pp:case w1:break;default:o+=s.bounds.height()+l}switch((i||o)&&A$(e,n,i,o),s.orient){case dp:c+=uI(t,n,s,a,1,1);break;case pp:u+=uI(t,n,s,kl,0,0)+l,c+=uI(t,n,s,a,1,1);break;case w1:u+=uI(t,n,s,a,0,0),c+=uI(t,n,s,kl,-1,0,1)+l;break;default:u+=uI(t,n,s,a,0,0)}(u||c)&&A$(e,s,u,c),(u=Math.round(s.bounds.x1-r))<0&&(A$(e,n,-u,0),A$(e,s,-u,0))}}function uI(e,t,n,r,i,o,s){let a=e.datum.type!=="symbol",l=n.datum.vgrad,u=a&&(o||!l)&&!s?t.items[0]:t,c=u.bounds[i?"y2":"x2"]-e.padding,f=l&&o?c:0,d=l&&o?0:c,p=i<=0?0:Mce(n);return Math.round(r===Gce?f:r===kl?d-p:.5*(c-p))}function A$(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Hjt(e){let t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Yjt(e,t,n,r,i){var o=t.items[0],s=o.frame,a=o.orient,l=o.anchor,u=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],p=a===dp||a===pp?r:n,m=0,h=0,g=0,x=0,b=0,y;if(s!==D9?a===dp?(m=i.y2,p=i.y1):a===pp?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):a===dp&&(m=r,p=0),y=l===Gce?m:l===kl?p:(m+p)/2,d&&d.text){switch(a){case fI:case w1:b=f.bounds.height()+c;break;case dp:x=f.bounds.width()+c;break;case pp:x=-f.bounds.width()-c;break}ka.clear().union(d.bounds),ka.translate(x-(d.x||0),b-(d.y||0)),cI(d,"x",x)|cI(d,"y",b)&&(e.dirty(d),d.bounds.clear().union(ka),d.mark.bounds.clear().union(ka),e.dirty(d)),ka.clear().union(d.bounds)}else ka.clear();switch(ka.union(f.bounds),a){case fI:h=y,g=i.y1-ka.height()-u;break;case dp:h=i.x1-ka.width()-u,g=y;break;case pp:h=i.x2+ka.width()+u,g=y;break;case w1:h=y,g=i.y2+u;break;default:h=o.x,g=o.y}return cI(o,"x",h)|cI(o,"y",g)&&(ka.translate(h,g),e.dirty(o),o.bounds.clear().union(ka),t.bounds.clear().union(ka),e.dirty(o)),o.bounds}function KUe(e){ce.call(this,null,e)}function Kjt(e){return e&&e.mark.role!=="legend-entry"}function Xjt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=new gu().set(0,0,i,o),a=s.clone(),l=s.clone(),u=[],c,f,d,p,m,h;for(m=0,h=r.length;m<h;++m)switch(f=r[m],f.role){case qce:p=Fjt(f)?a:l,p.union(Ojt(e,f,i,o));break;case Hce:c=f;break;case Yce:u.push(Wjt(e,f));break;case _jt:case Sjt:case OUe:case MUe:case $Ue:case PUe:case LUe:case BUe:a.union(f.bounds),l.union(f.bounds);break;default:s.union(f.bounds)}if(u.length){let g={};u.forEach(x=>{d=x.orient||pp,d!==Kce&&(g[d]||(g[d]=[])).push(x)});for(let x in g){let b=g[x];YUe(e,b,Vjt(b,x,n.legends,a,l,i,o))}u.forEach(x=>{let b=x.bounds;if(b.equals(x._bounds)||(x.bounds=x._bounds,e.dirty(x),x.bounds=b,e.dirty(x)),n.autosize&&(n.autosize.type===zUe||n.autosize.type===UUe||n.autosize.type===jUe))switch(x.orient){case dp:case pp:s.add(b.x1,0).add(b.x2,0);break;case fI:case w1:s.add(0,b.y1).add(0,b.y2)}else s.union(b)})}s.union(a).union(l),c&&s.union(Yjt(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),Zjt(e,t,s,n)}function Zjt(e,t,n,r){let i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.x2-l)),p=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Ejt){let m=e.padding();s-=m.left+m.right,a-=m.top+m.bottom}o===Kce?(u=0,f=0,l=s,c=a):o===zUe?(l=Math.max(0,s-u-d),c=Math.max(0,a-f-p)):o===UUe?(l=Math.max(0,s-u-d),a=c+f+p):o===jUe?(s=l+u+d,c=Math.max(0,a-f-p)):o===Tjt&&(s=l+u+d,a=c+f+p),e._resizeView(s,a,l,c,[u,f],i.resize)}var fI,dp,pp,w1,xjt,bjt,yjt,vjt,Gce,Vce,kl,wjt,Cjt,D9,qce,Hce,_jt,Sjt,Yce,OUe,MUe,$Ue,PUe,LUe,BUe,Ejt,Ajt,zUe,UUe,jUe,Tjt,Kce,A9,Wce,Xce,y1,v1,EUe,AUe,qUe,TUe,Djt,Njt,kUe,IUe,ka,DUe,NUe,XUe=w(()=>{"use strict";hs();SUe();kS();fI="top",dp="left",pp="right",w1="bottom",xjt="top-left",bjt="top-right",yjt="bottom-left",vjt="bottom-right",Gce="start",Vce="middle",kl="end",wjt="x",Cjt="y",D9="group",qce="axis",Hce="title",_jt="frame",Sjt="scope",Yce="legend",OUe="row-header",MUe="row-footer",$Ue="row-title",PUe="column-header",LUe="column-footer",BUe="column-title",Ejt="padding",Ajt="symbol",zUe="fit",UUe="fit-x",jUe="fit-y",Tjt="pad",Kce="none",A9="all",Wce="each",Xce="flush",y1="column",v1="row";tb(VUe,ce,{transform(e,t){let n=t.dataflow,r=e.mark,i=r.marktype,o=b1[i],s=o.bound,a=r.bounds,l;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=T9(r,s),r.items.forEach(u=>{u.bounds.clear().union(a)});else if(i===D9||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),r.items.forEach(u=>a.union(T9(u,s))),r.role){case qce:case Yce:case Hce:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(T9(u,s))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(T9(u,s))}),l&&(a.clear(),r.items.forEach(u=>a.union(u.bounds)));return _Ue(r),t.modifies("bounds")}});EUe=":vega_identifier:";Zce.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};tb(Zce,ce,{transform(e,t){let n=kjt(t.dataflow),r=e.as,i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}});tb(WUe,ce,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Ijt(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);let r=n.marktype===D9?Ece:b9;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});AUe={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!qUe(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},qUe=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),TUe=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,o;n<r;i=o,++n)if(qUe(i,o=e[n].bounds,t))return!0},Djt=e=>{let t=e.bounds;return t.width()>1&&t.height()>1},Njt=(e,t,n)=>{var r=e.range(),i=new gu;return t===fI||t===w1?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)},kUe=e=>(e.forEach(t=>t.opacity=1),e),IUe=(e,t)=>e.reflow(t.modified()).modifies("opacity");tb(GUe,ce,{transform(e,t){let n=AUe[e.method]||AUe.parity,r=e.separation||0,i=t.materialize(t.SOURCE).source,o,s;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(kUe(i),t=IUe(t,e)),t;if(i=i.filter(Djt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=kUe(i),t=IUe(t,e),o.length>=3&&TUe(o,r)){do o=n(o,r);while(o.length>=3&&TUe(o,r));o.length<3&&!lu(i).opacity&&(o.length>1&&(lu(o).opacity=0),lu(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=Njt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(l=>{s(l)||(l.opacity=0)}));let a=o[0].mark.bounds.clear();return i.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}});tb(HUe,ce,{transform(e,t){let n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){let r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});ka=new gu;DUe=(e,t)=>Math.floor(Math.min(e,t)),NUe=(e,t)=>Math.ceil(Math.max(e,t));tb(KUe,ce,{transform(e,t){let n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Ljt(n,r,e.layout),Xjt(n,r,e)}),Kjt(e.mark.group)?t.reflow():t}})});function Do(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function hg(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var Dc=w(()=>{"use strict"});function pI(){var e=new Map,t=[],n=[],r=dI;function i(o){var s=o+"",a=e.get(s);if(!a){if(r!==dI)return r;e.set(s,a=t.push(o))}return n[(a-1)%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(let s of o){let a=s+"";e.has(a)||e.set(a,t.push(s))}return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return pI(t,n).unknown(r)},Do.apply(i,arguments),i}var dI,ZUe=w(()=>{"use strict";Dc();dI=Symbol("implicit")});function Jce(e){return function(){return e}}var QUe=w(()=>{"use strict"});function mI(e){return+e}var efe=w(()=>{"use strict"});function Zs(e){return e}function tfe(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Jce(isNaN(t)?NaN:.5)}function Qjt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Jjt(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=tfe(i,r),o=n(s,o)):(r=tfe(r,i),o=n(o,s)),function(a){return o(r(a))}}function e7t(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=tfe(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var l=ep(e,a,1,r)-1;return o[l](i[l](a))}}function gg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function rE(){var e=JUe,t=JUe,n=Ea,r,i,o,s=Zs,a,l,u;function c(){var d=Math.min(e.length,t.length);return s!==Zs&&(s=Qjt(e[0],e[d-1])),a=d>2?e7t:Jjt,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?o:(l||(l=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((u||(u=a(t,e.map(r),Aa)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,mI),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=fg,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Zs,c()):s!==Zs},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,p){return r=d,i=p,c()}}function T$(){return rE()(Zs,Zs)}var JUe,C1=w(()=>{"use strict";kr();YS();QUe();efe();JUe=[0,1]});function iE(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var N9=w(()=>{"use strict"});function xg(e){return e=iE(Math.abs(e)),e?e[1]:NaN}var k$=w(()=>{"use strict";N9()});function eje(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}var tje=w(()=>{"use strict"});function nje(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var rje=w(()=>{"use strict"});function Nc(e){return new nfe(e)}function nfe(e){if(!(t=t7t.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}var t7t,rfe=w(()=>{"use strict";t7t=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Nc.prototype=nfe.prototype;nfe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function ije(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var oje=w(()=>{"use strict"});function sje(e,t){var n=iE(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(ife=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+iE(e,Math.max(0,t+o-1))[0]}var ife,ofe=w(()=>{"use strict";N9()});function sfe(e,t){var n=iE(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var aje=w(()=>{"use strict";N9()});var afe,lje=w(()=>{"use strict";ofe();aje();afe={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return sfe(e*100,t)},r:sfe,s:sje,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}}});function lfe(e){return e}var uje=w(()=>{"use strict"});function F9(e){var t=e.grouping&&e.thousands?eje(e.grouping,e.thousands):lfe,n=e.currency,r=e.decimal,i=e.numerals?nje(e.numerals):lfe,o=e.percent||"%";function s(l){l=Nc(l);var u=l.fill,c=l.align,f=l.sign,d=l.symbol,p=l.zero,m=l.width,h=l.comma,g=l.precision,x=l.trim,b=l.type;b==="n"?(h=!0,b="g"):afe[b]||(g==null&&(g=12),x=!0,b="g"),(p||u==="0"&&c==="=")&&(p=!0,u="0",c="=");var y=d==="$"?n[0]:d==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",v=d==="$"?n[1]:/[%p]/.test(b)?o:"",C=afe[b],_=/[defgprs%]/.test(b);g=g==null?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function S(E){var T=y,I=v,k,O,F;if(b==="c")I=C(E)+I,E="";else{E=+E;var B=E<0;if(E=C(Math.abs(E),g),x&&(E=ije(E)),B&&+E==0&&(B=!1),T=(B?f==="("?f:"-":f==="-"||f==="("?"":f)+T,I=(b==="s"?cje[8+ife/3]:"")+I+(B&&f==="("?")":""),_){for(k=-1,O=E.length;++k<O;)if(F=E.charCodeAt(k),48>F||F>57){I=(F===46?r+E.slice(k+1):E.slice(k))+I,E=E.slice(0,k);break}}}h&&!p&&(E=t(E,1/0));var M=T.length+E.length+I.length,z=M<m?new Array(m-M+1).join(u):"";switch(h&&p&&(E=t(z+E,z.length?m-I.length:1/0),z=""),c){case"<":E=T+E+I+z;break;case"=":E=T+z+E+I;break;case"^":E=z.slice(0,M=z.length>>1)+T+E+I+z.slice(M);break;default:E=z+T+E+I;break}return i(E)}return S.toString=function(){return l+""},S}function a(l,u){var c=s((l=Nc(l),l.type="f",l)),f=Math.max(-8,Math.min(8,Math.floor(xg(u)/3)))*3,d=Math.pow(10,-f),p=cje[8+f/3];return function(m){return c(d*m)+p}}return{format:s,formatPrefix:a}}var cje,ufe=w(()=>{"use strict";k$();tje();rje();rfe();oje();lje();ofe();uje();cje=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function O9(e){return R9=F9(e),mp=R9.format,oE=R9.formatPrefix,R9}var R9,mp,oE,fje=w(()=>{"use strict";ufe();O9({decimal:".",thousands:",",grouping:[3],currency:["$",""]})});function hI(e){return Math.max(0,-xg(Math.abs(e)))}var dje=w(()=>{"use strict";k$()});function gI(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xg(t)/3)))*3-xg(Math.abs(e)))}var pje=w(()=>{"use strict";k$()});function xI(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,xg(t)-xg(e))+1}var mje=w(()=>{"use strict";k$()});var cfe={};rn(cfe,{format:()=>mp,formatDefaultLocale:()=>O9,formatLocale:()=>F9,formatPrefix:()=>oE,formatSpecifier:()=>Nc,precisionFixed:()=>hI,precisionPrefix:()=>gI,precisionRound:()=>xI});var sE=w(()=>{"use strict";fje();ufe();rfe();dje();pje();mje()});function bI(e,t,n,r){var i=bl(e,t,n),o;switch(r=Nc(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=gI(i,s))&&(r.precision=o),oE(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=xI(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=hI(i))&&(r.precision=o-(r.type==="%")*2);break}}return mp(r)}var ffe=w(()=>{"use strict";kr();sE()});function Fc(e){var t=e.domain;return e.ticks=function(n){var r=t();return _k(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return bI(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],l,u,c=10;for(a<s&&(u=s,s=a,a=u,u=i,i=o,o=u);c-- >0;){if(u=rj(s,a,n),u===l)return r[i]=s,r[o]=a,t(r);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;l=u}return e},e}function I$(){var e=T$();return e.copy=function(){return gg(e,I$())},Do.apply(e,arguments),Fc(e)}var _1=w(()=>{"use strict";kr();C1();Dc();ffe()});function D$(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,mI),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return D$(e).unknown(t)},e=arguments.length?Array.from(e,mI):[0,1],Fc(n)}var hje=w(()=>{"use strict";_1();efe()});function N$(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}var dfe=w(()=>{"use strict"});function gje(e){return Math.log(e)}function xje(e){return Math.exp(e)}function n7t(e){return-Math.log(-e)}function r7t(e){return-Math.exp(-e)}function i7t(e){return isFinite(e)?+("1e"+e):e<0?0:e}function o7t(e){return e===10?i7t:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function s7t(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function bje(e){return function(t){return-e(-t)}}function F$(e){var t=e(gje,xje),n=t.domain,r=10,i,o;function s(){return i=s7t(r),o=o7t(r),n()[0]<0?(i=bje(i),o=bje(o),e(n7t,r7t)):e(gje,xje),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=function(a){var l=n(),u=l[0],c=l[l.length-1],f;(f=c<u)&&(d=u,u=c,c=d);var d=i(u),p=i(c),m,h,g,x=a==null?10:+a,b=[];if(!(r%1)&&p-d<x){if(d=Math.floor(d),p=Math.ceil(p),u>0){for(;d<=p;++d)for(h=1,m=o(d);h<r;++h)if(g=m*h,!(g<u)){if(g>c)break;b.push(g)}}else for(;d<=p;++d)for(h=r-1,m=o(d);h>=1;--h)if(g=m*h,!(g<u)){if(g>c)break;b.push(g)}b.length*2<x&&(b=_k(u,c,x))}else b=_k(d,p,Math.min(p-d,x)).map(o);return f?b.reverse():b},t.tickFormat=function(a,l){if(l==null&&(l=r===10?".0e":","),typeof l!="function"&&(l=mp(l)),a===1/0)return l;a==null&&(a=10);var u=Math.max(1,r*a/t.ticks().length);return function(c){var f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=function(){return n(N$(n(),{floor:function(a){return o(Math.floor(i(a)))},ceil:function(a){return o(Math.ceil(i(a)))}}))},t}function R$(){var e=F$(rE()).domain([1,10]);return e.copy=function(){return gg(e,R$()).base(e.base())},Do.apply(e,arguments),e}var M9=w(()=>{"use strict";kr();sE();dfe();C1();Dc()});function yje(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vje(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function O$(e){var t=1,n=e(yje(t),vje(t));return n.constant=function(r){return arguments.length?e(yje(t=+r),vje(t)):t},Fc(n)}function M$(){var e=O$(rE());return e.copy=function(){return gg(e,M$()).constant(e.constant())},Do.apply(e,arguments)}var $9=w(()=>{"use strict";_1();C1();Dc()});function wje(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function a7t(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function l7t(e){return e<0?-e*e:e*e}function $$(e){var t=e(Zs,Zs),n=1;function r(){return n===1?e(Zs,Zs):n===.5?e(a7t,l7t):e(wje(n),wje(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Fc(t)}function yI(){var e=$$(rE());return e.copy=function(){return gg(e,yI()).exponent(e.exponent())},Do.apply(e,arguments),e}function pfe(){return yI.apply(null,arguments).exponent(.5)}var P9=w(()=>{"use strict";_1();C1();Dc()});function P$(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=TM(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[ep(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Af),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return P$().domain(e).range(t).unknown(r)},Do.apply(o,arguments)}var Cje=w(()=>{"use strict";kr();Dc()});function L$(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(l){return l!=null&&l<=l?i[ep(r,l,0,n)]:o}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},s.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,a()):i.slice()},s.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},s.unknown=function(l){return arguments.length&&(o=l),s},s.thresholds=function(){return r.slice()},s.copy=function(){return L$().domain([e,t]).range(i).unknown(o)},Do.apply(Fc(s),arguments)}var _je=w(()=>{"use strict";kr();_1();Dc()});function B$(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[ep(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return B$().domain(e).range(t).unknown(n)},Do.apply(i,arguments)}var Sje=w(()=>{"use strict";kr();Dc()});function mfe(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function hfe(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function z$(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function vI(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,u=U$(i),c=j$(i),f=U$(o),d=j$(o),p=U$(s),m=j$(s),h=U$(a),g=j$(a),x=U$(l),b=j$(l),y={a:W,A:H,b:Q,B:re,c:null,d:Dje,e:Dje,f:N7t,g:U7t,G:V7t,H:k7t,I:I7t,j:D7t,L:Mje,m:F7t,M:R7t,p:oe,q:me,Q:Rje,s:Oje,S:O7t,u:M7t,U:$7t,V:P7t,w:L7t,W:B7t,x:null,X:null,y:z7t,Y:j7t,Z:W7t,"%":Fje},v={a:ge,A:ye,b:ve,B:Ne,c:null,d:Nje,e:Nje,f:Y7t,g:i9t,G:s9t,H:G7t,I:q7t,j:H7t,L:Pje,m:K7t,M:X7t,p:Ge,q:nt,Q:Rje,s:Oje,S:Z7t,u:Q7t,U:J7t,V:e9t,w:t9t,W:n9t,x:null,X:null,y:r9t,Y:o9t,Z:a9t,"%":Fje},C={a:I,A:k,b:O,B:F,c:B,d:kje,e:kje,f:S7t,g:Tje,G:Aje,H:Ije,I:Ije,j:v7t,L:_7t,m:y7t,M:w7t,p:T,q:b7t,Q:A7t,s:T7t,S:C7t,u:p7t,U:m7t,V:h7t,w:d7t,W:g7t,x:M,X:z,y:Tje,Y:Aje,Z:x7t,"%":E7t};y.x=_(n,y),y.X=_(r,y),y.c=_(t,y),v.x=_(n,v),v.X=_(r,v),v.c=_(t,v);function _(Y,ie){return function(ue){var U=[],Ue=-1,ke=0,Xe=Y.length,Ye,Pt,yn;for(ue instanceof Date||(ue=new Date(+ue));++Ue<Xe;)Y.charCodeAt(Ue)===37&&(U.push(Y.slice(ke,Ue)),(Pt=Eje[Ye=Y.charAt(++Ue)])!=null?Ye=Y.charAt(++Ue):Pt=Ye==="e"?" ":"0",(yn=ie[Ye])&&(Ye=yn(ue,Pt)),U.push(Ye),ke=Ue+1);return U.push(Y.slice(ke,Ue)),U.join("")}}function S(Y,ie){return function(ue){var U=z$(1900,void 0,1),Ue=E(U,Y,ue+="",0),ke,Xe;if(Ue!=ue.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(ie&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(ke=hfe(z$(U.y,0,1)),Xe=ke.getUTCDay(),ke=Xe>4||Xe===0?Dk.ceil(ke):Dk(ke),ke=wc.offset(ke,(U.V-1)*7),U.y=ke.getUTCFullYear(),U.m=ke.getUTCMonth(),U.d=ke.getUTCDate()+(U.w+6)%7):(ke=mfe(z$(U.y,0,1)),Xe=ke.getDay(),ke=Xe>4||Xe===0?Ik.ceil(ke):Ik(ke),ke=yc.offset(ke,(U.V-1)*7),U.y=ke.getFullYear(),U.m=ke.getMonth(),U.d=ke.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),Xe="Z"in U?hfe(z$(U.y,0,1)).getUTCDay():mfe(z$(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(Xe+5)%7:U.w+U.U*7-(Xe+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,hfe(U)):mfe(U)}}function E(Y,ie,ue,U){for(var Ue=0,ke=ie.length,Xe=ue.length,Ye,Pt;Ue<ke;){if(U>=Xe)return-1;if(Ye=ie.charCodeAt(Ue++),Ye===37){if(Ye=ie.charAt(Ue++),Pt=C[Ye in Eje?ie.charAt(Ue++):Ye],!Pt||(U=Pt(Y,ue,U))<0)return-1}else if(Ye!=ue.charCodeAt(U++))return-1}return U}function T(Y,ie,ue){var U=u.exec(ie.slice(ue));return U?(Y.p=c.get(U[0].toLowerCase()),ue+U[0].length):-1}function I(Y,ie,ue){var U=p.exec(ie.slice(ue));return U?(Y.w=m.get(U[0].toLowerCase()),ue+U[0].length):-1}function k(Y,ie,ue){var U=f.exec(ie.slice(ue));return U?(Y.w=d.get(U[0].toLowerCase()),ue+U[0].length):-1}function O(Y,ie,ue){var U=x.exec(ie.slice(ue));return U?(Y.m=b.get(U[0].toLowerCase()),ue+U[0].length):-1}function F(Y,ie,ue){var U=h.exec(ie.slice(ue));return U?(Y.m=g.get(U[0].toLowerCase()),ue+U[0].length):-1}function B(Y,ie,ue){return E(Y,t,ie,ue)}function M(Y,ie,ue){return E(Y,n,ie,ue)}function z(Y,ie,ue){return E(Y,r,ie,ue)}function W(Y){return s[Y.getDay()]}function H(Y){return o[Y.getDay()]}function Q(Y){return l[Y.getMonth()]}function re(Y){return a[Y.getMonth()]}function oe(Y){return i[+(Y.getHours()>=12)]}function me(Y){return 1+~~(Y.getMonth()/3)}function ge(Y){return s[Y.getUTCDay()]}function ye(Y){return o[Y.getUTCDay()]}function ve(Y){return l[Y.getUTCMonth()]}function Ne(Y){return a[Y.getUTCMonth()]}function Ge(Y){return i[+(Y.getUTCHours()>=12)]}function nt(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ie=_(Y+="",y);return ie.toString=function(){return Y},ie},parse:function(Y){var ie=S(Y+="",!1);return ie.toString=function(){return Y},ie},utcFormat:function(Y){var ie=_(Y+="",v);return ie.toString=function(){return Y},ie},utcParse:function(Y){var ie=S(Y+="",!0);return ie.toString=function(){return Y},ie}}}function Zn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function f7t(e){return e.replace(c7t,"\\$&")}function U$(e){return new RegExp("^(?:"+e.map(f7t).join("|")+")","i")}function j$(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function d7t(e,t,n){var r=ws.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function p7t(e,t,n){var r=ws.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function m7t(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function h7t(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function g7t(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Aje(e,t,n){var r=ws.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Tje(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function x7t(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function b7t(e,t,n){var r=ws.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function y7t(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function kje(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function v7t(e,t,n){var r=ws.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ije(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function w7t(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function C7t(e,t,n){var r=ws.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function _7t(e,t,n){var r=ws.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function S7t(e,t,n){var r=ws.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function E7t(e,t,n){var r=u7t.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function A7t(e,t,n){var r=ws.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function T7t(e,t,n){var r=ws.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Dje(e,t){return Zn(e.getDate(),t,2)}function k7t(e,t){return Zn(e.getHours(),t,2)}function I7t(e,t){return Zn(e.getHours()%12||12,t,2)}function D7t(e,t){return Zn(1+yc.count(vc(e),e),t,3)}function Mje(e,t){return Zn(e.getMilliseconds(),t,3)}function N7t(e,t){return Mje(e,t)+"000"}function F7t(e,t){return Zn(e.getMonth()+1,t,2)}function R7t(e,t){return Zn(e.getMinutes(),t,2)}function O7t(e,t){return Zn(e.getSeconds(),t,2)}function M7t(e){var t=e.getDay();return t===0?7:t}function $7t(e,t){return Zn(kf.count(vc(e)-1,e),t,2)}function $je(e){var t=e.getDay();return t>=4||t===0?zv(e):zv.ceil(e)}function P7t(e,t){return e=$je(e),Zn(zv.count(vc(e),e)+(vc(e).getDay()===4),t,2)}function L7t(e){return e.getDay()}function B7t(e,t){return Zn(Ik.count(vc(e)-1,e),t,2)}function z7t(e,t){return Zn(e.getFullYear()%100,t,2)}function U7t(e,t){return e=$je(e),Zn(e.getFullYear()%100,t,2)}function j7t(e,t){return Zn(e.getFullYear()%1e4,t,4)}function V7t(e,t){var n=e.getDay();return e=n>=4||n===0?zv(e):zv.ceil(e),Zn(e.getFullYear()%1e4,t,4)}function W7t(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Zn(t/60|0,"0",2)+Zn(t%60,"0",2)}function Nje(e,t){return Zn(e.getUTCDate(),t,2)}function G7t(e,t){return Zn(e.getUTCHours(),t,2)}function q7t(e,t){return Zn(e.getUTCHours()%12||12,t,2)}function H7t(e,t){return Zn(1+wc.count(Cc(e),e),t,3)}function Pje(e,t){return Zn(e.getUTCMilliseconds(),t,3)}function Y7t(e,t){return Pje(e,t)+"000"}function K7t(e,t){return Zn(e.getUTCMonth()+1,t,2)}function X7t(e,t){return Zn(e.getUTCMinutes(),t,2)}function Z7t(e,t){return Zn(e.getUTCSeconds(),t,2)}function Q7t(e){var t=e.getUTCDay();return t===0?7:t}function J7t(e,t){return Zn(If.count(Cc(e)-1,e),t,2)}function Lje(e){var t=e.getUTCDay();return t>=4||t===0?jv(e):jv.ceil(e)}function e9t(e,t){return e=Lje(e),Zn(jv.count(Cc(e),e)+(Cc(e).getUTCDay()===4),t,2)}function t9t(e){return e.getUTCDay()}function n9t(e,t){return Zn(Dk.count(Cc(e)-1,e),t,2)}function r9t(e,t){return Zn(e.getUTCFullYear()%100,t,2)}function i9t(e,t){return e=Lje(e),Zn(e.getUTCFullYear()%100,t,2)}function o9t(e,t){return Zn(e.getUTCFullYear()%1e4,t,4)}function s9t(e,t){var n=e.getUTCDay();return e=n>=4||n===0?jv(e):jv.ceil(e),Zn(e.getUTCFullYear()%1e4,t,4)}function a9t(){return"+0000"}function Fje(){return"%"}function Rje(e){return+e}function Oje(e){return Math.floor(+e/1e3)}var Eje,ws,u7t,c7t,gfe=w(()=>{"use strict";MM();Eje={"-":"",_:" ",0:"0"},ws=/^\s*\d+/,u7t=/^%/,c7t=/[\\^$*+?|[\]().{}]/g});function xfe(e){return wI=vI(e),S1=wI.format,L9=wI.parse,E1=wI.utcFormat,B9=wI.utcParse,wI}var wI,S1,L9,E1,B9,Bje=w(()=>{"use strict";gfe();xfe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})});var CI=w(()=>{"use strict";Bje();gfe()});function l9t(e){return new Date(e)}function u9t(e){return e instanceof Date?+e:+new Date(+e)}function z9(e,t,n,r,i,o,s,a,l,u){var c=T$(),f=c.invert,d=c.domain,p=u(".%L"),m=u(":%S"),h=u("%I:%M"),g=u("%I %p"),x=u("%a %d"),b=u("%b %d"),y=u("%B"),v=u("%Y");function C(_){return(l(_)<_?p:a(_)<_?m:s(_)<_?h:o(_)<_?g:r(_)<_?i(_)<_?x:b:n(_)<_?y:v)(_)}return c.invert=function(_){return new Date(f(_))},c.domain=function(_){return arguments.length?d(Array.from(_,u9t)):d().map(l9t)},c.ticks=function(_){var S=d();return e(S[0],S[S.length-1],_??10)},c.tickFormat=function(_,S){return S==null?C:u(S)},c.nice=function(_){var S=d();return(!_||typeof _.range!="function")&&(_=t(S[0],S[S.length-1],_??10)),_?d(N$(S,_)):c},c.copy=function(){return gg(c,z9(e,t,n,r,i,o,s,a,l,u))},c}function U9(){return Do.apply(z9(Rse,Ose,vc,Uv,kf,yc,CS,vS,vl,S1).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var bfe=w(()=>{"use strict";MM();CI();C1();Dc();dfe()});function j9(){return Do.apply(z9(Nse,Fse,Cc,Vv,If,wc,ES,SS,vl,E1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}var zje=w(()=>{"use strict";MM();CI();bfe();Dc()});function V9(){var e=0,t=1,n,r,i,o,s=Zs,a=!1,l;function u(f){return f==null||isNaN(f=+f)?l:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(a=!!f,u):a},u.interpolator=function(f){return arguments.length?(s=f,u):s};function c(f){return function(d){var p,m;return arguments.length?([p,m]=d,s=f(p,m),u):[s(0),s(1)]}}return u.range=c(Ea),u.rangeRound=c(fg),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function mb(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function _I(){var e=Fc(V9()(Zs));return e.copy=function(){return mb(e,_I())},hg.apply(e,arguments)}function W9(){var e=F$(V9()).domain([1,10]);return e.copy=function(){return mb(e,W9()).base(e.base())},hg.apply(e,arguments)}function G9(){var e=O$(V9());return e.copy=function(){return mb(e,G9()).constant(e.constant())},hg.apply(e,arguments)}function V$(){var e=$$(V9());return e.copy=function(){return mb(e,V$()).exponent(e.exponent())},hg.apply(e,arguments)}function yfe(){return V$.apply(null,arguments).exponent(.5)}var vfe=w(()=>{"use strict";YS();C1();Dc();_1();M9();$9();P9()});function q9(){var e=0,t=.5,n=1,r=1,i,o,s,a,l,u=Zs,c,f=!1,d;function p(h){return isNaN(h=+h)?d:(h=.5+((h=+c(h))-o)*(r*h<r*o?a:l),u(f?Math.max(0,Math.min(1,h)):h))}p.domain=function(h){return arguments.length?([e,t,n]=h,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,p):[e,t,n]},p.clamp=function(h){return arguments.length?(f=!!h,p):f},p.interpolator=function(h){return arguments.length?(u=h,p):u};function m(h){return function(g){var x,b,y;return arguments.length?([x,b,y]=g,u=HS(h,[x,b,y]),p):[u(0),u(.5),u(1)]}}return p.range=m(Ea),p.rangeRound=m(fg),p.unknown=function(h){return arguments.length?(d=h,p):d},function(h){return c=h,i=h(e),o=h(t),s=h(n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,p}}function W$(){var e=Fc(q9()(Zs));return e.copy=function(){return mb(e,W$())},hg.apply(e,arguments)}function H9(){var e=F$(q9()).domain([.1,1,10]);return e.copy=function(){return mb(e,H9()).base(e.base())},hg.apply(e,arguments)}function Y9(){var e=O$(q9());return e.copy=function(){return mb(e,Y9()).constant(e.constant())},hg.apply(e,arguments)}function G$(){var e=$$(q9());return e.copy=function(){return mb(e,G$()).exponent(e.exponent())},hg.apply(e,arguments)}function wfe(){return G$.apply(null,arguments).exponent(.5)}var Uje=w(()=>{"use strict";YS();C1();Dc();_1();M9();vfe();$9();P9()});var Cfe=w(()=>{"use strict";hje();_1();M9();$9();ZUe();P9();Cje();_je();Sje();bfe();zje();vfe();Uje();ffe()});function q$(e,t,n){let r=e-t+n*2;return e?r>0?r:1:0}function f9t(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function d9t(e){return function(t){let n=e.range(),r=t[0],i=t[1],o=-1,s,a,l,u;for(i<r&&(a=r,r=i,i=a),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(o<0&&(o=l),s=l);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function Afe(){let e=pI().unknown(void 0),t=e.domain,n=e.range,r=[0,1],i,o,s=!1,a=0,l=0,u=.5;delete e.unknown;function c(){let f=t().length,d=r[1]<r[0],p=r[1-d],m=q$(f,a,l),h=r[d-0];i=(p-h)/(m||1),s&&(i=Math.floor(i)),h+=(p-h-i*(f-a))*u,o=i*(1-a),s&&(h=Math.round(h),o=Math.round(o));let g=Eo(f).map(x=>h+i*x);return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),a=l,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;let d=r[1]<r[0],p=d?n().reverse():n(),m=p.length-1,h=+f[0],g=+f[1],x,b,y;if(!(h!==h||g!==g)&&(g<h&&(y=h,h=g,g=y),!(g<p[0]||h>r[1-d])))return x=Math.max(0,gS(p,h)-1),b=h===g?x:gS(p,g)-1,h-p[x]>o+1e-10&&++x,d&&(y=x,x=m-b,b=m-y),x>b?void 0:t().slice(x,b+1)},e.invert=function(f){let d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return Afe().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(l).align(u)},c()}function Gje(e){let t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Gje(t())},e}function p9t(){return Gje(Afe().paddingInner(1))}function h9t(e){return m9t.call(e,qd)}function qje(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(ep(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=h9t(r),n):e.slice()},n.range=function(r){return arguments.length?(t=g9t.call(r),n):t.slice()},n.tickFormat=function(r,i){return bI(e[0],Fn(e),r??10,i)},n.copy=function(){return qje().domain(n.domain()).range(n.range())},n}function x9t(e,t,n){let r=function(){let o=t();return o.invertRange||(o.invertRange=o.invert?f9t(o):o.invertExtent?d9t(o):void 0),o.type=e,o};return r.metadata=wa(Rt(n)),r}function On(e,t,n){return arguments.length>1?(K9[e]=x9t(e,t,n),this):Tfe(e)?K9[e]:void 0}function Tfe(e){return Dt(K9,e)}function cE(e,t){let n=K9[e];return n&&n.metadata[t]}function Q$(e){return cE(e,Jo)}function k1(e){return cE(e,X$)}function J9(e){return cE(e,Z$)}function kfe(e){return cE(e,bg)}function b9t(e){return cE(e,Efe)}function Ife(e){return cE(e,Bf)}function Dfe(e){return cE(e,aE)}function eV(e,t){let n=t[0],r=Fn(t)-n;return function(i){return e(n+i*r)}}function AI(e,t,n){return HS(J$(t||"rgb",n),e)}function tV(e,t){let n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function nV(e,t,n){let r=n-t,i,o,s;return!r||!Number.isFinite(r)?ps(.5):(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=On(o)().domain([t,n]).range([0,1]),y9t.forEach(a=>e[a]?s[a](e[a]()):0),s)}function J$(e,t){let n=Vue[v9t(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function v9t(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Hje(e){let t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function Yje(e,t){for(let n in e)eP(n,t(e[n]))}function eP(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(jje[e]=t,this):jje[e]}function rV(e,t,n){let r;return zh(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(sS(e.domain())/n||1)))),tn(t)&&(r=t.step,t=t.interval),zn(t)&&(t=e.type===A1?Zx(t):e.type==T1?Qx(t):Se("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function Nfe(e,t,n){let r=e.range(),i=r[0],o=Fn(r),s=E9t;if(i>o&&(r=o,o=i,i=r,s=A9t),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){let a=[t[0],Fn(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function iV(e,t){return e.bins?Nfe(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Ffe(e,t,n,r,i,o){let s=t.type,a=S9t;if(s===A1||i===A1)a=e.timeFormat(r);else if(s===T1||i===T1)a=e.utcFormat(r);else if(kfe(s)){let l=e.formatFloat(r);if(o||t.bins)a=l;else{let u=Xje(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){let l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(a=e.format(r));return a}function Xje(e,t,n){let r=iV(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/o));return u*i<i-.5&&(u*=i),u<=s};return n?r.filter(a):a}function Rfe(e,t){return e.bins?I9t(e.bins):e.type===bg?Xje(e,t,!0):_fe[e.type]?k9t(e[_fe[e.type]]()):iV(e,t)}function T9t(e,t,n){let r=t[Zje[t.type]](),i=r.length,o=i>1?r[1]-r[0]:r[0],s;for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,3*10,n)}function k9t(e){let t=[-1/0].concat(e);return t.max=1/0,t}function I9t(e){let t=e.slice(0,-1);return t.max=Fn(e),t}function Ofe(e,t,n,r,i,o,s){let a=Zje[t.type]&&o!==A1&&o!==T1?T9t(e,t,i):Ffe(e,t,n,i,o,s);return r===tP&&D9t(t)?N9t(a):r===_9t?F9t(a):R9t(a)}function Qje(e){let t=e.domain(),n=t.length-1,r=+t[0],i=+Fn(t),o=i-r;if(e.type===K$){let s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}function O9t(e,t,n,r){let i=r||t.type;return zn(n)&&b9t(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===A1?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===T1?e.utcFormat("%A, %d %B %Y, %X UTC"):Ofe(e,t,5,null,n,r,!0)}function Mfe(e,t,n){n=n||{};let r=Math.max(3,n.maxlen||7),i=O9t(e,t,n.format,n.formatType);if(J9(t.type)){let o=Rfe(t).slice(1).map(i),s=o.length;return"".concat(s," boundar").concat(s===1?"y":"ies",": ").concat(o.join(", "))}else if(k1(t.type)){let o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return"".concat(s," value").concat(s===1?"":"s",": ").concat(a)}else{let o=t.domain();return"values from ".concat(i(o[0])," to ").concat(i(Fn(o)))}}var c9t,lE,bg,SI,EI,H$,A1,T1,hp,uE,aE,Y$,K$,X9,Z9,Sfe,Q9,Jo,X$,Z$,Bf,Efe,m9t,g9t,K9,y9t,w9t,C9t,jje,tP,_9t,Kje,S9t,E9t,A9t,_fe,Zje,D9t,N9t,Vje,F9t,R9t,Wje,TI=w(()=>{"use strict";ao();kr();Cfe();Cfe();YS();YS();Fk();c9t="identity",lE="linear",bg="log",SI="pow",EI="sqrt",H$="symlog",A1="time",T1="utc",hp="sequential",uE="diverging",aE="quantile",Y$="quantize",K$="threshold",X9="ordinal",Z9="point",Sfe="band",Q9="bin-ordinal",Jo="continuous",X$="discrete",Z$="discretizing",Bf="interpolating",Efe="temporal";m9t=Array.prototype.map;g9t=Array.prototype.slice;K9={};On(c9t,D$);On(lE,I$,Jo);On(bg,R$,[Jo,bg]);On(SI,yI,Jo);On(EI,pfe,Jo);On(H$,M$,Jo);On(A1,U9,[Jo,Efe]);On(T1,j9,[Jo,Efe]);On(hp,_I,[Jo,Bf]);On("".concat(hp,"-").concat(lE),_I,[Jo,Bf]);On("".concat(hp,"-").concat(bg),W9,[Jo,Bf,bg]);On("".concat(hp,"-").concat(SI),V$,[Jo,Bf]);On("".concat(hp,"-").concat(EI),yfe,[Jo,Bf]);On("".concat(hp,"-").concat(H$),G9,[Jo,Bf]);On("".concat(uE,"-").concat(lE),W$,[Jo,Bf]);On("".concat(uE,"-").concat(bg),H9,[Jo,Bf,bg]);On("".concat(uE,"-").concat(SI),G$,[Jo,Bf]);On("".concat(uE,"-").concat(EI),wfe,[Jo,Bf]);On("".concat(uE,"-").concat(H$),Y9,[Jo,Bf]);On(aE,P$,[Z$,aE]);On(Y$,L$,Z$);On(K$,B$,Z$);On(Q9,qje,[X$,Z$]);On(X9,pI,X$);On(Sfe,Afe,X$);On(Z9,p9t,X$);y9t=["clamp","base","constant","exponent"];w9t={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},C9t={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};jje={};Yje(C9t,Hje);Yje(w9t,e=>AI(Hje(e)));tP="symbol",_9t="discrete",Kje="gradient",S9t=e=>Vt(e)?e.map(t=>String(t)):String(e),E9t=(e,t)=>e[1]-t[1],A9t=(e,t)=>t[1]-e[1];_fe={[aE]:"quantiles",[Y$]:"thresholds",[K$]:"domain"},Zje={[aE]:"quantiles",[Y$]:"domain"};D9t=e=>_fe[e.type]||e.bins;N9t=e=>(t,n,r)=>{let i=Vje(r[n+1],Vje(r.max,1/0)),o=Wje(t,e),s=Wje(i,e);return o&&s?o+" \u2013 "+s:s?"< "+s:"\u2265 "+o},Vje=(e,t)=>e??t,F9t=e=>(t,n)=>n?e(t):null,R9t=e=>t=>e(t),Wje=(e,t)=>Number.isFinite(e)?t(e):null});var zfe={};rn(zfe,{axisticks:()=>n7e,datajoin:()=>r7e,encode:()=>i7e,legendentries:()=>o7e,linkpath:()=>Pfe,pie:()=>Lfe,scale:()=>c7e,sortitems:()=>d7e,stack:()=>Bfe});function n7e(e){ce.call(this,null,e)}function r7e(e){ce.call(this,null,e)}function M9t(){return Cn({})}function $9t(e){let t=Dv().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}function i7e(e){ce.call(this,null,e)}function o7e(e){ce.call(this,[],e)}function Pfe(e){ce.call(this,{},e)}function Lfe(e){ce.call(this,null,e)}function Z9t(e){let t=e.type;return!e.bins&&(t===lE||t===SI||t===EI)}function u7e(e){return Q$(e)&&e!==hp}function c7e(e){ce.call(this,null,e),this.modified(!0)}function J9t(e){var t=e.type,n="",r;return t===hp?hp+"-"+lE:(eVt(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?hp+"-":r===3?uE+"-":""),(n+t||lE).toLowerCase())}function eVt(e){let t=e.type;return Q$(t)&&t!==A1&&t!==T1&&(e.scheme||e.range&&e.range.length&&e.range.every(zn))}function tVt(e,t,n){let r=nVt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,o=e.type,s=t.zero||t.zero===void 0&&Z9t(e),a,l;if(!i)return 0;if(u7e(o)&&t.padding&&i[0]!==Fn(i)&&(i=rVt(o,i,t.range,t.padding,t.exponent,t.constant)),(s||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){l=t.domainMid;let u=l>i[a]?a+1:l<i[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),i.splice(u,0,l)}return e.domain(f7e(o,i,n)),o===X9&&e.unknown(t.domainImplicit?dI:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&rV(e,t.nice)||null),i.length}function nVt(e,t,n){return t?(e.domain(f7e(e.type,t,n)),t.length):-1}function rVt(e,t,n,r,i,o){var s=Math.abs(Fn(n)-n[0]),a=s/(s-2*r),l=e===bg?Oie(t,null,a):e===EI?_U(t,null,a,.5):e===SI?_U(t,null,a,i||1):e===H$?Mie(t,null,a,o||1):Rie(t,null,a);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function f7e(e,t,n){if(kfe(e)){var r=Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+Ot(t))}return t}function iVt(e,t,n){let r=t.bins;if(r&&!Vt(r)){let i=e.domain(),o=i[0],s=Fn(i),a=r.step,l=r.start==null?o:r.start,u=r.stop==null?s:r.stop;a||Se("Scale bins parameter missing step property."),l<o&&(l=a*Math.ceil(o/a)),u>s&&(u=a*Math.floor(s/a)),r=Eo(l,u+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===Q9&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function oVt(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(t.rangeStep!=null)o=sVt(r,t,n);else if(t.scheme&&(o=aVt(r,t,n),wn(o))){if(e.interpolator)return e.interpolator(o);Se("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&Ife(r))return e.interpolator(AI($fe(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(J$(t.interpolate,t.interpolateGamma)):wn(e.round)?e.round(i):wn(e.rangeRound)&&e.interpolate(i?fg:Ea),o&&e.range($fe(o,t.reverse))}function sVt(e,t,n){e!==Sfe&&e!==Z9&&Se("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===Z9?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*q$(n,i,r)]}function aVt(e,t,n){var r=t.schemeExtent,i,o;return Vt(t.scheme)?o=AI(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),o=eP(i),o||Se("Unrecognized scheme name: ".concat(t.scheme))),n=e===K$?n+1:e===Q9?n-1:e===aE||e===Y$?+t.schemeCount||X9t:n,Ife(e)?e7e(o,r,t.reverse):wn(o)?tV(e7e(o,r),n):e===X9?o:o.slice(0,n)}function e7e(e,t,n){return wn(e)&&(t||n)?eV(e,$fe(t||[0,1],n)):e}function $fe(e,t){return t?e.slice().reverse():e}function d7e(e){ce.call(this,null,e)}function Bfe(e){ce.call(this,null,e)}function lVt(e,t,n,r,i){for(var o=(t-e.sum)/2,s=e.length,a=0,l;a<s;++a)l=e[a],l[r]=o,l[i]=o+=Math.abs(n(l))}function uVt(e,t,n,r,i){for(var o=1/e.sum,s=0,a=e.length,l=0,u=0,c;l<a;++l)c=e[l],c[r]=s,c[i]=s=o*(u+=Math.abs(n(c)))}function cVt(e,t,n,r,i){for(var o=0,s=0,a=e.length,l=0,u,c;l<a;++l)c=e[l],u=+n(c),u<0?(c[r]=s,c[i]=s+=u):(c[r]=o,c[i]=o+=u)}function fVt(e,t,n,r){var i=[],o=h=>h(c),s,a,l,u,c,f,d,p,m;if(t==null)i.push(e.slice());else for(s={},a=0,l=e.length;a<l;++a)c=e[a],f=t.map(o),d=s[f],d||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,m=0,u=i.length;f<u;++f){for(d=i[f],a=0,p=0,l=d.length;a<l;++a)p+=Math.abs(r(d[a]));d.sum=p,p>m&&(m=p),n&&d.sort(n)}return i.max=m,i}var P9t,L9t,B9t,z9t,s7e,U9t,a7e,j9t,l7e,V9t,W9t,G9t,q9t,H9t,Y9t,K9t,Jje,X9t,Q9t,t7e,p7e,m7e,h7e,g7e=w(()=>{"use strict";hs();TI();ao();kr();YS();$e(n7e,ce,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,s=e.count==null?e.values?e.values.length:10:e.count,a=rV(o,s,e.minstep),l=e.format||Ffe(n,o,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?Nfe(o,e.values,a):iV(o,a);return i&&(r.rem=i),i=u.map((c,f)=>Cn({index:f/(u.length-1||1),value:c,label:l(c)})),e.extra&&i.length&&i.push(Cn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});$e(r7e,ce,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||M9t,o=e.key||bt,s=this.value;return Vt(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&Se("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=$9t(o)),t.visit(t.ADD,a=>{let l=o(a),u=s.get(l);u?u.exit?(s.empty--,r.add.push(u)):r.mod.push(u):(u=i(a),s.set(l,u),r.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{let l=o(a),u=s.get(l);u&&(u.datum=a,r.mod.push(u))}),t.visit(t.REM,a=>{let l=o(a),u=s.get(l);a===u.datum&&!u.exit&&(r.rem.push(u),u.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}});$e(i7e,ce,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(Vt(o))if(n.changed()||o.every(f=>i[f]))o=o[0],n.encode=null;else return t.StopPropagation;var s=o==="enter",a=i.update||jx,l=i.enter||jx,u=i.exit||jx,c=(o&&!s?i[o]:a)||jx;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{l(f,e),a(f,e)}),n.modifies(l.output),n.modifies(a.output),c!==jx&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==jx&&(t.visit(t.REM,f=>{u(f,e)}),n.modifies(u.output)),s||c!==jx){let f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{let p=l(d,e)||r;(c(d,e)||p)&&n.mod.push(d)}),n.mod.length&&n.modifies(l.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});$e(o7e,ce,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||tP,s=e.scale,a=+e.limit,l=rV(s,e.count==null?5:e.count,e.minstep),u=!!e.values||o===tP,c=e.format||Ofe(n,s,l,o,e.formatSpecifier,e.formatType,u),f=e.values||Rfe(s,l),d,p,m,h,g;return i&&(r.rem=i),o===tP?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),g=!0):i=f,wn(m=e.size)?(!e.values&&s(i[0])===0&&(i=i.slice(1)),h=i.reduce((x,b)=>Math.max(x,m(b,e)),0)):m=ps(h=m||8),i=i.map((x,b)=>Cn({index:b,label:c(x,b,i),value:x,offset:h,size:m(x,e)})),g&&(g=f[i.length],i.push(Cn({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:g,offset:h,size:m(g,e)})))):o===Kje?(d=s.domain(),p=nV(s,d[0],Fn(d)),f.length<3&&!e.values&&d[0]!==Fn(d)&&(f=[d[0],Fn(d)]),i=f.map((x,b)=>Cn({index:b,label:c(x,b,f),value:x,perc:p(x)}))):(m=f.length-1,p=Qje(s),i=f.map((x,b)=>Cn({index:b,label:c(x,b,f),value:x,perc:b?p(x):0,perc2:b===m?1:p(f[b+1])}))),r.source=i,r.add=i,this.value=i,r}});P9t=e=>e.source.x,L9t=e=>e.source.y,B9t=e=>e.target.x,z9t=e=>e.target.y;Pfe.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};$e(Pfe,ce,{transform(e,t){var n=e.sourceX||P9t,r=e.sourceY||L9t,i=e.targetX||B9t,o=e.targetY||z9t,s=e.as||"path",a=e.orient||"vertical",l=e.shape||"line",u=Jje.get(l+"-"+a)||Jje.get(l);return u||Se("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=u(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});s7e=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,U9t=(e,t,n,r)=>s7e(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),a7e=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.sqrt(i*i+o*o)/2,a=180*Math.atan2(o,i)/Math.PI;return"M"+e+","+t+"A"+s+","+s+" "+a+" 0 1 "+n+","+r},j9t=(e,t,n,r)=>a7e(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),l7e=(e,t,n,r)=>{let i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},V9t=(e,t,n,r)=>l7e(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),W9t=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,G9t=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,q9t=(e,t,n,r)=>{let i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},H9t=(e,t,n,r)=>{let i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Y9t=(e,t,n,r)=>{let i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},K9t=(e,t,n,r)=>{let i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*o+"C"+l*i+","+l*o+" "+l*s+","+l*a+" "+r*s+","+r*a},Jje=Dv({line:s7e,"line-radial":U9t,arc:a7e,"arc-radial":j9t,curve:l7e,"curve-radial":V9t,"orthogonal-horizontal":W9t,"orthogonal-vertical":G9t,"orthogonal-radial":q9t,"diagonal-horizontal":H9t,"diagonal-vertical":Y9t,"diagonal-radial":K9t});Lfe.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};$e(Lfe,ce,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],o=e.field||Lh,s=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(o),c=u.length,f=s,d=(a-s)/Ek(u),p=Eo(c),m,h,g;for(e.sort&&p.sort((x,b)=>u[x]-u[b]),m=0;m<c;++m)g=u[p[m]],h=l[p[m]],h[r]=f,h[i]=f+=g*d;return this.value=u,t.reflow(e.modified()).modifies(n)}});X9t=5;Q9t=wa(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);$e(c7e,ce,{transform(e,t){var n=t.dataflow,r=this.value,i=J9t(e);(!r||i!==r.type)&&(this.value=r=On(i)());for(i in e)if(!Q9t[i]){if(i==="padding"&&u7e(r.type))continue;wn(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return oVt(r,e,iVt(r,e,tVt(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});$e(d7e,ce,{transform(e,t){let n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Xh(e.sort)),this.modified(n),t}});t7e="zero",p7e="center",m7e="normalize",h7e=["y0","y1"];Bfe.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:t7e,values:[t7e,p7e,m7e]},{name:"as",type:"string",array:!0,length:2,default:h7e}]};$e(Bfe,ce,{transform(e,t){var n=e.as||h7e,r=n[0],i=n[1],o=Xh(e.sort),s=e.field||Lh,a=e.offset===p7e?lVt:e.offset===m7e?uVt:cVt,l,u,c,f;for(l=fVt(t.source,e.groupby,o,s),u=0,c=l.length,f=l.max;u<c;++u)a(l[u],f,s,r,i);return t.reflow(e.modified()).modifies(n)}})});function lV(e){return e>1?0:e<-1?Ht:Math.acos(e)}function ai(e){return e>1?Ir:e<-1?-Ir:Math.asin(e)}var Je,fE,Ht,Ir,kI,uo,Dr,Wt,Gt,zf,Gi,Qe,nP,oV,sV,dE,aV,He,Ia,Nr,II,xn=w(()=>{"use strict";Je=1e-6,fE=1e-12,Ht=Math.PI,Ir=Ht/2,kI=Ht/4,uo=Ht*2,Dr=180/Ht,Wt=Ht/180,Gt=Math.abs,zf=Math.atan,Gi=Math.atan2,Qe=Math.cos,nP=Math.ceil,oV=Math.exp,sV=Math.hypot,dE=Math.log,aV=Math.pow,He=Math.sin,Ia=Math.sign||function(e){return e>0?1:e<0?-1:0},Nr=Math.sqrt,II=Math.tan});function li(){}var I1=w(()=>{"use strict"});function uV(e,t){e&&b7e.hasOwnProperty(e.type)&&b7e[e.type](e,t)}function Ufe(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function y7e(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Ufe(e[n],t,1);t.polygonEnd()}function xu(e,t){e&&x7e.hasOwnProperty(e.type)?x7e[e.type](e,t):uV(e,t)}var x7e,b7e,DI=w(()=>{"use strict";x7e={Feature:function(e,t){uV(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)uV(n[r].geometry,t)}},b7e={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ufe(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Ufe(n[r],t,0)},Polygon:function(e,t){y7e(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)y7e(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)uV(n[r],t)}}});function dVt(){gp.point=mVt}function pVt(){C7e(v7e,w7e)}function mVt(e,t){gp.point=C7e,v7e=e,w7e=t,e*=Wt,t*=Wt,jfe=e,Vfe=Qe(t=t/2+kI),Wfe=He(t)}function C7e(e,t){e*=Wt,t*=Wt,t=t/2+kI;var n=e-jfe,r=n>=0?1:-1,i=r*n,o=Qe(t),s=He(t),a=Wfe*s,l=Vfe*o+a*Qe(i),u=a*r*He(i);rP.add(Gi(u,l)),jfe=e,Vfe=o,Wfe=s}function Gfe(e){return cV=new wi,xu(e,gp),cV*2}var rP,cV,v7e,w7e,jfe,Vfe,Wfe,gp,qfe=w(()=>{"use strict";kr();xn();I1();DI();rP=new wi,cV=new wi,gp={point:li,lineStart:li,lineEnd:li,polygonStart:function(){rP=new wi,gp.lineStart=dVt,gp.lineEnd=pVt},polygonEnd:function(){var e=+rP;cV.add(e<0?uo+e:e),this.lineStart=this.lineEnd=this.point=li},sphere:function(){cV.add(uo)}}});function pE(e){return[Gi(e[1],e[0]),ai(e[2])]}function Uf(e){var t=e[0],n=e[1],r=Qe(n);return[r*Qe(t),r*He(t),He(n)]}function iP(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hb(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function fV(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function oP(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function mE(e){var t=Nr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var NI=w(()=>{"use strict";xn()});function Hfe(e,t){D1.push(xb=[Oi=e,qi=e]),t<bu&&(bu=t),t>Oc&&(Oc=t)}function k7e(e,t){var n=Uf([e*Wt,t*Wt]);if(FI){var r=hb(FI,n),i=[r[1],-r[0],0],o=hb(i,r);mE(o),o=pE(o);var s=e-hE,a=s>0?1:-1,l=o[0]*Dr*a,u,c=Gt(s)>180;c^(a*hE<l&&l<a*e)?(u=o[1]*Dr,u>Oc&&(Oc=u)):(l=(l+360)%360-180,c^(a*hE<l&&l<a*e)?(u=-o[1]*Dr,u<bu&&(bu=u)):(t<bu&&(bu=t),t>Oc&&(Oc=t))),c?e<hE?Rc(Oi,e)>Rc(Oi,qi)&&(qi=e):Rc(e,qi)>Rc(Oi,qi)&&(Oi=e):qi>=Oi?(e<Oi&&(Oi=e),e>qi&&(qi=e)):e>hE?Rc(Oi,e)>Rc(Oi,qi)&&(qi=e):Rc(e,qi)>Rc(Oi,qi)&&(Oi=e)}else D1.push(xb=[Oi=e,qi=e]);t<bu&&(bu=t),t>Oc&&(Oc=t),FI=n,hE=e}function _7e(){gb.point=k7e}function S7e(){xb[0]=Oi,xb[1]=qi,gb.point=Hfe,FI=null}function I7e(e,t){if(FI){var n=e-hE;sP.add(Gt(n)>180?n+(n>0?360:-360):n)}else A7e=e,T7e=t;gp.point(e,t),k7e(e,t)}function hVt(){gp.lineStart()}function gVt(){I7e(A7e,T7e),gp.lineEnd(),Gt(sP)>Je&&(Oi=-(qi=180)),xb[0]=Oi,xb[1]=qi,FI=null}function Rc(e,t){return(t-=e)<0?t+360:t}function xVt(e,t){return e[0]-t[0]}function E7e(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Yfe(e){var t,n,r,i,o,s,a;if(Oc=qi=-(Oi=bu=1/0),D1=[],xu(e,gb),n=D1.length){for(D1.sort(xVt),t=1,r=D1[0],o=[r];t<n;++t)i=D1[t],E7e(r,i[0])||E7e(r,i[1])?(Rc(r[0],i[1])>Rc(r[0],r[1])&&(r[1]=i[1]),Rc(i[0],r[1])>Rc(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,n=o.length-1,t=0,r=o[n];t<=n;r=i,++t)i=o[t],(a=Rc(r[1],i[0]))>s&&(s=a,Oi=i[0],qi=r[1])}return D1=xb=null,Oi===1/0||bu===1/0?[[NaN,NaN],[NaN,NaN]]:[[Oi,bu],[qi,Oc]]}var Oi,bu,qi,Oc,hE,A7e,T7e,FI,sP,D1,xb,gb,D7e=w(()=>{"use strict";kr();qfe();NI();xn();DI();gb={point:Hfe,lineStart:_7e,lineEnd:S7e,polygonStart:function(){gb.point=I7e,gb.lineStart=hVt,gb.lineEnd=gVt,sP=new wi,gp.polygonStart()},polygonEnd:function(){gp.polygonEnd(),gb.point=Hfe,gb.lineStart=_7e,gb.lineEnd=S7e,rP<0?(Oi=-(qi=180),bu=-(Oc=90)):sP>Je?Oc=90:sP<-Je&&(bu=-90),xb[0]=Oi,xb[1]=qi},sphere:function(){Oi=-(qi=180),bu=-(Oc=90)}}});function Qfe(e,t){e*=Wt,t*=Wt;var n=Qe(t);lP(n*Qe(e),n*He(e),He(t))}function lP(e,t,n){++aP,pV+=(e-pV)/aP,mV+=(t-mV)/aP,hV+=(n-hV)/aP}function N7e(){xp.point=bVt}function bVt(e,t){e*=Wt,t*=Wt;var n=Qe(t);Il=n*Qe(e),Dl=n*He(e),Nl=He(t),xp.point=yVt,lP(Il,Dl,Nl)}function yVt(e,t){e*=Wt,t*=Wt;var n=Qe(t),r=n*Qe(e),i=n*He(e),o=He(t),s=Gi(Nr((s=Dl*o-Nl*i)*s+(s=Nl*r-Il*o)*s+(s=Il*i-Dl*r)*s),Il*r+Dl*i+Nl*o);dV+=s,gV+=s*(Il+(Il=r)),xV+=s*(Dl+(Dl=i)),bV+=s*(Nl+(Nl=o)),lP(Il,Dl,Nl)}function F7e(){xp.point=Qfe}function vVt(){xp.point=CVt}function wVt(){M7e(R7e,O7e),xp.point=Qfe}function CVt(e,t){R7e=e,O7e=t,e*=Wt,t*=Wt,xp.point=M7e;var n=Qe(t);Il=n*Qe(e),Dl=n*He(e),Nl=He(t),lP(Il,Dl,Nl)}function M7e(e,t){e*=Wt,t*=Wt;var n=Qe(t),r=n*Qe(e),i=n*He(e),o=He(t),s=Dl*o-Nl*i,a=Nl*r-Il*o,l=Il*i-Dl*r,u=sV(s,a,l),c=ai(u),f=u&&-c/u;Kfe.add(f*s),Xfe.add(f*a),Zfe.add(f*l),dV+=c,gV+=c*(Il+(Il=r)),xV+=c*(Dl+(Dl=i)),bV+=c*(Nl+(Nl=o)),lP(Il,Dl,Nl)}function Jfe(e){aP=dV=pV=mV=hV=gV=xV=bV=0,Kfe=new wi,Xfe=new wi,Zfe=new wi,xu(e,xp);var t=+Kfe,n=+Xfe,r=+Zfe,i=sV(t,n,r);return i<fE&&(t=gV,n=xV,r=bV,dV<Je&&(t=pV,n=mV,r=hV),i=sV(t,n,r),i<fE)?[NaN,NaN]:[Gi(n,t)*Dr,ai(r/i)*Dr]}var aP,dV,pV,mV,hV,gV,xV,bV,Kfe,Xfe,Zfe,R7e,O7e,Il,Dl,Nl,xp,$7e=w(()=>{"use strict";kr();xn();I1();DI();xp={sphere:li,point:Qfe,lineStart:N7e,lineEnd:F7e,polygonStart:function(){xp.lineStart=vVt,xp.lineEnd=wVt},polygonEnd:function(){xp.lineStart=N7e,xp.lineEnd=F7e}}});function uP(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}var ede=w(()=>{"use strict"});function tde(e,t){return[Gt(e)>Ht?e+Math.round(-e/uo)*uo:e,t]}function nde(e,t,n){return(e%=uo)?t||n?uP(L7e(e),B7e(t,n)):L7e(e):t||n?B7e(t,n):tde}function P7e(e){return function(t,n){return t+=e,[t>Ht?t-uo:t<-Ht?t+uo:t,n]}}function L7e(e){var t=P7e(e);return t.invert=P7e(-e),t}function B7e(e,t){var n=Qe(e),r=He(e),i=Qe(t),o=He(t);function s(a,l){var u=Qe(l),c=Qe(a)*u,f=He(a)*u,d=He(l),p=d*n+c*r;return[Gi(f*i-p*o,c*n-d*r),ai(p*i+f*o)]}return s.invert=function(a,l){var u=Qe(l),c=Qe(a)*u,f=He(a)*u,d=He(l),p=d*i-f*o;return[Gi(f*i+d*o,c*n+p*r),ai(p*n-c*r)]},s}function z7e(e){e=nde(e[0]*Wt,e[1]*Wt,e.length>2?e[2]*Wt:0);function t(n){return n=e(n[0]*Wt,n[1]*Wt),n[0]*=Dr,n[1]*=Dr,n}return t.invert=function(n){return n=e.invert(n[0]*Wt,n[1]*Wt),n[0]*=Dr,n[1]*=Dr,n},t}var rde=w(()=>{"use strict";ede();xn();tde.invert=tde});function j7e(e,t,n,r,i,o){if(n){var s=Qe(t),a=He(t),l=r*n;i==null?(i=t+r*uo,o=t-l/2):(i=U7e(s,i),o=U7e(s,o),(r>0?i<o:i>o)&&(i+=r*uo));for(var u,c=i;r>0?c>o:c<o;c-=l)u=pE([s,-a*Qe(c),-a*He(c)]),e.point(u[0],u[1])}}function U7e(e,t){t=Uf(t),t[0]-=e,mE(t);var n=lV(-t[1]);return((-t[2]<0?-n:n)+uo-Je)%uo}var V7e=w(()=>{"use strict";NI();xn()});function yV(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:li,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}var ide=w(()=>{"use strict";I1()});function RI(e,t){return Gt(e[0]-t[0])<Je&&Gt(e[1]-t[1])<Je}var ode=w(()=>{"use strict";xn()});function vV(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function wV(e,t,n,r,i){var o=[],s=[],a,l;if(e.forEach(function(m){if(!((h=m.length-1)<=0)){var h,g=m[0],x=m[h],b;if(RI(g,x)){if(!g[2]&&!x[2]){for(i.lineStart(),a=0;a<h;++a)i.point((g=m[a])[0],g[1]);i.lineEnd();return}x[0]+=2*Je}o.push(b=new vV(g,m,null,!0)),s.push(b.o=new vV(g,null,b,!1)),o.push(b=new vV(x,m,null,!1)),s.push(b.o=new vV(x,null,b,!0))}}),!!o.length){for(s.sort(t),W7e(o),W7e(s),a=0,l=s.length;a<l;++a)s[a].e=n=!n;for(var u=o[0],c,f;;){for(var d=u,p=!0;d.v;)if((d=d.n)===u)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(a=0,l=c.length;a<l;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(p)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,p=!p}while(!d.v);i.lineEnd()}}}function W7e(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}var sde=w(()=>{"use strict";ode();xn()});function ade(e){return Gt(e[0])<=Ht?e[0]:Ia(e[0])*((Gt(e[0])+Ht)%uo-Ht)}function G7e(e,t){var n=ade(t),r=t[1],i=He(r),o=[He(n),-Qe(n),0],s=0,a=0,l=new wi;i===1?r=Ir+Je:i===-1&&(r=-Ir-Je);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,p=f[d-1],m=ade(p),h=p[1]/2+kI,g=He(h),x=Qe(h),b=0;b<d;++b,m=v,g=_,x=S,p=y){var y=f[b],v=ade(y),C=y[1]/2+kI,_=He(C),S=Qe(C),E=v-m,T=E>=0?1:-1,I=T*E,k=I>Ht,O=g*_;if(l.add(Gi(O*T*He(I),x*S+O*Qe(I))),s+=k?E+T*uo:E,k^m>=n^v>=n){var F=hb(Uf(p),Uf(y));mE(F);var B=hb(o,F);mE(B);var M=(k^E>=0?-1:1)*ai(B[2]);(r>M||r===M&&(F[0]||F[1]))&&(a+=k^E>=0?1:-1)}}return(s<-Je||s<Je&&l<-fE)^a&1}var q7e=w(()=>{"use strict";kr();NI();xn()});function CV(e,t,n,r){return function(i){var o=t(i),s=yV(),a=t(s),l=!1,u,c,f,d={point:p,lineStart:h,lineEnd:g,polygonStart:function(){d.point=x,d.lineStart=b,d.lineEnd=y,c=[],u=[]},polygonEnd:function(){d.point=p,d.lineStart=h,d.lineEnd=g,c=Sk(c);var v=G7e(u,r);c.length?(l||(i.polygonStart(),l=!0),wV(c,SVt,v,n,i)):v&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(v,C){e(v,C)&&i.point(v,C)}function m(v,C){o.point(v,C)}function h(){d.point=m,o.lineStart()}function g(){d.point=p,o.lineEnd()}function x(v,C){f.push([v,C]),a.point(v,C)}function b(){a.lineStart(),f=[]}function y(){x(f[0][0],f[0][1]),a.lineEnd();var v=a.clean(),C=s.result(),_,S=C.length,E,T,I;if(f.pop(),u.push(f),f=null,!!S){if(v&1){if(T=C[0],(E=T.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),_=0;_<E;++_)i.point((I=T[_])[0],I[1]);i.lineEnd()}return}S>1&&v&2&&C.push(C.pop().concat(C.shift())),c.push(C.filter(_Vt))}}return d}}function _Vt(e){return e.length>1}function SVt(e,t){return((e=e.x)[0]<0?e[1]-Ir-Je:Ir-e[1])-((t=t.x)[0]<0?t[1]-Ir-Je:Ir-t[1])}var lde=w(()=>{"use strict";ide();sde();xn();q7e();kr()});function EVt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?Ht:-Ht,l=Gt(o-t);Gt(l-Ht)<Je?(e.point(t,n=(n+s)/2>0?Ir:-Ir),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&l>=Ht&&(Gt(t-r)<Je&&(t-=r*Je),Gt(o-a)<Je&&(o-=a*Je),n=AVt(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function AVt(e,t,n,r){var i,o,s=He(e-n);return Gt(s)>Je?zf((He(t)*(o=Qe(r))*He(n)-He(r)*(i=Qe(t))*He(e))/(i*o*s)):(t+r)/2}function TVt(e,t,n,r){var i;if(e==null)i=n*Ir,r.point(-Ht,i),r.point(0,i),r.point(Ht,i),r.point(Ht,0),r.point(Ht,-i),r.point(0,-i),r.point(-Ht,-i),r.point(-Ht,0),r.point(-Ht,i);else if(Gt(e[0]-t[0])>Je){var o=e[0]<t[0]?Ht:-Ht;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}var ude,H7e=w(()=>{"use strict";lde();xn();ude=CV(function(){return!0},EVt,TVt,[-Ht,-Ir])});function Y7e(e){var t=Qe(e),n=6*Wt,r=t>0,i=Gt(t)>Je;function o(c,f,d,p){j7e(p,e,n,d,c,f)}function s(c,f){return Qe(c)*Qe(f)>t}function a(c){var f,d,p,m,h;return{lineStart:function(){m=p=!1,h=1},point:function(g,x){var b=[g,x],y,v=s(g,x),C=r?v?0:u(g,x):v?u(g+(g<0?Ht:-Ht),x):0;if(!f&&(m=p=v)&&c.lineStart(),v!==p&&(y=l(f,b),(!y||RI(f,y)||RI(b,y))&&(b[2]=1)),v!==p)h=0,v?(c.lineStart(),y=l(b,f),c.point(y[0],y[1])):(y=l(f,b),c.point(y[0],y[1],2),c.lineEnd()),f=y;else if(i&&f&&r^v){var _;!(C&d)&&(_=l(b,f,!0))&&(h=0,r?(c.lineStart(),c.point(_[0][0],_[0][1]),c.point(_[1][0],_[1][1]),c.lineEnd()):(c.point(_[1][0],_[1][1]),c.lineEnd(),c.lineStart(),c.point(_[0][0],_[0][1],3)))}v&&(!f||!RI(f,b))&&c.point(b[0],b[1]),f=b,p=v,d=C},lineEnd:function(){p&&c.lineEnd(),f=null},clean:function(){return h|(m&&p)<<1}}}function l(c,f,d){var p=Uf(c),m=Uf(f),h=[1,0,0],g=hb(p,m),x=iP(g,g),b=g[0],y=x-b*b;if(!y)return!d&&c;var v=t*x/y,C=-t*b/y,_=hb(h,g),S=oP(h,v),E=oP(g,C);fV(S,E);var T=_,I=iP(S,T),k=iP(T,T),O=I*I-k*(iP(S,S)-1);if(!(O<0)){var F=Nr(O),B=oP(T,(-I-F)/k);if(fV(B,S),B=pE(B),!d)return B;var M=c[0],z=f[0],W=c[1],H=f[1],Q;z<M&&(Q=M,M=z,z=Q);var re=z-M,oe=Gt(re-Ht)<Je,me=oe||re<Je;if(!oe&&H<W&&(Q=W,W=H,H=Q),me?oe?W+H>0^B[1]<(Gt(B[0]-M)<Je?W:H):W<=B[1]&&B[1]<=H:re>Ht^(M<=B[0]&&B[0]<=z)){var ge=oP(T,(-I+F)/k);return fV(ge,S),[B,pE(ge)]}}}function u(c,f){var d=r?e:Ht-e,p=0;return c<-d?p|=1:c>d&&(p|=2),f<-d?p|=4:f>d&&(p|=8),p}return CV(s,a,o,r?[0,-e]:[-Ht,e-Ht])}var K7e=w(()=>{"use strict";NI();V7e();xn();ode();lde()});function X7e(e,t,n,r,i,o){var s=e[0],a=e[1],l=t[0],u=t[1],c=0,f=1,d=l-s,p=u-a,m;if(m=n-s,!(!d&&m>0)){if(m/=d,d<0){if(m<c)return;m<f&&(f=m)}else if(d>0){if(m>f)return;m>c&&(c=m)}if(m=i-s,!(!d&&m<0)){if(m/=d,d<0){if(m>f)return;m>c&&(c=m)}else if(d>0){if(m<c)return;m<f&&(f=m)}if(m=r-a,!(!p&&m>0)){if(m/=p,p<0){if(m<c)return;m<f&&(f=m)}else if(p>0){if(m>f)return;m>c&&(c=m)}if(m=o-a,!(!p&&m<0)){if(m/=p,p<0){if(m>f)return;m>c&&(c=m)}else if(p>0){if(m<c)return;m<f&&(f=m)}return c>0&&(e[0]=s+c*d,e[1]=a+c*p),f<1&&(t[0]=s+f*d,t[1]=a+f*p),!0}}}}}var Z7e=w(()=>{"use strict"});function fP(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function o(u,c,f,d){var p=0,m=0;if(u==null||(p=s(u,f))!==(m=s(c,f))||l(u,c)<0^f>0)do d.point(p===0||p===3?e:n,p>1?r:t);while((p=(p+f+4)%4)!==m);else d.point(c[0],c[1])}function s(u,c){return Gt(u[0]-e)<Je?c>0?0:3:Gt(u[0]-n)<Je?c>0?2:1:Gt(u[1]-t)<Je?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var f=s(u,1),d=s(c,1);return f!==d?f-d:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=yV(),d,p,m,h,g,x,b,y,v,C,_,S={point:E,lineStart:O,lineEnd:F,polygonStart:I,polygonEnd:k};function E(M,z){i(M,z)&&c.point(M,z)}function T(){for(var M=0,z=0,W=p.length;z<W;++z)for(var H=p[z],Q=1,re=H.length,oe=H[0],me,ge,ye=oe[0],ve=oe[1];Q<re;++Q)me=ye,ge=ve,oe=H[Q],ye=oe[0],ve=oe[1],ge<=r?ve>r&&(ye-me)*(r-ge)>(ve-ge)*(e-me)&&++M:ve<=r&&(ye-me)*(r-ge)<(ve-ge)*(e-me)&&--M;return M}function I(){c=f,d=[],p=[],_=!0}function k(){var M=T(),z=_&&M,W=(d=Sk(d)).length;(z||W)&&(u.polygonStart(),z&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),W&&wV(d,a,M,o,u),u.polygonEnd()),c=u,d=p=m=null}function O(){S.point=B,p&&p.push(m=[]),C=!0,v=!1,b=y=NaN}function F(){d&&(B(h,g),x&&v&&f.rejoin(),d.push(f.result())),S.point=E,v&&c.lineEnd()}function B(M,z){var W=i(M,z);if(p&&m.push([M,z]),C)h=M,g=z,x=W,C=!1,W&&(c.lineStart(),c.point(M,z));else if(W&&v)c.point(M,z);else{var H=[b=Math.max(_V,Math.min(cP,b)),y=Math.max(_V,Math.min(cP,y))],Q=[M=Math.max(_V,Math.min(cP,M)),z=Math.max(_V,Math.min(cP,z))];X7e(H,Q,e,t,n,r)?(v||(c.lineStart(),c.point(H[0],H[1])),c.point(Q[0],Q[1]),W||c.lineEnd(),_=!1):W&&(c.lineStart(),c.point(M,z),_=!1)}b=M,y=z,v=W}return S}}var cP,_V,cde=w(()=>{"use strict";xn();ide();Z7e();sde();kr();cP=1e9,_V=-cP});function Q7e(e,t,n){var r=Eo(e,t-Je,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function J7e(e,t,n){var r=Eo(e,t-Je,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function SV(){var e,t,n,r,i,o,s,a,l=10,u=l,c=90,f=360,d,p,m,h,g=2.5;function x(){return{type:"MultiLineString",coordinates:b()}}function b(){return Eo(nP(r/c)*c,n,c).map(m).concat(Eo(nP(a/f)*f,s,f).map(h)).concat(Eo(nP(t/l)*l,e,l).filter(function(y){return Gt(y%c)>Je}).map(d)).concat(Eo(nP(o/u)*u,i,u).filter(function(y){return Gt(y%f)>Je}).map(p))}return x.lines=function(){return b().map(function(y){return{type:"LineString",coordinates:y}})},x.outline=function(){return{type:"Polygon",coordinates:[m(r).concat(h(s).slice(1),m(n).reverse().slice(1),h(a).reverse().slice(1))]}},x.extent=function(y){return arguments.length?x.extentMajor(y).extentMinor(y):x.extentMinor()},x.extentMajor=function(y){return arguments.length?(r=+y[0][0],n=+y[1][0],a=+y[0][1],s=+y[1][1],r>n&&(y=r,r=n,n=y),a>s&&(y=a,a=s,s=y),x.precision(g)):[[r,a],[n,s]]},x.extentMinor=function(y){return arguments.length?(t=+y[0][0],e=+y[1][0],o=+y[0][1],i=+y[1][1],t>e&&(y=t,t=e,e=y),o>i&&(y=o,o=i,i=y),x.precision(g)):[[t,o],[e,i]]},x.step=function(y){return arguments.length?x.stepMajor(y).stepMinor(y):x.stepMinor()},x.stepMajor=function(y){return arguments.length?(c=+y[0],f=+y[1],x):[c,f]},x.stepMinor=function(y){return arguments.length?(l=+y[0],u=+y[1],x):[l,u]},x.precision=function(y){return arguments.length?(g=+y,d=Q7e(o,i,90),p=J7e(t,e,g),m=Q7e(a,s,90),h=J7e(r,n,g),x):g},x.extentMajor([[-180,-90+Je],[180,90-Je]]).extentMinor([[-180,-80-Je],[180,80+Je]])}var e9e=w(()=>{"use strict";kr();xn()});var N1,EV=w(()=>{"use strict";N1=e=>e});function kVt(){F1.point=IVt}function IVt(e,t){F1.point=r9e,t9e=pde=e,n9e=mde=t}function r9e(e,t){dde.add(mde*e-pde*t),pde=e,mde=t}function DVt(){r9e(t9e,n9e)}var fde,dde,t9e,n9e,pde,mde,F1,hde,i9e=w(()=>{"use strict";kr();xn();I1();fde=new wi,dde=new wi,F1={point:li,lineStart:li,lineEnd:li,polygonStart:function(){F1.lineStart=kVt,F1.lineEnd=DVt},polygonEnd:function(){F1.lineStart=F1.lineEnd=F1.point=li,fde.add(Gt(dde)),dde=new wi},result:function(){var e=fde/2;return fde=new wi,e}};hde=F1});function FVt(e,t){e<OI&&(OI=e),e>dP&&(dP=e),t<AV&&(AV=t),t>TV&&(TV=t)}var OI,AV,dP,TV,NVt,MI,gde=w(()=>{"use strict";I1();OI=1/0,AV=OI,dP=-OI,TV=dP,NVt={point:FVt,lineStart:li,lineEnd:li,polygonStart:li,polygonEnd:li,result:function(){var e=[[OI,AV],[dP,TV]];return dP=TV=-(AV=OI=1/0),e}};MI=NVt});function gE(e,t){xde+=e,bde+=t,++pP}function o9e(){bp.point=RVt}function RVt(e,t){bp.point=OVt,gE(yg=e,vg=t)}function OVt(e,t){var n=e-yg,r=t-vg,i=Nr(n*n+r*r);kV+=i*(yg+e)/2,IV+=i*(vg+t)/2,$I+=i,gE(yg=e,vg=t)}function s9e(){bp.point=gE}function MVt(){bp.point=PVt}function $Vt(){u9e(a9e,l9e)}function PVt(e,t){bp.point=u9e,gE(a9e=yg=e,l9e=vg=t)}function u9e(e,t){var n=e-yg,r=t-vg,i=Nr(n*n+r*r);kV+=i*(yg+e)/2,IV+=i*(vg+t)/2,$I+=i,i=vg*e-yg*t,yde+=i*(yg+e),vde+=i*(vg+t),mP+=i*3,gE(yg=e,vg=t)}var xde,bde,pP,kV,IV,$I,yde,vde,mP,a9e,l9e,yg,vg,bp,wde,c9e=w(()=>{"use strict";xn();xde=0,bde=0,pP=0,kV=0,IV=0,$I=0,yde=0,vde=0,mP=0,bp={point:gE,lineStart:o9e,lineEnd:s9e,polygonStart:function(){bp.lineStart=MVt,bp.lineEnd=$Vt},polygonEnd:function(){bp.point=gE,bp.lineStart=o9e,bp.lineEnd=s9e},result:function(){var e=mP?[yde/mP,vde/mP]:$I?[kV/$I,IV/$I]:pP?[xde/pP,bde/pP]:[NaN,NaN];return xde=bde=pP=kV=IV=$I=yde=vde=mP=0,e}};wde=bp});function DV(e){this._context=e}var f9e=w(()=>{"use strict";xn();I1();DV.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,uo);break}}},result:li}});function LVt(e,t){NV.point=m9e,d9e=hP=e,p9e=gP=t}function m9e(e,t){hP-=e,gP-=t,_de.add(Nr(hP*hP+gP*gP)),hP=e,gP=t}var _de,Cde,d9e,p9e,hP,gP,NV,Sde,h9e=w(()=>{"use strict";kr();xn();I1();_de=new wi,NV={point:li,lineStart:function(){NV.point=LVt},lineEnd:function(){Cde&&m9e(d9e,p9e),NV.point=li},polygonStart:function(){Cde=!0},polygonEnd:function(){Cde=null},result:function(){var e=+_de;return _de=new wi,e}};Sde=NV});function FV(){this._string=[]}function g9e(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var x9e=w(()=>{"use strict";FV.prototype={_radius:4.5,_circle:g9e(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=g9e(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}}});function RV(e,t){var n=4.5,r,i;function o(s){return s&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),xu(s,r(i))),i.result()}return o.area=function(s){return xu(s,r(hde)),hde.result()},o.measure=function(s){return xu(s,r(Sde)),Sde.result()},o.bounds=function(s){return xu(s,r(MI)),MI.result()},o.centroid=function(s){return xu(s,r(wde)),wde.result()},o.projection=function(s){return arguments.length?(r=s==null?(e=null,N1):(e=s).stream,o):e},o.context=function(s){return arguments.length?(i=s==null?(t=null,new FV):new DV(t=s),typeof n!="function"&&i.pointRadius(n),o):t},o.pointRadius=function(s){return arguments.length?(n=typeof s=="function"?s:(i.pointRadius(+s),+s),o):n},o.projection(e).context(t)}var b9e=w(()=>{"use strict";EV();DI();i9e();gde();c9e();f9e();h9e();x9e()});function xE(e){return function(t){var n=new Ede;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Ede(){}var OV=w(()=>{"use strict";Ede.prototype={constructor:Ede,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}}});function Ade(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),xu(n,e.stream(MI)),t(MI.result()),r!=null&&e.clipExtent(r),e}function bE(e,t,n){return Ade(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,l])},n)}function PI(e,t,n){return bE(e,[[0,0],t],n)}function LI(e,t,n){return Ade(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function BI(e,t,n){return Ade(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}var MV=w(()=>{"use strict";DI();gde()});function Tde(e,t){return+t?UVt(e,t):zVt(e)}function zVt(e){return xE({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function UVt(e,t){function n(r,i,o,s,a,l,u,c,f,d,p,m,h,g){var x=u-r,b=c-i,y=x*x+b*b;if(y>4*t&&h--){var v=s+d,C=a+p,_=l+m,S=Nr(v*v+C*C+_*_),E=ai(_/=S),T=Gt(Gt(_)-1)<Je||Gt(o-f)<Je?(o+f)/2:Gi(C,v),I=e(T,E),k=I[0],O=I[1],F=k-r,B=O-i,M=b*F-x*B;(M*M/y>t||Gt((x*F+b*B)/y-.5)>.3||s*d+a*p+l*m<BVt)&&(n(r,i,o,s,a,l,k,O,T,v/=S,C/=S,_,h,g),g.point(k,O),n(k,O,T,v,C,_,u,c,f,d,p,m,h,g))}}return function(r){var i,o,s,a,l,u,c,f,d,p,m,h,g={point:x,lineStart:b,lineEnd:v,polygonStart:function(){r.polygonStart(),g.lineStart=C},polygonEnd:function(){r.polygonEnd(),g.lineStart=b}};function x(E,T){E=e(E,T),r.point(E[0],E[1])}function b(){f=NaN,g.point=y,r.lineStart()}function y(E,T){var I=Uf([E,T]),k=e(E,T);n(f,d,c,p,m,h,f=k[0],d=k[1],c=E,p=I[0],m=I[1],h=I[2],y9e,r),r.point(f,d)}function v(){g.point=x,r.lineEnd()}function C(){b(),g.point=_,g.lineEnd=S}function _(E,T){y(i=E,T),o=f,s=d,a=p,l=m,u=h,g.point=y}function S(){n(f,d,c,p,m,h,o,s,i,a,l,u,y9e,r),g.lineEnd=v,v()}return g}}var y9e,BVt,v9e=w(()=>{"use strict";NI();xn();OV();y9e=16,BVt=Qe(30*Wt)});function VVt(e){return xE({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function WVt(e,t,n,r,i){function o(s,a){return s*=r,a*=i,[t+e*s,n-e*a]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}function w9e(e,t,n,r,i,o){if(!o)return WVt(e,t,n,r,i);var s=Qe(o),a=He(o),l=s*e,u=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,p=(a*t+s*n)/e;function m(h,g){return h*=r,g*=i,[l*h-u*g+t,n-u*h-l*g]}return m.invert=function(h,g){return[r*(c*h-f*g+d),i*(p-f*h-c*g)]},m}function Hi(e){return $V(function(){return e})()}function $V(e){var t,n=150,r=480,i=250,o=0,s=0,a=0,l=0,u=0,c,f=0,d=1,p=1,m=null,h=ude,g=null,x,b,y,v=N1,C=.5,_,S,E,T,I;function k(M){return E(M[0]*Wt,M[1]*Wt)}function O(M){return M=E.invert(M[0],M[1]),M&&[M[0]*Dr,M[1]*Dr]}k.stream=function(M){return T&&I===M?T:T=jVt(VVt(c)(h(_(v(I=M)))))},k.preclip=function(M){return arguments.length?(h=M,m=void 0,B()):h},k.postclip=function(M){return arguments.length?(v=M,g=x=b=y=null,B()):v},k.clipAngle=function(M){return arguments.length?(h=+M?Y7e(m=M*Wt):(m=null,ude),B()):m*Dr},k.clipExtent=function(M){return arguments.length?(v=M==null?(g=x=b=y=null,N1):fP(g=+M[0][0],x=+M[0][1],b=+M[1][0],y=+M[1][1]),B()):g==null?null:[[g,x],[b,y]]},k.scale=function(M){return arguments.length?(n=+M,F()):n},k.translate=function(M){return arguments.length?(r=+M[0],i=+M[1],F()):[r,i]},k.center=function(M){return arguments.length?(o=M[0]%360*Wt,s=M[1]%360*Wt,F()):[o*Dr,s*Dr]},k.rotate=function(M){return arguments.length?(a=M[0]%360*Wt,l=M[1]%360*Wt,u=M.length>2?M[2]%360*Wt:0,F()):[a*Dr,l*Dr,u*Dr]},k.angle=function(M){return arguments.length?(f=M%360*Wt,F()):f*Dr},k.reflectX=function(M){return arguments.length?(d=M?-1:1,F()):d<0},k.reflectY=function(M){return arguments.length?(p=M?-1:1,F()):p<0},k.precision=function(M){return arguments.length?(_=Tde(S,C=M*M),B()):Nr(C)},k.fitExtent=function(M,z){return bE(k,M,z)},k.fitSize=function(M,z){return PI(k,M,z)},k.fitWidth=function(M,z){return LI(k,M,z)},k.fitHeight=function(M,z){return BI(k,M,z)};function F(){var M=w9e(n,0,0,d,p,f).apply(null,t(o,s)),z=w9e(n,r-M[0],i-M[1],d,p,f);return c=nde(a,l,u),S=uP(t,z),E=uP(c,S),_=Tde(S,C),B()}function B(){return T=I=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&O,F()}}var jVt,jf=w(()=>{"use strict";H7e();K7e();cde();ede();EV();xn();rde();OV();MV();v9e();jVt=xE({point:function(e,t){this.stream.point(e*Wt,t*Wt)}})});function zI(e){var t=0,n=Ht/3,r=$V(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*Wt,n=o[1]*Wt):[t*Dr,n*Dr]},i}var PV=w(()=>{"use strict";xn();jf()});function C9e(e){var t=Qe(e);function n(r,i){return[r*t,He(i)/t]}return n.invert=function(r,i){return[r/t,ai(i*t)]},n}var _9e=w(()=>{"use strict";xn()});function S9e(e,t){var n=He(e),r=(n+He(t))/2;if(Gt(r)<Je)return C9e(e);var i=1+n*(2*r-n),o=Nr(i)/r;function s(a,l){var u=Nr(i-2*r*He(l))/r;return[u*He(a*=r),o-u*Qe(a)]}return s.invert=function(a,l){var u=o-l,c=Gi(a,Gt(u))*Ia(u);return u*r<0&&(c-=Ht*Ia(a)*Ia(u)),[c/r,ai((i-(a*a+u*u)*r*r)/(2*r))]},s}function R1(){return zI(S9e).scale(155.424).center([0,33.6442])}var LV=w(()=>{"use strict";xn();PV();_9e()});function xP(){return R1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}var kde=w(()=>{"use strict";LV()});function GVt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Ide(){var e,t,n=xP(),r,i=R1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=R1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,l,u={point:function(d,p){l=[d,p]}};function c(d){var p=d[0],m=d[1];return l=null,r.point(p,m),l||(o.point(p,m),l)||(a.point(p,m),l)}c.invert=function(d){var p=n.scale(),m=n.translate(),h=(d[0]-m[0])/p,g=(d[1]-m[1])/p;return(g>=.12&&g<.234&&h>=-.425&&h<-.214?i:g>=.166&&g<.234&&h>=-.214&&h<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=GVt([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var p=n.scale(),m=+d[0],h=+d[1];return r=n.translate(d).clipExtent([[m-.455*p,h-.238*p],[m+.455*p,h+.238*p]]).stream(u),o=i.translate([m-.307*p,h+.201*p]).clipExtent([[m-.425*p+Je,h+.12*p+Je],[m-.214*p-Je,h+.234*p-Je]]).stream(u),a=s.translate([m-.205*p,h+.212*p]).clipExtent([[m-.214*p+Je,h+.166*p+Je],[m-.115*p-Je,h+.234*p-Je]]).stream(u),f()},c.fitExtent=function(d,p){return bE(c,d,p)},c.fitSize=function(d,p){return PI(c,d,p)},c.fitWidth=function(d,p){return LI(c,d,p)},c.fitHeight=function(d,p){return BI(c,d,p)};function f(){return e=t=null,c}return c.scale(1070)}var E9e=w(()=>{"use strict";xn();kde();LV();MV()});function BV(e){return function(t,n){var r=Qe(t),i=Qe(n),o=e(r*i);return o===1/0?[2,0]:[o*i*He(t),o*He(n)]}}function wg(e){return function(t,n){var r=Nr(t*t+n*n),i=e(r),o=He(i),s=Qe(i);return[Gi(t*o,r*s),ai(r&&n*o/r)]}}var UI=w(()=>{"use strict";xn()});function Nde(){return Hi(Dde).scale(124.75).clipAngle(180-.001)}var Dde,A9e=w(()=>{"use strict";xn();UI();jf();Dde=BV(function(e){return Nr(2/(1+e))});Dde.invert=wg(function(e){return 2*ai(e/2)})});function Rde(){return Hi(Fde).scale(79.4188).clipAngle(180-.001)}var Fde,T9e=w(()=>{"use strict";xn();UI();jf();Fde=BV(function(e){return(e=lV(e))&&e/He(e)});Fde.invert=wg(function(e){return e})});function jI(e,t){return[e,dE(II((Ir+t)/2))]}function Ode(){return Mde(jI).scale(961/uo)}function Mde(e){var t=Hi(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null,a,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=a=l=u=null:(s=+f[0][0],a=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):s==null?null:[[s,a],[l,u]]};function c(){var f=Ht*r(),d=t(z7e(t.rotate()).invert([0,0]));return o(s==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===jI?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,l),u]]:[[s,Math.max(d[1]-f,a)],[l,Math.min(d[1]+f,u)]])}return c()}var zV=w(()=>{"use strict";xn();rde();jf();jI.invert=function(e,t){return[e,2*zf(oV(t))-Ir]}});function UV(e){return II((Ir+e)/2)}function k9e(e,t){var n=Qe(e),r=e===t?He(e):dE(n/Qe(t))/dE(UV(t)/UV(e)),i=n*aV(UV(e),r)/r;if(!r)return jI;function o(s,a){i>0?a<-Ir+Je&&(a=-Ir+Je):a>Ir-Je&&(a=Ir-Je);var l=i/aV(UV(a),r);return[l*He(r*s),i-l*Qe(r*s)]}return o.invert=function(s,a){var l=i-a,u=Ia(r)*Nr(s*s+l*l),c=Gi(s,Gt(l))*Ia(l);return l*r<0&&(c-=Ht*Ia(s)*Ia(l)),[c/r,2*zf(aV(i/u,1/r))-Ir]},o}function $de(){return zI(k9e).scale(109.5).parallels([30,30])}var I9e=w(()=>{"use strict";xn();PV();zV()});function VI(e,t){return[e,t]}function Pde(){return Hi(VI).scale(152.63)}var Lde=w(()=>{"use strict";jf();VI.invert=VI});function D9e(e,t){var n=Qe(e),r=e===t?He(e):(n-Qe(t))/(t-e),i=n/r+e;if(Gt(r)<Je)return VI;function o(s,a){var l=i-a,u=r*s;return[l*He(u),i-l*Qe(u)]}return o.invert=function(s,a){var l=i-a,u=Gi(s,Gt(l))*Ia(l);return l*r<0&&(u-=Ht*Ia(s)*Ia(l)),[u/r,i-Ia(r)*Nr(s*s+l*l)]},o}function Bde(){return zI(D9e).scale(131.154).center([0,13.9389])}var N9e=w(()=>{"use strict";xn();PV();Lde()});function zde(e,t){var n=ai(jV*He(t)),r=n*n,i=r*r*r;return[e*Qe(n)/(jV*(bP+3*yP*r+i*(7*vP+9*wP*r))),n*(bP+yP*r+i*(vP+wP*r))]}function Ude(){return Hi(zde).scale(177.158)}var bP,yP,vP,wP,jV,qVt,F9e=w(()=>{"use strict";jf();xn();bP=1.340264,yP=-.081106,vP=893e-6,wP=.003796,jV=Nr(3)/2,qVt=12;zde.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,s,a,l;o<qVt&&(a=n*(bP+yP*r+i*(vP+wP*r))-t,l=bP+3*yP*r+i*(7*vP+9*wP*r),n-=s=a/l,r=n*n,i=r*r*r,!(Gt(s)<fE));++o);return[jV*e*(bP+3*yP*r+i*(7*vP+9*wP*r))/Qe(n),ai(He(n)/jV)]}});function jde(e,t){var n=Qe(t),r=Qe(e)*n;return[n*He(e)/r,He(t)/r]}function Vde(){return Hi(jde).scale(144.049).clipAngle(60)}var R9e=w(()=>{"use strict";xn();UI();jf();jde.invert=wg(zf)});function Wde(){var e=1,t=0,n=0,r=1,i=1,o=0,s,a,l=null,u,c,f,d=1,p=1,m=xE({point:function(v,C){var _=y([v,C]);this.stream.point(_[0],_[1])}}),h=N1,g,x;function b(){return d=e*r,p=e*i,g=x=null,y}function y(v){var C=v[0]*d,_=v[1]*p;if(o){var S=_*s-C*a;C=C*s+_*a,_=S}return[C+t,_+n]}return y.invert=function(v){var C=v[0]-t,_=v[1]-n;if(o){var S=_*s+C*a;C=C*s-_*a,_=S}return[C/d,_/p]},y.stream=function(v){return g&&x===v?g:g=m(h(x=v))},y.postclip=function(v){return arguments.length?(h=v,l=u=c=f=null,b()):h},y.clipExtent=function(v){return arguments.length?(h=v==null?(l=u=c=f=null,N1):fP(l=+v[0][0],u=+v[0][1],c=+v[1][0],f=+v[1][1]),b()):l==null?null:[[l,u],[c,f]]},y.scale=function(v){return arguments.length?(e=+v,b()):e},y.translate=function(v){return arguments.length?(t=+v[0],n=+v[1],b()):[t,n]},y.angle=function(v){return arguments.length?(o=v%360*Wt,a=He(o),s=Qe(o),b()):o*Dr},y.reflectX=function(v){return arguments.length?(r=v?-1:1,b()):r<0},y.reflectY=function(v){return arguments.length?(i=v?-1:1,b()):i<0},y.fitExtent=function(v,C){return bE(y,v,C)},y.fitSize=function(v,C){return PI(y,v,C)},y.fitWidth=function(v,C){return LI(y,v,C)},y.fitHeight=function(v,C){return BI(y,v,C)},y}var O9e=w(()=>{"use strict";cde();EV();OV();MV();xn()});function Gde(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}function qde(){return Hi(Gde).scale(175.295)}var M9e=w(()=>{"use strict";jf();xn();Gde.invert=function(e,t){var n=t,r=25,i;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-t)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(Gt(i)>Je&&--r>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]}});function Hde(e,t){return[Qe(t)*He(e),He(t)]}function Yde(){return Hi(Hde).scale(249.5).clipAngle(90+Je)}var $9e=w(()=>{"use strict";xn();UI();jf();Hde.invert=wg(ai)});function Kde(e,t){var n=Qe(t),r=1+Qe(e)*n;return[n*He(e)/r,He(t)/r]}function Xde(){return Hi(Kde).scale(250).clipAngle(142)}var P9e=w(()=>{"use strict";xn();UI();jf();Kde.invert=wg(function(e){return 2*zf(e)})});function Zde(e,t){return[dE(II((Ir+t)/2)),-e]}function Qde(){var e=Mde(Zde),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var L9e=w(()=>{"use strict";xn();zV();Zde.invert=function(e,t){return[-t,2*zf(oV(e))-Ir]}});var CP=w(()=>{"use strict";qfe();D7e();$7e();e9e();b9e();kde();E9e();A9e();T9e();I9e();LV();N9e();F9e();Lde();R9e();O9e();jf();zV();M9e();$9e();P9e();L9e()});function epe(e){return e>1?VV:e<-1?-VV:Math.asin(e)}function U9e(e){return e>0?Math.sqrt(e):0}var B9e,WV,_P,z9e,O1,VV,XLr,Jde,ZLr,QLr,JLr,eBr,j9e=w(()=>{"use strict";B9e=Math.abs,WV=Math.cos,_P=Math.sin,z9e=1e-6,O1=Math.PI,VV=O1/2,XLr=O1/4,Jde=U9e(2),ZLr=U9e(O1),QLr=O1*2,JLr=180/O1,eBr=O1/180});function HVt(e,t){var n=e*_P(t),r=30,i;do t-=i=(t+_P(t)-n)/(1+WV(t));while(B9e(i)>z9e&&--r>0);return t/2}function YVt(e,t,n){function r(i,o){return[e*i*WV(o=HVt(n,o)),t*_P(o)]}return r.invert=function(i,o){return o=epe(o/t),[i/(e*WV(o)),epe((2*o+_P(2*o))/n)]},r}function tpe(){return Hi(V9e).scale(169.529)}var V9e,W9e=w(()=>{"use strict";CP();j9e();V9e=YVt(Jde/VV,Jde,O1)});var G9e=w(()=>{"use strict";W9e()});function XVt(e,t){return function n(){let r=t();return r.type=e,r.path=RV().projection(r),r.copy=r.copy||function(){let i=n();return qV.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function SP(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(GV[e]=XVt(e,t),this):GV[e]||null}function npe(e){return e&&e.path||KVt}var KVt,qV,GV,rpe=w(()=>{"use strict";CP();G9e();KVt=RV(),qV=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];GV={albers:xP,albersusa:Ide,azimuthalequalarea:Nde,azimuthalequidistant:Rde,conicconformal:$de,conicequalarea:R1,conicequidistant:Bde,equalEarth:Ude,equirectangular:Pde,gnomonic:Vde,identity:Wde,mercator:Ode,mollweide:tpe,naturalEarth1:qde,orthographic:Yde,stereographic:Xde,transversemercator:Qde};for(let e in GV)SP(e,GV[e])});var gpe={};rn(gpe,{contour:()=>lpe,geojson:()=>cpe,geopath:()=>fpe,geopoint:()=>dpe,geoshape:()=>ppe,graticule:()=>mpe,heatmap:()=>hpe,isocontour:()=>spe,kde2d:()=>ape,projection:()=>eVe});function ZVt(){}function Y9e(){var e=1,t=1,n=a;function r(l,u){return u.map(c=>i(l,c))}function i(l,u){var c=[],f=[];return o(l,u,d=>{n(d,l,u),QVt(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var p=0,m=c.length,h;p<m;++p)if(JVt((h=c[p])[0],d)!==-1){h.push(d);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function o(l,u,c){var f=new Array,d=new Array,p,m,h,g,x,b;for(p=m=-1,g=l[0]>=u,bb[g<<1].forEach(y);++p<e-1;)h=g,g=l[p+1]>=u,bb[h|g<<1].forEach(y);for(bb[g<<0].forEach(y);++m<t-1;){for(p=-1,g=l[m*e+e]>=u,x=l[m*e]>=u,bb[g<<1|x<<2].forEach(y);++p<e-1;)h=g,g=l[m*e+e+p+1]>=u,b=x,x=l[m*e+p+1]>=u,bb[h|g<<1|x<<2|b<<3].forEach(y);bb[g|x<<3].forEach(y)}for(p=-1,x=l[m*e]>=u,bb[x<<2].forEach(y);++p<e-1;)b=x,x=l[m*e+p+1]>=u,bb[x<<2|b<<3].forEach(y);bb[x<<3].forEach(y);function y(v){var C=[v[0][0]+p,v[0][1]+m],_=[v[1][0]+p,v[1][1]+m],S=s(C),E=s(_),T,I;(T=d[S])?(I=f[E])?(delete d[T.end],delete f[I.start],T===I?(T.ring.push(_),c(T.ring)):f[T.start]=d[I.end]={start:T.start,end:I.end,ring:T.ring.concat(I.ring)}):(delete d[T.end],T.ring.push(_),d[T.end=E]=T):(T=f[E])?(I=d[S])?(delete f[T.start],delete d[I.end],T===I?(T.ring.push(_),c(T.ring)):f[I.start]=d[T.end]={start:I.start,end:T.end,ring:I.ring.concat(T.ring)}):(delete f[T.start],T.ring.unshift(C),f[T.start=S]=T):f[S]=d[E]={start:S,end:E,ring:[C,_]}}}function s(l){return l[0]*2+l[1]*(e+1)*4}function a(l,u,c){l.forEach(f=>{var d=f[0],p=f[1],m=d|0,h=p|0,g,x=u[h*e+m];d>0&&d<e&&m===d&&(g=u[h*e+m-1],f[0]=d+(c-g)/(x-g)-.5),p>0&&p<t&&h===p&&(g=u[(h-1)*e+m],f[1]=p+(c-g)/(x-g)-.5)})}return r.contour=i,r.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||Se("invalid size"),e=u,t=c,r},r.smooth=function(l){return arguments.length?(n=l?a:ZVt,r):n===a},r}function QVt(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function JVt(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=eWt(e,t[n]))return i;return 0}function eWt(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],u=l[0],c=l[1],f=e[a],d=f[0],p=f[1];if(tWt(l,f,t))return 0;c>r!=p>r&&n<(d-u)*(r-c)/(p-c)+u&&(i=-i)}return i}function tWt(e,t,n){var r;return nWt(e,t,n)&&rWt(e[r=+(e[0]===t[0])],n[r],t[r])}function nWt(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function rWt(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function K9e(e,t,n){return function(r){var i=Hd(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,l=t?bl(o,s,e):a/(e+1);return Eo(o+l,s,l)}}function spe(e){ce.call(this,null,e)}function iWt(e,t,n){let r=K9e(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>Tf(t(i).values)))}function oWt(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(wn(i)&&(i=i(n,r)),wn(o)&&(o=o(n,r)),(i===1||i==null)&&!o)return;let s=(zh(i)?i:i[0])||1,a=(zh(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;e.forEach(X9e(t,s,a,l,u))}function X9e(e,t,n,r,i){let o=e.x1||0,s=e.y1||0,a=t*n<0;function l(f){f.forEach(u)}function u(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(l),f}}function q9e(e,t,n){let r=e>=0?e:lj(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function ipe(e){return wn(e)?e:ps(+e)}function Z9e(){var e=l=>l[0],t=l=>l[1],n=Lh,r=[-1,-1],i=960,o=500,s=2;function a(l,u){let c=q9e(r[0],l,e)>>s,f=q9e(r[1],l,t)>>s,d=c?c+2:0,p=f?f+2:0,m=2*d+(i>>s),h=2*p+(o>>s),g=new Float32Array(m*h),x=new Float32Array(m*h),b=g;l.forEach(v=>{let C=d+(+e(v)>>s),_=p+(+t(v)>>s);C>=0&&C<m&&_>=0&&_<h&&(g[C+_*m]+=+n(v))}),c>0&&f>0?(WI(m,h,g,x,c),GI(m,h,x,g,f),WI(m,h,g,x,c),GI(m,h,x,g,f),WI(m,h,g,x,c),GI(m,h,x,g,f)):c>0?(WI(m,h,g,x,c),WI(m,h,x,g,c),WI(m,h,g,x,c),b=x):f>0&&(GI(m,h,g,x,f),GI(m,h,x,g,f),GI(m,h,g,x,f),b=x);let y=u?Math.pow(2,-2*s):1/Ek(b);for(let v=0,C=m*h;v<C;++v)b[v]*=y;return{values:b,scale:1<<s,width:m,height:h,x1:d,y1:p,x2:d+(i>>s),y2:p+(o>>s)}}return a.x=function(l){return arguments.length?(e=ipe(l),a):e},a.y=function(l){return arguments.length?(t=ipe(l),a):t},a.weight=function(l){return arguments.length?(n=ipe(l),a):n},a.size=function(l){if(!arguments.length)return[i,o];var u=+l[0],c=+l[1];return u>=0&&c>=0||Se("invalid size"),i=u,o=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||Se("invalid cell size"),s=Math.floor(Math.log(l)/Math.LN2),a):1<<s},a.bandwidth=function(l){return arguments.length?(l=Rt(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&Se("invalid bandwidth"),r=l,a):r},a}function WI(e,t,n,r,i){let o=(i<<1)+1;for(let s=0;s<t;++s)for(let a=0,l=0;a<e+i;++a)a<e&&(l+=n[a+s*e]),a>=i&&(a>=o&&(l-=n[a-o+s*e]),r[a-i+s*e]=l/Math.min(a+1,e-1+o-a,o))}function GI(e,t,n,r,i){let o=(i<<1)+1;for(let s=0;s<e;++s)for(let a=0,l=0;a<t+i;++a)a<t&&(l+=n[s+a*e]),a>=i&&(a>=o&&(l-=n[s+(a-o)*e]),r[s+(a-i)*e]=l/Math.min(a+1,t-1+o-a,o))}function ape(e){ce.call(this,null,e)}function Q9e(e,t){return sWt.forEach(n=>t[n]!=null?e[n](t[n]):0),e}function aWt(e,t){var n=[],r=c=>c(a),i,o,s,a,l,u;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function lpe(e){ce.call(this,null,e)}function cpe(e){ce.call(this,null,e)}function fpe(e){ce.call(this,null,e)}function uWt(e,t){let n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function dpe(e){ce.call(this,null,e)}function ppe(e){ce.call(this,null,e)}function cWt(e,t,n){let r=n==null?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}function mpe(e){ce.call(this,[],e),this.generator=SV()}function hpe(e){ce.call(this,null,e)}function fWt(e,t){let n;return wn(e)?(n=r=>ko(e(r,t)),n.dep=J9e(e)):n=ps(ko(e||"#888")),n}function dWt(e,t){let n;return wn(e)?(n=r=>e(r,t),n.dep=J9e(e)):e?n=ps(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function J9e(e){if(!wn(e))return!1;let t=wa(Xo(e));return t.$x||t.$y||t.$value||t.$max}function pWt(e,t,n,r){let i=e.width,o=e.height,s=e.x1||0,a=e.y1||0,l=e.x2||i,u=e.y2||o,c=e.values,f=c?g=>c[g]:Gd,d=uu(l-s,u-a),p=d.getContext("2d"),m=p.getImageData(0,0,l-s,u-a),h=m.data;for(let g=a,x=0;g<u;++g){t.$y=g-a;for(let b=s,y=g*i;b<l;++b,x+=4){t.$x=b-s,t.$value=f(b+y);let v=n(t);h[x+0]=v.r,h[x+1]=v.g,h[x+2]=v.b,h[x+3]=~~(255*r(t))}}return p.putImageData(m,0,0),d}function eVe(e){ce.call(this,null,e),this.modified(!0)}function mWt(e,t){let n=gWt(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function hWt(e){let t=SP((e||"mercator").toLowerCase());return t||Se("Unrecognized projection type: "+e),t()}function H9e(e,t,n){wn(e[t])&&e[t](n)}function gWt(e){return e=Rt(e),e.length===1?e[0]:{type:upe,features:e.reduce((t,n)=>t.concat(xWt(n)),[])}}function xWt(e){return e.type===upe?e.features:Rt(e).filter(t=>t!=null).map(t=>t.type===ope?t:{type:ope,geometry:t})}var bb,sWt,ope,upe,lWt,tVe=w(()=>{"use strict";hs();ao();kr();kk();rpe();CP();lo();Lk();bb=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];spe.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};$e(spe,ce,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||gl,o=Y9e().smooth(e.smooth!==!1),s=e.thresholds||iWt(r,i,e),a=e.as===null?null:e.as||"contour",l=[];return r.forEach(u=>{let c=i(u),f=o.size([c.width,c.height])(c.values,Vt(s)?s:s(c.values));oWt(f,c,u,e),f.forEach(d=>{l.push(hS(u,Cn(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});ape.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};sWt=["x","y","weight","size","cellSize","bandwidth"];$e(ape,ce,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=aWt(r,e.groupby),o=(e.groupby||[]).map(si),s=Q9e(Z9e(),e),a=e.as||"grid",l=[];function u(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return l=i.map(c=>Cn(u({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});lpe.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};$e(lpe,ce,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Y9e().smooth(e.smooth!==!1),i=e.values,o=e.thresholds||K9e(e.count||10,e.nice,!!i),s=e.size,a,l;return i||(i=t.materialize(t.SOURCE).source,a=Q9e(Z9e(),e)(i,!0),l=X9e(a,a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=Vt(o)?o:o(i),i=r.size(s)(i,o),l&&i.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Cn),n}});ope="Feature",upe="FeatureCollection",lWt="MultiPoint";cpe.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};$e(cpe,ce,{transform(e,t){var n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&gl,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(Xo(a))||o&&t.modified(Xo(o))||s&&t.modified(Xo(s)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(l,c=>n.push(a(c))),o&&s&&(t.visit(l,c=>{var f=o(c),d=s(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:ope,geometry:{type:lWt,coordinates:r}})),this.value={type:upe,features:n}}});fpe.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};$e(fpe,ce,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||gl,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=npe(e.projection),n.materialize().reflow()):s=i===gl||t.modified(i.fields)?n.ADD_MOD:n.ADD;let a=uWt(r,e.pointRadius);return n.visit(s,l=>l[o]=r(i(l))),r.pointRadius(a),n.modifies(o)}});dpe.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};$e(dpe,ce,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1],l;function u(c){let f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(r.fields)||t.modified(i.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(o)}});ppe.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};$e(ppe,ce,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=cWt(npe(e.projection),e.field||Wd("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}});mpe.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};$e(mpe,ce,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(let o in e)wn(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(QU(n[0],i)):t.add.push(Cn(i)),n[0]=i,t}});hpe.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};$e(hpe,ce,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||gl,o=dWt(e.opacity,e),s=fWt(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?Tf(n.map(u=>Tf(i(u).values))):0};return n.forEach(u=>{let c=i(u),f=Jt({},u,l);r||(f.$max=Tf(c.values||[])),u[a]=pWt(c,f,s.dep?s:ps(s(f)),o.dep?o:ps(o(f)))}),t.reflow(!0).modifies(a)}});$e(eVe,ce,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=hWt(e.type),qV.forEach(r=>{e[r]!=null&&H9e(n,r,e[r])})):qV.forEach(r=>{e.modified(r)&&H9e(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&mWt(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}})});function xpe(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var o,s=n.length,a,l=0,u=0;for(o=0;o<s;++o)a=n[o],l+=a.x,u+=a.y;for(l=(l/s-e)*r,u=(u/s-t)*r,o=0;o<s;++o)a=n[o],a.x-=l,a.y-=u}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i}var nVe=w(()=>{"use strict"});function rVe(e){let t=+this._x.call(null,e),n=+this._y.call(null,e);return iVe(this.cover(t,n),t,n,e)}function iVe(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o=e._root,s={data:r},a=e._x0,l=e._y0,u=e._x1,c=e._y1,f,d,p,m,h,g,x,b;if(!o)return e._root=s,e;for(;o.length;)if((h=t>=(f=(a+u)/2))?a=f:u=f,(g=n>=(d=(l+c)/2))?l=d:c=d,i=o,!(o=o[x=g<<1|h]))return i[x]=s,e;if(p=+e._x.call(null,o.data),m=+e._y.call(null,o.data),t===p&&n===m)return s.next=o,i?i[x]=s:e._root=s,e;do i=i?i[x]=new Array(4):e._root=new Array(4),(h=t>=(f=(a+u)/2))?a=f:u=f,(g=n>=(d=(l+c)/2))?l=d:c=d;while((x=g<<1|h)===(b=(m>=d)<<1|p>=f));return i[b]=o,i[x]=s,e}function oVe(e){var t,n,r=e.length,i,o,s=new Array(r),a=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<l&&(l=i),i>c&&(c=i),o<u&&(u=o),o>f&&(f=o));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)iVe(this,s[n],a[n],e[n]);return this}var sVe=w(()=>{"use strict"});function aVe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s=i-n||1,a=this._root,l,u;n>e||e>=i||r>t||t>=o;)switch(u=(t<r)<<1|e<n,l=new Array(4),l[u]=a,a=l,s*=2,u){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}var lVe=w(()=>{"use strict"});function uVe(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}var cVe=w(()=>{"use strict"});function fVe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}var dVe=w(()=>{"use strict"});function Cs(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}var HV=w(()=>{"use strict"});function pVe(e,t,n){var r,i=this._x0,o=this._y0,s,a,l,u,c=this._x1,f=this._y1,d=[],p=this._root,m,h;for(p&&d.push(new Cs(p,i,o,c,f)),n==null?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);m=d.pop();)if(!(!(p=m.node)||(s=m.x0)>c||(a=m.y0)>f||(l=m.x1)<i||(u=m.y1)<o))if(p.length){var g=(s+l)/2,x=(a+u)/2;d.push(new Cs(p[3],g,x,l,u),new Cs(p[2],s,x,g,u),new Cs(p[1],g,a,l,x),new Cs(p[0],s,a,g,x)),(h=(t>=x)<<1|e>=g)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-h],d[d.length-1-h]=m)}else{var b=e-+this._x.call(null,p.data),y=t-+this._y.call(null,p.data),v=b*b+y*y;if(v<n){var C=Math.sqrt(n=v);i=e-C,o=t-C,c=e+C,f=t+C,r=p.data}}return r}var mVe=w(()=>{"use strict";HV()});function hVe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,o,s=this._x0,a=this._y0,l=this._x1,u=this._y1,c,f,d,p,m,h,g,x;if(!n)return this;if(n.length)for(;;){if((m=c>=(d=(s+l)/2))?s=d:l=d,(h=f>=(p=(a+u)/2))?a=p:u=p,t=n,!(n=n[g=h<<1|m]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,x=g)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[g]=o:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[x]=n:this._root=n),this):(this._root=o,this)}function gVe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}var xVe=w(()=>{"use strict"});function bVe(){return this._root}var yVe=w(()=>{"use strict"});function vVe(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}var wVe=w(()=>{"use strict"});function CVe(e){var t=[],n,r=this._root,i,o,s,a,l;for(r&&t.push(new Cs(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,l=n.y1)&&r.length){var u=(o+a)/2,c=(s+l)/2;(i=r[3])&&t.push(new Cs(i,u,c,a,l)),(i=r[2])&&t.push(new Cs(i,o,c,u,l)),(i=r[1])&&t.push(new Cs(i,u,s,a,c)),(i=r[0])&&t.push(new Cs(i,o,s,u,c))}return this}var _Ve=w(()=>{"use strict";HV()});function SVe(e){var t=[],n=[],r;for(this._root&&t.push(new Cs(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,l=r.x1,u=r.y1,c=(s+l)/2,f=(a+u)/2;(o=i[0])&&t.push(new Cs(o,s,a,c,f)),(o=i[1])&&t.push(new Cs(o,c,a,l,f)),(o=i[2])&&t.push(new Cs(o,s,f,c,u)),(o=i[3])&&t.push(new Cs(o,c,f,l,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}var EVe=w(()=>{"use strict";HV()});function AVe(e){return e[0]}function TVe(e){return arguments.length?(this._x=e,this):this._x}var kVe=w(()=>{"use strict"});function IVe(e){return e[1]}function DVe(e){return arguments.length?(this._y=e,this):this._y}var NVe=w(()=>{"use strict"});function yE(e,t,n){var r=new bpe(t??AVe,n??IVe,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function bpe(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function FVe(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Fl,RVe=w(()=>{"use strict";sVe();lVe();cVe();dVe();mVe();xVe();yVe();wVe();_Ve();EVe();kVe();NVe();Fl=yE.prototype=bpe.prototype;Fl.copy=function(){var e=new bpe(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=FVe(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=FVe(r));return e};Fl.add=rVe;Fl.addAll=oVe;Fl.cover=aVe;Fl.data=uVe;Fl.extent=fVe;Fl.find=pVe;Fl.remove=hVe;Fl.removeAll=gVe;Fl.root=bVe;Fl.size=vVe;Fl.visit=CVe;Fl.visitAfter=SVe;Fl.x=TVe;Fl.y=DVe});var ype=w(()=>{"use strict";RVe()});function No(e){return function(){return e}}var qI=w(()=>{"use strict"});function yp(e){return(e()-.5)*1e-6}var YV=w(()=>{"use strict"});function bWt(e){return e.x+e.vx}function yWt(e){return e.y+e.vy}function vpe(e){var t,n,r,i=1,o=1;typeof e!="function"&&(e=No(e==null?1:+e));function s(){for(var u,c=t.length,f,d,p,m,h,g,x=0;x<o;++x)for(f=yE(t,bWt,yWt).visitAfter(a),u=0;u<c;++u)d=t[u],h=n[d.index],g=h*h,p=d.x+d.vx,m=d.y+d.vy,f.visit(b);function b(y,v,C,_,S){var E=y.data,T=y.r,I=h+T;if(E){if(E.index>d.index){var k=p-E.x-E.vx,O=m-E.y-E.vy,F=k*k+O*O;F<I*I&&(k===0&&(k=yp(r),F+=k*k),O===0&&(O=yp(r),F+=O*O),F=(I-(F=Math.sqrt(F)))/F*i,d.vx+=(k*=F)*(I=(T*=T)/(g+T)),d.vy+=(O*=F)*I,E.vx-=k*(I=1-I),E.vy-=O*I)}return}return v>p+I||_<p-I||C>m+I||S<m-I}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,c=t.length,f;for(n=new Array(c),u=0;u<c;++u)f=t[u],n[f.index]=+e(f,u,t)}}return s.initialize=function(u,c){t=u,r=c,l()},s.iterations=function(u){return arguments.length?(o=+u,s):o},s.strength=function(u){return arguments.length?(i=+u,s):i},s.radius=function(u){return arguments.length?(e=typeof u=="function"?u:No(+u),l(),s):e},s}var OVe=w(()=>{"use strict";ype();qI();YV()});function vWt(e){return e.index}function MVe(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function wpe(e){var t=vWt,n=f,r,i=No(30),o,s,a,l,u,c=1;e==null&&(e=[]);function f(g){return 1/Math.min(a[g.source.index],a[g.target.index])}function d(g){for(var x=0,b=e.length;x<c;++x)for(var y=0,v,C,_,S,E,T,I;y<b;++y)v=e[y],C=v.source,_=v.target,S=_.x+_.vx-C.x-C.vx||yp(u),E=_.y+_.vy-C.y-C.vy||yp(u),T=Math.sqrt(S*S+E*E),T=(T-o[y])/T*g*r[y],S*=T,E*=T,_.vx-=S*(I=l[y]),_.vy-=E*I,C.vx+=S*(I=1-I),C.vy+=E*I}function p(){if(s){var g,x=s.length,b=e.length,y=new Map(s.map((C,_)=>[t(C,_,s),C])),v;for(g=0,a=new Array(x);g<b;++g)v=e[g],v.index=g,typeof v.source!="object"&&(v.source=MVe(y,v.source)),typeof v.target!="object"&&(v.target=MVe(y,v.target)),a[v.source.index]=(a[v.source.index]||0)+1,a[v.target.index]=(a[v.target.index]||0)+1;for(g=0,l=new Array(b);g<b;++g)v=e[g],l[g]=a[v.source.index]/(a[v.source.index]+a[v.target.index]);r=new Array(b),m(),o=new Array(b),h()}}function m(){if(s)for(var g=0,x=e.length;g<x;++g)r[g]=+n(e[g],g,e)}function h(){if(s)for(var g=0,x=e.length;g<x;++g)o[g]=+i(e[g],g,e)}return d.initialize=function(g,x){s=g,u=x,p()},d.links=function(g){return arguments.length?(e=g,p(),d):e},d.id=function(g){return arguments.length?(t=g,d):t},d.iterations=function(g){return arguments.length?(c=+g,d):c},d.strength=function(g){return arguments.length?(n=typeof g=="function"?g:No(+g),m(),d):n},d.distance=function(g){return arguments.length?(i=typeof g=="function"?g:No(+g),h(),d):i},d}var $Ve=w(()=>{"use strict";qI();YV()});function LVe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new KV(n)}function KV(e){this._=e}function CWt(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}function _Wt(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function PVe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=wWt,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var wWt,Cpe,BVe=w(()=>{"use strict";wWt={value:()=>{}};KV.prototype=LVe.prototype={constructor:KV,on:function(e,t){var n=this._,r=CWt(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=_Wt(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=PVe(n[i],e.name,t);else if(t==null)for(i in n)n[i]=PVe(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new KV(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};Cpe=LVe});var zVe=w(()=>{"use strict";BVe()});function DP(){return vE||(VVe(SWt),vE=kP.now()+QV)}function SWt(){vE=0}function IP(){this._call=this._time=this._next=null}function JV(e,t,n){var r=new IP;return r.restart(e,t,n),r}function WVe(){DP(),++HI;for(var e=XV,t;e;)(t=vE-e._time)>=0&&e._call.call(null,t),e=e._next;--HI}function UVe(){vE=(ZV=kP.now())+QV,HI=AP=0;try{WVe()}finally{HI=0,AWt(),vE=0}}function EWt(){var e=kP.now(),t=e-ZV;t>jVe&&(QV-=t,ZV=e)}function AWt(){for(var e,t=XV,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:XV=n);TP=e,_pe(r)}function _pe(e){if(!HI){AP&&(AP=clearTimeout(AP));var t=e-vE;t>24?(e<1/0&&(AP=setTimeout(UVe,e-kP.now()-QV)),EP&&(EP=clearInterval(EP))):(EP||(ZV=kP.now(),EP=setInterval(EWt,jVe)),HI=1,VVe(UVe))}}var HI,AP,EP,jVe,XV,TP,ZV,vE,QV,kP,VVe,Spe=w(()=>{"use strict";HI=0,AP=0,EP=0,jVe=1e3,ZV=0,vE=0,QV=0,kP=typeof performance=="object"&&performance.now?performance:Date,VVe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};IP.prototype=JV.prototype={constructor:IP,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?DP():+n)+(t==null?0:+t),!this._next&&TP!==this&&(TP?TP._next=this:XV=this,TP=this),this._call=e,this._time=n,_pe()},stop:function(){this._call&&(this._call=null,this._time=1/0,_pe())}}});function Epe(e,t,n){var r=new IP,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=a==null?DP():+a,r._restart(function l(u){u+=i,r._restart(l,i+=s,a),o(u)},s,a)},r.restart(e,t,n),r)}var GVe=w(()=>{"use strict";Spe()});var Ape=w(()=>{"use strict";Spe();GVe()});function qVe(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}var HVe=w(()=>{"use strict"});function YVe(e){return e.x}function KVe(e){return e.y}function Tpe(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,l=JV(f),u=Cpe("tick","end"),c=qVe();e==null&&(e=[]);function f(){d(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function d(h){var g,x=e.length,b;h===void 0&&(h=1);for(var y=0;y<h;++y)for(n+=(o-n)*i,a.forEach(function(v){v(n)}),g=0;g<x;++g)b=e[g],b.fx==null?b.x+=b.vx*=s:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=s:(b.y=b.fy,b.vy=0);return t}function p(){for(var h=0,g=e.length,x;h<g;++h){if(x=e[h],x.index=h,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var b=TWt*Math.sqrt(.5+h),y=h*kWt;x.x=b*Math.cos(y),x.y=b*Math.sin(y)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function m(h){return h.initialize&&h.initialize(e,c),h}return p(),t={tick:d,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(h){return arguments.length?(e=h,p(),a.forEach(m),t):e},alpha:function(h){return arguments.length?(n=+h,t):n},alphaMin:function(h){return arguments.length?(r=+h,t):r},alphaDecay:function(h){return arguments.length?(i=+h,t):+i},alphaTarget:function(h){return arguments.length?(o=+h,t):o},velocityDecay:function(h){return arguments.length?(s=1-h,t):1-s},randomSource:function(h){return arguments.length?(c=h,a.forEach(m),t):c},force:function(h,g){return arguments.length>1?(g==null?a.delete(h):a.set(h,m(g)),t):a.get(h)},find:function(h,g,x){var b=0,y=e.length,v,C,_,S,E;for(x==null?x=1/0:x*=x,b=0;b<y;++b)S=e[b],v=h-S.x,C=g-S.y,_=v*v+C*C,_<x&&(E=S,x=_);return E},on:function(h,g){return arguments.length>1?(u.on(h,g),t):u.on(h)}}}var TWt,kWt,kpe=w(()=>{"use strict";zVe();Ape();HVe();TWt=10,kWt=Math.PI*(3-Math.sqrt(5))});function Ipe(){var e,t,n,r,i=No(-30),o,s=1,a=1/0,l=.81;function u(p){var m,h=e.length,g=yE(e,YVe,KVe).visitAfter(f);for(r=p,m=0;m<h;++m)t=e[m],g.visit(d)}function c(){if(e){var p,m=e.length,h;for(o=new Array(m),p=0;p<m;++p)h=e[p],o[h.index]=+i(h,p,e)}}function f(p){var m=0,h,g,x=0,b,y,v;if(p.length){for(b=y=v=0;v<4;++v)(h=p[v])&&(g=Math.abs(h.value))&&(m+=h.value,x+=g,b+=g*h.x,y+=g*h.y);p.x=b/x,p.y=y/x}else{h=p,h.x=h.data.x,h.y=h.data.y;do m+=o[h.data.index];while(h=h.next)}p.value=m}function d(p,m,h,g){if(!p.value)return!0;var x=p.x-t.x,b=p.y-t.y,y=g-m,v=x*x+b*b;if(y*y/l<v)return v<a&&(x===0&&(x=yp(n),v+=x*x),b===0&&(b=yp(n),v+=b*b),v<s&&(v=Math.sqrt(s*v)),t.vx+=x*p.value*r/v,t.vy+=b*p.value*r/v),!0;if(p.length||v>=a)return;(p.data!==t||p.next)&&(x===0&&(x=yp(n),v+=x*x),b===0&&(b=yp(n),v+=b*b),v<s&&(v=Math.sqrt(s*v)));do p.data!==t&&(y=o[p.data.index]*r/v,t.vx+=x*y,t.vy+=b*y);while(p=p.next)}return u.initialize=function(p,m){e=p,n=m,c()},u.strength=function(p){return arguments.length?(i=typeof p=="function"?p:No(+p),c(),u):i},u.distanceMin=function(p){return arguments.length?(s=p*p,u):Math.sqrt(s)},u.distanceMax=function(p){return arguments.length?(a=p*p,u):Math.sqrt(a)},u.theta=function(p){return arguments.length?(l=p*p,u):Math.sqrt(l)},u}var XVe=w(()=>{"use strict";ype();qI();YV();kpe()});function Dpe(e){var t=No(.1),n,r,i;typeof e!="function"&&(e=No(e==null?0:+e));function o(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*a}function s(){if(n){var a,l=n.length;for(r=new Array(l),i=new Array(l),a=0;a<l;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:No(+a),s(),o):t},o.x=function(a){return arguments.length?(e=typeof a=="function"?a:No(+a),s(),o):e},o}var ZVe=w(()=>{"use strict";qI()});function Npe(e){var t=No(.1),n,r,i;typeof e!="function"&&(e=No(e==null?0:+e));function o(a){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*a}function s(){if(n){var a,l=n.length;for(r=new Array(l),i=new Array(l),a=0;a<l;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t=typeof a=="function"?a:No(+a),s(),o):t},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:No(+a),s(),o):e},o}var QVe=w(()=>{"use strict";qI()});var JVe=w(()=>{"use strict";nVe();OVe();$Ve();XVe();kpe();ZVe();QVe()});var Ope={};rn(Ope,{force:()=>Rpe});function Rpe(e){ce.call(this,null,e)}function DWt(e,t){return()=>e.touch(t).run()}function NWt(e,t){let n=Tpe(e),r=n.stop,i=n.restart,o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),nWe(n,t,!0).on("end",()=>o=!0)}function nWe(e,t,n,r){var i=Rt(t.forces),o,s,a,l;for(o=0,s=Fpe.length;o<s;++o)a=Fpe[o],a!==NP&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)l=NP+o,a=n||t.modified(NP,o)?RWt(i[o]):r&&FWt(i[o],r)?e.force(l):null,a&&e.force(l,a);for(s=e.numForces||0;o<s;++o)e.force(NP+o,null);return e.numForces=i.length,e}function FWt(e,t){var n,r;for(n in e)if(wn(r=e[n])&&t.modified(Xo(r)))return 1;return 0}function RWt(e){var t,n;Dt(eWe,e.force)||Se("Unrecognized force: "+e.force),t=eWe[e.force]();for(n in e)wn(t[n])&&OWt(t[n],e[n],e);return t}function OWt(e,t,n){e(wn(t)?r=>t(r,n):t)}var eWe,NP,Fpe,IWt,tWe,rWe=w(()=>{"use strict";hs();ao();JVe();eWe={center:xpe,collide:vpe,nbody:Ipe,link:wpe,x:Dpe,y:Npe},NP="forces",Fpe=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],IWt=["static","iterations"],tWe=["x","y","vx","vy"];Rpe.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:tWe}]};$e(Rpe,ce,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(Fpe),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&nWe(n,e,0,t)):(this.value=n=NWt(t.source,e),n.on("tick",DWt(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(IWt)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){let n=t.dataflow;for(let a=this._argops,l=0,u=a.length,c;l<u;++l)if(c=a[l],!(c.name!==NP||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,o=r.length,s;i<o;++i)if(r[i].name==="links"&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(tWe)}})});function MWt(e,t){return e.parent===t.parent?1:2}function $Wt(e){return e.reduce(PWt,0)/e.length}function PWt(e,t){return e+t.x}function LWt(e){return 1+e.reduce(BWt,0)}function BWt(e,t){return Math.max(e,t.y)}function zWt(e){for(var t;t=e.children;)e=t[0];return e}function UWt(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Mpe(){var e=MWt,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var p=d.children;p?(d.x=$Wt(p),d.y=LWt(p)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var l=zWt(o),u=UWt(o),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}var iWe=w(()=>{"use strict"});function jWt(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function oWe(){return this.eachAfter(jWt)}var sWe=w(()=>{"use strict"});function aWe(e,t){let n=-1;for(let r of this)e.call(t,r,++n,this);return this}var lWe=w(()=>{"use strict"});function uWe(e,t){for(var n=this,r=[n],i,o,s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}var cWe=w(()=>{"use strict"});function fWe(e,t){for(var n=this,r=[n],i=[],o,s,a,l=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++l,this);return this}var dWe=w(()=>{"use strict"});function pWe(e,t){let n=-1;for(let r of this)if(e.call(t,r,++n,this))return r}var mWe=w(()=>{"use strict"});function hWe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}var gWe=w(()=>{"use strict"});function xWe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}var bWe=w(()=>{"use strict"});function yWe(e){for(var t=this,n=VWt(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function VWt(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}var vWe=w(()=>{"use strict"});function wWe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}var CWe=w(()=>{"use strict"});function _We(){return Array.from(this)}var SWe=w(()=>{"use strict"});function EWe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}var AWe=w(()=>{"use strict"});function TWe(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}var kWe=w(()=>{"use strict"});function*IWe(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}var DWe=w(()=>{"use strict"});function YI(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=qWt)):t===void 0&&(t=GWt);for(var n=new M1(e),r,i=[n],o,s,a,l;r=i.pop();)if((s=t(r.data))&&(l=(s=Array.from(s)).length))for(r.children=s,a=l-1;a>=0;--a)i.push(o=s[a]=new M1(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore($pe)}function WWt(){return YI(this).eachBefore(HWt)}function GWt(e){return e.children}function qWt(e){return Array.isArray(e)?e[1]:null}function HWt(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function $pe(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function M1(e){this.data=e,this.depth=this.height=0,this.parent=null}var eW=w(()=>{"use strict";sWe();lWe();cWe();dWe();mWe();gWe();bWe();vWe();CWe();SWe();AWe();kWe();DWe();M1.prototype=YI.prototype={constructor:M1,count:oWe,each:aWe,eachAfter:fWe,eachBefore:uWe,find:pWe,sum:hWe,sort:xWe,path:yWe,ancestors:wWe,descendants:_We,leaves:EWe,links:TWe,copy:WWt,[Symbol.iterator]:IWe}});function NWe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function FWe(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}var Ppe=w(()=>{"use strict"});function RWe(e){for(var t=0,n=(e=FWe(Array.from(e))).length,r=[],i,o;t<n;)i=e[t],o&&OWe(o,i)?++t:(o=KWt(r=YWt(r,i)),t=0);return o}function YWt(e,t){var n,r;if(Lpe(t,e))return[t];for(n=0;n<e.length;++n)if(tW(t,e[n])&&Lpe(FP(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(tW(FP(e[n],e[r]),t)&&tW(FP(e[n],t),e[r])&&tW(FP(e[r],t),e[n])&&Lpe(MWe(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function tW(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function OWe(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Lpe(e,t){for(var n=0;n<t.length;++n)if(!OWe(e,t[n]))return!1;return!0}function KWt(e){switch(e.length){case 1:return XWt(e[0]);case 2:return FP(e[0],e[1]);case 3:return MWe(e[0],e[1],e[2])}}function XWt(e){return{x:e.x,y:e.y,r:e.r}}function FP(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,l=o-n,u=s-r,c=a-i,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(r+s+u/f*c)/2,r:(f+i+a)/2}}function MWe(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,l=t.r,u=n.x,c=n.y,f=n.r,d=r-s,p=r-u,m=i-a,h=i-c,g=l-o,x=f-o,b=r*r+i*i-o*o,y=b-s*s-a*a+l*l,v=b-u*u-c*c+f*f,C=p*m-d*h,_=(m*v-h*y)/(C*2)-r,S=(h*g-m*x)/C,E=(p*y-d*v)/(C*2)-i,T=(d*x-p*g)/C,I=S*S+T*T-1,k=2*(o+_*S+E*T),O=_*_+E*E-o*o,F=-(I?(k+Math.sqrt(k*k-4*I*O))/(2*I):O/k);return{x:r+_+S*F,y:i+E+T*F,r:F}}var $We=w(()=>{"use strict";Ppe()});function PWe(e,t,n){var r=e.x-t.x,i,o,s=e.y-t.y,a,l,u=r*r+s*s;u?(o=t.r+n.r,o*=o,l=e.r+n.r,l*=l,o>l?(i=(u+l-o)/(2*u),a=Math.sqrt(Math.max(0,l/u-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(u+o-l)/(2*u),a=Math.sqrt(Math.max(0,o/u-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function LWe(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function BWe(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function nW(e){this._=e,this.next=null,this.previous=null}function zWe(e){if(!(i=(e=NWe(e)).length))return 0;var t,n,r,i,o,s,a,l,u,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;PWe(n,t,r=e[2]),t=new nW(t),n=new nW(n),r=new nW(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(a=3;a<i;++a){PWe(t._,n._,r=e[a]),r=new nW(r),l=n.next,u=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(LWe(l._,r._)){n=l,t.next=n,n.previous=t,--a;continue e}c+=l._.r,l=l.next}else{if(LWe(u._,r._)){t=u,t.next=n,n.previous=t,--a;continue e}f+=u._.r,u=u.previous}while(l!==u.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=BWe(t);(r=r.next)!==n;)(s=BWe(r))<o&&(t=r,o=s);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=RWe(t),a=0;a<i;++a)t=e[a],t.x-=r.x,t.y-=r.y;return r.r}var UWe=w(()=>{"use strict";Ppe();$We()});function jWe(e){return e==null?null:KI(e)}function KI(e){if(typeof e!="function")throw new Error;return e}var rW=w(()=>{"use strict"});function yb(){return 0}function $1(e){return function(){return e}}var Bpe=w(()=>{"use strict"});function ZWt(e){return Math.sqrt(e.value)}function Upe(){var e=null,t=1,n=1,r=yb;function i(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(VWe(e)).eachAfter(zpe(r,.5)).eachBefore(WWe(1)):o.eachBefore(VWe(ZWt)).eachAfter(zpe(yb,1)).eachAfter(zpe(r,o.r/Math.min(t,n))).eachBefore(WWe(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=jWe(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:$1(+o),i):r},i}function VWe(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function zpe(e,t){return function(n){if(r=n.children){var r,i,o=r.length,s=e(n)*t||0,a;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=zWe(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function WWe(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var GWe=w(()=>{"use strict";UWe();rW();Bpe()});function iW(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}var jpe=w(()=>{"use strict"});function vp(e,t,n,r,i){for(var o=e.children,s,a=-1,l=o.length,u=e.value&&(r-t)/e.value;++a<l;)s=o[a],s.y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*u}var XI=w(()=>{"use strict"});function Vpe(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(o(t,a)),r&&s.eachBefore(iW),s}function o(s,a){return function(l){l.children&&vp(l,l.x0,s*(l.depth+1)/a,l.x1,s*(l.depth+2)/a);var u=l.x0,c=l.y0,f=l.x1-n,d=l.y1-n;f<u&&(u=f=(u+f)/2),d<c&&(c=d=(c+d)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=d}}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i}var qWe=w(()=>{"use strict";jpe();XI()});function JWt(e){return e.id}function eGt(e){return e.parentId}function oW(){var e=JWt,t=eGt;function n(r){var i=Array.from(r),o=i.length,s,a,l,u,c,f,d,p=new Map;for(a=0;a<o;++a)s=i[a],c=i[a]=new M1(s),(f=e(s,a,r))!=null&&(f+="")&&(d=c.id=f,p.set(d,p.has(d)?HWe:c)),(f=t(s,a,r))!=null&&(f+="")&&(c.parent=f);for(a=0;a<o;++a)if(c=i[a],f=c.parent){if(u=p.get(f),!u)throw new Error("missing: "+f);if(u===HWe)throw new Error("ambiguous: "+f);u.children?u.children.push(c):u.children=[c],c.parent=u}else{if(l)throw new Error("multiple roots");l=c}if(!l)throw new Error("no root");if(l.parent=QWt,l.eachBefore(function(m){m.depth=m.parent.depth+1,--o}).eachBefore($pe),l.parent=null,o>0)throw new Error("cycle");return l}return n.id=function(r){return arguments.length?(e=KI(r),n):e},n.parentId=function(r){return arguments.length?(t=KI(r),n):t},n}var QWt,HWe,YWe=w(()=>{"use strict";rW();eW();QWt={depth:-1},HWe={}});function tGt(e,t){return e.parent===t.parent?1:2}function Wpe(e){var t=e.children;return t?t[0]:e.t}function Gpe(e){var t=e.children;return t?t[t.length-1]:e.t}function nGt(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function rGt(e){for(var t=0,n=0,r=e.children,i=r.length,o;--i>=0;)o=r[i],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function iGt(e,t,n){return e.a.parent===t.parent?e.a:n}function sW(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function oGt(e){for(var t=new sW(e,0),n,r=[t],i,o,s,a;n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new sW(o[s],s)),i.parent=n;return(t.parent=new sW(null,0)).children=[t],t}function qpe(){var e=tGt,t=1,n=1,r=null;function i(u){var c=oGt(u);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)u.eachBefore(l);else{var f=u,d=u,p=u;u.eachBefore(function(b){b.x<f.x&&(f=b),b.x>d.x&&(d=b),b.depth>p.depth&&(p=b)});var m=f===d?1:e(f,d)/2,h=m-f.x,g=t/(d.x+m+h),x=n/(p.depth||1);u.eachBefore(function(b){b.x=(b.x+h)*g,b.y=b.depth*x})}return u}function o(u){var c=u.children,f=u.parent.children,d=u.i?f[u.i-1]:null;if(c){rGt(u);var p=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+e(u._,d._),u.m=u.z-p):u.z=p}else d&&(u.z=d.z+e(u._,d._));u.parent.A=a(u,d,u.parent.A||f[0])}function s(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function a(u,c,f){if(c){for(var d=u,p=u,m=c,h=d.parent.children[0],g=d.m,x=p.m,b=m.m,y=h.m,v;m=Gpe(m),d=Wpe(d),m&&d;)h=Wpe(h),p=Gpe(p),p.a=u,v=m.z+b-d.z-g+e(m._,d._),v>0&&(nGt(iGt(m,u,f),u,v),g+=v,x+=v),b+=m.m,g+=d.m,y+=h.m,x+=p.m;m&&!Gpe(p)&&(p.t=m,p.m+=b-x),d&&!Wpe(h)&&(h.t=d,h.m+=g-y,f=u)}return f}function l(u){u.x*=t,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],i):r?null:[t,n]},i.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],i):r?[t,n]:null},i}var KWe=w(()=>{"use strict";eW();sW.prototype=Object.create(M1.prototype)});function vb(e,t,n,r,i){for(var o=e.children,s,a=-1,l=o.length,u=e.value&&(i-n)/e.value;++a<l;)s=o[a],s.x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*u}var RP=w(()=>{"use strict"});function Ype(e,t,n,r,i,o){for(var s=[],a=t.children,l,u,c=0,f=0,d=a.length,p,m,h=t.value,g,x,b,y,v,C,_;c<d;){p=i-n,m=o-r;do g=a[f++].value;while(!g&&f<d);for(x=b=g,C=Math.max(m/p,p/m)/(h*e),_=g*g*C,v=Math.max(b/_,_/x);f<d;++f){if(g+=u=a[f].value,u<x&&(x=u),u>b&&(b=u),_=g*g*C,y=Math.max(b/_,_/x),y>v){g-=u;break}v=y}s.push(l={value:g,dice:p<m,children:a.slice(c,f)}),l.dice?vp(l,n,r,i,h?r+=m*g/h:o):vb(l,n,r,h?n+=p*g/h:i,o),h-=g,c=f}return s}var Hpe,OP,aW=w(()=>{"use strict";XI();RP();Hpe=(1+Math.sqrt(5))/2;OP=function e(t){function n(r,i,o,s,a){Ype(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Hpe)});function Kpe(){var e=OP,t=!1,n=1,r=1,i=[0],o=yb,s=yb,a=yb,l=yb,u=yb;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(iW),d}function f(d){var p=i[d.depth],m=d.x0+p,h=d.y0+p,g=d.x1-p,x=d.y1-p;g<m&&(m=g=(m+g)/2),x<h&&(h=x=(h+x)/2),d.x0=m,d.y0=h,d.x1=g,d.y1=x,d.children&&(p=i[d.depth+1]=o(d)/2,m+=u(d)-p,h+=s(d)-p,g-=a(d)-p,x-=l(d)-p,g<m&&(m=g=(m+g)/2),x<h&&(h=x=(h+x)/2),e(d,m,h,g,x))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=KI(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:$1(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s=typeof d=="function"?d:$1(+d),c):s},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:$1(+d),c):a},c.paddingBottom=function(d){return arguments.length?(l=typeof d=="function"?d:$1(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u=typeof d=="function"?d:$1(+d),c):u},c}var XWe=w(()=>{"use strict";jpe();aW();rW();Bpe()});function Xpe(e,t,n,r,i){var o=e.children,s,a=o.length,l,u=new Array(a+1);for(u[0]=l=s=0;s<a;++s)u[s+1]=l+=o[s].value;c(0,a,e.value,t,n,r,i);function c(f,d,p,m,h,g,x){if(f>=d-1){var b=o[f];b.x0=m,b.y0=h,b.x1=g,b.y1=x;return}for(var y=u[f],v=p/2+y,C=f+1,_=d-1;C<_;){var S=C+_>>>1;u[S]<v?C=S+1:_=S}v-u[C-1]<u[C]-v&&f+1<C&&--C;var E=u[C]-y,T=p-E;if(g-m>x-h){var I=p?(m*T+g*E)/p:g;c(f,C,E,m,h,I,x),c(C,d,T,I,h,g,x)}else{var k=p?(h*T+x*E)/p:x;c(f,C,E,m,h,g,k),c(C,d,T,m,k,g,x)}}}var ZWe=w(()=>{"use strict"});function Zpe(e,t,n,r,i){(e.depth&1?vb:vp)(e,t,n,r,i)}var QWe=w(()=>{"use strict";XI();RP()});var Qpe,JWe=w(()=>{"use strict";XI();RP();aW();Qpe=function e(t){function n(r,i,o,s,a){if((l=r._squarify)&&l.ratio===t)for(var l,u,c,f,d=-1,p,m=l.length,h=r.value;++d<m;){for(u=l[d],c=u.children,f=u.value=0,p=c.length;f<p;++f)u.value+=c[f].value;u.dice?vp(u,i,o,s,h?o+=(a-o)*u.value/h:a):vb(u,i,o,h?i+=(s-i)*u.value/h:s,a),h-=u.value}else r._squarify=l=Ype(t,r,i,o,s,a),l.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Hpe)});var eGe=w(()=>{"use strict";iWe();eW();GWe();qWe();YWe();KWe();XWe();ZWe();XI();RP();QWe();aW();JWe()});var fme={};rn(fme,{nest:()=>ime,pack:()=>ome,partition:()=>sme,stratify:()=>ame,tree:()=>lme,treelinks:()=>ume,treemap:()=>cme});function Jpe(e,t,n){let r={};return e.each(i=>{let o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function ime(e){ce.call(this,null,e)}function aGt(){let e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;let s=i.length,a=e[o++],l={},u={},c=-1,f,d,p;for(;++c<s;)f=a(d=i[c])+"",(p=l[f])?p.push(d):l[f]=[d];for(f in l)u[f]=n(l[f],o);return u}function r(i,o){if(++o>e.length)return i;let s=[];for(let a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function wb(e){ce.call(this,null,e)}function uGt(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}function cGt(e,t,n){let r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}function ome(e){wb.call(this,e)}function sme(e){wb.call(this,e)}function ame(e){ce.call(this,null,e)}function lme(e){wb.call(this,e)}function ume(e){ce.call(this,[],e)}function cme(e){wb.call(this,e)}var sGt,lGt,eme,tme,tGe,nme,nGe,rme,rGe=w(()=>{"use strict";hs();ao();eGe();ime.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};sGt=e=>e.values;$e(ime,ce,{transform(e,t){t.source||Se("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&mS(s.data)&&i.rem.push(s.data)}),this.value=o=YI({values:Rt(e.keys).reduce((s,a)=>(s.key(a),s),aGt()).entries(i.source)},sGt),n&&o.each(s=>{s.children&&(s=Cn(s.data),i.add.push(s),i.source.push(s))}),Jpe(o,bt,bt)),i.source.root=o,i}});lGt=(e,t)=>e.parent===t.parent?1:2;$e(wb,ce,{transform(e,t){(!t.source||!t.source.root)&&Se(this.constructor.name+" transform requires a backing tree data source.");let n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Xh(e.sort,s=>s.data)),uGt(n,this.params,e),n.separation&&n.separation(e.separation!==!1?lGt:Lh);try{this.value=n(i)}catch(s){Se(s)}return i.each(s=>cGt(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});eme=["x","y","r","depth","children"];ome.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:eme.length,default:eme}]};$e(ome,wb,{layout:Upe,params:["radius","size","padding"],fields:eme});tme=["x0","y0","x1","y1","depth","children"];sme.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:tme.length,default:tme}]};$e(sme,wb,{layout:Vpe,params:["size","round","padding"],fields:tme});ame.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};$e(ame,ce,{transform(e,t){t.source||Se("Stratify transform requires an upstream data source.");let n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?Jpe(oW().id(e.key).parentId(e.parentKey)(i.source),e.key,Bh):Jpe(oW()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});tGe={tidy:qpe,cluster:Mpe},nme=["x","y","depth","children"];lme.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:nme.length,default:nme}]};$e(lme,wb,{layout(e){let t=e||"tidy";if(Dt(tGe,t))return tGe[t]();Se("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:nme});ume.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};$e(ume,ce,{transform(e,t){let n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||Se("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[bt(s)]=1),r.each(s=>{let a=s.data,l=s.parent&&s.parent.data;l&&o[bt(a)]&&o[bt(l)]&&i.add.push(Cn({source:l,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[bt(s)]=1),n.forEach(s=>{(o[bt(s.source)]||o[bt(s.target)])&&i.mod.push(s)})),i}});nGe={binary:Xpe,dice:vp,slice:vb,slicedice:Zpe,squarify:OP,resquarify:Qpe},rme=["x0","y0","x1","y1","depth","children"];cme.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:rme.length,default:rme}]};$e(cme,wb,{layout(){let e=Kpe();return e.ratio=t=>{let n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Dt(nGe,t)?e.tile(nGe[t]):Se("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:rme})});function mme(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function iGe(){return new mme}var dme,pme,wE,fGt,Vf,oGe=w(()=>{"use strict";dme=Math.PI,pme=2*dme,wE=1e-6,fGt=pme-wE;mme.prototype=iGe.prototype={constructor:mme,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-e,l=r-t,u=o-e,c=s-t,f=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>wE)if(!(Math.abs(c*a-l*u)>wE)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,p=r-s,m=a*a+l*l,h=d*d+p*p,g=Math.sqrt(m),x=Math.sqrt(f),b=i*Math.tan((dme-Math.acos((m+f-h)/(2*g*x)))/2),y=b/x,v=b/g;Math.abs(y-1)>wE&&(this._+="L"+(e+y*u)+","+(t+y*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>u*p)+","+(this._x1=e+v*a)+","+(this._y1=t+v*l)}},arc:function(e,t,n,r,i,o){e=+e,t=+t,n=+n,o=!!o;var s=n*Math.cos(r),a=n*Math.sin(r),l=e+s,u=t+a,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>wE||Math.abs(this._y1-u)>wE)&&(this._+="L"+l+","+u),n&&(f<0&&(f=f%pme+pme),f>fGt?this._+="A"+n+","+n+",0,1,"+c+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):f>wE&&(this._+="A"+n+","+n+",0,"+ +(f>=dme)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};Vf=iGe});var ZI=w(()=>{"use strict";oGe()});function Mn(e){return function(){return e}}var MP=w(()=>{"use strict"});function aGe(e){return e>1?0:e<-1?L1:Math.acos(e)}function gme(e){return e>=1?$P:e<=-1?-$P:Math.asin(e)}var hme,Qs,P1,sGe,lW,wp,CE,_s,L1,$P,uW,cW=w(()=>{"use strict";hme=Math.abs,Qs=Math.atan2,P1=Math.cos,sGe=Math.max,lW=Math.min,wp=Math.sin,CE=Math.sqrt,_s=1e-12,L1=Math.PI,$P=L1/2,uW=2*L1});function dGt(e){return e.innerRadius}function pGt(e){return e.outerRadius}function mGt(e){return e.startAngle}function hGt(e){return e.endAngle}function gGt(e){return e&&e.padAngle}function xGt(e,t,n,r,i,o,s,a){var l=n-e,u=r-t,c=s-i,f=a-o,d=f*l-c*u;if(!(d*d<_s))return d=(c*(t-o)-f*(e-i))/d,[e+d*l,t+d*u]}function fW(e,t,n,r,i,o,s){var a=e-n,l=t-r,u=(s?o:-o)/CE(a*a+l*l),c=u*l,f=-u*a,d=e+c,p=t+f,m=n+c,h=r+f,g=(d+m)/2,x=(p+h)/2,b=m-d,y=h-p,v=b*b+y*y,C=i-o,_=d*h-m*p,S=(y<0?-1:1)*CE(sGe(0,C*C*v-_*_)),E=(_*y-b*S)/v,T=(-_*b-y*S)/v,I=(_*y+b*S)/v,k=(-_*b+y*S)/v,O=E-g,F=T-x,B=I-g,M=k-x;return O*O+F*F>B*B+M*M&&(E=I,T=k),{cx:E,cy:T,x01:-c,y01:-f,x11:E*(i/C-1),y11:T*(i/C-1)}}function xme(){var e=dGt,t=pGt,n=Mn(0),r=null,i=mGt,o=hGt,s=gGt,a=null;function l(){var u,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),p=i.apply(this,arguments)-$P,m=o.apply(this,arguments)-$P,h=hme(m-p),g=m>p;if(a||(a=u=Vf()),d<f&&(c=d,d=f,f=c),!(d>_s))a.moveTo(0,0);else if(h>uW-_s)a.moveTo(d*P1(p),d*wp(p)),a.arc(0,0,d,p,m,!g),f>_s&&(a.moveTo(f*P1(m),f*wp(m)),a.arc(0,0,f,m,p,g));else{var x=p,b=m,y=p,v=m,C=h,_=h,S=s.apply(this,arguments)/2,E=S>_s&&(r?+r.apply(this,arguments):CE(f*f+d*d)),T=lW(hme(d-f)/2,+n.apply(this,arguments)),I=T,k=T,O,F;if(E>_s){var B=gme(E/f*wp(S)),M=gme(E/d*wp(S));(C-=B*2)>_s?(B*=g?1:-1,y+=B,v-=B):(C=0,y=v=(p+m)/2),(_-=M*2)>_s?(M*=g?1:-1,x+=M,b-=M):(_=0,x=b=(p+m)/2)}var z=d*P1(x),W=d*wp(x),H=f*P1(v),Q=f*wp(v);if(T>_s){var re=d*P1(b),oe=d*wp(b),me=f*P1(y),ge=f*wp(y),ye;if(h<L1&&(ye=xGt(z,W,me,ge,re,oe,H,Q))){var ve=z-ye[0],Ne=W-ye[1],Ge=re-ye[0],nt=oe-ye[1],Y=1/wp(aGe((ve*Ge+Ne*nt)/(CE(ve*ve+Ne*Ne)*CE(Ge*Ge+nt*nt)))/2),ie=CE(ye[0]*ye[0]+ye[1]*ye[1]);I=lW(T,(f-ie)/(Y-1)),k=lW(T,(d-ie)/(Y+1))}}_>_s?k>_s?(O=fW(me,ge,z,W,d,k,g),F=fW(re,oe,H,Q,d,k,g),a.moveTo(O.cx+O.x01,O.cy+O.y01),k<T?a.arc(O.cx,O.cy,k,Qs(O.y01,O.x01),Qs(F.y01,F.x01),!g):(a.arc(O.cx,O.cy,k,Qs(O.y01,O.x01),Qs(O.y11,O.x11),!g),a.arc(0,0,d,Qs(O.cy+O.y11,O.cx+O.x11),Qs(F.cy+F.y11,F.cx+F.x11),!g),a.arc(F.cx,F.cy,k,Qs(F.y11,F.x11),Qs(F.y01,F.x01),!g))):(a.moveTo(z,W),a.arc(0,0,d,x,b,!g)):a.moveTo(z,W),!(f>_s)||!(C>_s)?a.lineTo(H,Q):I>_s?(O=fW(H,Q,re,oe,f,-I,g),F=fW(z,W,me,ge,f,-I,g),a.lineTo(O.cx+O.x01,O.cy+O.y01),I<T?a.arc(O.cx,O.cy,I,Qs(O.y01,O.x01),Qs(F.y01,F.x01),!g):(a.arc(O.cx,O.cy,I,Qs(O.y01,O.x01),Qs(O.y11,O.x11),!g),a.arc(0,0,f,Qs(O.cy+O.y11,O.cx+O.x11),Qs(F.cy+F.y11,F.cx+F.x11),g),a.arc(F.cx,F.cy,I,Qs(F.y11,F.x11),Qs(F.y01,F.x01),!g))):a.arc(0,0,f,v,y,g)}if(a.closePath(),u)return a=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-L1/2;return[P1(c)*u,wp(c)*u]},l.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:Mn(+u),l):e},l.outerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:Mn(+u),l):t},l.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:Mn(+u),l):n},l.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Mn(+u),l):r},l.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:Mn(+u),l):i},l.endAngle=function(u){return arguments.length?(o=typeof u=="function"?u:Mn(+u),l):o},l.padAngle=function(u){return arguments.length?(s=typeof u=="function"?u:Mn(+u),l):s},l.context=function(u){return arguments.length?(a=u??null,l):a},l}var lGe=w(()=>{"use strict";ZI();MP();cW()});function dW(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}var S5r,bme=w(()=>{"use strict";S5r=Array.prototype.slice});function uGe(e){this._context=e}function _E(e){return new uGe(e)}var pW=w(()=>{"use strict";uGe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}}});function mW(e){return e[0]}function hW(e){return e[1]}var yme=w(()=>{"use strict"});function PP(e,t){var n=Mn(!0),r=null,i=_E,o=null;e=typeof e=="function"?e:e===void 0?mW:Mn(e),t=typeof t=="function"?t:t===void 0?hW:Mn(t);function s(a){var l,u=(a=dW(a)).length,c,f=!1,d;for(r==null&&(o=i(d=Vf())),l=0;l<=u;++l)!(l<u&&n(c=a[l],l,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,l,a),+t(c,l,a));if(d)return o=null,d+""||null}return s.x=function(a){return arguments.length?(e=typeof a=="function"?a:Mn(+a),s):e},s.y=function(a){return arguments.length?(t=typeof a=="function"?a:Mn(+a),s):t},s.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Mn(!!a),s):n},s.curve=function(a){return arguments.length?(i=a,r!=null&&(o=i(r)),s):i},s.context=function(a){return arguments.length?(a==null?r=o=null:o=i(r=a),s):r},s}var vme=w(()=>{"use strict";ZI();bme();MP();pW();yme()});function gW(e,t,n){var r=null,i=Mn(!0),o=null,s=_E,a=null;e=typeof e=="function"?e:e===void 0?mW:Mn(+e),t=typeof t=="function"?t:t===void 0?Mn(0):Mn(+t),n=typeof n=="function"?n:n===void 0?hW:Mn(+n);function l(c){var f,d,p,m=(c=dW(c)).length,h,g=!1,x,b=new Array(m),y=new Array(m);for(o==null&&(a=s(x=Vf())),f=0;f<=m;++f){if(!(f<m&&i(h=c[f],f,c))===g)if(g=!g)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=f-1;p>=d;--p)a.point(b[p],y[p]);a.lineEnd(),a.areaEnd()}g&&(b[f]=+e(h,f,c),y[f]=+t(h,f,c),a.point(r?+r(h,f,c):b[f],n?+n(h,f,c):y[f]))}if(x)return a=null,x+""||null}function u(){return PP().defined(i).curve(s).context(o)}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Mn(+c),r=null,l):e},l.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Mn(+c),l):e},l.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Mn(+c),l):r},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Mn(+c),n=null,l):t},l.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Mn(+c),l):t},l.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Mn(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Mn(!!c),l):i},l.curve=function(c){return arguments.length?(s=c,o!=null&&(a=s(o)),l):s},l.context=function(c){return arguments.length?(c==null?o=a=null:a=s(o=c),l):o},l}var cGe=w(()=>{"use strict";ZI();bme();MP();pW();vme();yme()});var fGe,dGe=w(()=>{"use strict";cW();fGe={draw:function(e,t){var n=Math.sqrt(t/L1);e.moveTo(n,0),e.arc(0,0,n,0,uW)}}});function wme(e,t){var n=null;e=typeof e=="function"?e:Mn(e||fGe),t=typeof t=="function"?t:Mn(t===void 0?64:+t);function r(){var i;if(n||(n=i=Vf()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Mn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Mn(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}var pGe=w(()=>{"use strict";ZI();dGe();MP()});function Wf(){}var LP=w(()=>{"use strict"});function QI(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function BP(e){this._context=e}function Cme(e){return new BP(e)}var zP=w(()=>{"use strict";BP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:QI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:QI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function mGe(e){this._context=e}function _me(e){return new mGe(e)}var hGe=w(()=>{"use strict";LP();zP();mGe.prototype={areaStart:Wf,areaEnd:Wf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:QI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function gGe(e){this._context=e}function Sme(e){return new gGe(e)}var xGe=w(()=>{"use strict";zP();gGe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:QI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function bGe(e,t){this._basis=new BP(e),this._beta=t}var Eme,yGe=w(()=>{"use strict";zP();bGe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,l;++a<=n;)l=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+l*o),this._beta*t[a]+(1-this._beta)*(i+l*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};Eme=function e(t){function n(r){return t===1?new BP(r):new bGe(r,t)}return n.beta=function(r){return e(+r)},n}(.85)});function JI(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function xW(e,t){this._context=e,this._k=(1-t)/6}var Ame,UP=w(()=>{"use strict";xW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:JI(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:JI(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Ame=function e(t){function n(r){return new xW(r,t)}return n.tension=function(r){return e(+r)},n}(0)});function bW(e,t){this._context=e,this._k=(1-t)/6}var Tme,kme=w(()=>{"use strict";LP();UP();bW.prototype={areaStart:Wf,areaEnd:Wf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:JI(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Tme=function e(t){function n(r){return new bW(r,t)}return n.tension=function(r){return e(+r)},n}(0)});function yW(e,t){this._context=e,this._k=(1-t)/6}var Ime,Dme=w(()=>{"use strict";UP();yW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:JI(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Ime=function e(t){function n(r){return new yW(r,t)}return n.tension=function(r){return e(+r)},n}(0)});function jP(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>_s){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>_s){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function vGe(e,t){this._context=e,this._alpha=t}var Nme,vW=w(()=>{"use strict";cW();UP();vGe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:jP(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Nme=function e(t){function n(r){return t?new vGe(r,t):new xW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5)});function wGe(e,t){this._context=e,this._alpha=t}var Fme,CGe=w(()=>{"use strict";kme();LP();vW();wGe.prototype={areaStart:Wf,areaEnd:Wf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:jP(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Fme=function e(t){function n(r){return t?new wGe(r,t):new bW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5)});function _Ge(e,t){this._context=e,this._alpha=t}var Rme,SGe=w(()=>{"use strict";Dme();vW();_Ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:jP(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};Rme=function e(t){function n(r){return t?new _Ge(r,t):new yW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5)});function EGe(e){this._context=e}function Ome(e){return new EGe(e)}var AGe=w(()=>{"use strict";LP();EGe.prototype={areaStart:Wf,areaEnd:Wf,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}}});function TGe(e){return e<0?-1:1}function kGe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(TGe(o)+TGe(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function IGe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Mme(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function wW(e){this._context=e}function DGe(e){this._context=new NGe(e)}function NGe(e){this._context=e}function $me(e){return new wW(e)}function Pme(e){return new DGe(e)}var FGe=w(()=>{"use strict";wW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Mme(this,this._t0,IGe(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Mme(this,IGe(this,n=kGe(this,e,t)),n);break;default:Mme(this,this._t0,n=kGe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};(DGe.prototype=Object.create(wW.prototype)).point=function(e,t){wW.prototype.point.call(this,t,e)};NGe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}}});function OGe(e){this._context=e}function RGe(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function Lme(e){return new OGe(e)}var MGe=w(()=>{"use strict";OGe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=RGe(e),i=RGe(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}}});function CW(e,t){this._context=e,this._t=t}function Bme(e){return new CW(e,.5)}function zme(e){return new CW(e,0)}function Ume(e){return new CW(e,1)}var $Ge=w(()=>{"use strict";CW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}}});var PGe=w(()=>{"use strict";lGe();cGe();vme();pGe();hGe();xGe();zP();yGe();kme();Dme();UP();CGe();SGe();vW();AGe();pW();FGe();MGe();$Ge()});function zGe(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function bGt(e,t){var n=zGe(e);return function(r,i){return t(n(r),i,e)}}function BGe(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function yu(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function yGt(e){return e<0?"-"+yu(-e,6):e>9999?"+"+yu(e,6):yu(e,4)}function vGt(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":yGt(e.getUTCFullYear(),4)+"-"+yu(e.getUTCMonth()+1,2)+"-"+yu(e.getUTCDate(),2)+(i?"T"+yu(t,2)+":"+yu(n,2)+":"+yu(r,2)+"."+yu(i,3)+"Z":r?"T"+yu(t,2)+":"+yu(n,2)+":"+yu(r,2)+"Z":n||t?"T"+yu(t,2)+":"+yu(n,2)+"Z":"")}function Gme(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var p,m,h=i(f,function(g,x){if(p)return p(g,x-1);m=g,p=d?bGt(g,d):zGe(g)});return h.columns=m||[],h}function i(f,d){var p=[],m=f.length,h=0,g=0,x,b=m<=0,y=!1;f.charCodeAt(m-1)===VP&&--m,f.charCodeAt(m-1)===Wme&&--m;function v(){if(b)return jme;if(y)return y=!1,LGe;var _,S=h,E;if(f.charCodeAt(S)===Vme){for(;h++<m&&f.charCodeAt(h)!==Vme||f.charCodeAt(++h)===Vme;);return(_=h)>=m?b=!0:(E=f.charCodeAt(h++))===VP?y=!0:E===Wme&&(y=!0,f.charCodeAt(h)===VP&&++h),f.slice(S+1,_-1).replace(/""/g,'"')}for(;h<m;){if((E=f.charCodeAt(_=h++))===VP)y=!0;else if(E===Wme)y=!0,f.charCodeAt(h)===VP&&++h;else if(E!==n)continue;return f.slice(S,_)}return b=!0,f.slice(S,m)}for(;(x=v())!==jme;){for(var C=[];x!==LGe&&x!==jme;)C.push(x),x=v();d&&(C=d(C,g++))==null||p.push(C)}return p}function o(f,d){return f.map(function(p){return d.map(function(m){return c(p[m])}).join(e)})}function s(f,d){return d==null&&(d=BGe(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function a(f,d){return d==null&&(d=BGe(f)),o(f,d).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?vGt(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:s,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}var LGe,jme,Vme,VP,Wme,UGe=w(()=>{"use strict";LGe={},jme={},Vme=34,VP=10,Wme=13});var jGe=w(()=>{"use strict";UGe()});function VGe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function SE(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var WP=w(()=>{"use strict"});function Cg(e){return e=SE(Math.abs(e)),e?e[1]:NaN}var GP=w(()=>{"use strict";WP()});function WGe(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}var GGe=w(()=>{"use strict"});function qGe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var HGe=w(()=>{"use strict"});function Cb(e){if(!(t=wGt.exec(e)))throw new Error("invalid format: "+e);var t;return new _W({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function _W(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}var wGt,qme=w(()=>{"use strict";wGt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Cb.prototype=_W.prototype;_W.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function YGe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var KGe=w(()=>{"use strict"});function XGe(e,t){var n=SE(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Hme=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+SE(e,Math.max(0,t+o-1))[0]}var Hme,Yme=w(()=>{"use strict";WP()});function Kme(e,t){var n=SE(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var ZGe=w(()=>{"use strict";WP()});var Xme,QGe=w(()=>{"use strict";WP();Yme();ZGe();Xme={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:VGe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Kme(e*100,t),r:Kme,s:XGe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)}});function Zme(e){return e}var JGe=w(()=>{"use strict"});function qP(e){var t=e.grouping===void 0||e.thousands===void 0?Zme:WGe(eqe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?Zme:qGe(eqe.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=Cb(f);var d=f.fill,p=f.align,m=f.sign,h=f.symbol,g=f.zero,x=f.width,b=f.comma,y=f.precision,v=f.trim,C=f.type;C==="n"?(b=!0,C="g"):Xme[C]||(y===void 0&&(y=12),v=!0,C="g"),(g||d==="0"&&p==="=")&&(g=!0,d="0",p="=");var _=h==="$"?n:h==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",S=h==="$"?r:/[%p]/.test(C)?s:"",E=Xme[C],T=/[defgprs%]/.test(C);y=y===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function I(k){var O=_,F=S,B,M,z;if(C==="c")F=E(k)+F,k="";else{k=+k;var W=k<0||1/k<0;if(k=isNaN(k)?l:E(Math.abs(k),y),v&&(k=YGe(k)),W&&+k==0&&m!=="+"&&(W=!1),O=(W?m==="("?m:a:m==="-"||m==="("?"":m)+O,F=(C==="s"?tqe[8+Hme/3]:"")+F+(W&&m==="("?")":""),T){for(B=-1,M=k.length;++B<M;)if(z=k.charCodeAt(B),48>z||z>57){F=(z===46?i+k.slice(B+1):k.slice(B))+F,k=k.slice(0,B);break}}}b&&!g&&(k=t(k,1/0));var H=O.length+k.length+F.length,Q=H<x?new Array(x-H+1).join(d):"";switch(b&&g&&(k=t(Q+k,Q.length?x-F.length:1/0),Q=""),p){case"<":k=O+k+F+Q;break;case"=":k=O+Q+k+F;break;case"^":k=Q.slice(0,H=Q.length>>1)+O+k+F+Q.slice(H);break;default:k=Q+O+k+F;break}return o(k)}return I.toString=function(){return f+""},I}function c(f,d){var p=u((f=Cb(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(Cg(d)/3)))*3,h=Math.pow(10,-m),g=tqe[8+m/3];return function(x){return p(h*x)+g}}return{format:u,formatPrefix:c}}var eqe,tqe,Qme=w(()=>{"use strict";GP();GGe();HGe();qme();KGe();QGe();Yme();JGe();eqe=Array.prototype.map,tqe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function Jme(e){return SW=qP(e),EW=SW.format,AW=SW.formatPrefix,SW}var SW,EW,AW,nqe=w(()=>{"use strict";Qme();Jme({thousands:",",grouping:[3],currency:["$",""]})});function ehe(e){return Math.max(0,-Cg(Math.abs(e)))}var rqe=w(()=>{"use strict";GP()});function the(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cg(t)/3)))*3-Cg(Math.abs(e)))}var iqe=w(()=>{"use strict";GP()});function nhe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Cg(t)-Cg(e))+1}var oqe=w(()=>{"use strict";GP()});var sqe=w(()=>{"use strict";nqe();Qme();qme();rqe();iqe();oqe()});function HP(e){let t={};return n=>t[n]||(t[n]=e(n))}function CGt(e,t){return n=>{let r=e(n),i=r.indexOf(t);if(i<0)return r;let o=_Gt(r,i),s=o<r.length?r.slice(o):"";for(;--o>i;)if(r[o]!=="0"){++o;break}return r.slice(0,o)+s}}function _Gt(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function lqe(e){let t=HP(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){let i=Cb(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return CGt(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,o,s){s=Cb(s??",f");let a=bl(r,i,o),l=Math.max(Math.abs(r),Math.abs(i)),u;if(s.precision==null)switch(s.type){case"s":return isNaN(u=the(a,l))||(s.precision=u),n(s,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=nhe(a,l))||(s.precision=u-(s.type==="e"));break}case"f":case"%":{isNaN(u=ehe(a))||(s.precision=u-(s.type==="%")*2);break}}return t(s)}}}function uqe(){return rhe=lqe({format:EW,formatPrefix:AW})}function cqe(e){return lqe(qP(e))}function YP(e){return arguments.length?rhe=cqe(e):rhe}function aqe(e,t,n){n=n||{},tn(n)||Se("Invalid time multi-format specifier: ".concat(n));let r=t(_c),i=t(au),o=t(su),s=t(Cl),a=t(Ao),l=t(Hs),u=t(wl),c=t(gs),f=e(n[Df]||".%L"),d=e(n[_c]||":%S"),p=e(n[au]||"%I:%M"),m=e(n[su]||"%I %p"),h=e(n[Cl]||n[qs]||"%a %d"),g=e(n[Ao]||"%b %d"),x=e(n[Hs]||"%B"),b=e(n[wl]||"%B"),y=e(n[gs]||"%Y");return v=>(r(v)<v?f:i(v)<v?d:o(v)<v?p:s(v)<v?m:l(v)<v?a(v)<v?h:g:c(v)<v?u(v)<v?x:b:y)(v)}function fqe(e){let t=HP(e.format),n=HP(e.utcFormat);return{timeFormat:r=>zn(r)?t(r):aqe(t,Zx,r),utcFormat:r=>zn(r)?n(r):aqe(n,Qx,r),timeParse:HP(e.parse),utcParse:HP(e.utcParse)}}function dqe(){return ihe=fqe({format:S1,parse:L9,utcFormat:E1,utcParse:B9})}function pqe(e){return fqe(vI(e))}function EE(e){return arguments.length?ihe=pqe(e):ihe}function TW(e,t){let n=e?cqe(e):YP(),r=t?pqe(t):EE();return ohe(n,r)}function she(e,t){let n=arguments.length;return n&&n!==2&&Se("defaultLocale expects either zero or two arguments."),n?ohe(YP(e),EE(t)):ohe(YP(),EE())}function mqe(){return uqe(),dqe(),she()}var rhe,ihe,ohe,kW=w(()=>{"use strict";kr();sqe();Fk();ao();CI();uqe();dqe();ohe=(e,t)=>Jt({},e,t)});function TGt(e,t){return n=>({options:n||{},sanitize:IGt,load:kGt,fileAccess:!!t,file:DGt(t),http:FGt(e)})}function kGt(e,t){return te(this,null,function*(){let n=yield this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)})}function IGt(e,t){return te(this,null,function*(){t=Jt({},this.options,t);let n=this.fileAccess,r={href:null},i,o,s,a=EGt.test(e.replace(AGt,""));(e==null||typeof e!="string"||!a)&&Se("Sanitize failure, invalid URI: "+Ot(e));let l=SGt.test(e);return(s=t.baseURL)&&!l&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(hqe))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(hqe.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r})}function DGt(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):NGt}function NGt(){return te(this,null,function*(){Se("No file system access.")})}function FGt(e){return e?function(t,n){return te(this,null,function*(){let r=Jt({},this.options.http,n),i=n&&n.response,o=yield e(t,r);return o.ok?wn(o[i])?o[i]():o.text():Se(o.status+""+o.statusText)})}:RGt}function RGt(){return te(this,null,function*(){Se("No HTTP fetch method available.")})}function bqe(e,t){if(!e||!e.length)return"unknown";let n=e.length,r=IW.length,i=IW.map((o,s)=>s+1);for(let o=0,s=0,a,l;o<n;++o)for(l=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&OGt(l)&&!IW[a](l)&&(i[a]=0,++s,s===IW.length))return"string";return LGt[i.reduce((o,s)=>o===0?s:o,0)-1]}function yqe(e,t){return t.reduce((n,r)=>(n[r]=bqe(e,r),n),{})}function gqe(e){let t=function(n,r){let i={delimiter:e};return lhe(n,r?Jt(r,i):i)};return t.responseType="text",t}function lhe(e,t){return t.header&&(e=t.header.map(Ot).join(t.delimiter)+`
`+e),Gme(t.delimiter).parse(e+"")}function BGt(e){return typeof Buffer=="function"&&wn(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function uhe(e,t){let n=t&&t.property?Wd(t.property):gl;return tn(e)&&!BGt(e)?zGt(n(e),t):n(JSON.parse(e))}function zGt(e,t){return!Vt(e)&&zie(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function vqe(e,t){let n,r,i,o;return e=uhe(e,t),t&&t.feature?(n=aS,i=t.feature):t&&t.mesh?(n=lS,i=t.mesh,o=UGt[t.filter]):Se("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):Se("Invalid TopoJSON object: "+i),r&&r.features||[r]}function che(e,t){return arguments.length>1?(DW[e]=t,this):Dt(DW,e)?DW[e]:null}function jGt(e){let t=che(e);return t&&t.responseType||"text"}function VGt(e,t,n,r){t=t||{};let i=che(t.type||"json");return i||Se("Unknown data format type: "+t.type),e=i(e,t),t.parse&&WGt(e,t.parse,n,r),Dt(e,"columns")&&delete e.columns,e}function WGt(e,t,n,r){if(!e.length)return;let i=EE();n=n||i.timeParse,r=r||i.utcParse;let o=e.columns||Object.keys(e[0]),s,a,l,u,c,f;t==="auto"&&(t=yqe(e,o)),o=Object.keys(t);let d=o.map(p=>{let m=t[p],h,g;if(m&&(m.startsWith("date:")||m.startsWith("utc:")))return h=m.split(/:(.+)?/,2),g=h[1],(g[0]==="'"&&g[g.length-1]==="'"||g[0]==='"'&&g[g.length-1]==='"')&&(g=g.slice(1,-1)),(h[0]==="utc"?r:n)(g);if(!ahe[m])throw Error("Illegal format pattern: "+p+":"+m);return ahe[m]});for(l=0,c=e.length,f=o.length;l<c;++l)for(s=e[l],u=0;u<f;++u)a=o[u],s[a]=d[u](s[a])}var SGt,EGt,AGt,hqe,OGt,MGt,$Gt,xqe,PGt,ahe,IW,LGt,UGt,DW,NW,fhe=w(()=>{"use strict";ao();jGe();NU();kW();SGt=/^(data:|([A-Za-z]+:)?\/\/)/,EGt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,AGt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,hqe="file://";OGt=e=>e!=null&&e===e,MGt=e=>e==="true"||e==="false"||e===!0||e===!1,$Gt=e=>!Number.isNaN(Date.parse(e)),xqe=e=>!Number.isNaN(+e)&&!(e instanceof Date),PGt=e=>xqe(e)&&Number.isInteger(+e),ahe={boolean:Wie,integer:qd,number:qd,date:Gie,string:qie,unknown:gl},IW=[MGt,PGt,xqe,$Gt],LGt=["boolean","integer","number","date"];lhe.responseType="text";uhe.responseType="json";UGt={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};vqe.responseType="json";DW={dsv:lhe,csv:gqe(","),tsv:gqe("	"),json:uhe,topojson:vqe};NW=TGt(typeof fetch<"u"&&fetch,null)});function GGt(){Gqe=0}function Dhe(e){return e&&e.gradient}function qqe(e,t,n){let r=e.gradient,i=e.id,o=r==="radial"?BW:"";return i||(i=e.id="gradient_"+Gqe++,r==="radial"?(e.x1=_g(e.x1,.5),e.y1=_g(e.y1,.5),e.r1=_g(e.r1,0),e.x2=_g(e.x2,.5),e.y2=_g(e.y2,.5),e.r2=_g(e.r2,.5),o=BW):(e.x1=_g(e.x1,0),e.y1=_g(e.y1,0),e.x2=_g(e.x2,1),e.y2=_g(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function _g(e,t){return e??t}function Nhe(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}function Fhe(e,t,n){var r=Dt(wqe,e)&&wqe[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}function NE(e){let t=[],n,r,i,o,s,a,l,u,c,f,d=e.slice().replace(KP[0],"###$1").split(KP[1]).slice(1);for(l=0,c=d.length;l<c;++l){for(n=d[l],r=n.slice(1).trim().replace(KP[2],"$1###$2").replace(KP[3],"$1###$2").split(KP[4]),s=n.charAt(0),i=[s],u=0,f=r.length;u<f;++u)(o=+r[u])===o&&i.push(o);if(a=qGt[s.toLowerCase()],i.length-1>a){let p=i.length;for(u=1,t.push([s].concat(i.slice(u,u+=a))),s=s==="M"?"L":s==="m"?"l":s;u<p;u+=a)t.push([s].concat(i.slice(u,u+a)))}else t.push(i)}return t}function YGt(e,t,n,r,i,o,s,a,l){let u=Hqe.call(arguments);if(dhe[u])return dhe[u];let c=s*W1,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);let p=d*(a-e)*.5+f*(l-t)*.5,m=d*(l-t)*.5-f*(a-e)*.5,h=p*p/(n*n)+m*m/(r*r);h>1&&(h=Math.sqrt(h),n*=h,r*=h);let g=d/n,x=f/n,b=-f/r,y=d/r,v=g*a+x*l,C=b*a+y*l,_=g*e+x*t,S=b*e+y*t,T=1/((_-v)*(_-v)+(S-C)*(S-C))-.25;T<0&&(T=0);let I=Math.sqrt(T);o==i&&(I=-I);let k=.5*(v+_)-I*(S-C),O=.5*(C+S)+I*(_-v),F=Math.atan2(C-O,v-k),M=Math.atan2(S-O,_-k)-F;M<0&&o===1?M+=Sg:M>0&&o===0&&(M-=Sg);let z=Math.ceil(Math.abs(M/(AE+.001))),W=[];for(let H=0;H<z;++H){let Q=F+H*M/z,re=F+(H+1)*M/z;W[H]=[k,O,Q,re,n,r,f,d]}return dhe[u]=W}function KGt(e){let t=Hqe.call(e);if(phe[t])return phe[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7];let c=u*s,f=-l*a,d=l*s,p=u*a,m=Math.cos(i),h=Math.sin(i),g=Math.cos(o),x=Math.sin(o),b=.5*(o-i),y=Math.sin(b*.5),v=8/3*y*y/Math.sin(b),C=n+m-v*h,_=r+h+v*m,S=n+g,E=r+x,T=S+v*x,I=E-v*g;return phe[t]=[c*C+f*_,d*C+p*_,c*T+f*I,d*T+p*I,c*S+f*E,d*S+p*E]}function XGt(e,t,n){let r=Gf[0]=e[0];if(r==="a"||r==="A")Gf[1]=t*e[1],Gf[2]=n*e[2],Gf[3]=e[3],Gf[4]=e[4],Gf[5]=e[5],Gf[6]=t*e[6],Gf[7]=n*e[7];else if(r==="h"||r==="H")Gf[1]=t*e[1];else if(r==="v"||r==="V")Gf[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)Gf[i]=(i%2==1?t:n)*e[i];return Gf}function nD(e,t,n,r,i,o){var s,a=null,l=0,u=0,c=0,f=0,d,p,m,h;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),o==null&&(o=i),e.beginPath&&e.beginPath();for(var g=0,x=t.length;g<x;++g){switch(s=t[g],(i!==1||o!==1)&&(s=XGt(s,i,o)),s[0]){case"l":l+=s[1],u+=s[2],e.lineTo(l+n,u+r);break;case"L":l=s[1],u=s[2],e.lineTo(l+n,u+r);break;case"h":l+=s[1],e.lineTo(l+n,u+r);break;case"H":l=s[1],e.lineTo(l+n,u+r);break;case"v":u+=s[1],e.lineTo(l+n,u+r);break;case"V":u=s[1],e.lineTo(l+n,u+r);break;case"m":l+=s[1],u+=s[2],e.moveTo(l+n,u+r);break;case"M":l=s[1],u=s[2],e.moveTo(l+n,u+r);break;case"c":d=l+s[5],p=u+s[6],c=l+s[3],f=u+s[4],e.bezierCurveTo(l+s[1]+n,u+s[2]+r,c+n,f+r,d+n,p+r),l=d,u=p;break;case"C":l=s[5],u=s[6],c=s[3],f=s[4],e.bezierCurveTo(s[1]+n,s[2]+r,c+n,f+r,l+n,u+r);break;case"s":d=l+s[3],p=u+s[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+s[1]+n,u+s[2]+r,d+n,p+r),c=l+s[1],f=u+s[2],l=d,u=p;break;case"S":d=s[3],p=s[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,s[1]+n,s[2]+r,d+n,p+r),l=d,u=p,c=s[1],f=s[2];break;case"q":d=l+s[3],p=u+s[4],c=l+s[1],f=u+s[2],e.quadraticCurveTo(c+n,f+r,d+n,p+r),l=d,u=p;break;case"Q":d=s[3],p=s[4],e.quadraticCurveTo(s[1]+n,s[2]+r,d+n,p+r),l=d,u=p,c=s[1],f=s[2];break;case"t":d=l+s[1],p=u+s[2],a[0].match(/[QqTt]/)===null?(c=l,f=u):a[0]==="t"?(c=2*l-m,f=2*u-h):a[0]==="q"&&(c=2*l-c,f=2*u-f),m=c,h=f,e.quadraticCurveTo(c+n,f+r,d+n,p+r),l=d,u=p,c=l+s[1],f=u+s[2];break;case"T":d=s[1],p=s[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,d+n,p+r),l=d,u=p;break;case"a":Cqe(e,l+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+l+n,s[7]+u+r]),l+=s[6],u+=s[7];break;case"A":Cqe(e,l+n,u+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),l=s[6],u=s[7];break;case"z":case"Z":e.closePath();break}a=s}}function Cqe(e,t,n,r){let i=YGt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){let s=KGt(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}function Yqe(e){return Dt(Sqe,e)?Sqe[e]:ZGt(e)}function ZGt(e){if(!Dt(mhe,e)){let t=NE(e);mhe[e]={draw:function(n,r){nD(n,t,0,0,Math.sqrt(r)/2)}}}return mhe[e]}function QGt(e){return e.x}function JGt(e){return e.y}function eqt(e){return e.width}function tqt(e){return e.height}function _b(e){return typeof e=="function"?e:()=>+e}function FW(e,t,n){return Math.max(t,Math.min(e,n))}function Kqe(){var e=QGt,t=JGt,n=eqt,r=tqt,i=_b(0),o=i,s=i,a=i,l=null;function u(c,f,d){var p,m=f??+e.call(this,c),h=d??+t.call(this,c),g=+n.call(this,c),x=+r.call(this,c),b=Math.min(g,x)/2,y=FW(+i.call(this,c),0,b),v=FW(+o.call(this,c),0,b),C=FW(+s.call(this,c),0,b),_=FW(+a.call(this,c),0,b);if(l||(l=p=Vf()),y<=0&&v<=0&&C<=0&&_<=0)l.rect(m,h,g,x);else{var S=m+g,E=h+x;l.moveTo(m+y,h),l.lineTo(S-v,h),l.bezierCurveTo(S-B1*v,h,S,h+B1*v,S,h+v),l.lineTo(S,E-_),l.bezierCurveTo(S,E-B1*_,S-B1*_,E,S-_,E),l.lineTo(m+C,E),l.bezierCurveTo(m+B1*C,E,m,E-B1*C,m,E-C),l.lineTo(m,h+y),l.bezierCurveTo(m,h+B1*y,m+B1*y,h,m+y,h),l.closePath()}if(p)return l=null,p+""||null}return u.x=function(c){return arguments.length?(e=_b(c),u):e},u.y=function(c){return arguments.length?(t=_b(c),u):t},u.width=function(c){return arguments.length?(n=_b(c),u):n},u.height=function(c){return arguments.length?(r=_b(c),u):r},u.cornerRadius=function(c,f,d,p){return arguments.length?(i=_b(c),o=f!=null?_b(f):i,a=d!=null?_b(d):i,s=p!=null?_b(p):o,u):i},u.context=function(c){return arguments.length?(l=c??null,u):l},u}function Xqe(){var e,t,n,r,i=null,o,s,a,l;function u(f,d,p){let m=p/2;if(o){var h=a-d,g=f-s;if(h||g){var x=Math.sqrt(h*h+g*g),b=(h/=x)*l,y=(g/=x)*l,v=Math.atan2(g,h);i.moveTo(s-b,a-y),i.lineTo(f-h*m,d-g*m),i.arc(f,d,m,v-Math.PI,v),i.lineTo(s+b,a+y),i.arc(s,a,l,v,v+Math.PI)}else i.arc(f,d,m,0,Sg);i.closePath()}else o=1;s=f,a=d,l=m}function c(f){var d,p=f.length,m,h=!1,g;for(i==null&&(i=g=Vf()),d=0;d<=p;++d)!(d<p&&r(m=f[d],d,f))===h&&(h=!h)&&(o=0),h&&u(+e(m,d,f),+t(m,d,f),+n(m,d,f));if(g)return i=null,g+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function iL(e,t){return e??t}function Rhe(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Aqt(e,t){return yqt.context(e)(t)}function Tqt(e,t){let n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?wqt:vqt).curve(Fhe(r,n.orient,n.tension)).context(e)(t)}function kqt(e,t){let n=t[0],r=n.interpolate||"linear";return Cqt.curve(Fhe(r,n.orient,n.tension)).context(e)(t)}function sD(e,t,n,r){return _qt.context(e)(t,n,r)}function Iqt(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Dqt(e,t){return Sqt.context(e)(t)}function Nqt(e,t){return Eqt.context(e)(t)}function Qqe(){Zqe=1}function Ohe(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+Zqe++),s=i.clipping[o]||(i.clipping[o]={id:o});return wn(r)?s.path=r(null):Rhe(n)?s.path=sD(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function Na(e){this.clear(),e&&this.union(e)}function Mhe(e){this.mark=e,this.bounds=this.bounds||new Na}function $he(e){Mhe.call(this,e),this.items=this.items||[]}function Phe(e){this._pending=0,this._loader=e||NW()}function Eqe(e){e._pending+=1}function XP(e){e._pending-=1}function FE(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){let r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Fqt(t,r):0))}return e}function Fqt(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}function aL(e,t){return XW=e,t?(IE=t*W1,vhe=Che=Math.cos(IE),MW=Math.sin(IE),whe=-MW):(vhe=Che=1,IE=MW=whe=0),Oqt}function kqe(e,t,n,r){let i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function Iqe(e,t,n,r,i){let o=r-e+3*t-3*n,s=e+n-2*t,a=e-t,l=0,u=0,c;Math.abs(o)>HGt?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),l=(-s+c)/o,u=(-s-c)/o)):l=.5*a/s,0<l&&l<1&&i(Dqe(l,e,t,n,r)),0<u&&u<1&&i(Dqe(u,e,t,n,r))}function Dqe(e,t,n,r,i){let o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}function Lhe(e){return function(t,n){if(!V1)return!0;e(V1,t),_he.clear().union(t.bounds).intersect(n).round();let{x1:r,y1:i,x2:o,y2:s}=_he;for(let a=i;a<=s;++a)for(let l=r;l<=o;++l)if(V1.isPointInPath(l,a))return!0;return!1}}function Bhe(e,t){return t.contains(e.x||0,e.y||0)}function Jqe(e,t){let n=e.x||0,r=e.y||0,i=e.width||0,o=e.height||0;return t.intersects(_he.set(n,r,n+i,r+o))}function eHe(e,t){let n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:r;return tD(t,n,r,i,o)}function tD(e,t,n,r,i){let{x1:o,y1:s,x2:a,y2:l}=e,u=r-t,c=i-n,f=0,d=1,p,m,h,g;for(g=0;g<4;++g){if(g===0&&(p=-u,m=-(o-t)),g===1&&(p=u,m=a-t),g===2&&(p=-c,m=-(s-n)),g===3&&(p=c,m=l-n),Math.abs(p)<1e-10&&m<0)return!1;if(h=m/p,p<0){if(h>d)return!1;h>f&&(f=h)}else if(p>0){if(h<f)return!1;h<d&&(d=h)}}return!0}function rD(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Cp(e,t){return e??t}function Nqe(e,t){let n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Mqt(e,t,n){let r=n.width(),i=n.height(),o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+Cp(t.x1,.5)*r,n.y1+Cp(t.y1,.5)*i,Math.max(r,i)*Cp(t.r1,0),n.x1+Cp(t.x2,.5)*r,n.y1+Cp(t.y2,.5)*i,Math.max(r,i)*Cp(t.r2,.5));else{let s=Cp(t.x1,0),a=Cp(t.y1,0),l=Cp(t.x2,1),u=Cp(t.y2,0);if(s===l||a===u||r===i)o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+l*r,n.y1+u*i);else{let c=uu(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=Nqe(f.createLinearGradient(s,a,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return Nqe(o,t.stops)}function tHe(e,t,n){return Dhe(n)?Mqt(e,n,t.bounds):n}function zW(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=tHe(e,t,t.fill),!0):!1}function iD(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=tHe(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||$qt),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Pqt(e,t){return e.zindex-t.zindex||e.index-t.index}function zhe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,o;for(i=0,o=t.length;i<o;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Pqt)}function Ep(e,t){var n=e.items,r,i;if(!n||!n.length)return;let o=zhe(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function UW(e,t){var n=e.items,r,i;if(!n||!n.length)return null;let o=zhe(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function Uhe(e){return function(t,n,r){Ep(n,i=>{(!r||r.intersects(i.bounds))&&nHe(e,t,i,i)})}}function Lqt(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&nHe(e,t,n.items[0],n.items)}}function nHe(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(rD(t,n),n.fill&&zW(t,n,i)&&t.fill(),n.stroke&&iD(t,n,i)&&t.stroke()))}function ZW(e){return e=e||Bh,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,UW(n,a=>{let l=a.bounds;if(!(l&&!l.contains(o,s)||!l)&&e(t,a,r,i,o,s))return a})}}function lL(e,t){return function(n,r,i,o){var s=Array.isArray(r)?r[0]:r,a=t??s.fill,l=s.stroke&&n.isPointInStroke,u,c;return l&&(u=s.strokeWidth,c=s.strokeCap,n.lineWidth=u??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,o)||l&&n.isPointInStroke(i,o)}}function jhe(e){return ZW(lL(e))}function DE(e,t){return"translate("+e+","+t+")"}function Vhe(e){return"rotate("+e+")"}function Bqt(e,t){return"scale("+e+","+t+")"}function rHe(e){return DE(e.x||0,e.y||0)}function zqt(e){return DE(e.x||0,e.y||0)+(e.angle?" "+Vhe(e.angle):"")}function Uqt(e){return DE(e.x||0,e.y||0)+(e.angle?" "+Vhe(e.angle):"")+(e.scaleX||e.scaleY?" "+Bqt(e.scaleX||1,e.scaleY||1):"")}function Whe(e,t,n){function r(s,a){s("transform",zqt(a)),s("d",t(null,a))}function i(s,a){return t(aL(s,a.angle),a),FE(s,a).translate(a.x||0,a.y||0)}function o(s,a){var l=a.x||0,u=a.y||0,c=a.angle||0;s.translate(l,u),c&&s.rotate(c*=W1),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:Uhe(o),pick:jhe(o),isect:n||Lhe(o)}}function Vqt(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,o=1/0,s,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<o&&(o=a,s=e[i]));return s}function Wqt(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,o,s;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],o=e[r].y-t[1],s=i*i+o*o,s<n))return e[r];return null}function Gqt(e,t){for(var n=e.length,r,i,o;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],o=r*r+i*i,r=e[n].size||1,o<r*r))return e[n];return null}function Ghe(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(aL(l),c),FE(l,c[0]))}function o(l,u){l.beginPath(),t(l,u)}let s=lL(o);function a(l,u,c,f,d,p){var m=u.items,h=u.bounds;return!m||!m.length||h&&!h.contains(d,p)?null:(c*=l.pixelRatio,f*=l.pixelRatio,s(l,m,c,f)?m[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:Lqt(o),pick:a,isect:Bhe,tip:n}}function Hqt(e,t){var n=t.clip;e.save(),wn(n)?(e.beginPath(),n(e),e.clip()):iHe(e,t.group)}function iHe(e,t){e.beginPath(),Rhe(t)?sD(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function oHe(e){let t=Cp(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Yqt(e,t){e("transform",rHe(t))}function sHe(e,t){let n=oHe(t);e("d",sD(null,t,n,n))}function Kqt(e,t){e("class","background"),e("aria-hidden",!0),sHe(e,t)}function Xqt(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?sHe(e,t):e("d","")}function Zqt(e,t,n){let r=t.clip?Ohe(n,t,t):null;e("clip-path",r)}function Qqt(e,t){if(!t.clip&&t.items){let n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),FE(e,t),e.translate(t.x||0,t.y||0)}function tL(e,t,n,r){let i=oHe(t);e.beginPath(),sD(e,t,(n||0)+i,(r||0)+i)}function nHt(e,t,n){Ep(t,r=>{let i=r.x||0,o=r.y||0,s=r.strokeForeground,a=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&a&&(tL(e,r,i,o),rD(e,r),r.fill&&zW(e,r,a)&&e.fill(),r.stroke&&!s&&iD(e,r,a)&&e.stroke()),e.save(),e.translate(i,o),r.clip&&iHe(e,r),n&&n.translate(-i,-o),Ep(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,o),e.restore(),s&&r.stroke&&a&&(tL(e,r,i,o),rD(e,r),iD(e,r,a)&&e.stroke())})}function rHt(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;let s=n*e.pixelRatio,a=r*e.pixelRatio;return UW(t,l=>{let u,c,f,d=l.bounds;if(d&&!d.contains(i,o))return;c=l.x||0,f=l.y||0;let p=c+(l.width||0),m=f+(l.height||0),h=l.clip;if(h&&(i<c||i>p||o<f||o>m))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,h&&Rhe(l)&&!tHt(e,l,s,a))return e.restore(),null;let g=l.strokeForeground,x=t.interactive!==!1;return x&&g&&l.stroke&&eHt(e,l,s,a)?(e.restore(),l):(u=UW(l,b=>iHt(b,c,f)?this.pick(b,n,r,c,f):null),!u&&x&&(l.fill||!g&&l.stroke)&&Jqt(e,l,s,a)&&(u=l),e.restore(),u||null)})}function iHt(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}function qhe(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Hhe(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Yhe(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function QW(e,t){return e==="center"?t/2:e==="right"?t:0}function JW(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function sHt(e,t,n){let r=qhe(t,n),i=Hhe(t,r),o=Yhe(t,r),s=(t.x||0)-QW(t.align,i),a=(t.y||0)-JW(t.baseline,o),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,nL["xmlns:xlink"],"xlink:href"),e("transform",DE(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function aHt(e,t){let n=t.image,r=Hhe(t,n),i=Yhe(t,n),o=(t.x||0)-QW(t.align,r),s=(t.y||0)-JW(t.baseline,i);return e.set(o,s,o+r,s+i)}function lHt(e,t,n){Ep(t,r=>{if(n&&!n.intersects(r.bounds))return;let i=qhe(r,this),o=Hhe(r,i),s=Yhe(r,i);if(o===0||s===0)return;let a=(r.x||0)-QW(r.align,o),l=(r.y||0)-JW(r.baseline,s),u,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,l+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(rD(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,l,o,s))})}function fHt(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Uqt(t)),e("d",t.path)}function PW(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*W1,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=NE(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),nD(e,l,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):nD(e,l,r,i,o,s)}function dHt(e,t){return PW(aL(e,t.angle),t)?e.set(0,0,0,0):FE(e,t,!0)}function mHt(e,t){e("d",sD(null,t))}function hHt(e,t){var n,r;return FE(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Fqe(e,t){e.beginPath(),sD(e,t)}function xHt(e,t){e("transform",rHe(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function bHt(e,t){var n,r;return FE(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function aHe(e,t,n){var r,i,o,s;return t.stroke&&iD(e,t,n)?(r=t.x||0,i=t.y||0,o=t.x2!=null?t.x2:r,s=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),!0):!1}function yHt(e,t,n){Ep(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&aHe(e,r,i)&&(rD(e,r),e.stroke())}})}function vHt(e,t,n,r){return e.isPointInStroke?aHe(e,t,1)&&e.isPointInStroke(n,r):!1}function lHe(e){Sp.width=e&&V1?Khe:She}function She(e,t){return uHe(q1(e,t),Eg(e))}function uHe(e,t){return~~(.8*e.length*t)}function Khe(e,t){return Eg(e)<=0||!(t=q1(e,t))?0:cHe(t,eG(e))}function cHe(e,t){let n=`(${t}) ${e}`,r=Rqe.get(n);return r===void 0&&(V1.font=t,r=V1.measureText(e).width,Rqe.set(n,r)),r}function Eg(e){return e.fontSize!=null?+e.fontSize||0:11}function G1(e){return e.lineHeight!=null?e.lineHeight:Eg(e)+2}function SHt(e){return Vt(e)?e.length>1?e:e[0]:e}function uL(e){return SHt(e.lineBreak&&e.text&&!Vt(e.text)?e.text.split(e.lineBreak):e.text)}function EHt(e){let t=uL(e);return(Vt(t)?t.length-1:0)*G1(e)}function q1(e,t){let n=t==null?"":(t+"").trim();return e.limit>0&&n.length?THt(e,n):n}function AHt(e){if(Sp.width===Khe){let t=eG(e);return n=>cHe(n,t)}else{let t=Eg(e);return n=>uHe(n,t)}}function THt(e,t){var n=+e.limit,r=AHt(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",o=e.dir==="rtl",s=0,a=t.length,l;if(n-=r(i),o){for(;s<a;)l=s+a>>>1,r(t.slice(l))>n?s=l+1:a=l;return i+t.slice(s)}else{for(;s<a;)l=1+(s+a>>>1),r(t.slice(0,l))<n?s=l:a=l-1;return t.slice(0,s)+i}}function cL(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function eG(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Eg(e)+"px "+cL(e,t)}function Xhe(e){var t=e.baseline,n=Eg(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*G1(e):t==="line-bottom"?.29*n-.5*G1(e):0)}function tG(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-AE,t+=r*Math.cos(i),n+=r*Math.sin(i)),QP.x1=t,QP.y1=n,QP}function IHt(e,t){var n=t.dx||0,r=(t.dy||0)+Xhe(t),i=tG(t),o=i.x1,s=i.y1,a=t.angle||0,l;e("text-anchor",kHt[t.align]||"start"),a?(l=DE(o,s)+" "+Vhe(a),(n||r)&&(l+=" "+DE(n,r))):l=DE(o+n,s+r),e("transform",l)}function Zhe(e,t,n){var r=Sp.height(t),i=t.align,o=tG(t),s=o.x1,a=o.y1,l=t.dx||0,u=(t.dy||0)+Xhe(t)-Math.round(.8*r),c=uL(t),f;if(Vt(c)?(r+=G1(t)*(c.length-1),f=c.reduce((d,p)=>Math.max(d,Sp.width(t,p)),0)):f=Sp.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=s,u+=a,l+f,u+r),t.angle&&!n)e.rotate(t.angle*W1,s,a);else if(n===2)return e.rotatedPoints(t.angle*W1,s,a);return e}function DHt(e,t,n){Ep(t,r=>{var i=r.opacity==null?1:r.opacity,o,s,a,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=eG(r),e.textAlign=r.align||"left",o=tG(r),s=o.x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*W1),s=a=0),s+=r.dx||0,a+=(r.dy||0)+Xhe(r),c=uL(r),rD(e,r),Vt(c))for(u=G1(r),l=0;l<c.length;++l)f=q1(r,c[l]),r.fill&&zW(e,r,i)&&e.fillText(f,s,a),r.stroke&&iD(e,r,i)&&e.strokeText(f,s,a),a+=u;else f=q1(r,c),r.fill&&zW(e,r,i)&&e.fillText(f,s,a),r.stroke&&iD(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})}function NHt(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=tG(t),a=s.x1,l=s.y1,u=Zhe(QP,t,1),c=-t.angle*W1,f=Math.cos(c),d=Math.sin(c),p=f*i-d*o+(a-f*a+d*l),m=d*i+f*o+(l-d*a-f*l);return u.contains(p,m)}function FHt(e,t){let n=Zhe(QP,e,2);return tD(t,n[0],n[1],n[2],n[3])||tD(t,n[0],n[1],n[4],n[5])||tD(t,n[4],n[5],n[6],n[7])||tD(t,n[2],n[3],n[6],n[7])}function Ehe(e,t,n){var r=Mc[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Na),e,n)}function fHe(e,t,n){var r=Mc[e.marktype],i=r.bound,o=e.items,s=o&&o.length,a,l,u,c;if(r.nested)return s?u=o[0]:(Oqe.mark=e,u=Oqe),c=Ehe(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Na,s)for(a=0,l=o.length;a<l;++a)t.union(Ehe(o[a],i,n));return e.bounds=t}function dHe(e,t){return JSON.stringify(e,MHt,t)}function pHe(e){let t=typeof e=="string"?JSON.parse(e):e;return mHe(t)}function mHe(e){var t=e.marktype,n=e.items,r,i,o;if(n)for(i=0,o=n.length;i<o;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&mHe(n[i]);return t&&fHe(e),e}function nG(e){arguments.length?this.root=pHe(e):(this.root=hHe({marktype:"group",name:"root",role:"frame"}),this.root.items=[new $he(this.root)])}function hHe(e,t){let n={bounds:new Na,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function U1(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Qhe(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function vu(e,t,n,r){var i=e.childNodes[t],o;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=U1(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function _p(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function gHe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function fL(e,t){let n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function $Ht(e,t,n,r){var i=e&&e.mark,o,s;if(i&&(o=Mc[i.marktype]).tip){for(s=fL(t,n),s[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}function H1(e,t){this._active=null,this._handlers={},this._loader=e||NW(),this._tooltip=t||PHt}function PHt(e,t,n,r){e.element().setAttribute("title",r||"")}function Ag(e){this._el=null,this._bgcolor=null,this._loader=new Phe(e)}function aD(e,t){H1.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function Mqe(e,t){GHt(t).forEach(n=>qHt(e,n))}function qHt(e,t){let n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function $qe(e,t,n){return function(r){let i=this._active,o=this.pickEvent(r);o===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=o,this.fire(t,r),this.fire(e,r))}}function Pqe(e){return function(t){this.fire(e,t),this._active=null}}function HHt(){return typeof window<"u"&&window.devicePixelRatio||1}function KHt(e,t,n,r,i,o){let s=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),l=s?YHt:i;e.width=t*l,e.height=n*l;for(let u in o)a[u]=o[u];return s&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function HW(e){Ag.call(this,e),this._options={},this._redraw=!1,this._dirty=new Na,this._tempb=new Na}function ZHt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}function Jhe(e,t){H1.call(this,e,t);let n=this;n._hrefHandler=Ihe(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=Ihe(n,(r,i)=>{n.handleTooltip(r,i,r.type!==rL)})}function SHe(e,t){let n=t.aria===!1;if(e(wHe,n||void 0),n||t.description==null)for(let r in zqe)e(zqe[r],void 0);else{let r=t.mark.marktype;e(ege,t.description),e(tge,t.ariaRole||(r==="group"?CHe:rge)),e(nge,t.ariaRoleDescription||`${r} mark`)}}function EHe(e){return e.aria===!1?{[wHe]:!0}:QHt[e.role]?null:Bqe[e.role]?eYt(e,Bqe[e.role]):JHt(e)}function JHt(e){let t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return _He(n?CHe:rge,`${t} mark container`,e.description)}function eYt(e,t){try{let n=e.items[0],r=t.caption||(()=>"");return _He(t.role||rge,t.desc,n.description||r(n))}catch{return null}}function Uqe(e){return Rt(e.text).join(" ")}function tYt(e){let t=e.datum,n=e.orient,r=t.title?AHe(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${k1(a)?"discrete":a} scale with ${Mfe(s,o,e)}`}function nYt(e){let t=e.datum,n=t.title?AHe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,l=s.dataflow.locale();return iYt(r)+(n?` titled '${n}'`:"")+` for ${rYt(o)} with ${Mfe(l,a,e)}`}function AHe(e){try{return Rt(Fn(e.items).items[0].text).join(" ")}catch{return null}}function rYt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Fn(e)}function iYt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function ige(){let e="",t="",n="",r=[],i=()=>t=n="",o=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},s=(l,u)=>(u!=null&&(t+=` ${l}="${oYt(u)}"`),a),a={open(l,...u){o(l),t="<"+l;for(let c of u)for(let f in c)s(f,c[f]);return a},close(){let l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),a},attr:s,text:l=>(n+=THe(l),a),toString:()=>e};return a}function IHe(e,t){if(e.open(t.tagName),t.hasAttributes()){let n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){let n=t.childNodes,r=n.length;for(let i=0;i<r;i++){let o=n[i];o.nodeType===3?e.text(o.nodeValue):IHe(e,o)}}return e.close()}function oge(e){Ag.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}function Vqe(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function sYt(e,t,n){let r,i,o;if(t.gradient==="radial"){let s=vu(e,n++,"pattern",es);j1(s,{id:BW+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=vu(s,0,"rect",es),j1(s,{width:1,height:1,fill:`url(${NHe()}#${t.id})`}),e=vu(e,n++,"radialGradient",es),j1(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=vu(e,n++,"linearGradient",es),j1(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=vu(e,r,"stop",es),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return _p(e,r),n}function aYt(e,t,n){let r;return e=vu(e,n,"clipPath",es),e.setAttribute("id",t.id),t.path?(r=vu(e,0,"path",es),r.setAttribute("d",t.path)):(r=vu(e,0,"rect",es),j1(r,{x:0,y:0,width:t.width,height:t.height})),_p(e,1),n+1}function lYt(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Ep(n,o=>{r=e.mark(t,o,r),++i}),_p(t,1+i)}function Wqe(e,t,n,r,i){let o=e._svg,s;if(!o&&(s=t.ownerDocument,o=U1(s,r,es),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},r==="g"))){let a=U1(s,"path",es);o.appendChild(a),a.__data__=e;let l=U1(s,"g",es);o.appendChild(l),l.__data__=e;let u=U1(s,"path",es);o.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(o.ownerSVGElement!==i||uYt(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function uYt(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}function eL(e,t,n){t!==Da[e]&&(n?fYt(Sb,e,t,n):Rl(Sb,e,t),Da[e]=t)}function bhe(e,t,n){n!==Da[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Da[t]=n)}function j1(e,t){for(let n in t)Rl(e,n,t[n])}function Rl(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function fYt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function NHe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function sge(e){Ag.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}function dYt(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=cL(t),e["font-size"]=Eg(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(let o in YW){let s=t[o],a=YW[o];s==="transparent"&&(a==="fill"||a==="stroke")||s!=null&&(Dhe(s)&&(s=qqe(s,i.gradient,"")),e[a]=s)}return e}function dL(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(oD[e]=t,this):oD[e]}function age(e,t,n){let r=[],i=new Na().union(t),o=e.marktype;return o?$He(e,i,n,r):o==="group"?PHe(e,i,n,r):Se("Intersect scene must be mark node or group item.")}function $He(e,t,n,r){if(pYt(e,t,n)){let i=e.items,o=e.marktype,s=i.length,a=0;if(o==="group")for(;a<s;++a)PHe(i[a],t,n,r);else for(let l=Mc[o].isect;a<s;++a){let u=i[a];LHe(u,t,l)&&r.push(u)}}return r}function pYt(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function PHe(e,t,n,r){n&&n(e.mark)&&LHe(e,t,Mc.group.isect)&&r.push(e);let i=e.items,o=i&&i.length;if(o){let s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let l=0;l<o;++l)$He(i[l],t,n,r);t.translate(s,a)}return r}function LHe(e,t,n){let r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}function mYt(e){let t=e.clip;if(wn(t))t(aL(yhe.clear()));else if(t)yhe.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(yhe)}function lge(e,t,n){return e===t?!0:n==="path"?BHe(e,t):e instanceof Date&&t instanceof Date?+e==+t:zh(e)&&zh(t)?Math.abs(e-t)<=hYt:!e||!t||!tn(e)&&!tn(t)?e==t:gYt(e,t)}function BHe(e,t){return lge(NE(e),NE(t))}function gYt(e,t){var n=Object.keys(e),r=Object.keys(t),i,o;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(i=n[o],!lge(e[i],t[i],i))return!1;return typeof e==typeof t}function xYt(){Qqe(),GGt()}var Gqe,BW,wqe,qGt,KP,W1,HGt,AE,Sg,eD,dhe,phe,Hqe,Gf,_qe,Sqe,mhe,B1,oL,sL,nqt,rqt,iqt,oqt,sqt,aqt,lqt,uqt,cqt,fqt,dqt,pqt,mqt,hqt,gqt,xqt,KW,bqt,yqt,vqt,wqt,Cqt,_qt,Sqt,Eqt,Zqe,Rqt,XW,RW,OW,IE,vhe,MW,whe,Che,z1,$W,Aqe,Tqe,TE,kE,hhe,ghe,Oqt,V1,_he,$qt,jqt,qqt,Jqt,eHt,tHt,oHt,nL,uHt,cHt,pHt,gHt,wHt,CHt,_Ht,Rqe,Sp,kHt,QP,RHt,OHt,Mc,Oqe,MHt,LHt,BHt,zHt,xHe,LW,bHe,Ahe,UHt,jW,JP,yHe,VW,jHt,VHt,vHe,WW,GW,qW,WHt,The,rL,khe,GHt,YHt,Lqe,XHt,Ihe,wHe,ege,tge,nge,CHe,rge,_He,QHt,Bqe,zqe,THe,oYt,kHe,YW,DHe,ZP,jqe,es,xhe,Sb,Da,cYt,FHe,RHe,OHe,MHe,Eb,oD,yhe,hYt,pL=w(()=>{"use strict";ao();PGe();ZI();Lk();fhe();TI();Gqe=0;BW="p_";wqe={basis:{curve:Cme},"basis-closed":{curve:_me},"basis-open":{curve:Sme},bundle:{curve:Eme,tension:"beta",value:.85},cardinal:{curve:Ame,tension:"tension",value:0},"cardinal-open":{curve:Ime,tension:"tension",value:0},"cardinal-closed":{curve:Tme,tension:"tension",value:0},"catmull-rom":{curve:Nme,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Fme,tension:"alpha",value:.5},"catmull-rom-open":{curve:Rme,tension:"alpha",value:.5},linear:{curve:_E},"linear-closed":{curve:Ome},monotone:{horizontal:Pme,vertical:$me},natural:{curve:Lme},step:{curve:Bme},"step-after":{curve:Ume},"step-before":{curve:zme}};qGt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},KP=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];W1=Math.PI/180,HGt=1e-14,AE=Math.PI/2,Sg=Math.PI*2,eD=Math.sqrt(3)/2,dhe={},phe={},Hqe=[].join;Gf=["l",0,0,0,0,0,0,0];_qe=.5773502691896257,Sqe={circle:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Sg)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=eD*n,i=r-n*_qe,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=eD*n,i=r-n*_qe;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=eD*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=eD*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=eD*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=eD*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){let n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};mhe={};B1=.448084975506;oL=e=>e.x||0,sL=e=>e.y||0,nqt=e=>e.width||0,rqt=e=>e.height||0,iqt=e=>(e.x||0)+(e.width||0),oqt=e=>(e.y||0)+(e.height||0),sqt=e=>e.startAngle||0,aqt=e=>e.endAngle||0,lqt=e=>e.padAngle||0,uqt=e=>e.innerRadius||0,cqt=e=>e.outerRadius||0,fqt=e=>e.cornerRadius||0,dqt=e=>iL(e.cornerRadiusTopLeft,e.cornerRadius)||0,pqt=e=>iL(e.cornerRadiusTopRight,e.cornerRadius)||0,mqt=e=>iL(e.cornerRadiusBottomRight,e.cornerRadius)||0,hqt=e=>iL(e.cornerRadiusBottomLeft,e.cornerRadius)||0,gqt=e=>iL(e.size,64),xqt=e=>e.size||1,KW=e=>e.defined!==!1,bqt=e=>Yqe(e.shape||"circle"),yqt=xme().startAngle(sqt).endAngle(aqt).padAngle(lqt).innerRadius(uqt).outerRadius(cqt).cornerRadius(fqt),vqt=gW().x(oL).y1(sL).y0(oqt).defined(KW),wqt=gW().y(sL).x1(oL).x0(iqt).defined(KW),Cqt=PP().x(oL).y(sL).defined(KW),_qt=Kqe().x(oL).y(sL).width(nqt).height(rqt).cornerRadius(dqt,pqt,mqt,hqt),Sqt=wme().type(bqt).size(gqt),Eqt=Xqe().x(oL).y(sL).defined(KW).size(xqt);Zqe=1;Na.prototype={clone(){return new Na(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){let r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*r-l*i+u,l*r+a*i+c,a*r-l*s+u,l*r+a*s+c,a*o-l*i+u,l*o+a*i+c,a*o-l*s+u,l*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};$e($he,Mhe);Phe.prototype={pending(){return this._pending},sanitizeURL(e){let t=this;return Eqe(t),t._loader.sanitize(e,{context:"href"}).then(n=>(XP(t),n)).catch(()=>(XP(t),null))},loadImage(e){let t=this,n=qj();return Eqe(t),t._loader.sanitize(e,{context:"image"}).then(r=>{let i=r.href;if(!i||!n)throw{url:i};let o=new n,s=Dt(r,"crossOrigin")?r.crossOrigin:"anonymous";return s!=null&&(o.crossOrigin=s),o.onload=()=>XP(t),o.onerror=()=>XP(t),o.src=i,o}).catch(r=>(XP(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){let e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};Rqt=Sg-1e-8,z1=(e,t)=>XW.add(e,t),$W=(e,t)=>z1(RW=e,OW=t),Aqe=e=>z1(e,XW.y1),Tqe=e=>z1(XW.x1,e),TE=(e,t)=>vhe*e+whe*t,kE=(e,t)=>MW*e+Che*t,hhe=(e,t)=>z1(TE(e,t),kE(e,t)),ghe=(e,t)=>$W(TE(e,t),kE(e,t));Oqt={beginPath(){},closePath(){},moveTo:ghe,lineTo:ghe,rect(e,t,n,r){IE?(hhe(e+n,t),hhe(e+n,t+r),hhe(e,t+r),ghe(e,t)):(z1(e+n,t+r),$W(e,t))},quadraticCurveTo(e,t,n,r){let i=TE(e,t),o=kE(e,t),s=TE(n,r),a=kE(n,r);kqe(RW,i,s,Aqe),kqe(OW,o,a,Tqe),$W(s,a)},bezierCurveTo(e,t,n,r,i,o){let s=TE(e,t),a=kE(e,t),l=TE(n,r),u=kE(n,r),c=TE(i,o),f=kE(i,o);Iqe(RW,s,l,c,Aqe),Iqe(OW,a,u,f,Tqe),$W(c,f)},arc(e,t,n,r,i,o){if(r+=IE,i+=IE,RW=n*Math.cos(i)+e,OW=n*Math.sin(i)+t,Math.abs(i-r)>Rqt)z1(e-n,t-n),z1(e+n,t+n);else{let s=u=>z1(n*Math.cos(u)+e,n*Math.sin(u)+t),a,l;if(s(r),s(i),i!==r)if(r=r%Sg,r<0&&(r+=Sg),i=i%Sg,i<0&&(i+=Sg),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=Sg,a=r-r%AE,l=0;l<4&&a>i;++l,a-=AE)s(a);else for(a=r-r%AE+AE,l=0;l<4&&a<i;++l,a=a+AE)s(a)}}};V1=(V1=uu(1,1))?V1.getContext("2d"):null,_he=new Na;$qt=[];jqt=Whe("arc",Aqt);qqt=Ghe("area",Tqt,Vqt);Jqt=lL(tL),eHt=lL(tL,!1),tHt=lL(tL,!0);oHt={type:"group",tag:"g",nested:!1,attr:Yqt,bound:Qqt,draw:nHt,pick:rHt,isect:Jqe,content:Zqt,background:Kqt,foreground:Xqt},nL={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};uHt={type:"image",tag:"image",nested:!1,attr:sHt,bound:aHt,draw:lHt,pick:ZW(),isect:Bh,get:qhe,xOffset:QW,yOffset:JW},cHt=Ghe("line",kqt,Wqt);pHt={type:"path",tag:"path",nested:!1,attr:fHt,bound:dHt,draw:Uhe(PW),pick:jhe(PW),isect:Lhe(PW)};gHt={type:"rect",tag:"path",nested:!1,attr:mHt,bound:hHt,draw:Uhe(Fqe),pick:jhe(Fqe),isect:Jqe};wHt={type:"rule",tag:"line",nested:!1,attr:xHt,bound:bHt,draw:yHt,pick:ZW(vHt),isect:eHe},CHt=Whe("shape",Iqt),_Ht=Whe("symbol",Dqt,Bhe),Rqe=jie(),Sp={height:Eg,measureWidth:Khe,estimateWidth:She,width:She,canvas:lHe};lHe(!0);kHt={left:"start",center:"middle",right:"end"},QP=new Na;RHt={type:"text",tag:"text",nested:!1,attr:IHt,bound:Zhe,draw:DHt,pick:ZW(NHt),isect:FHt},OHt=Ghe("trail",Nqt,Gqt),Mc={arc:jqt,area:qqt,group:oHt,image:uHt,line:cHt,path:pHt,rect:gHt,rule:wHt,shape:CHt,symbol:_Ht,text:RHt,trail:OHt};Oqe={mark:null};MHt=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];nG.prototype={toJSON(e){return dHe(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];let r=hHe(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};H1.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){let t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(let r in t)n.push(...t[r]);return n},eventName(e){let t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{let i=new MouseEvent(e.type,e),o=U1(null,"a");for(let s in r)o.setAttribute(s,r[s]);o.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=$Ht(t,e,this.canvas(),this._origin);let r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){let t=this.canvas();if(!t)return;let n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),s=i.height(),a=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,l+=e.y||0;return{x:a,y:l,width:o,height:s,left:a,top:l,right:a+o,bottom:l+s}}};Ag.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){let t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){let t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){let i=n._call;n._ready=n._loader.ready().then(o=>{o&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};LHt="keydown",BHt="keypress",zHt="keyup",xHe="dragenter",LW="dragleave",bHe="dragover",Ahe="mousedown",UHt="mouseup",jW="mousemove",JP="mouseout",yHe="mouseover",VW="click",jHt="dblclick",VHt="wheel",vHe="mousewheel",WW="touchstart",GW="touchmove",qW="touchend",WHt=[LHt,BHt,zHt,xHe,LW,bHe,Ahe,UHt,jW,JP,yHe,VW,jHt,VHt,vHe,WW,GW,qW],The=jW,rL=JP,khe=VW;GHt=e=>e===WW||e===GW||e===qW?[WW,GW,qW]:[e];$e(aD,H1,{initialize(e,t,n){return this._canvas=e&&Qhe(e,"canvas"),[VW,Ahe,jW,JP,LW].forEach(r=>Mqe(this,r)),H1.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:WHt,DOMMouseScroll(e){this.fire(vHe,e)},mousemove:$qe(jW,yHe,JP),dragover:$qe(bHe,xHe,LW),mouseout:Pqe(JP),dragleave:Pqe(LW),mousedown(e){this._down=this._active,this.fire(Ahe,e)},click(e){this._down===this._active&&(this.fire(VW,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(WW,e,!0)},touchmove(e){this.fire(GW,e,!0)},touchend(e){this.fire(qW,e,!0),this._touch=null},fire(e,t,n){let r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===khe&&r&&r.href?this.handleHref(t,r,r.href):(e===The||e===rL)&&this.handleTooltip(t,r,e!==rL),i)for(let o=0,s=i.length;o<s;++o)i[o].handler.call(this._obj,t,r)},on(e,t){let n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(Mqe(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){let n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){let t=fL(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){let o=this.context();return Mc[e.marktype].pick.call(this,o,e,t,n,r,i)}});YHt=HHt();Lqe=Ag.prototype,XHt=(e,t,n)=>new Na().set(0,0,t,n).translate(-e[0],-e[1]);$e(HW,Ag,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:uu(1,1,this._options.type),e&&this._canvas&&(_p(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Lqe.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(Lqe.resize.call(this,e,t,n,r),this._canvas)KHt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{let i=this._options.externalContext;i||Se("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){let t=this._tempb.clear().union(e.bounds),n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){let t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,s=XHt(n,r,i);t.save();let a=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):ZHt(t,s.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,a),t.restore(),o.clear(),this},draw(e,t,n){let r=Mc[t.marktype];t.clip&&Hqt(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){let i=this._options,o=this.context();i.type!=="pdf"&&!i.externalContext&&o.clearRect(e,t,n,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});Ihe=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};$e(Jhe,H1,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(khe,this._hrefHandler),r.removeEventListener(The,this._tooltipHandler),r.removeEventListener(rL,this._tooltipHandler)),this._svg=r=e&&Qhe(e,"svg"),r&&(r.addEventListener(khe,this._hrefHandler),r.addEventListener(The,this._tooltipHandler),r.addEventListener(rL,this._tooltipHandler)),H1.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){let n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){let o={type:e,handler:t,listener:Ihe(this,t)};(r[n]||(r[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){let n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});wHe="aria-hidden",ege="aria-label",tge="role",nge="aria-roledescription",CHe="graphics-object",rge="graphics-symbol",_He=(e,t,n)=>({[tge]:e,[nge]:t,[ege]:n||void 0}),QHt=wa(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Bqe={axis:{desc:"axis",caption:tYt},legend:{desc:"legend",caption:nYt},"title-text":{desc:"title",caption:e=>`Title text '${Uqe(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Uqe(e)}'`}},zqe={ariaRole:tge,ariaRoleDescription:nge,description:ege};THe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),oYt=e=>THe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");kHe=e=>IHe(ige(),e)+"";YW={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},DHe={fill:"none","stroke-miterlimit":10},ZP=0,jqe="http://www.w3.org/2000/xmlns/",es=nL.xmlns;xhe=Ag.prototype;$e(oge,Ag,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=vu(e,0,"svg",es),this._svg.setAttributeNS(jqe,"xmlns",es),this._svg.setAttributeNS(jqe,"xmlns:xlink",nL["xmlns:xlink"]),this._svg.setAttribute("version",nL.version),this._svg.setAttribute("class","marks"),_p(e,1),this._root=vu(this._svg,ZP,"g",es),j1(this._root,DHe),_p(this._svg,ZP+1)),this.background(this._bgcolor),xhe.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),xhe.background.apply(this,arguments)},resize(e,t,n,r){return xhe.resize.call(this,e,t,n,r),this._svg&&(j1(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){let e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=vu(e,ZP,"rect",es),j1(n,{width:this._width,height:this._height,fill:t}));let r=kHe(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),_p(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;let e=this._dirty;if(!e.length||!this._dirtyID)return!0;let t=++this._dirtyID,n,r,i,o,s,a,l;for(s=0,a=e.length;s<a;++s)if(n=e[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Mc[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Vqe(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=o.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Vqe(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;let r=this._svg,i=Mc[t.marktype],o=t.interactive===!1?"none":null,s=i.tag==="g",a=null,l=0,u=Wqe(t,e,n,"g",r);u.setAttribute("class",gHe(t));let c=EHe(t);for(let d in c)Rl(u,d,c[d]);s||Rl(u,"pointer-events",o),Rl(u,"clip-path",t.clip?Ohe(this,t,t.group):null);let f=d=>{let p=this.isDirty(d),m=Wqe(d,u,a,i.tag,r);p&&(this._update(i,m,d),s&&lYt(this,m,d)),a=m,++l};return i.nested?t.items.length&&f(t.items[0]):Ep(t,f),_p(u,l),u},_update(e,t,n){Sb=t,Da=t.__values__,SHe(eL,n),e.attr(eL,n,this);let r=cYt[e.type];r&&r.call(this,e,t,n),Sb&&this.style(Sb,n)},style(e,t){if(t!=null)for(let n in YW){let r=n==="font"?cL(t):t[n];if(r===Da[n])continue;let i=YW[n];r==null?e.removeAttribute(i):(Dhe(r)&&(r=qqe(r,this._defs.gradient,NHe())),e.setAttribute(i,r+"")),Da[n]=r}},defs(){let e=this._svg,t=this._defs,n=t.el,r=0;for(let i in t.gradient)n||(t.el=n=vu(e,ZP+1,"defs",es)),r=sYt(n,t.gradient[i],r);for(let i in t.clipping)n||(t.el=n=vu(e,ZP+1,"defs",es)),r=aYt(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):_p(n,r))},_clearDefs(){let e=this._defs;e.gradient={},e.clipping={}}});Sb=null,Da=null,cYt={group(e,t,n){let r=Sb=t.childNodes[2];Da=r.__values__,e.foreground(eL,n,this),Da=t.__values__,Sb=t.childNodes[1],e.content(eL,n,this);let i=Sb=t.childNodes[0];e.background(eL,n,this);let o=n.mark.interactive===!1?"none":null;if(o!==Da.events&&(Rl(r,"pointer-events",o),Rl(i,"pointer-events",o),Da.events=o),n.strokeForeground&&n.stroke){let s=n.fill;Rl(r,"display",null),this.style(i,n),Rl(i,"stroke",null),s&&(n.fill=null),Da=r.__values__,this.style(r,n),s&&(n.fill=s),Sb=null}else Rl(r,"display","none")},image(e,t,n){n.smooth===!1?(bhe(t,"image-rendering","optimizeSpeed"),bhe(t,"image-rendering","pixelated")):bhe(t,"image-rendering",null)},text(e,t,n){let r=uL(n),i,o,s,a;Vt(r)?(o=r.map(l=>q1(n,l)),i=o.join(`
`),i!==Da.text&&(_p(t,0),s=t.ownerDocument,a=G1(n),o.forEach((l,u)=>{let c=U1(s,"tspan",es);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Da.text=i)):(o=q1(n,r),o!==Da.text&&(t.textContent=o,Da.text=o)),Rl(t,"font-family",cL(n)),Rl(t,"font-size",Eg(n)+"px"),Rl(t,"font-style",n.fontStyle),Rl(t,"font-variant",n.fontVariant),Rl(t,"font-weight",n.fontWeight)}};$e(sge,Ag,{svg(){return this._text},_render(e){let t=ige();t.open("svg",Jt({},nL,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));let n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",DHe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){let n=Mc[t.marktype],r=n.tag,i=[SHe,n.attr];e.open("g",{class:gHe(t),"clip-path":t.clip?Ohe(this,t,t.group):null},EHe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});let o=s=>{let a=this.href(s);if(a&&e.open("a",a),e.open(r,this.attr(t,s,i,r!=="g"?r:null)),r==="text"){let l=uL(s);if(Vt(l)){let u={x:0,dy:G1(s)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(q1(s,l[c])).close()}else e.text(q1(s,l))}else if(r==="g"){let l=s.strokeForeground,u=s.fill,c=s.stroke;l&&c&&(s.stroke=null),e.open("path",this.attr(t,s,n.background,"bgrect")).close(),e.open("g",this.attr(t,s,n.content)),Ep(s,f=>this.mark(e,f)),e.close(),l&&c?(u&&(s.fill=null),s.stroke=c,e.open("path",this.attr(t,s,n.foreground,"bgrect")).close(),u&&(s.fill=u)):e.open("path",this.attr(t,s,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):Ep(t,o),e.close()},href(e){let t=e.href,n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){let i={},o=(s,a,l,u)=>{i[u||s]=a};return Array.isArray(n)?n.forEach(s=>s(o,t,this)):n(o,t,this),r&&dYt(i,t,e,r,this._defs),i},defs(e){let t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(let i in t){let o=t[i],s=o.stops;o.gradient==="radial"?(e.open("pattern",{id:BW+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:i,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let a=0;a<s.length;++a)e.open("stop",{offset:s[a].offset,"stop-color":s[a].color}).close();e.close()}for(let i in n){let o=n[i];e.open("clipPath",{id:i}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});FHe="canvas",RHe="png",OHe="svg",MHe="none",Eb={Canvas:FHe,PNG:RHe,SVG:OHe,None:MHe},oD={};oD[FHe]=oD[RHe]={renderer:HW,headless:HW,handler:aD};oD[OHe]={renderer:oge,headless:sge,handler:Jhe};oD[MHe]={};yhe=new Na;hYt=1e-9});var xge={};rn(xge,{label:()=>gge});function wYt(e,t){let n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function CYt(e,t,n,r){let i=e.width,o=e.height,s=n||r,a=uu(i,o).getContext("2d");t.forEach(g=>UHe(a,g,s));let l=new Uint32Array(a.getImageData(0,0,i,o).data.buffer),u=e.bitmap(),c=s&&e.bitmap(),f,d,p,m,h;for(d=0;d<o;++d)for(f=0;f<i;++f)h=l[d*i+f]&bYt,h&&(p=e(f),m=e(d),r||u.set(p,m),s&&h^yYt&&c.set(p,m));return[u,c]}function UHe(e,t,n){if(!t.length)return;let r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(o=>UHe(e,o.items,n))}):Mc[r].draw(e,{items:n?t.map(_Yt):t})}function _Yt(e){let t=hS(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=vYt,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}function SYt(e,t){let n=new Uint32Array(~~((e*t+mL)/mL));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{let a=s*e+o;return n[a>>>Ab]&1<<(a&Ol)},set:(o,s)=>{let a=s*e+o;r(a>>>Ab,1<<(a&Ol))},clear:(o,s)=>{let a=s*e+o;i(a>>>Ab,~(1<<(a&Ol)))},getRange:(o,s,a,l)=>{let u=l,c,f,d,p;for(;u>=s;--u)if(c=u*e+o,f=u*e+a,d=c>>>Ab,p=f>>>Ab,d===p){if(n[d]&Y1[c&Ol]&Ap[(f&Ol)+1])return!0}else{if(n[d]&Y1[c&Ol]||n[p]&Ap[(f&Ol)+1])return!0;for(let m=d+1;m<p;++m)if(n[m])return!0}return!1},setRange:(o,s,a,l)=>{let u,c,f,d,p;for(;s<=l;++s)if(u=s*e+o,c=s*e+a,f=u>>>Ab,d=c>>>Ab,f===d)r(f,Y1[u&Ol]&Ap[(c&Ol)+1]);else for(r(f,Y1[u&Ol]),r(d,Ap[(c&Ol)+1]),p=f+1;p<d;++p)r(p,4294967295)},clearRange:(o,s,a,l)=>{let u,c,f,d,p;for(;s<=l;++s)if(u=s*e+o,c=s*e+a,f=u>>>Ab,d=c>>>Ab,f===d)i(f,Ap[u&Ol]|Y1[(c&Ol)+1]);else for(i(f,Ap[u&Ol]),i(d,Y1[(c&Ol)+1]),p=f+1;p<d;++p)i(p,0)},outOfBounds:(o,s,a,l)=>o<0||s<0||l>=t||a>=e}}function EYt(e,t,n){let r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>SYt(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}function AYt(e,t,n,r){let i=e.width,o=e.height;return function(s){let a=s.datum.datum.items[r].items,l=a.length,u=s.datum.fontSize,c=Sp.width(s.datum,s.datum.text),f=0,d,p,m,h,g,x,b;for(let y=0;y<l;++y)d=a[y].x,m=a[y].y,p=a[y].x2===void 0?d:a[y].x2,h=a[y].y2===void 0?m:a[y].y2,g=(d+p)/2,x=(m+h)/2,b=Math.abs(p-d+h-m),b>=f&&(f=b,s.x=g,s.y=x);return g=c/2,x=u/2,d=s.x-g,p=s.x+g,m=s.y-x,h=s.y+x,s.align="center",d<0&&p<=i?s.align="left":0<=d&&i<p&&(s.align="right"),s.baseline="middle",m<0&&h<=o?s.baseline="top":0<=m&&o<h&&(s.baseline="bottom"),!0}}function rG(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function K1(e,t,n,r,i,o,s,a){let l=i*o/(r*2),u=e(t-l),c=e(t+l),f=e(n-(o=o/2)),d=e(n+o);return s.outOfBounds(u,f,c,d)||s.getRange(u,f,c,d)||a&&a.getRange(u,f,c,d)}function TYt(e,t,n,r){let i=e.width,o=e.height,s=t[0],a=t[1];function l(u,c,f,d,p){let m=e.invert(u),h=e.invert(c),g=f,x=o,b;if(!rG(m,h,d,p,i,o)&&!K1(e,m,h,p,d,g,s,a)&&!K1(e,m,h,p,d,p,s,null)){for(;x-g>=1;)b=(g+x)/2,K1(e,m,h,p,d,b,s,a)?x=b:g=b;if(g>f)return[m,h,g,!0]}}return function(u){let c=u.datum.datum.items[r].items,f=c.length,d=u.datum.fontSize,p=Sp.width(u.datum,u.datum.text),m=n?d:0,h=!1,g=!1,x=0,b,y,v,C,_,S,E,T,I,k,O,F,B,M,z,W,H;for(let Q=0;Q<f;++Q){for(b=c[Q].x,v=c[Q].y,y=c[Q].x2===void 0?b:c[Q].x2,C=c[Q].y2===void 0?v:c[Q].y2,b>y&&(H=b,b=y,y=H),v>C&&(H=v,v=C,C=H),I=e(b),O=e(y),k=~~((I+O)/2),F=e(v),M=e(C),B=~~((F+M)/2),E=k;E>=I;--E)for(T=B;T>=F;--T)W=l(E,T,m,p,d),W&&([u.x,u.y,m,h]=W);for(E=k;E<=O;++E)for(T=B;T<=M;++T)W=l(E,T,m,p,d),W&&([u.x,u.y,m,h]=W);!h&&!n&&(z=Math.abs(y-b+C-v),_=(b+y)/2,S=(v+C)/2,z>=x&&!rG(_,S,p,d,i,o)&&!K1(e,_,S,d,p,d,s,null)&&(x=z,u.x=_,u.y=S,g=!0))}return h||g?(_=p/2,S=d/2,s.setRange(e(u.x-_),e(u.y-S),e(u.x+_),e(u.y+S)),u.align="center",u.baseline="middle",!0):!1}}function DYt(e,t,n,r){let i=e.width,o=e.height,s=t[0],a=t[1],l=e.bitmap();return function(u){let c=u.datum.datum.items[r].items,f=c.length,d=u.datum.fontSize,p=Sp.width(u.datum,u.datum.text),m=[],h=n?d:0,g=!1,x=!1,b=0,y,v,C,_,S,E,T,I,k,O,F,B;for(let M=0;M<f;++M){for(y=c[M].x,C=c[M].y,v=c[M].x2===void 0?y:c[M].x2,_=c[M].y2===void 0?C:c[M].y2,m.push([e((y+v)/2),e((C+_)/2)]);m.length;)if([T,I]=m.pop(),!(s.get(T,I)||a.get(T,I)||l.get(T,I))){l.set(T,I);for(let z=0;z<4;++z)S=T+kYt[z],E=I+IYt[z],l.outOfBounds(S,E,S,E)||m.push([S,E]);if(S=e.invert(T),E=e.invert(I),k=h,O=o,!rG(S,E,p,d,i,o)&&!K1(e,S,E,d,p,k,s,a)&&!K1(e,S,E,d,p,d,s,null)){for(;O-k>=1;)F=(k+O)/2,K1(e,S,E,d,p,F,s,a)?O=F:k=F;k>h&&(u.x=S,u.y=E,h=k,g=!0)}}!g&&!n&&(B=Math.abs(v-y+_-C),S=(y+v)/2,E=(C+_)/2,B>=b&&!rG(S,E,p,d,i,o)&&!K1(e,S,E,d,p,d,s,null)&&(b=B,u.x=S,u.y=E,x=!0))}return g||x?(S=p/2,E=d/2,s.setRange(e(u.x-S),e(u.y-E),e(u.x+S),e(u.y+E)),u.align="center",u.baseline="middle",!0):!1}}function RYt(e,t,n,r){let i=e.width,o=e.height,s=t[0],a=t[1],l=r.length;return function(u){let c=u.boundary,f=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>o)return!1;let d=0,p,m,h,g,x,b,y,v,C,_,S,E,T,I,k;for(let O=0;O<l;++O){if(p=(n[O]&3)-1,m=(n[O]>>>2&3)-1,h=p===0&&m===0||r[O]<0,g=p&&m?Math.SQRT1_2:1,x=r[O]<0?-1:1,b=c[1+p]+r[O]*p*g,S=c[4+m]+x*f*m/2+r[O]*m*g,v=S-f/2,C=S+f/2,E=e(b),I=e(v),k=e(C),!d)if(zHe(E,E,I,k,s,a,b,b,v,C,c,h))d=Sp.width(u.datum,u.datum.text);else continue;if(_=b+x*d*p/2,b=_-d/2,y=_+d/2,E=e(b),T=e(y),zHe(E,T,I,k,s,a,b,y,v,C,c,h))return u.x=p?p*x<0?y:b:_,u.y=m?m*x<0?C:v:S,u.align=NYt[p*x+1],u.baseline=FYt[m*x+1],s.setRange(E,I,T,k),!0}return!1}}function zHe(e,t,n,r,i,o,s,a,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o?o.getRange(e,n,t,r)||!OYt(s,l,a,u,c):i.getRange(e,n,t,r)))}function OYt(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}function PYt(e,t,n,r,i,o,s,a,l,u,c){if(!e.length)return e;let f=Math.max(r.length,i.length),d=LYt(r,f),p=BYt(i,f),m=zYt(e[0].datum),h=m==="group"&&e[0].datum.items[l].marktype,g=h==="area",x=UYt(m,h,a,l),b=EYt(t[0],t[1],u),y=g&&c==="naive",v=e.map(S=>({datum:S,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:x(S)})),C;if(!y){n&&v.sort((E,T)=>n(E.datum,T.datum));let S=!1;for(let E=0;E<p.length&&!S;++E)S=p[E]===5||d[E]<0;m&&(s||g)&&(o=[e.map(E=>E.datum)].concat(o)),C=o.length?CYt(b,o,S,g):wYt(b,s&&v)}let _=g?$Yt[c](b,C,s,l):RYt(b,C,p,d);return v.forEach(S=>S.opacity=+_(S)),v}function LYt(e,t){let n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function BYt(e,t){let n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=MYt[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function zYt(e){return e&&e.mark&&e.mark.marktype}function UYt(e,t,n,r){let i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>i(o.datum):t==="line"?o=>{let s=o.datum.items[r].items;return i(s.length?s[n==="start"?0:s.length-1]:{x:NaN,y:NaN})}:o=>{let s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}function gge(e){ce.call(this,null,e)}var bYt,yYt,vYt,Ab,Ol,mL,Y1,Ap,kYt,IYt,NYt,FYt,uge,cge,fge,dge,pge,mge,MYt,$Yt,hge,jHe,VHe=w(()=>{"use strict";Lk();hs();pL();ao();bYt=4278190080,yYt=268435456,vYt=.0625;Ab=5,Ol=31,mL=32,Y1=new Uint32Array(mL+1),Ap=new Uint32Array(mL+1);Ap[0]=0;Y1[0]=~Ap[0];for(let e=1;e<=mL;++e)Ap[e]=Ap[e-1]<<1|1,Y1[e]=~Ap[e];kYt=[-1,-1,1,1],IYt=[-1,1,-1,1];NYt=["right","center","left"],FYt=["bottom","middle","top"];uge=0,cge=4,fge=8,dge=0,pge=1,mge=2,MYt={"top-left":uge+dge,top:uge+pge,"top-right":uge+mge,left:cge+dge,middle:cge+pge,right:cge+mge,"bottom-left":fge+dge,bottom:fge+pge,"bottom-right":fge+mge},$Yt={naive:AYt,"reduced-search":TYt,floodfill:DYt};hge=["x","y","opacity","align","baseline"],jHe=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];gge.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:jHe},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:hge.length,default:hge}]};$e(gge,ce,{transform(e,t){function n(o){let s=e[o];return wn(s)&&t.modified(s.fields)}let r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Se("Size parameter should be specified as a [width, height] array.");let i=e.as||hge;return PYt(t.materialize(t.SOURCE).source,e.size,e.sort,Rt(e.offset||1),Rt(e.anchor||jHe),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(o=>{let s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}})});var wge={};rn(wge,{loess:()=>yge,regression:()=>vge});function WHe(e,t){var n=[],r=function(c){return c(a)},i,o,s,a,l,u;if(t==null)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function yge(e){ce.call(this,null,e)}function vge(e){ce.call(this,null,e)}var bge,jYt,GHe=w(()=>{"use strict";kk();hs();ao();yge.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};$e(yge,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=t.materialize(t.SOURCE).source,i=WHe(r,e.groupby),o=(e.groupby||[]).map(si),s=o.length,a=e.as||[si(e.x),si(e.y)],l=[];i.forEach(u=>{fse(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{let f={};for(let d=0;d<s;++d)f[o[d]]=u.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],l.push(Cn(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});bge={linear:wj,log:ase,exp:lse,pow:use,quad:Cj,poly:cse},jYt=(e,t)=>e==="poly"?t:e==="quad"?2:1;vge.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(bge)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};$e(vge,ce,{transform(e,t){let n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let r=t.materialize(t.SOURCE).source,i=WHe(r,e.groupby),o=(e.groupby||[]).map(si),s=e.method||"linear",a=e.order||3,l=jYt(s,a),u=e.as||[si(e.x),si(e.y)],c=bge[s],f=[],d=e.extent;Dt(bge,s)||Se("Invalid regression method: "+s),d!=null&&s==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(p=>{if(p.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}let h=c(p,e.x,e.y,a);if(e.params){f.push(Cn({keys:p.dims,coef:h.coef,rSquared:h.rSquared}));return}let g=d||Hd(p,e.x),x=b=>{let y={};for(let v=0;v<o.length;++v)y[o[v]]=p.dims[v];y[u[0]]=b[0],y[u[1]]=b[1],f.push(Cn(y))};s==="linear"?g.forEach(b=>x([b,h.predict(b)])):Tk(h.predict,g,25,200).forEach(x)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}})});function VYt(e,t){let n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Cge(e,t,n,r){let i=e-n,o=t-r;return i*i+o*o}function _ge(e,t,n,r,i,o){let s=(r-t)*(i-e),a=(n-e)*(o-t);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function oG(e,t,n,r,i,o){return(_ge(i,o,e,t,n,r)||_ge(e,t,n,r,i,o)||_ge(n,r,i,o,e,t))<0}function WYt(e,t,n,r,i,o,s,a){let l=e-s,u=t-a,c=n-s,f=r-a,d=i-s,p=o-a,m=l*l+u*u,h=c*c+f*f,g=d*d+p*p;return l*(f*g-h*p)-u*(c*g-h*d)+m*(c*p-f*d)<0}function GYt(e,t,n,r,i,o){let s=n-e,a=r-t,l=i-e,u=o-t,c=s*s+a*a,f=l*l+u*u,d=.5/(s*u-a*l),p=(u*c-a*f)*d,m=(s*f-l*c)*d;return p*p+m*m}function qYt(e,t,n,r,i,o){let s=n-e,a=r-t,l=i-e,u=o-t,c=s*s+a*a,f=l*l+u*u,d=.5/(s*u-a*l),p=e+(u*c-a*f)*d,m=t+(s*f-l*c)*d;return{x:p,y:m}}function lD(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){let o=e[i],s=t[o],a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{let i=n+r>>1,o=n+1,s=r;hL(e,i,o),t[e[n]]>t[e[r]]&&hL(e,n,r),t[e[o]]>t[e[r]]&&hL(e,o,r),t[e[n]]>t[e[o]]&&hL(e,n,o);let a=e[o],l=t[a];for(;;){do o++;while(t[e[o]]<l);do s--;while(t[e[s]]>l);if(s<o)break;hL(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(lD(e,t,o,r),lD(e,t,n,s-1)):(lD(e,t,n,s-1),lD(e,t,o,r))}}function hL(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function HYt(e){return e[0]}function YYt(e){return e[1]}var qHe,iG,gL,HHe=w(()=>{"use strict";qHe=Math.pow(2,-52),iG=new Uint32Array(512),gL=class e{static from(t,n=HYt,r=YYt){let i=t.length,o=new Float64Array(i*2);for(let s=0;s<i;s++){let a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new e(o)}constructor(t){let n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;let r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){let{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1,a=1/0,l=1/0,u=-1/0,c=-1/0;for(let I=0;I<s;I++){let k=t[2*I],O=t[2*I+1];k<a&&(a=k),O<l&&(l=O),k>u&&(u=k),O>c&&(c=O),this._ids[I]=I}let f=(a+u)/2,d=(l+c)/2,p=1/0,m,h,g;for(let I=0;I<s;I++){let k=Cge(f,d,t[2*I],t[2*I+1]);k<p&&(m=I,p=k)}let x=t[2*m],b=t[2*m+1];p=1/0;for(let I=0;I<s;I++){if(I===m)continue;let k=Cge(x,b,t[2*I],t[2*I+1]);k<p&&k>0&&(h=I,p=k)}let y=t[2*h],v=t[2*h+1],C=1/0;for(let I=0;I<s;I++){if(I===m||I===h)continue;let k=GYt(x,b,y,v,t[2*I],t[2*I+1]);k<C&&(g=I,C=k)}let _=t[2*g],S=t[2*g+1];if(C===1/0){for(let O=0;O<s;O++)this._dists[O]=t[2*O]-t[0]||t[2*O+1]-t[1];lD(this._ids,this._dists,0,s-1);let I=new Uint32Array(s),k=0;for(let O=0,F=-1/0;O<s;O++){let B=this._ids[O];this._dists[B]>F&&(I[k++]=B,F=this._dists[B])}this.hull=I.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(oG(x,b,y,v,_,S)){let I=h,k=y,O=v;h=g,y=_,v=S,g=I,_=k,S=O}let E=qYt(x,b,y,v,_,S);this._cx=E.x,this._cy=E.y;for(let I=0;I<s;I++)this._dists[I]=Cge(t[2*I],t[2*I+1],E.x,E.y);lD(this._ids,this._dists,0,s-1),this._hullStart=m;let T=3;r[m]=n[g]=h,r[h]=n[m]=g,r[g]=n[h]=m,i[m]=0,i[h]=1,i[g]=2,o.fill(-1),o[this._hashKey(x,b)]=m,o[this._hashKey(y,v)]=h,o[this._hashKey(_,S)]=g,this.trianglesLen=0,this._addTriangle(m,h,g,-1,-1,-1);for(let I=0,k,O;I<this._ids.length;I++){let F=this._ids[I],B=t[2*F],M=t[2*F+1];if(I>0&&Math.abs(B-k)<=qHe&&Math.abs(M-O)<=qHe||(k=B,O=M,F===m||F===h||F===g))continue;let z=0;for(let oe=0,me=this._hashKey(B,M);oe<this._hashSize&&(z=o[(me+oe)%this._hashSize],!(z!==-1&&z!==r[z]));oe++);z=n[z];let W=z,H;for(;H=r[W],!oG(B,M,t[2*W],t[2*W+1],t[2*H],t[2*H+1]);)if(W=H,W===z){W=-1;break}if(W===-1)continue;let Q=this._addTriangle(W,F,r[W],-1,-1,i[W]);i[F]=this._legalize(Q+2),i[W]=Q,T++;let re=r[W];for(;H=r[re],oG(B,M,t[2*re],t[2*re+1],t[2*H],t[2*H+1]);)Q=this._addTriangle(re,F,H,i[F],-1,i[re]),i[F]=this._legalize(Q+2),r[re]=re,T--,re=H;if(W===z)for(;H=n[W],oG(B,M,t[2*H],t[2*H+1],t[2*W],t[2*W+1]);)Q=this._addTriangle(H,F,W,-1,i[W],i[H]),this._legalize(Q+2),i[H]=Q,r[W]=W,T--,W=H;this._hullStart=n[F]=W,r[W]=n[re]=F,r[F]=re,o[this._hashKey(B,M)]=F,o[this._hashKey(t[2*W],t[2*W+1])]=W}this.hull=new Uint32Array(T);for(let I=0,k=this._hullStart;I<T;I++)this.hull[I]=k,k=r[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(VYt(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){let{_triangles:n,_halfedges:r,coords:i}=this,o=0,s=0;for(;;){let a=r[t],l=t-t%3;if(s=l+(t+2)%3,a===-1){if(o===0)break;t=iG[--o];continue}let u=a-a%3,c=l+(t+1)%3,f=u+(a+2)%3,d=n[s],p=n[t],m=n[c],h=n[f];if(WYt(i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*m],i[2*m+1],i[2*h],i[2*h+1])){n[t]=h,n[a]=d;let x=r[f];if(x===-1){let y=this._hullStart;do{if(this._hullTri[y]===f){this._hullTri[y]=t;break}y=this._hullPrev[y]}while(y!==this._hullStart)}this._link(t,x),this._link(a,r[s]),this._link(s,f);let b=u+(a+1)%3;o<iG.length&&(iG[o++]=b)}else{if(o===0)break;t=iG[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){let a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}});var Tp,Sge=w(()=>{"use strict";Tp=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;let i=t+r,o=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-o)>1e-6)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}});var RE,Ege=w(()=>{"use strict";RE=class{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}});var sG,YHe=w(()=>{"use strict";Sge();Ege();sG=class{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){let{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,o=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let p=0,m=0,h=r.length,g,x;p<h;p+=3,m+=2){let b=r[p]*2,y=r[p+1]*2,v=r[p+2]*2,C=t[b],_=t[b+1],S=t[y],E=t[y+1],T=t[v],I=t[v+1],k=S-C,O=E-_,F=T-C,B=I-_,M=k*k+O*O,z=F*F+B*B,W=(k*B-O*F)*2;if(!W)g=(C+T)/2-1e8*B,x=(_+I)/2+1e8*F;else if(Math.abs(W)<1e-8)g=(C+T)/2,x=(_+I)/2;else{let H=1/W;g=C+(B*M-O*z)*H,x=_+(k*z-F*M)*H}o[m]=g,o[m+1]=x}let s=n[n.length-1],a,l=s*4,u,c=t[2*s],f,d=t[2*s+1];i.fill(0);for(let p=0;p<n.length;++p)s=n[p],a=l,u=c,f=d,l=s*4,c=t[2*s],d=t[2*s+1],i[a+2]=i[l]=f-d,i[a+3]=i[l+1]=c-u}render(t){let n=t==null?t=new Tp:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){let d=r[c];if(d<c)continue;let p=Math.floor(c/3)*2,m=Math.floor(d/3)*2,h=s[p],g=s[p+1],x=s[m],b=s[m+1];this._renderSegment(h,g,x,b,t)}let l,u=o[o.length-1];for(let c=0;c<o.length;++c){l=u,u=o[c];let f=Math.floor(i[u]/3)*2,d=s[f],p=s[f+1],m=l*4,h=this._project(d,p,a[m+2],a[m+3]);h&&this._renderSegment(d,p,h[0],h[1],t)}return n&&n.value()}renderBounds(t){let n=t==null?t=new Tp:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){let r=n==null?n=new Tp:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){let{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){let i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){let n=new RE;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s,a=this._regioncode(t,n),l=this._regioncode(r,i);a===0&&l===0?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,l))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){let n=this._clip(t);if(n)for(let r of this.delaunay.neighbors(t)){let i=this._clip(r);if(i){e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,l=i.length;a<l;a+=2)if(n[o]==i[a]&&n[o+1]==i[a+1]&&n[(o+2)%s]==i[(a+l-2)%l]&&n[(o+3)%s]==i[(a+l-1)%l]){yield r;break e}}}}_cell(t){let{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(s===-1)return null;let a=[],l=s;do{let u=Math.floor(l/3);if(a.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,o[l]!==t)break;l=i[l]}while(l!==s&&l!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let n=this._cell(t);if(n===null)return null;let{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){let r=n.length,i=null,o,s,a=n[r-2],l=n[r-1],u,c=this._regioncode(a,l),f,d;for(let p=0;p<r;p+=2)if(o=a,s=l,a=n[p],l=n[p+1],u=c,c=this._regioncode(a,l),u===0&&c===0)f=d,d=0,i?i.push(a,l):i=[a,l];else{let m,h,g,x,b;if(u===0){if((m=this._clipSegment(o,s,a,l,u,c))===null)continue;[h,g,x,b]=m}else{if((m=this._clipSegment(a,l,o,s,c,u))===null)continue;[x,b,h,g]=m,f=d,d=this._edgecode(h,g),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(h,g):i=[h,g]}f=d,d=this._edgecode(x,b),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(x,b):i=[x,b]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){for(;;){if(o===0&&s===0)return[t,n,r,i];if(o&s)return null;let a,l,u=o||s;u&8?(a=t+(r-t)*(this.ymax-n)/(i-n),l=this.ymax):u&4?(a=t+(r-t)*(this.ymin-n)/(i-n),l=this.ymin):u&2?(l=n+(i-n)*(this.xmax-t)/(r-t),a=this.xmax):(l=n+(i-n)*(this.xmin-t)/(r-t),a=this.xmin),o?(t=a,n=l,o=this._regioncode(t,n)):(r=a,i=l,s=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,o,s){let a=Array.from(n),l;if((l=this._project(a[0],a[1],r,i))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let u=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)f=d,d=this._edgecode(a[u],a[u+1]),f&&d&&(u=this._edge(t,f,d,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin;break}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}if(i.length>4)for(let s=0;s<i.length;s+=2){let a=(s+2)%i.length,l=(s+4)%i.length;(i[s]===i[a]&&i[a]===i[l]||i[s+1]===i[a+1]&&i[a+1]===i[l+1])&&(i.splice(a,2),s-=2)}return o}_project(t,n,r,i){let o=1/0,s,a,l;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(l=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(l=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,l=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,l=n+(o=s)*i)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}});function XYt(e){return e[0]}function ZYt(e){return e[1]}function QYt(e){let{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){let i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}function JYt(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}function eKt(e,t,n,r){let i=e.length,o=new Float64Array(i*2);for(let s=0;s<i;++s){let a=e[s];o[s*2]=t.call(r,a,s,e),o[s*2+1]=n.call(r,a,s,e)}return o}function*tKt(e,t,n,r){let i=0;for(let o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}var KYt,uD,xL,KHe=w(()=>{"use strict";HHe();Sge();Ege();YHe();KYt=2*Math.PI,uD=Math.pow;xL=class e{static from(t,n=XYt,r=ZYt,i){return new e("length"in t?eKt(t,n,r,i):Float64Array.from(tKt(t,n,r,i)))}constructor(t){this._delaunator=new gL(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){let t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&QYt(t)){this.collinear=Int32Array.from({length:n.length/2},(d,p)=>p).sort((d,p)=>n[2*d]-n[2*p]||n[2*d+1]-n[2*p+1]);let l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,p=n.length/2;d<p;++d){let m=JYt(n[2*d],n[2*d+1],f);n[2*d]=m[0],n[2*d+1]=m[1]}this._delaunator=new gL(n)}else delete this.collinear;let r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=r.length;l<u;++l){let c=o[l%3===2?l-2:l+1];(r[l]===-1||s[c]===-1)&&(s[c]=l)}for(let l=0,u=i.length;l<u;++l)a[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],s[i[0]]=1,i.length===2&&(s[i[1]]=0))}voronoi(t){return new sG(this,t)}*neighbors(t){let{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){let f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}let l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=s[u],u=u%3===2?u-2:u+1,s[u]!==t)return;if(u=o[u],u===-1){let f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(u!==l)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;let i=r,o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){let{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:l,points:u}=this;if(i[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,f=uD(n-u[t*2],2)+uD(r-u[t*2+1],2),d=i[t],p=d;do{let m=l[p],h=uD(n-u[m*2],2)+uD(r-u[m*2+1],2);if(h<f&&(f=h,c=m),p=p%3===2?p-2:p+1,l[p]!==t)break;if(p=a[p],p===-1){if(p=o[(s[t]+1)%o.length],p!==m&&uD(n-u[p*2],2)+uD(r-u[p*2+1],2)<f)return p;break}}while(p!==d);return c}render(t){let n=t==null?t=new Tp:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){let l=i[s];if(l<s)continue;let u=o[s]*2,c=o[l]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){let r=t==null?t=new Tp:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){let a=i[o],l=i[o+1];t.moveTo(a+n,l),t.arc(a,l,n,0,KYt)}return r&&r.value()}renderHull(t){let n=t==null?t=new Tp:void 0,{hull:r,points:i}=this,o=r[0]*2,s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){let l=2*r[a];t.lineTo(i[l],i[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){let t=new RE;return this.renderHull(t),t.value()}renderTriangle(t,n){let r=n==null?n=new Tp:void 0,{points:i,triangles:o}=this,s=o[t*=3]*2,a=o[t+1]*2,l=o[t+2]*2;return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[l],i[l+1]),n.closePath(),r&&r.value()}*trianglePolygons(){let{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){let n=new RE;return this.renderTriangle(t,n),n.value()}}});var XHe=w(()=>{"use strict";KHe()});var Tge={};rn(Tge,{voronoi:()=>Age});function Age(e){ce.call(this,null,e)}function rKt(e){let t=e[0][0],n=e[0][1],r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var nKt,ZHe=w(()=>{"use strict";hs();ao();XHe();Age.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};nKt=[-1e5,-1e5,1e5,1e5];$e(Age,ce,{transform(e,t){let n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:nKt;let o=this.value=xL.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){let l=o.cellPolygon(s);r[s][n]=l?rKt(l):null}return t.reflow(e.modified()).modifies(n)}})});function cD(e,t,n){return e.fields=t||[],e.fname=n,e}function iKt(e){return e.length===1?oKt(e[0]):sKt(e)}function OE(e){throw Error(e)}function aKt(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||OE("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&OE("Access path missing closing bracket: "+e),r&&OE("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function lKt(e,t,n){let r=aKt(e);return e=r.length===1?r[0]:e,cD((n&&n.get||iKt)(r),[e],t||e)}function Ige(e){return e[e.length-1]}function QHe(e){return e==null||e===""?null:+e}function Dge(e){return e!=null?kge(e)?e:[e]:[]}function aG(e){return typeof e=="function"}function lG(e){return aG(e)?e:()=>e}function JHe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function eYe(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function tYe(e,t,n){let r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),JHe(r,n)}function Nge(e){let t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}var oKt,sKt,wUr,CUr,uKt,cKt,_Ur,SUr,kge,uG=w(()=>{"use strict";oKt=e=>function(t){return t[e]},sKt=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};wUr=lKt("id"),CUr=cD(e=>e,[],"identity"),uKt=cD(()=>0,[],"zero"),cKt=cD(()=>1,[],"one"),_Ur=cD(()=>!0,[],"true"),SUr=cD(()=>!1,[],"false"),kge=Array.isArray});function Tg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}var cG=w(()=>{"use strict"});function Fge(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}var nYe=w(()=>{"use strict"});function ME(e){let t,n,r;e.length!==2?(t=Tg,n=(a,l)=>Tg(e(a),l),r=(a,l)=>e(a)-l):(t=e===Tg||e===Fge?e:fKt,n=e,r=e);function i(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{let f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}function o(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{let f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function s(a,l,u=0,c=a.length){let f=i(a,l,u,c-1);return f>u&&r(a[f-1],l)>-r(a[f],l)?f-1:f}return{left:i,center:s,right:o}}function fKt(){return 0}var Rge=w(()=>{"use strict";cG();nYe()});function bL(e){return e===null?NaN:+e}var Oge=w(()=>{"use strict"});var rYe,yL,dKt,pKt,kp,iYe=w(()=>{"use strict";cG();Rge();Oge();rYe=ME(Tg),yL=rYe.right,dKt=rYe.left,pKt=ME(bL).center,kp=yL});function fG(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=mKt?10:o>=hKt?5:o>=gKt?2:1,a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(e*u),l=Math.round(t*u),a/u<e&&++a,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(e/u),l=Math.round(t/u),a*u<e&&++a,l*u>t&&--l),l<a&&.5<=n&&n<2?fG(e,t,n*2):[a,l,u]}function $E(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];let r=t<e,[i,o,s]=r?fG(t,e,n):fG(e,t,n);if(!(o>=i))return[];let a=o-i+1,l=new Array(a);if(r)if(s<0)for(let u=0;u<a;++u)l[u]=(o-u)/-s;else for(let u=0;u<a;++u)l[u]=(o-u)*s;else if(s<0)for(let u=0;u<a;++u)l[u]=(i+u)/-s;else for(let u=0;u<a;++u)l[u]=(i+u)*s;return l}function vL(e,t,n){return t=+t,e=+e,n=+n,fG(e,t,n)[2]}function fD(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?vL(t,e,n):vL(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}var mKt,hKt,gKt,oYe=w(()=>{"use strict";mKt=Math.sqrt(50),hKt=Math.sqrt(10),gKt=Math.sqrt(2)});function Mge(e,t,n=bL){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e),a=+n(e[o+1],o+1,e);return s+(a-s)*(i-o)}}var sYe=w(()=>{"use strict";Oge()});function dG(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}var aYe=w(()=>{"use strict"});var Ip=w(()=>{"use strict";iYe();cG();Rge();sYe();aYe();oYe();oM()});function Fo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function kg(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var $c=w(()=>{"use strict"});function PE(){var e=new jh,t=[],n=[],r=$ge;function i(o){let s=e.get(o);if(s===void 0){if(r!==$ge)return r;e.set(o,s=t.push(o)-1)}return n[s%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new jh;for(let s of o)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return PE(t,n).unknown(r)},Fo.apply(i,arguments),i}var $ge,lYe=w(()=>{"use strict";Ip();$c();$ge=Symbol("implicit")});function Pge(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function pG(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,a=r<t-1?e[r+2]:2*o-i;return Pge((n-r/t)*t,s,i,o,a)}}var mG=w(()=>{"use strict"});function hG(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],a=e[(r+2)%t];return Pge((n-r/t)*t,i,o,s,a)}}var Lge=w(()=>{"use strict";mG()});var dD,Bge=w(()=>{"use strict";dD=e=>()=>e});function uYe(e,t){return function(n){return e+n*t}}function xKt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function X1(e,t){var n=t-e;return n?uYe(e,n>180||n<-180?n-360*Math.round(n/360):n):dD(isNaN(e)?t:e)}function cYe(e){return(e=+e)==1?Ei:function(t,n){return n-t?xKt(t,n,e):dD(isNaN(t)?n:t)}}function Ei(e,t){var n=t-e;return n?uYe(e,n):dD(isNaN(e)?t:e)}var LE=w(()=>{"use strict";Bge()});function fYe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=ko(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(l){return a.r=r(l),a.g=i(l),a.b=o(l),a+""}}}var wL,dYe,pYe,zge=w(()=>{"use strict";lo();mG();Lge();LE();wL=function e(t){var n=cYe(t);function r(i,o){var s=n((i=ko(i)).r,(o=ko(o)).r),a=n(i.g,o.g),l=n(i.b,o.b),u=Ei(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);dYe=fYe(pG),pYe=fYe(hG)});function pD(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function gG(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var xG=w(()=>{"use strict"});function mYe(e,t){return(gG(t)?pD:Uge)(e,t)}function Uge(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=wu(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}var jge=w(()=>{"use strict";CL();xG()});function bG(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}var Vge=w(()=>{"use strict"});function Fa(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var _L=w(()=>{"use strict"});function yG(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=wu(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Wge=w(()=>{"use strict";CL()});function bKt(e){return function(){return e}}function yKt(e){return function(t){return e(t)+""}}function vG(e,t){var n=qge.lastIndex=Gge.lastIndex=0,r,i,o,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=qge.exec(e))&&(i=Gge.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:Fa(r,i)})),n=Gge.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?yKt(l[0].x):bKt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}var qge,Gge,Hge=w(()=>{"use strict";_L();qge=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Gge=new RegExp(qge.source,"g")});function wu(e,t){var n=typeof t,r;return t==null||n==="boolean"?dD(t):(n==="number"?Fa:n==="string"?(r=pu(t))?(t=r,wL):vG:t instanceof pu?wL:t instanceof Date?bG:gG(t)?pD:Array.isArray(t)?Uge:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?yG:Fa)(e,t)}var CL=w(()=>{"use strict";lo();zge();jge();Vge();_L();Wge();Hge();Bge();xG()});function hYe(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var gYe=w(()=>{"use strict"});function xYe(e,t){var n=X1(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}var bYe=w(()=>{"use strict";LE()});function Z1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var yYe=w(()=>{"use strict"});function Yge(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*vYe,skewX:Math.atan(l)*vYe,scaleX:s,scaleY:a}}var vYe,wG,wYe=w(()=>{"use strict";vYe=180/Math.PI,wG={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1}});function CYe(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wG:Yge(t.a,t.b,t.c,t.d,t.e,t.f)}function _Ye(e){return e==null?wG:(CG||(CG=document.createElementNS("http://www.w3.org/2000/svg","g")),CG.setAttribute("transform",e),(e=CG.transform.baseVal.consolidate())?(e=e.matrix,Yge(e.a,e.b,e.c,e.d,e.e,e.f)):wG)}var CG,SYe=w(()=>{"use strict";wYe()});function EYe(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,d,p,m){if(u!==f||c!==d){var h=p.push("translate(",null,t,null,n);m.push({i:h-4,x:Fa(u,f)},{i:h-2,x:Fa(c,d)})}else(f||d)&&p.push("translate("+f+t+d+n)}function s(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Fa(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(u,c,f,d){u!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Fa(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,d,p,m){if(u!==f||c!==d){var h=p.push(i(p)+"scale(",null,",",null,")");m.push({i:h-4,x:Fa(u,f)},{i:h-2,x:Fa(c,d)})}else(f!==1||d!==1)&&p.push(i(p)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,d),s(u.rotate,c.rotate,f,d),a(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(p){for(var m=-1,h=d.length,g;++m<h;)f[(g=d[m]).i]=g.x(p);return f.join("")}}}var AYe,TYe,kYe=w(()=>{"use strict";_L();SYe();AYe=EYe(CYe,"px, ","px)","deg)"),TYe=EYe(_Ye,", ",")",")")});function IYe(e){return((e=Math.exp(e))+1/e)/2}function wKt(e){return((e=Math.exp(e))-1/e)/2}function CKt(e){return((e=Math.exp(2*e))-1)/(e+1)}var vKt,DYe,NYe=w(()=>{"use strict";vKt=1e-12;DYe=function e(t,n,r){function i(o,s){var a=o[0],l=o[1],u=o[2],c=s[0],f=s[1],d=s[2],p=c-a,m=f-l,h=p*p+m*m,g,x;if(h<vKt)x=Math.log(d/u)/t,g=function(S){return[a+S*p,l+S*m,u*Math.exp(t*S*x)]};else{var b=Math.sqrt(h),y=(d*d-u*u+r*h)/(2*u*n*b),v=(d*d-u*u-r*h)/(2*d*n*b),C=Math.log(Math.sqrt(y*y+1)-y),_=Math.log(Math.sqrt(v*v+1)-v);x=(_-C)/t,g=function(S){var E=S*x,T=IYe(C),I=u/(n*b)*(T*CKt(t*E+C)-wKt(C));return[a+I*p,l+I*m,u*T/IYe(t*E+C)]}}return g.duration=x*1e3*t/Math.SQRT2,g}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,l=a*a;return e(s,a,l)},i}(Math.SQRT2,2,4)});function FYe(e){return function(t,n){var r=e((t=Tc(t)).h,(n=Tc(n)).h),i=Ei(t.s,n.s),o=Ei(t.l,n.l),s=Ei(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var RYe,OYe,MYe=w(()=>{"use strict";lo();LE();RYe=FYe(X1),OYe=FYe(Ei)});function Kge(e,t){var n=Ei((e=mu(e)).l,(t=mu(t)).l),r=Ei(e.a,t.a),i=Ei(e.b,t.b),o=Ei(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}var $Ye=w(()=>{"use strict";lo();LE()});function PYe(e){return function(t,n){var r=e((t=kc(t)).h,(n=kc(n)).h),i=Ei(t.c,n.c),o=Ei(t.l,n.l),s=Ei(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}var LYe,BYe,zYe=w(()=>{"use strict";lo();LE();LYe=PYe(X1),BYe=PYe(Ei)});function UYe(e){return function t(n){n=+n;function r(i,o){var s=e((i=Pf(i)).h,(o=Pf(o)).h),a=Ei(i.s,o.s),l=Ei(i.l,o.l),u=Ei(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}var jYe,VYe,WYe=w(()=>{"use strict";lo();LE();jYe=UYe(X1),VYe=UYe(Ei)});function BE(e,t){t===void 0&&(t=e,e=wu);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}var GYe=w(()=>{"use strict";CL()});function qYe(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var HYe=w(()=>{"use strict"});var Xge={};rn(Xge,{interpolate:()=>wu,interpolateArray:()=>mYe,interpolateBasis:()=>pG,interpolateBasisClosed:()=>hG,interpolateCubehelix:()=>jYe,interpolateCubehelixLong:()=>VYe,interpolateDate:()=>bG,interpolateDiscrete:()=>hYe,interpolateHcl:()=>LYe,interpolateHclLong:()=>BYe,interpolateHsl:()=>RYe,interpolateHslLong:()=>OYe,interpolateHue:()=>xYe,interpolateLab:()=>Kge,interpolateNumber:()=>Fa,interpolateNumberArray:()=>pD,interpolateObject:()=>yG,interpolateRgb:()=>wL,interpolateRgbBasis:()=>dYe,interpolateRgbBasisClosed:()=>pYe,interpolateRound:()=>Z1,interpolateString:()=>vG,interpolateTransformCss:()=>AYe,interpolateTransformSvg:()=>TYe,interpolateZoom:()=>DYe,piecewise:()=>BE,quantize:()=>qYe});var SL=w(()=>{"use strict";CL();jge();mG();Lge();Vge();gYe();bYe();_L();xG();Wge();yYe();Hge();kYe();NYe();zge();MYe();$Ye();zYe();WYe();GYe();HYe()});function Zge(e){return function(){return e}}var YYe=w(()=>{"use strict"});function mD(e){return+e}var Qge=w(()=>{"use strict"});function Js(e){return e}function Jge(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Zge(isNaN(t)?NaN:.5)}function _Kt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function SKt(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=Jge(i,r),o=n(s,o)):(r=Jge(r,i),o=n(o,s)),function(a){return o(r(a))}}function EKt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=Jge(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var l=kp(e,a,1,r)-1;return o[l](i[l](a))}}function Ig(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function zE(){var e=KYe,t=KYe,n=wu,r,i,o,s=Js,a,l,u;function c(){var d=Math.min(e.length,t.length);return s!==Js&&(s=_Kt(e[0],e[d-1])),a=d>2?EKt:SKt,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?o:(l||(l=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((u||(u=a(t,e.map(r),Fa)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,mD),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Z1,c()},f.clamp=function(d){return arguments.length?(s=d?!0:Js,c()):s!==Js},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,p){return r=d,i=p,c()}}function EL(){return zE()(Js,Js)}var KYe,Q1=w(()=>{"use strict";Ip();SL();YYe();Qge();KYe=[0,1]});function hD(e,t,n,r){var i=fD(e,t,n),o;switch(r=Nc(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=gI(i,s))&&(r.precision=o),oE(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=xI(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=hI(i))&&(r.precision=o-(r.type==="%")*2);break}}return mp(r)}var e0e=w(()=>{"use strict";Ip();sE()});function Pc(e){var t=e.domain;return e.ticks=function(n){var r=t();return $E(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return hD(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,s=r[i],a=r[o],l,u,c=10;for(a<s&&(u=s,s=a,a=u,u=i,i=o,o=u);c-- >0;){if(u=vL(s,a,n),u===l)return r[i]=s,r[o]=a,t(r);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;l=u}return e},e}function AL(){var e=EL();return e.copy=function(){return Ig(e,AL())},Fo.apply(e,arguments),Pc(e)}var J1=w(()=>{"use strict";Ip();Q1();$c();e0e()});function TL(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,mD),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return TL(e).unknown(t)},e=arguments.length?Array.from(e,mD):[0,1],Pc(n)}var XYe=w(()=>{"use strict";J1();Qge()});function kL(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}var t0e=w(()=>{"use strict"});function ZYe(e){return Math.log(e)}function QYe(e){return Math.exp(e)}function AKt(e){return-Math.log(-e)}function TKt(e){return-Math.exp(-e)}function kKt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function IKt(e){return e===10?kKt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function DKt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function JYe(e){return(t,n)=>-e(-t,n)}function IL(e){let t=e(ZYe,QYe),n=t.domain,r=10,i,o;function s(){return i=DKt(r),o=IKt(r),n()[0]<0?(i=JYe(i),o=JYe(o),e(AKt,TKt)):e(ZYe,QYe),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=a=>{let l=n(),u=l[0],c=l[l.length-1],f=c<u;f&&([u,c]=[c,u]);let d=i(u),p=i(c),m,h,g=a==null?10:+a,x=[];if(!(r%1)&&p-d<g){if(d=Math.floor(d),p=Math.ceil(p),u>0){for(;d<=p;++d)for(m=1;m<r;++m)if(h=d<0?m/o(-d):m*o(d),!(h<u)){if(h>c)break;x.push(h)}}else for(;d<=p;++d)for(m=r-1;m>=1;--m)if(h=d>0?m/o(-d):m*o(d),!(h<u)){if(h>c)break;x.push(h)}x.length*2<g&&(x=$E(u,c,g))}else x=$E(d,p,Math.min(p-d,g)).map(o);return f?x.reverse():x},t.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Nc(l)).precision==null&&(l.trim=!0),l=mp(l)),a===1/0)return l;let u=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(kL(n(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),t}function DL(){let e=IL(zE()).domain([1,10]);return e.copy=()=>Ig(e,DL()).base(e.base()),Fo.apply(e,arguments),e}var _G=w(()=>{"use strict";Ip();sE();t0e();Q1();$c()});function eKe(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function tKe(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function NL(e){var t=1,n=e(eKe(t),tKe(t));return n.constant=function(r){return arguments.length?e(eKe(t=+r),tKe(t)):t},Pc(n)}function FL(){var e=NL(zE());return e.copy=function(){return Ig(e,FL()).constant(e.constant())},Fo.apply(e,arguments)}var SG=w(()=>{"use strict";J1();Q1();$c()});function nKe(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function NKt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function FKt(e){return e<0?-e*e:e*e}function RL(e){var t=e(Js,Js),n=1;function r(){return n===1?e(Js,Js):n===.5?e(NKt,FKt):e(nKe(n),nKe(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Pc(t)}function gD(){var e=RL(zE());return e.copy=function(){return Ig(e,gD()).exponent(e.exponent())},Fo.apply(e,arguments),e}function n0e(){return gD.apply(null,arguments).exponent(.5)}var EG=w(()=>{"use strict";J1();Q1();$c()});function OL(){var e=[],t=[],n=[],r;function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=Mge(e,s/a);return o}function o(s){return s==null||isNaN(s=+s)?r:t[kp(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Tg),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return OL().domain(e).range(t).unknown(r)},Fo.apply(o,arguments)}var rKe=w(()=>{"use strict";Ip();$c()});function ML(){var e=0,t=1,n=1,r=[.5],i=[0,1],o;function s(l){return l!=null&&l<=l?i[kp(r,l,0,n)]:o}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},s.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,a()):i.slice()},s.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},s.unknown=function(l){return arguments.length&&(o=l),s},s.thresholds=function(){return r.slice()},s.copy=function(){return ML().domain([e,t]).range(i).unknown(o)},Fo.apply(Pc(s),arguments)}var iKe=w(()=>{"use strict";Ip();J1();$c()});function $L(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[kp(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return $L().domain(e).range(t).unknown(n)},Fo.apply(i,arguments)}var oKe=w(()=>{"use strict";Ip();$c()});function Wr(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{let s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=(o,s)=>(t(o=new Date(+o),s==null?1:Math.floor(s)),o),i.range=(o,s,a)=>{let l=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return l;let u;do l.push(u=new Date(+o)),t(o,a),e(o);while(u<o&&o<s);return l},i.filter=o=>Wr(s=>{if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););}),n&&(i.count=(o,s)=>(r0e.setTime(+o),i0e.setTime(+s),e(r0e),e(i0e),Math.floor(n(r0e,i0e))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?s=>r(s)%o===0:s=>i.count(0,s)%o===0):i)),i}var r0e,i0e,Tb=w(()=>{"use strict";r0e=new Date,i0e=new Date});var Dp,sKe,o0e=w(()=>{"use strict";Tb();Dp=Wr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Dp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Wr(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Dp);sKe=Dp.range});var Ra,aKe,s0e=w(()=>{"use strict";Tb();Ra=Wr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),aKe=Ra.range});var ew,RKt,tw,OKt,a0e=w(()=>{"use strict";Tb();ew=Wr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),RKt=ew.range,tw=Wr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),OKt=tw.range});var nw,MKt,rw,$Kt,l0e=w(()=>{"use strict";Tb();nw=Wr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),MKt=nw.range,rw=Wr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),$Kt=rw.range});var Np,PKt,kb,LKt,AG,BKt,u0e=w(()=>{"use strict";Tb();Np=Wr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),PKt=Np.range,kb=Wr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),LKt=kb.range,AG=Wr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),BKt=AG.range});function VE(e){return Wr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}function WE(e){return Wr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/6048e5)}var Ng,uKe,cKe,fKe,dKe,pKe,mKe,hKe,zKt,UKt,jKt,VKt,WKt,GKt,Fg,gKe,xKe,bKe,yKe,vKe,wKe,CKe,qKt,HKt,YKt,KKt,XKt,ZKt,c0e=w(()=>{"use strict";Tb();Ng=VE(0),uKe=VE(1),cKe=VE(2),fKe=VE(3),dKe=VE(4),pKe=VE(5),mKe=VE(6),hKe=Ng.range,zKt=uKe.range,UKt=cKe.range,jKt=fKe.range,VKt=dKe.range,WKt=pKe.range,GKt=mKe.range;Fg=WE(0),gKe=WE(1),xKe=WE(2),bKe=WE(3),yKe=WE(4),vKe=WE(5),wKe=WE(6),CKe=Fg.range,qKt=gKe.range,HKt=xKe.range,YKt=bKe.range,KKt=yKe.range,XKt=vKe.range,ZKt=wKe.range});var Ib,QKt,Db,JKt,f0e=w(()=>{"use strict";Tb();Ib=Wr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),QKt=Ib.range,Db=Wr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),JKt=Db.range});var Nb,eXt,Fb,tXt,d0e=w(()=>{"use strict";Tb();Nb=Wr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Nb.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Wr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});eXt=Nb.range,Fb=Wr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Fb.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Wr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});tXt=Fb.range});function SKe(e,t,n,r,i,o){let s=[[Ra,1,1e3],[Ra,5,5*1e3],[Ra,15,15*1e3],[Ra,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[r,1,864e5],[r,2,2*864e5],[n,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function a(u,c,f){let d=c<u;d&&([u,c]=[c,u]);let p=f&&typeof f.range=="function"?f:l(u,c,f),m=p?p.range(u,+c+1):[];return d?m.reverse():m}function l(u,c,f){let d=Math.abs(c-u)/f,p=ME(([,,g])=>g).right(s,d);if(p===s.length)return e.every(fD(u/31536e6,c/31536e6,f));if(p===0)return Dp.every(Math.max(fD(u,c,f),1));let[m,h]=s[d/s[p-1][2]<s[p][2]/d?p-1:p];return m.every(h)}return[a,l]}var p0e,m0e,h0e,g0e,EKe=w(()=>{"use strict";Ip();o0e();s0e();a0e();l0e();u0e();c0e();f0e();d0e();[p0e,m0e]=SKe(Fb,Db,Fg,AG,rw,tw),[h0e,g0e]=SKe(Nb,Ib,Ng,Np,nw,ew)});var TG=w(()=>{"use strict";o0e();s0e();a0e();l0e();u0e();c0e();f0e();d0e();EKe()});function rXt(e){return new Date(e)}function iXt(e){return e instanceof Date?+e:+new Date(+e)}function kG(e,t,n,r,i,o,s,a,l,u){var c=EL(),f=c.invert,d=c.domain,p=u(".%L"),m=u(":%S"),h=u("%I:%M"),g=u("%I %p"),x=u("%a %d"),b=u("%b %d"),y=u("%B"),v=u("%Y");function C(_){return(l(_)<_?p:a(_)<_?m:s(_)<_?h:o(_)<_?g:r(_)<_?i(_)<_?x:b:n(_)<_?y:v)(_)}return c.invert=function(_){return new Date(f(_))},c.domain=function(_){return arguments.length?d(Array.from(_,iXt)):d().map(rXt)},c.ticks=function(_){var S=d();return e(S[0],S[S.length-1],_??10)},c.tickFormat=function(_,S){return S==null?C:u(S)},c.nice=function(_){var S=d();return(!_||typeof _.range!="function")&&(_=t(S[0],S[S.length-1],_??10)),_?d(kL(S,_)):c},c.copy=function(){return Ig(c,kG(e,t,n,r,i,o,s,a,l,u))},c}function IG(){return Fo.apply(kG(h0e,g0e,Nb,Ib,Ng,Np,nw,ew,Ra,S1).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var x0e=w(()=>{"use strict";TG();CI();Q1();$c();t0e()});function DG(){return Fo.apply(kG(p0e,m0e,Fb,Db,Fg,kb,rw,tw,Ra,E1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}var AKe=w(()=>{"use strict";TG();CI();x0e();$c()});function NG(){var e=0,t=1,n,r,i,o,s=Js,a=!1,l;function u(f){return f==null||isNaN(f=+f)?l:s(i===0?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(a=!!f,u):a},u.interpolator=function(f){return arguments.length?(s=f,u):s};function c(f){return function(d){var p,m;return arguments.length?([p,m]=d,s=f(p,m),u):[s(0),s(1)]}}return u.range=c(wu),u.rangeRound=c(Z1),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function Rb(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function xD(){var e=Pc(NG()(Js));return e.copy=function(){return Rb(e,xD())},kg.apply(e,arguments)}function FG(){var e=IL(NG()).domain([1,10]);return e.copy=function(){return Rb(e,FG()).base(e.base())},kg.apply(e,arguments)}function RG(){var e=NL(NG());return e.copy=function(){return Rb(e,RG()).constant(e.constant())},kg.apply(e,arguments)}function LL(){var e=RL(NG());return e.copy=function(){return Rb(e,LL()).exponent(e.exponent())},kg.apply(e,arguments)}function b0e(){return LL.apply(null,arguments).exponent(.5)}var y0e=w(()=>{"use strict";SL();Q1();$c();J1();_G();SG();EG()});function OG(){var e=0,t=.5,n=1,r=1,i,o,s,a,l,u=Js,c,f=!1,d;function p(h){return isNaN(h=+h)?d:(h=.5+((h=+c(h))-o)*(r*h<r*o?a:l),u(f?Math.max(0,Math.min(1,h)):h))}p.domain=function(h){return arguments.length?([e,t,n]=h,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,p):[e,t,n]},p.clamp=function(h){return arguments.length?(f=!!h,p):f},p.interpolator=function(h){return arguments.length?(u=h,p):u};function m(h){return function(g){var x,b,y;return arguments.length?([x,b,y]=g,u=BE(h,[x,b,y]),p):[u(0),u(.5),u(1)]}}return p.range=m(wu),p.rangeRound=m(Z1),p.unknown=function(h){return arguments.length?(d=h,p):d},function(h){return c=h,i=h(e),o=h(t),s=h(n),a=i===o?0:.5/(o-i),l=o===s?0:.5/(s-o),r=o<i?-1:1,p}}function BL(){var e=Pc(OG()(Js));return e.copy=function(){return Rb(e,BL())},kg.apply(e,arguments)}function MG(){var e=IL(OG()).domain([.1,1,10]);return e.copy=function(){return Rb(e,MG()).base(e.base())},kg.apply(e,arguments)}function $G(){var e=NL(OG());return e.copy=function(){return Rb(e,$G()).constant(e.constant())},kg.apply(e,arguments)}function zL(){var e=RL(OG());return e.copy=function(){return Rb(e,zL()).exponent(e.exponent())},kg.apply(e,arguments)}function v0e(){return zL.apply(null,arguments).exponent(.5)}var TKe=w(()=>{"use strict";SL();Q1();$c();J1();_G();y0e();SG();EG()});var w0e=w(()=>{"use strict";XYe();J1();_G();SG();lYe();EG();rKe();iKe();oKe();x0e();AKe();y0e();TKe();e0e()});function S0e(e){return GE.setFullYear(e),GE.setMonth(0),GE.setDate(1),GE.setHours(0,0,0,0),GE}function lXt(e){return Np.count(S0e(e.getFullYear())-1,e)}function kKe(e){return Ng.count(S0e(e.getFullYear())-1,e)}function C0e(e){return S0e(e).getDay()}function uXt(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return kb.count(t-1,e)}function IKe(e){let t=Date.UTC(e.getUTCFullYear(),0,1);return Fg.count(t-1,e)}function _0e(e){return GE.setTime(Date.UTC(e,0,1)),GE.getUTCDay()}function bD(e,t,n){return t+e*7-(n+6)%7}var qf,lw,Rg,Fp,iw,ow,yD,sw,aw,qE,HE,aXt,jVr,VVr,GE,WVr,GVr,qVr,HVr,YVr,KVr,UL,jL,VL,PG,cXt,DKe,fXt,dXt,WL,GL,qL,pXt,mXt,NKe,hXt,XVr,FKe=w(()=>{"use strict";uG();TG();qf="year",lw="quarter",Rg="month",Fp="week",iw="date",ow="day",yD="dayofyear",sw="hours",aw="minutes",qE="seconds",HE="milliseconds",aXt=[qf,lw,Rg,Fp,iw,ow,yD,sw,aw,qE,HE],jVr=aXt.reduce((e,t,n)=>(e[t]=1+n,e),{}),VVr={[qf]:"%Y ",[lw]:"Q%q ",[Rg]:"%b ",[iw]:"%d ",[Fp]:"W%U ",[ow]:"%a ",[yD]:"%j ",[sw]:"%H:00",[aw]:"00:%M",[qE]:":%S",[HE]:".%L",[`${qf}-${Rg}`]:"%Y-%m ",[`${qf}-${Rg}-${iw}`]:"%Y-%m-%d ",[`${sw}-${aw}`]:"%H:%M"},GE=new Date;WVr={[qf]:e=>e.getFullYear(),[lw]:e=>Math.floor(e.getMonth()/3),[Rg]:e=>e.getMonth(),[iw]:e=>e.getDate(),[sw]:e=>e.getHours(),[aw]:e=>e.getMinutes(),[qE]:e=>e.getSeconds(),[HE]:e=>e.getMilliseconds(),[yD]:e=>lXt(e),[Fp]:e=>kKe(e),[Fp+ow]:(e,t)=>bD(kKe(e),e.getDay(),C0e(t)),[ow]:(e,t)=>bD(1,e.getDay(),C0e(t))},GVr={[lw]:e=>3*e,[Fp]:(e,t)=>bD(e,0,C0e(t))},qVr={[qf]:e=>e.getUTCFullYear(),[lw]:e=>Math.floor(e.getUTCMonth()/3),[Rg]:e=>e.getUTCMonth(),[iw]:e=>e.getUTCDate(),[sw]:e=>e.getUTCHours(),[aw]:e=>e.getUTCMinutes(),[qE]:e=>e.getUTCSeconds(),[HE]:e=>e.getUTCMilliseconds(),[yD]:e=>uXt(e),[Fp]:e=>IKe(e),[ow]:(e,t)=>bD(1,e.getUTCDay(),_0e(t)),[Fp+ow]:(e,t)=>bD(IKe(e),e.getUTCDay(),_0e(t))},HVr={[lw]:e=>3*e,[Fp]:(e,t)=>bD(e,0,_0e(t))},YVr={[qf]:Nb,[lw]:Ib.every(3),[Rg]:Ib,[Fp]:Ng,[iw]:Np,[ow]:Np,[yD]:Np,[sw]:nw,[aw]:ew,[qE]:Ra,[HE]:Dp},KVr={[qf]:Fb,[lw]:Db.every(3),[Rg]:Db,[Fp]:Fg,[iw]:kb,[ow]:kb,[yD]:kb,[sw]:rw,[aw]:tw,[qE]:Ra,[HE]:Dp},UL=1e3,jL=UL*60,VL=jL*60,PG=VL*24,cXt=PG*7,DKe=PG*30,fXt=PG*365,dXt=[qf,Rg,iw,sw,aw,qE,HE],WL=dXt.slice(0,-1),GL=WL.slice(0,-1),qL=GL.slice(0,-1),pXt=qL.slice(0,-1),mXt=[qf,Fp],NKe=[qf,Rg],hXt=[qf],XVr=[[WL,1,UL],[WL,5,5*UL],[WL,15,15*UL],[WL,30,30*UL],[GL,1,jL],[GL,5,5*jL],[GL,15,15*jL],[GL,30,30*jL],[qL,1,VL],[qL,3,3*VL],[qL,6,6*VL],[qL,12,12*VL],[pXt,1,PG],[mXt,1,cXt],[NKe,1,DKe],[NKe,3,3*DKe],[hXt,1,fXt]]});function gXt(e,t,n){let r=e-t+n*2;return e?r>0?r:1:0}function SXt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function EXt(e){return function(t){let n=e.range(),r=t[0],i=t[1],o=-1,s,a,l,u;for(i<r&&(a=r,r=i,i=a),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(o<0&&(o=l),s=l);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function N0e(){let e=PE().unknown(void 0),t=e.domain,n=e.range,r=[0,1],i,o,s=!1,a=0,l=0,u=.5;delete e.unknown;function c(){let f=t().length,d=r[1]<r[0],p=r[1-d],m=gXt(f,a,l),h=r[d-0];i=(p-h)/(m||1),s&&(i=Math.floor(i)),h+=(p-h-i*(f-a))*u,o=i*(1-a),s&&(h=Math.round(h),o=Math.round(o));let g=dG(f).map(x=>h+i*x);return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),a=l,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;let d=r[1]<r[0],p=d?n().reverse():n(),m=p.length-1,h=+f[0],g=+f[1],x,b,y;if(!(h!==h||g!==g)&&(g<h&&(y=h,h=g,g=y),!(g<p[0]||h>r[1-d])))return x=Math.max(0,yL(p,h)-1),b=h===g?x:yL(p,g)-1,h-p[x]>o+1e-10&&++x,d&&(y=x,x=m-b,b=m-y),x>b?void 0:t().slice(x,b+1)},e.invert=function(f){let d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return N0e().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(l).align(u)},c()}function $Ke(e){let t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return $Ke(t())},e}function AXt(){return $Ke(N0e().paddingInner(1))}function kXt(e){return TXt.call(e,QHe)}function PKe(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(kp(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=kXt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=IXt.call(r),n):t.slice()},n.tickFormat=function(r,i){return hD(e[0],Ige(e),r??10,i)},n.copy=function(){return PKe().domain(n.domain()).range(n.range())},n}function NXt(e){return e[DXt]=!0,e}function FXt(e,t,n){let r=function(){let o=t();return o.invertRange||(o.invertRange=o.invert?SXt(o):o.invertExtent?EXt(o):void 0),o.type=e,NXt(o)};return r.metadata=Nge(Dge(n)),r}function Fr(e,t,n){return arguments.length>1?(E0e.set(e,FXt(e,t,n)),this):RXt(e)?E0e.get(e):void 0}function RXt(e){return E0e.has(e)}function OXt(e,t,n){return BE(MXt(t||"rgb",n),e)}function MXt(e,t){let n=Xge[$Xt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function $Xt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function LKe(e){if(kge(e))return e;let t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function BKe(e,t){for(let n in e)BXt(n,t(e[n]))}function BXt(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(RKe[e]=t,this):RKe[e]}var xXt,A0e,vD,T0e,k0e,I0e,bXt,yXt,wD,HL,LG,D0e,OKe,vXt,wXt,CXt,_Xt,Ss,BG,zG,Rp,MKe,TXt,IXt,E0e,DXt,PXt,LXt,RKe,lWr,uWr,zKe=w(()=>{"use strict";uG();Ip();w0e();w0e();SL();Wue();FKe();xXt="identity",A0e="linear",vD="log",T0e="pow",k0e="sqrt",I0e="symlog",bXt="time",yXt="utc",wD="sequential",HL="diverging",LG="quantile",D0e="quantize",OKe="threshold",vXt="ordinal",wXt="point",CXt="band",_Xt="bin-ordinal",Ss="continuous",BG="discrete",zG="discretizing",Rp="interpolating",MKe="temporal";TXt=Array.prototype.map;IXt=Array.prototype.slice;E0e=new Map,DXt=Symbol("vega_scale");Fr(xXt,TL);Fr(A0e,AL,Ss);Fr(vD,DL,[Ss,vD]);Fr(T0e,gD,Ss);Fr(k0e,n0e,Ss);Fr(I0e,FL,Ss);Fr(bXt,IG,[Ss,MKe]);Fr(yXt,DG,[Ss,MKe]);Fr(wD,xD,[Ss,Rp]);Fr(`${wD}-${A0e}`,xD,[Ss,Rp]);Fr(`${wD}-${vD}`,FG,[Ss,Rp,vD]);Fr(`${wD}-${T0e}`,LL,[Ss,Rp]);Fr(`${wD}-${k0e}`,b0e,[Ss,Rp]);Fr(`${wD}-${I0e}`,RG,[Ss,Rp]);Fr(`${HL}-${A0e}`,BL,[Ss,Rp]);Fr(`${HL}-${vD}`,MG,[Ss,Rp,vD]);Fr(`${HL}-${T0e}`,zL,[Ss,Rp]);Fr(`${HL}-${k0e}`,v0e,[Ss,Rp]);Fr(`${HL}-${I0e}`,$G,[Ss,Rp]);Fr(LG,OL,[zG,LG]);Fr(D0e,ML,zG);Fr(OKe,$L,zG);Fr(_Xt,PKe,[BG,zG]);Fr(vXt,PE,BG);Fr(CXt,N0e,BG);Fr(wXt,AXt,BG);PXt={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},LXt={accent:H3,category10:q3,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Y3,observable10:K3,paired:X3,pastel1:Z3,pastel2:Q3,set1:J3,set2:e$,set3:t$,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};RKe={};BKe(LXt,LKe);BKe(PXt,e=>OXt(LKe(e)));lWr={[LG]:"quantiles",[D0e]:"thresholds",[OKe]:"domain"},uWr={[LG]:"quantiles",[D0e]:"domain"}});var UKe,fWr,dWr,jKe=w(()=>{"use strict";UKe=Math.random,fWr=Math.sqrt(2*Math.PI),dWr=.5*Math.PI/180});var O0e={};rn(O0e,{wordcloud:()=>R0e});function zXt(){var e=[256,256],t,n,r,i,o,s,a,l=VKe,u=[],c=Math.random,f={};f.layout=function(){for(var m=d(uu()),h=qXt((e[0]>>5)*e[1]),g=null,x=u.length,b=-1,y=[],v=u.map(_=>({text:t(_),font:n(_),style:i(_),weight:o(_),rotate:s(_),size:~~(r(_)+1e-14),padding:a(_),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:_})).sort((_,S)=>S.size-_.size);++b<x;){var C=v[b];C.x=e[0]*(c()+.5)>>1,C.y=e[1]*(c()+.5)>>1,UXt(m,C,v,b),C.hasText&&p(h,C,g)&&(y.push(C),g?VXt(g,C):g=[{x:C.x+C.x0,y:C.y+C.y0},{x:C.x+C.x1,y:C.y+C.y1}],C.x-=e[0]>>1,C.y-=e[1]>>1)}return y};function d(m){m.width=m.height=1;var h=Math.sqrt(m.getContext("2d").getImageData(0,0,1,1).data.length>>2);m.width=(YL<<5)/h,m.height=UG/h;var g=m.getContext("2d");return g.fillStyle=g.strokeStyle="red",g.textAlign="center",{context:g,ratio:h}}function p(m,h,g){for(var x=h.x,b=h.y,y=Math.sqrt(e[0]*e[0]+e[1]*e[1]),v=l(e),C=c()<.5?1:-1,_=-C,S,E,T;(S=v(_+=C))&&(E=~~S[0],T=~~S[1],!(Math.min(Math.abs(E),Math.abs(T))>=y));)if(h.x=x+E,h.y=b+T,!(h.x+h.x0<0||h.y+h.y0<0||h.x+h.x1>e[0]||h.y+h.y1>e[1])&&(!g||!jXt(h,m,e[0]))&&(!g||WXt(h,g))){for(var I=h.sprite,k=h.width>>5,O=e[0]>>5,F=h.x-(k<<4),B=F&127,M=32-B,z=h.y1-h.y0,W=(h.y+h.y0)*O+(F>>5),H,Q=0;Q<z;Q++){H=0;for(var re=0;re<=k;re++)m[W+re]|=H<<M|(re<k?(H=I[Q*k+re])>>>B:0);W+=O}return h.sprite=null,!0}return!1}return f.words=function(m){return arguments.length?(u=m,f):u},f.size=function(m){return arguments.length?(e=[+m[0],+m[1]],f):e},f.font=function(m){return arguments.length?(n=YE(m),f):n},f.fontStyle=function(m){return arguments.length?(i=YE(m),f):i},f.fontWeight=function(m){return arguments.length?(o=YE(m),f):o},f.rotate=function(m){return arguments.length?(s=YE(m),f):s},f.text=function(m){return arguments.length?(t=YE(m),f):t},f.spiral=function(m){return arguments.length?(l=HXt[m]||m,f):l},f.fontSize=function(m){return arguments.length?(r=YE(m),f):r},f.padding=function(m){return arguments.length?(a=YE(m),f):a},f.random=function(m){return arguments.length?(c=m,f):c},f}function UXt(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,(YL<<5)/o,UG/o);var s=0,a=0,l=0,u=n.length,c,f,d,p,m;for(--r;++r<u;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var h=Math.sin(t.rotate*F0e),g=Math.cos(t.rotate*F0e),x=c*g,b=c*h,y=d*g,v=d*h;c=Math.max(Math.abs(x+v),Math.abs(x-v))+31>>5<<5,d=~~Math.max(Math.abs(b+y),Math.abs(b-y))}else c=c+31>>5<<5;if(d>l&&(l=d),s+c>=YL<<5&&(s=0,a+=l,l=0),a+d>=UG)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*F0e),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var C=i.getImageData(0,0,(YL<<5)/o,UG/o).data,_=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,p=0;p<d*f;p++)_[p]=0;if(s=t.xoff,s==null)return;a=t.yoff;var S=0,E=-1;for(m=0;m<d;m++){for(p=0;p<c;p++){var T=f*m+(p>>5),I=C[(a+m)*(YL<<5)+(s+p)<<2]?1<<31-p%32:0;_[T]|=I,S|=I}S?E=m:(t.y0++,d--,m--,a++)}t.y1=t.y0+E,t.sprite=_.slice(0,(t.y1-t.y0)*f)}}}function jXt(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=o&127,a=32-s,l=e.y1-e.y0,u=(e.y+e.y0)*n+(o>>5),c,f=0;f<l;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[u+d])return!0;u+=n}return!1}function VXt(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function WXt(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function VKe(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function GXt(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function qXt(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function YE(e){return typeof e=="function"?e:function(){return e}}function R0e(e){ce.call(this,zXt(),e)}var F0e,YL,UG,HXt,WKe,YXt,GKe=w(()=>{"use strict";Lk();hs();uG();zKe();jKe();F0e=Math.PI/180,YL=64,UG=2048;HXt={archimedean:VKe,rectangular:GXt},WKe=["x","y","font","fontSize","fontStyle","fontWeight","angle"],YXt=["text","font","rotate","fontSize","fontStyle","fontWeight"];R0e.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:WKe}]};tYe(R0e,ce,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&OE("Wordcloud size dimensions must be non-zero.");function n(m){let h=e[m];return aG(h)&&t.modified(h.fields)}let r=e.modified();if(!(r||t.changed(t.ADD_REM)||YXt.some(n)))return;let i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||WKe,a=e.fontSize||14,l;if(aG(a)?l=e.fontSizeRange:a=lG(a),l){let m=a,h=Fr("sqrt")().domain(eYe(i,m)).range(l);a=g=>h(m(g))}i.forEach(m=>{m[s[0]]=NaN,m[s[1]]=NaN,m[s[3]]=0});let u=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(UKe).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,p=u.length;for(let m=0,h,g;m<p;++m)h=u[m],g=h.datum,g[s[0]]=h.x+f,g[s[1]]=h.y+d,g[s[2]]=h.font,g[s[3]]=h.size,g[s[4]]=h.style,g[s[5]]=h.weight,g[s[6]]=h.rotate;return t.reflow(r).modifies(s)}})});var P0e={};rn(P0e,{crossfilter:()=>M0e,resolvefilter:()=>$0e});function ZXt(){let e=8,t=[],n=KL(0),r=jG(0,e),i=jG(0,e);return{data:()=>t,seen:()=>n=QXt(n,t.length),add(o){for(let s=0,a=t.length,l=o.length,u;s<l;++s)u=o[s],u._index=a++,t.push(u)},remove(o,s){let a=t.length,l=Array(a-o),u=t,c,f,d;for(f=0;!s[f]&&f<a;++f)l[f]=t[f],u[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?u[f]=-1:(u[f]=d,r[d]=r[f],i[d]=i[f],l[d]=c,c._index=d++),r[f]=0;return t=l,u},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){let a=r.length;(o>a||s>e)&&(e=Math.max(s,e),r=jG(o,e,r),i=jG(o,e))}}}function QXt(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function jG(e,t,n){let r=(t<257?KXt:t<65537?XXt:KL)(e);return n&&r.set(n),r}function qKe(e,t,n){let r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){let s=this,a=s.bisect(s.range,i.value),l=i.index,u=a[0],c=a[1],f=l.length,d;for(d=0;d<u;++d)o[l[d]]|=r;for(d=c;d<f;++d)o[l[d]]|=r;return s}}}function HKe(){let e=KL(0),t=[],n=0;function r(a,l,u){if(!l.length)return[];let c=n,f=l.length,d=KL(f),p=Array(f),m,h,g;for(g=0;g<f;++g)p[g]=a(l[g]),d[g]=g;if(p=JXt(p,d),c)m=t,h=e,t=Array(c+f),e=KL(c+f),eZt(u,m,h,c,p,d,f,t,e);else{if(u>0)for(g=0;g<f;++g)d[g]+=u;t=p,e=d}return n=c+f,{index:d,value:p}}function i(a,l){let u=n,c,f,d;for(f=0;!l[e[f]]&&f<u;++f);for(d=f;f<u;++f)l[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=u-a}function o(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]}function s(a,l){let u;return l?u=l.length:(l=t,u=n),[qoe(l,a[0],0,u),gS(l,a[1],0,u)]}return{insert:r,remove:i,bisect:s,reindex:o,index:()=>e,size:()=>n}}function JXt(e,t){return e.sort.call(t,(n,r)=>{let i=e[n],o=e[r];return i<o?-1:i>o?1:0}),Yoe(e,t)}function eZt(e,t,n,r,i,o,s,a,l){let u=0,c=0,f;for(f=0;u<r&&c<s;++f)t[u]<i[c]?(a[f]=t[u],l[f]=n[u++]):(a[f]=i[c],l[f]=o[c++]+e);for(;u<r;++u,++f)a[f]=t[u],l[f]=n[u];for(;c<s;++c,++f)a[f]=i[c],l[f]=o[c]+e}function M0e(e){ce.call(this,ZXt(),e),this._indices=null,this._dims=null}function $0e(e){ce.call(this,null,e)}var KXt,XXt,KL,YKe=w(()=>{"use strict";kr();hs();ao();KXt=e=>new Uint8Array(e),XXt=e=>new Uint16Array(e),KL=e=>new Uint32Array(e);M0e.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};$e(M0e,ce,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){let n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length,a=0,l,u;for(;a<s;++a)l=n[a].fname,u=i[l]||(i[l]=HKe()),o.push(qKe(u,a,r[a]));return this.eval(e,t)},reinit(e,t){let n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,p=i.length,m={},h,g,x,b,y,v,C,_,S;if(u.set(l),t.rem.length&&(y=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(v={},b=t.mod,C=0,_=b.length;C<_;++C)v[b[C]._index]=1;for(C=0;C<p;++C)S=r[C],(!s[C]||e.modified("fields",C)||t.modified(S.fields))&&(x=S.fname,(h=m[x])||(o[x]=g=HKe(),m[x]=h=g.insert(S,t.source,0)),s[C]=qKe(g,C,i[C]).onAdd(h,l));for(C=0,_=a.data().length;C<_;++C)y[C]||(u[C]!==l[C]?f.push(C):v[C]&&l[C]!==c&&d.push(C));return a.mask=(1<<p)-1,n},eval(e,t){let n=t.materialize().fork(),r=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){let r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,l={},u=n.add,c=i.size()+r.length,f=o.length,d=i.size(),p,m,h;i.resize(c,f),i.add(r);let g=i.curr(),x=i.prev(),b=i.all();for(p=0;p<f;++p)m=a[p].fname,h=l[m]||(l[m]=s[m].insert(a[p],r,d)),o[p].onAdd(h,g);for(;d<c;++d)x[d]=b,g[d]!==b&&u.push(d)},modify(e,t){let n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod,a,l,u;for(a=0,l=s.length;a<l;++a)u=s[a]._index,i[u]!==o&&n.push(u)},remove(e,t,n){let r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),l={},u=n.rem,c=t.rem,f,d,p,m;for(f=0,d=c.length;f<d;++f)p=c[f]._index,l[p]=1,s[p]=m=o[p],o[p]=a,m!==a&&u.push(p);for(p in r)r[p].remove(d,l);return this.reindex(t,d,l),l},reindex(e,t,n){let r=this._indices,i=this.value;e.runAfter(()=>{let o=i.remove(t,n);for(let s in r)r[s].reindex(o)})},update(e,t,n){let r=this._dims,i=e.query,o=t.stamp,s=r.length,a=0,l,u;for(n.filters=0,u=0;u<s;++u)e.modified("query",u)&&(l=u,++a);if(a===1)a=r[l].one,this.incrementOne(r[l],i[l],n.add,n.rem);else for(u=0,a=0;u<s;++u)e.modified("query",u)&&(a|=r[u].one,this.incrementAll(r[u],i[u],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){let i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],p=u[0],m=u[1],h=e.one,g,x,b;if(f<p)for(g=f,x=Math.min(p,d);g<x;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=h;else if(f>p)for(g=p,x=Math.min(f,m);g<x;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=h;if(d>m)for(g=Math.max(f,m),x=d;g<x;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=h;else if(d<m)for(g=Math.max(p,d),x=m;g<x;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=h;e.range=t.slice()},incrementOne(e,t,n,r){let i=this.value,o=i.curr(),s=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],f=a[0],d=a[1],p=e.one,m,h,g;if(u<f)for(m=u,h=Math.min(f,c);m<h;++m)g=s[m],o[g]^=p,n.push(g);else if(u>f)for(m=f,h=Math.min(u,d);m<h;++m)g=s[m],o[g]^=p,r.push(g);if(c>d)for(m=Math.max(u,d),h=c;m<h;++m)g=s[m],o[g]^=p,n.push(g);else if(c<d)for(m=Math.max(f,c),h=d;m<h;++m)g=s[m],o[g]^=p,r.push(g);e.range=t.slice()}});$0e.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};$e($0e,ce,{transform(e,t){let n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;let o=t.fork(t.ALL),s=r.data(),a=r.curr(),l=r.prev(),u=c=>a[c]&n?null:s[c];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,c=>{let f=a[c]&n;return!f&&f^l[c]&n?s[c]:null}),o.filter(o.REM,c=>{let f=a[c]&n;return f&&!(f^(f^l[c]&n))?s[c]:null})):(o.filter(o.ADD,u),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>u(c._index))}})});function CD(e,t,n){return e.fields=t||[],e.fname=n,e}function tZt(e){return e.length===1?nZt(e[0]):rZt(e)}function Es(e){throw Error(e)}function iZt(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||Es("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&Es("Access path missing closing bracket: "+e),r&&Es("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function L0e(e,t,n){let r=iZt(e);return e=r.length===1?r[0]:e,CD((n&&n.get||tZt)(r),[e],t||e)}function XL(e){return e===Object(e)}function Ob(e){return e[e.length-1]}function qG(e){return e==null||e===""?null:+e}function HG(e,t,n,r){let i=n(e[0]),o=n(Ob(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function JKe(e,t){return HG(e,t,qG,GG)}function eXe(e,t){var n=Math.sign(e[0]);return HG(e,t,XKe(n),KKe(n))}function tXe(e,t,n){return HG(e,t,WG(n),WG(1/n))}function nXe(e,t,n){return HG(e,t,ZKe(n),QKe(n))}function YG(e,t,n,r,i){let o=r(e[0]),s=r(Ob(e)),a=t!=null?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function rXe(e,t,n){return YG(e,t,n,qG,GG)}function iXe(e,t,n){let r=Math.sign(e[0]);return YG(e,t,n,XKe(r),KKe(r))}function oXe(e,t,n,r){return YG(e,t,n,WG(r),WG(1/r))}function sXe(e,t,n,r){return YG(e,t,n,ZKe(r),QKe(r))}function aXe(e){return 1+~~(new Date(e).getMonth()/3)}function lXe(e){return 1+~~(new Date(e).getUTCMonth()/3)}function z0e(e){return e!=null?Og(e)?e:[e]:[]}function uXe(e,t,n){let r=e[0],i=e[1],o;return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function _D(e){return typeof e=="function"}function KG(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function cXe(e,t){let n=0,r,i,o,s;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],i!=null&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),i!=null&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function Mg(e,t){return oZt.call(e,t)}function fXe(e,t,n,r,i,o){if(!n&&n!==0)return o;let s=+n,a=e[0],l=Ob(e),u;l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);let c=Math.abs(l-t);return u<c&&u<=s?r:c<=s?i:o}function dXe(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function pXe(e){return typeof e=="boolean"}function U0e(e){return Object.prototype.toString.call(e)==="[object Date]"}function j0e(e){return typeof e=="number"}function mXe(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function uw(e){return typeof e=="string"}function hXe(e,t){let n=e[0],r=Ob(e),i=+t;return i?i===1?r:n+i*(r-n):n}function VG(e,t){let n="";for(;--t>=0;)n+=e;return n}function gXe(e,t,n,r){let i=n||" ",o=e+"",s=t-o.length;return s<=0?o:r==="left"?VG(i,s)+o:r==="center"?VG(i,~~(s/2))+o+VG(i,Math.ceil(s/2)):o+VG(i,s)}function xXe(e){return e&&Ob(e)-e[0]||0}function SD(e){return Og(e)?"["+e.map(SD)+"]":XL(e)||uw(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function bXe(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}function yXe(e,t){return t=t||sZt,e==null||e===""?null:t(e)}function vXe(e){return e==null||e===""?null:e+""}function V0e(e){let t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function wXe(e,t,n,r){let i=r??"\u2026",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:n==="left"?i+o.slice(s-a):n==="center"?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}var nZt,rZt,CWr,GG,_Wr,SWr,B0e,EWr,Og,KKe,XKe,ZKe,QKe,WG,oZt,sZt,W0e=w(()=>{"use strict";nZt=e=>function(t){return t[e]},rZt=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};CWr=L0e("id"),GG=CD(e=>e,[],"identity"),_Wr=CD(()=>0,[],"zero"),SWr=CD(()=>1,[],"one"),B0e=CD(()=>!0,[],"true"),EWr=CD(()=>!1,[],"false"),Og=Array.isArray;KKe=e=>t=>e*Math.exp(t),XKe=e=>t=>Math.log(e*t),ZKe=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),QKe=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,WG=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);oZt=Object.prototype.hasOwnProperty;sZt=e=>j0e(e)||U0e(e)?e:Date.parse(e)});function Op(e){this.type=e}function xZt(e){switch(e.type){case cZt:return e.elements;case fZt:case pZt:return[e.left,e.right];case X0e:return[e.callee].concat(e.arguments);case dZt:return[e.test,e.consequent,e.alternate];case mZt:return[e.object,e.property];case hZt:return e.properties;case lZt:return[e.key,e.value];case gZt:return[e.argument];case uZt:case ZE:case aZt:default:return[]}}function eq(e,t){if(!e)throw new Error("ASSERT: "+t)}function Mb(e){return e>=48&&e<=57}function Z0e(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function QL(e){return"01234567".indexOf(e)>=0}function PZt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function eB(e){return e===10||e===13||e===8232||e===8233}function rB(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&MZt.test(String.fromCharCode(e))}function ZG(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&$Zt.test(String.fromCharCode(e))}function NXe(){for(;we<Oa;){let e=mt.charCodeAt(we);if(PZt(e)||eB(e))++we;else break}}function K0e(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<Oa&&Z0e(mt[we])?(r=mt[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Qn({},As,ea);return String.fromCharCode(i)}function BZt(){var e,t,n,r;for(e=mt[we],t=0,e==="}"&&Qn({},As,ea);we<Oa&&(e=mt[we++],!!Z0e(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Qn({},As,ea),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function FXe(){var e,t;for(e=mt.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(mt.charCodeAt(we)!==117&&Qn({},As,ea),++we,e=K0e("u"),(!e||e==="\\"||!rB(e.charCodeAt(0)))&&Qn({},As,ea),t=e);we<Oa&&(e=mt.charCodeAt(we),!!ZG(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),mt.charCodeAt(we)!==117&&Qn({},As,ea),++we,e=K0e("u"),(!e||e==="\\"||!ZG(e.charCodeAt(0)))&&Qn({},As,ea),t+=e);return t}function zZt(){var e,t;for(e=we++;we<Oa;){if(t=mt.charCodeAt(we),t===92)return we=e,FXe();if(ZG(t))++we;else break}return mt.slice(e,we)}function UZt(){var e,t,n;return e=we,t=mt.charCodeAt(we)===92?FXe():zZt(),t.length===1?n=KE:LZt.hasOwnProperty(t)?n=cw:t==="null"?n=JG:t==="true"||t==="false"?n=QG:n=KE,{type:n,value:t,start:e,end:we}}function q0e(){var e=we,t=mt.charCodeAt(we),n,r=mt[we],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:Cu,value:String.fromCharCode(t),start:e,end:we};default:if(n=mt.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:Cu,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,mt.charCodeAt(we)===61&&++we,{type:Cu,value:mt.slice(e,we),start:e,end:we}}}if(s=mt.substr(we,4),s===">>>=")return we+=4,{type:Cu,value:s,start:e,end:we};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return we+=3,{type:Cu,value:o,start:e,end:we};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:Cu,value:i,start:e,end:we};if(i==="//"&&Qn({},As,ea),"<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:Cu,value:r,start:e,end:we};Qn({},As,ea)}function jZt(e){let t="";for(;we<Oa&&Z0e(mt[we]);)t+=mt[we++];return t.length===0&&Qn({},As,ea),rB(mt.charCodeAt(we))&&Qn({},As,ea),{type:QE,value:parseInt("0x"+t,16),start:e,end:we}}function VZt(e){let t="0"+mt[we++];for(;we<Oa&&QL(mt[we]);)t+=mt[we++];return(rB(mt.charCodeAt(we))||Mb(mt.charCodeAt(we)))&&Qn({},As,ea),{type:QE,value:parseInt(t,8),octal:!0,start:e,end:we}}function CXe(){var e,t,n;if(n=mt[we],eq(Mb(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=mt[we++],n=mt[we],e==="0"){if(n==="x"||n==="X")return++we,jZt(t);if(QL(n))return VZt(t);n&&Mb(n.charCodeAt(0))&&Qn({},As,ea)}for(;Mb(mt.charCodeAt(we));)e+=mt[we++];n=mt[we]}if(n==="."){for(e+=mt[we++];Mb(mt.charCodeAt(we));)e+=mt[we++];n=mt[we]}if(n==="e"||n==="E")if(e+=mt[we++],n=mt[we],(n==="+"||n==="-")&&(e+=mt[we++]),Mb(mt.charCodeAt(we)))for(;Mb(mt.charCodeAt(we));)e+=mt[we++];else Qn({},As,ea);return rB(mt.charCodeAt(we))&&Qn({},As,ea),{type:QE,value:parseFloat(e),start:t,end:we}}function WZt(){var e="",t,n,r,i,o=!1;for(t=mt[we],eq(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<Oa;)if(r=mt[we++],r===t){t="";break}else if(r==="\\")if(r=mt[we++],!r||!eB(r.charCodeAt(0)))switch(r){case"u":case"x":mt[we]==="{"?(++we,e+=BZt()):e+=K0e(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:QL(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),we<Oa&&QL(mt[we])&&(o=!0,i=i*8+"01234567".indexOf(mt[we++]),"0123".indexOf(r)>=0&&we<Oa&&QL(mt[we])&&(i=i*8+"01234567".indexOf(mt[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&mt[we]===`
`&&++we;else{if(eB(r.charCodeAt(0)))break;e+=r}return t!==""&&Qn({},As,ea),{type:nB,value:e,octal:o,start:n,end:we}}function GZt(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Qn({},Y0e)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Qn({},Y0e)}try{return new RegExp(e,t)}catch{return null}}function qZt(){var e,t,n,r,i;for(e=mt[we],eq(e==="/","Regular expression literal must start with a slash"),t=mt[we++],n=!1,r=!1;we<Oa;)if(e=mt[we++],t+=e,e==="\\")e=mt[we++],eB(e.charCodeAt(0))&&Qn({},G0e),t+=e;else if(eB(e.charCodeAt(0)))Qn({},G0e);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Qn({},G0e),i=t.substr(1,t.length-2),{value:i,literal:t}}function HZt(){var e,t,n;for(t="",n="";we<Oa&&(e=mt[we],!!ZG(e.charCodeAt(0)));)++we,e==="\\"&&we<Oa?Qn({},As,ea):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Qn({},Y0e,n),{value:n,literal:t}}function YZt(){var e,t,n,r;return vr=null,NXe(),e=we,t=qZt(),n=HZt(),r=GZt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function KZt(e){return e.type===KE||e.type===cw||e.type===QG||e.type===JG}function RXe(){if(NXe(),we>=Oa)return{type:tB,start:we,end:we};let e=mt.charCodeAt(we);return rB(e)?UZt():e===40||e===41||e===59?q0e():e===39||e===34?WZt():e===46?Mb(mt.charCodeAt(we+1))?CXe():q0e():Mb(e)?CXe():q0e()}function _u(){let e=vr;return we=e.end,vr=RXe(),we=e.end,e}function OXe(){let e=we;vr=RXe(),we=e}function XZt(e){let t=new Op(yZt);return t.elements=e,t}function _Xe(e,t,n){let r=new Op(e==="||"||e==="&&"?SZt:vZt);return r.operator=e,r.left=t,r.right=n,r}function ZZt(e,t){let n=new Op(wZt);return n.callee=e,n.arguments=t,n}function QZt(e,t,n){let r=new Op(CZt);return r.test=e,r.consequent=t,r.alternate=n,r}function Q0e(e){let t=new Op(IXe);return t.name=e,t}function ZL(e){let t=new Op(_Zt);return t.value=e.value,t.raw=mt.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function SXe(e,t,n){let r=new Op(EZt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function JZt(e){let t=new Op(AZt);return t.properties=e,t}function EXe(e,t,n){let r=new Op(TZt);return r.key=t,r.value=n,r.kind=e,r}function eQt(e,t){let n=new Op(kZt);return n.operator=e,n.argument=t,n.prefix=!0,n}function Qn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(eq(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=we,n.description=i,n}function tq(e){e.type===tB&&Qn(e,RZt),e.type===QE&&Qn(e,IZt),e.type===nB&&Qn(e,DZt),e.type===KE&&Qn(e,NZt),e.type===cw&&Qn(e,FZt),Qn(e,As,e.value)}function Ma(e){let t=_u();(t.type!==Cu||t.value!==e)&&tq(t)}function ui(e){return vr.type===Cu&&vr.value===e}function H0e(e){return vr.type===cw&&vr.value===e}function tQt(){let e=[];for(we=vr.start,Ma("[");!ui("]");)ui(",")?(_u(),e.push(null)):(e.push(XE()),ui("]")||Ma(","));return _u(),XZt(e)}function AXe(){we=vr.start;let e=_u();return e.type===nB||e.type===QE?(e.octal&&Qn(e,DXe),ZL(e)):Q0e(e.value)}function nQt(){var e,t,n,r;if(we=vr.start,e=vr,e.type===KE)return n=AXe(),Ma(":"),r=XE(),EXe("init",n,r);if(e.type===tB||e.type===Cu)tq(e);else return t=AXe(),Ma(":"),r=XE(),EXe("init",t,r)}function rQt(){var e=[],t,n,r,i={},o=String;for(we=vr.start,Ma("{");!ui("}");)t=nQt(),t.key.type===IXe?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Qn({},OZt):i[r]=!0,e.push(t),ui("}")||Ma(",");return Ma("}"),JZt(e)}function iQt(){Ma("(");let e=J0e();return Ma(")"),e}function sQt(){var e,t,n;if(ui("("))return iQt();if(ui("["))return tQt();if(ui("{"))return rQt();if(e=vr.type,we=vr.start,e===KE||oQt[vr.value])n=Q0e(_u().value);else if(e===nB||e===QE)vr.octal&&Qn(vr,DXe),n=ZL(_u());else{if(e===cw)throw new Error(JL);e===QG?(t=_u(),t.value=t.value==="true",n=ZL(t)):e===JG?(t=_u(),t.value=null,n=ZL(t)):ui("/")||ui("/=")?(n=ZL(YZt()),OXe()):tq(_u())}return n}function aQt(){let e=[];if(Ma("("),!ui(")"))for(;we<Oa&&(e.push(XE()),!ui(")"));)Ma(",");return Ma(")"),e}function lQt(){we=vr.start;let e=_u();return KZt(e)||tq(e),Q0e(e.value)}function uQt(){return Ma("."),lQt()}function cQt(){Ma("[");let e=J0e();return Ma("]"),e}function fQt(){var e,t,n;for(e=sQt();;)if(ui("."))n=uQt(),e=SXe(".",e,n);else if(ui("("))t=aQt(),e=ZZt(e,t);else if(ui("["))n=cQt(),e=SXe("[",e,n);else break;return e}function TXe(){let e=fQt();if(vr.type===Cu&&(ui("++")||ui("--")))throw new Error(JL);return e}function XG(){var e,t;if(vr.type!==Cu&&vr.type!==cw)t=TXe();else{if(ui("++")||ui("--"))throw new Error(JL);if(ui("+")||ui("-")||ui("~")||ui("!"))e=_u(),t=XG(),t=eQt(e.value,t);else{if(H0e("delete")||H0e("void")||H0e("typeof"))throw new Error(JL);t=TXe()}}return t}function kXe(e){let t=0;if(e.type!==Cu&&e.type!==cw)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function dQt(){var e,t,n,r,i,o,s,a,l,u;if(e=vr,l=XG(),r=vr,i=kXe(r),i===0)return l;for(r.prec=i,_u(),t=[e,vr],s=XG(),o=[l,r,s];(i=kXe(vr))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,l=o.pop(),t.pop(),n=_Xe(a,l,s),o.push(n);r=_u(),r.prec=i,o.push(r),t.push(vr),n=XG(),o.push(n)}for(u=o.length-1,n=o[u],t.pop();u>1;)t.pop(),n=_Xe(o[u-1].value,o[u-2],n),u-=2;return n}function XE(){var e,t,n;return e=dQt(),ui("?")&&(_u(),t=XE(),Ma(":"),n=XE(),e=QZt(e,t,n)),e}function J0e(){let e=XE();if(ui(","))throw new Error(JL);return e}function MXe(e){mt=e,we=0,Oa=mt.length,vr=null,OXe();let t=J0e();if(vr.type!==tB)throw new Error("Unexpect token after expression.");return t}function txe(e){function t(s,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(u<0?"":u===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,l){return u=>t(s,u,a,l)}let r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&Es("Missing arguments to clamp function."),s.length>3&&Es("Too many arguments to clamp function.");let a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&Es("Missing arguments to if function."),s.length>3&&Es("Too many arguments to if function.");let a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function pQt(e){let t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function $Xe(e){e=e||{};let t=e.allowed?V0e(e.allowed):{},n=e.forbidden?V0e(e.forbidden):{},r=e.constants||exe,i=(e.functions||txe)(f),o=e.globalvar,s=e.fieldvar,a=_D(o)?o:m=>`${o}["${m}"]`,l={},u={},c=0;function f(m){if(uw(m))return m;let h=d[m.type];return h==null&&Es("Unsupported type: "+m.type),h(m)}let d={Literal:m=>m.raw,Identifier:m=>{let h=m.name;return c>0?h:Mg(n,h)?Es("Illegal identifier: "+h):Mg(r,h)?r[h]:Mg(t,h)?h:(l[h]=1,a(h))},MemberExpression:m=>{let h=!m.computed,g=f(m.object);h&&(c+=1);let x=f(m.property);return g===s&&(u[pQt(x)]=1),h&&(c-=1),g+(h?"."+x:"["+x+"]")},CallExpression:m=>{m.callee.type!=="Identifier"&&Es("Illegal callee type: "+m.callee.type);let h=m.callee.name,g=m.arguments,x=Mg(i,h)&&i[h];return x||Es("Unrecognized function: "+h),_D(x)?x(g):x+"("+g.map(f).join(",")+")"},ArrayExpression:m=>"["+m.elements.map(f).join(",")+"]",BinaryExpression:m=>"("+f(m.left)+" "+m.operator+" "+f(m.right)+")",UnaryExpression:m=>"("+m.operator+f(m.argument)+")",ConditionalExpression:m=>"("+f(m.test)+"?"+f(m.consequent)+":"+f(m.alternate)+")",LogicalExpression:m=>"("+f(m.left)+m.operator+f(m.right)+")",ObjectExpression:m=>"{"+m.properties.map(f).join(",")+"}",Property:m=>{c+=1;let h=f(m.key);return c-=1,h+":"+f(m.value)}};function p(m){let h={code:f(m),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},h}return p.functions=i,p.constants=r,p}var aZt,ZE,lZt,uZt,cZt,fZt,X0e,dZt,pZt,mZt,hZt,gZt,$g,mt,we,Oa,vr,QG,tB,KE,cw,JG,QE,Cu,nB,bZt,yZt,vZt,wZt,CZt,IXe,_Zt,SZt,EZt,AZt,TZt,kZt,As,IZt,DZt,NZt,FZt,RZt,Y0e,G0e,DXe,OZt,ea,JL,MZt,$Zt,LZt,oQt,exe,PXe=w(()=>{"use strict";W0e();aZt="RawCode",ZE="Literal",lZt="Property",uZt="Identifier",cZt="ArrayExpression",fZt="BinaryExpression",X0e="CallExpression",dZt="ConditionalExpression",pZt="LogicalExpression",mZt="MemberExpression",hZt="ObjectExpression",gZt="UnaryExpression";Op.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=xZt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};QG=1,tB=2,KE=3,cw=4,JG=5,QE=6,Cu=7,nB=8,bZt=9;$g={};$g[QG]="Boolean";$g[tB]="<end>";$g[KE]="Identifier";$g[cw]="Keyword";$g[JG]="Null";$g[QE]="Numeric";$g[Cu]="Punctuator";$g[nB]="String";$g[bZt]="RegularExpression";yZt="ArrayExpression",vZt="BinaryExpression",wZt="CallExpression",CZt="ConditionalExpression",IXe="Identifier",_Zt="Literal",SZt="LogicalExpression",EZt="MemberExpression",AZt="ObjectExpression",TZt="Property",kZt="UnaryExpression",As="Unexpected token %0",IZt="Unexpected number",DZt="Unexpected string",NZt="Unexpected identifier",FZt="Unexpected reserved word",RZt="Unexpected end of input",Y0e="Invalid regular expression",G0e="Invalid regular expression: missing /",DXe="Octal literals are not allowed in strict mode.",OZt="Duplicate data property in object literal not allowed in strict mode",ea="ILLEGAL",JL="Disabled.",MZt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),$Zt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");LZt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};oQt={if:1};exe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"}});function iB(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}var LXe=w(()=>{"use strict"});function nxe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}var BXe=w(()=>{"use strict"});function nq(e){let t,n,r;e.length!==2?(t=iB,n=(a,l)=>iB(e(a),l),r=(a,l)=>e(a)-l):(t=e===iB||e===nxe?e:mQt,n=e,r=e);function i(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{let f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}function o(a,l,u=0,c=a.length){if(u<c){if(t(l,l)!==0)return c;do{let f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function s(a,l,u=0,c=a.length){let f=i(a,l,u,c-1);return f>u&&r(a[f-1],l)>-r(a[f],l)?f-1:f}return{left:i,center:s,right:o}}function mQt(){return 0}var zXe=w(()=>{"use strict";LXe();BXe()});function rq(e,...t){e=new Vh(e),t=t.map(hQt);e:for(let n of e)for(let r of t)if(!r.has(n)){e.delete(n);continue e}return e}function hQt(e){return e instanceof Vh?e:new Vh(e)}var UXe=w(()=>{"use strict";oM()});function iq(...e){let t=new Vh;for(let n of e)for(let r of n)t.add(r);return t}var jXe=w(()=>{"use strict";oM()});var VXe=w(()=>{"use strict";zXe();UXe();jXe()});function AD(e,t,n){return e.fields=t||[],e.fname=n,e}function gQt(e){return e.length===1?xQt(e[0]):bQt(e)}function ED(e){throw Error(e)}function yQt(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||ED("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&ED("Access path missing closing bracket: "+e),r&&ED("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function oq(e,t,n){let r=yQt(e);return e=r.length===1?r[0]:e,AD((n&&n.get||gQt)(r),[e],t||e)}function WXe(e){return e[e.length-1]}function fw(e){return e==null||e===""?null:+e}function rxe(e){return e!=null?sq(e)?e:[e]:[]}function GXe(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function aq(e,t){return vQt.call(e,t)}function oB(e,t,n,r){let i=t[0],o=t[t.length-1],s;return i>o&&(s=i,i=o,o=s),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=o:e<o)}function lq(e){return Object.prototype.toString.call(e)==="[object Date]"}var xQt,bQt,jWr,VWr,WWr,GWr,qWr,HWr,sq,vQt,ixe=w(()=>{"use strict";xQt=e=>function(t){return t[e]},bQt=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};jWr=oq("id"),VWr=AD(e=>e,[],"identity"),WWr=AD(()=>0,[],"zero"),GWr=AD(()=>1,[],"one"),qWr=AD(()=>!0,[],"true"),HWr=AD(()=>!1,[],"false"),sq=Array.isArray;vQt=Object.prototype.hasOwnProperty});function FQt(e){this.type=e}function RQt(e){switch(e.type){case SQt:return e.elements;case EQt:case kQt:return[e.left,e.right];case AQt:return[e.callee].concat(e.arguments);case TQt:return[e.test,e.consequent,e.alternate];case IQt:return[e.object,e.property];case DQt:return e.properties;case CQt:return[e.key,e.value];case NQt:return[e.argument];case _Qt:case oxe:case wQt:default:return[]}}var wQt,oxe,CQt,_Qt,SQt,EQt,AQt,TQt,kQt,IQt,DQt,NQt,Pg,OQt,MQt,$Qt,PQt,LQt,BQt,zQt,UQt,jQt,JWr,eGr,qXe=w(()=>{"use strict";ixe();wQt="RawCode",oxe="Literal",CQt="Property",_Qt="Identifier",SQt="ArrayExpression",EQt="BinaryExpression",AQt="CallExpression",TQt="ConditionalExpression",kQt="LogicalExpression",IQt="MemberExpression",DQt="ObjectExpression",NQt="UnaryExpression";FQt.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=RQt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};OQt=1,MQt=2,$Qt=3,PQt=4,LQt=5,BQt=6,zQt=7,UQt=8,jQt=9;Pg={};Pg[OQt]="Boolean";Pg[MQt]="<end>";Pg[$Qt]="Identifier";Pg[PQt]="Keyword";Pg[LQt]="Null";Pg[BQt]="Numeric";Pg[zQt]="Punctuator";Pg[UQt]="String";Pg[jQt]="RegularExpression";JWr=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),eGr=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]")});function ZXe(e){return(!e.getter||!e.getter[HXe])&&(e.getter=oq(e.field),e.getter[HXe]=!0),e.getter}function XXe(e,t){for(var n=t.fields,r=t.values,i=n.length,o=0,s,a;o<i;++o)if(a=n[o],s=ZXe(a)(e),lq(s)&&(s=fw(s)),lq(r[o])&&(r[o]=fw(r[o])),sq(r[o])&&lq(r[o][0])&&(r[o]=r[o].map(fw)),a.type===qQt){if(sq(r[o])?r[o].indexOf(s)<0:s!==r[o])return!1}else if(a.type===HQt){if(!oB(s,r[o]))return!1}else if(a.type===XQt){if(!oB(s,r[o],!0,!1))return!1}else if(a.type===YQt){if(!oB(s,r[o],!1,!1))return!1}else if(a.type===KQt&&!oB(s,r[o],!1,!0))return!1;return!0}function QXe(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],o=r?r[uq]&&r[uq].value:void 0,s=n===axe,a=i.length,l=0,u,c,f,d,p;l<a;++l)if(u=i[l],o&&s){if(c=c||{},f=c[d=u.unit]||0,f===-1)continue;if(p=XXe(t,u),c[d]=p?-1:++f,p&&o.size===1)return!0;if(!p&&f===o.get(d).count)return!1}else if(p=XXe(t,u),s^p)return p;return a&&s}function eZe(e,t,n){let r=this.context.data[e],i=r?r.values.value:[],o=r?r[uq]&&r[uq].value:void 0,s=n===axe,a=sB(t),l=ZQt(i,a);if(l===i.length||sB(i[l])!==a)return!1;if(o&&s){if(o.size===1)return!0;if(QQt(i,a)-l<o.size)return!1}return!0}function tZe(e,t){return e.map(n=>GXe(t.fields?{values:t.fields.map(r=>ZXe(r)(n.datum))}:{[Lg]:sB(n.datum)},t))}function nZe(e,t,n,r){for(var i=this.context.data[e],o=i?i.values.value:[],s={},a={},l={},u,c,f,d,p,m,h,g,x,b,y=o.length,v=0,C,_;v<y;++v)if(u=o[v],d=u.unit,c=u.fields,f=u.values,c&&f){for(C=0,_=c.length;C<_;++C)p=c[C],h=s[p.field]||(s[p.field]={}),g=h[d]||(h[d]=[]),l[p.field]=x=p.type.charAt(0),b=sxe[`${x}_union`],h[d]=b(g,rxe(f[C]));n&&(g=a[d]||(a[d]=[]),g.push(rxe(f).reduce((S,E,T)=>(S[c[T].field]=E,S),{})))}else p=Lg,m=sB(u),h=s[p]||(s[p]={}),g=h[d]||(h[d]=[]),g.push(m),n&&(g=a[d]||(a[d]=[]),g.push({[Lg]:m}));if(t=t||YXe,s[Lg]?s[Lg]=sxe[`${Lg}_${t}`](...Object.values(s[Lg])):Object.keys(s).forEach(S=>{s[S]=Object.keys(s[S]).map(E=>s[S][E]).reduce((E,T)=>E===void 0?T:sxe[`${l[S]}_${t}`](E,T))}),o=Object.keys(a),n&&o.length){let S=r?WQt:VQt;s[S]=t===YXe?{[KXe]:o.reduce((E,T)=>(E.push(...a[T]),E),[])}:{[GQt]:o.map(E=>({[KXe]:a[E]}))}}return s}function cq(e,t,n,r){t[0].type!==oxe&&ED("First argument to selection functions must be a string literal.");let i=t[0].value,o=t.length>=2&&WXe(t).value,s="unit",a=eJt+s,l=JQt+i;o===axe&&!aq(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),aq(r,l)||(r[l]=n.getData(i).tuplesRef())}var HXe,axe,YXe,VQt,WQt,KXe,GQt,Lg,sB,qQt,HQt,YQt,KQt,XQt,uq,JXe,ZQt,QQt,sxe,JQt,eJt,rZe=w(()=>{"use strict";VXe();ixe();qXe();HXe=Symbol("vega_selection_getter");axe="intersect",YXe="union",VQt="vlMulti",WQt="vlPoint",KXe="or",GQt="and",Lg="_vgsid_",sB=oq(Lg),qQt="E",HQt="R",YQt="R-E",KQt="R-LE",XQt="R-RE",uq="index:unit";JXe=nq(sB),ZQt=JXe.left,QQt=JXe.right;sxe={[`${Lg}_union`]:iq,[`${Lg}_intersect`]:rq,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=fw(t[0]),r=fw(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=fw(t[0]),r=fw(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}},JQt=":",eJt="@"});function aZe(e){let t=this.context.data[e];return t?t.values.value:[]}function tJt(e,t,n){let r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function nJt(e,t){let n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(B0e).insert(t)),1}function rJt(e,t,n){if(e){let r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}function dq(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(fq.setYear(2e3),fq.setMonth(e),fq.setDate(t),lZe.call(this,fq,n))}function lJt(e){return dq.call(this,e,1,"%B")}function uJt(e){return dq.call(this,e,1,"%b")}function cJt(e){return dq.call(this,0,2+e,"%A")}function fJt(e){return dq.call(this,0,2+e,"%a")}function dxe(e,t,n,r){t[0].type!==ZE&&Es("First argument to data functions must be a string literal.");let i=t[0].value,o=dJt+i;if(!Mg(o,r))try{r[o]=n.getData(i).tuplesRef()}catch{}}function mJt(e,t,n,r){t[0].type!==ZE&&Es("First argument to indata must be a string literal."),t[1].type!==ZE&&Es("Second argument to indata must be a string literal.");let i=t[0].value,o=t[1].value,s=pJt+o;Mg(s,r)||(r[s]=n.getData(i).indataRef(n,o))}function Su(e,t,n,r){if(t[0].type===ZE)iZe(n,r,t[0].value);else for(e in n.scales)iZe(n,r,e)}function iZe(e,t,n){let r=uxe+n;if(!Mg(t,r))try{t[r]=e.scaleRef(n)}catch{}}function $b(e,t){let n;return _D(e)?e:uw(e)?(n=t.scales[e])&&n.value:void 0}function hJt(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Su,n._range=Su,n._scale=Su;let r=i=>"_["+(i.type===ZE?SD(uxe+i.value):SD(uxe)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function pxe(e,t){return function(n,r,i){if(n){let o=$b(n,(i||this).context);return o&&o.path[e](r)}else return t(r)}}function yJt(e){let t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function mxe(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function vJt(){return mxe(this.context.dataflow,"warn",arguments)}function wJt(){return mxe(this.context.dataflow,"info",arguments)}function CJt(){return mxe(this.context.dataflow,"debug",arguments)}function lxe(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function cxe(e){let t=ko(e),n=lxe(t.r),r=lxe(t.g),i=lxe(t.b);return .2126*n+.7152*r+.0722*i}function _Jt(e,t){let n=cxe(e),r=cxe(t),i=Math.max(n,r),o=Math.min(n,r);return(i+.05)/(o+.05)}function SJt(){let e=[].slice.call(arguments);return e.unshift({}),KG(...e)}function cZe(e,t){return e===t||e!==e&&t!==t?!0:Og(e)?Og(t)&&e.length===t.length?EJt(e,t):!1:XL(e)&&XL(t)?fZe(e,t):!1}function EJt(e,t){for(let n=0,r=e.length;n<r;++n)if(!cZe(e[n],t[n]))return!1;return!0}function fZe(e,t){for(let n in e)if(!cZe(e[n],t[n]))return!1;return!0}function oZe(e){return t=>fZe(e,t)}function AJt(e,t,n,r,i,o){let s=this.context.dataflow,a=this.context.data[e],l=a.input,u=s.stamp(),c=a.changes,f,d;if(s._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(a.changes=c=s.changeset(),c.stamp=u,s.runAfter(()=>{a.modified=!0,s.pulse(l,c).run()},!0,1)),n&&(f=n===!0?B0e:Og(n)||mS(n)?n:oZe(n),c.remove(f)),t&&c.insert(t),r&&(f=oZe(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}function TJt(e){let t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function kJt(e){let t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}function IJt(e,t){let n=sZe[t]||(sZe[t]=L0e(t));return Og(e)?e.map(n):n(e)}function hxe(e){return Og(e)||ArrayBuffer.isView(e)?e:null}function gxe(e){return hxe(e)||(uw(e)?e:null)}function DJt(e,...t){return hxe(e).join(...t)}function NJt(e,...t){return gxe(e).indexOf(...t)}function FJt(e,...t){return gxe(e).lastIndexOf(...t)}function RJt(e,...t){return gxe(e).slice(...t)}function OJt(e,t,n){return _D(n)&&Es("Function argument passed to replace."),String(e).replace(t,n)}function MJt(e){return hxe(e).slice().reverse()}function $Jt(e,t,n){return q$(e||0,t||0,n||0)}function PJt(e,t){let n=$b(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function LJt(e,t){let n=$b(e,(t||this).context);return n?n.copy():void 0}function BJt(e,t){let n=$b(e,(t||this).context);return n?n.domain():[]}function zJt(e,t,n){let r=$b(e,(n||this).context);return r?Og(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function UJt(e,t){let n=$b(e,(t||this).context);return n&&n.range?n.range():[]}function jJt(e,t,n){let r=$b(e,(n||this).context);return r?r(t):void 0}function VJt(e,t,n,r,i){e=$b(e,(i||this).context);let o=Nhe(t,n),s=e.domain(),a=s[0],l=Ob(s),u=GG;return l-a?u=nV(e,a,l):e=(e.interpolator?On("sequential")().interpolator(e.interpolator()):On("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,l=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),l!==Ob(s)&&s.push(l)),s.forEach(c=>o.stop(u(c),e(c))),o}function WJt(e,t,n){let r=$b(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function GJt(e){let t=null;return function(n){return n?nD(n,t=t||NE(e)):e}}function pZe(e,t){let n=aZe.call(t,e);return n.root&&n.root.lookup||{}}function qJt(e,t,n){let r=pZe(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(dZe):void 0}function HJt(e,t){let n=pZe(e,this)[t];return n?n.ancestors().map(dZe):void 0}function YJt(){let e=mZe();return e?e.screen:{}}function KJt(){let e=mZe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function XJt(){let e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function ZJt(e,t,n){if(!e)return[];let[r,i]=e,o=new Na().set(r[0],r[1],i[0],i[1]),s=n||this.context.dataflow.scenegraph().root;return age(s,o,QJt(t))}function QJt(e){let t=null;if(e){let n=z0e(e.marktype),r=z0e(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}function ten(e){let t=txe(e);JJt.forEach(n=>t[n]=een+n);for(let n in TD)t[n]=hZe+n;return KG(t,hJt(e,TD,xxe)),t}function co(e,t,n){return arguments.length===1?TD[e]:(TD[e]=t,n&&(xxe[e]=n),fxe&&(fxe.functions[e]=hZe+e),this)}function Mp(e,t){let n={},r;try{e=uw(e)?e:SD(e)+"",r=MXe(e)}catch{Es("Expression parse error: "+e)}r.visit(o=>{if(o.type!==X0e)return;let s=o.callee.name,a=gZe.visitors[s];a&&a(s,o.arguments,t,n)});let i=fxe(r);return i.globals.forEach(o=>{let s=uZe+o;!Mg(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:KG({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}var aB,iJt,lZe,oJt,sJt,aJt,fq,dJt,pJt,uxe,uZe,gJt,xJt,bJt,sZe,dZe,mZe,TD,JJt,een,hZe,xxe,gZe,fxe,pq=w(()=>{"use strict";W0e();PXe();CP();lo();hs();TI();pL();rZe();kk();Fk();kr();aB=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},iJt=aB("format"),lZe=aB("timeFormat"),oJt=aB("utcFormat"),sJt=aB("timeParse"),aJt=aB("utcParse"),fq=new Date(2e3,0,1);dJt=":",pJt="@",uxe="%",uZe="$";gJt=pxe("area",Gfe),xJt=pxe("bounds",Yfe),bJt=pxe("centroid",Jfe);sZe={};dZe=e=>e.data;mZe=()=>typeof window<"u"&&window||null;TD={random(){return bc()},cumulativeNormal:NM,cumulativeLogNormal:mj,cumulativeUniform:bj,densityNormal:uj,densityLogNormal:pj,densityUniform:xj,quantileNormal:FM,quantileLogNormal:hj,quantileUniform:yj,sampleNormal:DM,sampleLogNormal:dj,sampleUniform:gj,isArray:Og,isBoolean:pXe,isDate:U0e,isDefined(e){return e!==void 0},isNumber:j0e,isObject:XL,isRegExp:mXe,isString:uw,isTuple:mS,isValid(e){return e!=null&&e===e},toBoolean:bXe,toDate:yXe,toNumber:qG,toString:vXe,indexof:NJt,join:DJt,lastindexof:FJt,replace:OJt,reverse:MJt,slice:RJt,flush:fXe,lerp:hXe,merge:SJt,pad:gXe,peek:Ob,pluck:IJt,span:xXe,inrange:dXe,truncate:wXe,rgb:ko,lab:mu,hcl:kc,hsl:Tc,luminance:cxe,contrast:_Jt,sequence:Eo,format:iJt,utcFormat:oJt,utcParse:aJt,utcOffset:Xse,utcSequence:Qse,timeFormat:lZe,timeParse:sJt,timeOffset:Kse,timeSequence:Zse,timeUnitSpecifier:Use,monthFormat:lJt,monthAbbrevFormat:uJt,dayFormat:cJt,dayAbbrevFormat:fJt,quarter:aXe,utcquarter:lXe,week:Wse,utcweek:qse,dayofyear:Vse,utcdayofyear:Gse,warn:vJt,info:wJt,debug:CJt,extent:cXe,inScope:yJt,intersect:ZJt,clampRange:uXe,pinchDistance:TJt,pinchAngle:kJt,screen:YJt,containerSize:XJt,windowSize:KJt,bandspace:$Jt,setdata:nJt,pathShape:GJt,panLinear:JKe,panLog:eXe,panPow:tXe,panSymlog:nXe,zoomLinear:rXe,zoomLog:iXe,zoomPow:oXe,zoomSymlog:sXe,encode:rJt,modify:AJt},JJt=["view","item","group","xy","x","y"],een="event.vega.",hZe="this.",xxe={},gZe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${SD(uZe+e)}]`,functions:ten,constants:exe,visitors:xxe},fxe=$Xe(gZe);co("bandwidth",PJt,Su);co("copy",LJt,Su);co("domain",BJt,Su);co("range",UJt,Su);co("invert",zJt,Su);co("scale",jJt,Su);co("gradient",VJt,Su);co("geoArea",gJt,Su);co("geoBounds",xJt,Su);co("geoCentroid",bJt,Su);co("geoShape",WJt,Su);co("indata",tJt,mJt);co("data",aZe,dxe);co("treePath",qJt,dxe);co("treeAncestors",HJt,dxe);co("vlSelectionTest",QXe,cq);co("vlSelectionIdTest",eZe,cq);co("vlSelectionResolve",nZe,cq);co("vlSelectionTuples",tZe)});function $p(e,t,n){return e.fields=t||[],e.fname=n,e}function nen(e){return e==null?null:e.fields}function xZe(e){return e.length===1?ren(e[0]):ien(e)}function dw(e){throw Error(e)}function bZe(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||dw("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&dw("Access path missing closing bracket: "+e),r&&dw("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function mq(e,t,n){let r=bZe(e);return e=r.length===1?r[0]:e,$p((n&&n.get||xZe)(r),[e],t||e)}function gq(e){return e===Object(e)}function kD(e){return e!=null?hq(e)?e:[e]:[]}function oen(e){return typeof e=="function"}function vZe(e,t,n){n=n||{},t=kD(t)||[];let r=[],i=[],o={},s=n.comparator||aen;return kD(e).forEach((a,l)=>{a!=null&&(r.push(t[l]===sen?-1:1),i.push(a=oen(a)?a:mq(a,null,n)),(nen(a)||[]).forEach(u=>o[u]=1))}),i.length===0?null:$p(s(i,r),Object.keys(o))}function CZe(e,t){return cen.call(e,t)}function fen(e){return typeof e=="string"}function _Ze(e,t,n){e&&(e=t?kD(e).map(a=>a.replace(/\\(.)/g,"$1")):kD(e));let r=e&&e.length,i=n&&n.get||xZe,o=a=>i(t?[a]:bZe(a)),s;if(!r)s=function(){return""};else if(r===1){let a=o(e[0]);s=function(l){return""+a(l)}}else{let a=e.map(o);s=function(l){let u=""+a[0](l),c=0;for(;++c<r;)u+="|"+a[c](l);return u}}return $p(s,e,"key")}function xq(e){return hq(e)?"["+e.map(xq)+"]":gq(e)||fen(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function bxe(e){let t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}var ren,ien,bGr,yGr,vGr,wGr,yZe,CGr,hq,sen,wZe,aen,len,uen,cen,SZe=w(()=>{"use strict";ren=e=>function(t){return t[e]},ien=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};bGr=mq("id"),yGr=$p(e=>e,[],"identity"),vGr=$p(()=>0,[],"zero"),wGr=$p(()=>1,[],"one"),yZe=$p(()=>!0,[],"true"),CGr=$p(()=>!1,[],"false"),hq=Array.isArray;sen="descending";wZe=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),aen=(e,t)=>e.length===1?len(e[0],t[0]):uen(e,t,e.length),len=(e,t)=>function(n,r){return wZe(e(n),e(r))*t},uen=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;s===0&&++a<n;)o=e[a],s=wZe(o(r),o(i));return s*t[a]}),cen=Object.prototype.hasOwnProperty});function den(e){let t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}function men(e,t){let n="";return pen[t]||(e.x2&&(e.x?(EZe[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(EZe[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function yxe(e){return(e+"").toLowerCase()}function hen(e){return yxe(e)==="operator"}function gen(e){return yxe(e)==="collect"}function lB(e,t,n){n.endsWith(";")||(n="return("+n+");");let r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function xen(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}function yen(e){let t=this;hen(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function ven(e){let t=this;if(e.params){let n=t.get(e.id);n||dw("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function wen(e,t){t=t||{};let n=this;for(let r in e){let i=e[r];t[r]=hq(i)?i.map(o=>AZe(o,n,t)):AZe(i,n,t)}return t}function AZe(e,t,n){if(!e||!gq(e))return e;for(let r=0,i=TZe.length,o;r<i;++r)if(o=TZe[r],CZe(e,o.key))return o.parse(e,t,n);return e}function Cen(e,t){return t.get(e.$ref)||dw("Operator not defined: "+e.$ref)}function _en(e,t,n){e.$params&&t.parseParameters(e.$params,n);let r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=$p(t.parameterExpression(e.$expr),e.$fields))}function Sen(e,t){let n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=_Ze(e.$key,e.$flat,t.expr.codegen))}function Een(e,t){if(!e.$field)return null;let n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=mq(e.$field,e.$name,t.expr.codegen))}function Aen(e,t){let n="c:"+e.$compare+"_"+e.$order,r=kD(e.$compare).map(i=>i&&i.$tupleid?bt:i);return t.fn[n]||(t.fn[n]=vZe(r,e.$order,t.expr.codegen))}function Ten(e,t){let n=e.$encode,r={};for(let i in n){let o=n[i];r[i]=$p(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}function ken(e,t){return t}function Ien(e,t){let n=e.$subflow;return function(r,i,o){let s=t.fork().parse(n),a=s.get(n.operators[0].id),l=s.signals.parent;return l&&l.set(o),a.detachSubflow=()=>t.detach(s),a}}function Den(){return bt}function Nen(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(o=>t.get(o)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&dw("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function Fen(e){var t=this,n=gq(n=e.source)?n.$ref:n,r=t.get(n),i=null,o=e.update,s=void 0;r||dw("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)}function Oen(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{let s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{let s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function Men(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],Ren)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(yZe).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{let a=t.subcontext[s];a&&a.setState(o)})}function bq(e,t,n,r){return new IZe(e,t,n,r)}function IZe(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||ben,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function kZe(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}var pen,EZe,ben,TZe,Ren,vxe=w(()=>{"use strict";SZe();hs();pen=bxe(["rule"]),EZe=bxe(["group","image","rect"]);ben={operator:(e,t)=>lB(e,["_"],t.code),parameter:(e,t)=>lB(e,["datum","_"],t.code),event:(e,t)=>lB(e,["event"],t.code),handler:(e,t)=>{let n=`var datum=event.item&&event.item.datum;return ${t.code};`;return lB(e,["_","event"],n)},encode:(e,t)=>{let{marktype:n,channels:r}=t,i="var o=item,datum=o.datum,m=0,$;";for(let o in r){let s="o["+xq(o)+"]";i+=`$=${r[o].code};if(${s}!==$)${s}=$,m=1;`}return i+=men(r,n),i+="return m;",lB(e,["item","_"],i)},codegen:{get(e){let t=`[${e.map(xq).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n,r=(o,s)=>{let a=t[s],l,u;return o.path?(l=`a${o.path}`,u=`b${o.path}`):((n=n||{})["f"+s]=o,l=`this.f${s}(a)`,u=`this.f${s}(b)`),xen(l,u,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};TZe=[{key:"$ref",parse:Cen},{key:"$key",parse:Sen},{key:"$expr",parse:_en},{key:"$field",parse:Een},{key:"$encode",parse:Ten},{key:"$compare",parse:Aen},{key:"$context",parse:ken},{key:"$subflow",parse:Ien},{key:"$tupleid",parse:Den}];Ren={skip:!0};IZe.prototype=kZe.prototype={fork(){let e=new kZe(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);let t=Object.keys(e.nodes);for(let n of t)e.nodes[n]._targets=null;for(let n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){let n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),gen(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(let o in e.data){let s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[yxe(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:den,parseOperator:yen,parseOperatorParameters:ven,parseParameters:wen,parseStream:Nen,parseUpdate:Fen,getState:Oen,setState:Men}});function $en(e){let t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),LZe(t,e.description()))}function LZe(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Pen(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}function Len(e){let t=e._signals.cursor||(e._signals.cursor=e.add({user:wxe,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{let i=t.value,o=i?zn(i)?i:i.user:wxe,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return zn(r)||(i=r.item,r=r.user),_xe(e,r&&r!==wxe?r:i||r),i},{cursor:t})}function _xe(e,t){let n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function wq(e,t){var n=e._runtime.data;return Dt(n,t)||Se("Unrecognized data set: "+t),n[t]}function Ben(e,t){return arguments.length<2?wq(this,e).values.value:_q.call(this,e,Xx().remove(Bh).insert(t))}function _q(e,t){Uoe(t)||Se("Second argument to changes must be a changeset.");let n=wq(this,e);return n.modified=!0,this.pulse(n.input,t)}function zen(e,t){return _q.call(this,e,Xx().insert(t))}function Uen(e,t){return _q.call(this,e,Xx().remove(t))}function BZe(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function zZe(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Sq(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function jen(e){var t=Sq(e),n=BZe(e),r=zZe(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}function Ven(e,t,n){var r=e._renderer,i=r&&r.canvas(),o,s,a;return i&&(a=Sq(e),s=t.changedTouches?t.changedTouches[0]:t,o=fL(s,i),o[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=Wen(e,n,o),t}function Wen(e,t,n){let r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(s){var a=r,l;if(s){for(l=t;l;l=l.mark.group)if(l.mark.name===s){a=l;break}}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;zn(s)&&(s=i(s));let a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:ps(e),item:ps(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}function Yen(e){let t=Jt({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{Vt(r[o])&&(r[o]=wa(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function UZe(e,t,n,r){e._eventListeners.push({type:n,sources:Rt(t),handler:r})}function Ken(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function yq(e,t,n){let r=e._eventConfig&&e._eventConfig[t];return r===!1||tn(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Xen(e,t,n){var r=this,i=new Ck(n),o=function(u,c){r.runAsync(null,()=>{e===DZe&&Ken(r,t)&&u.preventDefault(),i.receive(Ven(r,u,c))})},s;if(e===Gen)yq(r,"timer",t)&&r.timer(o,t);else if(e===DZe)yq(r,"view",t)&&r.addEventListener(t,o,Hen);else if(e===qen?yq(r,"window",t)&&typeof window<"u"&&(s=[window]):typeof document<"u"&&yq(r,"selector",t)&&(s=document.querySelectorAll(e)),!s)r.warn("Can not resolve event source: "+e);else{for(var a=0,l=s.length;a<l;++a)s[a].addEventListener(t,o);UZe(r,s,t,o)}return i}function NZe(e){return e.item}function FZe(e){return e.item.mark.source}function RZe(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Zen(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",NZe),FZe,RZe(e)),this.on(this.events("view","mouseout",NZe),FZe,RZe(t)),this}function Qen(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,o;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(o=n[r],i=o.sources.length;--i>=0;)o.sources[i].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function Lc(e,t,n){let r=document.createElement(e);for(let i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}function ntn(e,t,n){if(!t)return;let r=n.param,i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=Pie(r.debounce,i.update))),(r.input==null&&r.element?rtn:otn)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function rtn(e,t,n,r){let i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),UZe(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(itn(i))}}function itn(e){return typeof Event<"u"?new Event(e):{type:e}}function otn(e,t,n,r){let i=r.signal(n.signal),o=Lc("div",{class:Jen}),s=n.input==="radio"?o:o.appendChild(Lc("label"));s.appendChild(Lc("span",{class:etn},n.name||n.signal)),t.appendChild(o);let a=stn;switch(n.input){case"checkbox":a=atn;break;case"select":a=ltn;break;case"radio":a=utn;break;case"range":a=ctn;break}a(e,s,n,i)}function stn(e,t,n,r){let i=Lc("input");for(let o in n)o!=="signal"&&o!=="element"&&i.setAttribute(o==="input"?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function atn(e,t,n,r){let i={type:"checkbox",name:n.signal};r&&(i.checked=!0);let o=Lc("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function ltn(e,t,n,r){let i=Lc("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{let l={value:s};Cq(s,r)&&(l.selected=!0),i.appendChild(Lc("option",l,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,l=n.options.length;a<l;++a)if(Cq(n.options[a],s)){i.selectedIndex=a;return}}}function utn(e,t,n,r){let i=Lc("span",{class:ttn}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{let l={type:"radio",name:n.signal,value:s};Cq(s,r)&&(l.checked=!0);let u=Lc("input",l);u.addEventListener("change",()=>e.update(s));let c=Lc("label",{},(o[a]||s)+"");return c.prepend(u),i.appendChild(c),u}),e.set=s=>{let a=e.elements,l=a.length;for(let u=0;u<l;++u)Cq(a[u].value,s)&&(a[u].checked=!0)}}function ctn(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;let i=n.max!=null?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||bl(o,i,100),a=Lc("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;let l=Lc("span",{},+r);t.appendChild(a),t.appendChild(l);let u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function Cq(e,t){return e===t||e+""==t+""}function jZe(e,t,n,r,i,o){return t=t||new r(e.loader()),t.initialize(n,BZe(e),zZe(e),Sq(e),i,o).background(e.background())}function Sxe(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function ftn(e,t,n,r){let i=new r(e.loader(),Sxe(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Sq(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}function dtn(e,t){let n=this,r=n._renderType,i=n._eventConfig.bind,o=dL(r);e=n._el=e?Cxe(n,e,!0):null,$en(n),o||n.error("Unrecognized renderer type: "+r);let s=o.handler||aD,a=e?o.renderer:o.headless;return n._renderer=a?jZe(n,n._renderer,e,a):null,n._handler=ftn(n,n._handler,e,s),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=Cxe(n,t,!0):e.appendChild(Lc("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&i!=="container"&&(l.element=Cxe(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{ntn(n,l.element||t,l)})),n}function Cxe(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}function OZe(e){return tn(e)?{top:uB(e.top),bottom:uB(e.bottom),left:uB(e.left),right:uB(e.right)}:ptn(uB(e))}function Exe(e,t,n,r){return te(this,null,function*(){let i=dL(t),o=i&&i.headless;return o||Se("Unrecognized renderer type: "+t),yield e.runAsync(),jZe(e,null,null,o,n,r).renderAsync(e._scenegraph.root)})}function mtn(e,t){return te(this,null,function*(){e!==Eb.Canvas&&e!==Eb.SVG&&e!==Eb.PNG&&Se("Unrecognized image type: "+e);let n=yield Exe(this,e,t);return e===Eb.SVG?htn(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")})}function htn(e,t){let n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function gtn(e,t){return te(this,null,function*(){return(yield Exe(this,Eb.Canvas,e,t)).canvas()})}function xtn(e){return te(this,null,function*(){return(yield Exe(this,Eb.SVG,e)).svg()})}function btn(e,t,n){return bq(e,Kx,TD,n).parse(t)}function ytn(e){var t=this._runtime.scales;return Dt(t,e)||Se("Unrecognized scale or projection: "+e),t[e].value}function GZe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Axe?r.left+r.right:0)}function qZe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Axe?r.top+r.bottom:0)}function vtn(e){var t=e._signals,n=t[VZe],r=t[WZe],i=t[Axe];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=GZe(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=qZe(e,a.size),o()},{size:r});let s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}function wtn(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(VZe,n,MZe),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(WZe,r,MZe),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(l=>l.resize())},!1,1)}function Ctn(e){return this._runtime.getState(e||{data:_tn,signals:Stn,recurse:!0})}function _tn(e,t){return t.modified&&Vt(t.input.value)&&e.indexOf("_:vega:_")}function Stn(e,t){return!(e==="parent"||t instanceof Kx.proxy)}function Etn(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Atn(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Epe(n,t))}function Ttn(e,t,n,r){let i=e.element();i&&i.setAttribute("title",ktn(r))}function ktn(e){return e==null?"":Vt(e)?HZe(e):tn(e)&&!JO(e)?Itn(e):e+""}function Itn(e){return Object.keys(e).map(t=>{let n=e[t];return t+": "+(Vt(n)?HZe(n):YZe(n))}).join(`
`)}function HZe(e){return"["+e.map(YZe).join(", ")+"]"}function YZe(e){return Vt(e)?"[\u2026]":tn(e)&&!JO(e)?"{\u2026}":e}function Txe(e,t){let n=this;if(t=t||{},Lv.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){let o=Jt({},e.locale,t.locale);n.locale(TW(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Eb.Canvas,n._scenegraph=new nG;let r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Ttn,n._redraw=!0,n._handler=new aD().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Yen(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);let i=btn(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:Jt({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=GZe(n,n._width),n._viewHeight=qZe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,vtn(n),Pen(n),Len(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function vq(e,t){return Dt(e._signals,t)?e._signals[t]:Se("Unrecognized signal name: "+Ot(t))}function KZe(e,t){let n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function $Ze(e,t,n,r){let i=KZe(n,r);return i||(i=Sxe(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function PZe(e,t,n){let r=KZe(t,n);return r&&t._targets.remove(r),e}var wxe,DZe,Gen,qen,Hen,Jen,etn,ttn,uB,ptn,VZe,WZe,Axe,MZe,XZe=w(()=>{"use strict";ao();hs();pL();kr();pq();vxe();Ape();kW();wxe="default";DZe="view",Gen="timer",qen="window",Hen={trap:!1};Jen="vega-bind",etn="vega-bind-name",ttn="vega-bind-radio";uB=e=>+e||0,ptn=e=>({top:e,bottom:e,left:e,right:e});VZe="width",WZe="height",Axe="padding",MZe={skip:!0};$e(Txe,Lv,{evaluate(e,t,n){return te(this,null,function*(){if(yield Lv.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,jen(this)),yield this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&_M(this,n),this})},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){let t=e!=null?e+"":null;return t!==this._desc&&LZe(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){let r=vq(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",OZe(e)):OZe(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(dL(e)||Se("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Lv.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(vq(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:wtn,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=Sxe(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,o;--r>=0;)if(o=n[r].type,i=n[r].handler,e===o&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){let t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return $Ze(this,e,vq(this,e),t)},removeSignalListener(e,t){return PZe(this,vq(this,e),t)},addDataListener(e,t){return $Ze(this,e,wq(this,e).values,t)},removeDataListener(e,t){return PZe(this,wq(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){let t=_xe(this,null);this._globalCursor=!!e,t&&_xe(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Atn,events:Xen,finalize:Qen,hover:Zen,data:Ben,change:_q,insert:zen,remove:Uen,scale:ytn,initialize:dtn,toImageURL:mtn,toCanvas:gtn,toSVG:xtn,getState:Ctn,setState:Etn})});function nQe(e,t,n){return eQe=t||Dtn,tQe=n||Mtn,rQe(e.trim()).map(kxe)}function $tn(e){return tQe[e]}function cB(e,t,n,r,i){let o=e.length,s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function rQe(e){let t=[],n=e.length,r=0,i=0;for(;i<n;)i=cB(e,i,JZe,Eq+ZZe,Aq+QZe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function kxe(e){return e[0]==="["?Ptn(e):Ltn(e)}function Ptn(e){let t=e.length,n=1,r;if(n=cB(e,n,Aq,Eq,Aq),n===t)throw"Empty between selector: "+e;if(r=rQe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Rtn)throw"Expected '>' after between selector: "+e;r=r.map(kxe);let i=kxe(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Ltn(e){let t={source:eQe},n=[],r=[0,0],i=0,o=0,s=e.length,a=0,l,u;if(e[s-1]===QZe){if(a=e.lastIndexOf(ZZe),a>=0){try{r=Btn(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===Ftn&&(i=++a),l=cB(e,a,Ntn),l<s&&(n.push(e.substring(o,l).trim()),o=a=++l),a=cB(e,a,Eq),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),u=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=cB(e,a,Aq),a===s)throw"Unmatched left bracket: "+e;if(u.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==Eq)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||Otn.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):$tn(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Btn(e){let t=e.split(JZe);if(!e.length||t.length>2)throw e;return t.map(n=>{let r=+n;if(r!==r)throw e;return r})}var Dtn,Eq,Aq,ZZe,QZe,Ntn,JZe,Ftn,Rtn,Otn,Mtn,eQe,tQe,iQe=w(()=>{"use strict";Dtn="view",Eq="[",Aq="]",ZZe="{",QZe="}",Ntn=":",JZe=",",Ftn="@",Rtn=">",Otn=/[[\]{}]/,Mtn={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1}});function ztn(e){return tn(e)?e:{type:e||"pad"}}function jtn(e){return tn(e)?e.signal?e:{top:fB(e.top),bottom:fB(e.bottom),left:fB(e.left),right:fB(e.right)}:Utn(fB(e))}function oQe(e,t,n,r){return n!=null?(tn(n)&&!Vt(n)||Vt(n)&&n.length&&tn(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function ta(e,t,n){for(let r in t)oQe(e,r,t[r]);for(let r in n)oQe(e,r,n[r],"update")}function OD(e,t,n){for(let r in t)n&&Dt(n,r)||(e[r]=Jt(e[r]||{},t[r]));return e}function DD(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function inn(e,t,n,r,i){let o={},s={},a,l,u,c;l="lineBreak",t==="text"&&i[l]!=null&&!DD(l,e)&&Ixe(o,l,i[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===zxe?i.group:n===Bxe?Jt({},i.mark,i[t]):null;for(l in c)u=DD(l,e)||(l==="fill"||l==="stroke")&&(DD("fill",e)||DD("stroke",e)),u||Ixe(o,l,c[l]);Rt(r).forEach(f=>{let d=i.style&&i.style[f];for(let p in d)DD(p,e)||Ixe(o,p,d[p])}),e=Jt({},e);for(l in o)c=o[l],c.signal?(a=a||{})[l]=c:s[l]=c;return e.enter=Jt(s,e.enter),a&&(e.update=Jt(a,e.update)),e}function Ixe(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}function Oq(e){if(e.gradient!=null)return snn(e);let t=e.signal?`(${e.signal})`:e.color?onn(e.color):e.field!=null?AQe(e.field):e.value!==void 0?Ot(e.value):void 0;return e.scale!=null&&(t=ann(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${kq(e.exponent)})`),e.mult!=null&&(t+=`*${kq(e.mult)}`),e.offset!=null&&(t+=`+${kq(e.offset)}`),e.round&&(t=`round(${t})`),t}function onn(e){return e.c?Tq("hcl",e.h,e.c,e.l):e.h||e.s?Tq("hsl",e.h,e.s,e.l):e.l||e.a?Tq("lab",e.l,e.a,e.b):e.r||e.g||e.b?Tq("rgb",e.r,e.g,e.b):null}function snn(e){let t=[e.start,e.stop,e.count].map(n=>n==null?null:Ot(n));for(;t.length&&Fn(t)==null;)t.pop();return t.unshift(EQe(e.gradient)),`gradient(${t.join(",")})`}function kq(e){return tn(e)?"("+Oq(e)+")":e}function AQe(e){return TQe(tn(e)?e:{datum:e})}function TQe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Se("Invalid field reference: "+Ot(e));return e.signal||(r=zn(r)?XO(r).map(Ot).join("]["):TQe(r)),t+"["+r+"]"}function ann(e,t){let n=EQe(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+kq(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function lnn(e){let t="";return e.forEach(n=>{let r=Oq(n);t+=n.test?`(${n.test})?${r}:`:r}),Fn(t)===":"&&(t+="null"),t}function kQe(e,t,n,r,i,o){let s={};o=o||{},o.encoders={$encode:s},e=inn(e,t,n,r,i.config);for(let a in e)s[a]=unn(e[a],t,o,i);return o}function unn(e,t,n,r){let i={},o={};for(let s in e)e[s]!=null&&(i[s]=fnn(cnn(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function cnn(e){return Vt(e)?lnn(e):Oq(e)}function fnn(e,t,n,r){let i=Mp(e,t);return i.$fields.forEach(o=>r[o]=1),Jt(n,i.$params),i.$expr}function sQe(e,t){Se(e+' for "outer" push: '+Ot(t))}function IQe(e,t){let n=e.name;if(e.push===dnn)t.signals[n]||sQe("No prior signal definition",n),pnn.forEach(r=>{e[r]!==void 0&&sQe("Invalid property ",r)});else{let r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Fxe(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function Mq(e,t,n,r){return new Fxe(e,t,n,r)}function Rq(e,t){return Mq("operator",e,t)}function At(e){let t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function mB(e,t){return t?{$field:e,$name:t}:{$field:e}}function aQe(e,t){return{$compare:e,$order:t}}function mnn(e,t){let n={$key:e};return t&&(n.$flat=!0),n}function xnn(e){return tn(e)?(e.order===gnn?"-":"+")+$q(e.op,e.field):""}function $q(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}function ts(e){return e&&e.signal}function bnn(e){return e&&e.expr}function Iq(e){if(ts(e))return!0;if(tn(e)){for(let t in e)if(Iq(e[t]))return!0}return!1}function Pp(e,t){return e??t}function e2(e){return e&&e.signal||e}function hB(e,t){return(e.merge?vnn:e.stream?wnn:e.type?Cnn:Se("Invalid stream specification: "+Ot(e)))(e,t)}function ynn(e){return e===jxe?Oxe:e||Oxe}function vnn(e,t){let n=e.merge.map(i=>hB(i,t)),r=Vxe({merge:n},e,t);return t.addStream(r).id}function wnn(e,t){let n=hB(e.stream,t),r=Vxe({stream:n},e,t);return t.addStream(r).id}function Cnn(e,t){let n;e.type===lQe?(n=t.event(lQe,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(ynn(e.source),e.type);let r=Vxe({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function Vxe(e,t,n){let r=t.between;return r&&(r.length!==2&&Se('Stream "between" parameter must have 2 entries: '+Ot(t)),e.between=[hB(r[0],n),hB(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(_nn(t.marktype,t.markname,t.markrole)),t.source===jxe&&r.push("inScope(event.item)"),r.length&&(e.filter=Mp("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function _nn(e,t,n){let r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}function Enn(e,t,n){let r=e.encode,i={target:n},o=e.events,s=e.update,a=[];o||Se("Signal update missing events specification."),zn(o)&&(o=nQe(o,t.isSubscope()?jxe:Oxe)),o=Rt(o).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[Tnn(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),r!=null&&(s&&Se("Signal encode and update are mutually exclusive."),s="encode(item(),"+Ot(r)+")"),i.update=zn(s)?Mp(s,t):s.expr!=null?Mp(s.expr,t):s.value!=null?s.value:s.signal!=null?{$expr:Snn,$params:{$value:t.signalRef(s.signal)}}:Se("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(l=>t.addUpdate(Jt(Ann(l,t),i)))}function Ann(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):hB(e,t)}}function Tnn(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function knn(e,t){let n=t.getSignal(e.name),r=e.update;e.init&&(r?Se("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Mp(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Enn(i,t,n.id))}function Knn(e,t){let n=e.type||"linear";Tfe(n)||Se("Unrecognized scale type: "+Ot(n)),t.addScale(e.name,{type:n,domain:void 0})}function Xnn(e,t){let n=t.getScale(e.name).params,r;n.domain=PQe(e.domain,e,t),e.range!=null&&(n.range=BQe(e,t,n)),e.interpolate!=null&&srn(e.interpolate,n),e.nice!=null&&(n.nice=orn(e.nice)),e.bins!=null&&(n.bins=irn(e.bins,t));for(r in e)Dt(n,r)||r==="name"||(n[r]=Hf(e[r],t))}function Hf(e,t){return tn(e)?e.signal?t.signalRef(e.signal):Se("Unsupported object: "+Ot(e)):e}function Dq(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Hf(n,t))}function Pq(e){Se("Can not find data set: "+Ot(e))}function PQe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Se("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Vt(e)?Znn:e.fields?Jnn:Qnn)(e,t,n)}function Znn(e,t,n){return e.map(r=>Hf(r,n))}function Qnn(e,t,n){let r=n.getData(e.data);return r||Pq(e.data),k1(t.type)?r.valuesRef(n,e.field,LQe(e.sort,!1)):Dfe(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Jnn(e,t,n){let r=e.data,i=e.fields.reduce((o,s)=>(s=zn(s)?{data:r,field:s}:Vt(s)||s.signal?ern(s,n):s,o.push(s),o),[]);return(k1(t.type)?trn:Dfe(t.type)?nrn:rrn)(e,n,i)}function ern(e,t){let n="_:vega:_"+Ynn++,r=Bp({});if(Vt(e))r.value={$ingest:e};else if(e.signal){let i="setdata("+Ot(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,n2({})]),{data:n,field:"data"}}function trn(e,t,n){let r=LQe(e.sort,!0),i,o,s=n.map(u=>{let c=t.getData(u.data);return c||Pq(u.data),c.countsRef(t,u.field,r)}),a={groupby:Rxe,pulse:s};r&&(i=r.op||"count",o=r.field?$q(i,r.field):"count",a.ops=[$Qe[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(DQe(a));let l=t.add(Bp({pulse:At(i)}));return o=t.add(Hnn({field:Rxe,sort:t.sortRef(r),pulse:At(l)})),At(o)}function LQe(e,t){return e&&(!e.field&&!e.op?tn(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Se("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!$Qe[e.op]&&Se("Multiple domain scales can not be sorted using "+e.op)),e}function nrn(e,t,n){let r=n.map(i=>{let o=t.getData(i.data);return o||Pq(i.data),o.domainRef(t,i.field)});return At(t.add(Bnn({values:r})))}function rrn(e,t,n){let r=n.map(i=>{let o=t.getData(i.data);return o||Pq(i.data),o.extentRef(t,i.field)});return At(t.add(Lnn({extents:r})))}function irn(e,t){return e.signal||Vt(e)?Dq(e,t):t.objectProperty(e)}function orn(e){return tn(e)?{interval:Hf(e.interval),step:Hf(e.step)}:Hf(e)}function srn(e,t){t.interpolate=Hf(e.type||e),e.gamma!=null&&(t.interpolateGamma=Hf(e.gamma))}function BQe(e,t,n){let r=t.config.range,i=e.range;if(i.signal)return t.signalRef(i.signal);if(zn(i)){if(r&&Dt(r,i))return e=Jt({},e,{range:r[i]}),BQe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=k1(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Se("Unrecognized scale range value: "+Ot(i))}else if(i.scheme){n.scheme=Vt(i.scheme)?Dq(i.scheme,t):Hf(i.scheme,t),i.extent&&(n.schemeExtent=Dq(i.extent,t)),i.count&&(n.schemeCount=Hf(i.count,t));return}else if(i.step){n.rangeStep=Hf(i.step,t);return}else{if(k1(e.type)&&!Vt(i))return PQe(i,e,t);Vt(i)||Se("Unsupported range type: "+Ot(i))}return i.map(o=>(Vt(o)?Dq:Hf)(o,t))}function arn(e,t){let n=t.config.projection||{},r={};for(let i in e)i!=="name"&&(r[i]=Mxe(e[i],i,t));for(let i in n)r[i]==null&&(r[i]=Mxe(n[i],i,t));t.addProjection(e.name,r)}function Mxe(e,t,n){return Vt(e)?e.map(r=>Mxe(r,t,n)):tn(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Se("Unsupported parameter object: "+Ot(e)):e}function gB(e){return e.type=Lq,e.interactive=e.interactive||!1,e}function Eu(e,t){let n=(r,i)=>Pp(e[r],Pp(t[r],i));return n.isVertical=r=>lrn===Pp(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Pp(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Pp(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Pp(e.columns,Pp(t.columns,+n.isVertical(!0))),n}function jQe(e,t){let n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function _rn(e,t,n){let r=t.config.style[n];return r&&r[e]}function Bq(e,t,n){return`item.anchor === '${urn}' ? ${e} : item.anchor === '${frn}' ? ${t} : ${n}`}function Srn(e){let t=e("tickBand"),n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},tn(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function VQe(e,t){return t?e?tn(e)?Object.assign({},e,{offset:VQe(e.offset,t)}):{value:e,offset:t}:t:e}function Bc(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=OD(e.encode,t,bB)):e.interactive=!1,e}function Ern(e,t,n,r){let i=Eu(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength(),l,u,c,f,d;o?(u=[0,1],c=[0,0],f=s,d=a):(u=[0,0],c=[1,0],f=a,d=s);let p={enter:l={opacity:$n,x:$n,y:$n,width:Ts(f),height:Ts(d)},update:Jt({},l,{opacity:Kf,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:$n}};return ta(p,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Bc({type:UQe,role:Qtn,encode:p},r)}function Arn(e,t,n,r,i){let o=Eu(e,n),s=o.isVertical(),a=o.gradientThickness(),l=o.gradientLength(),u,c,f,d,p="";s?(u="y",f="y2",c="x",d="width",p="1-"):(u="x",f="x2",c="y",d="height");let m={opacity:$n,fill:{scale:t,field:Yf}};m[u]={signal:p+"datum."+RD,mult:l},m[c]=$n,m[f]={signal:p+"datum."+prn,mult:l},m[d]=Ts(a);let h={enter:m,update:Jt({},m,{opacity:Kf}),exit:{opacity:$n}};return ta(h,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Bc({type:UQe,role:Xtn,key:Yf,from:i,encode:h},r)}function fQe(e,t,n,r){let i=Eu(e,t),o=i.isVertical(),s=Ts(i.gradientThickness()),a=i.gradientLength(),l=i("labelOverlap"),u,c,f,d,p="",m={enter:u={opacity:$n},update:c={opacity:Kf,text:{field:Wxe}},exit:{opacity:$n}};return ta(m,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Pp(e.labelLimit,t.gradientLabelLimit)}),o?(u.align={value:"left"},u.baseline=c.baseline={signal:krn},f="y",d="x",p="1-"):(u.align=c.align={signal:Trn},u.baseline={value:"top"},f="x",d="y"),u[f]=c[f]={signal:p+"datum."+RD,mult:a},u[d]=c[d]=s,s.offset=Pp(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:i("labelSeparation"),method:l,order:"datum."+$xe}:void 0,Bc({type:r2,role:SQe,style:xB,key:Yf,from:r,encode:m,overlap:l},n)}function Irn(e,t,n,r,i){let o=Eu(e,t),s=n.entries,a=!!(s&&s.interactive),l=s?s.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${drn} : datum.${Lxe}`,p=u?Ts(u):{field:Lxe},m=`datum.${$xe}`,h=`max(1, ${i})`,g,x,b,y,v;p.mult=.5,g={enter:x={opacity:$n,x:{signal:d,mult:.5,offset:c},y:p},update:b={opacity:Kf,x:x.x,y:x.y},exit:{opacity:$n}};let C=null,_=null;e.fill||(C=t.symbolBaseFillColor,_=t.symbolBaseStrokeColor),ta(g,{fill:o("symbolFillColor",C),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",_),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),qxe.forEach(I=>{e[I]&&(b[I]=x[I]={scale:e[I],field:Yf})});let S=Bc({type:Crn,role:Jtn,key:Yf,from:f,clip:u?!0:void 0,encode:g},n.symbols),E=Ts(c);E.offset=o("labelOffset"),g={enter:x={opacity:$n,x:{signal:d,offset:E},y:p},update:b={opacity:Kf,text:{field:Wxe},x:x.x,y:x.y},exit:{opacity:$n}},ta(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});let T=Bc({type:r2,role:SQe,style:xB,key:Yf,from:f,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:$n,height:u?Ts(u):$n,opacity:$n},exit:{opacity:$n},update:b={opacity:Kf,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(y=`ceil(item.mark.items.length / ${h})`,b.row.signal=`${m}%${y}`,b.column.signal=`floor(${m} / ${y})`,v={field:["row",m]}):(b.row.signal=`floor(${m} / ${h})`,b.column.signal=`${m} % ${h}`,v={field:m}),b.column.signal=`(${i})?${b.column.signal}:${m}`,r={facet:{data:r,name:"value",groupby:$xe}},gB({role:Uxe,from:r,encode:OD(g,s,bB),marks:[S,T],name:l,interactive:a,sort:v})}function Drn(e,t){let n=Eu(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}function Lrn(e,t,n,r){let i=Eu(e,t),o={enter:{opacity:$n},update:{opacity:Kf,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:$n}};return ta(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Mrn},angle:{signal:$rn},align:{signal:Orn},baseline:{signal:Prn},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Bc({type:r2,role:enn,style:Gxe,from:r,encode:o},n)}function Brn(e,t){let n;return tn(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+dQe(e.path)+")":e.sphere&&(n="geoShape("+dQe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function dQe(e){return tn(e)&&e.signal?e.signal:Ot(e)}function WQe(e){let t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===Lq?Uxe:t||Bxe}function zrn(e){return{marktype:e.type,name:e.name||void 0,role:e.role||WQe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Urn(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function Zxe(e,t){let n=ej(e.type);n||Se("Unrecognized transform type: "+Ot(e.type));let r=Mq(n.type.toLowerCase(),null,GQe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function GQe(e,t,n){let r={},i=e.params.length;for(let o=0;o<i;++o){let s=e.params[o];r[s.name]=jrn(s,t,n)}return r}function jrn(e,t,n){let r=e.type,i=t[e.name];if(r==="index")return Vrn(e,t,n);if(i===void 0){e.required&&Se("Missing required "+Ot(t.type)+" parameter: "+Ot(e.name));return}else{if(r==="param")return Wrn(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!ts(i)?i.map(o=>pQe(e,o,n)):pQe(e,i,n)}function pQe(e,t,n){let r=e.type;if(ts(t))return hQe(r)?Se("Expression references can not be signals."):Dxe(r)?n.fieldRef(t):gQe(r)?n.compareRef(t):n.signalRef(t.signal);{let i=e.expr||Dxe(r);return i&&Grn(t)?n.exprRef(t.expr,t.as):i&&qrn(t)?mB(t.field,t.as):hQe(r)?Mp(t,n):Hrn(r)?At(n.getData(t).values):Dxe(r)?mB(t):gQe(r)?n.compareRef(t):t}}function Vrn(e,t,n){return zn(t.from)||Se('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Wrn(e,t,n){let r=t[e.name];return e.array?(Vt(r)||Se("Expected an array of sub-parameters. Instead: "+Ot(r)),r.map(i=>mQe(e,i,n))):mQe(e,r,n)}function mQe(e,t,n){let r=e.params.length,i;for(let s=0;s<r;++s){i=e.params[s];for(let a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||Se("Unsupported parameter: "+Ot(t));let o=Jt(GQe(i,t,n),i.key);return At(n.add(Unn(o)))}function Yrn(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||Se("Only group marks can be faceted."),r.field!=null?s=a=Fq(r,n):(e.data?a=At(n.getData(e.data).aggregate):(o=Zxe(Jt({type:"aggregate",groupby:Rt(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=Fq(r,n),s=a=At(n.add(o))),i=n.keyRef(r.groupby,!0))):s=At(n.add(Bp(null,[{}]))),s||(s=Fq(e,n)),{key:i,pulse:s,parent:a}}function Fq(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:At(t.getData(e.data).output)}function t2(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}function qQe(e){return zn(e)?e:null}function xQe(e,t,n){let r=$q(n.op,n.field),i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function dB(e,t,n,r,i,o,s){let a=t[n]||(t[n]={}),l=xnn(o),u=qQe(i),c,f;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=a[u]),!c){let d=o?{field:Rxe,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:At(t.output)};l&&(d.sort=e.sortRef(o)),f=e.add(Mq(r,void 0,d)),s&&(t.index[i]=f),c=At(f),u!=null&&(a[u]=c)}return c}function Krn(e,t,n){let r=e.from.facet,i=r.name,o=Fq(r,t),s;r.name||Se("Facet must have a name: "+Ot(r)),r.data||Se("Facet must reference a data set: "+Ot(r)),r.field?s=t.add(RQe({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(Fnn({key:t.keyRef(r.groupby),group:At(t.proxy(n.parent)),pulse:o})):Se("Facet must specify groupby or field: "+Ot(r));let a=t.fork(),l=a.add(Bp()),u=a.add(n2({pulse:At(l)}));a.addData(i,new t2(a,l,l,u)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}function Xrn(e,t,n){let r=t.add(RQe({pulse:n.pulse})),i=t.fork();i.add(n2()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function HQe(e,t,n){let r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,l=t.add(Rq()),u="if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>f??"null").join(",")+"),0)",c=Mp(u,t);l.update=c.$expr,l.params=c.$params}function Uq(e,t){let n=WQe(e),r=e.type===Lq,i=e.from&&e.from.facet,o=e.overlap,s=e.layout||n===Uxe||n===zxe,a,l,u,c,f,d,p,m=n===Bxe||s||i,h=Yrn(e.from,r,t);l=t.add(Dnn({key:h.key||(e.key?mB(e.key):void 0),pulse:h.pulse,clean:!r}));let g=At(l);l=u=t.add(Bp({pulse:g})),l=t.add(Pnn({markdef:zrn(e),interactive:Urn(e.interactive,t),clip:Brn(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:At(l)}));let x=At(l);l=c=t.add(FQe(kQe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:x}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(_=>{let S=Zxe(_,t),E=S.metadata;(E.generates||E.changes)&&Se("Mark transforms should not generate new data."),E.nomod||(c.params.mod=!0),S.params.pulse=At(l),t.add(l=S)}),e.sort&&(l=t.add(qnn({sort:t.compareRef(e.sort),pulse:At(l)})));let b=At(l);(i||s)&&(s=t.add(MQe({layout:t.objectProperty(e.layout),legends:t.legends,mark:x,pulse:b})),d=At(s));let y=t.add(NQe({mark:x,pulse:d||b}));p=At(y),r&&(m&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(b,d||p,g),i?Krn(e,t,h):m?Xrn(e,t,h):t.parse(e),t.popState(),m&&(s&&a.push(s),a.push(y))),o&&(p=Zrn(o,p,t));let v=t.add(OQe({pulse:p})),C=t.add(n2({pulse:At(v)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new t2(t,u,v,C)),e.on&&e.on.forEach(_=>{(_.insert||_.remove||_.toggle)&&Se("Marks only support modify triggers."),HQe(_,t,f)}))}function Zrn(e,t,n){let r=e.method,i=e.bound,o=e.separation,s={separation:ts(o)?n.signalRef(o.signal):o,method:ts(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){let a=i.tolerance;s.boundTolerance=ts(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return At(n.add(znn(s)))}function Qrn(e,t){let n=t.config.legend,r=e.encode||{},i=Eu(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,l=o.style,u={},c=0,f,d,p;qxe.forEach(y=>e[y]?(u[y]=e[y],c=c||e[y]):0),c||Se("Missing valid scale for legend.");let m=Jrn(e,t.scaleType(c)),h={title:e.title!=null,scales:u,type:m,vgrad:m!=="symbol"&&i.isVertical()},g=At(t.add(Bp(null,[h]))),x={enter:{x:{value:0},y:{value:0}}},b=At(t.add(Mnn(d={type:m,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return m===Nq?(p=[Ern(e,c,n,r.gradient),fQe(e,n,r.labels,b)],d.count=d.count||t.signalRef(`max(2,2*floor((${e2(i.gradientLength())})/100))`)):m===Pxe?p=[Arn(e,c,n,r.gradient,b),fQe(e,n,r.labels,b)]:(f=Drn(e,n),p=[Irn(e,n,r,b,e2(f.columns))],d.size=nin(e,t,p[0].marks)),p=[gB({role:Ztn,from:g,encode:x,marks:p,layout:f,interactive:a})],h.title&&p.push(Lrn(e,n,r.title,g)),Uq(gB({role:Ktn,from:g,encode:OD(tin(i,e,n),o,bB),marks:p,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:l}),t)}function Jrn(e,t){let n=e.type||cQe;return!e.type&&ein(e)===1&&(e.fill||e.stroke)&&(n=Q$(t)?Nq:J9(t)?Pxe:cQe),n!==Nq?n:J9(t)?Pxe:Nq}function ein(e){return qxe.reduce((t,n)=>t+(e[n]?1:0),0)}function tin(e,t,n){let r={enter:{},update:{}};return ta(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function nin(e,t,n){let r=e2(bQe("size",e,n)),i=e2(bQe("strokeWidth",e,n)),o=e2(rin(n[1].encode,t,xB));return Mp(`max(ceil(sqrt(${r})+${i}),${o})`,t)}function bQe(e,t,n){return t[e]?`scale("${t[e]}",datum)`:jQe(e,n[0].encode)}function rin(e,t,n){return jQe("fontSize",e)||_rn("fontSize",t,n)}function oin(e,t){e=zn(e)?{text:e}:e;let n=Eu(e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,l=[],u={},c=At(t.add(Bp(null,[u])));return l.push(lin(e,n,sin(e),c)),e.subtitle&&l.push(uin(e,n,r.subtitle,c)),Uq(gB({role:tnn,from:c,encode:ain(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}function sin(e){let t=e.encode;return t&&t.title||Jt({name:e.name,interactive:e.interactive,style:e.style},t)}function ain(e,t){let n={enter:{},update:{}};return ta(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Yxe},angle:{signal:iin},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),OD(n,t,bB)}function lin(e,t,n,r){let i={value:0},o=e.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ta(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Bc({type:r2,role:nnn,style:mrn,from:r,encode:s},n)}function uin(e,t,n,r){let i={value:0},o=e.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ta(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Bc({type:r2,role:rnn,style:hrn,from:r,encode:s},n)}function cin(e,t){let n=[];e.transform&&e.transform.forEach(r=>{n.push(Zxe(r,t))}),e.on&&e.on.forEach(r=>{HQe(r,t,e.name)}),t.addDataPipeline(e.name,fin(e,t,n))}function fin(e,t,n){let r=[],i=null,o=!1,s=!1,a,l,u,c,f;for(e.values?ts(e.values)||Iq(e.format)?(r.push(yQe(t,e)),r.push(i=JE())):r.push(i=JE({$ingest:e.values,$format:e.format})):e.url?Iq(e.url)||Iq(e.format)?(r.push(yQe(t,e)),r.push(i=JE())):r.push(i=JE({$request:e.url,$format:e.format})):e.source&&(i=a=Rt(e.source).map(d=>At(t.getData(d).output)),r.push(null)),l=0,u=n.length;l<u;++l)c=n[l],f=c.metadata,!i&&!f.source&&r.push(i=JE()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(u=a.length-1,r[0]=Wnn({derive:o,pulse:u?a:a[0]}),(o||u)&&r.splice(1,0,JE())),i||r.push(JE()),r.push(n2({})),r}function JE(e){let t=Bp({},e);return t.metadata={source:!0},t}function yQe(e,t){return $nn({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}function ID(e,t,n,r){let i;if(t&&Dt(t,e))return t[e];if(Dt(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Gxe][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[xB][i]}return null}function wQe(e){let t={};for(let n of e)if(n)for(let r in n)t[r]=1;return Object.keys(t)}function vin(e,t){var n=t.config,r=n.style,i=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,s=e.orient,a,l,u;if(ts(s)){let f=wQe([n.axisX,n.axisY]),d=wQe([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(u of f)a[u]=ks(s,ID(u,n.axisX,i,r),ID(u,n.axisY,i,r));l={};for(u of d)l[u]=bin(s.signal,ID(u,n.axisTop,i,r),ID(u,n.axisBottom,i,r),ID(u,n.axisLeft,i,r),ID(u,n.axisRight,i,r))}else a=s===zp||s===pw?n.axisX:n.axisY,l=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||l||o?Jt({},i,a,l,o):i}function win(e,t,n,r){let i=Eu(e,t),o=e.orient,s,a,l={enter:s={opacity:$n},update:a={opacity:Kf},exit:{opacity:$n}};ta(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});let u=CQe(e,0),c=CQe(e,1);return s.x=a.x=ks(o,u,$n),s.x2=a.x2=ks(o,c),s.y=a.y=Lp(o,u,$n),s.y2=a.y2=Lp(o,c),Bc({type:Hxe,role:Wtn,from:r,encode:l},n)}function CQe(e,t){return{scale:e.scale,range:t}}function Cin(e,t,n,r,i){let o=Eu(e,t),s=e.orient,a=e.gridScale,l=jq(s,1,-1),u=_in(e.offset,l),c,f,d,p={enter:c={opacity:$n},update:d={opacity:Kf},exit:f={opacity:$n}};ta(p,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});let m={scale:e.scale,field:Yf,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},h=ks(s,{signal:"height"},{signal:"width"}),g=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},x=a?{scale:a,range:1,mult:l,offset:u}:Jt(h,{mult:l,offset:u});return c.x=d.x=ks(s,m,g),c.y=d.y=Lp(s,m,g),c.x2=d.x2=Lp(s,x),c.y2=d.y2=ks(s,x),f.x=ks(s,m),f.y=Lp(s,m),Bc({type:Hxe,role:Gtn,key:Yf,from:r,encode:p},n)}function _in(e,t){if(t!==1)if(!tn(e))e=ts(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Jt({},e);for(;n.mult!=null;)if(tn(n.mult))n=n.mult=Jt({},n.mult);else return n.mult=ts(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Sin(e,t,n,r,i,o){let s=Eu(e,t),a=e.orient,l=jq(a,-1,1),u,c,f,d={enter:u={opacity:$n},update:f={opacity:Kf},exit:c={opacity:$n}};ta(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});let p=Ts(i);p.mult=l;let m={scale:e.scale,field:Yf,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=u.y=ks(a,$n,m),f.y2=u.y2=ks(a,p),c.x=ks(a,m),f.x=u.x=Lp(a,$n,m),f.x2=u.x2=Lp(a,p),c.y=Lp(a,m),Bc({type:Hxe,role:Htn,key:Yf,from:r,encode:d},n)}function Nxe(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Ein(e,t,n,r,i,o){let s=Eu(e,t),a=e.orient,l=e.scale,u=jq(a,-1,1),c=e2(s("labelFlush")),f=e2(s("labelFlushOffset")),d=s("labelAlign"),p=s("labelBaseline"),m=c===0||!!c,h,g=Ts(i);g.mult=u,g.offset=Ts(s("labelPadding")||0),g.offset.mult=u;let x={scale:l,field:Yf,band:.5,offset:VQe(o.offset,s("labelOffset"))},b=ks(a,m?Nxe(l,c,'"left"','"right"','"center"'):{value:"center"},din(a,"left","right")),y=ks(a,KQe(a,"bottom","top"),m?Nxe(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),v=Nxe(l,c,`-(${f})`,f,0);m=m&&f;let C={opacity:$n,x:ks(a,x,g),y:Lp(a,x,g)},_={enter:C,update:h={opacity:Kf,text:{field:Wxe},x:C.x,y:C.y,align:b,baseline:y},exit:{opacity:$n,x:C.x,y:C.y}};ta(_,{dx:!d&&m?ks(a,v):null,dy:!p&&m?Lp(a,v):null}),ta(_,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:p});let S=s("labelBound"),E=s("labelOverlap");return E=E||S?{separation:s("labelSeparation"),method:E,order:"datum.index",bound:S?{scale:l,orient:a,tolerance:S}:null}:void 0,h.align!==b&&(h.align=FD(h.align,b)),h.baseline!==y&&(h.baseline=FD(h.baseline,y)),Bc({type:r2,role:qtn,style:xB,key:Yf,from:r,encode:_,overlap:E},n)}function Ain(e,t,n,r){let i=Eu(e,t),o=e.orient,s=jq(o,-1,1),a,l,u={enter:a={opacity:$n,anchor:Ts(i("titleAnchor",null)),align:{signal:Yxe}},update:l=Jt({},a,{opacity:Kf,text:Ts(e.title)}),exit:{opacity:$n}},c={signal:`lerp(range("${e.scale}"), ${Bq(0,1,.5)})`};return l.x=ks(o,c),l.y=Lp(o,c),a.angle=ks(o,$n,yin(s,90)),a.baseline=ks(o,KQe(o,pw,zp),{value:pw}),l.angle=a.angle,l.baseline=a.baseline,ta(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Tin(i,o,u,n),u.update.align=FD(u.update.align,a.align),u.update.angle=FD(u.update.angle,a.angle),u.update.baseline=FD(u.update.baseline,a.baseline),Bc({type:r2,role:Ytn,style:Gxe,from:r,encode:u},n)}function Tin(e,t,n,r){let i=(a,l)=>a!=null?(n.update[l]=FD(Ts(a),n.update[l]),!1):!DD(l,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?Ts(s):ks(t,Ts(s),Ts(o))}function kin(e,t){let n=vin(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,l=Eu(e,n),u=Srn(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},f=At(t.add(Bp({},[c]))),d=At(t.add(Inn({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[],m;return c.grid&&p.push(Cin(e,n,r.grid,d,u)),c.ticks&&(m=l("tickSize"),p.push(Sin(e,n,r.ticks,d,m,u))),c.labels&&(m=c.ticks?m:0,p.push(Ein(e,n,r.labels,d,m,u))),c.domain&&p.push(win(e,n,r.domain,f)),c.title&&p.push(Ain(e,n,r.title,f)),Uq(gB({role:Vtn,from:f,encode:OD(Iin(l,e),i,bB),marks:p,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:s,style:a}),t)}function Iin(e,t){let n={enter:{},update:{}};return ta(n,{orient:e("orient"),offset:e("offset")||0,position:Pp(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function ZQe(e,t,n){let r=Rt(e.signals),i=Rt(e.scales);return n||r.forEach(o=>IQe(o,t)),Rt(e.projections).forEach(o=>arn(o,t)),i.forEach(o=>Knn(o,t)),Rt(e.data).forEach(o=>cin(o,t)),i.forEach(o=>Xnn(o,t)),(n||r).forEach(o=>knn(o,t)),Rt(e.axes).forEach(o=>kin(o,t)),Rt(e.marks).forEach(o=>Uq(o,t)),Rt(e.legends).forEach(o=>Qrn(o,t)),e.title&&oin(e.title,t),t.parseLambdas(),t}function Nin(e,t){let n=t.config,r=At(t.root=t.add(Rq())),i=Fin(e,n);i.forEach(u=>IQe(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;let o=t.add(Bp()),s=t.add(FQe(kQe(Din(e.encode),Lq,zxe,e.style,t,{pulse:At(o)}))),a=t.add(MQe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:At(s)}));t.operators.pop(),t.pushState(At(s),At(a),null),ZQe(e,t,i),t.operators.push(a);let l=t.add(NQe({mark:r,pulse:At(a)}));return l=t.add(OQe({pulse:At(l)})),l=t.add(n2({pulse:At(l)})),t.addData("root",new t2(t,o,o,l)),t}function pB(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Fin(e,t){let n=s=>Pp(e[s],t[s]),r=[pB("background",n("background")),pB("autosize",ztn(n("autosize"))),pB("padding",jtn(n("padding"))),pB("width",n("width")||0),pB("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return Rt(e.signals).forEach(s=>{Dt(i,s.name)?s=Jt(i[s.name],s):r.push(s),o[s.name]=s}),Rt(t.signals).forEach(s=>{!Dt(o,s.name)&&!Dt(i,s.name)&&r.push(s)}),r}function QQe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function _Qe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function Jxe(e){return(Vt(e)?Rin:Oin)(e)}function Rin(e){let t=e.length,n="[";for(let r=0;r<t;++r){let i=e[r];n+=(r>0?",":"")+(tn(i)?i.signal||Jxe(i):Ot(i))}return n+"]"}function Oin(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+Ot(r)+":"+(tn(i)?i.signal||Jxe(i):Ot(i));return t+"}"}function Min(){let e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function JQe(e,t,n){return tn(e)||Se("Input Vega specification must be an object."),t=uk(Min(),t,e.config),Nin(e,new QQe(t,n)).toRuntime()}var fB,Utn,Ts,Bxe,zxe,Uxe,Vtn,Wtn,Gtn,qtn,Htn,Ytn,Ktn,Xtn,Ztn,Qtn,SQe,Jtn,enn,tnn,nnn,rnn,EQe,Tq,dnn,pnn,Rxe,hnn,gnn,jxe,Oxe,lQe,Snn,Rr,DQe,Inn,NQe,Bp,uQe,Dnn,FQe,Nnn,Fnn,Rnn,Onn,Mnn,$nn,Pnn,Lnn,Bnn,znn,Unn,RQe,jnn,Vnn,Wnn,OQe,Gnn,n2,qnn,MQe,Hnn,Ynn,$Qe,zp,MD,$D,pw,zQe,lrn,urn,crn,frn,$xe,Wxe,drn,RD,prn,Yf,xB,Gxe,mrn,hrn,cQe,Nq,Pxe,Lxe,grn,xrn,brn,yrn,vrn,wrn,qxe,bB,$n,Kf,Lq,UQe,Hxe,Crn,r2,Yxe,Trn,krn,Kxe,Xxe,zq,Nrn,Frn,Rrn,Orn,Mrn,$rn,Prn,Grn,qrn,Hrn,hQe,Dxe,gQe,iin,YQe,jq,ks,Lp,KQe,din,pin,min,hin,gin,xin,XQe,vQe,Qxe,bin,ND,yin,FD,Din,eJe=w(()=>{"use strict";ao();pq();iQe();TI();hs();fB=e=>+e||0,Utn=e=>({top:e,bottom:e,left:e,right:e});Ts=e=>tn(e)&&!Vt(e)?Jt({},e):{value:e};Bxe="mark",zxe="frame",Uxe="scope",Vtn="axis",Wtn="axis-domain",Gtn="axis-grid",qtn="axis-label",Htn="axis-tick",Ytn="axis-title",Ktn="legend",Xtn="legend-band",Ztn="legend-entry",Qtn="legend-gradient",SQe="legend-label",Jtn="legend-symbol",enn="legend-title",tnn="title",nnn="title-text",rnn="title-subtitle";EQe=e=>zn(e)?Ot(e):e.signal?`(${e.signal})`:AQe(e);Tq=(e,t,n,r)=>`(${e}(${[t,n,r].map(Oq).join(",")})+'')`;dnn="outer",pnn=["value","update","init","react","bind"];Rxe=mB("key");hnn="ascending",gnn="descending";jxe="scope",Oxe="view";lQe="timer";Snn={code:"_.$value",ast:{type:"Identifier",value:"value"}};Rr=e=>(t,n,r)=>Mq(e,n,t||void 0,r),DQe=Rr("aggregate"),Inn=Rr("axisticks"),NQe=Rr("bound"),Bp=Rr("collect"),uQe=Rr("compare"),Dnn=Rr("datajoin"),FQe=Rr("encode"),Nnn=Rr("expression"),Fnn=Rr("facet"),Rnn=Rr("field"),Onn=Rr("key"),Mnn=Rr("legendentries"),$nn=Rr("load"),Pnn=Rr("mark"),Lnn=Rr("multiextent"),Bnn=Rr("multivalues"),znn=Rr("overlap"),Unn=Rr("params"),RQe=Rr("prefacet"),jnn=Rr("projection"),Vnn=Rr("proxy"),Wnn=Rr("relay"),OQe=Rr("render"),Gnn=Rr("scale"),n2=Rr("sieve"),qnn=Rr("sortitems"),MQe=Rr("viewlayout"),Hnn=Rr("values"),Ynn=0,$Qe={min:"min",max:"max",count:"sum"};zp="top",MD="left",$D="right",pw="bottom",zQe="center",lrn="vertical",urn="start",crn="middle",frn="end",$xe="index",Wxe="label",drn="offset",RD="perc",prn="perc2",Yf="value",xB="guide-label",Gxe="guide-title",mrn="group-title",hrn="group-subtitle",cQe="symbol",Nq="gradient",Pxe="discrete",Lxe="size",grn="shape",xrn="fill",brn="stroke",yrn="strokeWidth",vrn="strokeDash",wrn="opacity",qxe=[Lxe,grn,xrn,brn,yrn,vrn,wrn],bB={name:1,style:1,interactive:1},$n={value:0},Kf={value:1},Lq="group",UQe="rect",Hxe="rule",Crn="symbol",r2="text";Yxe=Bq(Ot(MD),Ot($D),Ot(zQe));Trn=`datum.${RD}<=0?"${MD}":datum.${RD}>=1?"${$D}":"${zQe}"`,krn=`datum.${RD}<=0?"${pw}":datum.${RD}>=1?"${zp}":"${crn}"`;Kxe='item.orient === "left"',Xxe='item.orient === "right"',zq=`(${Kxe} || ${Xxe})`,Nrn=`datum.vgrad && ${zq}`,Frn=Bq('"top"','"bottom"','"middle"'),Rrn=Bq('"right"','"left"','"center"'),Orn=`datum.vgrad && ${Xxe} ? (${Rrn}) : (${zq} && !(datum.vgrad && ${Kxe})) ? "left" : ${Yxe}`,Mrn=`item._anchor || (${zq} ? "middle" : "start")`,$rn=`${Nrn} ? (${Kxe} ? -90 : 90) : 0`,Prn=`${zq} ? (datum.vgrad ? (${Xxe} ? "bottom" : "top") : ${Frn}) : "top"`;Grn=e=>e&&e.expr,qrn=e=>e&&e.field,Hrn=e=>e==="data",hQe=e=>e==="expr",Dxe=e=>e==="field",gQe=e=>e==="compare";t2.fromEntries=function(e,t){let n=t.length,r=t[n-1],i=t[n-2],o=t[0],s=null,a=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=At(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(s=t[a]);return new t2(e,o,i,r,s)};t2.prototype={countsRef(e,t,n){let r=this,i=r.counts||(r.counts={}),o=qQe(t),s,a,l;return o!=null&&(e=r.scope,s=i[o]),s?n&&n.field&&xQe(e,s.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:At(r.output)},n&&n.field&&xQe(e,l,n),a=e.add(DQe(l)),s=e.add(Bp({pulse:At(a)})),s={agg:a,ref:At(s)},o!=null&&(i[o]=s)),s.ref},tuplesRef(){return At(this.values)},extentRef(e,t){return dB(e,this,"extent","extent",t,!1)},domainRef(e,t){return dB(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return dB(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return dB(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return dB(e,this,"indata","tupleindex",t,!0,!0)}};iin=`item.orient==="${MD}"?-90:item.orient==="${$D}"?90:0`;YQe=e=>e===pw||e===zp,jq=(e,t,n)=>ts(e)?hin(e.signal,t,n):e===MD||e===zp?t:n,ks=(e,t,n)=>ts(e)?pin(e.signal,t,n):YQe(e)?t:n,Lp=(e,t,n)=>ts(e)?min(e.signal,t,n):YQe(e)?n:t,KQe=(e,t,n)=>ts(e)?gin(e.signal,t,n):e===zp?{value:t}:{value:n},din=(e,t,n)=>ts(e)?xin(e.signal,t,n):e===$D?{value:t}:{value:n},pin=(e,t,n)=>XQe(`${e} === '${zp}' || ${e} === '${pw}'`,t,n),min=(e,t,n)=>XQe(`${e} !== '${zp}' && ${e} !== '${pw}'`,t,n),hin=(e,t,n)=>Qxe(`${e} === '${MD}' || ${e} === '${zp}'`,t,n),gin=(e,t,n)=>Qxe(`${e} === '${zp}'`,t,n),xin=(e,t,n)=>Qxe(`${e} === '${$D}'`,t,n),XQe=(e,t,n)=>(t=t!=null?Ts(t):t,n=n!=null?Ts(n):n,vQe(t)&&vQe(n)?(t=t?t.signal||Ot(t.value):null,n=n?n.signal||Ot(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Jt({test:e},t)].concat(n||[])),vQe=e=>e==null||Object.keys(e).length===1,Qxe=(e,t,n)=>({signal:`${e} ? (${ND(t)}) : (${ND(n)})`}),bin=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${MD}' ? (${ND(r)}) : `:"")+(n!=null?`${e} === '${pw}' ? (${ND(n)}) : `:"")+(i!=null?`${e} === '${$D}' ? (${ND(i)}) : `:"")+(t!=null?`${e} === '${zp}' ? (${ND(t)}) : `:"")+"(null)"}),ND=e=>ts(e)?e.signal:e==null?null:Ot(e),yin=(e,t)=>t===0?0:ts(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},FD=(e,t)=>{let n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};Din=e=>OD({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);QQe.prototype=_Qe.prototype={parse(e){return ZQe(e,this)},fork(){return new _Qe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){let t=e instanceof Fxe?At(e):e;return this.add(Vnn({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(let r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(At(this.add(n2({pulse:e})))),this._parent.push(t),this._lookup.push(n?At(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Fn(this._parent)},encode(){return Fn(this._encode)},lookup(){return Fn(this._lookup)},markpath(){let e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(zn(e))return mB(e,t);e.signal||Se("Unsupported field reference: "+Ot(e));let n=e.signal,r=this.field[n];if(!r){let i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=At(this.add(Rnn(i)))}return r},compareRef(e){let t=!1,n=o=>ts(o)?(t=!0,this.signalRef(o.signal)):bnn(o)?(t=!0,this.exprRef(o.expr)):o,r=Rt(e.field).map(n),i=Rt(e.order).map(n);return t?At(this.add(uQe({fields:r,orders:i}))):aQe(r,i)},keyRef(e,t){let n=!1,r=o=>ts(o)?(n=!0,At(i[o.signal])):o,i=this.signals;return e=Rt(e).map(r),n?At(this.add(Onn({fields:e,flat:t}))):mnn(e,t)},sortRef(e){if(!e)return e;let t=$q(e.op,e.field),n=e.order||hnn;return n.signal?At(this.add(uQe({fields:t,orders:this.signalRef(n.signal)}))):aQe(t,n)},event(e,t){let n=e+":"+t;if(!this.events[n]){let r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return Dt(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Se("Duplicate signal name: "+Ot(e));let n=t instanceof Fxe?t:this.add(Rq(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Se("Unrecognized signal name: "+Ot(e)),this.signals[e]},signalRef(e){return this.signals[e]?At(this.signals[e]):(Dt(this.lambdas,e)||(this.lambdas[e]=this.add(Rq(null))),At(this.lambdas[e]))},parseLambdas(){let e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){let r=e[t],i=Mp(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!tn(e)?e:this.signalRef(e.signal||Jxe(e))},exprRef(e,t){let n={expr:Mp(e,this)};return t&&(n.expr.$name=t),At(this.add(Nnn(n)))},addBinding(e,t){this.bindings||Se("Nested signals do not support binding: "+Ot(e)),this.bindings.push(Jt({signal:e},t))},addScaleProj(e,t){Dt(this.scales,e)&&Se("Duplicate scale or projection name: "+Ot(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Gnn(t))},addProjection(e,t){this.addScaleProj(e,jnn(t))},getScale(e){return this.scales[e]||Se("Unrecognized scale name: "+Ot(e)),this.scales[e]},scaleRef(e){return At(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Dt(this.data,e)&&Se("Duplicate data set name: "+Ot(e)),this.data[e]=t},getData(e){return this.data[e]||Se("Undefined data set name: "+Ot(e)),this.data[e]},addDataPipeline(e,t){return Dt(this.data,e)&&Se("Duplicate data set name: "+Ot(e)),this.addData(e,t2.fromEntries(this,t))}}});function Up(e){this.type=e}function Yin(e){switch(e.type){case zin:return e.elements;case Uin:case Win:return[e.left,e.right];case jin:return[e.callee].concat(e.arguments);case Vin:return[e.test,e.consequent,e.alternate];case Gin:return[e.object,e.property];case qin:return e.properties;case Lin:return[e.key,e.value];case Hin:return[e.argument];case Bin:case Pin:case $in:default:return[]}}function Hq(e,t){if(!e)throw new Error("ASSERT: "+t)}function Pb(e){return e>=48&&e<=57}function obe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function vB(e){return"01234567".indexOf(e)>=0}function mon(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function CB(e){return e===10||e===13||e===8232||e===8233}function EB(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&don.test(String.fromCharCode(e))}function Wq(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&pon.test(String.fromCharCode(e))}function cJe(){for(;Ce<$a;){let e=ht.charCodeAt(Ce);if(mon(e)||CB(e))++Ce;else break}}function ibe(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)Ce<$a&&obe(ht[Ce])?(r=ht[Ce++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Jn({},Is,na);return String.fromCharCode(i)}function gon(){var e,t,n,r;for(e=ht[Ce],t=0,e==="}"&&Jn({},Is,na);Ce<$a&&(e=ht[Ce++],!!obe(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Jn({},Is,na),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function fJe(){var e,t;for(e=ht.charCodeAt(Ce++),t=String.fromCharCode(e),e===92&&(ht.charCodeAt(Ce)!==117&&Jn({},Is,na),++Ce,e=ibe("u"),(!e||e==="\\"||!EB(e.charCodeAt(0)))&&Jn({},Is,na),t=e);Ce<$a&&(e=ht.charCodeAt(Ce),!!Wq(e));)++Ce,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ht.charCodeAt(Ce)!==117&&Jn({},Is,na),++Ce,e=ibe("u"),(!e||e==="\\"||!Wq(e.charCodeAt(0)))&&Jn({},Is,na),t+=e);return t}function xon(){var e,t;for(e=Ce++;Ce<$a;){if(t=ht.charCodeAt(Ce),t===92)return Ce=e,fJe();if(Wq(t))++Ce;else break}return ht.slice(e,Ce)}function bon(){var e,t,n;return e=Ce,t=ht.charCodeAt(Ce)===92?fJe():xon(),t.length===1?n=i2:hon.hasOwnProperty(t)?n=mw:t==="null"?n=qq:t==="true"||t==="false"?n=Gq:n=i2,{type:n,value:t,start:e,end:Ce}}function tbe(){var e=Ce,t=ht.charCodeAt(Ce),n,r=ht[Ce],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Ce,{type:Au,value:String.fromCharCode(t),start:e,end:Ce};default:if(n=ht.charCodeAt(Ce+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Ce+=2,{type:Au,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Ce};case 33:case 61:return Ce+=2,ht.charCodeAt(Ce)===61&&++Ce,{type:Au,value:ht.slice(e,Ce),start:e,end:Ce}}}if(s=ht.substr(Ce,4),s===">>>=")return Ce+=4,{type:Au,value:s,start:e,end:Ce};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return Ce+=3,{type:Au,value:o,start:e,end:Ce};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return Ce+=2,{type:Au,value:i,start:e,end:Ce};if(i==="//"&&Jn({},Is,na),"<>=!+-*%&|^/".indexOf(r)>=0)return++Ce,{type:Au,value:r,start:e,end:Ce};Jn({},Is,na)}function yon(e){let t="";for(;Ce<$a&&obe(ht[Ce]);)t+=ht[Ce++];return t.length===0&&Jn({},Is,na),EB(ht.charCodeAt(Ce))&&Jn({},Is,na),{type:s2,value:parseInt("0x"+t,16),start:e,end:Ce}}function von(e){let t="0"+ht[Ce++];for(;Ce<$a&&vB(ht[Ce]);)t+=ht[Ce++];return(EB(ht.charCodeAt(Ce))||Pb(ht.charCodeAt(Ce)))&&Jn({},Is,na),{type:s2,value:parseInt(t,8),octal:!0,start:e,end:Ce}}function tJe(){var e,t,n;if(n=ht[Ce],Hq(Pb(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=Ce,e="",n!=="."){if(e=ht[Ce++],n=ht[Ce],e==="0"){if(n==="x"||n==="X")return++Ce,yon(t);if(vB(n))return von(t);n&&Pb(n.charCodeAt(0))&&Jn({},Is,na)}for(;Pb(ht.charCodeAt(Ce));)e+=ht[Ce++];n=ht[Ce]}if(n==="."){for(e+=ht[Ce++];Pb(ht.charCodeAt(Ce));)e+=ht[Ce++];n=ht[Ce]}if(n==="e"||n==="E")if(e+=ht[Ce++],n=ht[Ce],(n==="+"||n==="-")&&(e+=ht[Ce++]),Pb(ht.charCodeAt(Ce)))for(;Pb(ht.charCodeAt(Ce));)e+=ht[Ce++];else Jn({},Is,na);return EB(ht.charCodeAt(Ce))&&Jn({},Is,na),{type:s2,value:parseFloat(e),start:t,end:Ce}}function won(){var e="",t,n,r,i,o=!1;for(t=ht[Ce],Hq(t==="'"||t==='"',"String literal must starts with a quote"),n=Ce,++Ce;Ce<$a;)if(r=ht[Ce++],r===t){t="";break}else if(r==="\\")if(r=ht[Ce++],!r||!CB(r.charCodeAt(0)))switch(r){case"u":case"x":ht[Ce]==="{"?(++Ce,e+=gon()):e+=ibe(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:vB(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),Ce<$a&&vB(ht[Ce])&&(o=!0,i=i*8+"01234567".indexOf(ht[Ce++]),"0123".indexOf(r)>=0&&Ce<$a&&vB(ht[Ce])&&(i=i*8+"01234567".indexOf(ht[Ce++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ht[Ce]===`
`&&++Ce;else{if(CB(r.charCodeAt(0)))break;e+=r}return t!==""&&Jn({},Is,na),{type:SB,value:e,octal:o,start:n,end:Ce}}function Con(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Jn({},rbe)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Jn({},rbe)}try{return new RegExp(e,t)}catch{return null}}function _on(){var e,t,n,r,i;for(e=ht[Ce],Hq(e==="/","Regular expression literal must start with a slash"),t=ht[Ce++],n=!1,r=!1;Ce<$a;)if(e=ht[Ce++],t+=e,e==="\\")e=ht[Ce++],CB(e.charCodeAt(0))&&Jn({},ebe),t+=e;else if(CB(e.charCodeAt(0)))Jn({},ebe);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Jn({},ebe),i=t.substr(1,t.length-2),{value:i,literal:t}}function Son(){var e,t,n;for(t="",n="";Ce<$a&&(e=ht[Ce],!!Wq(e.charCodeAt(0)));)++Ce,e==="\\"&&Ce<$a?Jn({},Is,na):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Jn({},rbe,n),{value:n,literal:t}}function Eon(){var e,t,n,r;return wr=null,cJe(),e=Ce,t=_on(),n=Son(),r=Con(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Ce}}function Aon(e){return e.type===i2||e.type===mw||e.type===Gq||e.type===qq}function dJe(){if(cJe(),Ce>=$a)return{type:_B,start:Ce,end:Ce};let e=ht.charCodeAt(Ce);return EB(e)?bon():e===40||e===41||e===59?tbe():e===39||e===34?won():e===46?Pb(ht.charCodeAt(Ce+1))?tJe():tbe():Pb(e)?tJe():tbe()}function Tu(){let e=wr;return Ce=e.end,wr=dJe(),Ce=e.end,e}function pJe(){let e=Ce;wr=dJe(),Ce=e}function Ton(e){let t=new Up(Xin);return t.elements=e,t}function nJe(e,t,n){let r=new Up(e==="||"||e==="&&"?ton:Zin);return r.operator=e,r.left=t,r.right=n,r}function kon(e,t){let n=new Up(Qin);return n.callee=e,n.arguments=t,n}function Ion(e,t,n){let r=new Up(Jin);return r.test=e,r.consequent=t,r.alternate=n,r}function sbe(e){let t=new Up(lJe);return t.name=e,t}function yB(e){let t=new Up(eon);return t.value=e.value,t.raw=ht.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function rJe(e,t,n){let r=new Up(non);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Don(e){let t=new Up(ron);return t.properties=e,t}function iJe(e,t,n){let r=new Up(ion);return r.key=t,r.value=n,r.kind=e,r}function Non(e,t){let n=new Up(oon);return n.operator=e,n.argument=t,n.prefix=!0,n}function Jn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(Hq(s<r.length,"Message reference must be in range"),r[s]));throw n=new Error(i),n.index=Ce,n.description=i,n}function Yq(e){e.type===_B&&Jn(e,con),e.type===s2&&Jn(e,son),e.type===SB&&Jn(e,aon),e.type===i2&&Jn(e,lon),e.type===mw&&Jn(e,uon),Jn(e,Is,e.value)}function Pa(e){let t=Tu();(t.type!==Au||t.value!==e)&&Yq(t)}function ci(e){return wr.type===Au&&wr.value===e}function nbe(e){return wr.type===mw&&wr.value===e}function Fon(){let e=[];for(Ce=wr.start,Pa("[");!ci("]");)ci(",")?(Tu(),e.push(null)):(e.push(o2()),ci("]")||Pa(","));return Tu(),Ton(e)}function oJe(){Ce=wr.start;let e=Tu();return e.type===SB||e.type===s2?(e.octal&&Jn(e,uJe),yB(e)):sbe(e.value)}function Ron(){var e,t,n,r;if(Ce=wr.start,e=wr,e.type===i2)return n=oJe(),Pa(":"),r=o2(),iJe("init",n,r);if(e.type===_B||e.type===Au)Yq(e);else return t=oJe(),Pa(":"),r=o2(),iJe("init",t,r)}function Oon(){var e=[],t,n,r,i={},o=String;for(Ce=wr.start,Pa("{");!ci("}");)t=Ron(),t.key.type===lJe?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Jn({},fon):i[r]=!0,e.push(t),ci("}")||Pa(",");return Pa("}"),Don(e)}function Mon(){Pa("(");let e=abe();return Pa(")"),e}function Pon(){var e,t,n;if(ci("("))return Mon();if(ci("["))return Fon();if(ci("{"))return Oon();if(e=wr.type,Ce=wr.start,e===i2||$on[wr.value])n=sbe(Tu().value);else if(e===SB||e===s2)wr.octal&&Jn(wr,uJe),n=yB(Tu());else{if(e===mw)throw new Error(wB);e===Gq?(t=Tu(),t.value=t.value==="true",n=yB(t)):e===qq?(t=Tu(),t.value=null,n=yB(t)):ci("/")||ci("/=")?(n=yB(Eon()),pJe()):Yq(Tu())}return n}function Lon(){let e=[];if(Pa("("),!ci(")"))for(;Ce<$a&&(e.push(o2()),!ci(")"));)Pa(",");return Pa(")"),e}function Bon(){Ce=wr.start;let e=Tu();return Aon(e)||Yq(e),sbe(e.value)}function zon(){return Pa("."),Bon()}function Uon(){Pa("[");let e=abe();return Pa("]"),e}function jon(){var e,t,n;for(e=Pon();;)if(ci("."))n=zon(),e=rJe(".",e,n);else if(ci("("))t=Lon(),e=kon(e,t);else if(ci("["))n=Uon(),e=rJe("[",e,n);else break;return e}function sJe(){let e=jon();if(wr.type===Au&&(ci("++")||ci("--")))throw new Error(wB);return e}function Vq(){var e,t;if(wr.type!==Au&&wr.type!==mw)t=sJe();else{if(ci("++")||ci("--"))throw new Error(wB);if(ci("+")||ci("-")||ci("~")||ci("!"))e=Tu(),t=Vq(),t=Non(e.value,t);else{if(nbe("delete")||nbe("void")||nbe("typeof"))throw new Error(wB);t=sJe()}}return t}function aJe(e){let t=0;if(e.type!==Au&&e.type!==mw)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Von(){var e,t,n,r,i,o,s,a,l,u;if(e=wr,l=Vq(),r=wr,i=aJe(r),i===0)return l;for(r.prec=i,Tu(),t=[e,wr],s=Vq(),o=[l,r,s];(i=aJe(wr))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,l=o.pop(),t.pop(),n=nJe(a,l,s),o.push(n);r=Tu(),r.prec=i,o.push(r),t.push(wr),n=Vq(),o.push(n)}for(u=o.length-1,n=o[u],t.pop();u>1;)t.pop(),n=nJe(o[u-1].value,o[u-2],n),u-=2;return n}function o2(){var e,t,n;return e=Von(),ci("?")&&(Tu(),t=o2(),Pa(":"),n=o2(),e=Ion(e,t,n)),e}function abe(){let e=o2();if(ci(","))throw new Error(wB);return e}function mJe(e){ht=e,Ce=0,$a=ht.length,wr=null,pJe();let t=abe();if(wr.type!==_B)throw new Error("Unexpect token after expression.");return t}function Gon(e){function t(s,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+s+(u<0?"":u===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(s,a,l){return u=>t(s,u,a,l)}let r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&Se("Missing arguments to clamp function."),s.length>3&&Se("Too many arguments to clamp function.");let a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&Se("Missing arguments to if function."),s.length>3&&Se("Too many arguments to if function.");let a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function qon(e){let t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function hJe(e){e=e||{};let t=e.allowed?wa(e.allowed):{},n=e.forbidden?wa(e.forbidden):{},r=e.constants||Won,i=(e.functions||Gon)(f),o=e.globalvar,s=e.fieldvar,a=wn(o)?o:m=>"".concat(o,'["').concat(m,'"]'),l={},u={},c=0;function f(m){if(zn(m))return m;let h=d[m.type];return h==null&&Se("Unsupported type: "+m.type),h(m)}let d={Literal:m=>m.raw,Identifier:m=>{let h=m.name;return c>0?h:Dt(n,h)?Se("Illegal identifier: "+h):Dt(r,h)?r[h]:Dt(t,h)?h:(l[h]=1,a(h))},MemberExpression:m=>{let h=!m.computed,g=f(m.object);h&&(c+=1);let x=f(m.property);return g===s&&(u[qon(x)]=1),h&&(c-=1),g+(h?"."+x:"["+x+"]")},CallExpression:m=>{m.callee.type!=="Identifier"&&Se("Illegal callee type: "+m.callee.type);let h=m.callee.name,g=m.arguments,x=Dt(i,h)&&i[h];return x||Se("Unrecognized function: "+h),wn(x)?x(g):x+"("+g.map(f).join(",")+")"},ArrayExpression:m=>"["+m.elements.map(f).join(",")+"]",BinaryExpression:m=>"("+f(m.left)+" "+m.operator+" "+f(m.right)+")",UnaryExpression:m=>"("+m.operator+f(m.argument)+")",ConditionalExpression:m=>"("+f(m.test)+"?"+f(m.consequent)+":"+f(m.alternate)+")",LogicalExpression:m=>"("+f(m.left)+m.operator+f(m.right)+")",ObjectExpression:m=>"{"+m.properties.map(f).join(",")+"}",Property:m=>{c+=1;let h=f(m.key);return c-=1,h+":"+f(m.value)}};function p(m){let h={code:f(m),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},h}return p.functions=i,p.constants=r,p}var $in,Pin,Lin,Bin,zin,Uin,jin,Vin,Win,Gin,qin,Hin,Bg,ht,Ce,$a,wr,Gq,_B,i2,mw,qq,s2,Au,SB,Kin,Xin,Zin,Qin,Jin,lJe,eon,ton,non,ron,ion,oon,Is,son,aon,lon,uon,con,rbe,ebe,uJe,fon,na,wB,don,pon,hon,$on,Won,gJe=w(()=>{"use strict";ao();$in="RawCode",Pin="Literal",Lin="Property",Bin="Identifier",zin="ArrayExpression",Uin="BinaryExpression",jin="CallExpression",Vin="ConditionalExpression",Win="LogicalExpression",Gin="MemberExpression",qin="ObjectExpression",Hin="UnaryExpression";Up.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Yin(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};Gq=1,_B=2,i2=3,mw=4,qq=5,s2=6,Au=7,SB=8,Kin=9;Bg={};Bg[Gq]="Boolean";Bg[_B]="<end>";Bg[i2]="Identifier";Bg[mw]="Keyword";Bg[qq]="Null";Bg[s2]="Numeric";Bg[Au]="Punctuator";Bg[SB]="String";Bg[Kin]="RegularExpression";Xin="ArrayExpression",Zin="BinaryExpression",Qin="CallExpression",Jin="ConditionalExpression",lJe="Identifier",eon="Literal",ton="LogicalExpression",non="MemberExpression",ron="ObjectExpression",ion="Property",oon="UnaryExpression",Is="Unexpected token %0",son="Unexpected number",aon="Unexpected string",lon="Unexpected identifier",uon="Unexpected reserved word",con="Unexpected end of input",rbe="Invalid regular expression",ebe="Invalid regular expression: missing /",uJe="Octal literals are not allowed in strict mode.",fon="Duplicate data property in object literal not allowed in strict mode",na="ILLEGAL",wB="Disabled.",don=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),pon=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");hon={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};$on={if:1};Won={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"}});function ku(e,t,n){return vJe=t||Hon,wJe=n||Qon,CJe(e.trim()).map(lbe)}function Jon(e){return wJe[e]}function AB(e,t,n,r,i){let o=e.length,s=0,a;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function CJe(e){let t=[],n=e.length,r=0,i=0;for(;i<n;)i=AB(e,i,yJe,Kq+xJe,Xq+bJe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function lbe(e){return e[0]==="["?esn(e):tsn(e)}function esn(e){let t=e.length,n=1,r;if(n=AB(e,n,Xq,Kq,Xq),n===t)throw"Empty between selector: "+e;if(r=CJe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Xon)throw"Expected '>' after between selector: "+e;r=r.map(lbe);let i=lbe(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function tsn(e){let t={source:vJe},n=[],r=[0,0],i=0,o=0,s=e.length,a=0,l,u;if(e[s-1]===bJe){if(a=e.lastIndexOf(xJe),a>=0){try{r=nsn(e.substring(a+1,s-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),s=e.length}else throw"Unmatched right brace: "+e;a=0}if(!s)throw e;if(e[0]===Kon&&(i=++a),l=AB(e,a,Yon),l<s&&(n.push(e.substring(o,l).trim()),o=a=++l),a=AB(e,a,Kq),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),u=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=AB(e,a,Xq),a===s)throw"Unmatched left bracket: "+e;if(u.push(e.substring(o,a).trim()),a<s-1&&e[++a]!==Kq)throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||Zon.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):Jon(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function nsn(e){let t=e.split(yJe);if(!e.length||t.length>2)throw e;return t.map(n=>{let r=+n;if(r!==r)throw e;return r})}var Hon,Kq,Xq,xJe,bJe,Yon,yJe,Kon,Xon,Zon,Qon,vJe,wJe,hw=w(()=>{"use strict";Hon="view",Kq="[",Xq="]",xJe="{",bJe="}",Yon=":",yJe=",",Kon="@",Xon=">",Zon=/[[\]{}]/,Qon={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1}});var ube={};rn(ube,{Bounds:()=>Na,CanvasHandler:()=>aD,CanvasRenderer:()=>HW,DATE:()=>Cl,DAY:()=>qs,DAYOFYEAR:()=>Jh,Dataflow:()=>Lv,Debug:()=>i$e,Error:()=>t$e,EventStream:()=>Ck,Gradient:()=>Nhe,GroupItem:()=>$he,HOURS:()=>su,Handler:()=>H1,Info:()=>r$e,Item:()=>Mhe,MILLISECONDS:()=>Df,MINUTES:()=>au,MONTH:()=>Hs,Marks:()=>Mc,MultiPulse:()=>JU,None:()=>e$e,Operator:()=>yr,Parameters:()=>SM,Pulse:()=>Yx,QUARTER:()=>wl,RenderType:()=>Eb,Renderer:()=>Ag,ResourceLoader:()=>Phe,SECONDS:()=>_c,SVGHandler:()=>Jhe,SVGRenderer:()=>oge,SVGStringRenderer:()=>sge,Scenegraph:()=>nG,TIME_UNITS:()=>Sj,Transform:()=>ce,View:()=>Txe,WEEK:()=>Ao,Warn:()=>n$e,YEAR:()=>gs,accessor:()=>hc,accessorFields:()=>Xo,accessorName:()=>si,array:()=>Rt,ascending:()=>QO,bandwidthNRD:()=>lj,bin:()=>tse,bootstrapCI:()=>nse,boundClip:()=>mYt,boundContext:()=>aL,boundItem:()=>Ehe,boundMark:()=>fHe,boundStroke:()=>FE,changeset:()=>Xx,clampRange:()=>CMt,codegenExpression:()=>hJe,compare:()=>$ie,constant:()=>ps,cumulativeLogNormal:()=>mj,cumulativeNormal:()=>NM,cumulativeUniform:()=>bj,dayofyear:()=>Vse,debounce:()=>Pie,defaultLocale:()=>she,definition:()=>ej,densityLogNormal:()=>pj,densityNormal:()=>uj,densityUniform:()=>xj,domChild:()=>vu,domClear:()=>_p,domCreate:()=>U1,domFind:()=>Qhe,dotbin:()=>rse,error:()=>Se,expressionFunction:()=>co,extend:()=>Jt,extent:()=>Hd,extentIndex:()=>Lie,falsy:()=>jx,fastmap:()=>Dv,field:()=>Wd,flush:()=>kMt,font:()=>eG,fontFamily:()=>cL,fontSize:()=>Eg,format:()=>DW,formatLocale:()=>YP,formats:()=>che,hasOwnProperty:()=>Dt,id:()=>pMt,identity:()=>gl,inferType:()=>bqe,inferTypes:()=>yqe,ingest:()=>Cn,inherits:()=>$e,inrange:()=>IMt,interpolate:()=>J$,interpolateColors:()=>AI,interpolateRange:()=>eV,intersect:()=>age,intersectBoxLine:()=>tD,intersectPath:()=>Lhe,intersectPoint:()=>Bhe,intersectRule:()=>eHe,isArray:()=>Vt,isBoolean:()=>Bie,isDate:()=>JO,isFunction:()=>wn,isIterable:()=>zie,isNumber:()=>zh,isObject:()=>tn,isRegExp:()=>DMt,isString:()=>zn,isTuple:()=>mS,key:()=>Uie,lerp:()=>NMt,lineHeight:()=>G1,loader:()=>NW,locale:()=>TW,logger:()=>mMt,lruCache:()=>jie,markup:()=>ige,merge:()=>Vie,mergeConfig:()=>uk,multiLineOffset:()=>EHt,one:()=>Lh,pad:()=>RMt,panLinear:()=>gMt,panLog:()=>xMt,panPow:()=>bMt,panSymlog:()=>yMt,parse:()=>JQe,parseExpression:()=>mJe,parseSelector:()=>ku,pathCurves:()=>Fhe,pathEqual:()=>BHe,pathParse:()=>NE,pathRectangle:()=>Kqe,pathRender:()=>nD,pathSymbols:()=>Yqe,pathTrail:()=>Xqe,peek:()=>Fn,point:()=>fL,projection:()=>SP,quantileLogNormal:()=>hj,quantileNormal:()=>FM,quantileUniform:()=>yj,quantiles:()=>sj,quantizeInterpolator:()=>tV,quarter:()=>vMt,quartiles:()=>aj,random:()=>bc,randomInteger:()=>nLt,randomKDE:()=>fj,randomLCG:()=>tLt,randomLogNormal:()=>ise,randomMixture:()=>ose,randomNormal:()=>cj,randomUniform:()=>sse,read:()=>VGt,regressionExp:()=>lse,regressionLinear:()=>wj,regressionLoess:()=>fse,regressionLog:()=>ase,regressionPoly:()=>cse,regressionPow:()=>use,regressionQuad:()=>Cj,renderModule:()=>dL,repeat:()=>KO,resetDefaultLocale:()=>mqe,resetSVGClipId:()=>Qqe,resetSVGDefIds:()=>xYt,responseType:()=>jGt,runtimeContext:()=>bq,sampleCurve:()=>Tk,sampleLogNormal:()=>dj,sampleNormal:()=>DM,sampleUniform:()=>gj,scale:()=>On,sceneEqual:()=>lge,sceneFromJSON:()=>pHe,scenePickVisit:()=>UW,sceneToJSON:()=>dHe,sceneVisit:()=>Ep,sceneZOrder:()=>zhe,scheme:()=>eP,serializeXML:()=>kHe,setRandom:()=>JPt,span:()=>sS,splitAccessPath:()=>XO,stringValue:()=>Ot,textMetrics:()=>Sp,timeBin:()=>Jse,timeFloor:()=>Hse,timeFormatLocale:()=>EE,timeInterval:()=>Zx,timeOffset:()=>Kse,timeSequence:()=>Zse,timeUnitSpecifier:()=>Use,timeUnits:()=>Ej,toBoolean:()=>Wie,toDate:()=>Gie,toNumber:()=>qd,toSet:()=>wa,toString:()=>qie,transform:()=>Voe,transforms:()=>Kx,truncate:()=>MMt,truthy:()=>Bh,tupleid:()=>bt,typeParsers:()=>ahe,utcFloor:()=>Yse,utcInterval:()=>Qx,utcOffset:()=>Xse,utcSequence:()=>Qse,utcdayofyear:()=>Gse,utcquarter:()=>wMt,utcweek:()=>qse,version:()=>vsn,visitArray:()=>$Mt,week:()=>Wse,writeConfig:()=>ZO,zero:()=>Gd,zoomLinear:()=>Rie,zoomLog:()=>Oie,zoomPow:()=>_U,zoomSymlog:()=>Mie});var rsn,isn,osn,ssn,asn,lsn,usn,csn,fsn,dsn,psn,msn,hsn,gsn,xsn,bsn,ysn,vsn,cbe=w(()=>{"use strict";ao();ao();hs();hs();jBe();XUe();g7e();tVe();rWe();rGe();VHe();GHe();ZHe();GKe();YKe();kk();Fk();fhe();pL();TI();rpe();XZe();kW();pq();eJe();vxe();gJe();hw();rsn="vega",isn="5.20.0",osn="The Vega visualization grammar.",ssn=["vega","visualization","interaction","dataflow","library","data","d3"],asn="BSD-3-Clause",lsn="UW Interactive Data Lab (http://idl.cs.washington.edu)",usn="build/vega-node.js",csn="build/vega.module.js",fsn="build/vega.min.js",dsn="build/vega.min.js",psn="index.d.ts",msn="vega/vega",hsn={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},gsn={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},xsn={"vega-schema":"*"},bsn="f262105e75449760b0f35fda70e6b576a31d68a4",ysn={name:rsn,version:isn,description:osn,keywords:ssn,license:asn,author:lsn,main:usn,module:csn,unpkg:fsn,jsdelivr:dsn,types:psn,repository:msn,scripts:hsn,dependencies:gsn,devDependencies:xsn,gitHead:bsn};Jt(Kx,kae,Qce,zfe,gpe,Ope,xge,fme,wge,Tge,O0e,P0e);vsn=ysn.version});var SJe,_Je=w(()=>{SJe={name:"vega-lite",author:'Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version:"4.13.1",collaborators:["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",main:"build/vega-lite.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",module:"build/src/index",types:"build/src/index.d.ts",bin:{vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},directories:{test:"test"},scripts:{changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},dependencies:{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},peerDependencies:{vega:"^5.12.1"},jest:{preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1}}});function jp(e,t,n){return e.fields=t||[],e.fname=n,e}var PD=w(()=>{"use strict"});function fbe(e){return e.length===1?Csn(e[0]):_sn(e)}var Csn,_sn,dbe=w(()=>{"use strict";Csn=e=>function(t){return t[e]},_sn=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}}});function TB(e){throw Error(e)}var pbe=w(()=>{"use strict"});function Vp(e){var t=[],n=null,r=0,i=e.length,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<i;++a)if(l=e[a],l==="\\")o+=e.substring(s,a),o+=e.substring(++a,++a),s=a;else if(l===n)u(),n=null,r=-1;else{if(n)continue;s===r&&l==='"'||s===r&&l==="'"?(s=a+1,n=l):l==="."&&!r?a>s?u():s=a+1:l==="["?(a>s&&u(),r=s=a+1):l==="]"&&(r||TB("Access path missing open bracket: "+e),r>0&&u(),r=0,s=a+1)}return r&&TB("Access path missing closing bracket: "+e),n&&TB("Access path missing closing quote: "+e),a>s&&(a++,u()),t}var Zq=w(()=>{"use strict";pbe()});function Qq(e,t,n){let r=Vp(e);return e=r.length===1?r[0]:e,jp((n&&n.get||fbe)(r),[e],t||e)}var Jq=w(()=>{"use strict";PD();dbe();Zq()});var kB,Ssn,eH,Esn,Asn,Tsn,ksn,mbe=w(()=>{"use strict";PD();Jq();kB=[],Ssn=Qq("id"),eH=jp(function(e){return e},kB,"identity"),Esn=jp(function(){return 0},kB,"zero"),Asn=jp(function(){return 1},kB,"one"),Tsn=jp(function(){return!0},kB,"true"),ksn=jp(function(){return!1},kB,"false")});function tH(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}function hbe(e,t){var n=e||EJe;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=AJe&&tH(t||"error","ERROR",arguments),this},warn:function(){return n>=nH&&tH(t||"warn","WARN",arguments),this},info:function(){return n>=TJe&&tH(t||"log","INFO",arguments),this},debug:function(){return n>=kJe&&tH(t||"log","DEBUG",arguments),this}}}var EJe,AJe,nH,TJe,kJe,IJe=w(()=>{"use strict";EJe=0,AJe=1,nH=2,TJe=3,kJe=4});var ze,IB=w(()=>{"use strict";ze=Array.isArray});function lr(e){return e===Object(e)}var rH=w(()=>{"use strict"});function DB(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=Isn(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;NB(t,r,n[r],i)}return t},{})}function NB(e,t,n,r){if(DJe(t)){var i,o;if(lr(n)&&!ze(n)){o=lr(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?NB(o,i,n[i]):DJe(i)&&(o[i]=n[i])}else e[t]=n}}function Isn(e,t){if(e==null)return t;let n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}var DJe,NJe=w(()=>{"use strict";IB();rH();DJe=e=>e!=="__proto__"});var LD=w(()=>{"use strict"});var gbe=w(()=>{"use strict"});var FJe=w(()=>{"use strict";mbe();LD();gbe()});var RJe=w(()=>{"use strict"});function _n(e){return e!=null?ze(e)?e:[e]:[]}var oH=w(()=>{"use strict";IB()});var OJe=w(()=>{"use strict"});function FB(e){return typeof e=="function"}var sH=w(()=>{"use strict"});var MJe=w(()=>{"use strict";PD();oH();Jq();sH()});var $Je=w(()=>{"use strict";sH()});var PJe=w(()=>{"use strict"});var LJe=w(()=>{"use strict"});var BJe=w(()=>{"use strict"});var zJe=w(()=>{"use strict"});function zc(e,t){return Fsn.call(e,t)}var Fsn,aH=w(()=>{"use strict";Fsn=Object.prototype.hasOwnProperty});var UJe=w(()=>{"use strict";aH()});var jJe=w(()=>{"use strict";LD()});var VJe=w(()=>{"use strict"});var WJe=w(()=>{"use strict"});function zg(e){return typeof e=="boolean"}var GJe=w(()=>{"use strict"});var xbe=w(()=>{"use strict"});function ur(e){return typeof e=="number"}var bbe=w(()=>{"use strict"});var qJe=w(()=>{"use strict"});function dt(e){return typeof e=="string"}var ybe=w(()=>{"use strict"});var HJe=w(()=>{"use strict";PD();oH();dbe();Zq()});var YJe=w(()=>{"use strict";LD()});var KJe=w(()=>{"use strict";aH()});var XJe=w(()=>{"use strict"});var vbe=w(()=>{"use strict"});var ZJe=w(()=>{"use strict";vbe()});var QJe=w(()=>{"use strict";LD()});function Yt(e){return ze(e)?"["+e.map(Yt)+"]":lr(e)||dt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var JJe=w(()=>{"use strict";IB();rH();ybe()});var eet=w(()=>{"use strict"});var tet=w(()=>{"use strict";xbe();bbe()});var net=w(()=>{"use strict"});function Wp(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}var ret=w(()=>{"use strict"});var iet=w(()=>{"use strict"});var oet=w(()=>{"use strict"});var st=w(()=>{"use strict";PD();mbe();IJe();NJe();FJe();RJe();oH();OJe();MJe();$Je();PJe();pbe();LJe();BJe();zJe();UJe();Jq();jJe();aH();VJe();WJe();IB();GJe();xbe();sH();bbe();rH();qJe();ybe();HJe();YJe();KJe();XJe();ZJe();LD();vbe();QJe();Zq();JJe();eet();tet();gbe();net();ret();iet();oet()});function Le(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var cr=w(()=>{"use strict";});var set=w(()=>{"use strict";Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0})});var aet=Ee((cKr,lH)=>{"use strict";var Msn=function(){"use strict";function e(c,f){return f!=null&&c instanceof f}var t;try{t=Map}catch{t=function(){}}var n;try{n=Set}catch{n=function(){}}var r;try{r=Promise}catch{r=function(){}}function i(c,f,d,p,m){typeof f=="object"&&(d=f.depth,p=f.prototype,m=f.includeNonEnumerable,f=f.circular);var h=[],g=[],x=typeof Buffer<"u";typeof f>"u"&&(f=!0),typeof d>"u"&&(d=1/0);function b(y,v){if(y===null)return null;if(v===0)return y;var C,_;if(typeof y!="object")return y;if(e(y,t))C=new t;else if(e(y,n))C=new n;else if(e(y,r))C=new r(function(M,z){y.then(function(W){M(b(W,v-1))},function(W){z(b(W,v-1))})});else if(i.__isArray(y))C=[];else if(i.__isRegExp(y))C=new RegExp(y.source,u(y)),y.lastIndex&&(C.lastIndex=y.lastIndex);else if(i.__isDate(y))C=new Date(y.getTime());else{if(x&&Buffer.isBuffer(y))return Buffer.allocUnsafe?C=Buffer.allocUnsafe(y.length):C=new Buffer(y.length),y.copy(C),C;e(y,Error)?C=Object.create(y):typeof p>"u"?(_=Object.getPrototypeOf(y),C=Object.create(_)):(C=Object.create(p),_=p)}if(f){var S=h.indexOf(y);if(S!=-1)return g[S];h.push(y),g.push(C)}e(y,t)&&y.forEach(function(M,z){var W=b(z,v-1),H=b(M,v-1);C.set(W,H)}),e(y,n)&&y.forEach(function(M){var z=b(M,v-1);C.add(z)});for(var E in y){var T;_&&(T=Object.getOwnPropertyDescriptor(_,E)),!(T&&T.set==null)&&(C[E]=b(y[E],v-1))}if(Object.getOwnPropertySymbols)for(var I=Object.getOwnPropertySymbols(y),E=0;E<I.length;E++){var k=I[E],O=Object.getOwnPropertyDescriptor(y,k);O&&!O.enumerable&&!m||(C[k]=b(y[k],v-1),O.enumerable||Object.defineProperty(C,k,{enumerable:!1}))}if(m)for(var F=Object.getOwnPropertyNames(y),E=0;E<F.length;E++){var B=F[E],O=Object.getOwnPropertyDescriptor(y,B);O&&O.enumerable||(C[B]=b(y[B],v-1),Object.defineProperty(C,B,{enumerable:!1}))}return C}return b(c,d)}i.clonePrototype=function(f){if(f===null)return null;var d=function(){};return d.prototype=f,new d};function o(c){return Object.prototype.toString.call(c)}i.__objToStr=o;function s(c){return typeof c=="object"&&o(c)==="[object Date]"}i.__isDate=s;function a(c){return typeof c=="object"&&o(c)==="[object Array]"}i.__isArray=a;function l(c){return typeof c=="object"&&o(c)==="[object RegExp]"}i.__isRegExp=l;function u(c){var f="";return c.global&&(f+="g"),c.ignoreCase&&(f+="i"),c.multiline&&(f+="m"),f}return i.__getRegExpFlags=u,i}();typeof lH=="object"&&lH.exports&&(lH.exports=Msn)});var cet=Ee((fKr,uet)=>{"use strict";uet.exports=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!e(t[s],n[s]))return!1}return!0}return t!==t&&n!==n}});var wbe=Ee((dKr,fet)=>{"use strict";fet.exports=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(o){return function(s){return function(a,l){var u={key:a,value:s[a]},c={key:l,value:s[l]};return o(u,c)}}}(t.cmp),i=[];return function o(s){if(s&&s.toJSON&&typeof s.toJSON=="function"&&(s=s.toJSON()),s!==void 0){if(typeof s=="number")return isFinite(s)?""+s:"null";if(typeof s!="object")return JSON.stringify(s);var a,l;if(Array.isArray(s)){for(l="[",a=0;a<s.length;a++)a&&(l+=","),l+=o(s[a])||"null";return l+"]"}if(s===null)return"null";if(i.indexOf(s)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(s)-1,c=Object.keys(s).sort(r&&r(s));for(l="",a=0;a<c.length;a++){var f=c[a],d=o(s[f]);d&&(l&&(l+=","),l+=JSON.stringify(f)+":"+d)}return i.splice(u,1),"{"+l+"}"}}(e)}});function uH(e){return!!e.or}function cH(e){return!!e.and}function fH(e){return!!e.not}function RB(e,t){if(fH(e))RB(e.not,t);else if(cH(e))for(let n of e.and)RB(n,t);else if(uH(e))for(let n of e.or)RB(n,t);else t(e)}function OB(e,t){return fH(e)?{not:OB(e.not,t)}:cH(e)?{and:e.and.map(n=>OB(n,t))}:uH(e)?{or:e.or.map(n=>OB(n,t))}:t(e)}var dH=w(()=>{"use strict"});function gw(e,t){let n={};for(let r of t)zc(e,r)&&(n[r]=e[r]);return n}function Iu(e,t){let n=Object.assign({},e);for(let r of t)delete n[r];return n}function vt(e){if(ur(e))return e;let t=dt(e)?e:(0,pH.default)(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function Cbe(e){return e===!1||e===null}function Ve(e,t){return e.indexOf(t)>-1}function xw(e,t){let n=0;for(let[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function _be(e,t){let n=0;for(let[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function het(e,...t){for(let n of t)$sn(e,n??{});return e}function $sn(e,t){for(let n of pe(t))NB(e,n,t[n],!0)}function Uc(e,t){let n=[],r={},i;for(let o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function get(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function Sbe(e,t){for(let n of e)if(t.has(n))return!0;return!1}function det(e){let t=new Set;for(let n of e){let i=Vp(n).map((s,a)=>a===0?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(let s of o)t.add(s)}return t}function Ebe(e,t){return e===void 0||t===void 0?!0:Sbe(det(e),det(t))}function cn(e){return pe(e).length===0}function MB(e){let t=[];for(let n in e)zc(e,n)&&t.push({key:n,value:e[n]});return t}function $B(e){return e===!0||e===!1}function bn(e){let t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function a2(e,t){return fH(e)?"!("+a2(e.not,t)+")":cH(e)?"("+e.and.map(n=>a2(n,t)).join(") && (")+")":uH(e)?"("+e.or.map(n=>a2(n,t)).join(") || (")+")":t(e)}function mH(e,t){if(t.length===0)return!0;let n=t.shift();return n in e&&mH(e[n],t)&&delete e[n],cn(e)}function l2(e){return e.charAt(0).toUpperCase()+e.substr(1)}function hH(e,t="datum"){let n=Vp(e),r=[];for(let i=1;i<=n.length;i++){let o=`[${n.slice(0,i).map(Yt).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function xet(e,t="datum"){return`${t}[${Yt(Vp(e).join("."))}]`}function Psn(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Du(e){return`${Vp(e).map(Psn).join("\\.")}`}function Ug(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function gH(e){return`${Vp(e).join(".")}`}function BD(e){return e?Vp(e).length:0}function Sn(...e){for(let t of e)if(t!==void 0)return t}function Abe(e){let t=++Lsn;return e?String(e)+t:t}function bet(e){return Bsn(e)?e:`__${e}`}function Bsn(e){return e.indexOf("__")===0}function u2(e){if(e!==void 0)return(e%360+360)%360}function xH(e){return ur(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var pet,met,pH,Lb,at,Gr,pe,Xf,Lsn,Te=w(()=>{"use strict";set();pet=tc(aet()),met=tc(cet()),pH=tc(wbe());st();dH();Lb=met.default,at=pet.default;Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>(0,pH.default)(e)).join(",")})`};Gr=pH.default;pe=Object.keys,Xf=Object.values;Lsn=42});function zD(e){return e&&e.condition}function Ibe(e){return!!vet[e]}var Tbe,yH,yet,kbe,vet,bKr,PB=w(()=>{"use strict";Te();Tbe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};yH=["domain","grid","labels","ticks","title"],yet={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},kbe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},vet=Object.assign(Object.assign({},kbe),{style:1,labelExpr:1,encoding:1});bKr=pe(vet)});function Nu(e){return Ve(["line","area","trail"],e)}function Nbe(e){return Ve(["rect","bar","image","arc"],e)}function ra(e){return e.type}function Ret(e){return ra(e)?e.type:e}var Ml,Dbe,c2,f2,wet,d2,UD,Cet,jD,vH,LB,_et,BB,zB,wH,Fbe,CKr,zsn,Usn,Eet,jsn,Rbe,Aet,Tet,ket,Iet,Det,Net,Fet,Ro=w(()=>{"use strict";st();Te();Ml={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Dbe=Ml.arc,c2=Ml.area,f2=Ml.bar,wet=Ml.image,d2=Ml.line,UD=Ml.point,Cet=Ml.rect,jD=Ml.rule,vH=Ml.text,LB=Ml.tick,_et=Ml.trail,BB=Ml.circle,zB=Ml.square,wH=Ml.geoshape;Fbe=pe(Ml);CKr=Wp(Fbe),zsn=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Usn=["fill","fillOpacity"],Eet=[...zsn,...Usn],jsn={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},Rbe=pe(jsn),Aet={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Tet={color:"#4c78a8",invalid:"filter",timeUnitBand:1},ket={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Iet=5,Det={binSpacing:1,continuousBandSize:Iet,timeUnitBandPosition:.5},Net={binSpacing:0,continuousBandSize:Iet,timeUnitBandPosition:.5},Fet={thickness:1}});function ns(e){return"mark"in e}var bw=w(()=>{"use strict"});var jg,UB=w(()=>{"use strict";Ro();bw();jg=class{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return ns(t)?Ret(t.mark)===this.name:!1}}});function Zf(e){return!!e&&!!e.argmin}function Gp(e){return!!e&&!!e.argmax}function VD(e){return dt(e)&&!!Oet[e]}function CH(e){return dt(e)&&Ve(Wsn,e)}function $et(e){return dt(e)&&Ve(["min","max"],e)}var Oet,Met,IKr,Wsn,Pet,Gsn,Let,Bb=w(()=>{"use strict";st();Te();Oet={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Met={count:1,min:1,max:1};IKr=pe(Oet);Wsn=["count","valid","missing","distinct"];Pet=["count","sum","distinct","valid","missing"],Gsn=["mean","average","median","q1","q3","min","max"],Let=Wp(Gsn)});function Obe(e){return e in Bet}function zet(e){switch(e){case Pl:return"y";case La:return"y2";case Ll:return"x";case ia:return"x2"}}function Uet(e){return e in Mbe}function Ub(e){return e===Yi||e===Ba||e===za}function Get(e){return!!Wet[e]}function AH(e){return!!SH[e]}function TH(e){return Hc(e)!==e}function Hc(e){switch(e){case Ou:return jn;case jc:return qr;case La:return Pl;case ia:return Ll;case Hp:return $l;case qp:return Mu}return e}function Qf(e){if(Obe(e))switch(e){case $l:return"startAngle";case Hp:return"endAngle";case Mu:return"outerRadius";case qp:return"innerRadius"}return e}function Ns(e){switch(e){case jn:return Ou;case qr:return jc;case Pl:return La;case Ll:return ia;case $l:return Hp;case Mu:return qp}}function oa(e){switch(e){case jn:case Ou:return"width";case qr:case jc:return"height"}}function Het(e){switch(e){case jn:return"xOffset";case qr:return"yOffset";case Ou:return"x2Offset";case jc:return"y2Offset";case $l:return"thetaOffset";case Mu:return"radiusOffset";case Hp:return"theta2Offset";case qp:return"radius2Offset"}}function Fs(e){return e in Vg}function yw(e){return e==="width"?jn:qr}function Qet(e){return!!kH[e]}function Jet(e){switch(e){case Yi:case Ba:case za:case $u:case Mi:case Bl:case Gc:case qc:return!0;case Vc:case Wc:case Yp:return!1}}function Ua(e){return!!ett[e]}function ttt(e,t){return Ysn(e)[t]}function Ysn(e){switch(e){case Yi:case Ba:case za:case YD:case h2:case GD:case zb:case qD:case m2:case Bl:case Vc:case Wc:case Gc:case WD:case Fu:case Ru:return Pbe;case jn:case qr:case Pl:case Ll:return Hsn;case Ou:case jc:case La:case ia:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case $u:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case qc:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Mi:return{point:"always",geoshape:"always"};case p2:return{text:"always"};case Yp:return{point:"always",square:"always",text:"always"};case HD:return{image:"always"};case $l:return{text:"always",arc:"always"};case Mu:return{text:"always",arc:"always"};case Hp:case qp:return{arc:"always"}}}function KD(e){switch(e){case jn:case qr:case $l:case Mu:case $u:case Yp:case Gc:case Bl:case Vc:case Wc:case Ou:case jc:case Hp:case qp:return;case WD:case Fu:case Ru:case Mi:case qc:case p2:case zb:case qD:case HD:case YD:return"discrete";case Yi:case Ba:case za:return"flexible";case Pl:case Ll:case La:case ia:case h2:case GD:case m2:return}}var Fu,Ru,WD,jn,qr,Ou,jc,Mu,qp,$l,Hp,Pl,Ll,La,ia,Yi,Ba,za,Mi,$u,Yp,Bl,Vc,Wc,Gc,qc,p2,m2,h2,GD,zb,qD,HD,YD,qsn,Bet,Mbe,jet,_H,Vet,Ds,SH,EH,RKr,OKr,MKr,$be,$Kr,PKr,LKr,Wet,BKr,zKr,qet,UKr,jKr,VKr,WKr,GKr,qKr,HKr,YKr,KKr,XKr,ZKr,QKr,JKr,kH,Yet,Vg,Ki,IH,Ket,eXr,tXr,nXr,rXr,iXr,oXr,sXr,aXr,Xet,Zet,ett,vw,Pbe,lXr,Hsn,St=w(()=>{"use strict";cr();Te();Fu="row",Ru="column",WD="facet",jn="x",qr="y",Ou="x2",jc="y2",Mu="radius",qp="radius2",$l="theta",Hp="theta2",Pl="latitude",Ll="longitude",La="latitude2",ia="longitude2",Yi="color",Ba="fill",za="stroke",Mi="shape",$u="size",Yp="angle",Bl="opacity",Vc="fillOpacity",Wc="strokeOpacity",Gc="strokeWidth",qc="strokeDash",p2="text",m2="order",h2="detail",GD="key",zb="tooltip",qD="href",HD="url",YD="description",qsn={x:1,y:1,x2:1,y2:1},Bet={theta:1,theta2:1,radius:1,radius2:1};Mbe={longitude:1,longitude2:1,latitude:1,latitude2:1};jet=pe(Mbe),_H=Object.assign(Object.assign(Object.assign(Object.assign({},qsn),Bet),Mbe),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});Vet={row:1,column:1,facet:1},Ds=pe(Vet),SH=Object.assign(Object.assign({},_H),Vet),EH=pe(SH),{order:RKr,detail:OKr,tooltip:MKr}=SH,$be=Le(SH,["order","detail","tooltip"]),{row:$Kr,column:PKr,facet:LKr}=$be,Wet=Le($be,["row","column","facet"]),BKr=pe($be),zKr=pe(Wet);qet=[Ou,jc,La,ia,Hp,qp];UKr=pe(_H),{x:jKr,y:VKr,x2:WKr,y2:GKr,latitude:qKr,longitude:HKr,latitude2:YKr,longitude2:KKr,theta:XKr,theta2:ZKr,radius:QKr,radius2:JKr}=_H,kH=Le(_H,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Yet=pe(kH),Vg={x:1,y:1},Ki=pe(Vg);IH={theta:1,radius:1},Ket=pe(IH);({text:eXr,tooltip:tXr,href:nXr,url:rXr,description:iXr,detail:oXr,key:sXr,order:aXr}=kH),Xet=Le(kH,["text","tooltip","href","url","description","detail","key","order"]),Zet=pe(Xet);ett=Object.assign(Object.assign(Object.assign({},Vg),IH),Xet),vw=pe(ett);Pbe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:lXr}=Pbe,Hsn=Le(Pbe,["geoshape"])});function DH(e){return zg(e)&&(e=ZD(e,void 0)),"bin"+pe(e).map(t=>XD(e[t])?bn(`_${t}_${Object.entries(e[t])}`):bn(`_${t}_${e[t]}`)).join("")}function mn(e){return e===!0||ww(e)&&!e.binned}function Ai(e){return e==="binned"||ww(e)&&e.binned===!0}function ww(e){return lr(e)}function XD(e){return e?.selection}function Lbe(e){switch(e){case Fu:case Ru:case $u:case Yi:case Ba:case za:case Gc:case Bl:case Vc:case Wc:case Mi:return 6;case qc:return 4;default:return 10}}var sa=w(()=>{"use strict";st();St();Tt();Te()});var he={};rn(he,{CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:()=>$an,CONCAT_CANNOT_SHARE_AXIS:()=>fan,FACETED_INDEPENDENT_DIFFERENT_SOURCES:()=>Jan,FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES:()=>eln,FACETED_INDEPENDENT_SAME_SOURCE:()=>tln,FIT_NON_SINGLE:()=>Zsn,INVALID_CHANNEL_FOR_AXIS:()=>nln,LEGEND_BINDINGS_PROJECT_LENGTH:()=>aan,LINE_WITH_VARYING_SIZE:()=>kan,MORE_THAN_ONE_SORT:()=>Qan,NO_FIELDS_NEEDS_AS:()=>han,RANGE_STEP_DEPRECATED:()=>Pan,REPLACE_ANGLE_WITH_THETA:()=>yan,SCALE_BINDINGS_CONTINUOUS:()=>san,cannotApplySizeToNonOrientedMark:()=>jan,cannotProjectAggregate:()=>nan,cannotProjectOnChannelWithoutField:()=>tan,cannotStackNonLinearScale:()=>iln,cannotStackRangedMark:()=>rln,cannotUseScalePropertyWithNonColor:()=>Lan,channelRequiredForBinned:()=>pln,columnsNotSupportByRowCol:()=>can,containerSizeNonSingle:()=>Qsn,containerSizeNotCompatibleWithAutosize:()=>Jsn,customFormatTypeNotAllowed:()=>gan,differentParse:()=>pan,discreteChannelCannotEncode:()=>Ran,domainRequiredForThresholdScale:()=>mln,domainSortDropped:()=>Zan,droppedDay:()=>aln,droppingColor:()=>Ean,droppingFit:()=>ean,emptyFieldDef:()=>Aan,encodingOverridden:()=>xan,errorBand1DNotSupport:()=>dln,errorBarCenterAndExtentAreNotNeeded:()=>lln,errorBarCenterIsNotNeeded:()=>fln,errorBarCenterIsUsedWithWrongExtent:()=>uln,errorBarContinuousAxisHasCustomizedAggregate:()=>cln,facetChannelDropped:()=>Fan,facetChannelShouldBeDiscrete:()=>Nan,incompatibleChannel:()=>Ian,independentScaleMeansIndependentGuide:()=>Xan,invalidAggregate:()=>_an,invalidEncodingChannel:()=>Dan,invalidFieldType:()=>wan,invalidFieldTypeForCountAggregate:()=>Can,invalidSpec:()=>Xsn,invalidTimeUnit:()=>sln,invalidTransformIgnored:()=>man,latLongDeprecated:()=>Tan,lineWithRange:()=>Oan,mergeConflictingDomainProperty:()=>Kan,mergeConflictingProperty:()=>Yan,missingFieldType:()=>San,nearestNotSupportForContinuous:()=>ran,noSameUnitLookup:()=>lan,noSuchRepeatedValue:()=>uan,orientOverridden:()=>Man,primitiveChannelDef:()=>van,projectionOverridden:()=>ban,scalePropertyNotWorkWithScaleType:()=>Gan,scaleTypeNotWorkWithChannel:()=>Van,scaleTypeNotWorkWithFieldDef:()=>Wan,scaleTypeNotWorkWithMark:()=>qan,selectionNotFound:()=>oan,selectionNotSupported:()=>ian,stackNonSummativeAggregate:()=>oln,stepDropped:()=>Han,unaggregateDomainHasNoEffectForRawField:()=>Ban,unaggregateDomainWithNonSharedDomainOp:()=>zan,unaggregatedDomainWithLogScale:()=>Uan,unrecognizedParse:()=>dan});function Xsn(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}function Qsn(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function Jsn(e){let t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function ean(e){return e?`Dropping "fit-${e}" because spec has discrete ${oa(e)}.`:'Dropping "fit" because spec has discrete size.'}function tan(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function nan(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function ran(e){return`The "nearest" transform is not supported for ${e} marks.`}function ian(e){return`Selection not supported for ${e} yet.`}function oan(e){return`Cannot find a selection named "${e}".`}function lan(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function uan(e){return`Unknown repeated value "${e}".`}function can(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function dan(e){return`Unrecognized parse "${e}".`}function pan(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function man(e){return`Ignoring an invalid transform: ${Gr(e)}.`}function gan(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function xan(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function ban(e){let{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Gr(t)} is overridden by a child projection ${Gr(n)}.`}function van(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Gr(n)}}.`}function wan(e){return`Invalid field type "${e}".`}function Can(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function _an(e){return`Invalid aggregation operator "${e}".`}function San(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function Ean(e,t){let{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Aan(e,t){return`Dropping ${Gr(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function Tan(e,t,n){return`${e}-encoding with type ${t} is deprecated. Replacing with ${n}-encoding.`}function Ian(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function Dan(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Nan(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Fan(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Ran(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Oan(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Man(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Lan(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Ban(e){return`Using unaggregated domain with raw field has no effect (${Gr(e)}).`}function zan(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Uan(e){return`Unaggregated domain is currently unsupported for log scale (${Gr(e)}).`}function jan(e){return`Cannot apply size to non-oriented mark "${e}".`}function Van(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function Wan(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Gan(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function qan(e,t){return`Scale type "${t}" does not work with mark "${e}".`}function Han(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Yan(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Gr(n)} and ${Gr(r)}). Using ${Gr(n)}.`}function Kan(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Gr(n)} and ${Gr(r)}). Using the union of the two domains.`}function Xan(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Zan(e){return`Dropping sort property ${Gr(e)} as unioned domains only support boolean or op "count", "min", and "max".`}function rln(e){return`Cannot stack "${e}" if there is already "${e}2".`}function iln(e){return`Cannot stack non-linear scale (${e}).`}function oln(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function sln(e,t){return`Invalid ${e}: ${Gr(t)}.`}function aln(e){return`Dropping day from datetime ${Gr(e)} as day cannot be combined with other units.`}function lln(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function uln(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function cln(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function fln(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function dln(e){return`1D error band does not support ${e}.`}function pln(e){return`Channel ${e} is required for "binned" bin.`}function mln(e){return`Domain for ${e} is required for threshold scale.`}var Zsn,san,aan,fan,han,yan,kan,$an,Pan,Qan,Jan,eln,tln,nln,ntt=w(()=>{"use strict";St();Te();Zsn='Autosize "fit" only works for single views and layered views.';san="Scale bindings are currently only supported for scales with unbinned, continuous domains.",aan="Legend bindings are only supported for selections over an individual field or encoding channel.";fan="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";han='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';yan="Arc marks uses theta channel rather than angle, replacing angle with theta.";kan="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";$an="Custom domain scale cannot be unioned with default field-based domain.",Pan=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;Qan="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Jan="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",eln="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",tln="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",nln="Invalid channel for axis."});function itt(e){return QD=e,QD}function ott(){return QD=rtt,QD}function xe(...e){QD.warn(...e)}function stt(...e){QD.debug(...e)}var rtt,QD,nn=w(()=>{"use strict";st();ntt();rtt=hbe(nH),QD=rtt});function Wg(e){if(e&&lr(e)){for(let t of NH)if(t in e)return!0}return!1}function xln(e){if(xH(e)&&(e=+e),ur(e))return e>4&&xe(he.invalidTimeUnit("quarter",e)),e-1;throw new Error(he.invalidTimeUnit("quarter",e))}function bln(e){if(xH(e)&&(e=+e),ur(e))return e-1;{let t=e.toLowerCase(),n=att.indexOf(t);if(n!==-1)return n;let r=t.substr(0,3),i=hln.indexOf(r);if(i!==-1)return i;throw new Error(he.invalidTimeUnit("month",e))}}function yln(e){if(xH(e)&&(e=+e),ur(e))return e%7;{let t=e.toLowerCase(),n=ltt.indexOf(t);if(n!==-1)return n;let r=t.substr(0,3),i=gln.indexOf(r);if(i!==-1)return i;throw new Error(he.invalidTimeUnit("day",e))}}function Bbe(e,t){let n=[];if(t&&e.day!==void 0&&pe(e).length>1&&(xe(he.droppedDay(e)),e=at(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){let r=t?bln(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){let r=t?xln(e.quarter):e.quarter;n.push(ur(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){let r=t?yln(e.day):e.day;n.push(ur(r)?r+1:r+"+1")}else n.push(1);for(let r of["hours","minutes","seconds","milliseconds"]){let i=e[r];n.push(typeof i>"u"?0:i)}return n}function Cw(e){let n=Bbe(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function utt(e){let n=Bbe(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function ctt(e){let t=Bbe(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var att,hln,ltt,gln,JD=w(()=>{"use strict";st();nn();Gg();Te();att=["january","february","march","april","may","june","july","august","september","october","november","december"],hln=att.map(e=>e.substr(0,3)),ltt=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],gln=ltt.map(e=>e.substr(0,3))});function dtt(e){return!!ftt[e]}function Ube(e){return e.startsWith("utc")}function vln(e){return e.substr(3)}function jB(e){let t=[];for(let n of NH)ptt(e,n)&&t.push(n);return t}function ptt(e,t){let n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function mtt(e,t,{end:n}={end:!1}){let r=hH(t),i=Ube(e)?"utc":"";function o(l){return l==="quarter"?`(${i}quarter(${r})-1)`:`${i}${l}(${r})`}let s,a={};for(let l of NH)ptt(e,l)&&(a[l]=o(l),s=l);return n&&(a[s]+="+1"),utt(a)}function jbe(e){if(!e)return;let t=jB(e);return`timeUnitSpecifier(${(0,zbe.default)(t)}, ${(0,zbe.default)(wln)})`}function htt(e,t,n){if(!e)return;let r=jbe(e);return`${n||Ube(e)?"utc":"time"}Format(${t}, ${r})`}function $i(e){if(!e)return;let t;return dt(e)?t={unit:e}:lr(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),Ube(t.unit)&&(t.utc=!0,t.unit=vln(t.unit)),t}function gtt(e){let t=$i(e),{utc:n}=t,r=Le(t,["utc"]);return r.unit?(n?"utc":"")+pe(r).map(i=>bn(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+pe(r).map(i=>bn(`_${i}_${r[i]}`)).join("")}var zbe,ftt,NH,wln,Gg=w(()=>{"use strict";cr();zbe=tc(wbe());st();JD();Te();ftt={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},NH=pe(ftt);wln={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "}});function rt(e){return e&&!!e.signal}function ja(e){return!!e.step}function xtt(e){return ze(e)?!1:"fields"in e&&!("data"in e)}function btt(e){return ze(e)?!1:"fields"in e&&"data"in e}function jb(e){return ze(e)?!1:"field"in e&&"data"in e}var Cln,ytt,vtt,FH,er=w(()=>{"use strict";st();Te();Cln={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},ytt=pe(Cln),vtt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},FH=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"]});function wtt(e){return e?.selection}function RH(e){return e&&!!e.field&&e.equal!==void 0}function Ctt(e){return e&&!!e.field&&e.lt!==void 0}function _tt(e){return e&&!!e.field&&e.lte!==void 0}function Stt(e){return e&&!!e.field&&e.gt!==void 0}function Ett(e){return e&&!!e.field&&e.gte!==void 0}function OH(e){if(e&&e.field){if(ze(e.range)&&e.range.length===2)return!0;if(rt(e.range))return!0}return!1}function MH(e){return e&&!!e.field&&(ze(e.oneOf)||ze(e.in))}function _ln(e){return e&&!!e.field&&e.valid!==void 0}function Vbe(e){return MH(e)||RH(e)||OH(e)||Ctt(e)||Stt(e)||_tt(e)||Ett(e)}function qg(e,t){return WB(e,{timeUnit:t,wrapTime:!0})}function Sln(e,t){return e.map(n=>qg(n,t))}function $H(e,t=!0){var n;let{field:r}=e,i=(n=$i(e.timeUnit))===null||n===void 0?void 0:n.unit,o=i?"time("+mtt(i,r)+")":Ie(e,{expr:"datum"});if(RH(e))return o+"==="+qg(e.equal,i);if(Ctt(e)){let s=e.lt;return`${o}<${qg(s,i)}`}else if(Stt(e)){let s=e.gt;return`${o}>${qg(s,i)}`}else if(_tt(e)){let s=e.lte;return`${o}<=${qg(s,i)}`}else if(Ett(e)){let s=e.gte;return`${o}>=${qg(s,i)}`}else{if(MH(e))return`indexof([${Sln(e.oneOf,i).join(",")}], ${o}) !== -1`;if(_ln(e))return VB(o,e.valid);if(OH(e)){let{range:s}=e,a=rt(s)?{signal:`${s.signal}[0]`}:s[0],l=rt(s)?{signal:`${s.signal}[1]`}:s[1];if(a!==null&&l!==null&&t)return"inrange("+o+", ["+qg(a,i)+", "+qg(l,i)+"])";let u=[];return a!==null&&u.push(`${o} >= ${qg(a,i)}`),l!==null&&u.push(`${o} <= ${qg(l,i)}`),u.length>0?u.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function VB(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Att(e){var t;return Vbe(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=$i(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}var g2=w(()=>{"use strict";st();Tt();Gg();er()});function ktt(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Jf:return"quantitative";case"t":case Hg:return"temporal";case"o":case GB:return"ordinal";case"n":case qB:return"nominal";case Kp:return"geojson"}}var eN,Jf,GB,Hg,qB,Kp,Ttt,Yc=w(()=>{"use strict";Te();eN={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Jf=eN.quantitative,GB=eN.ordinal,Hg=eN.temporal,qB=eN.nominal,Kp=eN.geojson,Ttt=pe(eN)});function Itt(e,t){let n=Wbe[e],r=Wbe[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}function Gbe(e){return Aln[e]}function Ntt(e){return e in Iln}function Ti(e){return e in Mln}function Oo(e){return e in Rln}function Pu(e){return e in Tln}function tN(e){return e in Nln}function Rtt(e){return!dt(e)&&!!e.name}function qbe(e){return e?.selection}function Ott(e){return e&&e.unionWith}function PH(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Ve(["point","band","identity"],e);case"bins":return!Ve(["point","band","identity","ordinal"],e);case"round":return Pu(e)||e==="band"||e==="point";case"padding":return Pu(e)||Ve(["point","band"],e);case"paddingOuter":case"align":return Ve(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Pu(e);case"nice":return Pu(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Oo(e)&&!Ve(["log","time","utc","threshold","quantile"],e)}}function LH(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Ub(e)?void 0:he.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function Ybe(e,t){return Ve([GB,qB],t)?e===void 0||Ti(e):t===Hg?Ve([fi.TIME,fi.UTC,void 0],e):t===Jf?Ve([fi.LOG,fi.POW,fi.SQRT,fi.SYMLOG,fi.QUANTILE,fi.QUANTIZE,fi.THRESHOLD,fi.LINEAR,void 0],e):!0}function Kbe(e,t){if(!Ua(e))return!1;switch(e){case jn:case qr:case $l:case Mu:return Pu(t)||Ve(["band","point"],t);case $u:case Gc:case Bl:case Vc:case Wc:case Yp:return Pu(t)||tN(t)||Ve(["band","point","ordinal"],t);case Yi:case Ba:case za:return t!=="band";case qc:return t==="ordinal"||tN(t);case Mi:return t==="ordinal"}}function Pln(){var e;let t={};for(let n of EH)for(let r of Ttt)for(let i of Eln){let o=Lln(n,r);Kbe(n,i)&&Ybe(i,r)&&(t[o]=(e=t[o])!==null&&e!==void 0?e:[],t[o].push(i))}return t}function Lln(e,t){return e+"_"+t}var fi,Wbe,Eln,Aln,Dtt,Tln,kln,Iln,Dln,Nln,Fln,Rln,Oln,Mln,Ftt,Hbe,UXr,jXr,VXr,WXr,GXr,$ln,Mtt,qXr,ti=w(()=>{"use strict";cr();st();St();St();nn();Yc();Te();fi={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},Wbe={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},Eln=pe(Wbe);Aln={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};Dtt=["linear","log","pow","sqrt","symlog","time","utc"],Tln=Wp(Dtt),kln=["linear","log","pow","sqrt","symlog"],Iln=Wp(kln);Dln=["quantile","quantize","threshold"],Nln=Wp(Dln),Fln=Dtt.concat(["quantile","quantize","threshold","sequential","identity"]),Rln=Wp(Fln),Oln=["ordinal","bin-ordinal","point","band"],Mln=Wp(Oln);Ftt={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};Hbe={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},UXr=pe(Hbe),{type:jXr,domain:VXr,range:WXr,scheme:GXr}=Hbe,$ln=Le(Hbe,["type","domain","range","scheme"]),Mtt=pe($ln),qXr=Pln()});function rN(e){let{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,s=Zbe(e);return Re(n)&&!CH(n.aggregate)&&i&&Pu(i.get("type"))&&i.get("zero")===!1?Xbe({fieldDef:n,channel:t,markDef:r,ref:s,config:o}):s}function Xbe({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Nu(n.type)||en("invalid",n,i)===null?r:[Bln(e,t),r]}function Bln(e,t){let n=HB(e,!0),i=Hc(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function HB(e,t=!0){return VB(dt(e)?e:Ie(e,{expr:"datum"}),!t)}function $tt(e){let{datum:t}=e;return Wg(t)?Cw(t):`${JSON.stringify(t)}`}function Yg(e,t,n,r){let i={};if(t&&(i.scale=t),Lu(e)){let{datum:o}=e;Wg(o)?i.signal=Cw(o):rt(o)?i.signal=o.signal:i.value=o}else i.field=Ie(e,n);if(r){let{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function nN({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:o=.5}){let s=0<o&&o<1?"datum":void 0,a=Ie(t,{expr:s,suffix:i}),l=n!==void 0?Ie(n,{expr:s}):Ie(t,{suffix:"end",expr:s}),u={};if(o===0||o===1){u.scale=e;let c=o===0?a:l;u.field=c}else{let c=`${o} * ${a} + ${1-o} * ${l}`;u.signal=`scale("${e}", ${c})`}return r&&(u.offset=r),u}function Zbe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:l,defaultRef:u,band:c}){var f;if(t){if(It(t)){if(Mo(t)){c=c??Sw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:a,config:i,isMidPoint:!0});let{bin:p,timeUnit:m,type:h}=t;if(mn(p)||c&&m&&h===Hg)return a&&a.impute?Yg(t,o,{binSuffix:"mid"},{offset:l}):c?nN({scaleName:o,fieldOrDatumDef:t,band:c,offset:l}):Yg(t,o,Kg(t,e)?{binSuffix:"range"}:{},{offset:l});if(Ai(p)){if(Re(n))return nN({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:l});{let g=e===jn?Ou:jc;xe(he.channelRequiredForBinned(g))}}}let d=s?.get("type");return Yg(t,o,Ti(d)?{binSuffix:"range"}:{},{offset:l,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Va(t)){let d=t.value,p=l?{offset:l}:{};return Object.assign(Object.assign({},x2(e,d)),p)}}return FB(u)&&(u=u()),u&&Object.assign(Object.assign({},u),l?{offset:l}:{})}function x2(e,t){return Ve(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Ve(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:tr(t)}var _w=w(()=>{"use strict";st();Bb();sa();St();Tt();JD();nn();Ro();g2();ti();Yc();Te();er();Cr()});function Zg(e){return e&&e!=="number"&&e!=="time"}function Ltt(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}function iN({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var s,a;if(Zg(n))return YB({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});let l=Btt(e,r,i);if(aN(e)){let u=jln(l,Re(e)?(s=$i(e.timeUnit))===null||s===void 0?void 0:s.unit:void 0,t,o.timeFormat,sN(e)&&((a=e.scale)===null||a===void 0?void 0:a.type)===fi.UTC);return u?{signal:u}:void 0}if(t=ztt(Xg(e),t,o),Re(e)&&mn(e.bin)){let u=Ie(e,{expr:r,binSuffix:"end"});return{signal:oN(l,u,t,n,o)}}else return t||Xg(e)==="quantitative"?{signal:`${Utt(l,t)}`}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function Btt(e,t,n){return Re(e)?n?`${Ie(e,{expr:t,suffix:"end"})}-${Ie(e,{expr:t,suffix:"start"})}`:Ie(e,{expr:t}):$tt(e)}function YB({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(s=s??Btt(e,r,i),Re(e)&&mn(e.bin)){let a=Ie(e,{expr:r,binSuffix:"end"});return{signal:oN(s,a,t,n,o)}}return{signal:Ltt(n,s,t)}}function zH(e,t,n,r,i,o){var s;if(!Zg(r)){if(aN(e)){let a=Re(e)?(s=$i(e.timeUnit))===null||s===void 0?void 0:s.unit:void 0;return Uln(n,a,i,o)}return ztt(t,n,i)}}function UH(e,t,n){if(e&&(rt(e)||e==="number"||e==="time"))return e;if(aN(t)&&n!=="time"&&n!=="utc")return"time"}function ztt(e,t,n){if(dt(t))return t;if(e===Jf)return n.numberFormat}function Uln(e,t,n,r){return e||(t?{signal:jbe(t)}:r?void 0:n.timeFormat)}function Utt(e,t){return`format(${e}, "${t||""}")`}function Ptt(e,t,n,r){var i;return Zg(n)?Ltt(n,e,t):Utt(e,(i=dt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function oN(e,t,n,r,i){let o=Ptt(e,n,r,i),s=Ptt(t,n,r,i);return`${VB(e,!1)} ? "null" : ${o} + "${zln}" + ${s}`}function jln(e,t,n,r,i){return!t||n?(n=dt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):htt(t,e,i)}var zln,Qg=w(()=>{"use strict";st();sa();Tt();g2();ti();Gg();Yc();er();_w();zln=" \u2013 "});function Qbe(e){return e in Vln}function jH(e){return!!e&&!!e.encoding}function Rs(e){return!!e&&(e.op==="count"||!!e.field)}function VH(e){return!!e&&ze(e)}var Ew,Vln,Xp=w(()=>{"use strict";st();Ew="min",Vln={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1}});function Jg(e){return"row"in e||"column"in e}function WH(e){return!!e&&"header"in e}function Vb(e){return"facet"in e}var Wb=w(()=>{"use strict"});function jtt(e){return e.selection}function Vtt(e){return e&&!dt(e)&&"repeat"in e}function Jbe(e){let{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function eye(e){return Mo(e)&&"sort"in e}function Sw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:o,isMidPoint:s}){if(It(t)&&t.band!==void 0)return t.band;if(Re(t)){let{timeUnit:a,bin:l}=t;if(a&&!n)return s?e0("timeUnitBandPosition",r,o):Nbe(r.type)?e0("timeUnitBand",r,o):0;if(mn(l))return Nbe(r.type)&&!s?1:.5}if(i?.fieldChannel===e&&s)return .5}function lN(e,t,n,r,i,o){return mn(t.bin)||t.timeUnit&&Mo(t)&&t.type==="temporal"?!!Sw({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:o}):!1}function uN(e){return!!e&&"condition"in e}function cN(e){let t=e&&e.condition;return!!t&&!ze(t)&&Re(t)}function qH(e){let t=e&&e.condition;return!!t&&!ze(t)&&It(t)}function Wtt(e){let t=e&&e.condition;return!!t&&(ze(t)||Va(t))}function Re(e){return!!e&&(!!e.field||e.aggregate==="count")}function Xg(e){return e&&e.type}function Lu(e){return!!e&&"datum"in e}function Bu(e){return Mo(e)&&Htt(e)||HH(e)}function HH(e){return Lu(e)&&ur(e.datum)}function It(e){return Re(e)||Lu(e)}function Mo(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Va(e){return e&&"value"in e&&"value"in e}function sN(e){return!!e&&("scale"in e||"sort"in e)}function YH(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Gtt(e){return!!e&&"legend"in e}function qtt(e){return!!e&&("format"in e||"formatType"in e)}function Wln(e){return"op"in e}function Ie(e,t={}){var n,r,i;let o=e.field,s=t.prefix,a=t.suffix,l="";if(Gln(e))o=bet("count");else{let u;if(!t.nofn)if(Wln(e))u=e.op;else{let{bin:c,aggregate:f,timeUnit:d}=e;mn(c)?(u=DH(c),a=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Gp(f)?(l=`["${o}"]`,o=`argmax_${f.argmax}`):Zf(f)?(l=`["${o}"]`,o=`argmin_${f.argmin}`):u=String(f):d&&(u=gtt(d),a=(!Ve(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}u&&(o=o?`${u}_${o}`:u)}return a&&(o=`${o}_${a}`),s&&(o=`${s}_${o}`),t.forAs?gH(o):t.expr?xet(o,t.expr)+l:Du(o)+l}function tye(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Re(e)&&!!e.bin;case"temporal":return!1}throw new Error(he.invalidFieldType(e.type))}function Htt(e){return!tye(e)}function Gln(e){return e.aggregate==="count"}function qln(e,t){var n;let{field:r,bin:i,timeUnit:o,aggregate:s}=e;if(s==="count")return t.countTitle;if(mn(i))return`${r} (binned)`;if(o){let a=(n=$i(o))===null||n===void 0?void 0:n.unit;if(a)return`${r} (${jB(a).join("-")})`}else if(s)return Gp(s)?`${r} for max ${s.argmax}`:Zf(s)?`${r} for min ${s.argmin}`:`${l2(s)} of ${r}`;return r}function Hln(e){let{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Gp(t))return`${i} for argmax(${t.argmax})`;if(Zf(t))return`${i} for argmin(${t.argmin})`;let o=$i(r),s=t||o?.unit||o?.maxbins&&"timeunit"||mn(n)&&"bin";return s?s.toUpperCase()+"("+i+")":i}function nye(e){Ktt=e}function Xtt(){nye(Ytt)}function ed(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,o;let a=((i=KH(e))!==null&&i!==void 0?i:{}).title;if(!Re(e))return a;let l=e,u=r?rye(l,t):void 0;return n?Sn(a,l.title,u):(o=a??l.title)!==null&&o!==void 0?o:u}function KH(e){if(YH(e)&&e.axis)return e.axis;if(Gtt(e)&&e.legend)return e.legend;if(WH(e)&&e.header)return e.header}function rye(e,t){return Ktt(e,t)}function fN(e){var t;if(qtt(e)){let{format:n,formatType:r}=e;return{format:n,formatType:r}}else{let n=(t=KH(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function Yln(e,t){if(e.timeUnit)return"temporal";if(mn(e.bin))return"quantitative";switch(KD(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function aa(e){if(Re(e))return e;if(cN(e))return e.condition}function gr(e){if(It(e))return e;if(qH(e))return e.condition}function KB(e,t,n){if(dt(e)||ur(e)||zg(e)){let r=dt(e)?"string":ur(e)?"number":"boolean";return xe(he.primitiveChannelDef(t,r,e)),{value:e}}return It(e)?GH(e,t,n):qH(e)?Object.assign(Object.assign({},e),{condition:GH(e.condition,t,n)}):e}function GH(e,t,n){if(qtt(e)){let{format:r,formatType:i}=e,o=Le(e,["format","formatType"]);if(Zg(i)&&!n.customFormatTypes)return xe(he.customFormatTypeNotAllowed(t)),GH(o,t,n)}else{let r=YH(e)?"axis":Gtt(e)?"legend":WH(e)?"header":null;if(r&&e[r]){let i=e[r],{format:o,formatType:s}=i,a=Le(i,["format","formatType"]);if(Zg(s)&&!n.customFormatTypes)return xe(he.customFormatTypeNotAllowed(t)),GH(Object.assign(Object.assign({},e),{[r]:a}),t,n)}}return Re(e)?iye(e,t):Kln(e)}function Kln(e){let t=e.type;if(t)return e;let{datum:n}=e;return t=ur(n)?"quantitative":dt(n)?"nominal":Wg(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function iye(e,t){let{aggregate:n,timeUnit:r,bin:i,field:o}=e,s=Object.assign({},e);if(n&&!VD(n)&&!Gp(n)&&!Zf(n)&&(xe(he.invalidAggregate(n)),delete s.aggregate),r&&(s.timeUnit=$i(r)),o&&(s.field=`${o}`),mn(i)&&(s.bin=ZD(i,t)),Ai(i)&&!Fs(t)&&xe(`Channel ${t} should not be used with "binned" bin.`),Mo(s)){let{type:a}=s,l=ktt(a);a!==l&&(s.type=l),a!=="quantitative"&&CH(n)&&(xe(he.invalidFieldTypeForCountAggregate(a,n)),s.type="quantitative")}else if(!TH(t)){let a=Yln(s,t);xe(he.missingFieldType(t,a)),s.type=a}if(Mo(s)){let{compatible:a,warning:l}=Xln(s,t);a||xe(l)}if(eye(s)&&dt(s.sort)){let{sort:a}=s;if(Qbe(a))return Object.assign(Object.assign({},s),{sort:{encoding:a}});let l=a.substr(1);if(a.charAt(0)==="-"&&Qbe(l))return Object.assign(Object.assign({},s),{sort:{encoding:l,order:"descending"}})}if(WH(s)){let{header:a}=s,{orient:l}=a,u=Le(a,["orient"]);if(l)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},u),{labelOrient:a.labelOrient||l,titleOrient:a.titleOrient||l})})}return s}function ZD(e,t){return zg(e)?{maxbins:Lbe(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:Lbe(t)}):e}function Xln(e,t){let n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Fu:case Ru:case WD:return Htt(e)?{compatible:!1,warning:he.facetChannelShouldBeDiscrete(t)}:b2;case jn:case qr:case Yi:case Ba:case za:case p2:case h2:case GD:case zb:case qD:case HD:case Yp:case $l:case Mu:case YD:return b2;case Ll:case ia:case Pl:case La:return n!==Jf?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:b2;case Bl:case Vc:case Wc:case Gc:case $u:case Hp:case qp:case Ou:case jc:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:b2;case qc:return Ve(["ordinal","nominal"],e.type)?b2:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case Mi:return Ve(["ordinal","nominal","geojson"],e.type)?b2:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case m2:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:b2}}function aN(e){let{formatType:t}=fN(e);return t==="time"||!t&&Zln(e)}function Zln(e){return e&&(e.type==="temporal"||Re(e)&&!!e.timeUnit)}function WB(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;let s=t&&((o=$i(t))===null||o===void 0?void 0:o.unit),a=s||n==="temporal",l;return rt(e)?l=e.signal:Wg(e)?(a=!0,l=Cw(e)):(dt(e)||ur(e))&&a&&(l=`datetime(${JSON.stringify(e)})`,dtt(s)&&(ur(e)&&e<1e4||dt(e)&&isNaN(Date.parse(e)))&&(l=Cw({[s]:e}))),l?r&&a?`time(${l})`:l:i?void 0:JSON.stringify(e)}function XH(e,t){let{type:n}=e;return t.map(r=>{let i=WB(r,{timeUnit:Re(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Kg(e,t){return mn(e.bin)?Ua(t)&&Ve(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}var Ytt,Ktt,b2,Tt=w(()=>{"use strict";cr();st();Bb();sa();St();Cr();Qg();JD();nn();Ro();Xp();Wb();Gg();Yc();Te();er();Ytt=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Hln(e);default:return qln(e,t)}},Ktt=Ytt;b2={compatible:!0}});function ZH(e){let{anchor:t,frame:n,offset:r,orient:i,color:o,subtitleColor:s,subtitleFont:a,subtitleFontSize:l,subtitleFontStyle:u,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,p=Le(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),o?{fill:o}:{}),h=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{subtitleColor:s}:{}),a?{subtitleFont:a}:{}),l?{subtitleFontSize:l}:{}),u?{subtitleFontStyle:u}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),x=gw(m,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:x,nonMark:h,subtitle:g}}function Zp(e){return dt(e)||ze(e)&&dt(e[0])}var XB=w(()=>{"use strict";cr();st();Te()});function tr(e){return rt(e)?e:e!==void 0?{value:e}:void 0}function oye(e){return rt(e)?e.signal:Yt(e.value)}function Aw(e){return rt(e)?e.signal:e==null?null:Yt(e)}function Ztt(e,t,n){for(let r of n){let i=e0(r,t.markDef,t.config);i!==void 0&&(e[r]=tr(i))}return e}function sye(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function en(e,t,n,r={}){let{vgChannel:i,ignoreVgConfig:o}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:o&&(!i||i===e)?void 0:e0(e,t,n,r)}function e0(e,t,n,{vgChannel:r}={}){return Sn(r?ZB(e,t,n.style):void 0,ZB(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function ZB(e,t,n){return aye(e,sye(t),n)}function aye(e,t,n){t=_n(t);let r;for(let i of t){let o=n[i];o&&o[e]!==void 0&&(r=o[e])}return r}function QH(e,t){return _n(e).reduce((n,r)=>{var i;return n.field.push(Ie(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function lye(e,t){let n=[...e];return t.forEach(r=>{for(let i of n)if(Lb(i,r))return;n.push(r)}),n}function uye(e,t){return Lb(e,t)||!t?e:e?[..._n(e),..._n(t)].join(", "):t}function JH(e,t){let n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Zp(n)||rt(n))&&(Zp(r)||rt(r)))return{explicit:e.explicit,value:uye(n,r)};if(Zp(n)||rt(n))return{explicit:e.explicit,value:n};if(Zp(r)||rt(r))return{explicit:e.explicit,value:r};if(!Zp(n)&&!rt(n)&&!Zp(r)&&!rt(r))return{explicit:e.explicit,value:lye(n,r)};throw new Error("It should never reach here")}var Cr=w(()=>{"use strict";st();Tt();XB();Te();er()});function t0(e,t){let n=e&&e[t];return n?ze(n)?xw(n,r=>!!r.field):Re(n)||cN(n):!1}function dN(e){return xw(EH,t=>{if(t0(e,t)){let n=e[t];if(ze(n))return xw(n,r=>!!r.aggregate);{let r=aa(n);return r&&!!r.aggregate}}return!1})}function pN(e,t){let n=[],r=[],i=[],o=[],s={};return QB(e,(a,l)=>{if(Re(a)){let{field:u,aggregate:c,bin:f,timeUnit:d}=a,p=Le(a,["field","aggregate","bin","timeUnit"]);if(c||d||f){let m=KH(a),h=m&&m.title,g=Ie(a,{forAs:!0}),x=Object.assign(Object.assign(Object.assign({},h?[]:{title:ed(a,t,{allowDisabling:!0})}),p),{field:g});if(c){let b;if(Gp(c)?(b="argmax",g=Ie({op:"argmax",field:c.argmax},{forAs:!0}),x.field=`${g}.${u}`):Zf(c)?(b="argmin",g=Ie({op:"argmin",field:c.argmin},{forAs:!0}),x.field=`${g}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(b=c),b){let y={op:b,as:g};u&&(y.field=u),o.push(y)}}else if(n.push(g),Mo(a)&&mn(f)){if(r.push({bin:f,field:u,as:g}),n.push(Ie(a,{binSuffix:"end"})),Kg(a,l)&&n.push(Ie(a,{binSuffix:"range"})),Fs(l)){let b={field:g+"_end"};s[l+"2"]=b}x.bin="binned",TH(l)||(x.type=Jf)}else if(d){i.push({timeUnit:d,field:u,as:g});let b=Mo(a)&&a.type!==Hg&&"time";b&&(l===p2||l===zb?x.formatType=b:Qet(l)?x.legend=Object.assign({formatType:b},x.legend):Fs(l)&&(x.axis=Object.assign({formatType:b},x.axis)))}s[l]=x}else n.push(u),s[l]=e[l]}else s[l]=e[l]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function Jln(e,t,n){let r=ttt(t,n);if(r){if(r==="binned"){let i=e[t===Ou?jn:qr];return!!(Re(i)&&Re(e[t])&&Ai(i.bin))}}else return!1;return!0}function Qtt(e,t,n){let r=t.type;return pe(e).reduce((i,o)=>{if(!AH(o))return xe(he.invalidEncodingChannel(o)),i;let s=e[o];if(o==="angle"&&r==="arc"&&!e.theta&&(xe(he.REPLACE_ANGLE_WITH_THETA),o=$l),!Jln(e,o,r))return xe(he.incompatibleChannel(o,r)),i;if(o===$u&&r==="line"){let a=aa(e[o]);if(a?.aggregate)return xe(he.LINE_WITH_VARYING_SIZE),i}if(o===Yi&&(t.filled?"fill"in e:"stroke"in e))return xe(he.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(o===h2||o===m2&&!ze(s)&&!Va(s)||o===zb&&ze(s))s&&(i[o]=_n(s).reduce((a,l)=>(Re(l)?a.push(iye(l,o)):xe(he.emptyFieldDef(l,o)),a),[]));else{if(o===zb&&s===null)i[o]=null;else if(!Re(s)&&!Lu(s)&&!Va(s)&&!uN(s)&&!rt(s))return xe(he.emptyFieldDef(s,o)),i;i[o]=KB(s,o,n)}return i},{})}function Jtt(e){let t=[];for(let n of pe(e))if(t0(e,n)){let r=e[n],i=_n(r);for(let o of i)Re(o)?t.push(o):cN(o)&&t.push(o.condition)}return t}function QB(e,t,n){if(e)for(let r of pe(e)){let i=e[r];if(ze(i))for(let o of i)t.call(n,o,r);else t.call(n,i,r)}}function eY(e,t,n,r){return e?pe(e).reduce((i,o)=>{let s=e[o];return ze(s)?s.reduce((a,l)=>t.call(r,a,l,o),i):t.call(r,i,s,o)},n):n}function tY(e,t){return pe(t).reduce((n,r)=>{switch(r){case jn:case qr:case qD:case YD:case HD:case Ou:case jc:case $l:case Hp:case Mu:case qp:case Pl:case Ll:case La:case ia:case p2:case Mi:case Yp:case zb:return n;case m2:if(e==="line"||e==="trail")return n;case h2:case GD:{let i=t[r];if(ze(i)||Re(i))for(let o of _n(i))o.aggregate||n.push(Ie(o,{}));return n}case $u:if(e==="trail")return n;case Yi:case Ba:case za:case Bl:case Vc:case Wc:case qc:case Gc:{let i=aa(t[r]);return i&&!i.aggregate&&n.push(Ie(i,{})),n}}},[])}var zl=w(()=>{"use strict";cr();st();Bb();sa();St();Tt();nn();Yc();Te();er()});function ent(e){let{tooltip:t}=e,n=Le(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(ze(t)){for(let o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return ze(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function JB(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:o,titlePrefix:s})=>{let a=r?` of ${t.field}`:"";return{field:o+t.field,type:t.type,title:rt(s)?{signal:s+`"${escape(a)}"`}:s+a}}),...Jtt(n)]}}function cye(e){let{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:Sn(n,r)}function mN(e,t,n,r,i){let{scale:o,axis:s}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{let p=cye(n);return fye(e,a,i,f,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:u+"_"+n.field,type:n.type},p!==void 0?{title:p}:{}),o!==void 0?{scale:o}:{}),s!==void 0?{axis:s}:{})},dt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function fye(e,t,n,r,i){let{clip:o,color:s,opacity:a}=e,l=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),o?{clip:o}:{}),s?{color:s}:{}),a?{opacity:a}:{}),ra(i.mark)?i.mark:{type:i.mark}),{style:`${l}-${t}`}),zg(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function rY(e,t,n){let{encoding:r}=e,i=t==="vertical"?"y":"x",o=r[i],s=r[i+"2"],a=r[i+"Error"],l=r[i+"Error2"];return{continuousAxisChannelDef:nY(o,n),continuousAxisChannelDef2:nY(s,n),continuousAxisChannelDefError:nY(a,n),continuousAxisChannelDefError2:nY(l,n),continuousAxis:i}}function nY(e,t){if(e&&e.aggregate){let{aggregate:n}=e,r=Le(e,["aggregate"]);return n!==t&&xe(he.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}else return e}function iY(e,t){let{mark:n,encoding:r}=e,{x:i,y:o}=r;if(Bu(i)){if(Bu(o)){let s=Re(i)&&i.aggregate,a=Re(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return ra(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Bu(o))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}var oY=w(()=>{"use strict";cr();st();Tt();zl();nn();Ro();Te();er()});function rnt(e){return ur(e)?"tukey":e}function dye(e,{config:t}){var n,r;let{mark:i,encoding:o,selection:s,projection:a}=e,l=Le(e,["mark","encoding","selection","projection"]),u=ra(i)?i:{type:i};s&&xe(he.selectionNotSupported("boxplot"));let c=(n=u.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=en("size",u,t),d=rnt(c),{transform:p,continuousAxisChannelDef:m,continuousAxis:h,groupby:g,aggregate:x,encodingWithoutContinuousAxis:b,ticksOrient:y,boxOrient:v,customTooltipWithoutAggregatedField:C}=tun(e,c,t),{color:_,size:S}=b,E=Le(b,["color","size"]),T=Q=>mN(u,h,m,Q,t.boxplot),I=T(E),k=T(b),O=T(Object.assign(Object.assign({},E),S?{size:S}:{})),F=JB([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,b),B={type:"tick",color:"black",opacity:1,orient:y,invalid:null},M=d==="min-max"?F:JB([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,b),z=[...I({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:M}),...I({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:M}),...I({partName:"ticks",mark:B,positionPrefix:"lower_whisker",aria:!1,extraEncoding:M}),...I({partName:"ticks",mark:B,positionPrefix:"upper_whisker",aria:!1,extraEncoding:M})],W=[...d!=="tukey"?z:[],...k({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:v,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:F}),...O({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},lr(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:y,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:F})],H;if(d!=="min-max"){let Q=`datum["lower_box_${m.field}"]`,re=`datum["upper_box_${m.field}"]`,oe=`(${re} - ${Q})`,me=`${Q} - ${c} * ${oe}`,ge=`${re} + ${c} * ${oe}`,ye=`datum["${m.field}"]`,ve={joinaggregate:int(m.field),groupby:g},Ne;d==="tukey"&&(Ne={transform:[{filter:`(${me} <= ${ye}) && (${ye} <= ${ge})`},{aggregate:[{op:"min",field:m.field,as:"lower_whisker_"+m.field},{op:"max",field:m.field,as:"upper_whisker_"+m.field},{op:"min",field:"lower_box_"+m.field,as:"lower_box_"+m.field},{op:"max",field:"upper_box_"+m.field,as:"upper_box_"+m.field},...x],groupby:g}],layer:z});let{tooltip:Ge}=E,nt=Le(E,["tooltip"]),{scale:Y,axis:ie}=m,ue=cye(m),U=fye(u,"outliers",t.boxplot,!0,{transform:[{filter:`(${ye} < ${me}) || (${ye} > ${ge})`}],mark:"point",encoding:Object.assign(Object.assign({[h]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},ue!==void 0?{title:ue}:{}),Y!==void 0?{scale:Y}:{}),ie!==void 0?{axis:ie}:{})},nt),C?{tooltip:C}:{})})[0];U&&Ne?H={transform:[ve],layer:[U,Ne]}:U?(H=U,H.transform.unshift(ve)):Ne&&(H=Ne,H.transform.unshift(ve))}return H?Object.assign(Object.assign({},l),{layer:[H,{transform:p,layer:W}]}):Object.assign(Object.assign({},l),{transform:((r=l.transform)!==null&&r!==void 0?r:[]).concat(p),layer:W})}function int(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function tun(e,t,n){let r=iY(e,ez),{continuousAxisChannelDef:i,continuousAxis:o}=rY(e,r,ez),s=i.field,a=rnt(t),l=[...int(s),{op:"median",field:s,as:"mid_box_"+s},{op:"min",field:s,as:(a==="min-max"?"lower_whisker_":"min_")+s},{op:"max",field:s,as:(a==="min-max"?"upper_whisker_":"max_")+s}],u=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:"iqr_"+s},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:"upper_whisker_"+s},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:"lower_whisker_"+s}],c=e.encoding,f=o,d=c[f],p=Le(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:m,filteredEncoding:h}=ent(p),{bins:g,timeUnits:x,aggregate:b,groupby:y,encoding:v}=pN(h,n),C=r==="vertical"?"horizontal":"vertical",_=r;return{transform:[...g,...x,{aggregate:[...b,...l],groupby:y},...u],groupby:y,aggregate:b,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:C,boxOrient:_,customTooltipWithoutAggregatedField:m}}var ez,tnt,nnt,pye=w(()=>{"use strict";cr();st();Cr();zl();nn();Ro();UB();oY();ez="boxplot",tnt=["box","median","outliers","rule","ticks"],nnt=new jg(ez,dye)});function mye(e,{config:t}){let{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:l,tooltipEncoding:u}=hye(e,sY,t),c=mN(a,i,r,o,t.errorbar),f={type:"tick",orient:s},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function nun(e,t){let{encoding:n}=e;if(run(n))return{orient:iY(e,t),inputType:"raw"};let r=iun(n),i=oun(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);let a=n.x2,l=n.y2;if(It(a)&&It(l))throw new Error(`${t} cannot have both x2 and y2`);if(It(a)){if(Bu(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(It(l)){if(Bu(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{let a=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(It(l)&&!It(a))throw new Error(`${t} cannot have xError2 without xError`);if(It(c)&&!It(u))throw new Error(`${t} cannot have yError2 without yError`);if(It(a)&&It(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(It(a)){if(Bu(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(It(u)){if(Bu(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function run(e){return(It(e.x)||It(e.y))&&!It(e.x2)&&!It(e.y2)&&!It(e.xError)&&!It(e.xError2)&&!It(e.yError)&&!It(e.yError2)}function iun(e){return It(e.x2)||It(e.y2)}function oun(e){return It(e.xError)||It(e.xError2)||It(e.yError)||It(e.yError2)}function hye(e,t,n){var r;let{mark:i,encoding:o,selection:s,projection:a}=e,l=Le(e,["mark","encoding","selection","projection"]),u=ra(i)?i:{type:i};s&&xe(he.selectionNotSupported(t));let{orient:c,inputType:f}=nun(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:p,continuousAxisChannelDefError:m,continuousAxisChannelDefError2:h,continuousAxis:g}=rY(e,c,t),{errorBarSpecificAggregate:x,postAggregateCalculates:b,tooltipSummary:y,tooltipTitleWithFieldName:v}=sun(u,d,p,m,h,f,t,n),C=o,_=g,S=C[_],E=g==="x"?"x2":"y2",T=C[E],I=g==="x"?"xError":"yError",k=C[I],O=g==="x"?"xError2":"yError2",F=C[O],B=Le(C,[typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+"",typeof I=="symbol"?I:I+"",typeof O=="symbol"?O:O+""]),{bins:M,timeUnits:z,aggregate:W,groupby:H,encoding:Q}=pN(B,n),re=[...W,...x],oe=f!=="raw"?[]:H,me=JB(y,d,Q,v);return{transform:[...(r=l.transform)!==null&&r!==void 0?r:[],...M,...z,...re.length===0?[]:[{aggregate:re,groupby:oe}],...b],groupby:oe,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:Q,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:me}}function sun(e,t,n,r,i,o,s,a){let l=[],u=[],c=t.field,f,d=!1;if(o==="raw"){let p=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,m=e.extent?e.extent:p==="mean"?"stderr":"iqr";if(p==="median"!=(m==="iqr")&&xe(he.errorBarCenterIsUsedWithWrongExtent(p,m,s)),m==="stderr"||m==="stdev")l=[{op:m,field:c,as:"extent_"+c},{op:p,field:c,as:"center_"+c}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:l2(p)},{fieldPrefix:"upper_",titlePrefix:ont(p,m,"+")},{fieldPrefix:"lower_",titlePrefix:ont(p,m,"-")}],d=!0;else{e.center&&e.extent&&xe(he.errorBarCenterIsNotNeeded(e.extent,s));let h,g,x;m==="ci"?(h="mean",g="ci0",x="ci1"):(h="median",g="q1",x="q3"),l=[{op:g,field:c,as:"lower_"+c},{op:x,field:c,as:"upper_"+c},{op:h,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:ed({field:c,aggregate:x,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:ed({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:ed({field:c,aggregate:h,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&xe(he.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],u=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(let p of u)f.push({fieldPrefix:p.as.substring(0,6),titlePrefix:Ug(Ug(p.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}function ont(e,t,n){return l2(e)+" "+n+" "+t}var sY,snt,ant,aY=w(()=>{"use strict";cr();Tt();zl();nn();Ro();Te();UB();oY();sY="errorbar",snt=["ticks","rule"],ant=new jg(sY,mye)});function gye(e,{config:t}){let{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:l}=hye(e,lY,t),u=s,c=mN(u,i,r,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0,d={type:f?"area":"rect"},p={type:f?"line":"rule"},m=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),m),{ariaRoleDescription:"errorband"}),p=Object.assign(Object.assign({},p),m)):u.interpolate?xe(he.errorBand1DNotSupport("interpolate")):u.tension&&xe(he.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:p,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"borders",mark:p,positionPrefix:"upper",aria:!1,extraEncoding:l})]})}var lY,lnt,unt,xye=w(()=>{"use strict";nn();UB();oY();aY();lY="errorband",lnt=["band","borders"],unt=new jg(lY,gye)});function bye(e,t,n){let r=new jg(e,t);cnt[e]={normalizer:r,parts:n}}function fnt(){return pe(cnt)}var cnt,dnt=w(()=>{"use strict";Te();UB();pye();xye();aY();cnt={};bye(ez,dye,tnt);bye(sY,mye,snt);bye(lY,gye,lnt)});var pnt,mnt=w(()=>{"use strict";pnt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"]});var uY,hnt,gnt,yye,$Qr,tz=w(()=>{"use strict";Te();uY=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],hnt={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},gnt={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},yye={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},$Qr=pe(yye)});function nz(e){return!!e&&(e==="legend"||!!e.legend)}function cY(e){return nz(e)&&lr(e)}var Gb,xnt,hN=w(()=>{"use strict";st();Gb="_vgsid_",xnt={single:{on:"click",fields:[Gb],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[Gb],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}}});function vye(e){return Tw(e)||gN(e)||rz(e)}function rz(e){return"concat"in e}function Tw(e){return"vconcat"in e}function gN(e){return"hconcat"in e}var fY=w(()=>{"use strict"});function zu(e){return lr(e)&&e.step!==void 0}function wye(e){return e.view||e.width||e.height}function bnt(e,t,n){var r,i;let o=n[t],s={},{spacing:a,columns:l}=o;a!==void 0&&(s.spacing=a),l!==void 0&&(Vb(e)&&!Jg(e.facet)||rz(e))&&(s.columns=l),Tw(e)&&(s.columns=1);for(let u of lun)if(e[u]!==void 0)if(u==="spacing"){let c=e[u];s[u]=ur(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:a,column:(i=c.column)!==null&&i!==void 0?i:a}}else s[u]=e[u];return s}var Cye,aun,lun,y2=w(()=>{"use strict";st();Te();fY();Wb();Cye=20,aun={align:1,bounds:1,center:1,columns:1,spacing:1},lun=pe(aun)});function iz(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function v2(e,t){let n=w2(e,t);return zu(n)?n.step:dY}function w2(e,t){var n;let r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return Sn(r,{step:e.step})}function fun(e={}){return{signals:[{name:"color",value:lr(e)?Object.assign(Object.assign({},vnt),e):vnt}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function dun(e){return{signals:[{name:"fontSize",value:lr(e)?Object.assign(Object.assign({},ynt),e):ynt}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function pun(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function pY(e={}){let{color:t,font:n,fontSize:r}=e,i=Le(e,["color","font","fontSize"]);return DB({},cun,n?pun(n):{},t?fun(t):{},r?dun(r):{},i||{})}function wnt(e){e=at(e);for(let t of hun)delete e[t];if(e.axis)for(let t in e.axis)zD(e.axis[t])&&delete e.axis[t];if(e.legend)for(let t of pnt)delete e.legend[t];if(e.mark){for(let t of Rbe)delete e.mark[t];e.mark.tooltip&&lr(e.mark.tooltip)&&delete e.mark.tooltip}for(let t of mun){for(let r of Rbe)delete e[t][r];let n=gun[t];if(n)for(let r of n)delete e[t][r];bun(e,t)}for(let t of fnt())delete e[t];xun(e);for(let t in e)lr(e[t])&&cn(e[t])&&delete e[t];return cn(e)?void 0:e}function xun(e){let{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=ZH(e.title);cn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),cn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),cn(r)?delete e.title:e.title=r}function bun(e,t,n,r){let i=r?e[t][r]:e[t];t==="view"&&(n="cell");let o=Object.assign(Object.assign({},i),e.style[n??t]);cn(o)||(e.style[n??t]=o),r||delete e[t]}var dY,uun,cun,qb,ynt,vnt,mun,hun,gun,kw=w(()=>{"use strict";cr();st();PB();dnt();mnt();tz();Ro();Ro();ti();hN();y2();XB();Te();dY=20,uun={continuousWidth:200,continuousHeight:200,step:dY},cun={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:uun,mark:Tet,arc:{},area:{},bar:Det,circle:{},geoshape:{},image:{},line:{},point:{},rect:Net,rule:{color:"black"},square:{},text:{color:"black"},tick:Fet,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:Ftt,projection:{},legend:gnt,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:xnt,style:{},title:{},facet:{spacing:Cye},concat:{spacing:Cye}},qb=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],ynt={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},vnt={blue:qb[0],orange:qb[1],red:qb[2],teal:qb[3],green:qb[4],yellow:qb[5],purple:qb[6],pink:qb[7],brown:qb[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};mun=["view",...Fbe],hun=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],gun=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Aet)});function Hb(e){return"layer"in e}var _ye=w(()=>{"use strict"});function Sye(e){return"repeat"in e}function Cnt(e){return!ze(e.repeat)&&e.repeat.layer}var mY=w(()=>{"use strict";st()});var xN=w(()=>{"use strict";fY();Wb();_ye();mY();bw()});var bN,Eye=w(()=>{"use strict";cr();nn();fY();Wb();_ye();mY();bw();bN=class{map(t,n){return Vb(t)?this.mapFacet(t,n):Sye(t)?this.mapRepeat(t,n):gN(t)?this.mapHConcat(t,n):Tw(t)?this.mapVConcat(t,n):rz(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Hb(t))return this.mapLayer(t,n);if(ns(t))return this.mapUnit(t,n);throw new Error(he.invalidSpec(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){let{concat:r}=t,i=Le(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}});function vun(e){return e in yun}function _nt(e,t){var n,r;let i=t==="x"?"y":"radius",o=e[t],s=e[i];if(Re(o)&&Re(s))if(Xg(o)==="quantitative"&&Xg(s)==="quantitative"){if(o.stack)return t;if(s.stack)return i;let a=Re(o)&&!!o.aggregate,l=Re(s)&&!!s.aggregate;if(a!==l)return a?t:i;{let u=(n=o.scale)===null||n===void 0?void 0:n.type,c=(r=s.scale)===null||r===void 0?void 0:r.type;if(u&&u!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Xg(o)==="quantitative")return t;if(Xg(s)==="quantitative")return i}else{if(Xg(o)==="quantitative")return t;if(Xg(s)==="quantitative")return i}}function _un(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function hY(e,t,n={}){let r=ra(e)?e.type:e;if(!wun.has(r))return null;let i=_nt(t,"x")||_nt(t,"theta");if(!i)return null;let o=t[i],s=Re(o)?Ie(o,{}):void 0,a=_un(i),l=t[a],u=Re(l)?Ie(l,{}):void 0;u===s&&(u=void 0,l=void 0,a=void 0);let c=Yet.reduce((d,p)=>{if(p!=="tooltip"&&t0(t,p)){let m=t[p];for(let h of _n(m)){let g=aa(h);if(g.aggregate)continue;let x=Ie(g,{});(!x||x!==u)&&d.push({channel:p,fieldDef:g})}}return d},[]),f;if(o.stack!==void 0?zg(o.stack)?f=o.stack?"zero":null:f=o.stack:c.length>0&&Cun.has(r)&&(f="zero"),!f||!vun(f)||dN(t)&&c.length===0)return null;if(o.scale&&o.scale.type&&o.scale.type!==fi.LINEAR){if(n.disallowNonLinearStack)return null;xe(he.cannotStackNonLinearScale(o.scale.type))}return It(t[Ns(i)])?(o.stack!==void 0&&xe(he.cannotStackRangedMark(i)),null):(Re(o)&&o.aggregate&&!Ve(Pet,o.aggregate)&&xe(he.stackNonSummativeAggregate(o.aggregate)),{groupbyChannel:l?a:void 0,groupbyField:u,fieldChannel:i,impute:o.impute===null?!1:Nu(r),stackBy:c,offset:f})}var yun,wun,Cun,Aye=w(()=>{"use strict";st();Bb();St();Tt();zl();nn();Ro();ti();Te();yun={zero:1,center:1,normalize:1};wun=new Set([Dbe,f2,c2,jD,UD,BB,zB,d2,vH,LB]),Cun=new Set([f2,c2,Dbe])});function Sun(e){let{point:t,line:n}=e,r=Le(e,["point","line"]);return pe(r).length>1?r:r.type}function Eun(e){for(let t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Iu(e[t],["point","line"])}));return e}function Tye(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?lr(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?lr(t.point)?t.point:{}:void 0}function Snt(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}var gY,Ent=w(()=>{"use strict";cr();st();Ro();bw();Aye();Te();gY=class{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(ns(t)){let{mark:r,encoding:i}=t,o=ra(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!Tye(o,n[o.type],i);case"area":return!!Tye(o,n[o.type],i)||!!Snt(o,n[o.type])}}return!1}run(t,n,r){let{config:i}=n,{selection:o,projection:s,encoding:a,mark:l}=t,u=Le(t,["selection","projection","encoding","mark"]),c=ra(l)?l:{type:l},f=Tye(c,i[c.type],a),d=c.type==="area"&&Snt(c,i[c.type]),p=[Object.assign(Object.assign({},o?{selection:o}:{}),{mark:Sun(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:Iu(a,["shape"])})],m=hY(c,a),h=a;if(m){let{fieldChannel:g,offset:x}=m;h=Object.assign(Object.assign({},a),{[g]:Object.assign(Object.assign({},a[g]),x?{stack:x}:{})})}return d&&p.push(Object.assign(Object.assign({},s?{projection:s}:{}),{mark:Object.assign(Object.assign({type:"line"},gw(c,["clip","interpolate","tension","tooltip"])),d),encoding:h})),f&&p.push(Object.assign(Object.assign({},s?{projection:s}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},gw(c,["clip","tooltip"])),f),encoding:h})),r(Object.assign(Object.assign({},u),{layer:p}),Object.assign(Object.assign({},n),{config:Eun(i)}))}}});var xY,Ant=w(()=>{"use strict";cr();St();Tt();nn();bw();Te();xY=class{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(ns(t)&&t.encoding)for(let r of Ki){let i=t.encoding[r];if(i&&It(i)&&!((n=i?.scale)===null||n===void 0)&&n.rangeStep)return!0}return!1}run(t){var n;let r={},i=Object.assign({},t.encoding);for(let o of Ki){let s=oa(o),a=i[o];if(a&&It(a)&&!((n=a?.scale)===null||n===void 0)&&n.rangeStep){let{scale:l}=a,u=Le(a,["scale"]),c=l,{rangeStep:f}=c,d=Le(c,["rangeStep"]);r[s]={step:l.rangeStep},xe(he.RANGE_STEP_DEPRECATED),i=Object.assign(Object.assign({},i),{[o]:Object.assign(Object.assign({},u),cn(d)?{}:{scale:d})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}});function Int(e,t){return t?Jg(e)?Nnt(e,t):Dnt(e,t):e}function bY(e,t){return t?Nnt(e,t):e}function kye(e,t,n){let r=t[e];if(Vtt(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});xe(he.noSuchRepeatedValue(r.repeat));return}return t}function Dnt(e,t){if(e=kye("field",e,t),e!==void 0){if(e===null)return null;if(eye(e)&&Rs(e.sort)){let n=kye("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Tnt(e,t){if(Re(e))return Dnt(e,t);{let n=kye("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function knt(e,t){if(It(e)){let n=Tnt(e,t);if(n)return n;if(uN(e))return{condition:e.condition}}else{if(qH(e)){let n=Tnt(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});{let{condition:r}=e;return Le(e,["condition"])}}return e}}function Nnt(e,t){let n={};for(let r in e)if(zc(e,r)){let i=e[r];if(ze(i))n[r]=i.map(o=>knt(o,t)).filter(o=>o);else{let o=knt(i,t);o!==void 0&&(n[r]=o)}}return n}var Fnt=w(()=>{"use strict";cr();st();Tt();nn();Xp();Wb()});var yY,Rnt=w(()=>{"use strict";sa();St();Tt();nn();bw();yY=class{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(ns(t)){let{encoding:n,mark:r}=t;if(r==="line")for(let i of qet){let o=Hc(i),s=n[o];if(n[i]&&(Re(s)&&!Ai(s.bin)||Lu(s)))return!0}}return!1}run(t,n,r){let{encoding:i}=t;return xe(he.lineWithRange(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}});function Ont(e){let{parentEncoding:t,encoding:n}=e;if(t&&n){let i=pe(t).reduce((o,s)=>(n[s]&&o.push(s),o),[]);i.length>0&&xe(he.encodingOverridden(i))}let r=Object.assign(Object.assign({},t??{}),n??{});return cn(r)?void 0:r}function Mnt(e){let{parentProjection:t,projection:n}=e;return t&&n&&xe(he.projectionOverridden({parentProjection:t,projection:n})),n??t}var vY,$nt=w(()=>{"use strict";cr();st();St();pye();xye();aY();zl();nn();Wb();Eye();mY();bw();Te();Ent();Ant();Fnt();Rnt();vY=class extends bN{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[nnt,ant,unt,new gY,new yY,new xY]}map(t,n){if(ns(t)){let r=t0(t.encoding,Fu),i=t0(t.encoding,Ru),o=t0(t.encoding,WD);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){let{parentEncoding:r,parentProjection:i}=n,o=Object.assign(Object.assign({},t),{encoding:bY(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(o,n);let s=this.mapLayerOrUnit.bind(this);for(let a of this.nonFacetUnitNormalizers)if(a.hasMatchingType(o,n.config))return a.run(o,n,s);return o}mapRepeat(t,n){return Cnt(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){let{repeat:r,spec:i}=t,o=Le(t,["repeat","spec"]),{row:s,column:a,layer:l}=r,{repeater:u={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},s?{row:s}:{}),a?{column:a}:{}),spec:{repeat:{layer:l},spec:i}}),n):Object.assign(Object.assign({},o),{layer:l.map(f=>{let d=Object.assign(Object.assign({},u),{layer:f}),p=(i.name||"")+c+`child__layer_${bn(f)}`,m=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:p}));return m.name=p,m})})}mapNonLayerRepeat(t,n){var r;let{repeat:i,spec:o,data:s}=t,a=Le(t,["repeat","spec","data"]);!ze(i)&&t.columns&&(t=Iu(t,["columns"]),xe(he.columnsNotSupportByRowCol("repeat")));let l=[],{repeater:u={},repeaterPrefix:c=""}=n,f=!ze(i)&&i.row||[u?u.row:null],d=!ze(i)&&i.column||[u?u.column:null],p=ze(i)&&i||[u?u.repeat:null];for(let h of p)for(let g of f)for(let x of d){let b={repeat:h,row:g,column:x,layer:u.layer},y=(o.name||"")+c+"child__"+(ze(i)?`${bn(h)}`:(i.row?`row_${bn(g)}`:"")+(i.column?`column_${bn(x)}`:"")),v=this.map(o,Object.assign(Object.assign({},n),{repeater:b,repeaterPrefix:y}));v.name=y,l.push(Iu(v,["data"]))}let m=ze(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=o.data)!==null&&r!==void 0?r:s,align:"all"},a),{columns:m,concat:l})}mapFacet(t,n){let{facet:r}=t;return Jg(r)&&t.columns&&(t=Iu(t,["columns"]),xe(he.columnsNotSupportByRowCol("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){let{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,l=Mnt({parentProjection:s,projection:i}),u=Ont({parentEncoding:o,encoding:bY(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),l?{projection:l}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(t,n){let r=t.encoding,{row:i,column:o,facet:s}=r,a=Le(r,["row","column","facet"]),{mark:l,width:u,projection:c,height:f,view:d,selection:p,encoding:m}=t,h=Le(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:g,layout:x}=this.getFacetMappingAndLayout({row:i,column:o,facet:s},n),b=bY(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},h),x),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:l,encoding:b}),p?{selection:p}:{})}),n)}getFacetMappingAndLayout(t,n){var r;let{row:i,column:o,facet:s}=t;if(i||o){s&&xe(he.facetChannelDropped([...i?[Fu]:[],...o?[Ru]:[]]));let a={},l={};for(let u of[Fu,Ru]){let c=t[u];if(c){let{align:f,center:d,spacing:p,columns:m}=c,h=Le(c,["align","center","spacing","columns"]);a[u]=h;for(let g of["align","center","spacing"])c[g]!==void 0&&(l[g]=(r=l[g])!==null&&r!==void 0?r:{},l[g][u]=c[g])}}return{facetMapping:a,layout:l}}else{let{align:a,center:l,spacing:u,columns:c}=s,f=Le(s,["align","center","spacing","columns"]);return{facetMapping:Int(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),l?{center:l}:{}),u?{spacing:u}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,o=Le(n,["parentEncoding","parentProjection"]);let{encoding:s,projection:a}=t,l=Le(t,["encoding","projection"]),u=Object.assign(Object.assign({},o),{parentEncoding:Ont({parentEncoding:r,encoding:s}),parentProjection:Mnt({parentProjection:i,projection:a})});return super.mapLayer(l,u)}}});function wY(e,t){t===void 0&&(t=pY(e.config));let n=Tun(e,t),{width:r,height:i}=e,o=kun(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}function Tun(e,t={}){return Aun.map(e,{config:t})}function Pnt(e){return dt(e)?{type:e}:e??{}}function kun(e,t,n){let{width:r,height:i}=t,o=ns(e)||Hb(e),s={};o?r=="container"&&i=="container"?(s.type="fit",s.contains="padding"):r=="container"?(s.type="fit-x",s.contains="padding"):i=="container"&&(s.type="fit-y",s.contains="padding"):(r=="container"&&(xe(he.containerSizeNonSingle("width")),r=void 0),i=="container"&&(xe(he.containerSizeNonSingle("height")),i=void 0));let a=Object.assign(Object.assign(Object.assign({type:"pad"},s),n?Pnt(n.autosize):{}),Pnt(e.autosize));if(a.type==="fit"&&!o&&(xe(he.FIT_NON_SINGLE),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&xe(he.containerSizeNotCompatibleWithAutosize("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&xe(he.containerSizeNotCompatibleWithAutosize("height")),!Lb(a,{type:"pad"}))return a}var Aun,Iye=w(()=>{"use strict";st();kw();nn();xN();Te();$nt();Aun=new vY});function Lnt(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Bnt(e){return e?`fit-${yw(e)}`:"fit"}function Dye(e){return Iun.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}var Iun,znt=w(()=>{"use strict";St();Iun=["background","padding"]});function Yb(e){return{explicit:!0,value:e}}function Ga(e){return{explicit:!1,value:e}}function CY(e){return(t,n,r,i)=>{let o=e(t.value,n.value);return o>0?t:o<0?n:yN(t,n,r,i)}}function yN(e,t,n,r){return e.explicit&&t.explicit&&xe(he.mergeConflictingProperty(n,r,e.value,t.value)),e}function Uu(e,t,n,r,i=yN){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Lb(e.value,t.value)?e:i(e,t,n,r)}var Wa,Ul=w(()=>{"use strict";nn();Te();Wa=class e{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new e(at(this.explicit),at(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return Sn(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(let n of pe(t.combine())){let r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}});var _Y,Unt=w(()=>{"use strict";Ul();_Y=class extends Wa{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){let t=super.clone();return t.parseNothing=this.parseNothing,t}}});function Iw(e){return"url"in e}function vN(e){return"values"in e}function SY(e){return"name"in e&&!Iw(e)&&!vN(e)&&!n0(e)}function n0(e){return e&&(Nye(e)||Fye(e)||oz(e))}function Nye(e){return"sequence"in e}function Fye(e){return"sphere"in e}function oz(e){return"graticule"in e}var fo,wN,r0=w(()=>{"use strict";fo="main",wN="raw"});function Rye(e){return"filter"in e}function jnt(e){return e?.stop!==void 0}function Vnt(e){return"lookup"in e}function Wnt(e){return"data"in e}function Gnt(e){return"selection"in e}function qnt(e){return"pivot"in e}function Hnt(e){return"density"in e}function Ynt(e){return"quantile"in e}function Knt(e){return"regression"in e}function Xnt(e){return"loess"in e}function Znt(e){return"sample"in e}function Qnt(e){return"window"in e}function Jnt(e){return"joinaggregate"in e}function ert(e){return"flatten"in e}function trt(e){return"calculate"in e}function nrt(e){return"bin"in e}function rrt(e){return"impute"in e}function irt(e){return"timeUnit"in e}function ort(e){return"aggregate"in e}function srt(e){return"stack"in e}function art(e){return"fold"in e}function lrt(e){return e.map(t=>Rye(t)?{filter:OB(t.filter,Att)}:t)}var sz=w(()=>{"use strict";dH();g2()});function td(e,t,n,r){let i=uN(t)&&t.condition,o=r(t);if(i){let a=_n(i).map(l=>{let u=r(l),c=jtt(l)?EY(e,l.selection):S2(e,l.test);return Object.assign({test:c},u)});return{[n]:[...a,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}var C2=w(()=>{"use strict";st();Tt();AY();_2()});function Dw(e,t="text"){let n=e.encoding[t];return td(e,n,t,r=>CN(r,e.config))}function CN(e,t,n="datum"){if(e){if(Va(e))return tr(e.value);if(It(e)){let{format:r,formatType:i}=fN(e);return iN({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}var _N=w(()=>{"use strict";Tt();Cr();Qg();C2()});function SN(e,t={}){let{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(ze(s))return{tooltip:Oye({tooltip:s},o,i,t)};{let a=t.reactiveGeom?"datum.datum":"datum";return td(e,s,"tooltip",l=>{let u=CN(l,i,a);if(u)return u;if(l===null)return;let c=en("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),dt(c))return{value:c};if(lr(c))return c.content==="encoding"?Oye(n,o,i,t):{signal:a}})}}function Mye(e,t,n,{reactiveGeom:r}={}){let i={},o=r?"datum.datum":"datum",s=[];function a(u,c){let f=Hc(c),d=Mo(u)?u:Object.assign(Object.assign({},u),{type:e[f].type}),p=_n(ed(d,n,{allowDisabling:!1})).join(", "),m;if(Fs(c)){let h=c==="x"?"x2":"y2",g=aa(e[h]);if(Ai(d.bin)&&g){let x=Ie(d,{expr:o}),b=Ie(g,{expr:o}),{format:y,formatType:v}=fN(d);m=oN(x,b,y,v,n),i[h]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){let{format:x,formatType:b}=fN(d);m=iN({fieldOrDatumDef:d,format:x,formatType:b,expr:o,config:n,normalizeStack:!0}).signal}}m=m??CN(d,n,o).signal,s.push({channel:c,key:p,value:m})}QB(e,(u,c)=>{Re(u)?a(u,c):cN(u)&&a(u.condition,c)});let l={};for(let{channel:u,key:c,value:f}of s)!i[u]&&!l[c]&&(l[Yt(c)]=f);return l}function Oye(e,t,n,{reactiveGeom:r}={}){let i=Mye(e,t,n,{reactiveGeom:r}),o=MB(i).map(({key:s,value:a})=>`${s}: ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}var az=w(()=>{"use strict";st();sa();St();Tt();zl();Te();Cr();Qg();C2();_N()});function $ye(e){let{markDef:t,config:n}=e,r=en("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),Dun(e)),Nun(e))}function Dun(e){let{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};let i=en("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in vtt?{}:{ariaRoleDescription:{value:t}}}function Nun(e){let{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return td(e,o,"description",l=>CN(l,e.config));let s=en("description",n,r);if(s!=null)return{description:tr(s)};if(r.aria===!1)return{};let a=Mye(t,i,r);if(!cn(a))return{description:{signal:MB(a).map(({key:l,value:u})=>`${l} + ": " + (${u})`).join(' + "; " + ')}}}var Pye=w(()=>{"use strict";Te();Cr();er();C2();_N();az()});function Or(e,t,n={}){let{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n,{defaultRef:a,defaultValue:l}=n;a===void 0&&(l=l??en(e,r,o,{vgChannel:s,ignoreVgConfig:!0}),l!==void 0&&(a=tr(l)));let u=i[e];return td(t,u,s??e,c=>Zbe({channel:e,channelDef:c,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}var EN=w(()=>{"use strict";Cr();C2();_w()});function AN(e,t={filled:void 0}){var n,r,i,o;let{markDef:s,encoding:a,config:l}=e,{type:u}=s,c=(n=t.filled)!==null&&n!==void 0?n:en("filled",s,l),f=Ve(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,d=(i=(r=en(c===!0?"color":void 0,s,l,{vgChannel:"fill"}))!==null&&r!==void 0?r:l.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,p=(o=en(c===!1?"color":void 0,s,l,{vgChannel:"stroke"}))!==null&&o!==void 0?o:l.mark[c===!1&&"color"],m=c?"fill":"stroke",h=Object.assign(Object.assign({},d?{fill:tr(d)}:{}),p?{stroke:tr(p)}:{});return s.color&&(c?s.fill:s.stroke)&&xe(he.droppingColor("property",{fill:"fill"in s,stroke:"stroke"in s})),Object.assign(Object.assign(Object.assign(Object.assign({},h),Or("color",e,{vgChannel:m,defaultValue:c?d:p})),Or("fill",e,{defaultValue:a.fill?d:void 0})),Or("stroke",e,{defaultValue:a.stroke?p:void 0}))}var TY=w(()=>{"use strict";nn();Te();Cr();EN()});function Nw(e,t){let n=Het(e),r=t[n];if(r)return r}var kY=w(()=>{"use strict";St()});function ki(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){let{encoding:o,markDef:s,config:a,stack:l}=t,u=o[e],c=o[Ns(e)],f=t.scaleName(e),d=t.getScaleComponent(e),p=Nw(e,s),m=lz({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),h=!u&&Fs(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:Fun({channel:e,channelDef:u,channel2Def:c,markDef:s,config:a,isMidPoint:i,scaleName:f,scale:d,stack:l,offset:p,defaultRef:m});return h?{[r||e]:h}:void 0}function Fun(e){let{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:o,offset:s,markDef:a,config:l}=e;if(It(n)&&o&&t===o.fieldChannel){if(Re(n)){let u=Sw({channel:t,fieldDef:n,isMidPoint:r,markDef:a,stack:o,config:l});if(u!==void 0)return nN({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:u,offset:s})}return Yg(n,i,{suffix:"end"},{offset:s})}return rN(e)}function lz({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){let{markDef:o,config:s}=e;return()=>{let a=Hc(n),l=Qf(n),u=en(n,o,s,{vgChannel:l});if(u!==void 0)return x2(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){let c=i.get("type");if(!Ve([fi.LOG,fi.TIME,fi.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{let c=e[oa(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}var uz=w(()=>{"use strict";St();Tt();ti();Te();Cr();kY();_w()});function IY(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Qf(e);let o=en(e==="x"?"align":"baseline",t,n);return e==="x"?Run[o||(r==="top"?"left":"center")]:Oun[o||r]}var Run,Oun,Lye=w(()=>{"use strict";St();Cr();Run={left:"x",center:"xc",right:"x2"},Oun={top:"y",middle:"yc",bottom:"y2"}});function Fw(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?cz(e,t,{defaultPos:n,defaultPos2:r}):ki(e,t,{defaultPos:n})}function cz(e,t,{defaultPos:n,defaultPos2:r}){let{markDef:i,config:o}=t,s=Ns(e),a=oa(e),l=Mun(t,r,s),u=l[a]?IY(e,i,o):Qf(e);return Object.assign(Object.assign({},ki(e,t,{defaultPos:n,vgChannel:u})),l)}function Mun(e,t,n){let{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,l=Hc(n),u=oa(n),c=Qf(n),f=r[l],d=e.scaleName(l),p=e.getScaleComponent(l),m=n in r||n in o?Nw(n,e.markDef):Nw(l,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};let h=$un({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:p,stack:s,offset:m,defaultRef:void 0});return h!==void 0?{[c]:h}:DY(n,o)||DY(n,{[n]:ZB(n,o,a.style),[u]:ZB(u,o,a.style)})||DY(n,a[i])||DY(n,a.mark)||{[c]:lz({model:e,defaultPos:t,channel:n,scaleName:d,scale:p})()}}function $un({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:l,defaultRef:u}){return It(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Yg(t,o,{suffix:"start"},{offset:l}):rN({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:l,defaultRef:u})}function DY(e,t){let n=oa(e),r=Qf(e);if(t[r]!==void 0)return{[r]:x2(e,t[r])};if(t[e]!==void 0)return{[r]:x2(e,t[e])};if(t[n])return{[n]:x2(e,t[n])}}var NY=w(()=>{"use strict";St();Tt();Cr();kY();Lye();uz();_w()});function ju(e,t,n){var r,i,o,s;let{config:a,encoding:l,markDef:u,stack:c}=e,f=Ns(t),d=oa(t),p=l[t],m=l[f],h=e.getScaleComponent(t),g=h?h.get("type"):void 0,x=e.scaleName(t),b=u.orient,y=(i=(r=l[d])!==null&&r!==void 0?r:l.size)!==null&&i!==void 0?i:en("size",u,a,{vgChannel:d}),v=n==="bar"&&(t==="x"?b==="vertical":b==="horizontal");if(Re(p)&&(mn(p.bin)||Ai(p.bin)||p.timeUnit&&!m)&&!y&&!Ti(g)){let C=Sw({channel:t,fieldDef:p,stack:c,markDef:u,config:a}),_=(o=e.component.axes[t])===null||o===void 0?void 0:o[0],S=(s=_?.get("translate"))!==null&&s!==void 0?s:.5;return crt({fieldDef:p,fieldDef2:m,channel:t,markDef:u,scaleName:x,band:C,axisTranslate:S,spacing:Fs(t)?en("binSpacing",u,a):void 0,reverse:h.get("reverse"),config:a})}else return(It(p)&&Ti(g)||v)&&!m?Lun(n,p,t,e):cz(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Pun(e,t,n,r,i,o){if(r){let l=r.get("type");if(l==="point"||l==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(l===fi.POINT){let u=r.get("range");return ja(u)&&ur(u.step)?{value:u.step-2}:{value:dY-2}}else return{scale:n,band:o}}else return{value:i[e].continuousBandSize}}let s=v2(i.view,t),a=Sn(i[e].discreteBandSize,s-2);return a!==void 0?{value:a}:void 0}function Lun(e,t,n,r){var i;let{markDef:o,encoding:s,config:a,stack:l}=r,u=o.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=oa(n),p=Ns(n),m=u==="horizontal"&&n==="y"||u==="vertical"&&n==="x",h=en(m?"size":d,o,a,{vgChannel:d}),g;(s.size||h!==void 0)&&(m?g=Or("size",r,{vgChannel:d,defaultValue:h}):xe(he.cannotApplySizeToNonOrientedMark(o.type)));let x=(i=It(t)?Sw({channel:n,fieldDef:t,markDef:o,stack:l,config:a}):void 0)!==null&&i!==void 0?i:1;g=g||{[d]:Pun(e,d,c,f,a,x)};let b=f?.get("type")!=="band"||!("band"in g[d]),y=IY(n,o,a,b?"middle":"top"),v=Nw(n,o),C=rN({channel:n,channelDef:t,markDef:o,config:a,scaleName:c,scale:f,stack:l,offset:v,defaultRef:lz({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:b?.5:(1-x)/2});if(d)return Object.assign({[y]:C},g);{let _=Qf(p),S=g[d],E=v?Object.assign(Object.assign({},S),{offset:v}):S;return{[y]:C,[_]:ze(C)?[C[0],Object.assign(Object.assign({},C[1]),{offset:E})]:Object.assign(Object.assign({},C),{offset:E})}}}function fz(e,t,n,r,i){if(Obe(e))return 0;let o=e==="x"||e==="y2"?-t/2:t/2;if(rt(n)){let s=Aw(i);return{signal:`${n.signal} ? ${r-o}${s?"-"+s:""} : ${r+o}${s?"+"+s:""}`}}else{if(rt(i)){let s=r+(n?-o:o);return{signal:`${s||""}${n?" - ":s?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-o:+i+o)}}function crt({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:o,spacing:s=0,axisTranslate:a,reverse:l,config:u}){let c=Ns(n),f=Qf(n),d=Qf(c),p=Nw(n,o);if(mn(e.bin)||e.timeUnit)return{[d]:urt({channel:n,fieldDef:e,scaleName:i,markDef:o,band:(1-r)/2,offset:fz(c,s,l,a,p),config:u}),[f]:urt({channel:n,fieldDef:e,scaleName:i,markDef:o,band:1-(1-r)/2,offset:fz(n,s,l,a,p),config:u})};if(Ai(e.bin)){let m=Yg(e,i,{},{offset:fz(c,s,l,a,p)});if(Re(t))return{[d]:m,[f]:Yg(t,i,{},{offset:fz(n,s,l,a,p)})};if(ww(e.bin)&&e.bin.step)return{[d]:m,[f]:{signal:`scale("${i}", ${Ie(e,{expr:"datum"})} + ${e.bin.step})`,offset:fz(n,s,l,a,p)}}}xe(he.channelRequiredForBinned(c))}function urt({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:o,config:s}){let a=nN({scaleName:n,fieldOrDatumDef:t,band:i,offset:o});return Xbe({fieldDef:t,channel:e,markDef:r,ref:a,config:s})}var Bye=w(()=>{"use strict";st();sa();St();Tt();kw();nn();ti();Te();er();Cr();EN();kY();Lye();uz();NY();_w()});function Ii(e,t){let{fill:n=void 0,stroke:r=void 0}=t.color==="include"?AN(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},zun(e.markDef,t)),frt(e,"fill",n)),frt(e,"stroke",r)),Or("opacity",e)),Or("fillOpacity",e)),Or("strokeOpacity",e)),Or("strokeWidth",e)),Or("strokeDash",e)),SN(e)),Dw(e,"href")),$ye(e))}function frt(e,t,n){let{config:r,mark:i,markDef:o}=e;if(en("invalid",o,r)==="hide"&&n&&!Nu(i)){let a=Uun(e,{invalid:!0,channels:vw});if(a)return{[t]:[{test:a,value:null},..._n(n)]}}return n?{[t]:n}:{}}function zun(e,t){return ytt.reduce((n,r)=>(!Bun.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=tr(e[r])),n),{})}function Uun(e,{invalid:t=!1,channels:n}){let r=n.reduce((o,s)=>{let a=e.getScaleComponent(s);if(a){let l=a.get("type"),u=e.vgField(s,{expr:"datum"});u&&Oo(l)&&(o[u]=!0)}return o},{}),i=pe(r);if(i.length>0){let o=t?"||":"&&";return i.map(s=>HB(s,t)).join(` ${o} `)}}var Bun,drt=w(()=>{"use strict";st();St();Ro();ti();Te();er();Cr();Pye();TY();EN();_N();az();_w();TY();C2();EN();uz();NY();Bye();_N();az();Bun=new Set(["aria"])});function TN(e){let{config:t,markDef:n}=e;if(en("invalid",n,t)){let i=jun(e,{channels:Ki});if(i)return{defined:{signal:i}}}return{}}function jun(e,{invalid:t=!1,channels:n}){let r=n.reduce((o,s)=>{let a=e.getScaleComponent(s);if(a){let l=a.get("type"),u=e.vgField(s,{expr:"datum"});u&&Oo(l)&&(o[u]=!0)}return o},{}),i=pe(r);if(i.length>0){let o=t?"||":"&&";return i.map(s=>HB(s,t)).join(` ${o} `)}}function FY(e,t){if(t!==void 0)return{[e]:tr(t)}}var prt=w(()=>{"use strict";St();ti();Te();Cr();_w()});var jl=w(()=>{"use strict";drt();TY();C2();prt();EN();uz();NY();Bye();_N();az();Pye()});var zye,Vun,RY,Uye=w(()=>{"use strict";nn();Ro();jl();zye="voronoi",Vun={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(let n of t.events)n.markname=e.getName(zye)},marks:(e,t,n)=>{let{x:r,y:i}=t.project.hasChannel,o=e.mark;if(Nu(o))return xe(he.nearestNotSupportForContinuous(o)),n;let s={name:e.getName(zye),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},SN(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},a=0,l=!1;return n.forEach((u,c)=>{var f;let d=(f=u.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?a=c:d.indexOf(zye)>=0&&(l=!0)}),l||n.splice(a+1,0,s),n}},RY=Vun});var Et,Pi,Vn=w(()=>{"use strict";Te();Et=class{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){let n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(let n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){let n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){let t=this._parent,n=t.parent;for(let r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}},Pi=class extends Et{constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){let t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Abe()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}});var rd,dz=w(()=>{"use strict";cr();St();Tt();Gg();Te();Li();Vn();rd=class e extends Et{constructor(t,n){super(t),this.formula=n}clone(){return new e(null,at(this.formula))}static makeFromEncoding(t,n){let r=n.reduceFieldDef((i,o,s)=>{let{field:a,timeUnit:l}=o,u=Wn(n)?n.encoding[Ns(s)]:void 0,c=Wn(n)&&lN(s,o,u,n.stack,n.markDef,n.config);if(l){let f=Ie(o,{forAs:!0});i[vt({as:f,field:a,timeUnit:l})]=Object.assign({as:f,field:a,timeUnit:l},c?{band:!0}:{})}return i},{});return cn(r)?null:new e(t,r)}static makeFromTransform(t,n){let r=Object.assign({},n),{timeUnit:i}=r,o=Le(r,["timeUnit"]),s=$i(i),a=Object.assign(Object.assign({},o),{timeUnit:s});return new e(t,{[vt(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(let n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(let n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(Xf(this.formula).map(t=>t.as))}dependentFields(){return new Set(Xf(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${vt(this.formula)}`}assemble(){let t=[];for(let n of Xf(this.formula)){let{field:r,as:i,timeUnit:o}=n,s=$i(o),{unit:a,utc:l}=s,u=Le(s,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Du(r),type:"timeunit"},a?{units:jB(a)}:{}),l?{timezone:"utc"}:{}),u),{as:[i,`${i}_end`]}))}return t}}});var Kb,jye,Wun,mrt,kN=w(()=>{"use strict";cr();st();St();nn();ti();Te();dz();Kb="_tuple_fields",jye=class{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}},Wun={has:()=>!0,parse:(e,t,n)=>{var r,i,o;let s=t.name,a=(r=t.project)!==null&&r!==void 0?r:t.project=new jye,l={},u={},c=new Set,f=(d,p)=>{let m=p==="visual"?d.channel:d.field,h=bn(`${s}_${m}`);for(let g=1;c.has(h);g++)h=bn(`${s}_${m}_${g}`);return c.add(h),{[p]:h}};if(!n.fields&&!n.encodings){let d=e.config.selection[n.type];if(n.init)for(let p of _n(n.init))for(let m of pe(p))Get(m)?(n.encodings||(n.encodings=[])).push(m):n.type==="interval"?(xe('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(m);else n.encodings=d.encodings,n.fields=d.fields}for(let d of(i=n.fields)!==null&&i!==void 0?i:[]){let p={type:"E",field:d};p.signals=Object.assign({},f(p,"data")),a.items.push(p),a.hasField[d]=p}for(let d of(o=n.encodings)!==null&&o!==void 0?o:[]){let p=e.fieldDef(d);if(p){let m=p.field;if(p.aggregate){xe(he.cannotProjectAggregate(d,p.aggregate));continue}else if(!m){xe(he.cannotProjectOnChannelWithoutField(d));continue}if(p.timeUnit){m=e.vgField(d);let h={timeUnit:p.timeUnit,as:m,field:p.field};u[vt(h)]=h}if(!l[m]){let h="E";if(t.type==="interval"){let x=e.getScaleComponent(d).get("type");Oo(x)&&(h="R")}else p.bin&&(h="R-RE");let g={field:m,channel:d,type:h};g.signals=Object.assign(Object.assign({},f(g,"data")),f(g,"visual")),a.items.push(l[m]=g),a.hasField[m]=a.hasChannel[d]=l[m]}}else xe(he.cannotProjectOnChannelWithoutField(d))}if(n.init){let d=p=>a.items.map(m=>p[m.channel]!==void 0?p[m.channel]:p[m.field]);if(n.type==="interval")t.init=d(n.init);else{let p=_n(n.init);t.init=p.map(d)}}cn(u)||(a.timeUnit=new rd(null,u))},signals:(e,t,n)=>{let r=t.name+Kb;return n.filter(o=>o.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(o=>{let{signals:s,hasLegend:a}=o,l=Le(o,["signals","hasLegend"]);return l.field=Du(l.field),l})})}},mrt=Wun});var Gun,OY,Vye=w(()=>{"use strict";st();Vu();Te();E2();Uye();kN();hN();Gun={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!nz(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{let r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=RY.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((l,u)=>{var c,f;let d=bn(`${r}_${l.field}`);n.filter(m=>m.name===d).length||n.unshift(Object.assign(Object.assign({name:d},s?{init:Rw(s[u])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${Yt(l.field)}] : null`}]:[],bind:(f=(c=o[l.field])!==null&&c!==void 0?c:o[l.channel])!==null&&f!==void 0?f:o}))}),n},signals:(e,t,n)=>{let r=t.name,i=t.project,o=n.filter(u=>u.name===r+Os)[0],s=r+Kb,a=i.items.map(u=>bn(`${r}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(o.update=`${l} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},OY=Gun});var IN,qun,MY,$Y=w(()=>{"use strict";Vu();IN="_toggle",qun={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+IN,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{let n=t.name+Os,r=t.name+IN;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Wu(e)}}, `)+`${r} ? ${n} : null`}},MY=qun});var Hun,hrt,grt=w(()=>{"use strict";hw();st();Vu();Te();Vye();$Y();Hun={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=dt(n.clear)?ku(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(OY.has(t))for(let r of t.project.items){let i=n.findIndex(o=>o.name===bn(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if(t.type==="interval")for(let i of t.project.items){let o=n.findIndex(s=>s.name===i.signals.visual);if(r(o,"[0, 0]"),o===-1){let s=n.findIndex(a=>a.name===i.signals.data);r(s,"null")}}else{let i=n.findIndex(o=>o.name===t.name+Os);r(i,"null"),MY.has(t)&&(i=n.findIndex(o=>o.name===t.name+IN),r(i,"false"))}return n}},hrt=Hun});function pz(e,t){return`domain(${Yt(e.scaleName(t))})`}function Wye(e){var t;return e.parent&&od(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:Wye(e.parent.parent))}var Yun,id,mz=w(()=>{"use strict";st();Vu();St();nn();ti();Li();Yun={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{let n=t.scales=[];for(let r of t.project.items){let i=r.channel;if(!Ua(i))continue;let o=e.getScaleComponent(i),s=o?o.get("type"):void 0;if(!o||!Oo(s)){xe(he.SCALE_BINDINGS_CONTINUOUS);continue}let a={selection:t.name,field:r.field};o.set("selectionExtent",a,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{let r=t.scales.filter(s=>n.filter(a=>a.name===s.signals.data).length===0);if(!e.parent||Wye(e)||r.length===0)return n;let i=n.filter(s=>s.name===t.name)[0],o=i.update;if(o.indexOf(PY)>=0)i.update=`{${r.map(s=>`${Yt(s.field)}: ${s.signals.data}`).join(", ")}}`;else{for(let s of r){let a=`${Yt(s.field)}: ${s.signals.data}`;o.indexOf(a)<0&&(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!Wye(e))for(let r of t.scales){let i=n.filter(o=>o.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}},id=Yun});function yrt(e,t,n){var r;let i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;i0(e,o=>{var s,a;let l=(s=o.project.hasField[i])!==null&&s!==void 0?s:o.project.hasChannel[t];if(l&&xrt.has(o)){let u=(a=n.get("selections"))!==null&&a!==void 0?a:[];u.push(o.name),n.set("selections",u,!1),l.hasLegend=!0}})}var xrt,brt,Gye=w(()=>{"use strict";hw();st();Vu();nn();hN();Te();kN();$Y();xrt={has:e=>{let t=e.resolve==="global"&&e.bind&&nz(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Gb;return t&&!n&&xe(he.LEGEND_BINDINGS_PROJECT_LENGTH),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){let a='event.item && indexof(event.item.mark.role, "legend") < 0';for(let l of t.events)l.filter=_n((i=l.filter)!==null&&i!==void 0?i:[]),l.filter.indexOf(a)<0&&l.filter.push(a)}let o=cY(t.bind)?t.bind.legend:"click",s=dt(o)?ku(o,"view"):_n(o);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{let r=t.name,i=cY(t.bind)&&t.bind.legend,o=s=>a=>{let l=at(a);return l.markname=s,l};for(let s of t.project.items){if(!s.hasLegend)continue;let a=`${bn(s.field)}_legend`,l=`${r}_${a}`;if(n.filter(c=>c.name===l).length===0){let c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:l},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]}))}}return n},signals:(e,t,n)=>{let r=t.name,i=t.project,o=n.find(d=>d.name===r+Os),s=r+Kb,a=i.items.filter(d=>d.hasLegend).map(d=>bn(`${r}_${bn(d.field)}_legend`)),u=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:u}):a.length>0&&(o.update=u,delete o.value,delete o.on);let c=n.find(d=>d.name===r+IN),f=cY(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}},brt=xrt});function vrt(e,t,n,r,i){var o;let s=t.name,a=s+wrt,l=s+Crt,u=n.channel,c=id.has(t),f=i.filter(v=>v.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,p=e.getScaleComponent(u),m=p.get("type"),h=c&&u===jn?"-":"",g=`${a}.extent_${u}`,x=`${h}${l}.${u} / `+(c?`${d}`:`span(${g})`),y=`${c?m==="log"?"panLog":m==="pow"?"panPow":"panLinear":"panLinear"}(${g}, ${x}`+(c&&m==="pow"?`, ${(o=p.get("exponent"))!==null&&o!==void 0?o:1}`:"")+")";f.on.push({events:{signal:l},update:c?y:`clampRange(${y}, 0, ${d})`})}var wrt,Crt,Kun,_rt,Srt=w(()=>{"use strict";hw();St();LY();mz();wrt="_translate_anchor",Crt="_translate_delta",Kun={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{let r=t.name,i=id.has(t),o=r+wrt,{x:s,y:a}=t.project.hasChannel,l=ku(t.translate,"scope");return i||(l=l.map(u=>(u.between[0].markname=r+A2,u))),n.push({name:o,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(s!==void 0?", extent_x: "+(i?pz(e,jn):`slice(${s.signals.visual})`):"")+(a!==void 0?", extent_y: "+(i?pz(e,qr):`slice(${a.signals.visual})`):"")+"}"}]},{name:r+Crt,value:{},on:[{events:l,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),s!==void 0&&vrt(e,t,s,"width",n),a!==void 0&&vrt(e,t,a,"height",n),n}},_rt=Kun});function Ert(e,t,n,r,i){var o;let s=t.name,a=n.channel,l=id.has(t),u=i.filter(b=>b.name===n.signals[l?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(a),d=f.get("type"),p=l?pz(e,a):u.name,m=s+Trt,h=`${s}${Art}.${a}`,x=`${l?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${p}, ${h}, ${m}`+(l&&d==="pow"?`, ${(o=f.get("exponent"))!==null&&o!==void 0?o:1}`:"")+")";u.on.push({events:{signal:m},update:l?x:`clampRange(${x}, 0, ${c})`})}var Art,Trt,Xun,krt,Irt=w(()=>{"use strict";hw();st();St();LY();mz();Art="_zoom_anchor",Trt="_zoom_delta",Xun={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{let r=t.name,i=id.has(t),o=r+Trt,{x:s,y:a}=t.project.hasChannel,l=Yt(e.scaleName(jn)),u=Yt(e.scaleName(qr)),c=ku(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+A2,f))),n.push({name:r+Art,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),s!==void 0&&Ert(e,t,s,"width",n),a!==void 0&&Ert(e,t,a,"height",n),n}},krt=Xun});function DN(e,t){for(let n of Zun)n.has(e)&&t(n)}var Zun,qye=w(()=>{"use strict";grt();Vye();Uye();kN();mz();Gye();$Y();Srt();Irt();Zun=[mrt,MY,id,brt,_rt,krt,OY,RY,hrt]});function Rw(e,t=!0,n=eH){if(ze(e)){let r=e.map(i=>Rw(i,t,n));return t?`[${r.join(", ")}]`:r}else if(Wg(e))return n(t?Cw(e):ctt(e));return t?n(JSON.stringify(e)):e}function Drt(e,t){return i0(e,(n,r)=>{let i=n.name,o=r.modifyExpr(e,n);t.push(...r.signals(e,n)),DN(n,s=>{s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(o=s.modifyExpr(e,n,o))}),t.push({name:i+$rt,on:[{events:{signal:n.name+Os},update:`modify(${Yt(n.name+Qp)}, ${o})`}]})}),Yye(t)}function Nrt(e,t){if(e.component.selection&&pe(e.component.selection).length){let n=Yt(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:ku("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Yye(t)}function Frt(e,t){let n=!1;return i0(e,(r,i)=>{let o=r.name,s=Yt(o+Qp);if(t.filter(l=>l.name===o).length===0){let l=r.resolve==="global"?"union":r.resolve,u=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${PY}(${s}, ${Yt(l)}${u}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),DN(r,l=>{l.topLevelSignals&&(t=l.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),Yye(t)}function Rrt(e,t){let n=[...t];return i0(e,r=>{let i={name:r.name+Qp};if(r.init){let s=r.project.items.map(l=>{let{signals:u}=l;return Le(l,["signals"])}),a=r.init.map(l=>Rw(l,!1));i.values=r.type==="interval"?[{unit:Wu(e,{escape:!1}),fields:s,values:a}]:a.map(l=>({unit:Wu(e,{escape:!1}),fields:s,values:l}))}n.filter(s=>s.name===r.name+Qp).length||n.push(i)}),n}function Hye(e,t){return i0(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,DN(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function Ort(e,t){for(let n of e.children)Wn(n)&&(t=Hye(n,t));return t}function Mrt(e,t){let n=t.selection,r=e.getSelectionComponent(n,bn(n));return{signal:BY(r,t)}}function Yye(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}var E2=w(()=>{"use strict";cr();hw();st();Vu();JD();Te();Li();qye();_2()});function Jun(e,t,n,r){let i=n.channel,o=n.signals.visual,s=n.signals.data,a=id.has(t),l=Yt(e.scaleName(i)),u=e.getScaleComponent(i),c=u?u.get("type"):void 0,f=h=>`scale(${l}, ${h})`,d=e.getSizeSignalRef(i===jn?"width":"height").signal,p=`${i}(unit)`,m=Lrt(t,(h,g)=>[...h,{events:g.between[0],update:`[${p}, ${p}]`},{events:g,update:`[${o}[0], clamp(${p}, 0, ${d})]`}]);return m.push({events:{signal:t.name+Kye},update:Oo(c)?`[${f(`${s}[0]`)}, ${f(`${s}[1]`)}]`:"[0, 0]"}),a?[{name:s,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:Rw(r,!0,f)}:{value:[]}),{on:m}),Object.assign(Object.assign({name:s},r?{init:Rw(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${l}, ${o})`}]})]}function Lrt(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(xe(`${r} is not an ordered event stream for interval selections.`),n),[])}var A2,Kye,Qun,Prt,LY=w(()=>{"use strict";cr();st();Vu();St();nn();ti();Te();E2();kN();mz();A2="_brush",Kye="_scale_trigger",Qun={signals:(e,t)=>{let n=t.name,r=n+Kb,i=id.has(t),o=[],s=[],a=[];if(t.translate&&!i){let c=`!event.item || event.item.mark.name !== ${Yt(n+A2)}`;Lrt(t,(f,d)=>{var p;let m=_n((p=d.between[0].filter)!==null&&p!==void 0?p:d.between[0].filter=[]);return m.indexOf(c)<0&&m.push(c),f})}t.project.items.forEach((c,f)=>{let d=c.channel;if(d!==jn&&d!==qr){xe("Interval selections only support x and y encoding channels.");return}let p=t.init?t.init[f]:null,m=Jun(e,t,c,p),h=c.signals.data,g=c.signals.visual,x=Yt(e.scaleName(d)),b=e.getScaleComponent(d).get("type"),y=Oo(b)?"+":"";o.push(...m),s.push(h),a.push({scaleName:e.scaleName(d),expr:`(!isArray(${h}) || (${y}invert(${x}, ${g})[0] === ${y}${h}[0] && ${y}invert(${x}, ${g})[1] === ${y}${h}[1]))`})}),i||o.push({name:n+Kye,value:{},on:[{events:a.map(c=>({scale:c.scaleName})),update:a.map(c=>c.expr).join(" && ")+` ? ${n+Kye} : {}`}]});let l=t.init,u=`unit: ${Wu(e)}, fields: ${r}, values`;return o.concat(Object.assign(Object.assign({name:n+Os},l?{init:`{${u}: ${Rw(l)}}`}:{}),{on:[{events:[{signal:s.join(" || ")}],update:s.join(" && ")+` ? {${u}: [${s}]} : null`}]}))},modifyExpr:(e,t)=>t.name+Os+", "+(t.resolve==="global"?"true":`{unit: ${Wu(e)}}`),marks:(e,t,n)=>{let r=t.name,{x:i,y:o}=t.project.hasChannel,s=i&&i.signals.visual,a=o&&o.signals.visual,l=`data(${Yt(t.name+Qp)})`;if(id.has(t))return n;let u={x:i!==void 0?{signal:`${s}[0]`}:{value:0},y:o!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${s}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(let g of pe(u))u[g]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${Wu(e)}`},u[g]),{value:0}];let c=t.mark,{fill:f,fillOpacity:d,cursor:p}=c,m=Le(c,["fill","fillOpacity","cursor"]),h=pe(m).reduce((g,x)=>(g[x]=[{test:[i!==void 0&&`${s}[0] !== ${s}[1]`,o!==void 0&&`${a}[0] !== ${a}[1]`].filter(b=>b).join(" && "),value:m[x]},{value:null}],g),{});return[{name:r+A2+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:u}},...n,{name:r+A2,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},p?{cursor:{value:p}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),h)}}]}},Prt=Qun});function Xye(e,t){let n=t.name,r=n+Kb,i=t.project,o="(item().isVoronoi ? datum.datum : datum)",s=i.items.map(u=>{let c=e.fieldDef(u.channel);return c&&c.bin?`[${o}[${Yt(e.vgField(u.channel,{}))}], ${o}[${Yt(e.vgField(u.channel,{binSuffix:"end"}))}]]`:`${o}[${Yt(u.field)}]`}).join(", "),a=`unit: ${Wu(e)}, fields: ${r}, values`,l=t.events;return[{name:n+Os,on:l?[{events:l,update:`datum && item().mark.marktype !== 'group' ? {${a}: [${s}]} : null`,force:!0}]:[]}]}var ecn,Brt,Zye=w(()=>{"use strict";st();Vu();kN();ecn={signals:Xye,modifyExpr:(e,t)=>t.name+Os+", "+(t.resolve==="global"?"null":`{unit: ${Wu(e)}}`)},Brt=ecn});var tcn,zrt,Urt=w(()=>{"use strict";Vu();Zye();tcn={signals:Xye,modifyExpr:(e,t)=>t.name+Os+", "+(t.resolve==="global"?"true":`{unit: ${Wu(e)}}`)},zrt=tcn});function i0(e,t){let n=e.component.selection;if(n){for(let r of Xf(n))if(t(r,ncn[r.type])===!0)break}}function rcn(e){let t=e.parent;for(;t&&!Ms(t);)t=t.parent;return t}function Wu(e,{escape:t}={escape:!0}){let n=t?Yt(e.name):e.name,r=rcn(e);if(r){let{facet:i}=r;for(let o of Ds)i[o]&&(n+=` + '__facet_${o}_' + (facet[${Yt(r.vgField(o))}])`)}return n}function hz(e){let t=!1;return i0(e,n=>{t=t||n.project.items.some(r=>r.field===Gb)}),t}var Qp,Os,$rt,PY,ncn,Vu=w(()=>{"use strict";st();St();hN();Te();Li();LY();Zye();Urt();Qp="_store",Os="_tuple",$rt="_modify",PY="vlSelectionResolve",ncn={single:zrt,multi:Brt,interval:Prt}});function Gu(e){this.type=e}function icn(e){switch(e.type){case qrt:return e.elements;case Hrt:case Xrt:return[e.left,e.right];case Yrt:return[e.callee].concat(e.arguments);case Krt:return[e.test,e.consequent,e.alternate];case Zrt:return[e.object,e.property];case Qrt:return e.properties;case Wrt:return[e.key,e.value];case Jrt:return[e.argument];case Grt:case Vrt:case jrt:default:return[]}}var jrt,Vrt,Wrt,Grt,qrt,Hrt,Yrt,Krt,Xrt,Zrt,Qrt,Jrt,Qye=w(()=>{"use strict";jrt="RawCode",Vrt="Literal",Wrt="Property",Grt="Identifier",qrt="ArrayExpression",Hrt="BinaryExpression",Yrt="CallExpression",Krt="ConditionalExpression",Xrt="LogicalExpression",Zrt="MemberExpression",Qrt="ObjectExpression",Jrt="UnaryExpression";Gu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=icn(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1}});function WY(e,t){if(!e)throw new Error("ASSERT: "+t)}function Xb(e){return e>=48&&e<=57}function ive(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function xz(e){return"01234567".indexOf(e)>=0}function Scn(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function yz(e){return e===10||e===13||e===8232||e===8233}function Cz(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Ccn.test(String.fromCharCode(e))}function UY(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&_cn.test(String.fromCharCode(e))}function uit(){for(var e;_e<Ha&&(e=gt.charCodeAt(_e),Scn(e)||yz(e));)++_e}function rve(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)_e<Ha&&ive(gt[_e])?(r=gt[_e++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):fr({},la,qa);return String.fromCharCode(i)}function Acn(){var e,t,n,r;for(e=gt[_e],t=0,e==="}"&&fr({},la,qa);_e<Ha&&(e=gt[_e++],!!ive(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&fr({},la,qa),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function cit(){var e,t;for(e=gt.charCodeAt(_e++),t=String.fromCharCode(e),e===92&&(gt.charCodeAt(_e)!==117&&fr({},la,qa),++_e,e=rve("u"),(!e||e==="\\"||!Cz(e.charCodeAt(0)))&&fr({},la,qa),t=e);_e<Ha&&(e=gt.charCodeAt(_e),!!UY(e));)++_e,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),gt.charCodeAt(_e)!==117&&fr({},la,qa),++_e,e=rve("u"),(!e||e==="\\"||!UY(e.charCodeAt(0)))&&fr({},la,qa),t+=e);return t}function Tcn(){var e,t;for(e=_e++;_e<Ha;){if(t=gt.charCodeAt(_e),t===92)return _e=e,cit();if(UY(t))++_e;else break}return gt.slice(e,_e)}function kcn(){var e,t,n;return e=_e,t=gt.charCodeAt(_e)===92?cit():Tcn(),t.length===1?n=T2:Ecn.hasOwnProperty(t)?n=Ow:t==="null"?n=VY:t==="true"||t==="false"?n=jY:n=T2,{type:n,value:t,start:e,end:_e}}function eve(){var e=_e,t=gt.charCodeAt(_e),n,r=gt[_e],i,o,s;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_e,{type:qu,value:String.fromCharCode(t),start:e,end:_e};default:if(n=gt.charCodeAt(_e+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _e+=2,{type:qu,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:_e};case 33:case 61:return _e+=2,gt.charCodeAt(_e)===61&&++_e,{type:qu,value:gt.slice(e,_e),start:e,end:_e}}}if(s=gt.substr(_e,4),s===">>>=")return _e+=4,{type:qu,value:s,start:e,end:_e};if(o=s.substr(0,3),o===">>>"||o==="<<="||o===">>=")return _e+=3,{type:qu,value:o,start:e,end:_e};if(i=o.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return _e+=2,{type:qu,value:i,start:e,end:_e};if("<>=!+-*%&|^/".indexOf(r)>=0)return++_e,{type:qu,value:r,start:e,end:_e};fr({},la,qa)}function Icn(e){for(var t="";_e<Ha&&ive(gt[_e]);)t+=gt[_e++];return t.length===0&&fr({},la,qa),Cz(gt.charCodeAt(_e))&&fr({},la,qa),{type:I2,value:parseInt("0x"+t,16),start:e,end:_e}}function Dcn(e){for(var t="0"+gt[_e++];_e<Ha&&xz(gt[_e]);)t+=gt[_e++];return(Cz(gt.charCodeAt(_e))||Xb(gt.charCodeAt(_e)))&&fr({},la,qa),{type:I2,value:parseInt(t,8),octal:!0,start:e,end:_e}}function eit(){var e,t,n;if(n=gt[_e],WY(Xb(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=_e,e="",n!=="."){if(e=gt[_e++],n=gt[_e],e==="0"){if(n==="x"||n==="X")return++_e,Icn(t);if(xz(n))return Dcn(t);n&&Xb(n.charCodeAt(0))&&fr({},la,qa)}for(;Xb(gt.charCodeAt(_e));)e+=gt[_e++];n=gt[_e]}if(n==="."){for(e+=gt[_e++];Xb(gt.charCodeAt(_e));)e+=gt[_e++];n=gt[_e]}if(n==="e"||n==="E")if(e+=gt[_e++],n=gt[_e],(n==="+"||n==="-")&&(e+=gt[_e++]),Xb(gt.charCodeAt(_e)))for(;Xb(gt.charCodeAt(_e));)e+=gt[_e++];else fr({},la,qa);return Cz(gt.charCodeAt(_e))&&fr({},la,qa),{type:I2,value:parseFloat(e),start:t,end:_e}}function Ncn(){var e="",t,n,r,i,o=!1;for(t=gt[_e],WY(t==="'"||t==='"',"String literal must starts with a quote"),n=_e,++_e;_e<Ha;)if(r=gt[_e++],r===t){t="";break}else if(r==="\\")if(r=gt[_e++],!r||!yz(r.charCodeAt(0)))switch(r){case"u":case"x":gt[_e]==="{"?(++_e,e+=Acn()):e+=rve(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:xz(r)?(i="01234567".indexOf(r),i!==0&&(o=!0),_e<Ha&&xz(gt[_e])&&(o=!0,i=i*8+"01234567".indexOf(gt[_e++]),"0123".indexOf(r)>=0&&_e<Ha&&xz(gt[_e])&&(i=i*8+"01234567".indexOf(gt[_e++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&gt[_e]===`
`&&++_e;else{if(yz(r.charCodeAt(0)))break;e+=r}return t!==""&&fr({},la,qa),{type:wz,value:e,octal:o,start:n,end:_e}}function Fcn(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";fr({},nve)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{fr({},nve)}try{return new RegExp(e,t)}catch{return null}}function Rcn(){var e,t,n,r,i;for(e=gt[_e],WY(e==="/","Regular expression literal must start with a slash"),t=gt[_e++],n=!1,r=!1;_e<Ha;)if(e=gt[_e++],t+=e,e==="\\")e=gt[_e++],yz(e.charCodeAt(0))&&fr({},Jye),t+=e;else if(yz(e.charCodeAt(0)))fr({},Jye);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||fr({},Jye),i=t.substr(1,t.length-2),{value:i,literal:t}}function Ocn(){var e,t,n;for(t="",n="";_e<Ha&&(e=gt[_e],!!UY(e.charCodeAt(0)));)++_e,e==="\\"&&_e<Ha?fr({},la,qa):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&fr({},nve,n),{value:n,literal:t}}function Mcn(){var e,t,n,r;return _r=null,uit(),e=_e,t=Rcn(),n=Ocn(),r=Fcn(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_e}}function $cn(e){return e.type===T2||e.type===Ow||e.type===jY||e.type===VY}function fit(){var e;return uit(),_e>=Ha?{type:vz,start:_e,end:_e}:(e=gt.charCodeAt(_e),Cz(e)?kcn():e===40||e===41||e===59?eve():e===39||e===34?Ncn():e===46?Xb(gt.charCodeAt(_e+1))?eit():eve():Xb(e)?eit():eve())}function Hu(){var e;return e=_r,_e=e.end,_r=fit(),_e=e.end,e}function dit(){var e;e=_e,_r=fit(),_e=e}function Pcn(e){var t=new Gu(scn);return t.elements=e,t}function tit(e,t,n){var r=new Gu(e==="||"||e==="&&"?fcn:acn);return r.operator=e,r.left=t,r.right=n,r}function Lcn(e,t){var n=new Gu(lcn);return n.callee=e,n.arguments=t,n}function Bcn(e,t,n){var r=new Gu(ucn);return r.test=e,r.consequent=t,r.alternate=n,r}function ove(e){var t=new Gu(ait);return t.name=e,t}function gz(e){var t=new Gu(ccn);return t.value=e.value,t.raw=gt.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function nit(e,t,n){var r=new Gu(dcn);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function zcn(e){var t=new Gu(pcn);return t.properties=e,t}function rit(e,t,n){var r=new Gu(mcn);return r.key=t,r.value=n,r.kind=e,r}function Ucn(e,t){var n=new Gu(hcn);return n.operator=e,n.argument=t,n.prefix=!0,n}function fr(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(o,s){return WY(s<r.length,"Message reference must be in range"),r[s]});throw n=new Error(i),n.index=_e,n.description=i,n}function GY(e){e.type===vz&&fr(e,vcn),e.type===I2&&fr(e,gcn),e.type===wz&&fr(e,xcn),e.type===T2&&fr(e,bcn),e.type===Ow&&fr(e,ycn),fr(e,la,e.value)}function Ya(e){var t=Hu();(t.type!==qu||t.value!==e)&&GY(t)}function di(e){return _r.type===qu&&_r.value===e}function tve(e){return _r.type===Ow&&_r.value===e}function jcn(){var e=[];for(_e=_r.start,Ya("[");!di("]");)di(",")?(Hu(),e.push(null)):(e.push(k2()),di("]")||Ya(","));return Hu(),Pcn(e)}function iit(){var e;return _e=_r.start,e=Hu(),e.type===wz||e.type===I2?(e.octal&&fr(e,lit),gz(e)):ove(e.value)}function Vcn(){var e,t,n,r;if(_e=_r.start,e=_r,e.type===T2)return n=iit(),Ya(":"),r=k2(),rit("init",n,r);if(e.type===vz||e.type===qu)GY(e);else return t=iit(),Ya(":"),r=k2(),rit("init",t,r)}function Wcn(){var e=[],t,n,r,i={},o=String;for(_e=_r.start,Ya("{");!di("}");)t=Vcn(),t.key.type===ait?n=t.key.name:n=o(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?fr({},wcn):i[r]=!0,e.push(t),di("}")||Ya(",");return Ya("}"),zcn(e)}function Gcn(){var e;return Ya("("),e=sve(),Ya(")"),e}function Hcn(){var e,t,n;if(di("("))return Gcn();if(di("["))return jcn();if(di("{"))return Wcn();if(e=_r.type,_e=_r.start,e===T2||qcn[_r.value])n=ove(Hu().value);else if(e===wz||e===I2)_r.octal&&fr(_r,lit),n=gz(Hu());else{if(e===Ow)throw new Error(bz);e===jY?(t=Hu(),t.value=t.value==="true",n=gz(t)):e===VY?(t=Hu(),t.value=null,n=gz(t)):di("/")||di("/=")?(n=gz(Mcn()),dit()):GY(Hu())}return n}function Ycn(){var e=[];if(Ya("("),!di(")"))for(;_e<Ha&&(e.push(k2()),!di(")"));)Ya(",");return Ya(")"),e}function Kcn(){var e;return _e=_r.start,e=Hu(),$cn(e)||GY(e),ove(e.value)}function Xcn(){return Ya("."),Kcn()}function Zcn(){var e;return Ya("["),e=sve(),Ya("]"),e}function Qcn(){var e,t,n;for(e=Hcn();;)if(di("."))n=Xcn(),e=nit(".",e,n);else if(di("("))t=Ycn(),e=Lcn(e,t);else if(di("["))n=Zcn(),e=nit("[",e,n);else break;return e}function oit(){var e=Qcn();if(_r.type===qu&&(di("++")||di("--")))throw new Error(bz);return e}function zY(){var e,t;if(_r.type!==qu&&_r.type!==Ow)t=oit();else{if(di("++")||di("--"))throw new Error(bz);if(di("+")||di("-")||di("~")||di("!"))e=Hu(),t=zY(),t=Ucn(e.value,t);else{if(tve("delete")||tve("void")||tve("typeof"))throw new Error(bz);t=oit()}}return t}function sit(e){var t=0;if(e.type!==qu&&e.type!==Ow)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break;default:break}return t}function Jcn(){var e,t,n,r,i,o,s,a,l,u;if(e=_r,l=zY(),r=_r,i=sit(r),i===0)return l;for(r.prec=i,Hu(),t=[e,_r],s=zY(),o=[l,r,s];(i=sit(_r))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,l=o.pop(),t.pop(),n=tit(a,l,s),o.push(n);r=Hu(),r.prec=i,o.push(r),t.push(_r),n=zY(),o.push(n)}for(u=o.length-1,n=o[u],t.pop();u>1;)t.pop(),n=tit(o[u-1].value,o[u-2],n),u-=2;return n}function k2(){var e,t,n;return e=Jcn(),di("?")&&(Hu(),t=k2(),Ya(":"),n=k2(),e=Bcn(e,t,n)),e}function sve(){var e=k2();if(di(","))throw new Error(bz);return e}function ave(e){gt=e,_e=0,Ha=gt.length,_r=null,dit();var t=sve();if(_r.type!==vz)throw new Error("Unexpect token after expression.");return t}var o0,gt,_e,Ha,_r,jY,vz,T2,Ow,VY,I2,qu,wz,ocn,scn,acn,lcn,ucn,ait,ccn,fcn,dcn,pcn,mcn,hcn,la,gcn,xcn,bcn,ycn,vcn,nve,Jye,lit,wcn,qa,bz,Ccn,_cn,Ecn,qcn,pit=w(()=>{"use strict";Qye();jY=1,vz=2,T2=3,Ow=4,VY=5,I2=6,qu=7,wz=8,ocn=9;o0={};o0[jY]="Boolean";o0[vz]="<end>";o0[T2]="Identifier";o0[Ow]="Keyword";o0[VY]="Null";o0[I2]="Numeric";o0[qu]="Punctuator";o0[wz]="String";o0[ocn]="RegularExpression";scn="ArrayExpression",acn="BinaryExpression",lcn="CallExpression",ucn="ConditionalExpression",ait="Identifier",ccn="Literal",fcn="LogicalExpression",dcn="MemberExpression",pcn="ObjectExpression",mcn="Property",hcn="UnaryExpression",la="Unexpected token %0",gcn="Unexpected number",xcn="Unexpected string",bcn="Unexpected identifier",ycn="Unexpected reserved word",vcn="Unexpected end of input",nve="Invalid regular expression",Jye="Invalid regular expression: missing /",lit="Octal literals are not allowed in strict mode.",wcn="Duplicate data property in object literal not allowed in strict mode",qa="ILLEGAL",bz="Disabled.",Ccn=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),_cn=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");Ecn={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};qcn={if:1}});var lve=w(()=>{"use strict"});function NN(e,t,n){return e.fields=t||[],e.fname=n,e}function efn(e){return e.length===1?tfn(e[0]):nfn(e)}function _z(e){throw Error(e)}function rfn(e){let t=[],n=e.length,r=null,i=0,o="",s,a,l;e=e+"";function u(){t.push(o+e.substring(s,a)),o="",s=a+1}for(s=a=0;a<n;++a)if(l=e[a],l==="\\")o+=e.substring(s,a++),s=a;else if(l===r)u(),r=null,i=-1;else{if(r)continue;s===i&&l==='"'||s===i&&l==="'"?(s=a+1,r=l):l==="."&&!i?a>s?u():s=a+1:l==="["?(a>s&&u(),i=s=a+1):l==="]"&&(i||_z("Access path missing open bracket: "+e),i>0&&u(),i=0,s=a+1)}return i&&_z("Access path missing closing bracket: "+e),r&&_z("Access path missing closing quote: "+e),a>s&&(a++,u()),t}function ifn(e,t,n){let r=rfn(e);return e=r.length===1?r[0]:e,NN((n&&n.get||efn)(r),[e],t||e)}var tfn,nfn,Lii,Bii,zii,Uii,jii,Vii,Wii,uve=w(()=>{"use strict";tfn=e=>function(t){return t[e]},nfn=e=>{let t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};Lii=ifn("id"),Bii=NN(e=>e,[],"identity"),zii=NN(()=>0,[],"zero"),Uii=NN(()=>1,[],"one"),jii=NN(()=>!0,[],"true"),Vii=NN(()=>!1,[],"false"),Wii=Array.isArray});var cve=w(()=>{"use strict";uve()});var mit=w(()=>{"use strict";lve();cve();uve()});var hit=w(()=>{"use strict";Qye();pit();mit();cve();lve()});function fve(e){let t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...fve(e.object)),t.push(...fve(e.property))),t)}function git(e){return e.object.type==="MemberExpression"?git(e.object):e.object.name==="datum"}function qY(e){let t=ave(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&git(r)&&n.add(fve(r).slice(1).join("."))}),n}var dve=w(()=>{"use strict";hit()});var s0,Sz=w(()=>{"use strict";Te();AY();Vn();dve();s0=class e extends Et{constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=S2(this.model,this.filter,this),this._dependentFields=qY(this.expr)}clone(){return new e(null,this.model,at(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}});function xit(e,t){var n;let r={},i=e.config.selection;for(let o of pe(t??{})){let s=at(t[o]),a=i[s.type],{fields:l,encodings:u}=a,c=Le(a,["fields","encodings"]);for(let p in c)p==="encodings"&&s.fields||p==="fields"&&s.encodings||(p==="mark"&&(s[p]=Object.assign(Object.assign({},c[p]),s[p])),(s[p]===void 0||s[p]===!0)&&(s[p]=(n=c[p])!==null&&n!==void 0?n:s[p]));let f=bn(o),d=r[f]=Object.assign(Object.assign({},s),{name:f,events:dt(s.on)?ku(s.on,"scope"):at(s.on)});DN(d,p=>{p.has(d)&&p.parse&&p.parse(e,d,s,t[o])})}return r}function EY(e,t,n,r="datum"){let i=[];function o(a){let l=bn(a),u=e.getSelectionComponent(l,a),c=Yt(l+Qp);if(u.project.timeUnit){let f=n??e.component.data.raw,d=u.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return u.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(u.resolve==="global"?")":`, ${Yt(u.resolve)})`)}let s=a2(t,o);return(i.length?"!("+i.map(a=>`length(data(${a}))`).join(" || ")+") || ":"")+`(${s})`}function BY(e,t){let n=t.encoding,r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&xe(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Yt(r)}.`);else if(n&&!r){let i=e.project.items.filter(o=>o.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,xe((i.length?"Multiple ":"No ")+`matching ${Yt(n)} encoding found for selection ${Yt(t.selection)}. Using "field": ${Yt(r)}.`)):r=i[0].field}return`${e.name}[${Yt(r)}]`}function bit(e,t){i0(e,n=>{let r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new Pi(new s0(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}var _2=w(()=>{"use strict";cr();hw();st();Vu();nn();Te();Vn();Sz();qye()});function S2(e,t,n){return a2(t,r=>dt(r)?r:wtt(r)?EY(e,r.selection,n):$H(r))}var AY=w(()=>{"use strict";st();g2();Te();_2()});function afn(e,t){if(e)return ze(e)&&!Zp(e)?e.map(n=>rye(n,t)).join(", "):e}function pve(e,t,n,r){var i,o,s;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(o=e.encode[t])!==null&&o!==void 0?o:{},e.encode[t].update=(s=e.encode[t].update)!==null&&s!==void 0?s:{},e.encode[t].update[n]=r}function FN(e,t,n,r={header:!1}){var i,o;let s=e.combine(),{disable:a,orient:l,scale:u,labelExpr:c,title:f,zindex:d}=s,p=Le(s,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(let m in p){let h=yet[m],g=p[m];if(h&&h!==t&&h!=="both")delete p[m];else if(zD(g)){let{condition:x}=g,b=Le(g,["condition"]),y=_n(x),v=Tbe[m];if(v){let{vgProp:C,part:_}=v,S=[...y.map(E=>{let{test:T}=E,I=Le(E,["test"]);return Object.assign({test:S2(null,T)},I)}),b];pve(p,_,C,S),delete p[m]}else if(v===null){let C={signal:y.map(_=>{let{test:S}=_,E=Le(_,["test"]);return`${S2(null,S)} ? ${oye(E)} : `}).join("")+oye(b)};p[m]=C}}else if(rt(g)){let x=Tbe[m];if(x){let{vgProp:b,part:y}=x;pve(p,y,b,g),delete p[m]}}}if(t==="grid"){if(!p.grid)return;if(p.encode){let{grid:m}=p.encode;p.encode=Object.assign({},m?{grid:m}:{}),cn(p.encode)&&delete p.encode}return Object.assign(Object.assign({scale:u,orient:l},p),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Sn(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let h=c;!((o=(i=p.encode)===null||i===void 0?void 0:i.labels)===null||o===void 0)&&o.update&&rt(p.encode.labels.update.text)&&(h=Ug(c,"datum.label",p.encode.labels.update.text.signal)),pve(p,"labels","text",{signal:h})}if(p.labelAlign===null&&delete p.labelAlign,p.encode){for(let h of yH)e.hasAxisPart(h)||delete p.encode[h];cn(p.encode)&&delete p.encode}let m=afn(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:l,grid:!1},m?{title:m}:{}),p),n.aria===!1?{aria:!1}:{}),{zindex:Sn(d,0)})}}}function HY(e){let{axes:t}=e.component,n=[];for(let r of Ki)if(t[r]){for(let i of t[r])if(!i.get("disable")&&!i.get("gridScale")){let o=r==="x"?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}}return n}function yit(e,t){let{x:n=[],y:r=[]}=e;return[...n.map(i=>FN(i,"grid",t)),...r.map(i=>FN(i,"grid",t)),...n.map(i=>FN(i,"main",t)),...r.map(i=>FN(i,"main",t))].filter(i=>i)}var Ez=w(()=>{"use strict";cr();st();PB();St();Tt();XB();Te();er();Cr();AY()});var mve,hve,vit,wit,Cit=w(()=>{"use strict";Te();mve={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},hve={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},vit=pe(mve),wit=pe(hve)});function _it(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){let o=n==="x"?"bottom":"left",s=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...pe(s),...pe(a)]),u={};for(let c of l.values())u[c]={signal:`${r.signal} === "${o}" ? ${Aw(s[c])} : ${Aw(a[c])}`};return u}return t[i]})])}function Sit(e,t,n,r){let i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:Ntt(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",s=rt(n)?"axisOrient":"axis"+l2(n),a=[...i,...i.map(u=>o+u.substr(4))],l=["axis",s,o];return{vlOnlyAxisConfig:_it(a,r,e,n),vgAxisConfig:_it(l,r,e,n),axisConfigStyle:lfn([...l,...a],r)}}function lfn(e,t){var n;let r=[{}];for(let i of e){let o=(n=t[i])===null||n===void 0?void 0:n.style;if(o){o=_n(o);for(let s of o)r.push(t.style[s])}}return Object.assign.apply(null,r)}function Az(e,t,n,r={}){var i;let o=aye(e,n,t.style);if(o!==void 0)return{configFrom:"style",configValue:o};for(let s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[s])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:s,configValue:r[s][e]};return{}}var gve=w(()=>{"use strict";st();ti();Te();er();Cr()});function ufn(e,t){return!Ti(e)&&Re(t)&&!mn(t?.bin)}function cfn(e,t){let n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Eit(e,t,n,r,i){let o=t?.labelAngle;if(o!==void 0)return rt(o)?o:u2(o);{let{configValue:s}=Az("labelAngle",e.config,t?.style,i);return s!==void 0?u2(s):n===jn&&Ve([qB,GB],r.type)?270:void 0}}function xve(e){return`(((${e.signal} % 360) + 360) % 360)`}function yve(e,t,n,r){if(e!==void 0)if(n==="x"){if(rt(e)){let i=xve(e),o=rt(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(rt(t)){let i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(rt(e)){let i=xve(e),o=rt(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(rt(t)){let i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function vve(e,t,n){if(e===void 0)return;let r=n==="x",i=r?0:90,o=r?"bottom":"left";if(rt(e)){let s=xve(e),a=rt(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${i?"("+s+" + 90)":s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(rt(t)){let s=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${s} "${o}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===o)?"left":"right"}function ffn(e,t){if(t==="x"&&Ve(["quantitative","temporal"],e))return!0}function dfn(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function Ait(e){return e==="x"?"bottom":"left"}function pfn({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!Ti(t)&&t!=="log"){if(Re(e)){if(mn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Ve(["month","hours","day","quarter"],(i=$i(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function wve(e,t){let n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;if(o&&s)return uye(o,s);if(o)return o;if(s)return s;if(o!==void 0)return o;if(s!==void 0)return s}function mfn(e,t){let n=e.values;if(ze(n))return XH(t,n);if(rt(n))return n}function hfn(e,t){return e==="rect"&&tye(t)?1:0}var bve,Cve=w(()=>{"use strict";st();sa();St();Tt();ti();Gg();Yc();Te();er();Cr();Qg();gve();bve={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{let{format:r,formatType:i}=n;return zH(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{let{formatType:r}=e;return UH(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return Re(e)&&Ai(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:ufn(n,e)},gridScale:({model:e,channel:t})=>cfn(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||vve(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||yve(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:ffn(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:dfn(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;let s=e==="x"?"width":e==="y"?"height":void 0,a=s?t.getSizeSignalRef(s):void 0;return(o=n.tickCount)!==null&&o!==void 0?o:pfn({fieldOrDatumDef:r,scaleType:i,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;let r=wve(t,n);if(r!==void 0)return r;let i=t.typedFieldDef(n),o=n==="x"?"x2":"y2",s=t.fieldDef(o);return lye(i?[Jbe(i)]:[],Re(s)?[Jbe(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>mfn(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:hfn(n,t)}}});function a0(e,t,n){return Ie(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}var D2,N2=w(()=>{"use strict";Tt();g2();Xp();Te();Vn();dve();D2=class e extends Et{constructor(t,n){super(t),this.transform=n,this._dependentFields=qY(this.transform.calculate)}clone(){return new e(null,at(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(sN(r)&&VH(r.sort)){let{field:o,timeUnit:s}=r,a=r.sort,l=a.map((u,c)=>`${$H({field:o,timeUnit:s,equal:u})} ? ${c} : `).join("")+a.length;t=new e(t,{calculate:l,as:a0(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${vt(this.transform)}`}}});function RN(e,t){return Ve(["top","bottom"],t)?"column":Ve(["left","right"],t)||e==="row"?"row":"column"}function Zb(e,t,n,r){let i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Sn((t?.header||{})[e],i[e],n.header[e])}function Tz(e,t,n,r){let i={};for(let o of e){let s=Zb(o,t,n,r);s!==void 0&&(i[o]=s)}return i}var YY=w(()=>{"use strict";Te()});var ON,MN,kz=w(()=>{"use strict";ON=["row","column"],MN=["header","footer"]});function Tit(e,t){let n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Tz(["titleAnchor","titleAngle","titleOrient"],i,r,t),l=RN(t,a),u=u2(s);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),Iit(u,l)),kit(l,u,o)),Fit(r,i,t,vit,mve))}}function kit(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}let r=vve(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function Iit(e,t){let n=yve(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Dit(e,t){let n=e.component.layoutHeaders[t],r=[];for(let i of MN)if(n[i])for(let o of n[i]){let s=xfn(e,t,i,n,o);s!=null&&r.push(s)}return r}function gfn(e,t){var n;let{sort:r}=e;return Rs(r)?{field:Ie(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:ze(r)?{field:a0(e,t,{expr:"datum"}),order:"ascending"}:{field:Ie(e,{expr:"datum"}),order:r??"ascending"}}function KY(e,t,n){let{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:l}=Tz(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),u=iN({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=RN(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?Ug(Ug(l,"datum.label",u),"datum.value",Ie(e,{expr:"parent"})):u}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Iit(o,c)),kit(c,o,s)),Fit(n,e,t,wit,hve))}function xfn(e,t,n,r,i){if(i){let o=null,{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){let{labelOrient:f}=Tz(["labelOrient"],s,a,t);(t==="row"&&!Ve(["top","bottom"],f)||t==="column"&&!Ve(["left","right"],f))&&(o=KY(s,t,a))}let l=Ms(e)&&!Jg(e.facet),u=i.axes,c=u?.length>0;if(o||c){let f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:gfn(s,t)}:{}),c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:u}:{})}}return null}function yfn(e,t){return bfn[t][e]}function Nit(e,t){let n={};for(let r of Ds){let i=e[r];if(i?.facetFieldDef){let{titleAnchor:o,titleOrient:s}=Tz(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),a=RN(r,s),l=yfn(o,a);l!==void 0&&(n[a]=l)}}return cn(n)?void 0:n}function Fit(e,t,n,r,i){let o={};for(let s of r){if(!i[s])continue;let a=Zb(s,t,e,n);a!==void 0&&(o[i[s]]=a)}return o}var bfn,_ve=w(()=>{"use strict";st();St();Tt();Cit();Xp();Wb();Te();Cve();N2();Qg();Li();YY();kz();bfn={column:{start:0,end:1},row:{start:1,end:0}}});function $N(e){return[...XY(e,"width"),...XY(e,"height"),...XY(e,"childWidth"),...XY(e,"childHeight")]}function XY(e,t){let n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];let i=e.getSizeSignalRef(t).signal;if(r==="step"){let o=e.getScaleComponent(n);if(o){let s=o.get("type"),a=o.get("range");if(Ti(s)&&ja(a)){let l=e.scaleName(n);return Ms(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Rit(l,a)]:[Rit(l,a),{name:i,update:Sve(l,o,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){let o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",a=iz(e.config.view,o?"width":"height"),l=`isFinite(${s}) ? ${s} : ${a}`;return[{name:i,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:i,value:r}]}function Rit(e,t){return{name:e+"_step",value:t.step}}function Sve(e,t,n){let r=t.get("type"),i=t.get("padding"),o=Sn(t.get("paddingOuter"),i),s=t.get("paddingInner");return s=r==="band"?s!==void 0?s:i:1,`bandspace(${n}, ${s}, ${o}) * ${e}_step`}var Iz=w(()=>{"use strict";kw();ti();Te();er();Li()});function ZY(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}var Eve=w(()=>{"use strict"});function QY(e,t){return pe(e).reduce((n,r)=>{let i=e[r];return Object.assign(Object.assign({},n),td(t,i,r,o=>rt(o)?o:{value:o.value}))},{})}var Ave=w(()=>{"use strict";Te();er();jl()});function Oit(e,t){if(od(t)||Ms(t))return"shared";if(LN(t))return Fs(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function PN(e,t){let n=e.scale[t],r=Fs(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&xe(he.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}var Dz=w(()=>{"use strict";St();nn();Li()});var vfn,Tve,JY,Mit=w(()=>{"use strict";tz();Te();Ul();vfn=Object.assign(Object.assign({},yye),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Tve=pe(vfn),JY=class extends Wa{}});function wfn(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){var s,a,l,u,c;if(o!=="symbol")return;let{markDef:f,encoding:d,config:p,mark:m}=n,h=f.filled&&m!=="trail",g=Object.assign(Object.assign({},Ztt({},n,Eet)),AN(n,{filled:h})),x=(s=$it(d.opacity))!==null&&s!==void 0?s:f.opacity;if(g.fill){if(r==="fill"||h&&r===Yi)delete g.fill;else if(g.fill.field)i.get("symbolFillColor")?delete g.fill:(g.fill=tr((a=p.legend.symbolBaseFillColor)!==null&&a!==void 0?a:"black"),g.fillOpacity=tr(x??1));else if(ze(g.fill)){let b=(c=(u=eK((l=d.fill)!==null&&l!==void 0?l:d.color))!==null&&u!==void 0?u:f.fill)!==null&&c!==void 0?c:h&&f.color;b&&(g.fill=tr(b))}}if(g.stroke){if(r==="stroke"||!h&&r===Yi)delete g.stroke;else if(g.stroke.field)delete g.stroke;else if(ze(g.stroke)){let b=Sn(eK(d.stroke||d.color),f.stroke,h?f.color:void 0);b&&(g.stroke={value:b})}}if(r!==Bl){let b=Re(t)&&Lit(n,i,t);b?g.opacity=[Object.assign({test:b},tr(x??1)),tr(p.legend.unselectedOpacity)]:x&&(g.opacity=tr(x))}return g=Object.assign(Object.assign({},g),e),cn(g)?void 0:g}function Cfn(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={},i=$it(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=tr(i)),r=Object.assign(Object.assign({},r),e),cn(r)?void 0:r}function _fn(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){let o=n.legend(r)||{},s=n.config,a=Re(t)?Lit(n,i,t):void 0,l=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=o,f=Zg(c)?YB({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:s}):void 0,d=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),f?{text:f}:{}),e);return cn(d)?void 0:d}function Sfn(e,{legendCmpt:t}){let n=t.get("selections");return n?.length?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function $it(e){return Pit(e,(t,n)=>Math.max(t,n.value))}function eK(e){return Pit(e,(t,n)=>Sn(t,n.value))}function Pit(e,t){if(Wtt(e))return _n(e.condition).reduce(t,e.value);if(Va(e))return e.value}function Lit(e,t,n){let r=t.get("selections");if(!r?.length)return;let i=Yt(n.field);return r.map(o=>`(!length(data(${Yt(bn(o)+Qp)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}var kve,Ive=w(()=>{"use strict";st();St();Tt();Ro();Te();Cr();Qg();jl();Vu();kve={symbols:wfn,gradient:Cfn,labels:_fn,entries:Sfn}});function Efn(e,t){let n=e.values;if(ze(n))return XH(t,n);if(rt(n))return n}function Afn(e,t,n,r){var i;if(t!=="shape"){let o=(i=eK(n))!==null&&i!==void 0?i:r;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function zit(e){let{legend:t}=e;return Sn(t.type,Tfn(e))}function Tfn({channel:e,timeUnit:t,scaleType:n}){if(Ub(e)){if(Ve(["quarter","month","day"],t))return"symbol";if(Pu(n))return"gradient"}return"symbol"}function Uit({legendConfig:e,legendType:t,orient:n,legend:r}){var i,o;return(o=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:kfn(n,t)}function kfn(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Ifn({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){let{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(Pu(i))return n==="horizontal"?r==="top"||r==="bottom"?Bit(t,"width",s,o):s:Bit(t,"height",l,a)}function Bit(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function Dfn(e){if(Ve(["quantile","threshold","log"],e))return"greedy"}var Dve,jit=w(()=>{"use strict";st();St();Tt();ti();Te();er();Qg();Ive();Dve={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{let{format:r,formatType:i}=t;return zH(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{let{formatType:r}=e;return UH(r,t,n)},gradientLength:e=>{var t,n;let{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:Ifn(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:Dfn(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:Afn(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>ed(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Ub(n)&&Pu(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Efn(t,e)}});function Nve(e){let t=Wn(e)?Nfn(e):Mfn(e);return e.component.legends=t,t}function Nfn(e){let{encoding:t}=e,n={};for(let r of[Yi,...uY]){let i=gr(t[r]);!i||!e.getScaleComponent(r)||r===Mi&&Re(i)&&i.type===Kp||(n[r]=Ofn(e,r))}return n}function Ffn(e,t){let n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Rfn(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(t==="title"&&e===r?.title)return!0}return e===(n||{})[t]}function Ofn(e,t){var n,r,i;let o=e.legend(t),{markDef:s,encoding:a,config:l}=e,u=l.legend,c=new JY({},Ffn(e,t));yrt(e,t,c);let f=o!==void 0?!o:u.disable;if(c.set("disable",f,o!==void 0),f)return c;o=o||{};let d=e.getScaleComponent(t).get("type"),p=gr(a[t]),m=Re(p)?(n=$i(p.timeUnit))===null||n===void 0?void 0:n.unit:void 0,h=o.orient||l.legend.orient||"right",g=zit({legend:o,channel:t,timeUnit:m,scaleType:d}),x=Uit({legend:o,legendType:g,orient:h,legendConfig:u}),b={legend:o,channel:t,model:e,markDef:s,encoding:a,fieldOrDatumDef:p,legendConfig:u,config:l,scaleType:d,orient:h,legendType:g,direction:x};for(let S of Tve){let E=S in Dve?Dve[S](b):o[S];if(E!==void 0){let T=Rfn(E,S,o,e.fieldDef(t));(T||l.legend[S]===void 0)&&c.set(S,E,T)}}let y=(r=o?.encoding)!==null&&r!==void 0?r:{},v=c.get("selections"),C={},_={fieldOrDatumDef:p,model:e,channel:t,legendCmpt:c,legendType:g};for(let S of["labels","legend","title","symbols","gradient","entries"]){let E=QY((i=y[S])!==null&&i!==void 0?i:{},e),T=S in kve?kve[S](E,_):E;T!==void 0&&!cn(T)&&(C[S]=Object.assign(Object.assign(Object.assign({},v?.length&&Re(p)?{name:`${bn(p.field)}_legend_${S}`}:{}),v?.length?{interactive:!!v}:{}),{update:T}))}return cn(C)||c.set("encode",C,!!o?.encoding),c}function Mfn(e){let{legends:t,resolve:n}=e.component;for(let r of e.children){Nve(r);for(let i of pe(r.component.legends))n.legend[i]=PN(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=Fve(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(let r of pe(t))for(let i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function Fve(e,t){var n,r,i,o;if(!e)return t.clone();let s=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;let l=!1;for(let u of Tve){let c=Uu(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(f,d)=>{switch(u){case"symbolType":return $fn(f,d);case"title":return JH(f,d);case"type":return l=!0,Ga("symbol")}return yN(f,d,u,"legend")});e.setWithExplicit(u,c)}return l&&(!((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0)&&r.gradient&&mH(e.implicit,["encode","gradient"]),!((o=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||o===void 0)&&o.gradient&&mH(e.explicit,["encode","gradient"])),e}function $fn(e,t){return t.value==="circle"?t:e}var Rve=w(()=>{"use strict";St();Tt();tz();Gg();Yc();Te();Cr();Ave();Li();Dz();Gye();Ul();Mit();Ive();jit()});function Vit(e,t,n,r){var i,o,s;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(o=e.encode[t])!==null&&o!==void 0?o:{},e.encode[t].update=(s=e.encode[t].update)!==null&&s!==void 0?s:{},e.encode[t].update[n]=r}function tK(e){let t=e.component.legends,n={};for(let i of pe(t)){let o=e.getScaleComponent(i),s=Gr(o.get("domains"));if(n[s])for(let a of n[s])Fve(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return Xf(n).flat().map(i=>Pfn(i,e.config)).filter(i=>i!==void 0)}function Pfn(e,t){var n,r,i;let o=e.combine(),{disable:s,labelExpr:a,selections:l}=o,u=Le(o,["disable","labelExpr","selections"]);if(!s){if(t.aria===!1&&u.aria==null&&(u.aria=!1),!((n=u.encode)===null||n===void 0)&&n.symbols){let c=u.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!u.stroke&&(c.stroke={value:"transparent"});for(let f of uY)u[f]&&delete c[f]}if(u.title||delete u.title,a!==void 0){let c=a;!((i=(r=u.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0)&&i.update&&rt(u.encode.labels.update.text)&&(c=Ug(a,"datum.label",u.encode.labels.update.text.signal)),Vit(u,"labels","text",{signal:c})}for(let c in u){let f=u[c];if(rt(f)){let d=hnt[c];if(d){let{vgProp:p,part:m}=d;Vit(u,m,p,f),delete u[c]}}}return u}}var Ove=w(()=>{"use strict";cr();tz();Te();er();Rve()});function Wit(e){return od(e)||LN(e)?Lfn(e):Git(e)}function Lfn(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),Git(e))}function Git(e){let t=e.component.projection;if(!t||t.merged)return[];let n=t.combine(),{name:r}=n;if(t.data){let i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{let l=rt(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Ve(s,l)||s.push(l),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}var qit=w(()=>{"use strict";Te();er();Li()});var Hit,Yit=w(()=>{"use strict";Hit=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"]});var Nz,Kit=w(()=>{"use strict";Ul();Nz=class extends Wa{constructor(t,n,r,i){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}});function Mve(e){e.component.projection=Wn(e)?Bfn(e):jfn(e)}function Bfn(e){var t;if(e.hasProjection){let n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=r?zfn(e):void 0;return new Nz(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,o)}}function zfn(e){let t=[],{encoding:n}=e;for(let r of[[Ll,Pl],[ia,La]])(gr(n[r[0]])||gr(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Mi)&&e.typedFieldDef(Mi).type===Kp&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(fo)),t}function Ufn(e,t){let n=_be(Hit,i=>!!(!zc(e.explicit,i)&&!zc(t.explicit,i)||zc(e.explicit,i)&&zc(t.explicit,i)&&Gr(e.get(i))===Gr(t.get(i))));if(Gr(e.size)===Gr(t.size)){if(n)return e;if(Gr(e.explicit)===Gr({}))return t;if(Gr(t.explicit)===Gr({}))return e}return null}function jfn(e){if(e.children.length===0)return;let t;for(let r of e.children)Mve(r);let n=_be(e.children,r=>{let i=r.component.projection;if(i)if(t){let o=Ufn(t,i);return o&&(t=o),!!o}else return t=i,!0;else return!0});if(t&&n){let r=e.projectionName(!0),i=new Nz(r,t.specifiedProjection,t.size,at(t.data));for(let o of e.children){let s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}var Xit=w(()=>{"use strict";st();St();Tt();r0();Yit();Yc();Te();Li();Kit()});function Vfn(e,t,n,r){var i,o;if(Kg(t,n)){let s=Wn(e)?(o=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&o!==void 0?o:{}:{},a=Ie(t,{expr:"datum"}),l=Ie(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Ie(t,{binSuffix:"range",forAs:!0}),formula:oN(a,l,s.format,s.formatType,r)}}return{}}function Qit(e,t){return`${DH(e)}_${t}`}function Wfn(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function BN(e,t,n){var r;let i=(r=ZD(n,void 0))!==null&&r!==void 0?r:{},o=Qit(i,t);return e.getName(`${o}_bins`)}function Gfn(e){return"as"in e}function Zit(e,t,n){let r,i;Gfn(e)?r=dt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Ie(e,{forAs:!0}),Ie(e,{binSuffix:"end",forAs:!0})];let o=Object.assign({},ZD(t,void 0)),s=Qit(o,e.field),{signal:a,extentSignal:l}=Wfn(n,s);if(XD(o.extent)){let c=o.extent,f=c.selection;i=BY(n.getSelectionComponent(bn(f),f),c),delete o.extent}let u=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[r]},a?{signal:a}:{}),l?{extentSignal:l}:{}),i?{span:i}:{});return{key:s,binComponent:u}}var Jp,F2=w(()=>{"use strict";cr();st();sa();Tt();Te();Qg();Li();_2();Vn();Jp=class e extends Et{constructor(t,n){super(t),this.bins=n}clone(){return new e(null,at(this.bins))}static makeFromEncoding(t,n){let r=n.reduceFieldDef((i,o,s)=>{if(Mo(o)&&mn(o.bin)){let{key:a,binComponent:l}=Zit(o,o.bin,n);i[a]=Object.assign(Object.assign(Object.assign({},l),i[a]),Vfn(n,o,s,n.config))}return i},{});return cn(r)?null:new e(t,r)}static makeFromTransform(t,n,r){let{key:i,binComponent:o}=Zit(n,n.bin,r);return new e(t,{[i]:o})}merge(t,n){for(let r of pe(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Uc([...this.bins[r].as,...t.bins[r].as],vt)):this.bins[r]=t.bins[r];for(let r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(Xf(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Xf(this.bins).map(t=>t.field))}hash(){return`Bin ${vt(this.bins)}`}assemble(){return Xf(this.bins).flatMap(t=>{let n=[],[r,...i]=t.as,o=t.bin,{extent:s}=o,a=Le(o,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Du(t.field),as:r,signal:t.signal},XD(s)?{extent:null}:{extent:s}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!s&&t.extentSignal&&(n.push({type:"extent",field:Du(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),n.push(l);for(let u of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Ie({field:r[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}});var Kc,zN=w(()=>{"use strict";r0();Te();Vn();Kc=class extends Et{constructor(t){super(null),t=t??{name:"source"};let n;if(n0(t)||(n=t.format?Object.assign({},Iu(t.format,["parse"])):{}),vN(t))this._data={values:t.values};else if(Iw(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];Ve(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Fye(t)?this._data={values:[{type:"Sphere"}]}:(SY(t)||n0(t))&&(this._data={});this._generator=n0(t),t.name&&(this._name=t.name),n&&!cn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}});function nK(e){for(let t of e){for(let n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!nK(t.children))return!1}return!0}var Jit=w(()=>{"use strict";Te();Vn();zN()});var Mw,rK=w(()=>{"use strict";Te();Vn();Mw=class e extends Et{constructor(t,n){super(t),this.params=n}clone(){return new e(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${vt(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}});var $w,iK=w(()=>{"use strict";Te();Vn();$w=class e extends Et{constructor(t,n){super(t),this.params=n}clone(){return new e(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${vt(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}});function Fz(e){return e instanceof Kc||e instanceof Mw||e instanceof $w}var oK,Xc,UN,$ve=w(()=>{"use strict";zN();rK();iK();oK=class{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}},Xc=class extends oK{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(Fz(t))return!1;let n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}},UN=class extends oK{}});function qfn(e,t,n,r){let i=Wn(r)?r.encoding[Ns(t)]:void 0;if(Mo(n)&&Wn(r)&&lN(t,n,i,r.stack,r.markDef,r.config))e.add(Ie(n,{})),e.add(Ie(n,{suffix:"end"})),n.bin&&Kg(n,t)&&e.add(Ie(n,{binSuffix:"range"}));else if(Uet(t)){let o=zet(t);e.add(r.getName(o))}else e.add(Ie(n));return e}function Hfn(e,t){var n;for(let r of pe(t)){let i=t[r];for(let o of pe(i))r in e?e[r][o]=new Set([...(n=e[r][o])!==null&&n!==void 0?n:[],...i[o]]):e[r]={[o]:i[o]}}}var sd,sK=w(()=>{"use strict";Bb();St();Tt();nn();Te();Li();Vn();sd=class e extends Et{constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}clone(){return new e(null,new Set(this.dimensions),at(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});let i={},o=new Set;return!r||(n.forEachFieldDef((s,a)=>{var l,u,c,f;let{aggregate:d,field:p}=s;if(d)if(d==="count")i["*"]=(l=i["*"])!==null&&l!==void 0?l:{},i["*"].count=new Set([Ie(s,{forAs:!0})]);else{if(Zf(d)||Gp(d)){let m=Zf(d)?"argmin":"argmax",h=d[m];i[h]=(u=i[h])!==null&&u!==void 0?u:{},i[h][m]=new Set([Ie({op:m,field:h},{forAs:!0})])}else i[p]=(c=i[p])!==null&&c!==void 0?c:{},i[p][d]=new Set([Ie(s,{forAs:!0})]);Ua(a)&&n.scaleDomain(a)==="unaggregated"&&(i[p]=(f=i[p])!==null&&f!==void 0?f:{},i[p].min=new Set([Ie({field:p,aggregate:"min"},{forAs:!0})]),i[p].max=new Set([Ie({field:p,aggregate:"max"},{forAs:!0})]))}else qfn(o,a,s,n)}),o.size+pe(i).length===0)?null:new e(t,o,i)}static makeFromTransform(t,n){var r,i,o;let s=new Set,a={};for(let l of n.aggregate){let{op:u,field:c,as:f}=l;u&&(u==="count"?(a["*"]=(r=a["*"])!==null&&r!==void 0?r:{},a["*"].count=new Set([f||Ie(l,{forAs:!0})])):(a[c]=(i=a[c])!==null&&i!==void 0?i:{},a[c][u]=new Set([f||Ie(l,{forAs:!0})])))}for(let l of(o=n.groupby)!==null&&o!==void 0?o:[])s.add(l);return s.size+pe(a).length===0?null:new e(t,s,a)}merge(t){return get(this.dimensions,t.dimensions)?(Hfn(this.measures,t.measures),!0):(stt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...pe(this.measures)])}producedFields(){let t=new Set;for(let n of pe(this.measures))for(let r of pe(this.measures[n])){let i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${vt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){let t=[],n=[],r=[];for(let o of pe(this.measures))for(let s of pe(this.measures[o]))for(let a of this.measures[o][s])r.push(a),t.push(s),n.push(o==="*"?null:Du(o));return{type:"aggregate",groupby:[...this.dimensions].map(Du),ops:t,fields:n,as:r}}}});var em,aK=w(()=>{"use strict";st();sa();St();Tt();nn();ti();Xp();Te();er();kz();VN();N2();Vn();em=class extends Et{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(let o of Ds){let s=n.facet[o];if(s){let{bin:a,sort:l}=s;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[Ie(s),...mn(a)?[Ie(s,{binSuffix:"end"})]:[]]},Rs(l)?{sortField:l}:ze(l)?{sortIndexField:a0(s,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(let n of Ds)this[n]&&(t+=` ${n.charAt(0)}:${vt(this[n])}`);return t}get fields(){var t;let n=[];for(let r of Ds)!((t=this[r])===null||t===void 0)&&t.fields&&n.push(...this[r].fields);return n}dependentFields(){let t=new Set(this.fields);for(let n of Ds)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){let t={};for(let n of Ki){let r=this.childModel.component.scales[n];if(r&&!r.merged){let i=r.get("type"),o=r.get("range");if(Ti(i)&&ja(o)){let s=Pw(this.childModel,n),a=jN(s);a?t[n]=a:xe(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){let i={row:"y",column:"x"}[t],o=[],s=[],a=[];r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));let{sortField:l,sortIndexField:u}=this[t];if(l){let{op:c=Ew,field:f}=l;o.push(f),s.push(c),a.push(Ie(l,{forAs:!0}))}else u&&(o.push(u),s.push("max"),a.push(u));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:s,as:a}:{})]}}assembleFacetHeaderData(t){var n,r;let{columns:i}=this.model.layout,{layoutHeaders:o}=this.model.component,s=[],a={};for(let c of ON){for(let f of MN){let d=(n=o[c]&&o[c][f])!==null&&n!==void 0?n:[];for(let p of d)if(((r=p.axes)===null||r===void 0?void 0:r.length)>0){a[c]=!0;break}}if(a[c]){let f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};s.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}let{row:l,column:u}=a;return(l||u)&&s.unshift(this.assembleRowColumnHeaderData("facet",null,t)),s}assemble(){var t,n;let r=[],i=null,o=this.getChildIndependentFieldsWithStep(),{column:s,row:a,facet:l}=this;if(s&&a&&(o.x||o.y)){i=`cross_${this.column.name}_${this.row.name}`;let u=[].concat((t=o.x)!==null&&t!==void 0?t:[],(n=o.y)!==null&&n!==void 0?n:[]),c=u.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:u,ops:c}]})}for(let u of[Ru,Fu])this[u]&&r.push(this.assembleRowColumnHeaderData(u,i,o));if(l){let u=this.assembleFacetHeaderData(o);u&&r.push(...u)}return r}}});function eot(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function Yfn(e,t){let n=hH(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){let r=eot(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){let r=eot(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return xe(he.unrecognizedParse(t)),null}function tot(e){let t={};return RB(e.filter,n=>{var r;if(Vbe(n)){let i=null;RH(n)?i=n.equal:OH(n)?i=n.range[0]:MH(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(Wg(i)?t[n.field]="date":ur(i)?t[n.field]="number":dt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function not(e){let t={};function n(r){aN(r)?t[r.field]="date":r.type==="quantitative"&&$et(r.aggregate)?t[r.field]="number":BD(r.field)>1?r.field in t||(t[r.field]="flatten"):sN(r)&&Rs(r.sort)&&BD(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((Wn(e)||Ms(e))&&e.forEachFieldDef((r,i)=>{if(Mo(r))n(r);else{let o=Hc(i),s=e.fieldDef(o);n(Object.assign(Object.assign({},r),{type:s.type}))}}),Wn(e)){let{mark:r,markDef:i,encoding:o}=e;if(Nu(r)&&!e.encoding.order){let s=i.orient==="horizontal"?"y":"x",a=o[s];Re(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function rot(e){let t={};if(Wn(e)&&e.component.selection)for(let n of pe(e.component.selection)){let r=e.component.selection[n];for(let i of r.project.items)!i.channel&&BD(i.field)>1&&(t[i.field]="flatten")}return t}var $s,lK=w(()=>{"use strict";st();Bb();St();Tt();r0();JD();nn();dH();Ro();g2();Xp();Te();Li();Ul();Vn();$s=class e extends Et{constructor(t,n){super(t),this._parse=n}clone(){return new e(null,at(this._parse))}hash(){return`Parse ${vt(this._parse)}`}static makeExplicit(t,n,r){let i={},o=n.data;return!n0(o)&&o&&o.format&&o.format.parse&&(i=o.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(let a of pe(r)){let l=i.getWithExplicit(a);l.value!==void 0&&(l.explicit||l.value===r[a]||l.value==="derived"||r[a]==="flatten"?delete r[a]:xe(he.differentParse(a,r[a],l.value)))}for(let a of pe(n)){let l=i.get(a);l!==void 0&&(l===n[a]?delete n[a]:xe(he.differentParse(a,n[a],l)))}let o=new Wa(n,r);i.copyAll(o);let s={};for(let a of pe(o.combine())){let l=o.get(a);l!==null&&(s[a]=l)}return pe(s).length===0||i.parseNothing?null:new e(t,s)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){let t={};for(let n of pe(this._parse)){let r=this._parse[n];BD(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(pe(this._parse))}dependentFields(){return new Set(pe(this._parse))}assembleTransforms(t=!1){return pe(this._parse).filter(n=>t?BD(n)>1:!0).map(n=>{let r=Yfn(n,this._parse[n]);return r?{type:"formula",expr:r,as:gH(n)}:null}).filter(n=>n!==null)}}});var tm,uK=w(()=>{"use strict";hN();Vn();tm=class e extends Et{clone(){return new e(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Gb])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Gb}}}});var nm,Rz=w(()=>{"use strict";Tt();Te();Te();Vn();nm=class e extends Et{constructor(t,n){super(t),this.transform=n}clone(){return new e(null,at(this.transform))}addDimensions(t){this.transform.groupby=Uc(this.transform.groupby.concat(t),n=>n)}dependentFields(){let t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ie(t)}hash(){return`JoinAggregateTransform ${vt(this.transform)}`}assemble(){let t=[],n=[],r=[];for(let o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);let i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}});function Kfn(e){return e.stack.stackBy.reduce((t,n)=>{let r=n.fieldDef,i=Ie(r);return i&&t.push(i),t},[])}function Xfn(e){return ze(e)&&e.every(t=>dt(t))&&e.length>1}var l0,cK=w(()=>{"use strict";st();Tt();Te();Cr();Vn();l0=class e extends Et{constructor(t,n){super(t),this._stack=n}clone(){return new e(null,at(this._stack))}static makeFromTransform(t,n){let{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],l=[];if(n.sort!==void 0)for(let f of n.sort)a.push(f.field),l.push(Sn(f.order,"ascending"));let u={field:a,order:l},c;return Xfn(o)?c=o:dt(o)?c=[o,o+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new e(t,{stackField:r,groupby:i,offset:s,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){let r=n.stack,{encoding:i}=n;if(!r)return null;let{groupbyChannel:o,fieldChannel:s,offset:a,impute:l}=r,u;if(o){let p=i[o];u=aa(p)}let c=Kfn(n),f=n.encoding.order,d;return ze(f)||Re(f)?d=QH(f):d=c.reduce((p,m)=>(p.field.push(m),p.order.push(s==="y"?"descending":"ascending"),p),{field:[],order:[]}),new e(t,{dimensionFieldDef:u,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:l,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){let t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${vt(this._stack)}`}getGroupbyFields(){let{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Ie(t,{binSuffix:"mid"})]:[Ie(t,{}),Ie(t,{binSuffix:"end"})]:[Ie(t)]:r??[]}assemble(){let t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:o,sort:s,offset:a,impute:l,as:u}=this._stack;if(l&&r){let{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Ie(r,{expr:"datum"})+`+${1-c}*`+Ie(r,{expr:"datum",binSuffix:"end"}),as:Ie(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...o,...n],key:Ie(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:u,offset:a}),t}}});var Qb,fK=w(()=>{"use strict";Bb();Tt();Te();Te();Vn();Qb=class e extends Et{constructor(t,n){super(t),this.transform=n}clone(){return new e(null,at(this.transform))}addDimensions(t){this.transform.groupby=Uc(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;let r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ie(t)}hash(){return`WindowTransform ${vt(this.transform)}`}assemble(){var t;let n=[],r=[],i=[],o=[];for(let d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),o.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);let s=this.transform.frame,a=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&r.every(d=>VD(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},a!==void 0?{groupby:a}:{});let l=[],u=[];if(this.transform.sort!==void 0)for(let d of this.transform.sort)l.push(d.field),u.push((t=d.order)!==null&&t!==void 0?t:"ascending");let c={field:l,order:u},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),a!==void 0?{groupby:a}:{}),s!==void 0?{frame:s}:{})}}});function Zfn(e){function t(n){if(!(n instanceof em)){let r=n.clone();if(r instanceof Pi){let i=Oz+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof sd||r instanceof l0||r instanceof Qb||r instanceof nm)&&r.addDimensions(e.fields);for(let i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function xK(e){if(e instanceof em)if(e.numChildren()===1&&!(e.children[0]instanceof Pi)){let t=e.children[0];(t instanceof sd||t instanceof l0||t instanceof Qb||t instanceof nm)&&t.addDimensions(e.fields),t.swapWithParent(),xK(e)}else{let t=e.model.component.data.main;iot(t);let n=Zfn(e),r=e.children.map(n).flat();for(let i of r)i.parent=t}else e.children.map(xK)}function iot(e){if(e instanceof Pi&&e.type===fo&&e.numChildren()===1){let t=e.children[0];t instanceof em||(t.swapWithParent(),iot(e))}}var dK,pK,mK,hK,gK,bK,yK,vK,wK,CK,_K,oot=w(()=>{"use strict";r0();Te();Vu();sK();F2();Vn();aK();Sz();lK();uK();Rz();SK();$ve();cK();dz();fK();dK=class extends Xc{run(t){let n=t.parent;if(t instanceof $s){if(Fz(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof $s)this.setMutated(),n.merge(t);else{if(Ebe(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}},pK=class extends UN{mergeNodes(t,n){let r=n.shift();for(let i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){let n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(let i of pe(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(let i of t.children)this.run(i);return this.mutatedFlag}},mK=class extends Xc{run(t){return t instanceof Pi||t.numChildren()>0||t instanceof em?this.flags:(this.setMutated(),t.remove(),this.flags)}},hK=class extends Xc{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof rd){let n=t.producedFields();Sbe(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}},gK=class extends Xc{run(t){this.setContinue();let r=t.parent.children.filter(o=>o instanceof rd),i=r.pop();for(let o of r)this.setMutated(),i.merge(o);return this.flags}};bK=class extends UN{constructor(){super()}run(t){t instanceof Pi&&!t.isRequired()&&(this.setMutated(),t.remove());for(let n of t.children)this.run(n);return this.mutatedFlag}},yK=class extends UN{constructor(t){super(),this.requiresSelectionId=t&&hz(t)}run(t){t instanceof tm&&(this.requiresSelectionId&&(Fz(t.parent)||t.parent instanceof sd||t.parent instanceof $s)||(this.setMutated(),t.remove()));for(let n of t.children)this.run(n);return this.mutatedFlag}},vK=class extends Xc{run(t){let n=t.parent,r=[...n.children],i=n.children.filter(o=>o instanceof $s);if(n.numChildren()>1&&i.length>=1){let o={},s=new Set;for(let a of i){let l=a.parse;for(let u of pe(l))u in o?o[u]!==l[u]&&s.add(u):o[u]=l[u]}for(let a of s)delete o[a];if(!cn(o)){this.setMutated();let a=new $s(n,o);for(let l of r){if(l instanceof $s)for(let u of pe(o))delete l.parse[u];n.removeChild(l),l.parent=a,l instanceof $s&&pe(l.parse).length===0&&l.remove()}}}return this.setContinue(),this.flags}},wK=class extends Xc{run(t){let n=t.parent,r=n.children.filter(o=>o instanceof sd),i={};for(let o of r){let s=vt(o.groupBy);s in i||(i[s]=[]),i[s].push(o)}for(let o of pe(i)){let s=i[o];if(s.length>1){let a=s.pop();for(let l of s)a.merge(l)&&(n.removeChild(l),l.parent=a,l.remove(),this.setMutated())}}return this.setContinue(),this.flags}},CK=class extends Xc{constructor(t){super(),this.model=t}run(t){let n=t.parent,r=!(Fz(n)||n instanceof s0||n instanceof $s||n instanceof tm),i=[],o=[];for(let s of n.children)s instanceof Jp&&(r&&!Ebe(n.producedFields(),s.dependentFields())?i.push(s):o.push(s));if(i.length>0){let s=i.pop();for(let a of i)s.merge(a,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Jp?n.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(o.length>1){let s=o.pop();for(let a of o)s.merge(a,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}},_K=class extends Xc{run(t){let n=t.parent,r=[...n.children];if(!xw(r,a=>a instanceof Pi)||n.numChildren()<=1)return this.setContinue(),this.flags;let o=[],s;for(let a of r)if(a instanceof Pi){let l=a;for(;l.numChildren()===1;){let u=l.children[0];if(u instanceof Pi)l=u;else break}o.push(...l.children),s?(n.removeChild(a),a.parent=s.parent,s.parent.removeChild(s),s.parent=l,this.setMutated()):s=l}else o.push(a);if(o.length){this.setMutated();for(let a of o)a.parent.removeChild(a),a.parent=s}return this.setContinue(),this.flags}}});function Lw(e){let t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(let i of r.children)n(i)}for(let r of e)n(r);return t}function Jfn(e){return e}function rm(e,t){return t.map(r=>{if(e instanceof Xc){let i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(Jfn)}function sot(e,t){let n=e.sources,r=new Set;return r.add(rm(new bK,n)),r.add(rm(new yK(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(rm(new mK,Lw(n))),n=n.filter(i=>i.numChildren()>0),r.add(rm(new dK,Lw(n))),r.add(rm(new CK(t),Lw(n))),r.add(rm(new hK,Lw(n))),r.add(rm(new vK,Lw(n))),r.add(rm(new wK,Lw(n))),r.add(rm(new gK,Lw(n))),r.add(rm(new pK,n)),r.add(rm(new _K,Lw(n))),e.sources=n,r.has(!0)}function aot(e,t){nK(e.sources);let n=0,r=0;for(let i=0;i<EK&&sot(e,t);i++)n++;e.sources.map(xK);for(let i=0;i<EK&&sot(e,t);i++)r++;nK(e.sources),Math.max(n,r)===EK&&xe(`Maximum optimization runs(${EK}) reached.`)}var Oz,EK,SK=w(()=>{"use strict";nn();Jit();$ve();oot();Oz="scale_",EK=5});var Ka,AK=w(()=>{"use strict";Ka=class e{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new e(()=>t(n))}}});function zve(e){Wn(e)?edn(e):tdn(e)}function edn(e){let t=e.component.scales;for(let n of pe(t)){let r=rdn(e,n);if(t[n].setWithExplicit("domains",r),odn(e,n),e.component.data.isFaceted){let o=e;for(;!Ms(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(let a of r.value)jb(a)&&(a.data=Oz+a.data.replace(Oz,""))}}}function tdn(e){for(let n of e.children)zve(n);let t=e.component.scales;for(let n of pe(t)){let r,i=null;for(let o of e.children){let s=o.component.scales[n];if(s){r===void 0?r=s.getWithExplicit("domains"):r=Uu(r,s.getWithExplicit("domains"),"domains","scale",Bve);let a=s.get("selectionExtent");i&&a&&i.selection!==a.selection&&xe("The same selection must be used to override scale domains in a layered view."),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function ndn(e,t,n,r){if(e==="unaggregated"){let{valid:i,reason:o}=lot(t,n);if(!i){xe(o);return}}else if(e===void 0&&r.useUnaggregatedDomain){let{valid:i}=lot(t,n);if(i)return"unaggregated"}return e}function rdn(e,t){let n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=ndn(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&gr(r.x2)?gr(r.x)?Uu(Bw(n,i,e,"x"),Bw(n,i,e,"x2"),"domain","scale",Bve):Bw(n,i,e,"x2"):t==="y"&&gr(r.y2)?gr(r.y)?Uu(Bw(n,i,e,"y"),Bw(n,i,e,"y2"),"domain","scale",Bve):Bw(n,i,e,"y2"):Bw(n,i,e,t)}function idn(e,t,n){return e.map(r=>({signal:`{data: ${WB(r,{timeUnit:n,type:t})}}`}))}function Pve(e,t,n){var r;let i=(r=$i(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?idn(e,t,i):[e]}function Bw(e,t,n,r){let{encoding:i}=n,o=gr(i[r]),{type:s}=o,a=o.timeUnit;if(Ott(t)){let f=Bw(e,void 0,n,r),d=Pve(t.unionWith,s,a);return Yb([...f.value,...d])}else{if(rt(t))return Yb([t]);if(t&&t!=="unaggregated"&&!qbe(t))return Yb(Pve(t,s,a))}let l=n.stack;if(l&&r===l.fieldChannel){if(l.offset==="normalize")return Ga([[0,1]]);let f=n.requestDataName(fo);return Ga([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}let u=Ua(r)&&Re(o)?sdn(n,r,e):void 0;if(Lu(o)){let f=Pve([o.datum],s,a);return Ga(f)}let c=o;if(t==="unaggregated"){let f=n.requestDataName(fo),{field:d}=o;return Ga([{data:f,field:Ie({field:d,aggregate:"min"})},{data:f,field:Ie({field:d,aggregate:"max"})}])}else if(mn(c.bin)){if(Ti(e))return e==="bin-ordinal"?Ga([]):Ga([{data:$B(u)?n.requestDataName(fo):n.requestDataName(wN),field:n.vgField(r,Kg(c,r)?{binSuffix:"range"}:{}),sort:u===!0||!lr(u)?{field:n.vgField(r,{}),op:"min"}:u}]);{let{bin:f}=c;if(mn(f)){let d=BN(n,c.field,f);return Ga([new Ka(()=>{let p=n.getSignalName(d);return`[${p}.start, ${p}.stop]`})])}else return Ga([{data:n.requestDataName(fo),field:n.vgField(r,{})}])}}else if(c.timeUnit&&Ve(["time","utc"],e)&&lN(r,c,Wn(n)?n.encoding[Ns(r)]:void 0,n.stack,n.markDef,n.config)){let f=n.requestDataName(fo);return Ga([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return u?Ga([{data:$B(u)?n.requestDataName(fo):n.requestDataName(wN),field:n.vgField(r),sort:u}]):Ga([{data:n.requestDataName(fo),field:n.vgField(r)}])}function Lve(e,t){let{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":Ew)},r?{field:Du(r)}:{}),i?{order:i}:{})}function odn(e,t){var n;let r=e.component.scales[t],i=e.specifiedScales[t].domain,o=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,s=qbe(i)&&i,a=ww(o)&&XD(o.extent)&&o.extent;(s||a)&&r.set("selectionExtent",s??a,!0)}function sdn(e,t,n){if(!Ti(n))return;let r=e.fieldDef(t),i=r.sort;if(VH(i))return{op:"min",field:a0(r,t),order:"ascending"};let{stack:o}=e,s=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(a=>a.fieldDef.field)]:void 0;if(Rs(i)){let a=o&&!Ve(s,i.field);return Lve(i,a)}else if(jH(i)){let{encoding:a,order:l}=i,u=e.fieldDef(a),{aggregate:c,field:f}=u,d=o&&!Ve(s,f);if(Zf(c)||Gp(c))return Lve({field:Ie(u),order:l},d);if(VD(c)||!c)return Lve({op:c,field:f,order:l},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Ve(["ascending",void 0],i))return!0}}function lot(e,t){let{aggregate:n,type:r}=e;return n?dt(n)&&!Let[n]?{valid:!1,reason:he.unaggregateDomainWithNonSharedDomainOp(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:he.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:he.unaggregateDomainHasNoEffectForRawField(e)}}function Bve(e,t,n,r){return e.explicit&&t.explicit&&xe(he.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function adn(e){let t=Uc(e.map(s=>{if(jb(s)){let{sort:a}=s;return Le(s,["sort"])}return s}),vt),n=Uc(e.map(s=>{if(jb(s)){let a=s.sort;return a!==void 0&&!$B(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(s=>s!==void 0),vt);if(t.length===0)return;if(t.length===1){let s=e[0];if(jb(s)&&n.length>0){let a=n[0];if(n.length>1)xe(he.MORE_THAN_ONE_SORT),a=!0;else if(lr(a)&&"field"in a){let l=a.field;s.field===l&&(a=a.order?{order:a.order}:!0)}return Object.assign(Object.assign({},s),{sort:a})}return s}let r=Uc(n.map(s=>$B(s)||!("op"in s)||s.op in Met?s:(xe(he.domainSortDropped(s)),!0)),vt),i;r.length===1?i=r[0]:r.length>1&&(xe(he.MORE_THAN_ONE_SORT),i=!0);let o=Uc(e.map(s=>jb(s)?s.data:null),s=>s);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:t.map(a=>a.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function jN(e){if(jb(e)&&dt(e.field))return e.field;if(xtt(e)){let t;for(let n of e.fields)if(jb(n)&&dt(n.field)){if(!t)t=n.field;else if(t!==n.field)return xe(he.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}return xe(he.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}else if(btt(e)){xe(he.FACETED_INDEPENDENT_SAME_SOURCE);let t=e.fields[0];return dt(t)?t:void 0}}function Pw(e,t){let r=e.component.scales[t].get("domains").map(i=>(jb(i)&&(i.data=e.lookupDataSource(i.data)),i));return adn(r)}var VN=w(()=>{"use strict";cr();st();Bb();sa();St();Tt();r0();nn();ti();Xp();Gg();Te();er();F2();N2();SK();Li();AK();Ul()});function Uve(e){return od(e)||LN(e)?e.children.reduce((t,n)=>t.concat(Uve(n)),uot(e)):uot(e)}function uot(e){return pe(e.component.scales).reduce((t,n)=>{let r=e.component.scales[n];if(r.merged)return t;let i=r.combine(),{name:o,type:s,selectionExtent:a,domains:l,range:u,reverse:c}=i,f=Le(i,["name","type","selectionExtent","domains","range","reverse"]),d=ldn(i.range,o,n),p;a&&(p=Mrt(e,a));let m=Pw(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:s},m?{domain:m}:{}),p?{domainRaw:p}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function ldn(e,t,n){return Fs(n)&&ja(e)?{step:{signal:t+"_step"}}:e}var cot=w(()=>{"use strict";cr();St();Te();er();Li();E2();VN()});var Mz,fot=w(()=>{"use strict";st();Te();Ul();Mz=class extends Wa{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:xw(this.get("domains"),t=>ze(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}});function hot(e){return e==="x"?"width":e==="y"?"height":void 0}function got(e){let t=e.component.scales;for(let n of vw){let r=t[n];if(!r)continue;let i=cdn(n,e);r.setWithExplicit("range",i)}}function dot(e,t){let n=e.fieldDef(t);if(n&&n.bin&&mn(n.bin)){let r=BN(e,n.field,n.bin),i=hot(t),o=e.getName(i);return new Ka(()=>{let s=e.getSignalName(r),a=`(${s}.stop - ${s}.start) / ${s}.step`;return`${e.getSignalName(o)} / (${a})`})}}function cdn(e,t){let n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(let s of udn)if(n[s]!==void 0){let a=PH(o,s),l=LH(e,s);if(!a)xe(he.scalePropertyNotWorkWithScaleType(o,s,e));else if(l)xe(l);else switch(s){case"range":return ze(n.range)&&Fs(e)?Yb(n.range.map(u=>{if(u==="width"||u==="height"){let c=t.getName(u),f=t.getSignalName.bind(t);return Ka.fromName(f,c)}return u})):Yb(n.range);case"scheme":return Yb(fdn(n[s]))}}if(e===jn||e===qr){let s=e===jn?"width":"height",a=r[s];if(zu(a)){if(Ti(o))return Yb({step:a.step});xe(he.stepDropped(s))}}return Ga(ddn(e,t))}function fdn(e){return Rtt(e)?Object.assign({scheme:e.name},Iu(e,["name"])):{scheme:e}}function ddn(e,t){let{size:n,config:r,mark:i,encoding:o}=t,s=t.getSignalName.bind(t),{type:a}=gr(o[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case jn:case qr:{if(Ve(["point","band"],u)){if(e===jn&&!n.width){let m=w2(r.view,"width");if(zu(m))return m}else if(e===qr&&!n.height){let m=w2(r.view,"height");if(zu(m))return m}}let d=hot(e),p=t.getName(d);return e===qr&&Oo(u)?[Ka.fromName(s,p),0]:[0,Ka.fromName(s,p)]}case $u:{let d=t.component.scales[e].get("zero"),p=xot(i,d,r),m=hdn(i,n,t,r);return tN(u)?mdn(p,m,pdn(u,r,c,e)):[p,m]}case $l:return[0,Math.PI*2];case Yp:return[0,360];case Mu:return[0,new Ka(()=>{let d=t.getSignalName("width"),p=t.getSignalName("height");return`min(${d},${p})/2`})];case Gc:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case qc:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Mi:return"symbol";case Yi:case Ba:case za:return u==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Bl:case Vc:case Wc:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function pdn(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&ze(n)?n.length+1:(xe(he.domainRequiredForThresholdScale(r)),3)}}function mdn(e,t,n){let r=()=>{let i=Aw(t),o=Aw(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return rt(t)?new Ka(r):{signal:r()}}function xot(e,t,n){if(t)return rt(t)?{signal:`${t.signal} ? 0 : ${xot(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(he.incompatibleChannel("size",e))}function hdn(e,t,n,r){let i={x:dot(n,"x"),y:dot(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;let o=mot(t,i,r.view);return ur(o)?o-1:new Ka(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;let o=mot(t,i,r.view);return ur(o)?Math.pow(pot*o,2):new Ka(()=>`pow(${pot} * ${o.signal}, 2)`)}}throw new Error(he.incompatibleChannel("size",e))}function mot(e,t,n){let r=zu(e.width)?e.width.step:v2(n,"width"),i=zu(e.height)?e.height.step:v2(n,"height");return t.x||t.y?new Ka(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}var udn,pot,bot=w(()=>{"use strict";st();sa();St();Tt();kw();nn();ti();y2();Te();er();F2();AK();Ul();Cr();udn=["range","scheme"];pot=.95});function jve(e,t){Wn(e)?gdn(e,t):vot(e,t)}function gdn(e,t){let n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(let a of pe(n)){let l=s[a],u=n[a],c=e.getScaleComponent(a),f=gr(i[a]),d=l[t],p=c.get("type"),m=c.get("padding"),h=c.get("paddingInner"),g=PH(p,t),x=LH(a,t);if(d!==void 0&&(g?x&&xe(x):xe(he.scalePropertyNotWorkWithScaleType(p,t,a))),g&&x===void 0)if(d!==void 0)u.copyKeyFromObject(t,l);else{let b=t in yot?yot[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:p,scalePadding:m,scalePaddingInner:h,domain:l.domain,markDef:o,config:r}):r.scale[t];b!==void 0&&u.set(t,b,!1)}}}function Vve(e){Wn(e)?got(e):vot(e,"range")}function vot(e,t){let n=e.component.scales;for(let r of e.children)t==="range"?Vve(r):jve(r,t);for(let r of pe(n)){let i;for(let o of e.children){let s=o.component.scales[r];if(s){let a=s.getWithExplicit(t);i=Uu(i,a,t,"scale",CY((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function xdn(e,t){let n=t.bin;if(mn(n)){let r=BN(e,t.field,n);return new Ka(()=>e.getSignalName(r))}else if(Ai(n)&&ww(n)&&n.step!==void 0)return{step:n.step}}function bdn(e,t){if(Ve([Yi,Ba,za],e)&&t!=="nominal")return"hcl"}function ydn(e,t,n){var r;if(!(!((r=aa(n))===null||r===void 0)&&r.bin||Ve([fi.TIME,fi.UTC],e)))return t in Vg?!0:void 0}function vdn(e,t,n,r,i,o){if(e in Vg){if(Pu(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;let{type:s,orient:a}=i;if(s==="bar"&&!(Re(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===fi.POINT)return n.pointPadding}}function wdn(e,t,n,r){if(e===void 0&&t in Vg){let{bandPaddingInner:i,barBandPaddingInner:o,rectBandPaddingInner:s}=r;return Sn(i,n==="bar"?o:s)}}function Cdn(e,t,n,r,i,o){if(e===void 0&&t in Vg&&n===fi.BAND){let{bandPaddingOuter:s}=o;return Sn(s,rt(i)?{signal:`${i.signal}/2`}:i/2)}}function _dn(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Oo(e)&&t==="descending"?rt(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Oo(e)&&t==="descending")return!0}function Sdn(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&Oo(i)){if(ze(n)){let s=n[0],a=n[n.length-1];if(s<=0&&a>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!tN(i))return!0;if(!(Re(t)&&t.bin)&&Ve([...Ki,...Ket],e)){let{orient:s,type:a}=r;return!(Ve(["bar","area","line","trail"],a)&&(s==="horizontal"&&e==="y"||s==="vertical"&&e==="x"))}return!1}var yot,wot=w(()=>{"use strict";st();sa();St();Tt();nn();ti();Te();Te();er();F2();Li();AK();Ul();bot();yot={bins:({model:e,fieldOrDatumDef:t})=>Re(t)?xdn(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>bdn(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>ydn(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>vdn(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>wdn(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:o})=>Cdn(e,t,n,r.type,i,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{let i=Re(e)?e.sort:void 0;return _dn(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>Sdn(e,t,n,r,i)}});function Cot(e,t,n,r){let i=Edn(t,n,r),{type:o}=e;return Ua(t)?o!==void 0?Kbe(t,o)?Re(n)&&!Ybe(o,n.type)?(xe(he.scaleTypeNotWorkWithFieldDef(o,i)),i):o:(xe(he.scaleTypeNotWorkWithChannel(t,o,i)),i):i:null}function Edn(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(Ub(e)||KD(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&xe(he.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(e in Vg){if(Ve(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in IH)return"band";return t.band!==void 0||YH(t)&&(!((r=t.axis)===null||r===void 0)&&r.tickBand)?"band":"point";case"temporal":return Ub(e)?"time":KD(e)==="discrete"?(xe(he.discreteChannelCannotEncode(e,"temporal")),"ordinal"):Re(t)&&t.timeUnit&&$i(t.timeUnit).utc?"utc":"time";case"quantitative":return Ub(e)?Re(t)&&mn(t.bin)?"bin-ordinal":"linear":KD(e)==="discrete"?(xe(he.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(he.invalidFieldType(t.type))}var _ot=w(()=>{"use strict";sa();St();Tt();nn();ti();Gg();Te();St()});function Sot(e,{ignoreRange:t}={}){Eot(e),zve(e);for(let n of Mtt)jve(e,n);t||Vve(e)}function Eot(e){Wn(e)?e.component.scales=Adn(e):e.component.scales=kdn(e)}function Adn(e){let{encoding:t,mark:n}=e;return vw.reduce((r,i)=>{let o=gr(t[i]);if(o&&n===wH&&i===Mi&&o.type===Kp)return r;let s=o&&o.scale;if(o&&s!==null&&s!==!1){s=s??{};let a=Cot(s,i,o,n);r[i]=new Mz(e.scaleName(i+"",!0),{value:a,explicit:s.type===a})}return r},{})}function kdn(e){var t;let n=e.component.scales={},r={},i=e.component.resolve;for(let o of e.children){Eot(o);for(let s of pe(o.component.scales))if(i.scale[s]=(t=i.scale[s])!==null&&t!==void 0?t:Oit(s,e),i.scale[s]==="shared"){let a=r[s],l=o.component.scales[s].getWithExplicit("type");a?Itt(a.value,l.value)?r[s]=Uu(a,l,"type","scale",Tdn):(i.scale[s]="independent",delete r[s]):r[s]=l}}for(let o of pe(r)){let s=e.scaleName(o,!0),a=r[o];n[o]=new Mz(s,a);for(let l of e.children){let u=l.component.scales[o];u&&(l.renameScale(u.get("name"),s),u.merged=!0)}}return n}var Tdn,Aot=w(()=>{"use strict";St();Tt();Ro();ti();Yc();Te();Li();Dz();Ul();fot();VN();wot();_ot();Tdn=CY((e,t)=>Gbe(e)-Gbe(t))});function Wn(e){return e?.type==="unit"}function Ms(e){return e?.type==="facet"}function LN(e){return e?.type==="concat"}function od(e){return e?.type==="layer"}var $z,R2,WN,Li=w(()=>{"use strict";cr();St();Tt();zl();nn();ti();xN();y2();XB();sz();Te();er();Ez();Cr();_ve();kz();Iz();Eve();Ove();Rve();qit();Xit();cot();VN();Aot();Ul();$z=class{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}};R2=class{constructor(t,n,r,i,o,s,a){var l,u;this.type=n,this.parent=r,this.config=o,this.view=a,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=o,this.name=(l=t.name)!==null&&l!==void 0?l:i,this.title=Zp(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new $z,this.projectionNameMap=r?r.projectionNameMap:new $z,this.signalNameMap=r?r.signalNameMap:new $z,this.data=t.data,this.description=t.description,this.transforms=lrt((u=t.transform)!==null&&u!==void 0?u:[]),this.layout=n==="layer"||n==="unit"?{}:bnt(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:Vb(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Wa,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},s?at(s):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Sot(this)}parseProjection(){Mve(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Nve(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){let{style:n}=t,r=Le(t,["style"]),i={};for(let o of pe(r)){let s=r[o];s!==void 0&&(i[o]=tr(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=tr(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):cn(n)?void 0:n}assembleLayout(){if(!this.layout)return;let t=this.layout,{spacing:n}=t,r=Le(t,["spacing"]),{component:i,config:o}=this,s=Nit(i.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),s?{titleBand:s}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){let{layoutHeaders:t}=this.component,n=[];for(let r of Ds)t[r].title&&n.push(Tit(this,r));for(let r of ON)n=n.concat(Dit(this,r));return n}assembleAxes(){return yit(this.component.axes,this.config)}assembleLegends(){return tK(this)}assembleProjections(){return Wit(this)}assembleTitle(){var t,n,r;let i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:o}=i,s=Le(i,["encoding"]),a=Object.assign(Object.assign(Object.assign({},ZH(this.config.title).nonMark),s),o?{encode:{update:o}}:{});if(a.text)return Ve(["unit","layer"],this.type)?Ve(["middle",void 0],a.anchor)&&(a.frame=(n=a.frame)!==null&&n!==void 0?n:"group"):a.anchor=(r=a.anchor)!==null&&r!==void 0?r:"start",cn(a)?void 0:a}assembleGroup(t=[]){let n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);let r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());let i=!this.parent||Ms(this.parent)?Uve(this):[];i.length>0&&(n.scales=i);let o=this.assembleAxes();o.length>0&&(n.axes=o);let s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return bn((this.name?this.name+"_":"")+t)}requestDataName(t){var n;let r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(Ms(this.parent)){let n=ZY(t),r=yw(n),i=this.component.scales[r];if(i&&!i.merged){let o=i.get("type"),s=i.get("range");if(Ti(o)&&ja(s)){let a=i.get("name"),l=Pw(this,r),u=jN(l);if(u){let c=Ie({aggregate:"distinct",field:u},{expr:"datum"});return{signal:Sve(a,i,c)}}else return xe(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){let n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(AH(t)&&Ua(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");let n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(he.selectionNotFound(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}},WN=class extends R2{vgField(t,n={}){let r=this.fieldDef(t);if(r)return Ie(r,n)}reduceFieldDef(t,n){return eY(this.getMapping(),(r,i,o)=>{let s=aa(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){QB(this.getMapping(),(r,i)=>{let o=aa(r);o&&t(o,i)},n)}}});var GN,Wve=w(()=>{"use strict";cr();Te();Vn();GN=class e extends Et{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=at(n);let s=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=s[0])!==null&&i!==void 0?i:"value",(o=s[1])!==null&&o!==void 0?o:"density"]}clone(){return new e(null,at(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${vt(this.transform)}`}assemble(){let t=this.transform,{density:n}=t,r=Le(t,["density"]);return Object.assign({type:"kde",field:n},r)}}});var qN,Gve=w(()=>{"use strict";St();Tt();Ro();ti();Te();Cr();Vn();qN=class e extends Et{constructor(t,n){super(t),this.filter=n}clone(){return new e(null,Object.assign({},this.filter))}static make(t,n){let{config:r,mark:i,markDef:o}=n;if(en("invalid",o,r)!=="filter")return null;let a=n.reduceFieldDef((l,u,c)=>{let f=Ua(c)&&n.getScaleComponent(c);if(f){let d=f.get("type");Oo(d)&&u.aggregate!=="count"&&!Nu(i)&&(l[u.field]=u)}return l},{});return pe(a).length?new e(t,a):null}dependentFields(){return new Set(pe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${vt(this.filter)}`}assemble(){let t=pe(this.filter).reduce((n,r)=>{let i=this.filter[r],o=Ie(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):i.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}});var HN,qve=w(()=>{"use strict";Te();Vn();HN=class e extends Et{constructor(t,n){super(t),this.transform=n,this.transform=at(n);let{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>{var a;return(a=i[s])!==null&&a!==void 0?a:o})}clone(){return new e(this.parent,at(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${vt(this.transform)}`}assemble(){let{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}});var YN,Hve=w(()=>{"use strict";Te();Vn();YN=class e extends Et{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=at(n);let s=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=s[0])!==null&&i!==void 0?i:"key",(o=s[1])!==null&&o!==void 0?o:"value"]}clone(){return new e(null,at(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${vt(this.transform)}`}assemble(){let{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}});var KN,Yve=w(()=>{"use strict";st();St();Tt();Yc();Te();Vn();KN=class e extends Et{constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}clone(){return new e(null,at(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(let i of[[Ll,Pl],[ia,La]]){let o=i.map(s=>{let a=gr(n.encoding[s]);return Re(a)?a.field:Lu(a)?{expr:`${a.datum}`}:Va(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new e(t,o,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(Mi)){let i=n.typedFieldDef(Mi);i.type===Kp&&(t=new e(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;let n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(dt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${vt(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}});var XN,Kve=w(()=>{"use strict";st();St();Tt();Te();Vn();XN=class e extends Et{constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}clone(){return new e(null,this.projection,at(this.fields),at(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(let r of[[Ll,Pl],[ia,La]]){let i=r.map(s=>{let a=gr(n.encoding[s]);return Re(a)?a.field:Lu(a)?{expr:`${a.datum}`}:Va(a)?{expr:`${a.value}`}:void 0}),o=r[0]===ia?"2":"";(i[0]||i[1])&&(t=new e(t,n.projectionName(),i,[n.getName("x"+o),n.getName("y"+o)]))}return t}dependentFields(){return new Set(this.fields.filter(dt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${vt(this.fields)} ${vt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}});var O2,Xve=w(()=>{"use strict";Tt();zl();sz();Te();Vn();O2=class e extends Et{constructor(t,n){super(t),this.transform=n}clone(){return new e(null,at(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){let{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new e(t,n)}static makeFromEncoding(t,n){let r=n.encoding,i=r.x,o=r.y;if(Re(i)&&Re(o)){let s=i.impute?i:o.impute?o:void 0;if(s===void 0)return;let a=i.impute?o:o.impute?i:void 0,{method:l,value:u,frame:c,keyvals:f}=s.impute,d=tY(n.mark,r);return new e(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:s.field,key:a.field},l?{method:l}:{}),u!==void 0?{value:u}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${vt(this.transform)}`}assemble(){let{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:jnt(r)?this.processSequence(r):r}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!i||i==="value"?s:null});if(i&&i!=="value"){let u=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}});var ZN,Zve=w(()=>{"use strict";cr();Te();Vn();ZN=class e extends Et{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=at(n);let s=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=s[0])!==null&&i!==void 0?i:n.on,(o=s[1])!==null&&o!==void 0?o:n.loess]}clone(){return new e(null,at(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${vt(this.transform)}`}assemble(){let t=this.transform,{loess:n,on:r}=t,i=Le(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}});var QN,Qve=w(()=>{"use strict";st();nn();sz();Te();Vn();JN();zN();QN=class e extends Et{constructor(t,n,r){super(t),this.transform=n,this.secondary=r}clone(){return new e(null,at(this.transform),this.secondary)}static make(t,n,r,i){let o=n.component.data.sources,{from:s}=r,a=null;if(Wnt(s)){let l=Jve(s.data,o);l||(l=new Kc(s.data),o.push(l));let u=n.getName(`lookup_${i}`);a=new Pi(l,u,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(Gnt(s)){let l=s.selection;if(r=Object.assign({as:l},r),a=n.getSelectionComponent(bn(l),l).materialized,!a)throw new Error(he.noSameUnitLookup(l))}return new e(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?_n(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${vt({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:_n(this.transform.as)}:{});else{let n=this.transform.as;dt(n)||(xe(he.NO_FIELDS_NEEDS_AS),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}});var eF,e1e=w(()=>{"use strict";cr();Te();Vn();eF=class e extends Et{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=at(n);let s=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=s[0])!==null&&i!==void 0?i:"prob",(o=s[1])!==null&&o!==void 0?o:"value"]}clone(){return new e(null,at(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${vt(this.transform)}`}assemble(){let t=this.transform,{quantile:n}=t,r=Le(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}});var tF,t1e=w(()=>{"use strict";cr();Te();Vn();tF=class e extends Et{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=at(n);let s=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=s[0])!==null&&i!==void 0?i:n.on,(o=s[1])!==null&&o!==void 0?o:n.regression]}clone(){return new e(null,at(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${vt(this.transform)}`}assemble(){let t=this.transform,{regression:n,on:r}=t,i=Le(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}});var nF,n1e=w(()=>{"use strict";Te();Vn();nF=class e extends Et{constructor(t,n){super(t),this.transform=n}clone(){return new e(null,at(this.transform))}addDimensions(t){var n;this.transform.groupby=Uc(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${vt(this.transform)}`}assemble(){let{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),o!==void 0?{op:o}:{}),r!==void 0?{groupby:r}:{})}}});var rF,r1e=w(()=>{"use strict";Te();Vn();rF=class e extends Et{constructor(t,n){super(t),this.transform=n}clone(){return new e(null,at(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${vt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}});function Tot(e){let t=0;function n(r,i){var o;if(r instanceof Kc&&!r.isGenerator&&!Iw(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof $s&&(r.parent instanceof Kc&&!i.source?(i.format=Object.assign(Object.assign({},(o=i.format)!==null&&o!==void 0?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof em){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(let s of r.assemble())e.push(s);return}switch((r instanceof Mw||r instanceof $w||r instanceof qN||r instanceof s0||r instanceof D2||r instanceof XN||r instanceof KN||r instanceof sd||r instanceof QN||r instanceof Qb||r instanceof nm||r instanceof YN||r instanceof HN||r instanceof GN||r instanceof ZN||r instanceof eF||r instanceof tF||r instanceof tm||r instanceof rF||r instanceof nF)&&i.transform.push(r.assemble()),(r instanceof Jp||r instanceof rd||r instanceof O2||r instanceof l0)&&i.transform.push(...r.assemble()),r instanceof Pi&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof Pi?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Pi&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let s=i.name;!i.source||i.transform.length>0?e.push(i):s=i.source;for(let a of r.children)n(a,{name:null,source:s,transform:[]});break}}}return n}function kot(e){let t=[],n=Tot(t);for(let r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function Iot(e,t){var n,r;let i=[],o=Tot(i),s=0;for(let l of e.sources){l.hasName()||(l.dataName=`source_${s++}`);let u=l.assemble();o(l,u)}for(let l of i)l.transform.length===0&&delete l.transform;let a=0;for(let[l,u]of i.entries())((n=u.transform)!==null&&n!==void 0?n:[]).length===0&&!u.source&&i.splice(a++,0,i.splice(l,1)[0]);for(let l of i)for(let u of(r=l.transform)!==null&&r!==void 0?r:[])u.type==="lookup"&&(u.from=e.outputNodes[u.from].getSource());for(let l of i)l.name in t&&(l.values=t[l.name]);return i}var i1e=w(()=>{"use strict";r0();sK();F2();N2();Vn();Wve();aK();Sz();Gve();qve();Hve();lK();Yve();Kve();rK();uK();Xve();Rz();Zve();Qve();e1e();t1e();n1e();r1e();iK();zN();cK();dz();fK()});function Idn(e){return e==="top"||e==="left"||rt(e)?"header":"footer"}function Not(e){for(let t of Ds)Ddn(e,t);Dot(e,"x"),Dot(e,"y")}function Ddn(e,t){var n;let{facet:r,config:i,child:o,component:s}=e;if(e.channelHasField(t)){let a=r[t],l=Zb("title",null,i,t),u=ed(a,i,{allowDisabling:!0,includeDefault:l===void 0||!!l});o.component.layoutHeaders[t].title&&(u=ze(u)?u.join(", "):u,u+=" / "+o.component.layoutHeaders[t].title,o.component.layoutHeaders[t].title=null);let c=Zb("labelOrient",a,i,t),f=(n=a.header)!==null&&n!==void 0?n:{},d=Sn(f.labels,i.header.labels,!0),p=Ve(["bottom","right"],c)?"footer":"header";s.layoutHeaders[t]={title:u,facetFieldDef:a,[p]:t==="facet"?[]:[Fot(e,t,d)]}}}function Fot(e,t,n){let r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function Dot(e,t){var n;let{child:r}=e;if(r.component.axes[t]){let{layoutHeaders:i,resolve:o}=e.component;if(o.axis[t]=PN(o,t),o.axis[t]==="shared"){let s=t==="x"?"column":"row",a=i[s];for(let l of r.component.axes[t]){let u=Idn(l.get("orient"));a[u]=(n=a[u])!==null&&n!==void 0?n:[Fot(e,s,!1)];let c=FN(l,"main",e.config,{header:!0});c&&a[u][0].axes.push(c),l.mainExtracted=!0}}}}var Rot=w(()=>{"use strict";st();St();Tt();Te();er();Ez();Dz();YY()});function Oot(e){kK(e),TK(e,"width"),TK(e,"height")}function Mot(e){kK(e);let t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";TK(e,t),TK(e,n)}function kK(e){for(let t of e.children)t.parseLayoutSize()}function TK(e,t){let n=ZY(t),r=yw(n),i=e.component.resolve,o=e.component.layoutSize,s;for(let a of e.children){let l=a.component.layoutSize.getWithExplicit(n),u=i.scale[r];if(u==="independent"&&l.value==="step"){s=void 0;break}if(s){if(u==="independent"&&s.value!==l.value){s=void 0;break}s=Uu(s,l,n,"")}else s=l}if(s){for(let a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function $ot(e){let{size:t,component:n}=e;for(let r of Ki){let i=oa(r);if(t[i]){let o=t[i];n.layoutSize.set(i,zu(o)?"step":o,!0)}else{let o=Ndn(e,i);n.layoutSize.set(i,o,!1)}}}function Ndn(e,t){let n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){let o=i.get("type"),s=i.get("range");if(Ti(o)){let a=w2(r.view,t);return ja(s)||zu(a)?"step":a}else return iz(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return iz(r.view,t);{let o=w2(r.view,t);return zu(o)?o.step:o}}}var Pz=w(()=>{"use strict";St();kw();ti();y2();er();Ul();Eve()});function IK(e,t,n){return Ie(t,Object.assign({suffix:`by_${Ie(e)}`},n??{}))}var DK,o1e=w(()=>{"use strict";st();sa();St();Tt();zl();nn();ti();Xp();Wb();Te();er();NK();i1e();N2();JN();_ve();YY();kz();Rot();Pz();Li();VN();E2();DK=class e extends WN{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=iF(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return Jg(t)?eY(t,(r,i,o)=>Ve([Fu,Ru],o)?i.field===void 0?(xe(he.emptyFieldDef(i,o)),r):(r[o]=KB(i,o,n),r):(xe(he.incompatibleChannel(o,"facet")),r),{}):{facet:KB(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=zw(this),this.child.parseData()}parseLayoutSize(){kK(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Not(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;let i={};for(let o of Ds)for(let s of MN){let a=this.component.layoutHeaders[o],l=a[s],{facetFieldDef:u}=a;if(u){let c=Zb("titleOrient",u,this.config,o);if(Ve(["right","bottom"],c)){let f=RN(o,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(l?.[0]){let c=o==="row"?"height":"width",f=s==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][o]=.5),a.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){let{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0,i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof e))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof e?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ie(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){let t=[],n=[],r=[];if(this.child instanceof e){if(this.child.channelHasField("column")){let i=Ie(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(let i of Ki){let o=this.child.component.scales[i];if(o&&!o.merged){let s=o.get("type"),a=o.get("range");if(Ti(s)&&ja(a)){let l=Pw(this.child,i),u=jN(l);u?(t.push(u),n.push("distinct"),r.push(`distinct_${u}`)):xe(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){let{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),l=[];for(let c of Ds){let f=this.facet[c];if(f){l.push(Ie(f));let{bin:d,sort:p}=f;if(mn(d)&&l.push(Ie(f,{binSuffix:"end"})),Rs(p)){let{field:m,op:h=Ew}=p,g=IK(f,p);r&&i?(o.push(g),s.push("max"),a.push(g)):(o.push(m),s.push(h),a.push(g))}else if(ze(p)){let m=a0(f,c);o.push(m),s.push("max"),a.push(m)}}}let u=!!r&&!!i;return Object.assign({name:t,data:n,groupby:l},u||o.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),o.length?{fields:o,ops:s,as:a}:{})}:{})}facetSortFields(t){let{facet:n}=this,r=n[t];return r?Rs(r.sort)?[IK(r,r.sort,{expr:"datum"})]:ze(r.sort)?[a0(r,t,{expr:"datum"})]:[Ie(r,{expr:"datum"})]:[]}facetSortOrder(t){let{facet:n}=this,r=n[t];if(r){let{sort:i}=r;return[(Rs(i)?i.order:!ze(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){let{facet:t,config:n}=this;if(t.facet)return KY(t.facet,"facet",n);let r={row:["top","bottom"],column:["left","right"]};for(let i of ON)if(t[i]){let o=Zb("labelOrient",t[i],n,i);if(Ve(r[i],o))return KY(t[i],i,n)}}assembleMarks(){let{child:t}=this,n=this.component.data.facetRoot,r=kot(n),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),s?{style:s}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ds.map(l=>this.facetSortFields(l)).flat(),order:Ds.map(l=>this.facetSortOrder(l)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(Nrt(this,[])))]}getMapping(){return this.facet}}});function Pot(e,t){let{row:n,column:r}=t;if(n&&r){let i=null;for(let o of[n,r])if(Rs(o.sort)){let{field:s,op:a=Ew}=o.sort;e=i=new nm(e,{joinaggregate:[{op:a,field:s,as:IK(o,o.sort,{forAs:!0})}],groupby:[Ie(o)]})}return i}return null}var Lot=w(()=>{"use strict";Tt();Xp();o1e();Rz()});function Jve(e,t){var n,r,i,o,s,a,l,u,c,f;for(let d of t){let p=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(!((n=e.format)===null||n===void 0)&&n.mesh&&(!((r=p.format)===null||r===void 0)&&r.feature))&&!((!((i=e.format)===null||i===void 0)&&i.feature||!((o=p.format)===null||o===void 0)&&o.feature)&&((s=e.format)===null||s===void 0?void 0:s.feature)!==((a=p.format)===null||a===void 0?void 0:a.feature))&&!((!((l=e.format)===null||l===void 0)&&l.mesh||!((u=p.format)===null||u===void 0)&&u.mesh)&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=p.format)===null||f===void 0?void 0:f.mesh))){if(vN(e)&&vN(p)){if(Lb(e.values,p.values))return d}else if(Iw(e)&&Iw(p)){if(e.url===p.url)return d}else if(SY(e)&&e.name===d.dataName)return d}}return null}function Fdn(e,t){if(e.data||!e.parent){if(e.data===null){let r=new Kc({values:[]});return t.push(r),r}let n=Jve(e.data,t);if(n)return n0(e.data)||(n.data.format=het({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{let r=new Kc(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Rdn(e,t,n){var r,i;let o=0;for(let s of t.transforms){let a,l;if(trt(s))l=e=new D2(e,s),a="derived";else if(Rye(s)){let u=tot(s);l=e=(r=$s.makeWithAncestors(e,{},u,n))!==null&&r!==void 0?r:e,e=new s0(e,t,s.filter)}else if(nrt(s))l=e=Jp.makeFromTransform(e,s,t),a="number";else if(irt(s))a="date",n.getWithExplicit(s.field).value===void 0&&(e=new $s(e,{[s.field]:a}),n.set(s.field,a,!1)),l=e=rd.makeFromTransform(e,s);else if(ort(s))l=e=sd.makeFromTransform(e,s),a="number",hz(t)&&(e=new tm(e));else if(Vnt(s))l=e=QN.make(e,t,s,o++),a="derived";else if(Qnt(s))l=e=new Qb(e,s),a="number";else if(Jnt(s))l=e=new nm(e,s),a="number";else if(srt(s))l=e=l0.makeFromTransform(e,s),a="derived";else if(art(s))l=e=new YN(e,s),a="derived";else if(ert(s))l=e=new HN(e,s),a="derived";else if(qnt(s))l=e=new nF(e,s),a="derived";else if(Znt(s))e=new rF(e,s);else if(rrt(s))l=e=O2.makeFromTransform(e,s),a="derived";else if(Hnt(s))l=e=new GN(e,s),a="derived";else if(Ynt(s))l=e=new eF(e,s),a="derived";else if(Knt(s))l=e=new tF(e,s),a="derived";else if(Xnt(s))l=e=new ZN(e,s),a="derived";else{xe(he.invalidTransformIgnored(s));continue}if(l&&a!==void 0)for(let u of(i=l.producedFields())!==null&&i!==void 0?i:[])n.set(u,a,!1)}return e}function zw(e){var t,n,r,i,o,s,a,l,u,c;let f=Fdn(e,e.component.data.sources),{outputNodes:d,outputNodeRefCounts:p}=e.component.data,m=e.parent?e.parent.component.data.ancestorParse.clone():new _Y,h=e.data;n0(h)?(Nye(h)?f=new $w(f,h.sequence):oz(h)&&(f=new Mw(f,h.graticule)),m.parseNothing=!0):((t=h?.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=$s.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new tm(f);let g=e.parent&&od(e.parent);(Wn(e)||Ms(e))&&g&&(f=(r=Jp.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=Rdn(f,e,m));let x=rot(e),b=not(e);f=(i=$s.makeWithAncestors(f,{},Object.assign(Object.assign({},x),b),m))!==null&&i!==void 0?i:f,Wn(e)&&(f=KN.parseAll(f,e),f=XN.parseAll(f,e)),(Wn(e)||Ms(e))&&(g||(f=(o=Jp.makeFromEncoding(f,e))!==null&&o!==void 0?o:f),f=(s=rd.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=D2.parseAllForSortIndex(f,e));let y=e.getName(wN),v=new Pi(f,y,wN,p);if(d[y]=v,f=v,Wn(e)){let E=sd.makeFromEncoding(f,e);E&&(f=E,hz(e)&&(f=new tm(f))),f=(a=O2.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=(l=l0.makeFromEncoding(f,e))!==null&&l!==void 0?l:f}Wn(e)&&(f=(u=qN.make(f,e))!==null&&u!==void 0?u:f);let C=e.getName(fo),_=new Pi(f,C,fo,p);d[C]=_,f=_,Wn(e)&&bit(e,_);let S=null;if(Ms(e)){let E=e.getName("facet");f=(c=Pot(f,e.facet))!==null&&c!==void 0?c:f,S=new em(f,e,E,_.getSource()),d[E]=S}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:p,raw:v,main:_,facetRoot:S,ancestorParse:m})}var JN=w(()=>{"use strict";Unt();r0();nn();sz();Te();Li();Vu();_2();sK();F2();N2();Vn();Wve();aK();Sz();Gve();qve();Hve();lK();Yve();Kve();rK();uK();Xve();Rz();Lot();Zve();Qve();n1e();e1e();t1e();r1e();iK();zN();cK();dz();fK()});var FK,Bot=w(()=>{"use strict";nn();xN();Te();NK();JN();Iz();Pz();Li();FK=class extends R2{constructor(t,n,r,i){var o,s,a,l;super(t,"concat",n,r,i,t.resolve),(((s=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||s===void 0?void 0:s.x)==="shared"||((l=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||l===void 0?void 0:l.y)==="shared")&&xe(he.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(t).map((u,c)=>iF(u,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=zw(this);for(let t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(let t of this.children){t.parseSelections();for(let n of pe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(let t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(let t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Tw(t)?t.vconcat:gN(t)?t.hconcat:t.concat}parseLayoutSize(){Mot(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){let t=$N(this);for(let n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{let n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){let t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}});function Odn(e){return e===!1||e===null}var Mdn,s1e,RK,zot=w(()=>{"use strict";PB();Te();Ul();er();Mdn=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},kbe),{labelExpr:1,encode:1}),s1e=pe(Mdn),RK=class e extends Wa{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new e(at(this.explicit),at(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Odn(this.get(t))}hasOrientSignalRef(){return rt(this.explicit.orient)}}});function Uot(e,t,n){var r;let{encoding:i,config:o}=e,s=(r=gr(i[t]))!==null&&r!==void 0?r:gr(i[Ns(t)]),a=e.axis(t)||{},{format:l,formatType:u}=a;return Zg(u)?Object.assign({text:YB({fieldOrDatumDef:s,field:"datum.value",format:l,formatType:u,config:o})},n):n}var jot=w(()=>{"use strict";St();Tt();Qg()});function Vot(e){return Ki.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[jdn(n,e)]),t),{})}function Wot(e){var t;let{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(let o of e.children){o.parseAxesAndHeaders();for(let s of pe(o.component.axes))r.axis[s]=PN(e.component.resolve,s),r.axis[s]==="shared"&&(n[s]=Ldn(n[s],o.component.axes[s]),n[s]||(r.axis[s]="independent",delete n[s]))}for(let o of Ki){for(let s of e.children)if(s.component.axes[o]){if(r.axis[o]==="independent"){n[o]=((t=n[o])!==null&&t!==void 0?t:[]).concat(s.component.axes[o]);for(let a of s.component.axes[o]){let{value:l,explicit:u}=a.getWithExplicit("orient");if(!rt(l)){if(i[l]>0&&!u){let c=Pdn[l];i[l]>i[c]&&a.set("orient",c,!1)}i[l]++}}}delete s.component.axes[o]}if(r.axis[o]==="independent"&&n[o]&&n[o].length>1)for(let s of n[o])s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function Ldn(e,t){if(e){if(e.length!==t.length)return;let n=e.length;for(let r=0;r<n;r++){let i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){let s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=Bdn(i,o)}}}else return t.map(n=>n.clone());return e}function Bdn(e,t){for(let n of s1e){let r=Uu(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return JH(i,o);case"gridScale":return{explicit:i.explicit,value:Sn(i.value,o.value)}}return yN(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function zdn(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(rt(n.labelAngle)?n.labelAngle:u2(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===wve(r,i))return!0}return e===n[t]}function jdn(e,t){var n,r,i;let o=t.axis(e),s=new RK,a=gr(t.encoding[e]),{mark:l,config:u}=t,c=o?.orient||((n=u[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=u.axis)===null||r===void 0?void 0:r.orient)||Ait(e),f=t.getScaleComponent(e).get("type"),d=Sit(e,f,c,t.config),p=o!==void 0?!o:Az("disable",u,o?.style,d).configValue;if(s.set("disable",p,o!==void 0),p)return s;o=o||{};let m=Eit(t,o,e,a,d),h={fieldOrDatumDef:a,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:m,mark:l,config:u};for(let b of s1e){let y=b in bve?bve[b](h):Ibe(b)?o[b]:void 0,v=y!==void 0,C=zdn(y,b,o,t,e);if(v&&C)s.set(b,y,C);else{let{configValue:_=void 0,configFrom:S=void 0}=Ibe(b)&&b!=="values"?Az(b,t.config,o.style,d):{},E=_!==void 0;v&&!E?s.set(b,y,C):(S!=="vgAxisConfig"||Udn.has(b)&&E||zD(_)||rt(_))&&s.set(b,_,!1)}}let g=(i=o.encoding)!==null&&i!==void 0?i:{},x=yH.reduce((b,y)=>{var v;if(!s.hasAxisPart(y))return b;let C=QY((v=g[y])!==null&&v!==void 0?v:{},t),_=y==="labels"?Uot(t,e,C):C;return _!==void 0&&!cn(_)&&(b[y]={update:_}),b},{});return cn(x)||s.set("encode",x,!!o.encoding||o.labelAngle!==void 0),s}var Pdn,Udn,a1e=w(()=>{"use strict";PB();St();Tt();Te();er();Cr();Ave();Dz();Ul();zot();gve();jot();Cve();Pdn={bottom:"top",top:"bottom",left:"right",right:"left"};Udn=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"])});function Got({encoding:e,size:t}){for(let n of Ki){let r=oa(n);zu(t[r])&&Bu(e[n])&&(delete t[r],xe(he.stepDropped(r)))}return t}var qot=w(()=>{"use strict";St();Tt();nn();y2()});function Hot(e,t,n,{graticule:r}){let i=ra(e)?Object.assign({},e):{type:e},o=en("orient",i,n);if(i.orient=qdn(i.type,t,o),o!==void 0&&o!==i.orient&&xe(he.orientOverridden(i.orient,o)),i.type==="bar"&&i.orient){let u=en("cornerRadiusEnd",i,n);if(u!==void 0){let c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:ket[i.orient];for(let f of c)i[f]=u;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return en("opacity",i,n)===void 0&&(i.opacity=Wdn(i.type,t)),i.filled===void 0&&(i.filled=r?!1:Gdn(i,n)),en("cursor",i,n)===void 0&&(i.cursor=Vdn(i,t,n)),i}function Vdn(e,t,n){return t.href||e.href||en("href",e,n)?"pointer":e.cursor}function Wdn(e,t){if(Ve([UD,LB,BB,zB],e)&&!dN(t))return .7}function Gdn(e,t){let n=e0("filled",e,t),r=e.type;return Sn(n,r!==UD&&r!==d2&&r!==jD)}function qdn(e,t,n){switch(e){case UD:case BB:case zB:case vH:case Cet:case wet:return}let{x:r,y:i,x2:o,y2:s}=t;switch(e){case f2:if(Re(r)&&(Ai(r.bin)||Re(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Re(i)&&(Ai(i.bin)||Re(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o&&(Re(r)&&r.type===Jf&&!mn(r.bin)||HH(r)))return"horizontal";if(!s&&(Re(i)&&i.type===Jf&&!mn(i.bin)||HH(i)))return"vertical"}case jD:if(o&&!(Re(r)&&Ai(r.bin))&&s&&!(Re(i)&&Ai(i.bin)))return;case c2:if(s)return Re(i)&&Ai(i.bin)?"horizontal":"vertical";if(o)return Re(r)&&Ai(r.bin)?"vertical":"horizontal";if(e===jD){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case d2:case LB:{let a=Bu(r),l=Bu(i);if(a&&!l)return e!=="tick"?"horizontal":"vertical";if(!a&&l)return e!=="tick"?"vertical":"horizontal";if(a&&l){let u=r,c=i,f=u.type===Hg,d=c.type===Hg;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!u.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":u.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}var Yot=w(()=>{"use strict";sa();Tt();zl();nn();Ro();Yc();Te();Cr()});var Kot,Xot=w(()=>{"use strict";jl();Kot={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ki("x",e,{defaultPos:"mid"})),ki("y",e,{defaultPos:"mid"})),ju(e,"radius","arc")),ju(e,"theta","arc"))}});var Zot,Qot=w(()=>{"use strict";jl();Zot={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Fw("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),Fw("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),TN(e))}});var Jot,est=w(()=>{"use strict";jl();Jot={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ju(e,"x","bar")),ju(e,"y","bar"))}});var tst,nst=w(()=>{"use strict";Tt();Yc();jl();tst={vgMark:"shape",encodeEntry:e=>Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{let{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Re(n)&&n.type===Kp?{field:Ie(n,{expr:"datum"})}:{})]}}});var rst,ist=w(()=>{"use strict";jl();rst={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),ju(e,"x","image")),ju(e,"y","image")),Dw(e,"url"))}});var ost,sst,ast=w(()=>{"use strict";jl();ost={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ki("x",e,{defaultPos:"mid"})),ki("y",e,{defaultPos:"mid"})),Or("size",e,{vgChannel:"strokeWidth"})),TN(e))},sst={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ki("x",e,{defaultPos:"mid"})),ki("y",e,{defaultPos:"mid"})),Or("size",e)),TN(e))}});function l1e(e,t){let{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ki("x",e,{defaultPos:"mid"})),ki("y",e,{defaultPos:"mid"})),Or("size",e)),Or("angle",e)),Hdn(e,n,t))}function Hdn(e,t,n){return n?{shape:{value:n}}:Or("shape",e)}var lst,ust,cst,fst=w(()=>{"use strict";jl();lst={vgMark:"symbol",encodeEntry:e=>l1e(e)},ust={vgMark:"symbol",encodeEntry:e=>l1e(e,"circle")},cst={vgMark:"symbol",encodeEntry:e=>l1e(e,"square")}});var dst,pst=w(()=>{"use strict";jl();dst={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ju(e,"x","rect")),ju(e,"y","rect"))}});var mst,hst=w(()=>{"use strict";jl();mst={vgMark:"rule",encodeEntry:e=>{let{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Fw("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),Fw("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Or("size",e,{vgChannel:"strokeWidth"}))}}});function Ydn(e,t,n){if(en("align",e,n)===void 0)return"center"}function Kdn(e,t,n){if(en("baseline",e,n)===void 0)return"middle"}var gst,xst=w(()=>{"use strict";Cr();jl();gst={vgMark:"text",encodeEntry:e=>{let{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ki("x",e,{defaultPos:"mid"})),ki("y",e,{defaultPos:"mid"})),Dw(e)),Or("size",e,{vgChannel:"fontSize"})),Or("angle",e)),FY("align",Ydn(e.markDef,n,t))),FY("baseline",Kdn(e.markDef,n,t))),ki("radius",e,{defaultPos:null,isMidPoint:!0})),ki("theta",e,{defaultPos:null,isMidPoint:!0}))}}});function Xdn(e){var t;let{config:n,markDef:r}=e,{orient:i}=r,o=i==="horizontal"?"width":"height",s=e.getScaleComponent(i==="horizontal"?"x":"y"),a=(t=en("size",r,n,{vgChannel:o}))!==null&&t!==void 0?t:n.tick.bandSize;if(a!==void 0)return a;{let l=s?s.get("range"):void 0;return l&&ja(l)&&ur(l.step)?l.step*3/4:v2(n.view,o)*3/4}}var bst,yst=w(()=>{"use strict";st();kw();er();Cr();jl();bst={vgMark:"rect",encodeEntry:e=>{let{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",o=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ii(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ki("x",e,{defaultPos:"mid",vgChannel:"xc"})),ki("y",e,{defaultPos:"mid",vgChannel:"yc"})),Or("size",e,{defaultValue:Xdn(e),vgChannel:i})),{[o]:tr(en("thickness",n,t))})}}});function Cst(e){return Ve([d2,c2,_et],e.mark)?Zdn(e):Ve([f2],e.mark)?Qdn(e):MK(e)}function Zdn(e){let t=tY(e.mark,e.encoding),n=MK(e,{fromPrefix:t.length>0?vst:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:vst+e.requestDataName(fo),data:e.requestDataName(fo),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}function Qdn(e){let t=FH.some(n=>en(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){let[n]=MK(e,{fromPrefix:wst}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),o=(f,d)=>{let p=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${p.map(m=>`scale('${r}',${m})`).join(",")})`},s,a;e.stack.fieldChannel==="x"?(s=Object.assign(Object.assign({},gw(n.encode.update,["y","yc","y2","height",...FH])),{x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Iu(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(s=Object.assign(Object.assign({},gw(n.encode.update,["x","xc","x2","width"])),{y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Iu(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(let f of FH){let d=e0(f,e.markDef,e.config);n.encode.update[f]?(s[f]=n.encode.update[f],delete n.encode.update[f]):d&&(s[f]=tr(d)),d&&(n.encode.update[f]={value:0})}let l=e.fieldDef(e.stack.groupbyChannel),u=Ie(l)?[Ie(l)]:[];return(l?.bin||l?.timeUnit)&&u.push(Ie(l,{binSuffix:"end"})),s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{let p=e0(d,e.markDef,e.config);return p!==void 0?Object.assign(Object.assign({},f),{[d]:tr(p)}):f}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(fo),name:wst+e.requestDataName(fo),groupby:u,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}else return MK(e)}function Jdn(e){let{encoding:t,stack:n,mark:r,markDef:i,config:o}=e,s=t.order;if(!(!ze(s)&&Va(s)&&Cbe(s.value)||!s&&Cbe(en("order",i,o)))){if((ze(s)||Re(s))&&!n)return QH(s,{expr:"datum"});if(Nu(r)){let a=i.orient==="horizontal"?"y":"x",l=t[a];if(Re(l)){let u=l.sort;if(ze(u))return{field:Ie(l,{prefix:a,suffix:"sort_index",expr:"datum"})};if(Rs(u))return{field:Ie({aggregate:dN(e.encoding)?u.op:void 0,field:u.field},{expr:"datum"})};if(jH(u)){let c=e.fieldDef(u.encoding);return{field:Ie(c,{expr:"datum"}),order:u.order}}else return u===null?void 0:{field:Ie(l,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function MK(e,t={fromPrefix:""}){let{mark:n,markDef:r,config:i}=e,o=Sn(r.clip,epn(e),tpn(e)),s=sye(r),a=e.encoding.key,l=Jdn(e),u=npn(e),c=en("aria",r,i),f=OK[n].postEncodingTransform?OK[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:OK[n].vgMark},o?{clip:!0}:{}),s?{style:s}:{}),a?{key:a.field}:{}),l?{sort:l}:{}),u||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(fo)},encode:{update:OK[n].encodeEntry(e)}}),f?{transform:f}:{})]}function epn(e){let t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function tpn(e){let t=e.component.projection;return t&&!t.isFit?!0:void 0}function npn(e){if(!e.component.selection)return null;let t=pe(e.component.selection).length,n=t,r=e.parent;for(;r&&n===0;)n=pe(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}var OK,vst,wst,_st=w(()=>{"use strict";st();Tt();r0();zl();Ro();Xp();Te();er();Cr();Xot();Qot();est();nst();ist();ast();fst();pst();hst();xst();yst();OK={arc:Kot,area:Zot,bar:Jot,circle:ust,geoshape:tst,image:rst,line:ost,point:lst,rect:dst,rule:mst,square:cst,text:gst,tick:bst,trail:sst};vst="faceted_path_";wst="stack_group_"});var oF,u1e=w(()=>{"use strict";St();Tt();r0();zl();zl();Ro();y2();Aye();Ez();a1e();JN();Iz();qot();Pz();Yot();_st();Li();E2();_2();oF=class extends WN{constructor(t,n,r,i={},o){var s,a;super(t,"unit",n,r,o,void 0,wye(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];let l=ra(t.mark)?t.mark.type:t.mark;this.markDef=Hot(t.mark,(s=t.encoding)!==null&&s!==void 0?s:{},o,{graticule:t.data&&oz(t.data)});let u=this.encoding=Qtt((a=t.encoding)!==null&&a!==void 0?a:{},this.markDef,o);this.size=Got({encoding:u,size:wye(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=hY(l,u),this.specifiedScales=this.initScales(l,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){let{encoding:t}=this,n=this.mark===wH,r=t&&jet.some(i=>It(t[i]));return n||r}scaleDomain(t){let n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return vw.reduce((r,i)=>{var o;let s=gr(n[i]);return s&&(r[i]=(o=s.scale)!==null&&o!==void 0?o:{}),r},{})}initAxes(t){return Ki.reduce((n,r)=>{let i=t[r];if(It(i)||r===jn&&It(t.x2)||r===qr&&It(t.y2)){let o=It(i)?i.axis:void 0;n[r]=o&&Object.assign({},o)}return n},{})}initLegend(t){return Zet.reduce((n,r)=>{let i=gr(t[r]);if(i&&Jet(r)){let o=i.legend;n[r]=o&&Object.assign({},o)}return n},{})}parseData(){this.component.data=zw(this)}parseLayoutSize(){$ot(this)}parseSelections(){this.component.selection=xit(this,this.selection)}parseMarkGroup(){this.component.mark=Cst(this)}parseAxesAndHeaders(){this.component.axes=Vot(this)}assembleSelectionTopLevelSignals(t){return Frt(this,t)}assembleSignals(){return[...HY(this),...Drt(this,[])]}assembleSelectionData(t){return Rrt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return $N(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!od(this.parent))&&(n=Hye(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return t0(this.encoding,t)}fieldDef(t){let n=this.encoding[t];return aa(n)}typedFieldDef(t){let n=this.fieldDef(t);return Mo(n)?n:null}}});var $K,Sst=w(()=>{"use strict";nn();xN();Te();Ez();a1e();JN();Iz();Pz();Ove();Li();E2();u1e();$K=class e extends R2{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);let s=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,l)=>{if(Hb(a))return new e(a,this,this.getName("layer_"+l),s,o);if(ns(a))return new oF(a,this,this.getName("layer_"+l),s,o);throw new Error(he.invalidSpec(a))})}parseData(){this.component.data=zw(this);for(let t of this.children)t.parseData()}parseLayoutSize(){Oot(this)}parseSelections(){this.component.selection={};for(let t of this.children){t.parseSelections();for(let n of pe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(let t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Wot(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),HY(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),$N(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(let n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Ort(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),tK(this))}}});function iF(e,t,n,r,i){if(Vb(e))return new DK(e,t,n,i);if(Hb(e))return new $K(e,t,n,r,i);if(ns(e))return new oF(e,t,n,r,i);if(vye(e))return new FK(e,t,n,i);throw new Error(he.invalidSpec(e))}var NK=w(()=>{"use strict";nn();xN();Bot();o1e();Sst();u1e()});function Est(e,t={}){t.logger&&itt(t.logger),t.fieldTitle&&nye(t.fieldTitle);try{let n=pY(DB(t.config,e.config)),r=wY(e,n),i=iF(r,null,"",void 0,n);return i.parse(),aot(i.component.data,i),{spec:ipn(i,rpn(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&ott(),t.fieldTitle&&Xtt()}}function rpn(e,t,n,r){let i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):dt(t)&&(t={type:t}),i&&o&&Lnt(t.type)){if(i==="step"&&o==="step")xe(he.droppingFit()),t.type="pad";else if(i==="step"||o==="step"){let s=i==="step"?"width":"height";xe(he.droppingFit(yw(s)));let a=s==="width"?"height":"width";t.type=Bnt(a)}}return Object.assign(Object.assign(Object.assign({},pe(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Dye(n)),Dye(e))}function ipn(e,t,n={},r){let i=e.config?wnt(e.config):void 0,o=[].concat(e.assembleSelectionData([]),Iot(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0),c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),a?{title:a}:{}),l?{style:l}:{}),u?{encode:{update:u}}:{}),{data:o}),s.length>0?{projections:s}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}var Ast=w(()=>{"use strict";st();St();Tt();kw();nn();Iye();znt();Te();NK();i1e();SK()});function Tst(e,t){return opn.map(e,{config:t})}var c1e,opn,kst=w(()=>{"use strict";zl();Eye();c1e=class extends bN{mapUnit(t,{config:n}){if(t.encoding){let{encoding:r,transform:i}=t,{bins:o,timeUnits:s,aggregate:a,groupby:l,encoding:u}=pN(r,n),c=[...i||[],...o,...s,...a.length===0?[]:[{aggregate:a,groupby:l}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:u})}else return t}},opn=new c1e});var f1e={};rn(f1e,{compile:()=>Est,extractTransforms:()=>Tst,normalize:()=>wY,version:()=>spn});var spn,Ist=w(()=>{"use strict";_Je();Iye();Ast();kst();spn=SJe.version});function apn(e){let[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var d1e,Dst=w(()=>{"use strict";d1e=apn});var y1e={};rn(y1e,{carbong10:()=>omn,carbong100:()=>amn,carbong90:()=>smn,carbonwhite:()=>imn,dark:()=>Tpn,excel:()=>kpn,fivethirtyeight:()=>Npn,ggplot2:()=>Fpn,googlecharts:()=>Wpn,latimes:()=>$pn,powerbi:()=>emn,quartz:()=>Ppn,urbaninstitute:()=>Vpn,version:()=>lmn,vox:()=>Lpn});function UK({theme:e,background:t}){let n=["white","g10"].includes(e)?"light":"dark",r=zK.gridBg[e],i=zK.textPrimary[e],o=zK.textSecondary[e],s=n==="dark"?nmn:rmn,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:g1e,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:tmn,labelFontWeight:x1e,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:zK.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:g1e,fill:o,fontWeight:x1e},"guide-title":{font:g1e,fill:o,fontWeight:x1e}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}var lpn,upn,cpn,fpn,dpn,ppn,mpn,hpn,gpn,xpn,bpn,ypn,vpn,wpn,Cpn,_pn,Spn,Epn,Apn,sF,Nst,Tpn,M2,kpn,$2,p1e,Ipn,Dpn,Fst,Rst,Npn,P2,Fpn,Rpn,Opn,Ost,Mst,Mpn,L2,m1e,$st,Pst,Lz,$pn,B2,PK,Ppn,z2,Lpn,ad,Lst,Bpn,LK,h1e,zpn,Upn,jpn,Bz,Vpn,U2,Bst,BK,Wpn,b1e,zst,Ust,jst,zz,Vst,Wst,Uz,Gst,Gpn,im,qpn,Hpn,Ypn,Kpn,Xpn,Zpn,Qpn,Hst,Yst,qst,Jpn,emn,g1e,tmn,x1e,zK,nmn,rmn,imn,omn,smn,amn,lmn,Kst=w(()=>{"use strict";lpn="vega-themes",upn="2.15.0",cpn="Themes for stylized Vega and Vega-Lite visualizations.",fpn=["vega","vega-lite","themes","style"],dpn="BSD-3-Clause",ppn={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},mpn=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],hpn="build/vega-themes.js",gpn="build/vega-themes.module.js",xpn="build/vega-themes.min.js",bpn="build/vega-themes.min.js",ypn="build/vega-themes.module.d.ts",vpn={type:"git",url:"https://github.com/vega/vega-themes.git"},wpn=["src","build"],Cpn={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},_pn={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},Spn={vega:"*","vega-lite":"*"},Epn={},Apn={name:lpn,version:upn,description:cpn,keywords:fpn,license:dpn,author:ppn,contributors:mpn,main:hpn,module:gpn,unpkg:xpn,jsdelivr:bpn,types:ypn,repository:vpn,files:wpn,scripts:Cpn,devDependencies:_pn,peerDependencies:Spn,dependencies:Epn},sF="#fff",Nst="#888",Tpn={background:"#333",view:{stroke:Nst},title:{color:sF,subtitleColor:sF},style:{"guide-label":{fill:sF},"guide-title":{fill:sF}},axis:{domainColor:sF,gridColor:Nst,tickColor:sF}},M2="#4572a7",kpn={background:"#fff",arc:{fill:M2},area:{fill:M2},line:{stroke:M2,strokeWidth:2},path:{stroke:M2},rect:{fill:M2},shape:{stroke:M2},symbol:{fill:M2,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},$2="#30a2da",p1e="#cbcbcb",Ipn="#999",Dpn="#333",Fst="#f0f0f0",Rst="#333",Npn={arc:{fill:$2},area:{fill:$2},axis:{domainColor:p1e,grid:!0,gridColor:p1e,gridWidth:1,labelColor:Ipn,labelFontSize:10,titleColor:Dpn,tickColor:p1e,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Fst,group:{fill:Fst},legend:{labelColor:Rst,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Rst,titleFontSize:14,titlePadding:10},line:{stroke:$2,strokeWidth:2},path:{stroke:$2,strokeWidth:.5},rect:{fill:$2},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:$2},bar:{binSpacing:2,fill:$2,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},P2="#000",Fpn={group:{fill:"#e5e5e5"},arc:{fill:P2},area:{fill:P2},line:{stroke:P2},path:{stroke:P2},rect:{fill:P2},shape:{stroke:P2},symbol:{fill:P2,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Rpn=22,Opn="normal",Ost="Benton Gothic, sans-serif",Mst=11.5,Mpn="normal",L2="#82c6df",m1e="Benton Gothic Bold, sans-serif",$st="normal",Pst=13,Lz={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},$pn={background:"#ffffff",title:{anchor:"start",color:"#000000",font:m1e,fontSize:Rpn,fontWeight:Opn},arc:{fill:L2},area:{fill:L2},line:{stroke:L2,strokeWidth:2},path:{stroke:L2},rect:{fill:L2},shape:{stroke:L2},symbol:{fill:L2,size:30},axis:{labelFont:Ost,labelFontSize:Mst,labelFontWeight:Mpn,titleFont:m1e,titleFontSize:Pst,titleFontWeight:$st},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Ost,labelFontSize:Mst,symbolType:"square",titleFont:m1e,titleFontSize:Pst,titleFontWeight:$st},range:{category:Lz["category-6"],diverging:Lz["fireandice-6"],heatmap:Lz["fire-7"],ordinal:Lz["fire-7"],ramp:Lz["fire-7"]}},B2="#ab5787",PK="#979797",Ppn={background:"#f9f9f9",arc:{fill:B2},area:{fill:B2},line:{stroke:B2},path:{stroke:B2},rect:{fill:B2},shape:{stroke:B2},symbol:{fill:B2,size:30},axis:{domainColor:PK,domainWidth:.5,gridWidth:.2,labelColor:PK,tickColor:PK,tickWidth:.2,titleColor:PK},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},z2="#3e5c69",Lpn={background:"#fff",arc:{fill:z2},area:{fill:z2},line:{stroke:z2},path:{stroke:z2},rect:{fill:z2},shape:{stroke:z2},symbol:{fill:z2},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ad="#1696d2",Lst="#000000",Bpn="#FFFFFF",LK="Lato",h1e="Lato",zpn="Lato",Upn="#DEDDDD",jpn=18,Bz={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Vpn={background:Bpn,title:{anchor:"start",fontSize:jpn,font:LK},axisX:{domain:!0,domainColor:Lst,domainWidth:1,grid:!1,labelFontSize:12,labelFont:h1e,labelAngle:0,tickColor:Lst,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:LK},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:Upn,gridWidth:1,labelFontSize:12,labelFont:h1e,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:LK,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:h1e,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:LK,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Bz["six-groups-cat-1"],diverging:Bz["diverging-colors"],heatmap:Bz["diverging-colors"],ordinal:Bz["six-groups-seq"],ramp:Bz["shades-blue"]},area:{fill:ad},rect:{fill:ad},line:{color:ad,stroke:ad,strokeWidth:5},trail:{color:ad,stroke:ad,strokeWidth:0,size:1},path:{stroke:ad,strokeWidth:.5},point:{filled:!0},text:{font:zpn,color:ad,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ad,stroke:null}},arc:{fill:ad},shape:{stroke:ad},symbol:{fill:ad,size:30}},U2="#3366CC",Bst="#ccc",BK="Arial, sans-serif",Wpn={arc:{fill:U2},area:{fill:U2},path:{stroke:U2},rect:{fill:U2},shape:{stroke:U2},symbol:{stroke:U2},circle:{fill:U2},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:BK,fontSize:12},"guide-title":{font:BK,fontSize:12},"group-title":{font:BK,fontSize:12}},title:{font:BK,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Bst,tickColor:Bst,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},b1e=e=>e*(1/3+1),zst=b1e(9),Ust=b1e(10),jst=b1e(12),zz="Segoe UI",Vst="wf_standard-font, helvetica, arial, sans-serif",Wst="#252423",Uz="#605E5C",Gst="transparent",Gpn="#C8C6C4",im="#118DFF",qpn="#12239E",Hpn="#E66C37",Ypn="#6B007B",Kpn="#E044A7",Xpn="#744EC2",Zpn="#D9B300",Qpn="#D64550",Hst=im,Yst="#DEEFFF",qst=[Yst,Hst],Jpn=[Yst,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",Hst],emn={view:{stroke:Gst},background:Gst,font:zz,header:{titleFont:Vst,titleFontSize:jst,titleColor:Wst,labelFont:zz,labelFontSize:Ust,labelColor:Uz},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Uz,labelFontSize:zst,titleFont:Vst,titleColor:Wst,titleFontSize:jst,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:Gpn,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:im},line:{stroke:im,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:zz,fontSize:zst,fill:Uz},arc:{fill:im},area:{fill:im,line:!0,opacity:.6},path:{stroke:im},rect:{fill:im},point:{fill:im,filled:!0,size:75},shape:{stroke:im},symbol:{fill:im,strokeWidth:1.5,size:50},legend:{titleFont:zz,titleFontWeight:"bold",titleColor:Uz,labelFont:zz,labelFontSize:Ust,labelColor:Uz,symbolType:"circle",symbolSize:75},range:{category:[im,qpn,Hpn,Ypn,Kpn,Xpn,Zpn,Qpn],diverging:qst,heatmap:qst,ordinal:Jpn}},g1e='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',tmn='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',x1e=400,zK={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},nmn=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],rmn=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];imn=UK({theme:"white",background:"#ffffff"}),omn=UK({theme:"g10",background:"#f4f4f4"}),smn=UK({theme:"g90",background:"#262626"}),amn=UK({theme:"g100",background:"#161616"}),lmn=Apn.version});function Nmn(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function Fmn(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return Imn.toString().replace(Zst,e)}function Rmn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Omn(e,t,n){if(Vt(e))return`[${e.map(r=>t(zn(r)?r:Xst(r,n))).join(", ")}]`;if(tn(e)){let r="",i=e,{title:o,image:s}=i,a=Rmn(i,["title","image"]);o&&(r+=`<h2>${t(o)}</h2>`),s&&(r+=`<img src="${t(s)}">`);let l=Object.keys(a);if(l.length>0){r+="<table>";for(let u of l){let c=a[u];c!==void 0&&(tn(c)&&(c=Xst(c,n)),r+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function Mmn(e){let t=[];return function(n,r){if(typeof r!="object"||r===null)return r;let i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function Xst(e,t){return JSON.stringify(e,Mmn(t))}function $mn(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}var umn,cmn,fmn,dmn,pmn,mmn,hmn,gmn,xmn,bmn,ymn,vmn,wmn,Cmn,_mn,Smn,Emn,Amn,Tmn,kmn,Imn,Zst,Dmn,jK,D0i,Qst=w(()=>{"use strict";ao();umn="vega-tooltip",cmn="0.25.1",fmn="A tooltip plugin for Vega-Lite and Vega visualizations.",dmn=["vega-lite","vega","tooltip"],pmn={type:"git",url:"https://github.com/vega/vega-tooltip.git"},mmn={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},hmn=["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],gmn="BSD-3-Clause",xmn={url:"https://github.com/vega/vega-tooltip/issues"},bmn="https://github.com/vega/vega-tooltip#readme",ymn="build/vega-tooltip.js",vmn="build/vega-tooltip.module.js",wmn="build/vega-tooltip.min.js",Cmn="build/vega-tooltip.min.js",_mn="build/vega-tooltip.module.d.ts",Smn=["src","build","types"],Emn={prebuild:"yarn clean && yarn build:style",build:"rollup -c","build:style":"./build-style.sh",clean:"rimraf build && rimraf src/style.ts","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && yarn copy:build && gh-pages -d examples && yarn clean",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint && yarn test",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",pretest:"yarn build:style",test:"beemo jest","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand",prepare:"beemo create-config && yarn copy:data",prettierbase:"beemo prettier '*.{css,scss,html}'",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check"},Amn={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0","node-sass":"^5.0.0",path:"^0.12.7",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"~4.2.2","vega-datasets":"^2.2.0","vega-lite-dev-config":"^0.16.1","vega-typings":"^0.19.2"},Tmn={"vega-util":"^1.16.0"},kmn={name:umn,version:cmn,description:fmn,keywords:dmn,repository:pmn,author:mmn,collaborators:hmn,license:gmn,bugs:xmn,homepage:bmn,main:ymn,module:vmn,unpkg:wmn,jsdelivr:Cmn,types:_mn,files:Smn,scripts:Emn,devDependencies:Amn,dependencies:Tmn},Imn=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`,Zst="vg-tooltip-element",Dmn={offsetX:10,offsetY:10,id:Zst,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:Nmn,maxDepth:2};jK=class{constructor(t){this.options=Object.assign(Object.assign({},Dmn),t);let n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){let r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=Fmn(n);let i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=Omn(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);let{x:s,y:a}=$mn(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${s}px`)}},D0i=kmn.version});var j2={};rn(j2,{DEFAULT_ACTIONS:()=>iat,default:()=>Kmn,guessMode:()=>oat,vega:()=>Jb,vegaLite:()=>aF});function GK(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(f){s(f)}}function l(c){try{u(r.throw(c))}catch(f){s(f)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(e,t||[])).next())})}function Pmn(e,t,n){let r=e.open(t),i=1e4,o=250,{origin:s}=new URL(t),a=~~(i/o);function l(c){c.source===r&&(a=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function u(){a<=0||(r.postMessage(n,s),setTimeout(u,o),a-=1)}setTimeout(u,o)}function rat(e,...t){for(let n of t)Bmn(e,n);return e}function Bmn(e,t){for(let n of Object.keys(t))ZO(e,n,t[n],!0)}function Wmn(e){return typeof e=="function"}function Jst(e,t,n,r){let i=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+e+o),s.document.title=`${jz[r]} JSON Source`}function oat(e,t){var n;if(e.$schema){let r=d1e(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${jz[r.library]}, but mode argument sets ${(n=jz[t])!==null&&n!==void 0?n:t}.`);let i=r.library;return(0,w1e.satisfies)(qK[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${jz[i]} ${r.version}, but the current version of ${jz[i]} is v${qK[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function Gmn(e){return!!(e&&"load"in e)}function eat(e){return Gmn(e)?e:Jb.loader(e)}function tat(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function qmn(e,t,n={}){var r,i,o;return GK(this,void 0,void 0,function*(){let s,a;zn(t)?(a=eat(n.loader),s=JSON.parse(yield a.load(t))):s=t;let l=tat(s).loader;(!a||l)&&(a=eat((r=n.loader)!==null&&r!==void 0?r:l));let u=yield nat(tat(s),a),c=yield nat(n,a),f=Object.assign(Object.assign({},rat(c,u)),{config:uk((i=c.config)!==null&&i!==void 0?i:{},(o=u.config)!==null&&o!==void 0?o:{})});return yield Ymn(e,s,f,a)})}function nat(e,t){var n;return GK(this,void 0,void 0,function*(){let r=zn(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=zn(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function Hmn(e){var t;let n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function Ymn(e,t,n={},r){var i,o,s,a,l,u;return GK(this,void 0,void 0,function*(){let c=n.theme?uk(y1e[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=Bie(n.actions)?n.actions:rat({},iat,(o=n.actions)!==null&&o!==void 0?o:{}),d=Object.assign(Object.assign({},zmn),n.i18n),p=(s=n.renderer)!==null&&s!==void 0?s:"canvas",m=(a=n.logLevel)!==null&&a!==void 0?a:Jb.Warn,h=(l=n.downloadFileName)!==null&&l!==void 0?l:"visualization",g=typeof e=="string"?document.querySelector(e):e;if(!g)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){let k="vega-embed-style",{root:O,rootContainer:F}=Hmn(g);if(!O.getElementById(k)){let B=document.createElement("style");B.id=k,B.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?Lmn.toString():n.defaultStyle,F.appendChild(B)}}let x=oat(t,n.mode),b=Umn[x](t,c);if(x==="vega-lite"&&b.$schema){let k=d1e(b.$schema);(0,w1e.satisfies)(qK.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${qK.vega}.`)}g.classList.add("vega-embed"),f&&g.classList.add("has-actions"),g.innerHTML="";let y=g;if(f){let k=document.createElement("div");k.classList.add(Vmn),g.appendChild(k),y=k}let v=n.patch;v&&(v instanceof Function?b=v(b):b=sk(b,v,!0,!1).newDocument),n.formatLocale&&Jb.formatLocale(n.formatLocale),n.timeFormatLocale&&Jb.timeFormatLocale(n.timeFormatLocale);let{ast:C}=n,_=Jb.parse(b,x==="vega-lite"?{}:c,{ast:C}),S=new(n.viewClass||Jb.View)(_,Object.assign({loader:r,logLevel:m,renderer:p},C?{expr:Jb.expressionInterpreter}:{}));if(n.tooltip!==!1){let k;Wmn(n.tooltip)?k=n.tooltip:k=new jK(n.tooltip===!0?{}:n.tooltip).call,S.tooltip(k)}let{hover:E}=n;if(E===void 0&&(E=x==="vega"),E){let{hoverSet:k,updateSet:O}=typeof E=="boolean"?{}:E;S.hover(k,O)}n&&(n.width!=null&&S.width(n.width),n.height!=null&&S.height(n.height),n.padding!=null&&S.padding(n.padding)),yield S.initialize(y,n.bind).runAsync();let T;if(f!==!1){let k=g;if(n.defaultStyle!==!1){let F=document.createElement("details");F.title=d.CLICK_TO_VIEW_ACTIONS,g.append(F),k=F;let B=document.createElement("summary");B.innerHTML=jmn,F.append(B),T=M=>{F.contains(M.target)||F.removeAttribute("open")},document.addEventListener("click",T)}let O=document.createElement("div");if(k.append(O),O.classList.add("vega-actions"),f===!0||f.export!==!1){for(let F of["svg","png"])if(f===!0||f.export===!0||f.export[F]){let B=d[`${F.toUpperCase()}_ACTION`],M=document.createElement("a");M.text=B,M.href="#",M.target="_blank",M.download=`${h}.${F}`,M.addEventListener("mousedown",function(z){return GK(this,void 0,void 0,function*(){z.preventDefault();let W=yield S.toImageURL(F,n.scaleFactor);this.href=W})}),O.append(M)}}if(f===!0||f.source!==!1){let F=document.createElement("a");F.text=d.SOURCE_ACTION,F.href="#",F.addEventListener("click",function(B){var M,z;Jst((0,WK.default)(t),(M=n.sourceHeader)!==null&&M!==void 0?M:"",(z=n.sourceFooter)!==null&&z!==void 0?z:"",x),B.preventDefault()}),O.append(F)}if(x==="vega-lite"&&(f===!0||f.compiled!==!1)){let F=document.createElement("a");F.text=d.COMPILED_ACTION,F.href="#",F.addEventListener("click",function(B){var M,z;Jst((0,WK.default)(b),(M=n.sourceHeader)!==null&&M!==void 0?M:"",(z=n.sourceFooter)!==null&&z!==void 0?z:"","vega"),B.preventDefault()}),O.append(F)}if(f===!0||f.editor!==!1){let F=(u=n.editorUrl)!==null&&u!==void 0?u:"https://vega.github.io/editor/",B=document.createElement("a");B.text=d.EDITOR_ACTION,B.href="#",B.addEventListener("click",function(M){Pmn(window,F,{config:c,mode:x,renderer:p,spec:(0,WK.default)(t)}),M.preventDefault()}),O.append(B)}}function I(){T&&document.removeEventListener("click",T),S.finalize()}return{view:S,spec:t,vgSpec:b,finalize:I}})}var WK,w1e,Lmn,v1e,Jb,aF,VK,iat,zmn,jz,qK,Umn,jmn,Vmn,Kmn,V2=w(()=>{"use strict";iMe();WK=tc(sMe()),w1e=tc(Z3e());cbe();cbe();Ist();Dst();Kst();Qst();Lmn=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});Jb=ube,aF=f1e,VK=typeof window<"u"?window:void 0;aF===void 0&&(!((v1e=VK?.vl)===null||v1e===void 0)&&v1e.compile)&&(aF=VK.vl);iat={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},zmn={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},jz={vega:"Vega","vega-lite":"Vega-Lite"},qK={vega:Jb.version,"vega-lite":aF?aF.version:"not available"},Umn={vega:e=>e,"vega-lite":(e,t)=>aF.compile(e,{config:t}).spec},jmn=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Vmn="chart-wrapper";Kmn=qmn});var HK=Ee(($0i,aat)=>{"use strict";var sat=Object.getOwnPropertySymbols,Xmn=Object.prototype.hasOwnProperty,Zmn=Object.prototype.propertyIsEnumerable;function Qmn(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Jmn(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(o){return t[o]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}aat.exports=Jmn()?Object.assign:function(e,t){for(var n,r=Qmn(e),i,o=1;o<arguments.length;o++){n=Object(arguments[o]);for(var s in n)Xmn.call(n,s)&&(r[s]=n[s]);if(sat){i=sat(n);for(var a=0;a<i.length;a++)Zmn.call(n,i[a])&&(r[i[a]]=n[i[a]])}}return r}});var dat=Ee(_1e=>{"use strict";Object.defineProperty(_1e,"__esModule",{value:!0});_1e.StyleSheet=fat;var ehn=HK(),thn=nhn(ehn);function nhn(e){return e&&e.__esModule?e:{default:e}}function rhn(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function C1e(e){return e[e.length-1]}function lat(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var W2=typeof window<"u",cat=!1,ihn=!1,ohn=function(){if(W2){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function uat(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function fat(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!cat&&!ihn:t,r=e.maxLength,i=r===void 0?W2&&ohn?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,thn.default)(fat.prototype,{getSheet:function(){return lat(C1e(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");W2?this.tags[0]=uat():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch{cat&&console.warn("whoops, illegal rule inserted",t)}},insert:function(t){if(W2)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=C1e(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else C1e(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,W2&&this.ctr%this.maxLength===0&&this.tags.push(uat()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){W2?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!W2)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(rhn(Array.from(lat(n).cssRules))))}),t}})});var mat=Ee((L0i,pat)=>{"use strict";var shn=/-(.)/g;function ahn(e){return e.replace(shn,function(t,n){return n.toUpperCase()})}pat.exports=ahn});var gat=Ee((B0i,hat)=>{"use strict";var lhn=mat(),uhn=/^-ms-/;function chn(e){return lhn(e.replace(uhn,"ms-"))}hat.exports=chn});var xat=Ee(S1e=>{"use strict";Object.defineProperty(S1e,"__esModule",{value:!0});var YK={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function fhn(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var dhn=["Webkit","ms","Moz","O"];Object.keys(YK).forEach(function(e){dhn.forEach(function(t){YK[fhn(t,e)]=YK[e]})});var phn={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},mhn={isUnitlessNumber:YK,shorthandPropertyExpansions:phn};S1e.default=mhn});var yat=Ee((U0i,bat)=>{"use strict";function KK(e){return function(){return e}}var G2=function(){};G2.thatReturns=KK;G2.thatReturnsFalse=KK(!1);G2.thatReturnsTrue=KK(!0);G2.thatReturnsNull=KK(null);G2.thatReturnsThis=function(){return this};G2.thatReturnsArgument=function(e){return e};bat.exports=G2});var E1e=Ee((j0i,vat)=>{"use strict";var hhn=yat(),ghn=hhn;vat.exports=ghn});var _at=Ee(A1e=>{"use strict";Object.defineProperty(A1e,"__esModule",{value:!0});var xhn=xat(),bhn=Cat(xhn),yhn=E1e(),V0i=Cat(yhn);function Cat(e){return e&&e.__esModule?e:{default:e}}var wat=bhn.default.isUnitlessNumber;function vhn(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);if(i||t===0||wat.hasOwnProperty(e)&&wat[e])return""+t;if(typeof t=="string"){if(0&&n&&t!=="0"){var o,s,a;if(s)var l}t=t.trim()}return t+"px"}A1e.default=vhn});var Eat=Ee((G0i,Sat)=>{"use strict";var whn=/([A-Z])/g;function Chn(e){return e.replace(whn,"-$1").toLowerCase()}Sat.exports=Chn});var Tat=Ee((q0i,Aat)=>{"use strict";var _hn=Eat(),Shn=/^ms-/;function Ehn(e){return _hn(e).replace(Shn,"-ms-")}Aat.exports=Ehn});var Iat=Ee((H0i,kat)=>{"use strict";function Ahn(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}kat.exports=Ahn});var T1e=Ee(Wz=>{"use strict";Object.defineProperty(Wz,"__esModule",{value:!0});Wz.processStyleName=void 0;Wz.createMarkupForStyles=$hn;var Thn=gat(),Y0i=Vz(Thn),khn=_at(),Ihn=Vz(khn),Dhn=Tat(),Nhn=Vz(Dhn),Fhn=Iat(),Rhn=Vz(Fhn),Ohn=E1e(),K0i=Vz(Ohn);function Vz(e){return e&&e.__esModule?e:{default:e}}var Mhn=Wz.processStyleName=(0,Rhn.default)(Nhn.default);function $hn(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(e.hasOwnProperty(r)&&r!=="label"){var o=e[r];o!=null&&(i?n+=r+":"+o+";":(n+=Mhn(r)+":",n+=(0,Ihn.default)(r,o,t)+";"))}}return n||null}});var Nat=Ee(I1e=>{"use strict";Object.defineProperty(I1e,"__esModule",{value:!0});var Dat=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};I1e.default=k1e;function Phn(e){return e==null||e===!1||(typeof e>"u"?"undefined":Dat(e))==="object"&&Object.keys(e).length===0}function Lhn(e){if(Phn(e))return null;if((typeof e>"u"?"undefined":Dat(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var o=e[n[i]],s=k1e(o);(s===null||s!==o)&&(r=!0),s!==null&&(t[n[i]]=s)}return Object.keys(t).length===0?null:r?t:e}function Bhn(e){var t=!1,n=[];return e.forEach(function(r){var i=k1e(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function k1e(e){return Array.isArray(e)?Bhn(e):Lhn(e)}});var Oat=Ee((XK,Rat)=>{"use strict";Object.defineProperty(XK,"__esModule",{value:!0});var Ke=["Webkit"],Fat=["Moz"],po=["ms"],om=["Webkit","Moz"],u0=["Webkit","ms"],Gz=["Webkit","Moz","ms"];XK.default={plugins:[],prefixMap:{appearance:om,userSelect:Gz,textEmphasisPosition:Ke,textEmphasis:Ke,textEmphasisStyle:Ke,textEmphasisColor:Ke,boxDecorationBreak:Ke,clipPath:Ke,maskImage:Ke,maskMode:Ke,maskRepeat:Ke,maskPosition:Ke,maskClip:Ke,maskOrigin:Ke,maskSize:Ke,maskComposite:Ke,mask:Ke,maskBorderSource:Ke,maskBorderMode:Ke,maskBorderSlice:Ke,maskBorderWidth:Ke,maskBorderOutset:Ke,maskBorderRepeat:Ke,maskBorder:Ke,maskType:Ke,textDecorationStyle:Ke,textDecorationSkip:Ke,textDecorationLine:Ke,textDecorationColor:Ke,filter:Ke,fontFeatureSettings:Ke,breakAfter:Gz,breakBefore:Gz,breakInside:Gz,columnCount:om,columnFill:om,columnGap:om,columnRule:om,columnRuleColor:om,columnRuleStyle:om,columnRuleWidth:om,columns:om,columnSpan:om,columnWidth:om,writingMode:u0,flex:Ke,flexBasis:Ke,flexDirection:Ke,flexGrow:Ke,flexFlow:Ke,flexShrink:Ke,flexWrap:Ke,alignContent:Ke,alignItems:Ke,alignSelf:Ke,justifyContent:Ke,order:Ke,transform:Ke,transformOrigin:Ke,transformOriginX:Ke,transformOriginY:Ke,backfaceVisibility:Ke,perspective:Ke,perspectiveOrigin:Ke,transformStyle:Ke,transformOriginZ:Ke,animation:Ke,animationDelay:Ke,animationDirection:Ke,animationFillMode:Ke,animationDuration:Ke,animationIterationCount:Ke,animationName:Ke,animationPlayState:Ke,animationTimingFunction:Ke,backdropFilter:Ke,fontKerning:Ke,scrollSnapType:u0,scrollSnapPointsX:u0,scrollSnapPointsY:u0,scrollSnapDestination:u0,scrollSnapCoordinate:u0,shapeImageThreshold:Ke,shapeImageMargin:Ke,shapeImageOutside:Ke,hyphens:Gz,flowInto:u0,flowFrom:u0,regionFragment:u0,textAlignLast:Fat,tabSize:Fat,wrapFlow:po,wrapThrough:po,wrapMargin:po,gridTemplateColumns:po,gridTemplateRows:po,gridTemplateAreas:po,gridTemplate:po,gridAutoColumns:po,gridAutoRows:po,gridAutoFlow:po,grid:po,gridRowStart:po,gridColumnStart:po,gridRowEnd:po,gridRow:po,gridColumn:po,gridColumnEnd:po,gridColumnGap:po,gridRowGap:po,gridArea:po,gridGap:po,textSizeAdjust:u0,borderImage:Ke,borderImageOutset:Ke,borderImageRepeat:Ke,borderImageSlice:Ke,borderImageSource:Ke,borderImageWidth:Ke,transitionDelay:Ke,transitionDuration:Ke,transitionProperty:Ke,transitionTimingFunction:Ke}};Rat.exports=XK.default});var D1e=Ee((ZK,Mat)=>{"use strict";Object.defineProperty(ZK,"__esModule",{value:!0});ZK.default=zhn;function zhn(e){return e.charAt(0).toUpperCase()+e.slice(1)}Mat.exports=ZK.default});var Pat=Ee((QK,$at)=>{"use strict";Object.defineProperty(QK,"__esModule",{value:!0});QK.default=Whn;var Uhn=D1e(),jhn=Vhn(Uhn);function Vhn(e){return e&&e.__esModule?e:{default:e}}function Whn(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],i=0,o=r.length;i<o;++i)n[r[i]+(0,jhn.default)(t)]=n[t]}$at.exports=QK.default});var Bat=Ee((JK,Lat)=>{"use strict";Object.defineProperty(JK,"__esModule",{value:!0});JK.default=Ghn;function Ghn(e,t,n,r,i){for(var o=0,s=e.length;o<s;++o){var a=e[o](t,n,r,i);if(a)return a}}Lat.exports=JK.default});var Uat=Ee((eX,zat)=>{"use strict";Object.defineProperty(eX,"__esModule",{value:!0});eX.default=Yhn;var qhn=["-webkit-","-moz-",""],Hhn={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function Yhn(e,t){if(e==="cursor"&&Hhn.hasOwnProperty(t))return qhn.map(function(n){return n+t})}zat.exports=eX.default});var lF=Ee((tX,jat)=>{"use strict";Object.defineProperty(tX,"__esModule",{value:!0});tX.default=Xhn;var Khn=/-webkit-|-moz-|-ms-/;function Xhn(e){return typeof e=="string"&&Khn.test(e)}jat.exports=tX.default});var Wat=Ee((nX,Vat)=>{"use strict";Object.defineProperty(nX,"__esModule",{value:!0});nX.default=tgn;var Zhn=lF(),Qhn=Jhn(Zhn);function Jhn(e){return e&&e.__esModule?e:{default:e}}var egn=["-webkit-",""];function tgn(e,t){if(typeof t=="string"&&!(0,Qhn.default)(t)&&t.indexOf("cross-fade(")>-1)return egn.map(function(n){return t.replace(/cross-fade\(/g,n+"cross-fade(")})}Vat.exports=nX.default});var qat=Ee((rX,Gat)=>{"use strict";Object.defineProperty(rX,"__esModule",{value:!0});rX.default=sgn;var ngn=lF(),rgn=ign(ngn);function ign(e){return e&&e.__esModule?e:{default:e}}var ogn=["-webkit-",""];function sgn(e,t){if(typeof t=="string"&&!(0,rgn.default)(t)&&t.indexOf("filter(")>-1)return ogn.map(function(n){return t.replace(/filter\(/g,n+"filter(")})}Gat.exports=rX.default});var Kat=Ee((iX,Yat)=>{"use strict";Object.defineProperty(iX,"__esModule",{value:!0});iX.default=agn;var Hat={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function agn(e,t){if(e==="display"&&Hat.hasOwnProperty(t))return Hat[t]}Yat.exports=iX.default});var Qat=Ee((oX,Zat)=>{"use strict";Object.defineProperty(oX,"__esModule",{value:!0});oX.default=ugn;var lgn={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},Xat={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function ugn(e,t,n){e==="flexDirection"&&typeof t=="string"&&(t.indexOf("column")>-1?n.WebkitBoxOrient="vertical":n.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?n.WebkitBoxDirection="reverse":n.WebkitBoxDirection="normal"),Xat.hasOwnProperty(e)&&(n[Xat[e]]=lgn[t]||t)}Zat.exports=oX.default});var elt=Ee((sX,Jat)=>{"use strict";Object.defineProperty(sX,"__esModule",{value:!0});sX.default=hgn;var cgn=lF(),fgn=dgn(cgn);function dgn(e){return e&&e.__esModule?e:{default:e}}var pgn=["-webkit-","-moz-",""],mgn=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function hgn(e,t){if(typeof t=="string"&&!(0,fgn.default)(t)&&mgn.test(t))return pgn.map(function(n){return n+t})}Jat.exports=sX.default});var nlt=Ee((aX,tlt)=>{"use strict";Object.defineProperty(aX,"__esModule",{value:!0});aX.default=vgn;var ggn=lF(),xgn=bgn(ggn);function bgn(e){return e&&e.__esModule?e:{default:e}}var ygn=["-webkit-",""];function vgn(e,t){if(typeof t=="string"&&!(0,xgn.default)(t)&&t.indexOf("image-set(")>-1)return ygn.map(function(n){return t.replace(/image-set\(/g,n+"image-set(")})}tlt.exports=aX.default});var ilt=Ee((lX,rlt)=>{"use strict";Object.defineProperty(lX,"__esModule",{value:!0});lX.default=wgn;function wgn(e,t){if(e==="position"&&t==="sticky")return["-webkit-sticky","sticky"]}rlt.exports=lX.default});var slt=Ee((uX,olt)=>{"use strict";Object.defineProperty(uX,"__esModule",{value:!0});uX.default=Egn;var Cgn=["-webkit-","-moz-",""],_gn={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},Sgn={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function Egn(e,t){if(_gn.hasOwnProperty(e)&&Sgn.hasOwnProperty(t))return Cgn.map(function(n){return n+t})}olt.exports=uX.default});var alt={};rn(alt,{default:()=>Dgn});function kgn(e){return"-"+e.toLowerCase()}function Ign(e){if(N1e.hasOwnProperty(e))return N1e[e];var t=e.replace(Agn,kgn);return N1e[e]=Tgn.test(t)?"-"+t:t}var Agn,Tgn,N1e,Dgn,llt=w(()=>{"use strict";Agn=/[A-Z]/g,Tgn=/^ms-/,N1e={};Dgn=Ign});var clt=Ee((cX,ult)=>{"use strict";Object.defineProperty(cX,"__esModule",{value:!0});cX.default=Ogn;var Ngn=(llt(),zs(alt)),Fgn=Rgn(Ngn);function Rgn(e){return e&&e.__esModule?e:{default:e}}function Ogn(e){return(0,Fgn.default)(e)}ult.exports=cX.default});var plt=Ee((fX,dlt)=>{"use strict";Object.defineProperty(fX,"__esModule",{value:!0});fX.default=Vgn;var Mgn=clt(),$gn=F1e(Mgn),Pgn=lF(),Lgn=F1e(Pgn),Bgn=D1e(),flt=F1e(Bgn);function F1e(e){return e&&e.__esModule?e:{default:e}}var zgn={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},Ugn={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function jgn(e,t){if((0,Lgn.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),r=0,i=n.length;r<i;++r){var o=n[r],s=[o];for(var a in t){var l=(0,$gn.default)(a);if(o.indexOf(l)>-1&&l!=="order")for(var u=t[a],c=0,f=u.length;c<f;++c)s.unshift(o.replace(l,Ugn[u[c]]+l))}n[r]=s.join(",")}return n.join(",")}function Vgn(e,t,n,r){if(typeof t=="string"&&zgn.hasOwnProperty(e)){var i=jgn(t,r),o=i.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(a){return!/-moz-|-ms-/.test(a)}).join(",");if(e.indexOf("Webkit")>-1)return o;var s=i.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(a){return!/-webkit-|-ms-/.test(a)}).join(",");return e.indexOf("Moz")>-1?s:(n["Webkit"+(0,flt.default)(e)]=o,n["Moz"+(0,flt.default)(e)]=s,i)}}dlt.exports=fX.default});var hlt=Ee(R1e=>{"use strict";Object.defineProperty(R1e,"__esModule",{value:!0});R1e.default=x0n;var Wgn=Oat(),Ggn=Zc(Wgn),qgn=Pat(),Hgn=Zc(qgn),Ygn=Bat(),Kgn=Zc(Ygn),Xgn=Uat(),Zgn=Zc(Xgn),Qgn=Wat(),Jgn=Zc(Qgn),e0n=qat(),t0n=Zc(e0n),n0n=Kat(),r0n=Zc(n0n),i0n=Qat(),o0n=Zc(i0n),s0n=elt(),a0n=Zc(s0n),l0n=nlt(),u0n=Zc(l0n),c0n=ilt(),f0n=Zc(c0n),d0n=slt(),p0n=Zc(d0n),m0n=plt(),h0n=Zc(m0n);function Zc(e){return e&&e.__esModule?e:{default:e}}var g0n=[Jgn.default,Zgn.default,t0n.default,o0n.default,a0n.default,u0n.default,f0n.default,p0n.default,h0n.default,r0n.default],mlt=Ggn.default.prefixMap;function x0n(e){for(var t in e){var n=e[t],r=(0,Kgn.default)(g0n,t,n,e,mlt);r&&(e[t]=r),(0,Hgn.default)(mlt,t,e)}return e}});var blt=Ee(uF=>{"use strict";Object.defineProperty(uF,"__esModule",{value:!0});var O1e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};uF.PluginSet=xlt;uF.fallbacks=_0n;uF.contentWrap=E0n;uF.prefixes=A0n;var b0n=HK(),M1e=glt(b0n),y0n=T1e(),v0n=hlt(),w0n=glt(v0n);function glt(e){return e&&e.__esModule?e:{default:e}}var C0n=function(e){return e==="development"||!e}("production");function xlt(e){this.fns=e||[]}(0,M1e.default)(xlt.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(o){t.fns.indexOf(o)>=0?C0n&&console.warn("adding the same plugin again, ignoring"):t.fns=[o].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function _0n(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,o){return i[o]=Array.isArray(n[o])?n[o].join("; "+(0,y0n.processStyleName)(o)+": "):n[o],i},{});return(0,M1e.default)({},e,{style:r})}return e}var S0n=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function E0n(e){if(e.style.content){var t=e.style.content;return S0n.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:O1e({},e,{style:O1e({},e.style,{content:'"'+t+'"'})})}return e}function A0n(e){return(0,M1e.default)({},e,{style:(0,w0n.default)(O1e({},e.style))})}});var vlt=Ee($1e=>{"use strict";Object.defineProperty($1e,"__esModule",{value:!0});$1e.default=T0n;function T0n(e,t){for(var n=1540483477,r=24,i=t^e.length,o=e.length,s=0;o>=4;){var a=k0n(e,s);a=q2(a,n),a^=a>>>r,a=q2(a,n),i=q2(i,n),i^=a,s+=4,o-=4}switch(o){case 3:i^=ylt(e,s),i^=e.charCodeAt(s+2)<<16,i=q2(i,n);break;case 2:i^=ylt(e,s),i=q2(i,n);break;case 1:i^=e.charCodeAt(s),i=q2(i,n);break}return i^=i>>>13,i=q2(i,n),i^=i>>>15,i>>>0}function k0n(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function ylt(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function q2(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}});var cF=Ee(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.compose=Be.merge=Be.$=Be.style=Be.presets=Be.keyframes=Be.fontFace=Be.insertGlobal=Be.insertRule=Be.plugins=Be.styleSheet=void 0;Be.speedy=$0n;Be.simulations=L0n;Be.simulate=B0n;Be.cssLabels=z0n;Be.isLikeRule=j1e;Be.idFor=V1e;Be.css=Ps;Be.rehydrate=exn;Be.flush=txn;Be.select=W1e;Be.parent=rxn;Be.media=ixn;Be.pseudo=Xt;Be.active=oxn;Be.any=sxn;Be.checked=axn;Be.disabled=lxn;Be.empty=uxn;Be.enabled=cxn;Be._default=fxn;Be.first=dxn;Be.firstChild=pxn;Be.firstOfType=mxn;Be.fullscreen=hxn;Be.focus=gxn;Be.hover=xxn;Be.indeterminate=bxn;Be.inRange=yxn;Be.invalid=vxn;Be.lastChild=wxn;Be.lastOfType=Cxn;Be.left=_xn;Be.link=Sxn;Be.onlyChild=Exn;Be.onlyOfType=Axn;Be.optional=Txn;Be.outOfRange=kxn;Be.readOnly=Ixn;Be.readWrite=Dxn;Be.required=Nxn;Be.right=Fxn;Be.root=Rxn;Be.scope=Oxn;Be.target=Mxn;Be.valid=$xn;Be.visited=Pxn;Be.dir=Lxn;Be.lang=Bxn;Be.not=zxn;Be.nthChild=Uxn;Be.nthLastChild=jxn;Be.nthLastOfType=Vxn;Be.nthOfType=Wxn;Be.after=Gxn;Be.before=qxn;Be.firstLetter=Hxn;Be.firstLine=Yxn;Be.selection=Kxn;Be.backdrop=Xxn;Be.placeholder=Zxn;Be.cssFor=Qxn;Be.attribsFor=Jxn;var I0n=HK(),D0n=z1e(I0n),N0n=dat(),B1e=T1e(),F0n=Nat(),Uw=z1e(F0n),ey=blt(),R0n=vlt(),O0n=z1e(R0n);function z1e(e){return e&&e.__esModule?e:{default:e}}function M0n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function Hz(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qc=Be.styleSheet=new N0n.StyleSheet;Qc.inject();function $0n(e){return Qc.speedy(e)}var Yz=Be.plugins=Qc.plugins=new ey.PluginSet([ey.prefixes,ey.contentWrap,ey.fallbacks]);Yz.media=new ey.PluginSet;Yz.fontFace=new ey.PluginSet;Yz.keyframes=new ey.PluginSet([ey.prefixes,ey.fallbacks]);var Kz=!1,P0n=!1,bX=typeof window<"u",U1e=Kz,wlt=!1,Clt=!1;function L0n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;U1e=!!e}function B0n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,Uw.default)(t),t?U1e?t.reduce(function(r,i){return r["data-simulate-"+mX(i)]="",r},{}):(wlt||(console.warn("can't simulate without once calling simulations(true)"),wlt=!0),!Kz&&!P0n&&!Clt&&(console.warn("don't use simulation outside dev"),Clt=!0),{}):{}}var Xz=Kz;function z0n(e){Xz=!!e}function mX(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function Zz(e){var t=JSON.stringify(e),n=(0,O0n.default)(t).toString(36);return e.label&&e.label.length>0&&Kz?mX(e.label.join("."),"-")+"-"+n:n}function j1e(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function V1e(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var U0n=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function P1e(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=U0n.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function _lt(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=P1e(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return U1e&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+mX(t)+"],[data-css-"+e+"][data-simulate-"+mX(t)+"]"),n}function L1e(e){var t=e.selector,n=e.style,r=Yz.transform({selector:t,style:n});return r.selector+"{"+(0,B1e.createMarkupForStyles)(r.style)+"}"}function hX(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(o){o.indexOf("&")>=0?(n=n||{},n[o]=e[o]):o.indexOf("@media")===0?(r=r||{},r[o]=hX(e[o])):o.indexOf("@supports")===0?(i=i||{},i[o]=hX(e[o])):o==="label"?e.label.length>0&&(t=t||{},t.label=Xz?e.label.join("."):""):(t=t||{},t[o]=e[o])}),{plain:t,selects:n,medias:r,supports:i}}function gX(e,t){var n=[],r=t.plain,i=t.selects,o=t.medias,s=t.supports;return r&&n.push(L1e({style:r,selector:_lt(e)})),i&&Object.keys(i).forEach(function(a){return n.push(L1e({style:i[a],selector:_lt(e,a)}))}),o&&Object.keys(o).forEach(function(a){return n.push(a+"{"+gX(e,o[a]).join("")+"}")}),s&&Object.keys(s).forEach(function(a){return n.push(a+"{"+gX(e,s[a]).join("")+"}")}),n}var sm=Qc.inserted={};function j0n(e){if(!sm[e.id]){sm[e.id]=!0;var t=hX(e.style),n=gX(e.id,t);sm[e.id]=bX?!0:n,n.forEach(function(r){return Qc.insert(r)})}}var qz=Qc.registered={};function yX(e){qz[e.id]||(qz[e.id]=e)}function V0n(e){if(j1e(e)){var t=qz[V1e(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var pX={};function W0n(e){if(yX(e),j0n(e),pX[e.id])return pX[e.id];var t=Hz({},"data-css-"+e.id,Xz&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),pX[e.id]=t,t}function G0n(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function Slt(e,t){var n=P1e(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=P1e(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,o){return i.concat(n.map(function(s){return o.replace(/\&/g,s)}))},[]).join(",")}function q0n(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function H0n(e){return e.indexOf("@media")===0}function Y0n(e){return e.indexOf("@supports")===0}function K0n(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function klt(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(klt(e[n])):t=t.concat(e[n]);return t}var Elt={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function H2(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,o=i===void 0?"":i,s=t.supp,a=s===void 0?"":s,l=t.src,u=l===void 0?{}:l;Array.isArray(u)||(u=[u]),u=klt(u),u.forEach(function(c){if(j1e(c)){var f=V0n(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,Uw.default)(c),c&&c.composes&&H2(e,{selector:r,mq:o,supp:a,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(G0n(d))Elt[d]&&Elt[d].forEach(function(m){return H2(e,{selector:Slt(r,m),mq:o,supp:a,src:c[d]})}),H2(e,{selector:Slt(r,d),mq:o,supp:a,src:c[d]});else if(H0n(d))H2(e,{selector:r,mq:q0n(o,d),supp:a,src:c[d]});else if(Y0n(d))H2(e,{selector:r,mq:o,supp:K0n(a,d),src:c[d]});else if(d!=="composes"){var p=e;a&&(p[a]=p[a]||{},p=p[a]),o&&(p[o]=p[o]||{},p=p[o]),r&&(p[r]=p[r]||{},p=p[r]),d==="label"?Xz&&(e.label=e.label.concat(c.label)):p[d]=c[d]}})})}function Alt(e){var t={label:[]};H2(t,{src:e});var n={id:Zz(t),style:t,label:Xz?t.label.join("."):"",type:"css"};return W0n(n)}var xX={};Object.defineProperty(xX,"toString",{enumerable:!1,value:function(){return"css-nil"}});var dX=typeof WeakMap<"u"?[xX,new WeakMap,new WeakMap,new WeakMap]:[xX],Tlt=!1;function X0n(e){return function(t){if(dX[t.length]){for(var n=dX[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(qz[i.toString().substring(4)])return i}}var o=e(t);if(dX[t.length]){for(var s=0,a=dX[t.length];s<t.length-1;)a=a.get(t[s]),s++;try{a.set(t[s],o)}catch{if(Kz&&!Tlt){var l;Tlt=!0,(l=console).warn.apply(l,["failed setting the WeakMap cache for args:"].concat(M0n(t))),console.warn("this should NOT happen, please file a bug on the github repo.")}}}return o}}var Z0n=typeof WeakMap<"u"?X0n(Alt):Alt;function Ps(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,Uw.default)(t),t?Z0n(t):xX}Ps.insert=function(e){var t={id:Zz(e),css:e,type:"raw"};yX(t),sm[t.id]||(Qc.insert(t.css),sm[t.id]=bX?!0:[t.css])};var txi=Be.insertRule=Ps.insert;Ps.global=function(e,t){if(t=(0,Uw.default)(t),t)return Ps.insert(L1e({selector:e,style:t}))};var nxi=Be.insertGlobal=Ps.global;function Q0n(e){if(!sm[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=Yz.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,B1e.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Qc.insert(r)}),sm[e.id]=bX?!0:n}}Ps.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,Uw.default)(t)||{};var n={id:Zz({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return yX(n),Q0n(n),e+"_"+n.id};Ps.fontFace=function(e){e=(0,Uw.default)(e);var t={id:Zz(e),type:"font-face",font:e};return yX(t),J0n(t),e.fontFamily};var rxi=Be.fontFace=Ps.fontFace,ixi=Be.keyframes=Ps.keyframes;function J0n(e){if(!sm[e.id]){var t="@font-face{"+(0,B1e.createMarkupForStyles)(e.font)+"}";Qc.insert(t),sm[e.id]=bX?!0:[t]}}function exn(e){(0,D0n.default)(sm,e.reduce(function(t,n){return t[n]=!0,t},{}))}function txn(){sm=Qc.inserted={},qz=Qc.registered={},pX={},Qc.flush(),Qc.inject()}var oxi=Be.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"},nxn=Be.style=Ps;function W1e(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?Ps(Hz({},e,n)):nxn(n)}var sxi=Be.$=W1e;function rxn(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ps(Hz({},e+" &",n))}var axi=Be.merge=Ps,lxi=Be.compose=Ps;function ixn(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ps(Hz({},"@media "+e,n))}function Xt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ps(Hz({},e,n))}function oxn(e){return Xt(":active",e)}function sxn(e){return Xt(":any",e)}function axn(e){return Xt(":checked",e)}function lxn(e){return Xt(":disabled",e)}function uxn(e){return Xt(":empty",e)}function cxn(e){return Xt(":enabled",e)}function fxn(e){return Xt(":default",e)}function dxn(e){return Xt(":first",e)}function pxn(e){return Xt(":first-child",e)}function mxn(e){return Xt(":first-of-type",e)}function hxn(e){return Xt(":fullscreen",e)}function gxn(e){return Xt(":focus",e)}function xxn(e){return Xt(":hover",e)}function bxn(e){return Xt(":indeterminate",e)}function yxn(e){return Xt(":in-range",e)}function vxn(e){return Xt(":invalid",e)}function wxn(e){return Xt(":last-child",e)}function Cxn(e){return Xt(":last-of-type",e)}function _xn(e){return Xt(":left",e)}function Sxn(e){return Xt(":link",e)}function Exn(e){return Xt(":only-child",e)}function Axn(e){return Xt(":only-of-type",e)}function Txn(e){return Xt(":optional",e)}function kxn(e){return Xt(":out-of-range",e)}function Ixn(e){return Xt(":read-only",e)}function Dxn(e){return Xt(":read-write",e)}function Nxn(e){return Xt(":required",e)}function Fxn(e){return Xt(":right",e)}function Rxn(e){return Xt(":root",e)}function Oxn(e){return Xt(":scope",e)}function Mxn(e){return Xt(":target",e)}function $xn(e){return Xt(":valid",e)}function Pxn(e){return Xt(":visited",e)}function Lxn(e,t){return Xt(":dir("+e+")",t)}function Bxn(e,t){return Xt(":lang("+e+")",t)}function zxn(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?Xt(":not("+e+")",t):W1e(n.join(""),t)}function Uxn(e,t){return Xt(":nth-child("+e+")",t)}function jxn(e,t){return Xt(":nth-last-child("+e+")",t)}function Vxn(e,t){return Xt(":nth-last-of-type("+e+")",t)}function Wxn(e,t){return Xt(":nth-of-type("+e+")",t)}function Gxn(e){return Xt("::after",e)}function qxn(e){return Xt("::before",e)}function Hxn(e){return Xt("::first-letter",e)}function Yxn(e){return Xt("::first-line",e)}function Kxn(e){return Xt("::selection",e)}function Xxn(e){return Xt("::backdrop",e)}function Zxn(e){return Ps({"::placeholder":e})}function Qxn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,Uw.default)(t),t?t.map(function(r){var i={label:[]};return H2(i,{src:r}),gX(Zz(i),hX(i)).join("")}).join(""):""}function Jxn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,Uw.default)(t);var r=t?t.map(function(i){V1e(i);var o=Object.keys(i)[0],s=i[o];return o+'="'+(s||"")+'"'}).join(" "):"";return r}});var G1e=Ee(vX=>{"use strict";Object.defineProperty(vX,"__esModule",{value:!0});function ebn(e){return e.name!=null}vX.isSurfaceInfo=ebn;function tbn(e){return e.drawArea instanceof HTMLElement}vX.isSurface=tbn});var AX={};rn(AX,{Component:()=>Qz,cloneElement:()=>Flt,createElement:()=>wX,default:()=>mbn,h:()=>wX,options:()=>Yu,render:()=>jlt,rerender:()=>K1e});function nbn(){}function wX(e,t){var n=Ilt,r,i,o,s;for(s=arguments.length;s-- >2;)fF.push(arguments[s]);for(t&&t.children!=null&&(fF.length||fF.push(t.children),delete t.children);fF.length;)if((i=fF.pop())&&i.pop!==void 0)for(s=i.length;s--;)fF.push(i[s]);else typeof i=="boolean"&&(i=null),(o=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(o=!1)),o&&r?n[n.length-1]+=i:n===Ilt?n=[i]:n.push(i),r=o;var a=new nbn;return a.nodeName=e,a.children=n,a.attributes=t??void 0,a.key=t?.key,Yu.vnode!==void 0&&Yu.vnode(a),a}function Vw(e,t){for(var n in t)e[n]=t[n];return e}function Flt(e,t){return wX(e.nodeName,Vw(Vw({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}function Rlt(e){!e._dirty&&(e._dirty=!0)&&q1e.push(e)==1&&(Yu.debounceRendering||rbn)(K1e)}function K1e(){var e,t=q1e;for(q1e=[];e=t.pop();)e._dirty&&SX(e)}function obn(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&Olt(e,t.nodeName):n||e._componentConstructor===t.nodeName}function Olt(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function Mlt(e){var t=Vw({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function sbn(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function X1e(e){var t=e.parentNode;t&&t.removeChild(e)}function Dlt(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]=typeof r[o]=="number"&&ibn.test(o)===!1?r[o]+"px":r[o]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var s=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,Nlt,s):e.removeEventListener(t,Nlt,s),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)abn(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var a=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function abn(e,t,n){try{e[t]=n}catch{}}function Nlt(e){return this._listeners[e.type](Yu.event&&Yu.event(e)||e)}function Plt(){for(var e;e=$lt.pop();)Yu.afterMount&&Yu.afterMount(e),e.componentDidMount&&e.componentDidMount()}function Llt(e,t,n,r,i,o){H1e++||(jw=i!=null&&i.ownerSVGElement!==void 0,CX=e!=null&&!("__preactattr_"in e));var s=Blt(e,t,n,r,o);return i&&s.parentNode!==i&&i.appendChild(s),--H1e||(CX=!1,o||Plt()),s}function Blt(e,t,n,r,i){var o=e,s=jw;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(o=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(o,e),Y2(e,!0))),o.__preactattr_=!0,o;var a=t.nodeName;if(typeof a=="function")return dbn(e,t,n,r);if(jw=a==="svg"?!0:a==="foreignObject"?!1:jw,a=String(a),(!e||!Olt(e,a))&&(o=sbn(a,jw),e)){for(;e.firstChild;)o.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(o,e),Y2(e,!0)}var l=o.firstChild,u=o.__preactattr_,c=t.children;if(u==null){u=o.__preactattr_={};for(var f=o.attributes,d=f.length;d--;)u[f[d].name]=f[d].value}return!CX&&c&&c.length===1&&typeof c[0]=="string"&&l!=null&&l.splitText!==void 0&&l.nextSibling==null?l.nodeValue!=c[0]&&(l.nodeValue=c[0]):(c&&c.length||l!=null)&&lbn(o,c,n,r,CX||u.dangerouslySetInnerHTML!=null),ubn(o,t.attributes,u),jw=s,o}function lbn(e,t,n,r,i){var o=e.childNodes,s=[],a={},l=0,u=0,c=o.length,f=0,d=t?t.length:0,p,m,h,g,x;if(c!==0)for(var b=0;b<c;b++){var y=o[b],v=y.__preactattr_,C=d&&v?y._component?y._component.__key:v.key:null;C!=null?(l++,a[C]=y):(v||(y.splitText!==void 0?!i||y.nodeValue.trim():i))&&(s[f++]=y)}if(d!==0)for(var b=0;b<d;b++){g=t[b],x=null;var C=g.key;if(C!=null)l&&a[C]!==void 0&&(x=a[C],a[C]=void 0,l--);else if(!x&&u<f){for(p=u;p<f;p++)if(s[p]!==void 0&&obn(m=s[p],g,i)){x=m,s[p]=void 0,p===f-1&&f--,p===u&&u++;break}}x=Blt(x,g,n,r),h=o[b],x&&x!==e&&x!==h&&(h==null?e.appendChild(x):x===h.nextSibling?X1e(h):e.insertBefore(x,h))}if(l)for(var b in a)a[b]!==void 0&&Y2(a[b],!1);for(;u<=f;)(x=s[f--])!==void 0&&Y2(x,!1)}function Y2(e,t){var n=e._component;n?EX(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&X1e(e),zlt(e))}function zlt(e){for(e=e.lastChild;e;){var t=e.previousSibling;Y2(e,!0),e=t}}function ubn(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&Dlt(e,r,n[r],n[r]=void 0,jw);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&Dlt(e,r,n[r],n[r]=t[r],jw)}function cbn(e){var t=e.constructor.name;(Y1e[t]||(Y1e[t]=[])).push(e)}function Ult(e,t,n){var r=Y1e[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),Qz.call(i,t,n)):(i=new Qz(t,n),i.constructor=e,i.render=fbn),r){for(var o=r.length;o--;)if(r[o].constructor===e){i.nextBase=r[o].nextBase,r.splice(o,1);break}}return i}function fbn(e,t,n){return this.constructor(e,n)}function _X(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||Yu.syncComponentUpdates!==!1||!e.base?SX(e,1,i):Rlt(e)),e.__ref&&e.__ref(e))}function SX(e,t,n,r){if(!e._disable){var i=e.props,o=e.state,s=e.context,a=e.prevProps||i,l=e.prevState||o,u=e.prevContext||s,c=e.base,f=e.nextBase,d=c||f,p=e._component,m=!1,h,g,x;if(c&&(e.props=a,e.state=l,e.context=u,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,o,s)===!1?m=!0:e.componentWillUpdate&&e.componentWillUpdate(i,o,s),e.props=i,e.state=o,e.context=s),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!m){h=e.render(i,o,s),e.getChildContext&&(s=Vw(Vw({},s),e.getChildContext()));var b=h&&h.nodeName,y,v;if(typeof b=="function"){var C=Mlt(h);g=p,g&&g.constructor===b&&C.key==g.__key?_X(g,C,1,s,!1):(y=g,e._component=g=Ult(b,C,s),g.nextBase=g.nextBase||f,g._parentComponent=e,_X(g,C,0,s,!1),SX(g,1,n,!0)),v=g.base}else x=d,y=p,y&&(x=e._component=null),(d||t===1)&&(x&&(x._component=null),v=Llt(x,h,s,n||!c,d&&d.parentNode,!0));if(d&&v!==d&&g!==p){var _=d.parentNode;_&&v!==_&&(_.replaceChild(v,d),y||(d._component=null,Y2(d,!1)))}if(y&&EX(y),e.base=v,v&&!r){for(var S=e,E=e;E=E._parentComponent;)(S=E).base=v;v._component=S,v._componentConstructor=S.constructor}}if(!c||n?$lt.unshift(e):m||(e.componentDidUpdate&&e.componentDidUpdate(a,l,u),Yu.afterUpdate&&Yu.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!H1e&&!r&&Plt()}}function dbn(e,t,n,r){for(var i=e&&e._component,o=i,s=e,a=i&&e._componentConstructor===t.nodeName,l=a,u=Mlt(t);i&&!l&&(i=i._parentComponent);)l=i.constructor===t.nodeName;return i&&l&&(!r||i._component)?(_X(i,u,3,n,r),e=i.base):(o&&!a&&(EX(o),e=s=null),i=Ult(t.nodeName,u,n),e&&!i.nextBase&&(i.nextBase=e,s=null),_X(i,u,1,n,r),e=i.base,s&&e!==s&&(s._component=null,Y2(s,!1))),e}function EX(e){Yu.beforeUnmount&&Yu.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?EX(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,X1e(t),cbn(e),zlt(t)),e.__ref&&e.__ref(null)}function Qz(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function jlt(e,t,n){return Llt(n,e,{},!1,t,!1)}var Yu,fF,Ilt,rbn,ibn,q1e,$lt,H1e,jw,CX,Y1e,pbn,mbn,TX=w(()=>{"use strict";Yu={},fF=[],Ilt=[];rbn=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;ibn=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,q1e=[];$lt=[],H1e=0,jw=!1,CX=!1;Y1e={};Vw(Qz.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=Vw({},r)),Vw(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),Rlt(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),SX(this,2)},render:function(){}});pbn={h:wX,createElement:wX,cloneElement:Flt,Component:Qz,render:jlt,rerender:K1e,options:Yu},mbn=pbn});var Vlt=Ee(Q1e=>{"use strict";Object.defineProperty(Q1e,"__esModule",{value:!0});var kX=(TX(),zs(AX)),Z1e=cF(),hbn=(()=>{class e extends kX.Component{componentDidMount(){let{name:n,tab:r}=this.props;this.props.registerSurface(n,r,this)}componentDidUpdate(){return!1}render(){let{name:n,visible:r,styles:i}=this.props,o=Object.assign({},e.defaultStyles,i),{width:s,height:a}=o,{maxHeight:l,maxWidth:u}=o;l=a===e.defaultStyles.height?l:a,u=s===e.defaultStyles.width?u:s;let c=Z1e.css({display:r?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:a,width:s,maxHeight:l,maxWidth:u,overflow:"auto"}),f=Z1e.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),d=Z1e.css({boxSizing:"border-box"});return kX.h("div",{className:`${c} tf-surface`,ref:p=>this.container=p,"data-visible":r},kX.h("div",{className:`${f} tf-label`,ref:p=>this.label=p},n),kX.h("div",{className:`${d} tf-draw-area`,ref:p=>this.drawArea=p}))}}return e.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},e})();Q1e.SurfaceComponent=hbn});var Glt=Ee(twe=>{"use strict";Object.defineProperty(twe,"__esModule",{value:!0});var Jz=(TX(),zs(AX)),Wlt=cF(),J1e=class extends Jz.Component{render(){let{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(s=>Jz.h(ewe,{key:s,id:s,handleClick:r,isActive:s===n},s)):null,o=Wlt.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return Jz.h("div",{className:`${o} visor-tabs`},i)}};twe.Tabs=J1e;var ewe=class extends Jz.Component{render(){let{children:t,isActive:n,handleClick:r,id:i}=this.props,o=Wlt.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return Jz.h("a",{className:`${o} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}});var qlt=Ee(rwe=>{"use strict";Object.defineProperty(rwe,"__esModule",{value:!0});var am=(TX(),zs(AX)),K2=cF(),gbn=Vlt(),xbn=Glt(),nwe=class e extends am.Component{static render(t,n,r){return am.render(am.h(e,Object.assign({},r)),t,n)}constructor(t){super(t),this.surfaces=new Map;let n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){let r=this.surfaceId(t,n),i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){let n=t.map(o=>o.tab),r=this.state.tabs,i;for(let o of n)r.has(o)||(r.add(o),i=o);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){let i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){t.keyCode===192&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){let{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,o=Array.from(this.getTabs().values()),l=n?"90vw":"550px",u=K2.css({width:l,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=K2.css({right:"0"}),f=K2.css({right:`calc(-${l} - 10px)`}),d=t?c:f,p=K2.css({});return am.h("div",{className:`${u} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},am.h(bbn,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),am.h(xbn.Tabs,{tabNames:o,activeTab:r,handleClick:this.setActiveTab.bind(this)}),am.h("div",{className:`${p} visor-surfaces`},i.map(m=>am.h(gbn.SurfaceComponent,{key:m.name+m.tab,name:m.name,tab:m.tab,styles:m.styles,registerSurface:this.registerSurface.bind(this),visible:r===m.tab}))))}};rwe.VisorComponent=nwe;function bbn(e){let{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=K2.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),o=K2.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),s=K2.css({marginLeft:"auto"});return am.h("div",{className:`${i} visor-controls`},am.h("button",{className:`${o}`,onClick:n},t?"Minimize":"Maximize"),am.h("button",{className:`${o} ${s}`,onClick:r},"Hide"))}});var owe=Ee(NX=>{"use strict";Object.defineProperty(NX,"__esModule",{value:!0});var ybn=qlt(),IX,vbn="Visor",iwe="tfjs-visor-container";function wbn(){if(typeof document>"u")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(iwe)&&IX!=null)return IX;let e=document.getElementById(iwe);e==null&&(e=document.createElement("div"),e.id=iwe,document.body.appendChild(e));let t;function n(o,s){let a=null;return t=ybn.VisorComponent.render(o,t,{ref:l=>a=l,surfaceList:Array.from(s.values())}),a}let r=new Map,i=n(e,r);return IX=new DX(i,e,r,n),IX}NX.visor=wbn;var DX=class{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){let{name:n}=t,r=t.tab==null?vbn:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");let i=Object.assign({},t,{tab:r}),o=`${n}-${r}`;return this.surfaceList.has(o)||this.surfaceList.set(o,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}};NX.Visor=DX});var ld=Ee(X2=>{"use strict";var Cbn=X2&&X2.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(X2,"__esModule",{value:!0});var Hlt=G1e(),_bn=owe();function Sbn(e){if(e instanceof HTMLElement)return e;if(Hlt.isSurface(e))return e.drawArea;if(Hlt.isSurfaceInfo(e))return _bn.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}X2.getDrawArea=Sbn;function Ebn(e,t){let n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){let o=n[i];if(e[o]!==t[o])return!1}return!0}X2.shallowEquals=Ebn;function Abn(){return Cbn(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}X2.nextFrame=Abn});var ty=Ee(e4=>{"use strict";Object.defineProperty(e4,"__esModule",{value:!0});var Ylt=cF(),Tbn=ld(),kbn={prepend:!1};function Ibn(e,t,n={}){let r=Tbn.getDrawArea(e),i=Ylt.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),o=Ylt.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),s=Object.assign({},kbn,n),a=r.querySelector(`div[data-name=${t}]`);if(!a){if(a=document.createElement("div"),a.setAttribute("class",`${i}`),a.dataset.name=t,s.title){let l=document.createElement("div");l.setAttribute("class",`subsurface-title ${o}`),l.innerText=s.title,a.appendChild(l)}s.prepend?r.insertBefore(a,r.firstChild):r.appendChild(a)}return a}e4.subSurface=Ibn;function Dbn(e){let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=50;return r.clientWidth-n}e4.getDefaultWidth=Dbn;function Nbn(e){return e.clientHeight===0?200:e.clientHeight}e4.getDefaultHeight=Nbn});var Xlt=Ee(Z2=>{"use strict";var Fbn=Z2&&Z2.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},Rbn=Z2&&Z2.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Z2,"__esModule",{value:!0});var Obn=Rbn((V2(),zs(j2))),Klt=ty(),FX=ld();function Mbn(e,t,n={}){return Fbn(this,void 0,void 0,function*(){let r=FX.getDrawArea(e),i=t,o=Object.assign({},$bn,n);if(swe.has(r)){let g=swe.get(r);if(FX.shallowEquals(o,g.lastOptions)){yield FX.nextFrame();let x=g.view,b=x.changeset().remove(()=>!0).insert(i);yield x.change("values",b).runAsync();return}}let{xLabel:s,yLabel:a,xType:l,yType:u}=o,c=null;s!=null&&(c={title:s});let f=null;a!=null&&(f={title:a});let d={actions:!1,mode:"vega-lite",defaultStyle:!1},p;o.color!=null?Array.isArray(o.color)?p={field:"index",type:"nominal",scale:{range:o.color}}:p={value:o.color}:p={value:"#4C78A0"};let m={width:o.width||Klt.getDefaultWidth(r),height:o.height||Klt.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:l,axis:c},y:{field:"value",type:u,axis:f},color:p}};yield FX.nextFrame();let h=yield Obn.default(r,m,d);swe.set(r,{view:h.view,lastOptions:o})})}Z2.barchart=Mbn;var $bn={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},swe=new Map});var Qlt=Ee(Q2=>{"use strict";var Pbn=Q2&&Q2.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},Lbn=Q2&&Q2.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Q2,"__esModule",{value:!0});var Bbn=Lbn((V2(),zs(j2))),Zlt=ty(),zbn=ld();function Ubn(e,t,n={}){return Pbn(this,void 0,void 0,function*(){let r=Object.assign({},jbn,n),i=zbn.getDrawArea(e),o=[],s=t.values,a=t.tickLabels||[],l=a.length===0,u=!0;for(let p=0;p<s.length;p++){let m=l?`Class ${p}`:a[p];l&&a.push(m);for(let h=0;h<s[p].length;h++){let g=l?`Class ${h}`:a[h],x=s[p][h];p===h&&!r.shadeDiagonal?o.push({label:m,prediction:g,count:x,noFill:!0}):(o.push({label:m,prediction:g,count:x,scaleCount:x}),x!==0&&(u=!1))}}if(!r.shadeDiagonal&&u)for(let p of o)p.noFill===!0&&(p.noFill=!1,p.scaleCount=p.count);let c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Zlt.getDefaultWidth(i),height:r.height||Zlt.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:o},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:a}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:a}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});let d=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=d,yield Bbn.default(i,f,c)})}Q2.confusionMatrix=Ubn;var jbn={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}});var t4=Ee(dF=>{"use strict";Object.defineProperty(dF,"__esModule",{value:!0});function Jlt(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}dF.assert=Jlt;function Vbn(e,t,n=""){Jlt(eut(e,t),n+` Shapes ${e} and ${t} must match`)}dF.assertShapesMatch=Vbn;function eut(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}dF.arraysEqual=eut;dF.DECIMAL_PLACES_TO_CHECK=4});var iut=Ee(ny=>{"use strict";var rut=ny&&ny.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},Wbn=ny&&ny.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},Gbn=ny&&ny.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ny,"__esModule",{value:!0});var n4=Wbn((N(),zs(br))),qbn=Gbn((V2(),zs(j2))),tut=ty(),r4=t4(),Hbn=ld();function Ybn(e,t,n={}){return rut(this,void 0,void 0,function*(){let r=Object.assign({},Xbn,n),i=Hbn.getDrawArea(e),o=t.values;r.rowMajor&&(o=yield Kbn(t.values));let{xTickLabels:s,yTickLabels:a}=t;s!=null&&nut(o,s,0),a!=null&&nut(o,a,1);let l="@tfidx@",u=[];if(o instanceof n4.Tensor){r4.assert(o.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");let h=yield o.data(),[g,x]=o.shape;for(let b=0;b<g;b++){let y=s?`${s[b]}${l}${b}`:b;for(let v=0;v<x;v++){let C=a?`${a[v]}${l}${v}`:v,_=b*x+v,S=h[_];u.push({x:y,y:C,value:S})}}}else{let h=o;for(let g=0;g<h.length;g++){let x=s?`${s[g]}${l}${g}`:g;for(let b=0;b<h[g].length;b++){let y=a?`${a[b]}${l}${b}`:b,v=h[g][b];u.push({x,y,value:v})}}}let c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||tut.getDefaultWidth(i),height:r.height||tut.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:u},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},d=`${l}\\d+$`,p=new RegExp(d);s&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),a&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),(s||a)&&(c.tooltip={sanitize:h=>String(h).replace(p,"")});let m;switch(r.colorMap){case"blues":m=["#f7fbff","#4292c6"];break;case"greyscale":m=["#000000","#ffffff"];break;case"viridis":default:m="viridis";break}if(m!=="viridis"){let h=f.encoding.fill;h.scale={range:m}}if(r.domain){let h=f.encoding.fill;h.scale!=null?h.scale=Object.assign({},h.scale,{domain:r.domain}):h.scale={domain:r.domain}}yield qbn.default(i,f,c)})}ny.heatmap=Ybn;function Kbn(e){return rut(this,void 0,void 0,function*(){let t,n;e instanceof n4.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=n4.tidy(()=>n4.tensor2d(e).transpose())),r4.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");let r=yield n.array();n.dispose();let i=[r.length,r[0].length];return r4.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function nut(e,t,n){let r=e instanceof n4.Tensor?e.shape:[e.length,e[0].length];n===0?r4.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&r4.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}var Xbn={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}});var i4=Ee(ry=>{"use strict";var RX=ry&&ry.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(ry,"__esModule",{value:!0});var J2=(N(),zs(br)),Ww=t4();function Zbn(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};let t=e.length,n=-1/0,r=1/0,i=0,o=0,s=0;for(let l=0;l<t;l++){let u=e[l];u>n&&(n=u),u<r&&(r=u),u===0&&(i+=1),isNaN(u)?o+=1:isFinite(u)||(s+=1)}let a={numVals:t,numZeros:i,numNans:o,max:n,min:r,numInfs:s};return a.max===-1/0&&(a.max=NaN),a.min===1/0&&(a.min=NaN),a}ry.arrayStats=Zbn;function Qbn(e){return RX(this,void 0,void 0,function*(){let[t,n,r]=J2.tidy(()=>{let i=J2.scalar(0,e.dtype),o=e.min(),s=e.max(),a=e.equal(i).sum();return[o,s,a]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,o,s,a])=>{let l=i.length,u=0,c=0;for(let m=0;m<l;m++){let h=i[m];isNaN(h)?u+=1:isFinite(h)||(c+=1)}let f=o[0],d=s[0];return u===l&&(f=NaN,d=NaN),{numVals:l,numZeros:a[0],numNans:u,min:f,max:d,numInfs:c}})})}ry.tensorStats=Qbn;function Jbn(e,t,n,r){return RX(this,void 0,void 0,function*(){Ww.assert(e.rank===1,"labels must be a 1D tensor"),Ww.assert(t.rank===1,"predictions must be a 1D tensor"),Ww.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&Ww.assert(r.size===t.size,"labels and predictions must be the same length");let i=e.cast("int32"),o=t.cast("int32");n==null&&(n=J2.tidy(()=>J2.maximum(i.max(),o.max()).cast("int32").dataSync()[0]+1));let s=Promise.resolve(null);return r!=null&&(s=r.data()),Promise.all([i.data(),o.data(),s]).then(([a,l,u])=>{let c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<a.length;f++){let d=a[f],p=l[f];u!=null?c[d][p]+=u[f]:c[d][p]+=1}return c})})}ry.confusionMatrix=Jbn;function eyn(e,t){return RX(this,void 0,void 0,function*(){Ww.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");let n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return J2.dispose([n,r]),i})}ry.accuracy=eyn;function tyn(e,t,n){return RX(this,void 0,void 0,function*(){return Ww.assert(e.rank===1,"labels must be a 1D tensor"),Ww.assert(t.rank===1,"predictions must be a 1D tensor"),Ww.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=J2.tidy(()=>J2.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{let o=Array(n).fill(0),s=Array(n).fill(0);for(let l=0;l<r.length;l++){let u=r[l],c=i[l];o[u]+=1,u===c&&(s[u]+=1)}let a=[];for(let l=0;l<o.length;l++)a.push({count:o[l],accuracy:o[l]===0?0:s[l]/o[l]});return a})})}ry.perClassAccuracy=tyn});var OX,o4,MX=w(()=>{"use strict";OX="http://www.w3.org/1999/xhtml",o4={svg:"http://www.w3.org/2000/svg",xhtml:OX,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}});function pF(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),o4.hasOwnProperty(t)?{space:o4[t],local:e}:e}var $X=w(()=>{"use strict";MX()});function nyn(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===OX&&t.documentElement.namespaceURI===OX?t.createElement(e):t.createElementNS(n,e)}}function ryn(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Gw(e){var t=pF(e);return(t.local?ryn:nyn)(t)}var s4=w(()=>{"use strict";$X();MX()});function iyn(){}function mF(e){return e==null?iyn:function(){return this.querySelector(e)}}var PX=w(()=>{"use strict"});function out(e){typeof e!="function"&&(e=mF(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=new Array(s),l,u,c=0;c<s;++c)(l=o[c])&&(u=e.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new pi(r,this._parents)}var sut=w(()=>{"use strict";ud();PX()});function oyn(){return[]}function LX(e){return e==null?oyn:function(){return this.querySelectorAll(e)}}var awe=w(()=>{"use strict"});function aut(e){typeof e!="function"&&(e=LX(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s=t[o],a=s.length,l,u=0;u<a;++u)(l=s[u])&&(r.push(e.call(l,l.__data__,u,s)),i.push(l));return new pi(r,i)}var lut=w(()=>{"use strict";ud();awe()});var cut,hF,uut,BX,lwe=w(()=>{"use strict";cut=function(e){return function(){return this.matches(e)}};typeof document<"u"&&(hF=document.documentElement,hF.matches||(uut=hF.webkitMatchesSelector||hF.msMatchesSelector||hF.mozMatchesSelector||hF.oMatchesSelector,cut=function(e){return function(){return uut.call(this,e)}}));BX=cut});function fut(e){typeof e!="function"&&(e=BX(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],l,u=0;u<s;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&a.push(l);return new pi(r,this._parents)}var dut=w(()=>{"use strict";ud();lwe()});function zX(e){return new Array(e.length)}var uwe=w(()=>{"use strict"});function put(){return new pi(this._enter||this._groups.map(zX),this._parents)}function a4(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}var cwe=w(()=>{"use strict";uwe();ud();a4.prototype={constructor:a4,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}}});function mut(e){return function(){return e}}var hut=w(()=>{"use strict"});function syn(e,t,n,r,i,o){for(var s=0,a,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new a4(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function ayn(e,t,n,r,i,o,s){var a,l,u={},c=t.length,f=o.length,d=new Array(c),p;for(a=0;a<c;++a)(l=t[a])&&(d[a]=p=gut+s.call(l,l.__data__,a,t),p in u?i[a]=l:u[p]=l);for(a=0;a<f;++a)p=gut+s.call(e,o[a],a,o),(l=u[p])?(r[a]=l,l.__data__=o[a],u[p]=null):n[a]=new a4(e,o[a]);for(a=0;a<c;++a)(l=t[a])&&u[d[a]]===l&&(i[a]=l)}function xut(e,t){if(!e)return p=new Array(this.size()),u=-1,this.each(function(_){p[++u]=_}),p;var n=t?ayn:syn,r=this._parents,i=this._groups;typeof e!="function"&&(e=mut(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],d=f.length,p=e.call(c,c&&c.__data__,u,r),m=p.length,h=a[u]=new Array(m),g=s[u]=new Array(m),x=l[u]=new Array(d);n(c,f,h,g,x,p,t);for(var b=0,y=0,v,C;b<m;++b)if(v=h[b]){for(b>=y&&(y=b+1);!(C=g[y])&&++y<m;);v._next=C||null}}return s=new pi(s,r),s._enter=a,s._exit=l,s}var gut,but=w(()=>{"use strict";ud();cwe();hut();gut="$"});function yut(){return new pi(this._exit||this._groups.map(zX),this._parents)}var vut=w(()=>{"use strict";uwe();ud()});function wut(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l=t[a],u=n[a],c=l.length,f=s[a]=new Array(c),d,p=0;p<c;++p)(d=l[p]||u[p])&&(f[p]=d);for(;a<r;++a)s[a]=t[a];return new pi(s,this._parents)}var Cut=w(()=>{"use strict";ud()});function _ut(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&o!==s.nextSibling&&o.parentNode.insertBefore(s,o),o=s);return this}var Sut=w(()=>{"use strict"});function Eut(e){e||(e=lyn);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,l=i[o]=new Array(a),u,c=0;c<a;++c)(u=s[c])&&(l[c]=u);l.sort(t)}return new pi(i,this._parents).order()}function lyn(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var Aut=w(()=>{"use strict";ud()});function Tut(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}var kut=w(()=>{"use strict"});function Iut(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}var Dut=w(()=>{"use strict"});function Nut(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}var Fut=w(()=>{"use strict"});function Rut(){var e=0;return this.each(function(){++e}),e}var Out=w(()=>{"use strict"});function Mut(){return!this.node()}var $ut=w(()=>{"use strict"});function Put(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}var Lut=w(()=>{"use strict"});function uyn(e){return function(){this.removeAttribute(e)}}function cyn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function fyn(e,t){return function(){this.setAttribute(e,t)}}function dyn(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function pyn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function myn(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function But(e,t){var n=pF(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?cyn:uyn:typeof t=="function"?n.local?myn:pyn:n.local?dyn:fyn)(n,t))}var zut=w(()=>{"use strict";$X()});function gF(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}var UX=w(()=>{"use strict"});function hyn(e){return function(){this.style.removeProperty(e)}}function gyn(e,t,n){return function(){this.style.setProperty(e,t,n)}}function xyn(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Uut(e,t,n){return arguments.length>1?this.each((t==null?hyn:typeof t=="function"?xyn:gyn)(e,t,n??"")):fwe(this.node(),e)}function fwe(e,t){return e.style.getPropertyValue(t)||gF(e).getComputedStyle(e,null).getPropertyValue(t)}var dwe=w(()=>{"use strict";UX()});function byn(e){return function(){delete this[e]}}function yyn(e,t){return function(){this[e]=t}}function vyn(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function jut(e,t){return arguments.length>1?this.each((t==null?byn:typeof t=="function"?vyn:yyn)(e,t)):this.node()[e]}var Vut=w(()=>{"use strict"});function Wut(e){return e.trim().split(/^|\s+/)}function pwe(e){return e.classList||new Gut(e)}function Gut(e){this._node=e,this._names=Wut(e.getAttribute("class")||"")}function qut(e,t){for(var n=pwe(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Hut(e,t){for(var n=pwe(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function wyn(e){return function(){qut(this,e)}}function Cyn(e){return function(){Hut(this,e)}}function _yn(e,t){return function(){(t.apply(this,arguments)?qut:Hut)(this,e)}}function Yut(e,t){var n=Wut(e+"");if(arguments.length<2){for(var r=pwe(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?_yn:t?wyn:Cyn)(n,t))}var Kut=w(()=>{"use strict";Gut.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}}});function Syn(){this.textContent=""}function Eyn(e){return function(){this.textContent=e}}function Ayn(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Xut(e){return arguments.length?this.each(e==null?Syn:(typeof e=="function"?Ayn:Eyn)(e)):this.node().textContent}var Zut=w(()=>{"use strict"});function Tyn(){this.innerHTML=""}function kyn(e){return function(){this.innerHTML=e}}function Iyn(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Qut(e){return arguments.length?this.each(e==null?Tyn:(typeof e=="function"?Iyn:kyn)(e)):this.node().innerHTML}var Jut=w(()=>{"use strict"});function Dyn(){this.nextSibling&&this.parentNode.appendChild(this)}function ect(){return this.each(Dyn)}var tct=w(()=>{"use strict"});function Nyn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nct(){return this.each(Nyn)}var rct=w(()=>{"use strict"});function ict(e){var t=typeof e=="function"?e:Gw(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}var oct=w(()=>{"use strict";s4()});function Fyn(){return null}function sct(e,t){var n=typeof e=="function"?e:Gw(e),r=t==null?Fyn:typeof t=="function"?t:mF(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}var act=w(()=>{"use strict";s4();PX()});function Ryn(){var e=this.parentNode;e&&e.removeChild(this)}function lct(){return this.each(Ryn)}var uct=w(()=>{"use strict"});function Oyn(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Myn(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function cct(e){return this.select(e?Myn:Oyn)}var fct=w(()=>{"use strict"});function dct(e){return arguments.length?this.property("__data__",e):this.node().__data__}var pct=w(()=>{"use strict"});function $yn(e,t,n){return e=gct(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function gct(e,t,n){return function(r){var i=lm;lm=r;try{e.call(this,this.__data__,t,n)}finally{lm=i}}}function Pyn(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Lyn(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.capture):t[++r]=o;++r?t.length=r:delete this.__on}}}function Byn(e,t,n){var r=hct.hasOwnProperty(e.type)?$yn:gct;return function(i,o,s){var a=this.__on,l,u=r(t,o,s);if(a){for(var c=0,f=a.length;c<f;++c)if((l=a[c]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=u,l.capture=n),l.value=t;return}}this.addEventListener(e.type,u,n),l={type:e.type,name:e.name,value:t,listener:u,capture:n},a?a.push(l):this.__on=[l]}}function xct(e,t,n){var r=Pyn(e+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(i=0,c=a[l];i<o;++i)if((s=r[i]).type===c.type&&s.name===c.name)return c.value}return}for(a=t?Byn:Lyn,n==null&&(n=!1),i=0;i<o;++i)this.each(a(r[i],t,n));return this}function bct(e,t,n,r){var i=lm;e.sourceEvent=lm,lm=e;try{return t.apply(n,r)}finally{lm=i}}var hct,lm,mct,jX=w(()=>{"use strict";hct={},lm=null;typeof document<"u"&&(mct=document.documentElement,"onmouseenter"in mct||(hct={mouseenter:"mouseover",mouseleave:"mouseout"}))});function yct(e,t,n){var r=gF(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function zyn(e,t){return function(){return yct(this,e,t)}}function Uyn(e,t){return function(){return yct(this,e,t.apply(this,arguments))}}function vct(e,t){return this.each((typeof t=="function"?Uyn:zyn)(e,t))}var wct=w(()=>{"use strict";UX()});function pi(e,t){this._groups=e,this._parents=t}function Cct(){return new pi([[document.documentElement]],l4)}var l4,_ct,ud=w(()=>{"use strict";sut();lut();dut();but();cwe();vut();Cut();Sut();Aut();kut();Dut();Fut();Out();$ut();Lut();zut();dwe();Vut();Kut();Zut();Jut();tct();rct();oct();act();uct();fct();pct();jX();wct();l4=[null];pi.prototype=Cct.prototype={constructor:pi,select:out,selectAll:aut,filter:fut,data:xut,enter:put,exit:yut,merge:wut,order:_ut,sort:Eut,call:Tut,nodes:Iut,node:Nut,size:Rut,empty:Mut,each:Put,attr:But,style:Uut,property:jut,classed:Yut,text:Xut,html:Qut,raise:ect,lower:nct,append:ict,insert:sct,remove:lct,clone:cct,datum:dct,on:xct,dispatch:vct};_ct=Cct});function VX(e){return typeof e=="string"?new pi([[document.querySelector(e)]],[document.documentElement]):new pi([[e]],l4)}var mwe=w(()=>{"use strict";ud()});function Sct(e){return VX(Gw(e).call(document.documentElement))}var Ect=w(()=>{"use strict";s4();mwe()});function WX(){return new hwe}function hwe(){this._="@"+(++jyn).toString(36)}var jyn,Act=w(()=>{"use strict";jyn=0;hwe.prototype=WX.prototype={constructor:hwe,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}}});function xF(){for(var e=lm,t;t=e.sourceEvent;)e=t;return e}var GX=w(()=>{"use strict";jX()});function qw(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}var u4=w(()=>{"use strict"});function Tct(e){var t=xF();return t.changedTouches&&(t=t.changedTouches[0]),qw(e,t)}var kct=w(()=>{"use strict";GX();u4()});function Ict(e){return typeof e=="string"?new pi([document.querySelectorAll(e)],[document.documentElement]):new pi([e??[]],l4)}var Dct=w(()=>{"use strict";ud()});function Nct(e,t,n){arguments.length<3&&(n=t,t=xF().changedTouches);for(var r=0,i=t?t.length:0,o;r<i;++r)if((o=t[r]).identifier===n)return qw(e,o);return null}var Fct=w(()=>{"use strict";GX();u4()});function Rct(e,t){t==null&&(t=xF().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=qw(e,t[n]);return i}var Oct=w(()=>{"use strict";GX();u4()});var Mct={};rn(Mct,{clientPoint:()=>qw,create:()=>Sct,creator:()=>Gw,customEvent:()=>bct,event:()=>lm,local:()=>WX,matcher:()=>BX,mouse:()=>Tct,namespace:()=>pF,namespaces:()=>o4,select:()=>VX,selectAll:()=>Ict,selection:()=>_ct,selector:()=>mF,selectorAll:()=>LX,style:()=>fwe,touch:()=>Nct,touches:()=>Rct,window:()=>gF});var $ct=w(()=>{"use strict";Ect();s4();Act();lwe();kct();$X();MX();u4();mwe();Dct();ud();PX();awe();dwe();Fct();Oct();UX();jX()});var c4=Ee(xwe=>{"use strict";Object.defineProperty(xwe,"__esModule",{value:!0});var Vyn=(sE(),zs(cfe)),Pct=($ct(),zs(Mct)),gwe=cF(),Wyn=ld();function Gyn(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');let r=Wyn.getDrawArea(e),i=Object.assign({},qyn,n),o=Pct.select(r).select("table.tf-table"),s=gwe.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(o.size()===0&&(o=Pct.select(r).append("table"),o.attr("class",` ${s} tf-table`),o.append("thead").append("tr"),o.append("tbody")),o.size()!==1)throw new Error("Error inserting table");let a=gwe.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),l=o.select("thead").select("tr").selectAll("th").data(t.headers),u=l.enter().append("th").attr("class",`${a}`);l.merge(u).html(g=>g),l.exit().remove();let c=Vyn.format(",.4~f"),f=o.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),p=gwe.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),m=f.merge(d).selectAll("td").data(g=>g),h=m.enter().append("td").attr("class",`${p}`);m.merge(h).html(g=>typeof g=="number"?c(g):g),m.exit().remove(),f.exit().remove()}xwe.table=Gyn;var qyn={fontSize:14}});var HX=Ee(eA=>{"use strict";var Hyn=eA&&eA.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},Yyn=eA&&eA.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(eA,"__esModule",{value:!0});var Lct=(sE(),zs(cfe)),Kyn=Yyn((V2(),zs(j2))),qX=ty(),Xyn=i4(),Zyn=c4(),Qyn={maxBins:12,fontSize:11};function Jyn(e,t,n={}){return Hyn(this,void 0,void 0,function*(){let r=tvn(t),i=Object.assign({},Qyn,n),o={actions:!1,mode:"vega-lite",defaultStyle:!1},s=qX.subSurface(e,"histogram");if(n.stats!==!1){let u=qX.subSurface(e,"stats",{prepend:!0}),c;n.stats?c=n.stats:c=Xyn.arrayStats(r.map(f=>f.value)),evn(c,u,{fontSize:i.fontSize})}if(r.length===0)return;let a=[];for(let u=0;u<r.length;u++){let c=r[u].value;c!=null&&isFinite(c)&&a.push(r[u])}let l={width:i.width||qX.getDefaultWidth(s),height:i.height||qX.getDefaultHeight(s),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:a},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return Kyn.default(s,l,o)})}eA.histogram=Jyn;function evn(e,t,n){let r=Lct.format(",.4~f"),i=Lct.format(".4~p"),o=[],s=[];if(e.numVals!=null&&(o.push("Num Vals"),s.push(r(e.numVals))),e.min!=null&&(o.push("Min"),s.push(r(e.min))),e.max!=null&&(o.push("Max"),s.push(r(e.max))),e.numZeros!=null){o.push("# Zeros");let a="";e.numVals&&(a=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),s.push(`${r(e.numZeros)} ${a}`)}if(e.numNans!=null){o.push("# NaNs");let a="";e.numVals&&(a=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),s.push(`${r(e.numNans)} ${a}`)}if(e.numInfs!=null){o.push("# Infinity");let a="";e.numVals&&(a=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),s.push(`${r(e.numInfs)} ${a}`)}Zyn.table(t,{headers:o,values:[s]},n)}function tvn(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}});var bwe=Ee(tA=>{"use strict";var nvn=tA&&tA.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},rvn=tA&&tA.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tA,"__esModule",{value:!0});var ivn=rvn((V2(),zs(j2))),Bct=ty(),zct=t4(),ovn=ld();function svn(e,t,n={}){return nvn(this,void 0,void 0,function*(){let r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,o=t.series?t.series:r.map((h,g)=>`Series ${g+1}`);zct.assert(o.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&zct.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");let s=[];for(let h=0;h<i;h++){let g={x:h};o.forEach((x,b)=>{let y=r[b][h].y;g[x]=y,g[`${x}-name`]=x}),s.push(g)}let a=Object.assign({},avn,n),l=()=>{if(a.zoomToFit)return{zero:!1};if(a.yAxisDomain!=null)return{domain:a.yAxisDomain}},u={x:{field:"x",type:a.xType,title:a.xLabel},tooltip:[{field:"x",type:"quantitative"},...o.map(h=>({field:h,type:"quantitative"}))]},c=o.map(h=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:h,type:a.yType,title:a.yLabel,scale:l()},color:{field:`${h}-name`,type:"nominal",legend:{values:o,title:null},scale:{range:a.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},d=ovn.getDrawArea(e),p={width:a.width||Bct.getDefaultWidth(d),height:a.height||Bct.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:s},encoding:u,layer:[...c,f]},m={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield ivn.default(d,p,m),Promise.resolve()})}tA.linechart=svn;var avn={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}});var jct=Ee(nA=>{"use strict";var lvn=nA&&nA.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},uvn=nA&&nA.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nA,"__esModule",{value:!0});var cvn=uvn((V2(),zs(j2))),Uct=ty(),fvn=t4(),dvn=ld();function pvn(e,t,n={}){return lvn(this,void 0,void 0,function*(){let r=t.values,i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];let o=[];r.forEach((d,p)=>{let m=i[p]!=null?i[p]:`Series ${p+1}`,h=d.map(g=>Object.assign({},g,{series:m}));o.push(...h)}),n.seriesColors!=null&&fvn.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");let s=dvn.getDrawArea(e),a=Object.assign({},mvn,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},u=()=>{if(a.zoomToFit)return{zero:!1};if(a.xAxisDomain!=null)return{domain:a.xAxisDomain}},c=()=>{if(a.zoomToFit)return{zero:!1};if(a.yAxisDomain!=null)return{domain:a.yAxisDomain}},f={width:a.width||Uct.getDefaultWidth(s),height:a.height||Uct.getDefaultHeight(s),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:o},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:a.xType,title:a.xLabel,scale:u()},y:{field:"y",type:a.yType,title:a.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:a.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield cvn.default(s,f,l),Promise.resolve()})}nA.scatterplot=pvn;var mvn={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}});var Yct=Ee(bF=>{"use strict";var Gct=bF&&bF.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(bF,"__esModule",{value:!0});var hvn=bwe(),ywe=ld(),qct=ty();function Hct(e,t,n,r={}){return Gct(this,void 0,void 0,function*(){let i=ywe.getDrawArea(e),o={};for(let u of n)if(/val_/.test(u)){let c=u.replace("val_","");Vct(o,c);let f=Wct(t,u,n.indexOf(u));o[c].series.push(u),o[c].values.push(f)}else{let c=Wct(t,u,n.indexOf(u));Vct(o,u),o[u].series.push(u),o[u].values.push(c)}let s=Object.keys(o),a=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),l=[];for(let u of s){let c=qct.subSurface(i,u),f=o[u].series,d=o[u].values;f.every(m=>!!m.match("acc"))&&(a.zoomToFitAccuracy?a.zoomToFit=!0:(a.yAxisDomain=[0,1],delete a.zoomToFit));let p=hvn.linechart(c,{values:d,series:f},a);l.push(p)}yield Promise.all(l)})}bF.history=Hct;function Vct(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function Wct(e,t,n){if(Array.isArray(e)){let r=Array.isArray(e[0])?e[n]:e,i=[];for(let o=0;o<r.length;o++){let s=r[o];i.push({x:o,y:s[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function gvn(e,t,n={}){let r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],o=ywe.getDrawArea(e),s=Object.assign({},n);delete s.callbacks;function a(u){return(c,f)=>Gct(this,void 0,void 0,function*(){/batch/i.test(u)?s.xLabel="Batch":/epoch/i.test(u)&&(s.xLabel="Epoch");let d=[],p=[];for(let h of t)if(f[h]!=null){p.push(h);let g=xvn(r,u,h);g.push({[h]:f[h]}),d.push(g)}let m=qct.subSurface(o,u,{title:u});Hct(m,d,p,s),yield ywe.nextFrame()})}let l={};return i.forEach(u=>{l[u]=a(u)}),l}bF.fitCallbacks=gvn;function xvn(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}});var Zct=Ee(yF=>{"use strict";var YX=yF&&yF.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(yF,"__esModule",{value:!0});var bvn=HX(),Kct=ld(),Xct=c4(),vwe=ty(),yvn=i4();function vvn(e,t){return YX(this,void 0,void 0,function*(){let n=Kct.getDrawArea(e),r=Cvn(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],o=r.layers.map(s=>[s.name,s.outputShape,s.parameters,s.trainable]);Xct.table(n,{headers:i,values:o})})}yF.modelSummary=vvn;function wvn(e,t){return YX(this,void 0,void 0,function*(){let n=Kct.getDrawArea(e),r=yield Svn(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],o=vwe.subSurface(n,"layer-weights-info"),s=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);Xct.table(o,{headers:i,values:s});let a=vwe.subSurface(n,"select-layer"),l=vwe.subSurface(n,"param-distribution"),u=c=>YX(this,void 0,void 0,function*(){let d=yield r.filter(p=>p.name===c)[0].weight.data();bvn.histogram(l,d,{height:150,width:460,stats:!1})});Evn(r.map(c=>c.name),a,u)})}yF.layer=wvn;function Cvn(e){return{layers:e.layers.map(_vn)}}function _vn(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>wwe(r)).join(", ")}]`:t=wwe(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function Svn(e){return YX(this,void 0,void 0,function*(){let t=e.getWeights(),n=e.weights,r=t.map(yvn.tensorStats),i=yield Promise.all(r),o=t.map(s=>s.shape);return t.map((s,a)=>({name:n[a].name,stats:i[a],shape:wwe(o[a]),weight:s}))})}function wwe(e){let t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function Evn(e,t,n){let o=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(l=>`<option value=${l}>${l}</option>`)}
    </select>
  `}</div>`;t.innerHTML=o;let s=t.querySelector("button"),a=t.querySelector("select");s.addEventListener("click",()=>{n(a.selectedOptions[0].label)})}});var Qct=Ee(f4=>{"use strict";var Avn=f4&&f4.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(f4,"__esModule",{value:!0});var Tvn=ld(),kvn=c4();function Ivn(e,t,n){return Avn(this,void 0,void 0,function*(){let r=Tvn.getDrawArea(e),i=["Class","Accuracy","# Samples"],o=[];for(let s=0;s<t.length;s++){let a=n?n[s]:s.toString(),l=t[s];o.push([a,l.accuracy,l.count])}return kvn.table(r,{headers:i,values:o})})}f4.perClassAccuracy=Ivn});var Jct=Ee(d4=>{"use strict";var Dvn=d4&&d4.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{l(r.next(u))}catch(c){o(c)}}function a(u){try{l(r.throw(u))}catch(c){o(c)}}function l(u){u.done?i(u.value):new n(function(c){c(u.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(d4,"__esModule",{value:!0});var Nvn=HX(),Fvn=ld(),Rvn=i4();function Ovn(e,t){return Dvn(this,void 0,void 0,function*(){let n=Fvn.getDrawArea(e),r=yield Rvn.tensorStats(t),i=yield t.data();Nvn.histogram(n,i,{height:150,stats:r})})}d4.valuesDistribution=Ovn});var eft=Ee(Cwe=>{"use strict";Object.defineProperty(Cwe,"__esModule",{value:!0});var Mvn="1.5.1";Cwe.version=Mvn});var rft=Ee(iy=>{"use strict";function $vn(e){for(var t in e)iy.hasOwnProperty(t)||(iy[t]=e[t])}Object.defineProperty(iy,"__esModule",{value:!0});N();lie();var Pvn=Xlt(),Lvn=Qlt(),Bvn=iut(),zvn=HX(),Uvn=bwe(),jvn=jct(),Vvn=c4(),tft=Yct(),nft=Zct(),Wvn=Qct(),Gvn=Jct(),_we=i4(),qvn=eft();iy.version_vis=qvn.version;var Hvn={barchart:Pvn.barchart,table:Vvn.table,histogram:zvn.histogram,linechart:Uvn.linechart,scatterplot:jvn.scatterplot,confusionMatrix:Lvn.confusionMatrix,heatmap:Bvn.heatmap};iy.render=Hvn;var Yvn={accuracy:_we.accuracy,perClassAccuracy:_we.perClassAccuracy,confusionMatrix:_we.confusionMatrix};iy.metrics=Yvn;var Kvn={history:tft.history,fitCallbacks:tft.fitCallbacks,perClassAccuracy:Wvn.perClassAccuracy,valuesDistribution:Gvn.valuesDistribution,layer:nft.layer,modelSummary:nft.modelSummary};iy.show=Kvn;var Xvn=owe();iy.visor=Xvn.visor;$vn(G1e())});var wwt=Ee((Z4,MSe)=>{"use strict";(function(t,n){typeof Z4=="object"&&typeof MSe=="object"?MSe.exports=n():typeof define=="function"&&define.amd?define("Matter",[],n):typeof Z4=="object"?Z4.Matter=n():t.Matter=n()})(Z4,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(r,i,o){n.o(r,i)||Object.defineProperty(r,i,{enumerable:!0,get:o})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,i){if(i&1&&(r=n(r)),i&8||i&4&&typeof r=="object"&&r&&r.__esModule)return r;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),i&2&&typeof r!="string")for(var s in r)n.d(o,s,(function(a){return r[a]}).bind(null,s));return o},n.n=function(r){var i=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(i,"a",i),i},n.o=function(r,i){return Object.prototype.hasOwnProperty.call(r,i)},n.p="",n(n.s=20)}([function(e,t){var n={};e.exports=n,function(){n._baseDelta=1e3/60,n._nextId=0,n._seed=0,n._nowStartTime=+new Date,n._warnedOnce={},n._decomp=null,n.extend=function(i,o){var s,a,l;typeof o=="boolean"?(s=2,l=o):(s=1,l=!0);for(var u=s;u<arguments.length;u++){var c=arguments[u];if(c)for(var f in c)l&&c[f]&&c[f].constructor===Object&&(!i[f]||i[f].constructor===Object)?(i[f]=i[f]||{},n.extend(i[f],l,c[f])):i[f]=c[f]}return i},n.clone=function(i,o){return n.extend({},o,i)},n.keys=function(i){if(Object.keys)return Object.keys(i);var o=[];for(var s in i)o.push(s);return o},n.values=function(i){var o=[];if(Object.keys){for(var s=Object.keys(i),a=0;a<s.length;a++)o.push(i[s[a]]);return o}for(var l in i)o.push(i[l]);return o},n.get=function(i,o,s,a){o=o.split(".").slice(s,a);for(var l=0;l<o.length;l+=1)i=i[o[l]];return i},n.set=function(i,o,s,a,l){var u=o.split(".").slice(a,l);return n.get(i,o,0,-1)[u[u.length-1]]=s,s},n.shuffle=function(i){for(var o=i.length-1;o>0;o--){var s=Math.floor(n.random()*(o+1)),a=i[o];i[o]=i[s],i[s]=a}return i},n.choose=function(i){return i[Math.floor(n.random()*i.length)]},n.isElement=function(i){return typeof HTMLElement<"u"?i instanceof HTMLElement:!!(i&&i.nodeType&&i.nodeName)},n.isArray=function(i){return Object.prototype.toString.call(i)==="[object Array]"},n.isFunction=function(i){return typeof i=="function"},n.isPlainObject=function(i){return typeof i=="object"&&i.constructor===Object},n.isString=function(i){return toString.call(i)==="[object String]"},n.clamp=function(i,o,s){return i<o?o:i>s?s:i},n.sign=function(i){return i<0?-1:1},n.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-n._nowStartTime},n.random=function(i,o){return i=typeof i<"u"?i:0,o=typeof o<"u"?o:1,i+r()*(o-i)};var r=function(){return n._seed=(n._seed*9301+49297)%233280,n._seed/233280};n.colorToNumber=function(i){return i=i.replace("#",""),i.length==3&&(i=i.charAt(0)+i.charAt(0)+i.charAt(1)+i.charAt(1)+i.charAt(2)+i.charAt(2)),parseInt(i,16)},n.logLevel=1,n.log=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.info=function(){console&&n.logLevel>0&&n.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warn=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warnOnce=function(){var i=Array.prototype.slice.call(arguments).join(" ");n._warnedOnce[i]||(n.warn(i),n._warnedOnce[i]=!0)},n.deprecated=function(i,o,s){i[o]=n.chain(function(){n.warnOnce("\u{1F505} deprecated \u{1F505}",s)},i[o])},n.nextId=function(){return n._nextId++},n.indexOf=function(i,o){if(i.indexOf)return i.indexOf(o);for(var s=0;s<i.length;s++)if(i[s]===o)return s;return-1},n.map=function(i,o){if(i.map)return i.map(o);for(var s=[],a=0;a<i.length;a+=1)s.push(o(i[a]));return s},n.topologicalSort=function(i){var o=[],s=[],a=[];for(var l in i)!s[l]&&!a[l]&&n._topologicalSort(l,s,a,i,o);return o},n._topologicalSort=function(i,o,s,a,l){var u=a[i]||[];s[i]=!0;for(var c=0;c<u.length;c+=1){var f=u[c];s[f]||o[f]||n._topologicalSort(f,o,s,a,l)}s[i]=!1,o[i]=!0,l.push(i)},n.chain=function(){for(var i=[],o=0;o<arguments.length;o+=1){var s=arguments[o];s._chained?i.push.apply(i,s._chained):i.push(s)}var a=function(){for(var l,u=new Array(arguments.length),c=0,f=arguments.length;c<f;c++)u[c]=arguments[c];for(c=0;c<i.length;c+=1){var d=i[c].apply(l,u);typeof d<"u"&&(l=d)}return l};return a._chained=i,a},n.chainPathBefore=function(i,o,s){return n.set(i,o,n.chain(s,n.get(i,o)))},n.chainPathAfter=function(i,o,s){return n.set(i,o,n.chain(n.get(i,o),s))},n.setDecomp=function(i){n._decomp=i},n.getDecomp=function(){var i=n._decomp;try{!i&&typeof window<"u"&&(i=window.decomp),!i&&typeof global<"u"&&(i=global.decomp)}catch{i=null}return i}}()},function(e,t){var n={};e.exports=n,function(){n.create=function(r){var i={min:{x:0,y:0},max:{x:0,y:0}};return r&&n.update(i,r),i},n.update=function(r,i,o){r.min.x=1/0,r.max.x=-1/0,r.min.y=1/0,r.max.y=-1/0;for(var s=0;s<i.length;s++){var a=i[s];a.x>r.max.x&&(r.max.x=a.x),a.x<r.min.x&&(r.min.x=a.x),a.y>r.max.y&&(r.max.y=a.y),a.y<r.min.y&&(r.min.y=a.y)}o&&(o.x>0?r.max.x+=o.x:r.min.x+=o.x,o.y>0?r.max.y+=o.y:r.min.y+=o.y)},n.contains=function(r,i){return i.x>=r.min.x&&i.x<=r.max.x&&i.y>=r.min.y&&i.y<=r.max.y},n.overlaps=function(r,i){return r.min.x<=i.max.x&&r.max.x>=i.min.x&&r.max.y>=i.min.y&&r.min.y<=i.max.y},n.translate=function(r,i){r.min.x+=i.x,r.max.x+=i.x,r.min.y+=i.y,r.max.y+=i.y},n.shift=function(r,i){var o=r.max.x-r.min.x,s=r.max.y-r.min.y;r.min.x=i.x,r.max.x=i.x+o,r.min.y=i.y,r.max.y=i.y+s}}()},function(e,t){var n={};e.exports=n,function(){n.create=function(r,i){return{x:r||0,y:i||0}},n.clone=function(r){return{x:r.x,y:r.y}},n.magnitude=function(r){return Math.sqrt(r.x*r.x+r.y*r.y)},n.magnitudeSquared=function(r){return r.x*r.x+r.y*r.y},n.rotate=function(r,i,o){var s=Math.cos(i),a=Math.sin(i);o||(o={});var l=r.x*s-r.y*a;return o.y=r.x*a+r.y*s,o.x=l,o},n.rotateAbout=function(r,i,o,s){var a=Math.cos(i),l=Math.sin(i);s||(s={});var u=o.x+((r.x-o.x)*a-(r.y-o.y)*l);return s.y=o.y+((r.x-o.x)*l+(r.y-o.y)*a),s.x=u,s},n.normalise=function(r){var i=n.magnitude(r);return i===0?{x:0,y:0}:{x:r.x/i,y:r.y/i}},n.dot=function(r,i){return r.x*i.x+r.y*i.y},n.cross=function(r,i){return r.x*i.y-r.y*i.x},n.cross3=function(r,i,o){return(i.x-r.x)*(o.y-r.y)-(i.y-r.y)*(o.x-r.x)},n.add=function(r,i,o){return o||(o={}),o.x=r.x+i.x,o.y=r.y+i.y,o},n.sub=function(r,i,o){return o||(o={}),o.x=r.x-i.x,o.y=r.y-i.y,o},n.mult=function(r,i){return{x:r.x*i,y:r.y*i}},n.div=function(r,i){return{x:r.x/i,y:r.y/i}},n.perp=function(r,i){return i=i===!0?-1:1,{x:i*-r.y,y:i*r.x}},n.neg=function(r){return{x:-r.x,y:-r.y}},n.angle=function(r,i){return Math.atan2(i.y-r.y,i.x-r.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]}()},function(e,t,n){var r={};e.exports=r;var i=n(2),o=n(0);(function(){r.create=function(s,a){for(var l=[],u=0;u<s.length;u++){var c=s[u],f={x:c.x,y:c.y,index:u,body:a,isInternal:!1};l.push(f)}return l},r.fromPath=function(s,a){var l=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,u=[];return s.replace(l,function(c,f,d){u.push({x:parseFloat(f),y:parseFloat(d)})}),r.create(u,a)},r.centre=function(s){for(var a=r.area(s,!0),l={x:0,y:0},u,c,f,d=0;d<s.length;d++)f=(d+1)%s.length,u=i.cross(s[d],s[f]),c=i.mult(i.add(s[d],s[f]),u),l=i.add(l,c);return i.div(l,6*a)},r.mean=function(s){for(var a={x:0,y:0},l=0;l<s.length;l++)a.x+=s[l].x,a.y+=s[l].y;return i.div(a,s.length)},r.area=function(s,a){for(var l=0,u=s.length-1,c=0;c<s.length;c++)l+=(s[u].x-s[c].x)*(s[u].y+s[c].y),u=c;return a?l/2:Math.abs(l)/2},r.inertia=function(s,a){for(var l=0,u=0,c=s,f,d,p=0;p<c.length;p++)d=(p+1)%c.length,f=Math.abs(i.cross(c[d],c[p])),l+=f*(i.dot(c[d],c[d])+i.dot(c[d],c[p])+i.dot(c[p],c[p])),u+=f;return a/6*(l/u)},r.translate=function(s,a,l){l=typeof l<"u"?l:1;var u=s.length,c=a.x*l,f=a.y*l,d;for(d=0;d<u;d++)s[d].x+=c,s[d].y+=f;return s},r.rotate=function(s,a,l){if(a!==0){var u=Math.cos(a),c=Math.sin(a),f=l.x,d=l.y,p=s.length,m,h,g,x;for(x=0;x<p;x++)m=s[x],h=m.x-f,g=m.y-d,m.x=f+(h*u-g*c),m.y=d+(h*c+g*u);return s}},r.contains=function(s,a){for(var l=a.x,u=a.y,c=s.length,f=s[c-1],d,p=0;p<c;p++){if(d=s[p],(l-f.x)*(d.y-f.y)+(u-f.y)*(f.x-d.x)>0)return!1;f=d}return!0},r.scale=function(s,a,l,u){if(a===1&&l===1)return s;u=u||r.centre(s);for(var c,f,d=0;d<s.length;d++)c=s[d],f=i.sub(c,u),s[d].x=u.x+f.x*a,s[d].y=u.y+f.y*l;return s},r.chamfer=function(s,a,l,u,c){typeof a=="number"?a=[a]:a=a||[8],l=typeof l<"u"?l:-1,u=u||2,c=c||14;for(var f=[],d=0;d<s.length;d++){var p=s[d-1>=0?d-1:s.length-1],m=s[d],h=s[(d+1)%s.length],g=a[d<a.length?d:a.length-1];if(g===0){f.push(m);continue}var x=i.normalise({x:m.y-p.y,y:p.x-m.x}),b=i.normalise({x:h.y-m.y,y:m.x-h.x}),y=Math.sqrt(2*Math.pow(g,2)),v=i.mult(o.clone(x),g),C=i.normalise(i.mult(i.add(x,b),.5)),_=i.sub(m,i.mult(C,y)),S=l;l===-1&&(S=Math.pow(g,.32)*1.75),S=o.clamp(S,u,c),S%2===1&&(S+=1);for(var E=Math.acos(i.dot(x,b)),T=E/S,I=0;I<S;I++)f.push(i.add(i.rotate(v,T*I),_))}return f},r.clockwiseSort=function(s){var a=r.mean(s);return s.sort(function(l,u){return i.angle(a,l)-i.angle(a,u)}),s},r.isConvex=function(s){var a=0,l=s.length,u,c,f,d;if(l<3)return null;for(u=0;u<l;u++)if(c=(u+1)%l,f=(u+2)%l,d=(s[c].x-s[u].x)*(s[f].y-s[c].y),d-=(s[c].y-s[u].y)*(s[f].x-s[c].x),d<0?a|=1:d>0&&(a|=2),a===3)return!1;return a!==0?!0:null},r.hull=function(s){var a=[],l=[],u,c;for(s=s.slice(0),s.sort(function(f,d){var p=f.x-d.x;return p!==0?p:f.y-d.y}),c=0;c<s.length;c+=1){for(u=s[c];l.length>=2&&i.cross3(l[l.length-2],l[l.length-1],u)<=0;)l.pop();l.push(u)}for(c=s.length-1;c>=0;c-=1){for(u=s[c];a.length>=2&&i.cross3(a[a.length-2],a[a.length-1],u)<=0;)a.pop();a.push(u)}return a.pop(),l.pop(),a.concat(l)}})()},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(2),s=n(7),a=n(0),l=n(1),u=n(11);(function(){r._timeCorrection=!0,r._inertiaScale=4,r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,r._baseDelta=1e3/60,r.create=function(f){var d={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:i.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},p=a.extend(d,f);return c(p,f),p},r.nextGroup=function(f){return f?r._nextNonCollidingGroupId--:r._nextCollidingGroupId++},r.nextCategory=function(){return r._nextCategory=r._nextCategory<<1,r._nextCategory};var c=function(f,d){d=d||{},r.set(f,{bounds:f.bounds||l.create(f.vertices),positionPrev:f.positionPrev||o.clone(f.position),anglePrev:f.anglePrev||f.angle,vertices:f.vertices,parts:f.parts||[f],isStatic:f.isStatic,isSleeping:f.isSleeping,parent:f.parent||f}),i.rotate(f.vertices,f.angle,f.position),u.rotate(f.axes,f.angle),l.update(f.bounds,f.vertices,f.velocity),r.set(f,{axes:d.axes||f.axes,area:d.area||f.area,mass:d.mass||f.mass,inertia:d.inertia||f.inertia});var p=f.isStatic?"#14151f":a.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),m=f.isStatic?"#555":"#ccc",h=f.isStatic&&f.render.fillStyle===null?1:0;f.render.fillStyle=f.render.fillStyle||p,f.render.strokeStyle=f.render.strokeStyle||m,f.render.lineWidth=f.render.lineWidth||h,f.render.sprite.xOffset+=-(f.bounds.min.x-f.position.x)/(f.bounds.max.x-f.bounds.min.x),f.render.sprite.yOffset+=-(f.bounds.min.y-f.position.y)/(f.bounds.max.y-f.bounds.min.y)};r.set=function(f,d,p){var m;typeof d=="string"&&(m=d,d={},d[m]=p);for(m in d)if(Object.prototype.hasOwnProperty.call(d,m))switch(p=d[m],m){case"isStatic":r.setStatic(f,p);break;case"isSleeping":s.set(f,p);break;case"mass":r.setMass(f,p);break;case"density":r.setDensity(f,p);break;case"inertia":r.setInertia(f,p);break;case"vertices":r.setVertices(f,p);break;case"position":r.setPosition(f,p);break;case"angle":r.setAngle(f,p);break;case"velocity":r.setVelocity(f,p);break;case"angularVelocity":r.setAngularVelocity(f,p);break;case"speed":r.setSpeed(f,p);break;case"angularSpeed":r.setAngularSpeed(f,p);break;case"parts":r.setParts(f,p);break;case"centre":r.setCentre(f,p);break;default:f[m]=p}},r.setStatic=function(f,d){for(var p=0;p<f.parts.length;p++){var m=f.parts[p];m.isStatic=d,d?(m._original={restitution:m.restitution,friction:m.friction,mass:m.mass,inertia:m.inertia,density:m.density,inverseMass:m.inverseMass,inverseInertia:m.inverseInertia},m.restitution=0,m.friction=1,m.mass=m.inertia=m.density=1/0,m.inverseMass=m.inverseInertia=0,m.positionPrev.x=m.position.x,m.positionPrev.y=m.position.y,m.anglePrev=m.angle,m.angularVelocity=0,m.speed=0,m.angularSpeed=0,m.motion=0):m._original&&(m.restitution=m._original.restitution,m.friction=m._original.friction,m.mass=m._original.mass,m.inertia=m._original.inertia,m.density=m._original.density,m.inverseMass=m._original.inverseMass,m.inverseInertia=m._original.inverseInertia,m._original=null)}},r.setMass=function(f,d){var p=f.inertia/(f.mass/6);f.inertia=p*(d/6),f.inverseInertia=1/f.inertia,f.mass=d,f.inverseMass=1/f.mass,f.density=f.mass/f.area},r.setDensity=function(f,d){r.setMass(f,d*f.area),f.density=d},r.setInertia=function(f,d){f.inertia=d,f.inverseInertia=1/f.inertia},r.setVertices=function(f,d){d[0].body===f?f.vertices=d:f.vertices=i.create(d,f),f.axes=u.fromVertices(f.vertices),f.area=i.area(f.vertices),r.setMass(f,f.density*f.area);var p=i.centre(f.vertices);i.translate(f.vertices,p,-1),r.setInertia(f,r._inertiaScale*i.inertia(f.vertices,f.mass)),i.translate(f.vertices,f.position),l.update(f.bounds,f.vertices,f.velocity)},r.setParts=function(f,d,p){var m;for(d=d.slice(0),f.parts.length=0,f.parts.push(f),f.parent=f,m=0;m<d.length;m++){var h=d[m];h!==f&&(h.parent=f,f.parts.push(h))}if(f.parts.length!==1){if(p=typeof p<"u"?p:!0,p){var g=[];for(m=0;m<d.length;m++)g=g.concat(d[m].vertices);i.clockwiseSort(g);var x=i.hull(g),b=i.centre(x);r.setVertices(f,x),i.translate(f.vertices,b)}var y=r._totalProperties(f);f.area=y.area,f.parent=f,f.position.x=y.centre.x,f.position.y=y.centre.y,f.positionPrev.x=y.centre.x,f.positionPrev.y=y.centre.y,r.setMass(f,y.mass),r.setInertia(f,y.inertia),r.setPosition(f,y.centre)}},r.setCentre=function(f,d,p){p?(f.positionPrev.x+=d.x,f.positionPrev.y+=d.y,f.position.x+=d.x,f.position.y+=d.y):(f.positionPrev.x=d.x-(f.position.x-f.positionPrev.x),f.positionPrev.y=d.y-(f.position.y-f.positionPrev.y),f.position.x=d.x,f.position.y=d.y)},r.setPosition=function(f,d,p){var m=o.sub(d,f.position);p?(f.positionPrev.x=f.position.x,f.positionPrev.y=f.position.y,f.velocity.x=m.x,f.velocity.y=m.y,f.speed=o.magnitude(m)):(f.positionPrev.x+=m.x,f.positionPrev.y+=m.y);for(var h=0;h<f.parts.length;h++){var g=f.parts[h];g.position.x+=m.x,g.position.y+=m.y,i.translate(g.vertices,m),l.update(g.bounds,g.vertices,f.velocity)}},r.setAngle=function(f,d,p){var m=d-f.angle;p?(f.anglePrev=f.angle,f.angularVelocity=m,f.angularSpeed=Math.abs(m)):f.anglePrev+=m;for(var h=0;h<f.parts.length;h++){var g=f.parts[h];g.angle+=m,i.rotate(g.vertices,m,f.position),u.rotate(g.axes,m),l.update(g.bounds,g.vertices,f.velocity),h>0&&o.rotateAbout(g.position,m,f.position,g.position)}},r.setVelocity=function(f,d){var p=f.deltaTime/r._baseDelta;f.positionPrev.x=f.position.x-d.x*p,f.positionPrev.y=f.position.y-d.y*p,f.velocity.x=(f.position.x-f.positionPrev.x)/p,f.velocity.y=(f.position.y-f.positionPrev.y)/p,f.speed=o.magnitude(f.velocity)},r.getVelocity=function(f){var d=r._baseDelta/f.deltaTime;return{x:(f.position.x-f.positionPrev.x)*d,y:(f.position.y-f.positionPrev.y)*d}},r.getSpeed=function(f){return o.magnitude(r.getVelocity(f))},r.setSpeed=function(f,d){r.setVelocity(f,o.mult(o.normalise(r.getVelocity(f)),d))},r.setAngularVelocity=function(f,d){var p=f.deltaTime/r._baseDelta;f.anglePrev=f.angle-d*p,f.angularVelocity=(f.angle-f.anglePrev)/p,f.angularSpeed=Math.abs(f.angularVelocity)},r.getAngularVelocity=function(f){return(f.angle-f.anglePrev)*r._baseDelta/f.deltaTime},r.getAngularSpeed=function(f){return Math.abs(r.getAngularVelocity(f))},r.setAngularSpeed=function(f,d){r.setAngularVelocity(f,a.sign(r.getAngularVelocity(f))*d)},r.translate=function(f,d,p){r.setPosition(f,o.add(f.position,d),p)},r.rotate=function(f,d,p,m){if(!p)r.setAngle(f,f.angle+d,m);else{var h=Math.cos(d),g=Math.sin(d),x=f.position.x-p.x,b=f.position.y-p.y;r.setPosition(f,{x:p.x+(x*h-b*g),y:p.y+(x*g+b*h)},m),r.setAngle(f,f.angle+d,m)}},r.scale=function(f,d,p,m){var h=0,g=0;m=m||f.position;for(var x=0;x<f.parts.length;x++){var b=f.parts[x];i.scale(b.vertices,d,p,m),b.axes=u.fromVertices(b.vertices),b.area=i.area(b.vertices),r.setMass(b,f.density*b.area),i.translate(b.vertices,{x:-b.position.x,y:-b.position.y}),r.setInertia(b,r._inertiaScale*i.inertia(b.vertices,b.mass)),i.translate(b.vertices,{x:b.position.x,y:b.position.y}),x>0&&(h+=b.area,g+=b.inertia),b.position.x=m.x+(b.position.x-m.x)*d,b.position.y=m.y+(b.position.y-m.y)*p,l.update(b.bounds,b.vertices,f.velocity)}f.parts.length>1&&(f.area=h,f.isStatic||(r.setMass(f,f.density*h),r.setInertia(f,g))),f.circleRadius&&(d===p?f.circleRadius*=d:f.circleRadius=null)},r.update=function(f,d){d=(typeof d<"u"?d:1e3/60)*f.timeScale;var p=d*d,m=r._timeCorrection?d/(f.deltaTime||d):1,h=1-f.frictionAir*(d/a._baseDelta),g=(f.position.x-f.positionPrev.x)*m,x=(f.position.y-f.positionPrev.y)*m;f.velocity.x=g*h+f.force.x/f.mass*p,f.velocity.y=x*h+f.force.y/f.mass*p,f.positionPrev.x=f.position.x,f.positionPrev.y=f.position.y,f.position.x+=f.velocity.x,f.position.y+=f.velocity.y,f.deltaTime=d,f.angularVelocity=(f.angle-f.anglePrev)*h*m+f.torque/f.inertia*p,f.anglePrev=f.angle,f.angle+=f.angularVelocity;for(var b=0;b<f.parts.length;b++){var y=f.parts[b];i.translate(y.vertices,f.velocity),b>0&&(y.position.x+=f.velocity.x,y.position.y+=f.velocity.y),f.angularVelocity!==0&&(i.rotate(y.vertices,f.angularVelocity,f.position),u.rotate(y.axes,f.angularVelocity),b>0&&o.rotateAbout(y.position,f.angularVelocity,f.position,y.position)),l.update(y.bounds,y.vertices,f.velocity)}},r.updateVelocities=function(f){var d=r._baseDelta/f.deltaTime,p=f.velocity;p.x=(f.position.x-f.positionPrev.x)*d,p.y=(f.position.y-f.positionPrev.y)*d,f.speed=Math.sqrt(p.x*p.x+p.y*p.y),f.angularVelocity=(f.angle-f.anglePrev)*d,f.angularSpeed=Math.abs(f.angularVelocity)},r.applyForce=function(f,d,p){var m={x:d.x-f.position.x,y:d.y-f.position.y};f.force.x+=p.x,f.force.y+=p.y,f.torque+=m.x*p.y-m.y*p.x},r._totalProperties=function(f){for(var d={mass:0,area:0,inertia:0,centre:{x:0,y:0}},p=f.parts.length===1?0:1;p<f.parts.length;p++){var m=f.parts[p],h=m.mass!==1/0?m.mass:1;d.mass+=h,d.area+=m.area,d.inertia+=m.inertia,d.centre=o.add(d.centre,o.mult(m.position,h))}return d.centre=o.div(d.centre,d.mass),d}})()},function(e,t,n){var r={};e.exports=r;var i=n(0);(function(){r.on=function(o,s,a){for(var l=s.split(" "),u,c=0;c<l.length;c++)u=l[c],o.events=o.events||{},o.events[u]=o.events[u]||[],o.events[u].push(a);return a},r.off=function(o,s,a){if(!s){o.events={};return}typeof s=="function"&&(a=s,s=i.keys(o.events).join(" "));for(var l=s.split(" "),u=0;u<l.length;u++){var c=o.events[l[u]],f=[];if(a&&c)for(var d=0;d<c.length;d++)c[d]!==a&&f.push(c[d]);o.events[l[u]]=f}},r.trigger=function(o,s,a){var l,u,c,f,d=o.events;if(d&&i.keys(d).length>0){a||(a={}),l=s.split(" ");for(var p=0;p<l.length;p++)if(u=l[p],c=d[u],c){f=i.clone(a,!1),f.name=u,f.source=o;for(var m=0;m<c.length;m++)c[m].apply(o,[f])}}}})()},function(e,t,n){var r={};e.exports=r;var i=n(5),o=n(0),s=n(1),a=n(4);(function(){r.create=function(l){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},l)},r.setModified=function(l,u,c,f){if(l.isModified=u,u&&l.cache&&(l.cache.allBodies=null,l.cache.allConstraints=null,l.cache.allComposites=null),c&&l.parent&&r.setModified(l.parent,u,c,f),f)for(var d=0;d<l.composites.length;d++){var p=l.composites[d];r.setModified(p,u,c,f)}},r.add=function(l,u){var c=[].concat(u);i.trigger(l,"beforeAdd",{object:u});for(var f=0;f<c.length;f++){var d=c[f];switch(d.type){case"body":if(d.parent!==d){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}r.addBody(l,d);break;case"constraint":r.addConstraint(l,d);break;case"composite":r.addComposite(l,d);break;case"mouseConstraint":r.addConstraint(l,d.constraint);break}}return i.trigger(l,"afterAdd",{object:u}),l},r.remove=function(l,u,c){var f=[].concat(u);i.trigger(l,"beforeRemove",{object:u});for(var d=0;d<f.length;d++){var p=f[d];switch(p.type){case"body":r.removeBody(l,p,c);break;case"constraint":r.removeConstraint(l,p,c);break;case"composite":r.removeComposite(l,p,c);break;case"mouseConstraint":r.removeConstraint(l,p.constraint);break}}return i.trigger(l,"afterRemove",{object:u}),l},r.addComposite=function(l,u){return l.composites.push(u),u.parent=l,r.setModified(l,!0,!0,!1),l},r.removeComposite=function(l,u,c){var f=o.indexOf(l.composites,u);if(f!==-1&&r.removeCompositeAt(l,f),c)for(var d=0;d<l.composites.length;d++)r.removeComposite(l.composites[d],u,!0);return l},r.removeCompositeAt=function(l,u){return l.composites.splice(u,1),r.setModified(l,!0,!0,!1),l},r.addBody=function(l,u){return l.bodies.push(u),r.setModified(l,!0,!0,!1),l},r.removeBody=function(l,u,c){var f=o.indexOf(l.bodies,u);if(f!==-1&&r.removeBodyAt(l,f),c)for(var d=0;d<l.composites.length;d++)r.removeBody(l.composites[d],u,!0);return l},r.removeBodyAt=function(l,u){return l.bodies.splice(u,1),r.setModified(l,!0,!0,!1),l},r.addConstraint=function(l,u){return l.constraints.push(u),r.setModified(l,!0,!0,!1),l},r.removeConstraint=function(l,u,c){var f=o.indexOf(l.constraints,u);if(f!==-1&&r.removeConstraintAt(l,f),c)for(var d=0;d<l.composites.length;d++)r.removeConstraint(l.composites[d],u,!0);return l},r.removeConstraintAt=function(l,u){return l.constraints.splice(u,1),r.setModified(l,!0,!0,!1),l},r.clear=function(l,u,c){if(c)for(var f=0;f<l.composites.length;f++)r.clear(l.composites[f],u,!0);return u?l.bodies=l.bodies.filter(function(d){return d.isStatic}):l.bodies.length=0,l.constraints.length=0,l.composites.length=0,r.setModified(l,!0,!0,!1),l},r.allBodies=function(l){if(l.cache&&l.cache.allBodies)return l.cache.allBodies;for(var u=[].concat(l.bodies),c=0;c<l.composites.length;c++)u=u.concat(r.allBodies(l.composites[c]));return l.cache&&(l.cache.allBodies=u),u},r.allConstraints=function(l){if(l.cache&&l.cache.allConstraints)return l.cache.allConstraints;for(var u=[].concat(l.constraints),c=0;c<l.composites.length;c++)u=u.concat(r.allConstraints(l.composites[c]));return l.cache&&(l.cache.allConstraints=u),u},r.allComposites=function(l){if(l.cache&&l.cache.allComposites)return l.cache.allComposites;for(var u=[].concat(l.composites),c=0;c<l.composites.length;c++)u=u.concat(r.allComposites(l.composites[c]));return l.cache&&(l.cache.allComposites=u),u},r.get=function(l,u,c){var f,d;switch(c){case"body":f=r.allBodies(l);break;case"constraint":f=r.allConstraints(l);break;case"composite":f=r.allComposites(l).concat(l);break}return f?(d=f.filter(function(p){return p.id.toString()===u.toString()}),d.length===0?null:d[0]):null},r.move=function(l,u,c){return r.remove(l,u),r.add(c,u),l},r.rebase=function(l){for(var u=r.allBodies(l).concat(r.allConstraints(l)).concat(r.allComposites(l)),c=0;c<u.length;c++)u[c].id=o.nextId();return l},r.translate=function(l,u,c){for(var f=c?r.allBodies(l):l.bodies,d=0;d<f.length;d++)a.translate(f[d],u);return l},r.rotate=function(l,u,c,f){for(var d=Math.cos(u),p=Math.sin(u),m=f?r.allBodies(l):l.bodies,h=0;h<m.length;h++){var g=m[h],x=g.position.x-c.x,b=g.position.y-c.y;a.setPosition(g,{x:c.x+(x*d-b*p),y:c.y+(x*p+b*d)}),a.rotate(g,u)}return l},r.scale=function(l,u,c,f,d){for(var p=d?r.allBodies(l):l.bodies,m=0;m<p.length;m++){var h=p[m],g=h.position.x-f.x,x=h.position.y-f.y;a.setPosition(h,{x:f.x+g*u,y:f.y+x*c}),a.scale(h,u,c)}return l},r.bounds=function(l){for(var u=r.allBodies(l),c=[],f=0;f<u.length;f+=1){var d=u[f];c.push(d.bounds.min,d.bounds.max)}return s.create(c)}})()},function(e,t,n){var r={};e.exports=r;var i=n(4),o=n(5),s=n(0);(function(){r._motionWakeThreshold=.18,r._motionSleepThreshold=.08,r._minBias=.9,r.update=function(a,l){for(var u=l/s._baseDelta,c=r._motionSleepThreshold,f=0;f<a.length;f++){var d=a[f],p=i.getSpeed(d),m=i.getAngularSpeed(d),h=p*p+m*m;if(d.force.x!==0||d.force.y!==0){r.set(d,!1);continue}var g=Math.min(d.motion,h),x=Math.max(d.motion,h);d.motion=r._minBias*g+(1-r._minBias)*x,d.sleepThreshold>0&&d.motion<c?(d.sleepCounter+=1,d.sleepCounter>=d.sleepThreshold/u&&r.set(d,!0)):d.sleepCounter>0&&(d.sleepCounter-=1)}},r.afterCollisions=function(a){for(var l=r._motionSleepThreshold,u=0;u<a.length;u++){var c=a[u];if(c.isActive){var f=c.collision,d=f.bodyA.parent,p=f.bodyB.parent;if(!(d.isSleeping&&p.isSleeping||d.isStatic||p.isStatic)&&(d.isSleeping||p.isSleeping)){var m=d.isSleeping&&!d.isStatic?d:p,h=m===d?p:d;!m.isStatic&&h.motion>l&&r.set(m,!1)}}}},r.set=function(a,l){var u=a.isSleeping;l?(a.isSleeping=!0,a.sleepCounter=a.sleepThreshold,a.positionImpulse.x=0,a.positionImpulse.y=0,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.anglePrev=a.angle,a.speed=0,a.angularSpeed=0,a.motion=0,u||o.trigger(a,"sleepStart")):(a.isSleeping=!1,a.sleepCounter=0,u&&o.trigger(a,"sleepEnd"))}})()},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(9);(function(){var s=[],a={overlap:0,axis:null},l={overlap:0,axis:null};r.create=function(u,c){return{pair:null,collided:!1,bodyA:u,bodyB:c,parentA:u.parent,parentB:c.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},r.collides=function(u,c,f){if(r._overlapAxes(a,u.vertices,c.vertices,u.axes),a.overlap<=0||(r._overlapAxes(l,c.vertices,u.vertices,c.axes),l.overlap<=0))return null;var d=f&&f.table[o.id(u,c)],p;d?p=d.collision:(p=r.create(u,c),p.collided=!0,p.bodyA=u.id<c.id?u:c,p.bodyB=u.id<c.id?c:u,p.parentA=p.bodyA.parent,p.parentB=p.bodyB.parent),u=p.bodyA,c=p.bodyB;var m;a.overlap<l.overlap?m=a:m=l;var h=p.normal,g=p.supports,x=m.axis,b=x.x,y=x.y;b*(c.position.x-u.position.x)+y*(c.position.y-u.position.y)<0?(h.x=b,h.y=y):(h.x=-b,h.y=-y),p.tangent.x=-h.y,p.tangent.y=h.x,p.depth=m.overlap,p.penetration.x=h.x*p.depth,p.penetration.y=h.y*p.depth;var v=r._findSupports(u,c,h,1),C=0;if(i.contains(u.vertices,v[0])&&(g[C++]=v[0]),i.contains(u.vertices,v[1])&&(g[C++]=v[1]),C<2){var _=r._findSupports(c,u,h,-1);i.contains(c.vertices,_[0])&&(g[C++]=_[0]),C<2&&i.contains(c.vertices,_[1])&&(g[C++]=_[1])}return C===0&&(g[C++]=v[0]),g.length=C,p},r._overlapAxes=function(u,c,f,d){var p=c.length,m=f.length,h=c[0].x,g=c[0].y,x=f[0].x,b=f[0].y,y=d.length,v=Number.MAX_VALUE,C=0,_,S,E,T,I,k;for(I=0;I<y;I++){var O=d[I],F=O.x,B=O.y,M=h*F+g*B,z=x*F+b*B,W=M,H=z;for(k=1;k<p;k+=1)T=c[k].x*F+c[k].y*B,T>W?W=T:T<M&&(M=T);for(k=1;k<m;k+=1)T=f[k].x*F+f[k].y*B,T>H?H=T:T<z&&(z=T);if(S=W-z,E=H-M,_=S<E?S:E,_<v&&(v=_,C=I,_<=0))break}u.axis=d[C],u.overlap=v},r._projectToAxis=function(u,c,f){for(var d=c[0].x*f.x+c[0].y*f.y,p=d,m=1;m<c.length;m+=1){var h=c[m].x*f.x+c[m].y*f.y;h>p?p=h:h<d&&(d=h)}u.min=d,u.max=p},r._findSupports=function(u,c,f,d){var p=c.vertices,m=p.length,h=u.position.x,g=u.position.y,x=f.x*d,b=f.y*d,y=Number.MAX_VALUE,v,C,_,S,E;for(E=0;E<m;E+=1)C=p[E],S=x*(h-C.x)+b*(g-C.y),S<y&&(y=S,v=C);return _=p[(m+v.index-1)%m],y=x*(h-_.x)+b*(g-_.y),C=p[(v.index+1)%m],x*(h-C.x)+b*(g-C.y)<y?(s[0]=v,s[1]=C,s):(s[0]=v,s[1]=_,s)}})()},function(e,t,n){var r={};e.exports=r;var i=n(16);(function(){r.create=function(o,s){var a=o.bodyA,l=o.bodyB,u={id:r.id(a,l),bodyA:a,bodyB:l,collision:o,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:a.isSensor||l.isSensor,timeCreated:s,timeUpdated:s,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return r.update(u,o,s),u},r.update=function(o,s,a){var l=o.contacts,u=s.supports,c=o.activeContacts,f=s.parentA,d=s.parentB,p=f.vertices.length;o.isActive=!0,o.timeUpdated=a,o.collision=s,o.separation=s.depth,o.inverseMass=f.inverseMass+d.inverseMass,o.friction=f.friction<d.friction?f.friction:d.friction,o.frictionStatic=f.frictionStatic>d.frictionStatic?f.frictionStatic:d.frictionStatic,o.restitution=f.restitution>d.restitution?f.restitution:d.restitution,o.slop=f.slop>d.slop?f.slop:d.slop,s.pair=o,c.length=0;for(var m=0;m<u.length;m++){var h=u[m],g=h.body===f?h.index:p+h.index,x=l[g];x?c.push(x):c.push(l[g]=i.create(h))}},r.setActive=function(o,s,a){s?(o.isActive=!0,o.timeUpdated=a):(o.isActive=!1,o.activeContacts.length=0)},r.id=function(o,s){return o.id<s.id?"A"+o.id+"B"+s.id:"A"+s.id+"B"+o.id}})()},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(2),s=n(7),a=n(1),l=n(11),u=n(0);(function(){r._warming=.4,r._torqueDampen=1,r._minLength=1e-6,r.create=function(c){var f=c;f.bodyA&&!f.pointA&&(f.pointA={x:0,y:0}),f.bodyB&&!f.pointB&&(f.pointB={x:0,y:0});var d=f.bodyA?o.add(f.bodyA.position,f.pointA):f.pointA,p=f.bodyB?o.add(f.bodyB.position,f.pointB):f.pointB,m=o.magnitude(o.sub(d,p));f.length=typeof f.length<"u"?f.length:m,f.id=f.id||u.nextId(),f.label=f.label||"Constraint",f.type="constraint",f.stiffness=f.stiffness||(f.length>0?1:.7),f.damping=f.damping||0,f.angularStiffness=f.angularStiffness||0,f.angleA=f.bodyA?f.bodyA.angle:f.angleA,f.angleB=f.bodyB?f.bodyB.angle:f.angleB,f.plugin={};var h={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return f.length===0&&f.stiffness>.1?(h.type="pin",h.anchors=!1):f.stiffness<.9&&(h.type="spring"),f.render=u.extend(h,f.render),f},r.preSolveAll=function(c){for(var f=0;f<c.length;f+=1){var d=c[f],p=d.constraintImpulse;d.isStatic||p.x===0&&p.y===0&&p.angle===0||(d.position.x+=p.x,d.position.y+=p.y,d.angle+=p.angle)}},r.solveAll=function(c,f){for(var d=u.clamp(f/u._baseDelta,0,1),p=0;p<c.length;p+=1){var m=c[p],h=!m.bodyA||m.bodyA&&m.bodyA.isStatic,g=!m.bodyB||m.bodyB&&m.bodyB.isStatic;(h||g)&&r.solve(c[p],d)}for(p=0;p<c.length;p+=1)m=c[p],h=!m.bodyA||m.bodyA&&m.bodyA.isStatic,g=!m.bodyB||m.bodyB&&m.bodyB.isStatic,!h&&!g&&r.solve(c[p],d)},r.solve=function(c,f){var d=c.bodyA,p=c.bodyB,m=c.pointA,h=c.pointB;if(!(!d&&!p)){d&&!d.isStatic&&(o.rotate(m,d.angle-c.angleA,m),c.angleA=d.angle),p&&!p.isStatic&&(o.rotate(h,p.angle-c.angleB,h),c.angleB=p.angle);var g=m,x=h;if(d&&(g=o.add(d.position,m)),p&&(x=o.add(p.position,h)),!(!g||!x)){var b=o.sub(g,x),y=o.magnitude(b);y<r._minLength&&(y=r._minLength);var v=(y-c.length)/y,C=c.stiffness>=1||c.length===0,_=C?c.stiffness*f:c.stiffness*f*f,S=c.damping*f,E=o.mult(b,v*_),T=(d?d.inverseMass:0)+(p?p.inverseMass:0),I=(d?d.inverseInertia:0)+(p?p.inverseInertia:0),k=T+I,O,F,B,M,z;if(S>0){var W=o.create();B=o.div(b,y),z=o.sub(p&&o.sub(p.position,p.positionPrev)||W,d&&o.sub(d.position,d.positionPrev)||W),M=o.dot(B,z)}d&&!d.isStatic&&(F=d.inverseMass/T,d.constraintImpulse.x-=E.x*F,d.constraintImpulse.y-=E.y*F,d.position.x-=E.x*F,d.position.y-=E.y*F,S>0&&(d.positionPrev.x-=S*B.x*M*F,d.positionPrev.y-=S*B.y*M*F),O=o.cross(m,E)/k*r._torqueDampen*d.inverseInertia*(1-c.angularStiffness),d.constraintImpulse.angle-=O,d.angle-=O),p&&!p.isStatic&&(F=p.inverseMass/T,p.constraintImpulse.x+=E.x*F,p.constraintImpulse.y+=E.y*F,p.position.x+=E.x*F,p.position.y+=E.y*F,S>0&&(p.positionPrev.x+=S*B.x*M*F,p.positionPrev.y+=S*B.y*M*F),O=o.cross(h,E)/k*r._torqueDampen*p.inverseInertia*(1-c.angularStiffness),p.constraintImpulse.angle+=O,p.angle+=O)}}},r.postSolveAll=function(c){for(var f=0;f<c.length;f++){var d=c[f],p=d.constraintImpulse;if(!(d.isStatic||p.x===0&&p.y===0&&p.angle===0)){s.set(d,!1);for(var m=0;m<d.parts.length;m++){var h=d.parts[m];i.translate(h.vertices,p),m>0&&(h.position.x+=p.x,h.position.y+=p.y),p.angle!==0&&(i.rotate(h.vertices,p.angle,d.position),l.rotate(h.axes,p.angle),m>0&&o.rotateAbout(h.position,p.angle,d.position,h.position)),a.update(h.bounds,h.vertices,d.velocity)}p.angle*=r._warming,p.x*=r._warming,p.y*=r._warming}}},r.pointAWorld=function(c){return{x:(c.bodyA?c.bodyA.position.x:0)+(c.pointA?c.pointA.x:0),y:(c.bodyA?c.bodyA.position.y:0)+(c.pointA?c.pointA.y:0)}},r.pointBWorld=function(c){return{x:(c.bodyB?c.bodyB.position.x:0)+(c.pointB?c.pointB.x:0),y:(c.bodyB?c.bodyB.position.y:0)+(c.pointB?c.pointB.y:0)}}})()},function(e,t,n){var r={};e.exports=r;var i=n(2),o=n(0);(function(){r.fromVertices=function(s){for(var a={},l=0;l<s.length;l++){var u=(l+1)%s.length,c=i.normalise({x:s[u].y-s[l].y,y:s[l].x-s[u].x}),f=c.y===0?1/0:c.x/c.y;f=f.toFixed(3).toString(),a[f]=c}return o.values(a)},r.rotate=function(s,a){if(a!==0)for(var l=Math.cos(a),u=Math.sin(a),c=0;c<s.length;c++){var f=s[c],d;d=f.x*l-f.y*u,f.y=f.x*u+f.y*l,f.x=d}}})()},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(0),s=n(4),a=n(1),l=n(2);(function(){r.rectangle=function(u,c,f,d,p){p=p||{};var m={label:"Rectangle Body",position:{x:u,y:c},vertices:i.fromPath("L 0 0 L "+f+" 0 L "+f+" "+d+" L 0 "+d)};if(p.chamfer){var h=p.chamfer;m.vertices=i.chamfer(m.vertices,h.radius,h.quality,h.qualityMin,h.qualityMax),delete p.chamfer}return s.create(o.extend({},m,p))},r.trapezoid=function(u,c,f,d,p,m){m=m||{},p*=.5;var h=(1-p*2)*f,g=f*p,x=g+h,b=x+g,y;p<.5?y="L 0 0 L "+g+" "+-d+" L "+x+" "+-d+" L "+b+" 0":y="L 0 0 L "+x+" "+-d+" L "+b+" 0";var v={label:"Trapezoid Body",position:{x:u,y:c},vertices:i.fromPath(y)};if(m.chamfer){var C=m.chamfer;v.vertices=i.chamfer(v.vertices,C.radius,C.quality,C.qualityMin,C.qualityMax),delete m.chamfer}return s.create(o.extend({},v,m))},r.circle=function(u,c,f,d,p){d=d||{};var m={label:"Circle Body",circleRadius:f};p=p||25;var h=Math.ceil(Math.max(10,Math.min(p,f)));return h%2===1&&(h+=1),r.polygon(u,c,h,f,o.extend({},m,d))},r.polygon=function(u,c,f,d,p){if(p=p||{},f<3)return r.circle(u,c,d,p);for(var m=2*Math.PI/f,h="",g=m*.5,x=0;x<f;x+=1){var b=g+x*m,y=Math.cos(b)*d,v=Math.sin(b)*d;h+="L "+y.toFixed(3)+" "+v.toFixed(3)+" "}var C={label:"Polygon Body",position:{x:u,y:c},vertices:i.fromPath(h)};if(p.chamfer){var _=p.chamfer;C.vertices=i.chamfer(C.vertices,_.radius,_.quality,_.qualityMin,_.qualityMax),delete p.chamfer}return s.create(o.extend({},C,p))},r.fromVertices=function(u,c,f,d,p,m,h,g){var x=o.getDecomp(),b,y,v,C,_,S,E,T,I,k,O;for(b=!!(x&&x.quickDecomp),d=d||{},v=[],p=typeof p<"u"?p:!1,m=typeof m<"u"?m:.01,h=typeof h<"u"?h:10,g=typeof g<"u"?g:.01,o.isArray(f[0])||(f=[f]),k=0;k<f.length;k+=1)if(S=f[k],C=i.isConvex(S),_=!C,_&&!b&&o.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),C||!b)C?S=i.clockwiseSort(S):S=i.hull(S),v.push({position:{x:u,y:c},vertices:S});else{var F=S.map(function(ye){return[ye.x,ye.y]});x.makeCCW(F),m!==!1&&x.removeCollinearPoints(F,m),g!==!1&&x.removeDuplicatePoints&&x.removeDuplicatePoints(F,g);var B=x.quickDecomp(F);for(E=0;E<B.length;E++){var M=B[E],z=M.map(function(ye){return{x:ye[0],y:ye[1]}});h>0&&i.area(z)<h||v.push({position:i.centre(z),vertices:z})}}for(E=0;E<v.length;E++)v[E]=s.create(o.extend(v[E],d));if(p){var W=5;for(E=0;E<v.length;E++){var H=v[E];for(T=E+1;T<v.length;T++){var Q=v[T];if(a.overlaps(H.bounds,Q.bounds)){var re=H.vertices,oe=Q.vertices;for(I=0;I<H.vertices.length;I++)for(O=0;O<Q.vertices.length;O++){var me=l.magnitudeSquared(l.sub(re[(I+1)%re.length],oe[O])),ge=l.magnitudeSquared(l.sub(re[I],oe[(O+1)%oe.length]));me<W&&ge<W&&(re[I].isInternal=!0,oe[O].isInternal=!0)}}}}}return v.length>1?(y=s.create(o.extend({parts:v.slice(0)},d)),s.setPosition(y,{x:u,y:c}),y):v[0]}})()},function(e,t,n){var r={};e.exports=r;var i=n(0),o=n(8);(function(){r.create=function(s){var a={bodies:[],pairs:null};return i.extend(a,s)},r.setBodies=function(s,a){s.bodies=a.slice(0)},r.clear=function(s){s.bodies=[]},r.collisions=function(s){var a=[],l=s.pairs,u=s.bodies,c=u.length,f=r.canCollide,d=o.collides,p,m;for(u.sort(r._compareBoundsX),p=0;p<c;p++){var h=u[p],g=h.bounds,x=h.bounds.max.x,b=h.bounds.max.y,y=h.bounds.min.y,v=h.isStatic||h.isSleeping,C=h.parts.length,_=C===1;for(m=p+1;m<c;m++){var S=u[m],E=S.bounds;if(E.min.x>x)break;if(!(b<E.min.y||y>E.max.y)&&!(v&&(S.isStatic||S.isSleeping))&&f(h.collisionFilter,S.collisionFilter)){var T=S.parts.length;if(_&&T===1){var I=d(h,S,l);I&&a.push(I)}else for(var k=C>1?1:0,O=T>1?1:0,F=k;F<C;F++)for(var B=h.parts[F],g=B.bounds,M=O;M<T;M++){var z=S.parts[M],E=z.bounds;if(!(g.min.x>E.max.x||g.max.x<E.min.x||g.max.y<E.min.y||g.min.y>E.max.y)){var I=d(B,z,l);I&&a.push(I)}}}}}return a},r.canCollide=function(s,a){return s.group===a.group&&s.group!==0?s.group>0:(s.mask&a.category)!==0&&(a.mask&s.category)!==0},r._compareBoundsX=function(s,a){return s.bounds.min.x-a.bounds.min.x}})()},function(e,t,n){var r={};e.exports=r;var i=n(0);(function(){r.create=function(o){var s={};return o||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),s.element=o||document.body,s.absolute={x:0,y:0},s.position={x:0,y:0},s.mousedownPosition={x:0,y:0},s.mouseupPosition={x:0,y:0},s.offset={x:0,y:0},s.scale={x:1,y:1},s.wheelDelta=0,s.button=-1,s.pixelRatio=parseInt(s.element.getAttribute("data-pixel-ratio"),10)||1,s.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},s.mousemove=function(a){var l=r._getRelativeMousePosition(a,s.element,s.pixelRatio),u=a.changedTouches;u&&(s.button=0,a.preventDefault()),s.absolute.x=l.x,s.absolute.y=l.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y,s.sourceEvents.mousemove=a},s.mousedown=function(a){var l=r._getRelativeMousePosition(a,s.element,s.pixelRatio),u=a.changedTouches;u?(s.button=0,a.preventDefault()):s.button=a.button,s.absolute.x=l.x,s.absolute.y=l.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y,s.mousedownPosition.x=s.position.x,s.mousedownPosition.y=s.position.y,s.sourceEvents.mousedown=a},s.mouseup=function(a){var l=r._getRelativeMousePosition(a,s.element,s.pixelRatio),u=a.changedTouches;u&&a.preventDefault(),s.button=-1,s.absolute.x=l.x,s.absolute.y=l.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y,s.mouseupPosition.x=s.position.x,s.mouseupPosition.y=s.position.y,s.sourceEvents.mouseup=a},s.mousewheel=function(a){s.wheelDelta=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)),a.preventDefault()},r.setElement(s,s.element),s},r.setElement=function(o,s){o.element=s,s.addEventListener("mousemove",o.mousemove),s.addEventListener("mousedown",o.mousedown),s.addEventListener("mouseup",o.mouseup),s.addEventListener("mousewheel",o.mousewheel),s.addEventListener("DOMMouseScroll",o.mousewheel),s.addEventListener("touchmove",o.mousemove),s.addEventListener("touchstart",o.mousedown),s.addEventListener("touchend",o.mouseup)},r.clearSourceEvents=function(o){o.sourceEvents.mousemove=null,o.sourceEvents.mousedown=null,o.sourceEvents.mouseup=null,o.sourceEvents.mousewheel=null,o.wheelDelta=0},r.setOffset=function(o,s){o.offset.x=s.x,o.offset.y=s.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},r.setScale=function(o,s){o.scale.x=s.x,o.scale.y=s.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},r._getRelativeMousePosition=function(o,s,a){var l=s.getBoundingClientRect(),u=document.documentElement||document.body.parentNode||document.body,c=window.pageXOffset!==void 0?window.pageXOffset:u.scrollLeft,f=window.pageYOffset!==void 0?window.pageYOffset:u.scrollTop,d=o.changedTouches,p,m;return d?(p=d[0].pageX-l.left-c,m=d[0].pageY-l.top-f):(p=o.pageX-l.left-c,m=o.pageY-l.top-f),{x:p/(s.clientWidth/(s.width||s.clientWidth)*a),y:m/(s.clientHeight/(s.height||s.clientHeight)*a)}}})()},function(e,t,n){var r={};e.exports=r;var i=n(0);(function(){r._registry={},r.register=function(o){if(r.isPlugin(o)||i.warn("Plugin.register:",r.toString(o),"does not implement all required fields."),o.name in r._registry){var s=r._registry[o.name],a=r.versionParse(o.version).number,l=r.versionParse(s.version).number;a>l?(i.warn("Plugin.register:",r.toString(s),"was upgraded to",r.toString(o)),r._registry[o.name]=o):a<l?i.warn("Plugin.register:",r.toString(s),"can not be downgraded to",r.toString(o)):o!==s&&i.warn("Plugin.register:",r.toString(o),"is already registered to different plugin object")}else r._registry[o.name]=o;return o},r.resolve=function(o){return r._registry[r.dependencyParse(o).name]},r.toString=function(o){return typeof o=="string"?o:(o.name||"anonymous")+"@"+(o.version||o.range||"0.0.0")},r.isPlugin=function(o){return o&&o.name&&o.version&&o.install},r.isUsed=function(o,s){return o.used.indexOf(s)>-1},r.isFor=function(o,s){var a=o.for&&r.dependencyParse(o.for);return!o.for||s.name===a.name&&r.versionSatisfies(s.version,a.range)},r.use=function(o,s){if(o.uses=(o.uses||[]).concat(s||[]),o.uses.length===0){i.warn("Plugin.use:",r.toString(o),"does not specify any dependencies to install.");return}for(var a=r.dependencies(o),l=i.topologicalSort(a),u=[],c=0;c<l.length;c+=1)if(l[c]!==o.name){var f=r.resolve(l[c]);if(!f){u.push("\u274C "+l[c]);continue}r.isUsed(o,f.name)||(r.isFor(f,o)||(i.warn("Plugin.use:",r.toString(f),"is for",f.for,"but installed on",r.toString(o)+"."),f._warned=!0),f.install?f.install(o):(i.warn("Plugin.use:",r.toString(f),"does not specify an install function."),f._warned=!0),f._warned?(u.push("\u{1F536} "+r.toString(f)),delete f._warned):u.push("\u2705 "+r.toString(f)),o.used.push(f.name))}u.length>0&&i.info(u.join("  "))},r.dependencies=function(o,s){var a=r.dependencyParse(o),l=a.name;if(s=s||{},!(l in s)){o=r.resolve(o)||o,s[l]=i.map(o.uses||[],function(c){r.isPlugin(c)&&r.register(c);var f=r.dependencyParse(c),d=r.resolve(c);return d&&!r.versionSatisfies(d.version,f.range)?(i.warn("Plugin.dependencies:",r.toString(d),"does not satisfy",r.toString(f),"used by",r.toString(a)+"."),d._warned=!0,o._warned=!0):d||(i.warn("Plugin.dependencies:",r.toString(c),"used by",r.toString(a),"could not be resolved."),o._warned=!0),f.name});for(var u=0;u<s[l].length;u+=1)r.dependencies(s[l][u],s);return s}},r.dependencyParse=function(o){if(i.isString(o)){var s=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return s.test(o)||i.warn("Plugin.dependencyParse:",o,"is not a valid dependency string."),{name:o.split("@")[0],range:o.split("@")[1]||"*"}}return{name:o.name,range:o.range||o.version}},r.versionParse=function(o){var s=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;s.test(o)||i.warn("Plugin.versionParse:",o,"is not a valid version or range.");var a=s.exec(o),l=Number(a[4]),u=Number(a[5]),c=Number(a[6]);return{isRange:!!(a[1]||a[2]),version:a[3],range:o,operator:a[1]||a[2]||"",major:l,minor:u,patch:c,parts:[l,u,c],prerelease:a[7],number:l*1e8+u*1e4+c}},r.versionSatisfies=function(o,s){s=s||"*";var a=r.versionParse(s),l=r.versionParse(o);if(a.isRange){if(a.operator==="*"||o==="*")return!0;if(a.operator===">")return l.number>a.number;if(a.operator===">=")return l.number>=a.number;if(a.operator==="~")return l.major===a.major&&l.minor===a.minor&&l.patch>=a.patch;if(a.operator==="^")return a.major>0?l.major===a.major&&l.number>=a.number:a.minor>0?l.minor===a.minor&&l.patch>=a.patch:l.patch===a.patch}return o===s||o==="*"}})()},function(e,t){var n={};e.exports=n,function(){n.create=function(r){return{vertex:r,normalImpulse:0,tangentImpulse:0}}}()},function(e,t,n){var r={};e.exports=r;var i=n(7),o=n(18),s=n(13),a=n(19),l=n(5),u=n(6),c=n(10),f=n(0),d=n(4);(function(){r.create=function(p){p=p||{};var m={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},h=f.extend(m,p);return h.world=p.world||u.create({label:"World"}),h.pairs=p.pairs||a.create(),h.detector=p.detector||s.create(),h.grid={buckets:[]},h.world.gravity=h.gravity,h.broadphase=h.grid,h.metrics={},h},r.update=function(p,m){var h=f.now(),g=p.world,x=p.detector,b=p.pairs,y=p.timing,v=y.timestamp,C;m=typeof m<"u"?m:f._baseDelta,m*=y.timeScale,y.timestamp+=m,y.lastDelta=m;var _={timestamp:y.timestamp,delta:m};l.trigger(p,"beforeUpdate",_);var S=u.allBodies(g),E=u.allConstraints(g);for(g.isModified&&(s.setBodies(x,S),u.setModified(g,!1,!1,!0)),p.enableSleeping&&i.update(S,m),r._bodiesApplyGravity(S,p.gravity),m>0&&r._bodiesUpdate(S,m),c.preSolveAll(S),C=0;C<p.constraintIterations;C++)c.solveAll(E,m);c.postSolveAll(S),x.pairs=p.pairs;var T=s.collisions(x);a.update(b,T,v),p.enableSleeping&&i.afterCollisions(b.list),b.collisionStart.length>0&&l.trigger(p,"collisionStart",{pairs:b.collisionStart});var I=f.clamp(20/p.positionIterations,0,1);for(o.preSolvePosition(b.list),C=0;C<p.positionIterations;C++)o.solvePosition(b.list,m,I);for(o.postSolvePosition(S),c.preSolveAll(S),C=0;C<p.constraintIterations;C++)c.solveAll(E,m);for(c.postSolveAll(S),o.preSolveVelocity(b.list),C=0;C<p.velocityIterations;C++)o.solveVelocity(b.list,m);return r._bodiesUpdateVelocities(S),b.collisionActive.length>0&&l.trigger(p,"collisionActive",{pairs:b.collisionActive}),b.collisionEnd.length>0&&l.trigger(p,"collisionEnd",{pairs:b.collisionEnd}),r._bodiesClearForces(S),l.trigger(p,"afterUpdate",_),p.timing.lastElapsed=f.now()-h,p},r.merge=function(p,m){if(f.extend(p,m),m.world){p.world=m.world,r.clear(p);for(var h=u.allBodies(p.world),g=0;g<h.length;g++){var x=h[g];i.set(x,!1),x.id=f.nextId()}}},r.clear=function(p){a.clear(p.pairs),s.clear(p.detector)},r._bodiesClearForces=function(p){for(var m=p.length,h=0;h<m;h++){var g=p[h];g.force.x=0,g.force.y=0,g.torque=0}},r._bodiesApplyGravity=function(p,m){var h=typeof m.scale<"u"?m.scale:.001,g=p.length;if(!(m.x===0&&m.y===0||h===0))for(var x=0;x<g;x++){var b=p[x];b.isStatic||b.isSleeping||(b.force.y+=b.mass*m.y*h,b.force.x+=b.mass*m.x*h)}},r._bodiesUpdate=function(p,m){for(var h=p.length,g=0;g<h;g++){var x=p[g];x.isStatic||x.isSleeping||d.update(x,m)}},r._bodiesUpdateVelocities=function(p){for(var m=p.length,h=0;h<m;h++)d.updateVelocities(p[h])}})()},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(0),s=n(1);(function(){r._restingThresh=2,r._restingThreshTangent=Math.sqrt(6),r._positionDampen=.9,r._positionWarming=.8,r._frictionNormalMultiplier=5,r._frictionMaxStatic=Number.MAX_VALUE,r.preSolvePosition=function(a){var l,u,c,f=a.length;for(l=0;l<f;l++)u=a[l],u.isActive&&(c=u.activeContacts.length,u.collision.parentA.totalContacts+=c,u.collision.parentB.totalContacts+=c)},r.solvePosition=function(a,l,u){var c,f,d,p,m,h,g,x,b=r._positionDampen*(u||1),y=o.clamp(l/o._baseDelta,0,1),v=a.length;for(c=0;c<v;c++)f=a[c],!(!f.isActive||f.isSensor)&&(d=f.collision,p=d.parentA,m=d.parentB,h=d.normal,f.separation=h.x*(m.positionImpulse.x+d.penetration.x-p.positionImpulse.x)+h.y*(m.positionImpulse.y+d.penetration.y-p.positionImpulse.y));for(c=0;c<v;c++)f=a[c],!(!f.isActive||f.isSensor)&&(d=f.collision,p=d.parentA,m=d.parentB,h=d.normal,x=f.separation-f.slop*y,(p.isStatic||m.isStatic)&&(x*=2),p.isStatic||p.isSleeping||(g=b/p.totalContacts,p.positionImpulse.x+=h.x*x*g,p.positionImpulse.y+=h.y*x*g),m.isStatic||m.isSleeping||(g=b/m.totalContacts,m.positionImpulse.x-=h.x*x*g,m.positionImpulse.y-=h.y*x*g))},r.postSolvePosition=function(a){for(var l=r._positionWarming,u=a.length,c=i.translate,f=s.update,d=0;d<u;d++){var p=a[d],m=p.positionImpulse,h=m.x,g=m.y,x=p.velocity;if(p.totalContacts=0,h!==0||g!==0){for(var b=0;b<p.parts.length;b++){var y=p.parts[b];c(y.vertices,m),f(y.bounds,y.vertices,x),y.position.x+=h,y.position.y+=g}p.positionPrev.x+=h,p.positionPrev.y+=g,h*x.x+g*x.y<0?(m.x=0,m.y=0):(m.x*=l,m.y*=l)}}},r.preSolveVelocity=function(a){var l=a.length,u,c;for(u=0;u<l;u++){var f=a[u];if(!(!f.isActive||f.isSensor)){var d=f.activeContacts,p=d.length,m=f.collision,h=m.parentA,g=m.parentB,x=m.normal,b=m.tangent;for(c=0;c<p;c++){var y=d[c],v=y.vertex,C=y.normalImpulse,_=y.tangentImpulse;if(C!==0||_!==0){var S=x.x*C+b.x*_,E=x.y*C+b.y*_;h.isStatic||h.isSleeping||(h.positionPrev.x+=S*h.inverseMass,h.positionPrev.y+=E*h.inverseMass,h.anglePrev+=h.inverseInertia*((v.x-h.position.x)*E-(v.y-h.position.y)*S)),g.isStatic||g.isSleeping||(g.positionPrev.x-=S*g.inverseMass,g.positionPrev.y-=E*g.inverseMass,g.anglePrev-=g.inverseInertia*((v.x-g.position.x)*E-(v.y-g.position.y)*S))}}}}},r.solveVelocity=function(a,l){var u=l/o._baseDelta,c=u*u,f=c*u,d=-r._restingThresh*u,p=r._restingThreshTangent,m=r._frictionNormalMultiplier*u,h=r._frictionMaxStatic,g=a.length,x,b,y,v;for(y=0;y<g;y++){var C=a[y];if(!(!C.isActive||C.isSensor)){var _=C.collision,S=_.parentA,E=_.parentB,T=S.velocity,I=E.velocity,k=_.normal.x,O=_.normal.y,F=_.tangent.x,B=_.tangent.y,M=C.activeContacts,z=M.length,W=1/z,H=S.inverseMass+E.inverseMass,Q=C.friction*C.frictionStatic*m;for(T.x=S.position.x-S.positionPrev.x,T.y=S.position.y-S.positionPrev.y,I.x=E.position.x-E.positionPrev.x,I.y=E.position.y-E.positionPrev.y,S.angularVelocity=S.angle-S.anglePrev,E.angularVelocity=E.angle-E.anglePrev,v=0;v<z;v++){var re=M[v],oe=re.vertex,me=oe.x-S.position.x,ge=oe.y-S.position.y,ye=oe.x-E.position.x,ve=oe.y-E.position.y,Ne=T.x-ge*S.angularVelocity,Ge=T.y+me*S.angularVelocity,nt=I.x-ve*E.angularVelocity,Y=I.y+ye*E.angularVelocity,ie=Ne-nt,ue=Ge-Y,U=k*ie+O*ue,Ue=F*ie+B*ue,ke=C.separation+U,Xe=Math.min(ke,1);Xe=ke<0?0:Xe;var Ye=Xe*Q;Ue<-Ye||Ue>Ye?(b=Ue>0?Ue:-Ue,x=C.friction*(Ue>0?1:-1)*f,x<-b?x=-b:x>b&&(x=b)):(x=Ue,b=h);var Pt=me*O-ge*k,yn=ye*O-ve*k,nf=W/(H+S.inverseInertia*Pt*Pt+E.inverseInertia*yn*yn),Ni=(1+C.restitution)*U*nf;if(x*=nf,U<d)re.normalImpulse=0;else{var vm=re.normalImpulse;re.normalImpulse+=Ni,re.normalImpulse>0&&(re.normalImpulse=0),Ni=re.normalImpulse-vm}if(Ue<-p||Ue>p)re.tangentImpulse=0;else{var nl=re.tangentImpulse;re.tangentImpulse+=x,re.tangentImpulse<-b&&(re.tangentImpulse=-b),re.tangentImpulse>b&&(re.tangentImpulse=b),x=re.tangentImpulse-nl}var rf=k*Ni+F*x,da=O*Ni+B*x;S.isStatic||S.isSleeping||(S.positionPrev.x+=rf*S.inverseMass,S.positionPrev.y+=da*S.inverseMass,S.anglePrev+=(me*da-ge*rf)*S.inverseInertia),E.isStatic||E.isSleeping||(E.positionPrev.x-=rf*E.inverseMass,E.positionPrev.y-=da*E.inverseMass,E.anglePrev-=(ye*da-ve*rf)*E.inverseInertia)}}}}})()},function(e,t,n){var r={};e.exports=r;var i=n(9),o=n(0);(function(){r.create=function(s){return o.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},s)},r.update=function(s,a,l){var u=s.list,c=u.length,f=s.table,d=a.length,p=s.collisionStart,m=s.collisionEnd,h=s.collisionActive,g,x,b,y;for(p.length=0,m.length=0,h.length=0,y=0;y<c;y++)u[y].confirmedActive=!1;for(y=0;y<d;y++)g=a[y],b=g.pair,b?(b.isActive?h.push(b):p.push(b),i.update(b,g,l),b.confirmedActive=!0):(b=i.create(g,l),f[b.id]=b,p.push(b),u.push(b));var v=[];for(c=u.length,y=0;y<c;y++)b=u[y],b.confirmedActive||(i.setActive(b,!1,l),m.push(b),!b.collision.bodyA.isSleeping&&!b.collision.bodyB.isSleeping&&v.push(y));for(y=0;y<v.length;y++)x=v[y]-y,b=u[x],u.splice(x,1),delete f[b.id]},r.clear=function(s){return s.table={},s.list.length=0,s.collisionStart.length=0,s.collisionActive.length=0,s.collisionEnd.length=0,s}})()},function(e,t,n){var r=e.exports=n(21);r.Axes=n(11),r.Bodies=n(12),r.Body=n(4),r.Bounds=n(1),r.Collision=n(8),r.Common=n(0),r.Composite=n(6),r.Composites=n(22),r.Constraint=n(10),r.Contact=n(16),r.Detector=n(13),r.Engine=n(17),r.Events=n(5),r.Grid=n(23),r.Mouse=n(14),r.MouseConstraint=n(24),r.Pair=n(9),r.Pairs=n(19),r.Plugin=n(15),r.Query=n(25),r.Render=n(26),r.Resolver=n(18),r.Runner=n(27),r.SAT=n(28),r.Sleeping=n(7),r.Svg=n(29),r.Vector=n(2),r.Vertices=n(3),r.World=n(30),r.Engine.run=r.Runner.run,r.Common.deprecated(r.Engine,"run","Engine.run \u27A4 use Matter.Runner.run(engine) instead")},function(e,t,n){var r={};e.exports=r;var i=n(15),o=n(0);(function(){r.name="matter-js",r.version="0.19.0",r.uses=[],r.used=[],r.use=function(){i.use(r,Array.prototype.slice.call(arguments))},r.before=function(s,a){return s=s.replace(/^Matter./,""),o.chainPathBefore(r,s,a)},r.after=function(s,a){return s=s.replace(/^Matter./,""),o.chainPathAfter(r,s,a)}})()},function(e,t,n){var r={};e.exports=r;var i=n(6),o=n(10),s=n(0),a=n(4),l=n(12),u=s.deprecated;(function(){r.stack=function(c,f,d,p,m,h,g){for(var x=i.create({label:"Stack"}),b=c,y=f,v,C=0,_=0;_<p;_++){for(var S=0,E=0;E<d;E++){var T=g(b,y,E,_,v,C);if(T){var I=T.bounds.max.y-T.bounds.min.y,k=T.bounds.max.x-T.bounds.min.x;I>S&&(S=I),a.translate(T,{x:k*.5,y:I*.5}),b=T.bounds.max.x+m,i.addBody(x,T),v=T,C+=1}else b+=m}y+=S+h,b=c}return x},r.chain=function(c,f,d,p,m,h){for(var g=c.bodies,x=1;x<g.length;x++){var b=g[x-1],y=g[x],v=b.bounds.max.y-b.bounds.min.y,C=b.bounds.max.x-b.bounds.min.x,_=y.bounds.max.y-y.bounds.min.y,S=y.bounds.max.x-y.bounds.min.x,E={bodyA:b,pointA:{x:C*f,y:v*d},bodyB:y,pointB:{x:S*p,y:_*m}},T=s.extend(E,h);i.addConstraint(c,o.create(T))}return c.label+=" Chain",c},r.mesh=function(c,f,d,p,m){var h=c.bodies,g,x,b,y,v;for(g=0;g<d;g++){for(x=1;x<f;x++)b=h[x-1+g*f],y=h[x+g*f],i.addConstraint(c,o.create(s.extend({bodyA:b,bodyB:y},m)));if(g>0)for(x=0;x<f;x++)b=h[x+(g-1)*f],y=h[x+g*f],i.addConstraint(c,o.create(s.extend({bodyA:b,bodyB:y},m))),p&&x>0&&(v=h[x-1+(g-1)*f],i.addConstraint(c,o.create(s.extend({bodyA:v,bodyB:y},m)))),p&&x<f-1&&(v=h[x+1+(g-1)*f],i.addConstraint(c,o.create(s.extend({bodyA:v,bodyB:y},m))))}return c.label+=" Mesh",c},r.pyramid=function(c,f,d,p,m,h,g){return r.stack(c,f,d,p,m,h,function(x,b,y,v,C,_){var S=Math.min(p,Math.ceil(d/2)),E=C?C.bounds.max.x-C.bounds.min.x:0;if(!(v>S)){v=S-v;var T=v,I=d-1-v;if(!(y<T||y>I)){_===1&&a.translate(C,{x:(y+(d%2===1?1:-1))*E,y:0});var k=C?y*E:0;return g(c+k+y*m,b,y,v,C,_)}}})},r.newtonsCradle=function(c,f,d,p,m){for(var h=i.create({label:"Newtons Cradle"}),g=0;g<d;g++){var x=1.9,b=l.circle(c+g*(p*x),f+m,p,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),y=o.create({pointA:{x:c+g*(p*x),y:f},bodyB:b});i.addBody(h,b),i.addConstraint(h,y)}return h},u(r,"newtonsCradle","Composites.newtonsCradle \u27A4 moved to newtonsCradle example"),r.car=function(c,f,d,p,m){var h=a.nextGroup(!0),g=20,x=-d*.5+g,b=d*.5-g,y=0,v=i.create({label:"Car"}),C=l.rectangle(c,f,d,p,{collisionFilter:{group:h},chamfer:{radius:p*.5},density:2e-4}),_=l.circle(c+x,f+y,m,{collisionFilter:{group:h},friction:.8}),S=l.circle(c+b,f+y,m,{collisionFilter:{group:h},friction:.8}),E=o.create({bodyB:C,pointB:{x,y},bodyA:_,stiffness:1,length:0}),T=o.create({bodyB:C,pointB:{x:b,y},bodyA:S,stiffness:1,length:0});return i.addBody(v,C),i.addBody(v,_),i.addBody(v,S),i.addConstraint(v,E),i.addConstraint(v,T),v},u(r,"car","Composites.car \u27A4 moved to car example"),r.softBody=function(c,f,d,p,m,h,g,x,b,y){b=s.extend({inertia:1/0},b),y=s.extend({stiffness:.2,render:{type:"line",anchors:!1}},y);var v=r.stack(c,f,d,p,m,h,function(C,_){return l.circle(C,_,x,b)});return r.mesh(v,d,p,g,y),v.label="Soft Body",v},u(r,"softBody","Composites.softBody \u27A4 moved to softBody and cloth examples")})()},function(e,t,n){var r={};e.exports=r;var i=n(9),o=n(0),s=o.deprecated;(function(){r.create=function(a){var l={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return o.extend(l,a)},r.update=function(a,l,u,c){var f,d,p,m=u.world,h=a.buckets,g,x,b=!1;for(f=0;f<l.length;f++){var y=l[f];if(!(y.isSleeping&&!c)&&!(m.bounds&&(y.bounds.max.x<m.bounds.min.x||y.bounds.min.x>m.bounds.max.x||y.bounds.max.y<m.bounds.min.y||y.bounds.min.y>m.bounds.max.y))){var v=r._getRegion(a,y);if(!y.region||v.id!==y.region.id||c){(!y.region||c)&&(y.region=v);var C=r._regionUnion(v,y.region);for(d=C.startCol;d<=C.endCol;d++)for(p=C.startRow;p<=C.endRow;p++){x=r._getBucketId(d,p),g=h[x];var _=d>=v.startCol&&d<=v.endCol&&p>=v.startRow&&p<=v.endRow,S=d>=y.region.startCol&&d<=y.region.endCol&&p>=y.region.startRow&&p<=y.region.endRow;!_&&S&&S&&g&&r._bucketRemoveBody(a,g,y),(y.region===v||_&&!S||c)&&(g||(g=r._createBucket(h,x)),r._bucketAddBody(a,g,y))}y.region=v,b=!0}}}b&&(a.pairsList=r._createActivePairsList(a))},s(r,"update","Grid.update \u27A4 replaced by Matter.Detector"),r.clear=function(a){a.buckets={},a.pairs={},a.pairsList=[]},s(r,"clear","Grid.clear \u27A4 replaced by Matter.Detector"),r._regionUnion=function(a,l){var u=Math.min(a.startCol,l.startCol),c=Math.max(a.endCol,l.endCol),f=Math.min(a.startRow,l.startRow),d=Math.max(a.endRow,l.endRow);return r._createRegion(u,c,f,d)},r._getRegion=function(a,l){var u=l.bounds,c=Math.floor(u.min.x/a.bucketWidth),f=Math.floor(u.max.x/a.bucketWidth),d=Math.floor(u.min.y/a.bucketHeight),p=Math.floor(u.max.y/a.bucketHeight);return r._createRegion(c,f,d,p)},r._createRegion=function(a,l,u,c){return{id:a+","+l+","+u+","+c,startCol:a,endCol:l,startRow:u,endRow:c}},r._getBucketId=function(a,l){return"C"+a+"R"+l},r._createBucket=function(a,l){var u=a[l]=[];return u},r._bucketAddBody=function(a,l,u){var c=a.pairs,f=i.id,d=l.length,p;for(p=0;p<d;p++){var m=l[p];if(!(u.id===m.id||u.isStatic&&m.isStatic)){var h=f(u,m),g=c[h];g?g[2]+=1:c[h]=[u,m,1]}}l.push(u)},r._bucketRemoveBody=function(a,l,u){var c=a.pairs,f=i.id,d;l.splice(o.indexOf(l,u),1);var p=l.length;for(d=0;d<p;d++){var m=c[f(u,l[d])];m&&(m[2]-=1)}},r._createActivePairsList=function(a){var l,u=a.pairs,c=o.keys(u),f=c.length,d=[],p;for(p=0;p<f;p++)l=u[c[p]],l[2]>0?d.push(l):delete u[c[p]];return d}})()},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(7),s=n(14),a=n(5),l=n(13),u=n(10),c=n(6),f=n(0),d=n(1);(function(){r.create=function(p,m){var h=(p?p.mouse:null)||(m?m.mouse:null);h||(p&&p.render&&p.render.canvas?h=s.create(p.render.canvas):m&&m.element?h=s.create(m.element):(h=s.create(),f.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var g=u.create({label:"Mouse Constraint",pointA:h.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),x={type:"mouseConstraint",mouse:h,element:null,body:null,constraint:g,collisionFilter:{category:1,mask:4294967295,group:0}},b=f.extend(x,m);return a.on(p,"beforeUpdate",function(){var y=c.allBodies(p.world);r.update(b,y),r._triggerEvents(b)}),b},r.update=function(p,m){var h=p.mouse,g=p.constraint,x=p.body;if(h.button===0){if(g.bodyB)o.set(g.bodyB,!1),g.pointA=h.position;else for(var b=0;b<m.length;b++)if(x=m[b],d.contains(x.bounds,h.position)&&l.canCollide(x.collisionFilter,p.collisionFilter))for(var y=x.parts.length>1?1:0;y<x.parts.length;y++){var v=x.parts[y];if(i.contains(v.vertices,h.position)){g.pointA=h.position,g.bodyB=p.body=x,g.pointB={x:h.position.x-x.position.x,y:h.position.y-x.position.y},g.angleB=x.angle,o.set(x,!1),a.trigger(p,"startdrag",{mouse:h,body:x});break}}}else g.bodyB=p.body=null,g.pointB=null,x&&a.trigger(p,"enddrag",{mouse:h,body:x})},r._triggerEvents=function(p){var m=p.mouse,h=m.sourceEvents;h.mousemove&&a.trigger(p,"mousemove",{mouse:m}),h.mousedown&&a.trigger(p,"mousedown",{mouse:m}),h.mouseup&&a.trigger(p,"mouseup",{mouse:m}),s.clearSourceEvents(m)}})()},function(e,t,n){var r={};e.exports=r;var i=n(2),o=n(8),s=n(1),a=n(12),l=n(3);(function(){r.collides=function(u,c){for(var f=[],d=c.length,p=u.bounds,m=o.collides,h=s.overlaps,g=0;g<d;g++){var x=c[g],b=x.parts.length,y=b===1?0:1;if(h(x.bounds,p))for(var v=y;v<b;v++){var C=x.parts[v];if(h(C.bounds,p)){var _=m(C,u);if(_){f.push(_);break}}}}return f},r.ray=function(u,c,f,d){d=d||1e-100;for(var p=i.angle(c,f),m=i.magnitude(i.sub(c,f)),h=(f.x+c.x)*.5,g=(f.y+c.y)*.5,x=a.rectangle(h,g,m,d,{angle:p}),b=r.collides(x,u),y=0;y<b.length;y+=1){var v=b[y];v.body=v.bodyB=v.bodyA}return b},r.region=function(u,c,f){for(var d=[],p=0;p<u.length;p++){var m=u[p],h=s.overlaps(m.bounds,c);(h&&!f||!h&&f)&&d.push(m)}return d},r.point=function(u,c){for(var f=[],d=0;d<u.length;d++){var p=u[d];if(s.contains(p.bounds,c))for(var m=p.parts.length===1?0:1;m<p.parts.length;m++){var h=p.parts[m];if(s.contains(h.bounds,c)&&l.contains(h.vertices,c)){f.push(p);break}}}return f}})()},function(e,t,n){var r={};e.exports=r;var i=n(4),o=n(0),s=n(6),a=n(1),l=n(5),u=n(2),c=n(14);(function(){var f,d;typeof window<"u"&&(f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(y){window.setTimeout(function(){y(o.now())},1e3/60)},d=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r._goodFps=30,r._goodDelta=1e3/60,r.create=function(y){var v={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!y.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},C=o.extend(v,y);return C.canvas&&(C.canvas.width=C.options.width||C.canvas.width,C.canvas.height=C.options.height||C.canvas.height),C.mouse=y.mouse,C.engine=y.engine,C.canvas=C.canvas||h(C.options.width,C.options.height),C.context=C.canvas.getContext("2d"),C.textures={},C.bounds=C.bounds||{min:{x:0,y:0},max:{x:C.canvas.width,y:C.canvas.height}},C.controller=r,C.options.showBroadphase=!1,C.options.pixelRatio!==1&&r.setPixelRatio(C,C.options.pixelRatio),o.isElement(C.element)&&C.element.appendChild(C.canvas),C},r.run=function(y){(function v(C){y.frameRequestId=f(v),p(y,C),r.world(y,C),(y.options.showStats||y.options.showDebug)&&r.stats(y,y.context,C),(y.options.showPerformance||y.options.showDebug)&&r.performance(y,y.context,C)})()},r.stop=function(y){d(y.frameRequestId)},r.setPixelRatio=function(y,v){var C=y.options,_=y.canvas;v==="auto"&&(v=g(_)),C.pixelRatio=v,_.setAttribute("data-pixel-ratio",v),_.width=C.width*v,_.height=C.height*v,_.style.width=C.width+"px",_.style.height=C.height+"px"},r.lookAt=function(y,v,C,_){_=typeof _<"u"?_:!0,v=o.isArray(v)?v:[v],C=C||{x:0,y:0};for(var S={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},E=0;E<v.length;E+=1){var T=v[E],I=T.bounds?T.bounds.min:T.min||T.position||T,k=T.bounds?T.bounds.max:T.max||T.position||T;I&&k&&(I.x<S.min.x&&(S.min.x=I.x),k.x>S.max.x&&(S.max.x=k.x),I.y<S.min.y&&(S.min.y=I.y),k.y>S.max.y&&(S.max.y=k.y))}var O=S.max.x-S.min.x+2*C.x,F=S.max.y-S.min.y+2*C.y,B=y.canvas.height,M=y.canvas.width,z=M/B,W=O/F,H=1,Q=1;W>z?Q=W/z:H=z/W,y.options.hasBounds=!0,y.bounds.min.x=S.min.x,y.bounds.max.x=S.min.x+O*H,y.bounds.min.y=S.min.y,y.bounds.max.y=S.min.y+F*Q,_&&(y.bounds.min.x+=O*.5-O*H*.5,y.bounds.max.x+=O*.5-O*H*.5,y.bounds.min.y+=F*.5-F*Q*.5,y.bounds.max.y+=F*.5-F*Q*.5),y.bounds.min.x-=C.x,y.bounds.max.x-=C.x,y.bounds.min.y-=C.y,y.bounds.max.y-=C.y,y.mouse&&(c.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.canvas.width,y:(y.bounds.max.y-y.bounds.min.y)/y.canvas.height}),c.setOffset(y.mouse,y.bounds.min))},r.startViewTransform=function(y){var v=y.bounds.max.x-y.bounds.min.x,C=y.bounds.max.y-y.bounds.min.y,_=v/y.options.width,S=C/y.options.height;y.context.setTransform(y.options.pixelRatio/_,0,0,y.options.pixelRatio/S,0,0),y.context.translate(-y.bounds.min.x,-y.bounds.min.y)},r.endViewTransform=function(y){y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0)},r.world=function(y,v){var C=o.now(),_=y.engine,S=_.world,E=y.canvas,T=y.context,I=y.options,k=y.timing,O=s.allBodies(S),F=s.allConstraints(S),B=I.wireframes?I.wireframeBackground:I.background,M=[],z=[],W,H={timestamp:_.timing.timestamp};if(l.trigger(y,"beforeRender",H),y.currentBackground!==B&&b(y,B),T.globalCompositeOperation="source-in",T.fillStyle="transparent",T.fillRect(0,0,E.width,E.height),T.globalCompositeOperation="source-over",I.hasBounds){for(W=0;W<O.length;W++){var Q=O[W];a.overlaps(Q.bounds,y.bounds)&&M.push(Q)}for(W=0;W<F.length;W++){var re=F[W],oe=re.bodyA,me=re.bodyB,ge=re.pointA,ye=re.pointB;oe&&(ge=u.add(oe.position,re.pointA)),me&&(ye=u.add(me.position,re.pointB)),!(!ge||!ye)&&(a.contains(y.bounds,ge)||a.contains(y.bounds,ye))&&z.push(re)}r.startViewTransform(y),y.mouse&&(c.setScale(y.mouse,{x:(y.bounds.max.x-y.bounds.min.x)/y.options.width,y:(y.bounds.max.y-y.bounds.min.y)/y.options.height}),c.setOffset(y.mouse,y.bounds.min))}else z=F,M=O,y.options.pixelRatio!==1&&y.context.setTransform(y.options.pixelRatio,0,0,y.options.pixelRatio,0,0);!I.wireframes||_.enableSleeping&&I.showSleeping?r.bodies(y,M,T):(I.showConvexHulls&&r.bodyConvexHulls(y,M,T),r.bodyWireframes(y,M,T)),I.showBounds&&r.bodyBounds(y,M,T),(I.showAxes||I.showAngleIndicator)&&r.bodyAxes(y,M,T),I.showPositions&&r.bodyPositions(y,M,T),I.showVelocity&&r.bodyVelocity(y,M,T),I.showIds&&r.bodyIds(y,M,T),I.showSeparations&&r.separations(y,_.pairs.list,T),I.showCollisions&&r.collisions(y,_.pairs.list,T),I.showVertexNumbers&&r.vertexNumbers(y,M,T),I.showMousePosition&&r.mousePosition(y,y.mouse,T),r.constraints(z,T),I.hasBounds&&r.endViewTransform(y),l.trigger(y,"afterRender",H),k.lastElapsed=o.now()-C},r.stats=function(y,v,C){for(var _=y.engine,S=_.world,E=s.allBodies(S),T=0,I=55,k=44,O=0,F=0,B=0;B<E.length;B+=1)T+=E[B].parts.length;var M={Part:T,Body:E.length,Cons:s.allConstraints(S).length,Comp:s.allComposites(S).length,Pair:_.pairs.list.length};v.fillStyle="#0e0f19",v.fillRect(O,F,I*5.5,k),v.font="12px Arial",v.textBaseline="top",v.textAlign="right";for(var z in M){var W=M[z];v.fillStyle="#aaa",v.fillText(z,O+I,F+8),v.fillStyle="#eee",v.fillText(W,O+I,F+26),O+=I}},r.performance=function(y,v){var C=y.engine,_=y.timing,S=_.deltaHistory,E=_.elapsedHistory,T=_.timestampElapsedHistory,I=_.engineDeltaHistory,k=_.engineElapsedHistory,O=C.timing.lastDelta,F=m(S),B=m(E),M=m(I),z=m(k),W=m(T),H=W/F||0,Q=1e3/F||0,re=4,oe=12,me=60,ge=34,ye=10,ve=69;v.fillStyle="#0e0f19",v.fillRect(0,50,oe*4+me*5+22,ge),r.status(v,ye,ve,me,re,S.length,Math.round(Q)+" fps",Q/r._goodFps,function(Ne){return S[Ne]/F-1}),r.status(v,ye+oe+me,ve,me,re,I.length,O.toFixed(2)+" dt",r._goodDelta/O,function(Ne){return I[Ne]/M-1}),r.status(v,ye+(oe+me)*2,ve,me,re,k.length,z.toFixed(2)+" ut",1-z/r._goodFps,function(Ne){return k[Ne]/z-1}),r.status(v,ye+(oe+me)*3,ve,me,re,E.length,B.toFixed(2)+" rt",1-B/r._goodFps,function(Ne){return E[Ne]/B-1}),r.status(v,ye+(oe+me)*4,ve,me,re,T.length,H.toFixed(2)+" x",H*H*H,function(Ne){return(T[Ne]/S[Ne]/H||0)-1})},r.status=function(y,v,C,_,S,E,T,I,k){y.strokeStyle="#888",y.fillStyle="#444",y.lineWidth=1,y.fillRect(v,C+7,_,1),y.beginPath(),y.moveTo(v,C+7-S*o.clamp(.4*k(0),-2,2));for(var O=0;O<_;O+=1)y.lineTo(v+O,C+7-(O<E?S*o.clamp(.4*k(O),-2,2):0));y.stroke(),y.fillStyle="hsl("+o.clamp(25+95*I,0,120)+",100%,60%)",y.fillRect(v,C-7,4,4),y.font="12px Arial",y.textBaseline="middle",y.textAlign="right",y.fillStyle="#eee",y.fillText(T,v+_,C-5)},r.constraints=function(y,v){for(var C=v,_=0;_<y.length;_++){var S=y[_];if(!(!S.render.visible||!S.pointA||!S.pointB)){var E=S.bodyA,T=S.bodyB,I,k;if(E?I=u.add(E.position,S.pointA):I=S.pointA,S.render.type==="pin")C.beginPath(),C.arc(I.x,I.y,3,0,2*Math.PI),C.closePath();else{if(T?k=u.add(T.position,S.pointB):k=S.pointB,C.beginPath(),C.moveTo(I.x,I.y),S.render.type==="spring")for(var O=u.sub(k,I),F=u.perp(u.normalise(O)),B=Math.ceil(o.clamp(S.length/5,12,20)),M,z=1;z<B;z+=1)M=z%2===0?1:-1,C.lineTo(I.x+O.x*(z/B)+F.x*M*4,I.y+O.y*(z/B)+F.y*M*4);C.lineTo(k.x,k.y)}S.render.lineWidth&&(C.lineWidth=S.render.lineWidth,C.strokeStyle=S.render.strokeStyle,C.stroke()),S.render.anchors&&(C.fillStyle=S.render.strokeStyle,C.beginPath(),C.arc(I.x,I.y,3,0,2*Math.PI),C.arc(k.x,k.y,3,0,2*Math.PI),C.closePath(),C.fill())}}},r.bodies=function(y,v,C){var _=C,S=y.engine,E=y.options,T=E.showInternalEdges||!E.wireframes,I,k,O,F;for(O=0;O<v.length;O++)if(I=v[O],!!I.render.visible){for(F=I.parts.length>1?1:0;F<I.parts.length;F++)if(k=I.parts[F],!!k.render.visible){if(E.showSleeping&&I.isSleeping?_.globalAlpha=.5*k.render.opacity:k.render.opacity!==1&&(_.globalAlpha=k.render.opacity),k.render.sprite&&k.render.sprite.texture&&!E.wireframes){var B=k.render.sprite,M=x(y,B.texture);_.translate(k.position.x,k.position.y),_.rotate(k.angle),_.drawImage(M,M.width*-B.xOffset*B.xScale,M.height*-B.yOffset*B.yScale,M.width*B.xScale,M.height*B.yScale),_.rotate(-k.angle),_.translate(-k.position.x,-k.position.y)}else{if(k.circleRadius)_.beginPath(),_.arc(k.position.x,k.position.y,k.circleRadius,0,2*Math.PI);else{_.beginPath(),_.moveTo(k.vertices[0].x,k.vertices[0].y);for(var z=1;z<k.vertices.length;z++)!k.vertices[z-1].isInternal||T?_.lineTo(k.vertices[z].x,k.vertices[z].y):_.moveTo(k.vertices[z].x,k.vertices[z].y),k.vertices[z].isInternal&&!T&&_.moveTo(k.vertices[(z+1)%k.vertices.length].x,k.vertices[(z+1)%k.vertices.length].y);_.lineTo(k.vertices[0].x,k.vertices[0].y),_.closePath()}E.wireframes?(_.lineWidth=1,_.strokeStyle="#bbb",_.stroke()):(_.fillStyle=k.render.fillStyle,k.render.lineWidth&&(_.lineWidth=k.render.lineWidth,_.strokeStyle=k.render.strokeStyle,_.stroke()),_.fill())}_.globalAlpha=1}}},r.bodyWireframes=function(y,v,C){var _=C,S=y.options.showInternalEdges,E,T,I,k,O;for(_.beginPath(),I=0;I<v.length;I++)if(E=v[I],!!E.render.visible)for(O=E.parts.length>1?1:0;O<E.parts.length;O++){for(T=E.parts[O],_.moveTo(T.vertices[0].x,T.vertices[0].y),k=1;k<T.vertices.length;k++)!T.vertices[k-1].isInternal||S?_.lineTo(T.vertices[k].x,T.vertices[k].y):_.moveTo(T.vertices[k].x,T.vertices[k].y),T.vertices[k].isInternal&&!S&&_.moveTo(T.vertices[(k+1)%T.vertices.length].x,T.vertices[(k+1)%T.vertices.length].y);_.lineTo(T.vertices[0].x,T.vertices[0].y)}_.lineWidth=1,_.strokeStyle="#bbb",_.stroke()},r.bodyConvexHulls=function(y,v,C){var _=C,S,E,T,I,k;for(_.beginPath(),T=0;T<v.length;T++)if(S=v[T],!(!S.render.visible||S.parts.length===1)){for(_.moveTo(S.vertices[0].x,S.vertices[0].y),I=1;I<S.vertices.length;I++)_.lineTo(S.vertices[I].x,S.vertices[I].y);_.lineTo(S.vertices[0].x,S.vertices[0].y)}_.lineWidth=1,_.strokeStyle="rgba(255,255,255,0.2)",_.stroke()},r.vertexNumbers=function(y,v,C){var _=C,S,E,T;for(S=0;S<v.length;S++){var I=v[S].parts;for(T=I.length>1?1:0;T<I.length;T++){var k=I[T];for(E=0;E<k.vertices.length;E++)_.fillStyle="rgba(255,255,255,0.2)",_.fillText(S+"_"+E,k.position.x+(k.vertices[E].x-k.position.x)*.8,k.position.y+(k.vertices[E].y-k.position.y)*.8)}}},r.mousePosition=function(y,v,C){var _=C;_.fillStyle="rgba(255,255,255,0.8)",_.fillText(v.position.x+"  "+v.position.y,v.position.x+5,v.position.y-5)},r.bodyBounds=function(y,v,C){var _=C,S=y.engine,E=y.options;_.beginPath();for(var T=0;T<v.length;T++){var I=v[T];if(I.render.visible)for(var k=v[T].parts,O=k.length>1?1:0;O<k.length;O++){var F=k[O];_.rect(F.bounds.min.x,F.bounds.min.y,F.bounds.max.x-F.bounds.min.x,F.bounds.max.y-F.bounds.min.y)}}E.wireframes?_.strokeStyle="rgba(255,255,255,0.08)":_.strokeStyle="rgba(0,0,0,0.1)",_.lineWidth=1,_.stroke()},r.bodyAxes=function(y,v,C){var _=C,S=y.engine,E=y.options,T,I,k,O;for(_.beginPath(),I=0;I<v.length;I++){var F=v[I],B=F.parts;if(F.render.visible)if(E.showAxes)for(k=B.length>1?1:0;k<B.length;k++)for(T=B[k],O=0;O<T.axes.length;O++){var M=T.axes[O];_.moveTo(T.position.x,T.position.y),_.lineTo(T.position.x+M.x*20,T.position.y+M.y*20)}else for(k=B.length>1?1:0;k<B.length;k++)for(T=B[k],O=0;O<T.axes.length;O++)_.moveTo(T.position.x,T.position.y),_.lineTo((T.vertices[0].x+T.vertices[T.vertices.length-1].x)/2,(T.vertices[0].y+T.vertices[T.vertices.length-1].y)/2)}E.wireframes?(_.strokeStyle="indianred",_.lineWidth=1):(_.strokeStyle="rgba(255, 255, 255, 0.4)",_.globalCompositeOperation="overlay",_.lineWidth=2),_.stroke(),_.globalCompositeOperation="source-over"},r.bodyPositions=function(y,v,C){var _=C,S=y.engine,E=y.options,T,I,k,O;for(_.beginPath(),k=0;k<v.length;k++)if(T=v[k],!!T.render.visible)for(O=0;O<T.parts.length;O++)I=T.parts[O],_.arc(I.position.x,I.position.y,3,0,2*Math.PI,!1),_.closePath();for(E.wireframes?_.fillStyle="indianred":_.fillStyle="rgba(0,0,0,0.5)",_.fill(),_.beginPath(),k=0;k<v.length;k++)T=v[k],T.render.visible&&(_.arc(T.positionPrev.x,T.positionPrev.y,2,0,2*Math.PI,!1),_.closePath());_.fillStyle="rgba(255,165,0,0.8)",_.fill()},r.bodyVelocity=function(y,v,C){var _=C;_.beginPath();for(var S=0;S<v.length;S++){var E=v[S];if(E.render.visible){var T=i.getVelocity(E);_.moveTo(E.position.x,E.position.y),_.lineTo(E.position.x+T.x,E.position.y+T.y)}}_.lineWidth=3,_.strokeStyle="cornflowerblue",_.stroke()},r.bodyIds=function(y,v,C){var _=C,S,E;for(S=0;S<v.length;S++)if(v[S].render.visible){var T=v[S].parts;for(E=T.length>1?1:0;E<T.length;E++){var I=T[E];_.font="12px Arial",_.fillStyle="rgba(255,255,255,0.5)",_.fillText(I.id,I.position.x+10,I.position.y-10)}}},r.collisions=function(y,v,C){var _=C,S=y.options,E,T,I,k,O,F,B;for(_.beginPath(),F=0;F<v.length;F++)if(E=v[F],!!E.isActive)for(T=E.collision,B=0;B<E.activeContacts.length;B++){var M=E.activeContacts[B],z=M.vertex;_.rect(z.x-1.5,z.y-1.5,3.5,3.5)}for(S.wireframes?_.fillStyle="rgba(255,255,255,0.7)":_.fillStyle="orange",_.fill(),_.beginPath(),F=0;F<v.length;F++)if(E=v[F],!!E.isActive&&(T=E.collision,E.activeContacts.length>0)){var W=E.activeContacts[0].vertex.x,H=E.activeContacts[0].vertex.y;E.activeContacts.length===2&&(W=(E.activeContacts[0].vertex.x+E.activeContacts[1].vertex.x)/2,H=(E.activeContacts[0].vertex.y+E.activeContacts[1].vertex.y)/2),T.bodyB===T.supports[0].body||T.bodyA.isStatic===!0?_.moveTo(W-T.normal.x*8,H-T.normal.y*8):_.moveTo(W+T.normal.x*8,H+T.normal.y*8),_.lineTo(W,H)}S.wireframes?_.strokeStyle="rgba(255,165,0,0.7)":_.strokeStyle="orange",_.lineWidth=1,_.stroke()},r.separations=function(y,v,C){var _=C,S=y.options,E,T,I,k,O,F,B;for(_.beginPath(),F=0;F<v.length;F++)if(E=v[F],!!E.isActive){T=E.collision,k=T.bodyA,O=T.bodyB;var M=1;!O.isStatic&&!k.isStatic&&(M=.5),O.isStatic&&(M=0),_.moveTo(O.position.x,O.position.y),_.lineTo(O.position.x-T.penetration.x*M,O.position.y-T.penetration.y*M),M=1,!O.isStatic&&!k.isStatic&&(M=.5),k.isStatic&&(M=0),_.moveTo(k.position.x,k.position.y),_.lineTo(k.position.x+T.penetration.x*M,k.position.y+T.penetration.y*M)}S.wireframes?_.strokeStyle="rgba(255,165,0,0.5)":_.strokeStyle="orange",_.stroke()},r.inspector=function(y,v){var C=y.engine,_=y.selected,S=y.render,E=S.options,T;if(E.hasBounds){var I=S.bounds.max.x-S.bounds.min.x,k=S.bounds.max.y-S.bounds.min.y,O=I/S.options.width,F=k/S.options.height;v.scale(1/O,1/F),v.translate(-S.bounds.min.x,-S.bounds.min.y)}for(var B=0;B<_.length;B++){var M=_[B].data;switch(v.translate(.5,.5),v.lineWidth=1,v.strokeStyle="rgba(255,165,0,0.9)",v.setLineDash([1,2]),M.type){case"body":T=M.bounds,v.beginPath(),v.rect(Math.floor(T.min.x-3),Math.floor(T.min.y-3),Math.floor(T.max.x-T.min.x+6),Math.floor(T.max.y-T.min.y+6)),v.closePath(),v.stroke();break;case"constraint":var z=M.pointA;M.bodyA&&(z=M.pointB),v.beginPath(),v.arc(z.x,z.y,10,0,2*Math.PI),v.closePath(),v.stroke();break}v.setLineDash([]),v.translate(-.5,-.5)}y.selectStart!==null&&(v.translate(.5,.5),v.lineWidth=1,v.strokeStyle="rgba(255,165,0,0.6)",v.fillStyle="rgba(255,165,0,0.1)",T=y.selectBounds,v.beginPath(),v.rect(Math.floor(T.min.x),Math.floor(T.min.y),Math.floor(T.max.x-T.min.x),Math.floor(T.max.y-T.min.y)),v.closePath(),v.stroke(),v.fill(),v.translate(-.5,-.5)),E.hasBounds&&v.setTransform(1,0,0,1,0,0)};var p=function(y,v){var C=y.engine,_=y.timing,S=_.historySize,E=C.timing.timestamp;_.delta=v-_.lastTime||r._goodDelta,_.lastTime=v,_.timestampElapsed=E-_.lastTimestamp||0,_.lastTimestamp=E,_.deltaHistory.unshift(_.delta),_.deltaHistory.length=Math.min(_.deltaHistory.length,S),_.engineDeltaHistory.unshift(C.timing.lastDelta),_.engineDeltaHistory.length=Math.min(_.engineDeltaHistory.length,S),_.timestampElapsedHistory.unshift(_.timestampElapsed),_.timestampElapsedHistory.length=Math.min(_.timestampElapsedHistory.length,S),_.engineElapsedHistory.unshift(C.timing.lastElapsed),_.engineElapsedHistory.length=Math.min(_.engineElapsedHistory.length,S),_.elapsedHistory.unshift(_.lastElapsed),_.elapsedHistory.length=Math.min(_.elapsedHistory.length,S)},m=function(y){for(var v=0,C=0;C<y.length;C+=1)v+=y[C];return v/y.length||0},h=function(y,v){var C=document.createElement("canvas");return C.width=y,C.height=v,C.oncontextmenu=function(){return!1},C.onselectstart=function(){return!1},C},g=function(y){var v=y.getContext("2d"),C=window.devicePixelRatio||1,_=v.webkitBackingStorePixelRatio||v.mozBackingStorePixelRatio||v.msBackingStorePixelRatio||v.oBackingStorePixelRatio||v.backingStorePixelRatio||1;return C/_},x=function(y,v){var C=y.textures[v];return C||(C=y.textures[v]=new Image,C.src=v,C)},b=function(y,v){var C=v;/(jpg|gif|png)$/.test(v)&&(C="url("+v+")"),y.canvas.style.background=C,y.canvas.style.backgroundSize="contain",y.currentBackground=v}})()},function(e,t,n){var r={};e.exports=r;var i=n(5),o=n(17),s=n(0);(function(){var a,l;if(typeof window<"u"&&(a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,l=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!a){var u;a=function(c){u=setTimeout(function(){c(s.now())},1e3/60)},l=function(){clearTimeout(u)}}r.create=function(c){var f={fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},d=s.extend(f,c);return d.delta=d.delta||1e3/d.fps,d.deltaMin=d.deltaMin||1e3/d.fps,d.deltaMax=d.deltaMax||1e3/(d.fps*.5),d.fps=1e3/d.delta,d},r.run=function(c,f){return typeof c.positionIterations<"u"&&(f=c,c=r.create()),function d(p){c.frameRequestId=a(d),p&&c.enabled&&r.tick(c,f,p)}(),c},r.tick=function(c,f,d){var p=f.timing,m;c.isFixed?m=c.delta:(m=d-c.timePrev||c.delta,c.timePrev=d,c.deltaHistory.push(m),c.deltaHistory=c.deltaHistory.slice(-c.deltaSampleSize),m=Math.min.apply(null,c.deltaHistory),m=m<c.deltaMin?c.deltaMin:m,m=m>c.deltaMax?c.deltaMax:m,c.delta=m);var h={timestamp:p.timestamp};i.trigger(c,"beforeTick",h),c.frameCounter+=1,d-c.counterTimestamp>=1e3&&(c.fps=c.frameCounter*((d-c.counterTimestamp)/1e3),c.counterTimestamp=d,c.frameCounter=0),i.trigger(c,"tick",h),i.trigger(c,"beforeUpdate",h),o.update(f,m),i.trigger(c,"afterUpdate",h),i.trigger(c,"afterTick",h)},r.stop=function(c){l(c.frameRequestId)},r.start=function(c,f){r.run(c,f)}})()},function(e,t,n){var r={};e.exports=r;var i=n(8),o=n(0),s=o.deprecated;(function(){r.collides=function(a,l){return i.collides(a,l)},s(r,"collides","SAT.collides \u27A4 replaced by Collision.collides")})()},function(e,t,n){var r={};e.exports=r;var i=n(1),o=n(0);(function(){r.pathToVertices=function(s,a){typeof window<"u"&&!("SVGPathSeg"in window)&&o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var l,u,c,f,d,p,m,h,g,x,b=[],y,v,C=0,_=0,S=0;a=a||15;var E=function(I,k,O){var F=O%2===1&&O>1;if(!g||I!=g.x||k!=g.y){g&&F?(y=g.x,v=g.y):(y=0,v=0);var B={x:y+I,y:v+k};(F||!g)&&(g=B),b.push(B),_=y+I,S=v+k}},T=function(I){var k=I.pathSegTypeAsLetter.toUpperCase();if(k!=="Z"){switch(k){case"M":case"L":case"T":case"C":case"S":case"Q":_=I.x,S=I.y;break;case"H":_=I.x;break;case"V":S=I.y;break}E(_,S,I.pathSegType)}};for(r._svgPathToAbsolute(s),c=s.getTotalLength(),p=[],l=0;l<s.pathSegList.numberOfItems;l+=1)p.push(s.pathSegList.getItem(l));for(m=p.concat();C<c;){if(x=s.getPathSegAtLength(C),d=p[x],d!=h){for(;m.length&&m[0]!=d;)T(m.shift());h=d}switch(d.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":f=s.getPointAtLength(C),E(f.x,f.y,0);break}C+=a}for(l=0,u=m.length;l<u;++l)T(m[l]);return b},r._svgPathToAbsolute=function(s){for(var a,l,u,c,f,d,p=s.pathSegList,m=0,h=0,g=p.numberOfItems,x=0;x<g;++x){var b=p.getItem(x),y=b.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(y))"x"in b&&(m=b.x),"y"in b&&(h=b.y);else switch("x1"in b&&(u=m+b.x1),"x2"in b&&(f=m+b.x2),"y1"in b&&(c=h+b.y1),"y2"in b&&(d=h+b.y2),"x"in b&&(m+=b.x),"y"in b&&(h+=b.y),y){case"m":p.replaceItem(s.createSVGPathSegMovetoAbs(m,h),x);break;case"l":p.replaceItem(s.createSVGPathSegLinetoAbs(m,h),x);break;case"h":p.replaceItem(s.createSVGPathSegLinetoHorizontalAbs(m),x);break;case"v":p.replaceItem(s.createSVGPathSegLinetoVerticalAbs(h),x);break;case"c":p.replaceItem(s.createSVGPathSegCurvetoCubicAbs(m,h,u,c,f,d),x);break;case"s":p.replaceItem(s.createSVGPathSegCurvetoCubicSmoothAbs(m,h,f,d),x);break;case"q":p.replaceItem(s.createSVGPathSegCurvetoQuadraticAbs(m,h,u,c),x);break;case"t":p.replaceItem(s.createSVGPathSegCurvetoQuadraticSmoothAbs(m,h),x);break;case"a":p.replaceItem(s.createSVGPathSegArcAbs(m,h,b.r1,b.r2,b.angle,b.largeArcFlag,b.sweepFlag),x);break;case"z":case"Z":m=a,h=l;break}(y=="M"||y=="m")&&(a=m,l=h)}}})()},function(e,t,n){var r={};e.exports=r;var i=n(6),o=n(0);(function(){r.create=i.create,r.add=i.add,r.remove=i.remove,r.clear=i.clear,r.addComposite=i.addComposite,r.addBody=i.addBody,r.addConstraint=i.addConstraint})()}])})});var $ee=class{};var LA=class e{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),o=i.toLowerCase(),s=n.slice(r+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){let n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){let n=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(t.name,n);let i=(t.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let o=t.value;if(!o)this.headers.delete(n),this.normalizedNames.delete(n);else{let s=this.headers.get(n);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}break}}setHeaderEntries(t,n){let r=(Array.isArray(n)?n:[n]).map(o=>o.toString()),i=t.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(t,i)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}};var Pee=class{encodeKey(t){return JEe(t)}encodeValue(t){return JEe(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function TCt(e,t){let n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[s,a]=o==-1?[t.decodeKey(i),""]:[t.decodeKey(i.slice(0,o)),t.decodeValue(i.slice(o+1))],l=n.get(s)||[];l.push(a),n.set(s,l)}),n}var kCt=/%(\d[a-f0-9])/gi,ICt={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function JEe(e){return encodeURIComponent(e).replace(kCt,(t,n)=>ICt[n]??t)}function x5(e){return`${e}`}var Dy=class e{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Pee,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=TCt(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{let r=t.fromObject[n],i=Array.isArray(r)?r.map(x5):[x5(r)];this.map.set(n,i)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){let n=[];return Object.keys(t).forEach(r=>{let i=t[r];Array.isArray(i)?i.forEach(o=>{n.push({param:r,value:o,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let n=this.encoder.encodeKey(t);return this.map.get(t).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let n=(t.op==="a"?this.map.get(t.param):void 0)||[];n.push(x5(t.value)),this.map.set(t.param,n);break;case"d":if(t.value!==void 0){let r=this.map.get(t.param)||[],i=r.indexOf(x5(t.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var Lee=class{constructor(){this.map=new Map}set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function DCt(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function e2e(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function t2e(e){return typeof Blob<"u"&&e instanceof Blob}function n2e(e){return typeof FormData<"u"&&e instanceof FormData}function NCt(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var SR=class e{constructor(t,n,r,i){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase();let o;if(DCt(this.method)||i?(this.body=r!==void 0?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new LA,this.context??=new Lee,!this.params)this.params=new Dy,this.urlWithParams=n;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),l=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+l+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||e2e(this.body)||t2e(this.body)||n2e(this.body)||NCt(this.body)?this.body:this.body instanceof Dy?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||n2e(this.body)?null:t2e(this.body)?this.body.type||null:e2e(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Dy?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(t={}){let n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,o=t.transferCache??this.transferCache,s=t.body!==void 0?t.body:this.body,a=t.withCredentials??this.withCredentials,l=t.reportProgress??this.reportProgress,u=t.headers||this.headers,c=t.params||this.params,f=t.context??this.context;return t.setHeaders!==void 0&&(u=Object.keys(t.setHeaders).reduce((d,p)=>d.set(p,t.setHeaders[p]),u)),t.setParams&&(c=Object.keys(t.setParams).reduce((d,p)=>d.set(p,t.setParams[p]),c)),new e(n,r,s,{params:c,headers:u,context:f,reportProgress:l,responseType:i,withCredentials:a,transferCache:o})}},r2e=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(r2e||{}),Bee=class{constructor(t,n=200,r="OK"){this.headers=t.headers||new LA,this.status=t.status!==void 0?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}};var zee=class e extends Bee{constructor(t={}){super(t),this.type=r2e.Response,this.body=t.body!==void 0?t.body:null}clone(t={}){return new e({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}};function Mee(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}var i2e=(()=>{let t=class t{constructor(r){this.handler=r}request(r,i,o={}){let s;if(r instanceof SR)s=r;else{let u;o.headers instanceof LA?u=o.headers:u=new LA(o.headers);let c;o.params&&(o.params instanceof Dy?c=o.params:c=new Dy({fromObject:o.params})),s=new SR(r,i,o.body!==void 0?o.body:null,{headers:u,context:o.context,params:c,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache})}let a=Nt(s).pipe(sC(u=>this.handler.handle(u)));if(r instanceof SR||o.observe==="events")return a;let l=a.pipe(go(u=>u instanceof zee));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(on(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return l.pipe(on(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return l.pipe(on(u=>{if(u.body!==null&&typeof u.body!="string")throw new Error("Response is not a string.");return u.body}));case"json":default:return l.pipe(on(u=>u.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Dy().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,o={}){return this.request("PATCH",r,Mee(o,i))}post(r,i,o={}){return this.request("POST",r,Mee(o,i))}put(r,i,o={}){return this.request("PUT",r,Mee(o,i))}};t.\u0275fac=function(i){return new(i||t)(Oe($ee))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})();var Vee=class extends HEe{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Wee=class e extends Vee{static makeCurrent(){qEe(new e)}onAndCancel(t,n,r){return t.addEventListener(n,r),()=>{t.removeEventListener(n,r)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return n=n||this.getDefaultDocument(),n.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return n==="window"?window:n==="document"?t:n==="body"?t.body:null}getBaseHref(t){let n=OCt();return n==null?null:MCt(n)}resetBaseElement(){ER=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return YEe(document.cookie,t)}},ER=null;function OCt(){return ER=ER||document.querySelector("base"),ER?ER.getAttribute("href"):null}function MCt(e){return new URL(e,document.baseURI).pathname}var $Ct=(()=>{let t=class t{build(){return new XMLHttpRequest}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})(),Gee=new kn(""),u2e=(()=>{let t=class t{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(o=>{o.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,o){return this._findPluginFor(i).addEventListener(r,i,o)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(s=>s.supports(r)),!i)throw new Fi(5101,!1);return this._eventNameToPlugin.set(r,i),i}};t.\u0275fac=function(i){return new(i||t)(Oe(Gee),Oe(vn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})(),b5=class{constructor(t){this._doc=t}},Uee="ng-app-id",c2e=(()=>{let t=class t{constructor(r,i,o,s={}){this.doc=r,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Oee(s),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(o=>o.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Uee}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(o=>{o.textContent!=null&&i.set(o.textContent,o)}),i}return null}changeUsageCount(r,i){let o=this.styleRef;if(o.has(r)){let s=o.get(r);return s.usage+=i,s.usage}return o.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===r)return o.delete(i),s.removeAttribute(Uee),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Uee,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let o=this.getStyleElement(r,i),s=this.styleRef,a=s.get(i)?.elements;a?a.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};t.\u0275fac=function(i){return new(i||t)(Oe(dn),Oe(d5),Oe(yR,8),Oe(cC))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})(),jee={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Hee=/%COMP%/g,f2e="%COMP%",PCt=`_nghost-${f2e}`,LCt=`_ngcontent-${f2e}`,BCt=!0,zCt=new kn("",{providedIn:"root",factory:()=>BCt});function UCt(e){return LCt.replace(Hee,e)}function jCt(e){return PCt.replace(Hee,e)}function d2e(e,t){return t.map(n=>n.replace(Hee,e))}var y5=(()=>{let t=class t{constructor(r,i,o,s,a,l,u,c=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=l,this.ngZone=u,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=Oee(l),this.defaultRenderer=new AR(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===hR.ShadowDom&&(i=Qi(Ze({},i),{encapsulation:hR.Emulated}));let o=this.getOrCreateRenderer(r,i);return o instanceof v5?o.applyToHost(r):o instanceof TR&&o.applyStyles(),o}getOrCreateRenderer(r,i){let o=this.rendererByCompId,s=o.get(i.id);if(!s){let a=this.doc,l=this.ngZone,u=this.eventManager,c=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case hR.Emulated:s=new v5(u,c,i,this.appId,f,a,l,d);break;case hR.ShadowDom:return new qee(u,c,r,i,a,l,this.nonce,d);default:s=new TR(u,c,i,f,a,l,d);break}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};t.\u0275fac=function(i){return new(i||t)(Oe(u2e),Oe(c2e),Oe(d5),Oe(zCt),Oe(dn),Oe(cC),Oe(vn),Oe(yR))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})(),AR=class{constructor(t,n,r,i){this.eventManager=t,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,n){return n?this.doc.createElementNS(jee[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(o2e(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(o2e(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new Fi(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,i){if(i){n=i+":"+n;let o=jee[i];o?t.setAttributeNS(o,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){let i=jee[r];i?t.removeAttributeNS(i,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,i){i&(vR.DashCase|vR.Important)?t.style.setProperty(n,r,i&vR.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&vR.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t!=null&&(t[n]=r)}setValue(t,n){t.nodeValue=n}listen(t,n,r){if(typeof t=="string"&&(t=Ree().getGlobalEventTarget(this.doc,t),!t))throw new Error(`Unsupported event target ${t} for event ${n}`);return this.eventManager.addEventListener(t,n,this.decoratePreventDefault(r))}decoratePreventDefault(t){return n=>{if(n==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))===!1&&n.preventDefault()}}};function o2e(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var qee=class extends AR{constructor(t,n,r,i,o,s,a,l){super(t,o,s,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=d2e(i.id,i.styles);for(let c of u){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=c,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},TR=class extends AR{constructor(t,n,r,i,o,s,a,l){super(t,o,s,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=l?d2e(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},v5=class extends TR{constructor(t,n,r,i,o,s,a,l){let u=i+"-"+r.id;super(t,n,r,o,s,a,l,u),this.contentAttr=UCt(u),this.hostAttr=jCt(u)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){let r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}},VCt=(()=>{let t=class t extends b5{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,o){return r.addEventListener(i,o,!1),()=>this.removeEventListener(r,i,o)}removeEventListener(r,i,o){return r.removeEventListener(i,o)}};t.\u0275fac=function(i){return new(i||t)(Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})(),s2e=["alt","control","meta","shift"],WCt={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},GCt={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},qCt=(()=>{let t=class t extends b5{constructor(r){super(r)}supports(r){return t.parseEventName(r)!=null}addEventListener(r,i,o){let s=t.parseEventName(i),a=t.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ree().onAndCancel(r,s.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let s=t._normalizeKey(i.pop()),a="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),a="code."),s2e.forEach(c=>{let f=i.indexOf(c);f>-1&&(i.splice(f,1),a+=c+".")}),a+=s,i.length!=0||s.length===0)return null;let u={};return u.domEventName=o,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let o=WCt[r.key]||r.key,s="";return i.indexOf("code.")>-1&&(o=r.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),s2e.forEach(a=>{if(a!==o){let l=GCt[a];l(r)&&(s+=a+".")}}),s+=o,s===i)}static eventCallback(r,i,o){return s=>{t.matchEventFullKeyCode(s,r)&&o.runGuarded(()=>i(s))}}static _normalizeKey(r){return r==="esc"?"escape":r}};t.\u0275fac=function(i){return new(i||t)(Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})();function p2e(e,t){return WEe(Ze({rootComponent:e},HCt(t)))}function HCt(e){return{appProviders:[...QCt,...e?.providers??[]],platformProviders:ZCt}}function YCt(){Wee.makeCurrent()}function KCt(){return new uC}function XCt(){return CEe(document),document}var ZCt=[{provide:cC,useValue:XEe},{provide:_Ee,useValue:YCt,multi:!0},{provide:dn,useFactory:XCt,deps:[]}];var QCt=[{provide:wEe,useValue:"root"},{provide:uC,useFactory:KCt,deps:[]},{provide:Gee,useClass:VCt,multi:!0,deps:[dn,vn,cC]},{provide:Gee,useClass:qCt,multi:!0,deps:[dn]},y5,c2e,u2e,{provide:m5,useExisting:y5},{provide:QEe,useClass:$Ct,deps:[]},[]];var m2e=(()=>{let t=class t{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};t.\u0275fac=function(i){return new(i||t)(Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Yee=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:function(i){let o=null;return i?o=new(i||t):o=Oe(JCt),o},providedIn:"root"});let e=t;return e})(),JCt=(()=>{let t=class t extends Yee{constructor(r){super(),this._doc=r}sanitize(r,i){if(i==null)return null;switch(r){case rc.NONE:return i;case rc.HTML:return NA(i,"HTML")?DA(i):DEe(this._doc,String(i)).toString();case rc.STYLE:return NA(i,"Style")?DA(i):i;case rc.SCRIPT:if(NA(i,"Script"))return DA(i);throw new Fi(5200,!1);case rc.URL:return NA(i,"URL")?DA(i):IEe(String(i));case rc.RESOURCE_URL:if(NA(i,"ResourceURL"))return DA(i);throw new Fi(5201,!1);default:throw new Fi(5202,!1)}}bypassSecurityTrustHtml(r){return SEe(r)}bypassSecurityTrustStyle(r){return EEe(r)}bypassSecurityTrustScript(r){return AEe(r)}bypassSecurityTrustUrl(r){return TEe(r)}bypassSecurityTrustResourceUrl(r){return kEe(r)}};t.\u0275fac=function(i){return new(i||t)(Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var pn="primary",WR=Symbol("RouteTitle"),Jee=class{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){let n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function WA(e){return new Jee(e)}function t_t(e,t,n){let r=n.path.split("/");if(r.length>e.length||n.pathMatch==="full"&&(t.hasChildren()||r.length<e.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=e[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function n_t(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!_m(e[n],t[n]))return!1;return!0}function _m(e,t){let n=e?ete(e):void 0,r=t?ete(t):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!_2e(e[i],t[i]))return!1;return!0}function ete(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function _2e(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;let n=[...e].sort(),r=[...t].sort();return n.every((i,o)=>r[o]===i)}else return e===t}function S2e(e){return e.length>0?e[e.length-1]:null}function Fy(e){return Eee(e)?e:UEe(e)?of(Promise.resolve(e)):Nt(e)}var r_t={exact:A2e,subset:T2e},E2e={exact:i_t,subset:o_t,ignored:()=>!0};function g2e(e,t,n){return r_t[n.paths](e.root,t.root,n.matrixParams)&&E2e[n.queryParams](e.queryParams,t.queryParams)&&!(n.fragment==="exact"&&e.fragment!==t.fragment)}function i_t(e,t){return _m(e,t)}function A2e(e,t,n){if(!gC(e.segments,t.segments)||!_5(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!e.children[r]||!A2e(e.children[r],t.children[r],n))return!1;return!0}function o_t(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>_2e(e[n],t[n]))}function T2e(e,t,n){return k2e(e,t,t.segments,n)}function k2e(e,t,n,r){if(e.segments.length>n.length){let i=e.segments.slice(0,n.length);return!(!gC(i,n)||t.hasChildren()||!_5(i,n,r))}else if(e.segments.length===n.length){if(!gC(e.segments,n)||!_5(e.segments,n,r))return!1;for(let i in t.children)if(!e.children[i]||!T2e(e.children[i],t.children[i],r))return!1;return!0}else{let i=n.slice(0,e.segments.length),o=n.slice(e.segments.length);return!gC(e.segments,i)||!_5(e.segments,i,r)||!e.children[pn]?!1:k2e(e.children[pn],t,o,r)}}function _5(e,t,n){return t.every((r,i)=>E2e[n](e[i].parameters,r.parameters))}var Ny=class{constructor(t=new pr([],{}),n={},r=null){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=WA(this.queryParams),this._queryParamMap}toString(){return l_t.serialize(this)}},pr=class{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return S5(this)}},hC=class{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap??=WA(this.parameters),this._parameterMap}toString(){return D2e(this)}};function s_t(e,t){return gC(e,t)&&e.every((n,r)=>_m(n.parameters,t[r].parameters))}function gC(e,t){return e.length!==t.length?!1:e.every((n,r)=>n.path===t[r].path)}function a_t(e,t){let n=[];return Object.entries(e.children).forEach(([r,i])=>{r===pn&&(n=n.concat(t(i,r)))}),Object.entries(e.children).forEach(([r,i])=>{r!==pn&&(n=n.concat(t(i,r)))}),n}var Ate=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:()=>new OR,providedIn:"root"});let e=t;return e})(),OR=class{parse(t){let n=new nte(t);return new Ny(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){let n=`/${kR(t.root,!0)}`,r=f_t(t.queryParams),i=typeof t.fragment=="string"?`#${u_t(t.fragment)}`:"";return`${n}${r}${i}`}},l_t=new OR;function S5(e){return e.segments.map(t=>D2e(t)).join("/")}function kR(e,t){if(!e.hasChildren())return S5(e);if(t){let n=e.children[pn]?kR(e.children[pn],!1):"",r=[];return Object.entries(e.children).forEach(([i,o])=>{i!==pn&&r.push(`${i}:${kR(o,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=a_t(e,(r,i)=>i===pn?[kR(e.children[pn],!1)]:[`${i}:${kR(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[pn]!=null?`${S5(e)}/${n[0]}`:`${S5(e)}/(${n.join("//")})`}}function I2e(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function w5(e){return I2e(e).replace(/%3B/gi,";")}function u_t(e){return encodeURI(e)}function tte(e){return I2e(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function E5(e){return decodeURIComponent(e)}function x2e(e){return E5(e.replace(/\+/g,"%20"))}function D2e(e){return`${tte(e.path)}${c_t(e.parameters)}`}function c_t(e){return Object.entries(e).map(([t,n])=>`;${tte(t)}=${tte(n)}`).join("")}function f_t(e){let t=Object.entries(e).map(([n,r])=>Array.isArray(r)?r.map(i=>`${w5(n)}=${w5(i)}`).join("&"):`${w5(n)}=${w5(r)}`).filter(n=>n);return t.length?`?${t.join("&")}`:""}var d_t=/^[^\/()?;#]+/;function Kee(e){let t=e.match(d_t);return t?t[0]:""}var p_t=/^[^\/()?;=#]+/;function m_t(e){let t=e.match(p_t);return t?t[0]:""}var h_t=/^[^=?&#]+/;function g_t(e){let t=e.match(h_t);return t?t[0]:""}var x_t=/^[^&#]+/;function b_t(e){let t=e.match(x_t);return t?t[0]:""}var nte=class{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new pr([],{}):new pr([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[pn]=new pr(t,n)),r}parseSegment(){let t=Kee(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new Fi(4009,!1);return this.capture(t),new hC(E5(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let n=m_t(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Kee(this.remaining);i&&(r=i,this.capture(r))}t[E5(n)]=E5(r)}parseQueryParam(t){let n=g_t(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let s=b_t(this.remaining);s&&(r=s,this.capture(r))}let i=x2e(n),o=x2e(r);if(t.hasOwnProperty(i)){let s=t[i];Array.isArray(s)||(s=[s],t[i]=s),s.push(o)}else t[i]=o}parseParens(t){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Kee(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Fi(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=pn);let s=this.parseChildren();n[o]=Object.keys(s).length===1?s[pn]:new pr([],s),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new Fi(4011,!1)}};function N2e(e){return e.segments.length>0?new pr([],{[pn]:e}):e}function F2e(e){let t={};for(let[r,i]of Object.entries(e.children)){let o=F2e(i);if(r===pn&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))t[s]=a;else(o.segments.length>0||o.hasChildren())&&(t[r]=o)}let n=new pr(e.segments,t);return y_t(n)}function y_t(e){if(e.numberOfChildren===1&&e.children[pn]){let t=e.children[pn];return new pr(e.segments.concat(t.segments),t.children)}return e}function MR(e){return e instanceof Ny}function v_t(e,t,n=null,r=null){let i=R2e(e);return O2e(i,t,n,r)}function R2e(e){let t;function n(o){let s={};for(let l of o.children){let u=n(l);s[l.outlet]=u}let a=new pr(o.url,s);return o===e&&(t=a),a}let r=n(e.root),i=N2e(r);return t??i}function O2e(e,t,n,r){let i=e;for(;i.parent;)i=i.parent;if(t.length===0)return Xee(i,i,i,n,r);let o=w_t(t);if(o.toRoot())return Xee(i,i,new pr([],{}),n,r);let s=C_t(o,i,e),a=s.processChildren?NR(s.segmentGroup,s.index,o.commands):$2e(s.segmentGroup,s.index,o.commands);return Xee(i,s.segmentGroup,a,n,r)}function A5(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function $R(e){return typeof e=="object"&&e!=null&&e.outlets}function Xee(e,t,n,r,i){let o={};r&&Object.entries(r).forEach(([l,u])=>{o[l]=Array.isArray(u)?u.map(c=>`${c}`):`${u}`});let s;e===t?s=n:s=M2e(e,t,n);let a=N2e(F2e(s));return new Ny(a,o,i)}function M2e(e,t,n){let r={};return Object.entries(e.children).forEach(([i,o])=>{o===t?r[i]=n:r[i]=M2e(o,t,n)}),new pr(e.segments,r)}var T5=class{constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&A5(r[0]))throw new Fi(4003,!1);let i=r.find($R);if(i&&i!==S2e(r))throw new Fi(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function w_t(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new T5(!0,0,e);let t=0,n=!1,r=e.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,u])=>{a[l]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?n=!0:a===".."?t++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new T5(n,t,r)}var UA=class{constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}};function C_t(e,t,n){if(e.isAbsolute)return new UA(t,!0,0);if(!n)return new UA(t,!1,NaN);if(n.parent===null)return new UA(n,!0,0);let r=A5(e.commands[0])?0:1,i=n.segments.length-1+r;return __t(n,i,e.numberOfDoubleDots)}function __t(e,t,n){let r=e,i=t,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Fi(4005,!1);i=r.segments.length}return new UA(r,!1,i-o)}function S_t(e){return $R(e[0])?e[0].outlets:{[pn]:e}}function $2e(e,t,n){if(e??=new pr([],{}),e.segments.length===0&&e.hasChildren())return NR(e,t,n);let r=E_t(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let o=new pr(e.segments.slice(0,r.pathIndex),{});return o.children[pn]=new pr(e.segments.slice(r.pathIndex),e.children),NR(o,0,i)}else return r.match&&i.length===0?new pr(e.segments,{}):r.match&&!e.hasChildren()?rte(e,t,n):r.match?NR(e,0,i):rte(e,t,n)}function NR(e,t,n){if(n.length===0)return new pr(e.segments,{});{let r=S_t(n),i={};if(Object.keys(r).some(o=>o!==pn)&&e.children[pn]&&e.numberOfChildren===1&&e.children[pn].segments.length===0){let o=NR(e.children[pn],t,n);return new pr(e.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=$2e(e.children[o],t,s))}),Object.entries(e.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new pr(e.segments,i)}}function E_t(e,t,n){let r=0,i=t,o={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=n.length)return o;let s=e.segments[i],a=n[r];if($R(a))break;let l=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!y2e(l,u,s))return o;r+=2}else{if(!y2e(l,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function rte(e,t,n){let r=e.segments.slice(0,t),i=0;for(;i<n.length;){let o=n[i];if($R(o)){let l=A_t(o.outlets);return new pr(r,l)}if(i===0&&A5(n[0])){let l=e.segments[t];r.push(new hC(l.path,b2e(n[0]))),i++;continue}let s=$R(o)?o.outlets[pn]:`${o}`,a=i<n.length-1?n[i+1]:null;s&&a&&A5(a)?(r.push(new hC(s,b2e(a))),i+=2):(r.push(new hC(s,{})),i++)}return new pr(r,{})}function A_t(e){let t={};return Object.entries(e).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[n]=rte(new pr([],{}),0,r))}),t}function b2e(e){let t={};return Object.entries(e).forEach(([n,r])=>t[n]=`${r}`),t}function y2e(e,t,n){return e==n.path&&_m(t,n.parameters)}var FR="imperative",Us=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(Us||{}),pf=class{constructor(t,n){this.id=t,this.url=n}},PR=class extends pf{constructor(t,n,r="imperative",i=null){super(t,n),this.type=Us.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},xC=class extends pf{constructor(t,n,r){super(t,n),this.urlAfterRedirects=r,this.type=Us.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ac=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(ac||{}),ite=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(ite||{}),N0=class extends pf{constructor(t,n,r,i){super(t,n),this.reason=r,this.code=i,this.type=Us.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},bC=class extends pf{constructor(t,n,r,i){super(t,n),this.reason=r,this.code=i,this.type=Us.NavigationSkipped}},LR=class extends pf{constructor(t,n,r,i){super(t,n),this.error=r,this.target=i,this.type=Us.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},k5=class extends pf{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i,this.type=Us.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ote=class extends pf{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i,this.type=Us.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ste=class extends pf{constructor(t,n,r,i,o){super(t,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=Us.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ate=class extends pf{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i,this.type=Us.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lte=class extends pf{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i,this.type=Us.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ute=class{constructor(t){this.route=t,this.type=Us.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},cte=class{constructor(t){this.route=t,this.type=Us.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},fte=class{constructor(t){this.snapshot=t,this.type=Us.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dte=class{constructor(t){this.snapshot=t,this.type=Us.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pte=class{constructor(t){this.snapshot=t,this.type=Us.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mte=class{constructor(t){this.snapshot=t,this.type=Us.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var BR=class{},GA=class{constructor(t,n){this.url=t,this.navigationBehaviorOptions=n}};var hte=class{constructor(t){this.injector=t,this.outlet=null,this.route=null,this.children=new M5(this.injector),this.attachRef=null}},M5=(()=>{let t=class t{constructor(r){this.parentInjector=r,this.contexts=new Map}onChildOutletCreated(r,i){let o=this.getOrCreateContext(r);o.outlet=i,this.contexts.set(r,o)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new hte(this.parentInjector),this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};t.\u0275fac=function(i){return new(i||t)(Oe(lC))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),I5=class{constructor(t){this._root=t}get root(){return this._root.value}parent(t){let n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){let n=gte(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){let n=gte(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){let n=xte(t,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==t)}pathFromRoot(t){return xte(t,this._root).map(n=>n.value)}};function gte(e,t){if(e===t.value)return t;for(let n of t.children){let r=gte(e,n);if(r)return r}return null}function xte(e,t){if(e===t.value)return[t];for(let n of t.children){let r=xte(e,n);if(r.length)return r.unshift(t),r}return[]}var sc=class{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}};function zA(e){let t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}var D5=class extends I5{constructor(t,n){super(t),this.snapshot=n,Tte(this,t)}toString(){return this.snapshot.toString()}};function P2e(e){let t=T_t(e),n=new os([new hC("",{})]),r=new os({}),i=new os({}),o=new os({}),s=new os(""),a=new qA(n,r,o,s,i,pn,e,t.root);return a.snapshot=t.root,new D5(new sc(a,[]),t)}function T_t(e){let t={},n={},r={},i="",o=new jA([],t,r,i,n,pn,e,null,{});return new F5("",new sc(o,[]))}var qA=class{constructor(t,n,r,i,o,s,a,l){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(on(u=>u[WR]))??Nt(void 0),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(on(t=>WA(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(on(t=>WA(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function N5(e,t,n="emptyOnly"){let r,{routeConfig:i}=e;return t!==null&&(n==="always"||i?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:Ze(Ze({},t.params),e.params),data:Ze(Ze({},t.data),e.data),resolve:Ze(Ze(Ze(Ze({},e.data),t.data),i?.data),e._resolvedData)}:r={params:Ze({},e.params),data:Ze({},e.data),resolve:Ze(Ze({},e.data),e._resolvedData??{})},i&&B2e(i)&&(r.resolve[WR]=i.title),r}var jA=class{get title(){return this.data?.[WR]}constructor(t,n,r,i,o,s,a,l,u){this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=WA(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=WA(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${n}')`}},F5=class extends I5{constructor(t,n){super(n),this.url=t,Tte(this,n)}toString(){return L2e(this._root)}};function Tte(e,t){t.value._routerState=e,t.children.forEach(n=>Tte(e,n))}function L2e(e){let t=e.children.length>0?` { ${e.children.map(L2e).join(", ")} } `:"";return`${e.value}${t}`}function Zee(e){if(e.snapshot){let t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,_m(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),_m(t.params,n.params)||e.paramsSubject.next(n.params),n_t(t.url,n.url)||e.urlSubject.next(n.url),_m(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function bte(e,t){let n=_m(e.params,t.params)&&s_t(e.url,t.url),r=!e.parent!=!t.parent;return n&&!r&&(!e.parent||bte(e.parent,t.parent))}function B2e(e){return typeof e.title=="string"||e.title===null}var kte=(()=>{let t=class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=pn,this.activateEvents=new Uo,this.deactivateEvents=new Uo,this.attachEvents=new Uo,this.detachEvents=new Uo,this.parentContexts=ut(M5),this.location=ut(FA),this.changeDetector=ut(df),this.inputBinder=ut(Ite,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:o}=r.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Fi(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Fi(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Fi(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new Fi(4013,!1);this._activatedRoute=r;let o=this.location,a=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,u=new yte(r,l,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:u,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=pa({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[IA]});let e=t;return e})(),yte=class e{__ngOutletInjector(t){return new e(this.route,this.childContexts,t)}constructor(t,n,r){this.route=t,this.childContexts=n,this.parent=r}get(t,n){return t===qA?this.route:t===M5?this.childContexts:this.parent.get(t,n)}},Ite=new kn("");function k_t(e,t,n){let r=zR(e,t._root,n?n._root:void 0);return new D5(r,t)}function zR(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=t.value;let i=I_t(e,t,n);return new sc(r,i)}else{if(e.shouldAttach(t.value)){let o=e.retrieve(t.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>zR(e,a)),s}}let r=D_t(t.value),i=t.children.map(o=>zR(e,o));return new sc(r,i)}}function I_t(e,t,n){return t.children.map(r=>{for(let i of n.children)if(e.shouldReuseRoute(r.value,i.value.snapshot))return zR(e,r,i);return zR(e,r)})}function D_t(e){return new qA(new os(e.url),new os(e.params),new os(e.queryParams),new os(e.fragment),new os(e.data),e.outlet,e.component,e)}var UR=class{constructor(t,n){this.redirectTo=t,this.navigationBehaviorOptions=n}},z2e="ngNavigationCancelingError";function R5(e,t){let{redirectTo:n,navigationBehaviorOptions:r}=MR(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,i=U2e(!1,ac.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function U2e(e,t){let n=new Error(`NavigationCancelingError: ${e||""}`);return n[z2e]=!0,n.cancellationCode=t,n}function N_t(e){return j2e(e)&&MR(e.url)}function j2e(e){return!!e&&e[z2e]}var F_t=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=eo({type:t,selectors:[["ng-component"]],standalone:!0,features:[to],decls:1,vars:0,template:function(i,o){i&1&&ma(0,"router-outlet")},dependencies:[kte],encapsulation:2});let e=t;return e})();function R_t(e,t){return e.providers&&!e._injector&&(e._injector=PEe(e.providers,t,`Route: ${e.path}`)),e._injector??t}function Dte(e){let t=e.children&&e.children.map(Dte),n=t?Qi(Ze({},e),{children:t}):Ze({},e);return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==pn&&(n.component=F_t),n}function Ad(e){return e.outlet||pn}function O_t(e,t){let n=e.filter(r=>Ad(r)===t);return n.push(...e.filter(r=>Ad(r)!==t)),n}function GR(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){let n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var M_t=(e,t,n,r)=>on(i=>(new vte(t,i.targetRouterState,i.currentRouterState,n,r).activate(e),i)),vte=class{constructor(t,n,r,i,o){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(t){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),Zee(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){let i=zA(n);t.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(t,n,r){let i=t.value,o=n?n.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(t,n,s.children)}else this.deactivateChildRoutes(t,n,r);else o&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){let r=n.getContext(t.value.outlet),i=r&&t.value.component?r.children:n,o=zA(t);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){let r=n.getContext(t.value.outlet),i=r&&t.value.component?r.children:n,o=zA(t);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,n,r){let i=zA(n);t.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new mte(o.value.snapshot))}),t.children.length&&this.forwardEvent(new dte(t.value.snapshot))}activateRoutes(t,n,r){let i=t.value,o=n?n.value:null;if(Zee(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(t,n,s.children)}else this.activateChildRoutes(t,n,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Zee(a.route.value),this.activateChildRoutes(t,null,s.children)}else{let a=GR(i.snapshot);s.attachRef=null,s.route=i,s.injector=a??s.injector,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,r)}},O5=class{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},VA=class{constructor(t,n){this.component=t,this.route=n}};function $_t(e,t,n){let r=e._root,i=t?t._root:null;return IR(r,i,n,[r.value])}function P_t(e){let t=e.routeConfig?e.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:e,guards:t}}function YA(e,t){let n=Symbol(),r=t.get(e,n);return r===n?typeof e=="function"&&!vEe(e)?e:t.get(e):r}function IR(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=zA(t);return e.children.forEach(s=>{L_t(s,o[s.value.outlet],n,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>RR(a,n.getContext(s),i)),i}function L_t(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=e.value,s=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=B_t(s,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new O5(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?IR(e,t,a?a.children:null,r,i):IR(e,t,n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new VA(a.outlet.component,s))}else s&&RR(t,a,i),i.canActivateChecks.push(new O5(r)),o.component?IR(e,null,a?a.children:null,r,i):IR(e,null,n,r,i);return i}function B_t(e,t,n){if(typeof n=="function")return n(e,t);switch(n){case"pathParamsChange":return!gC(e.url,t.url);case"pathParamsOrQueryParamsChange":return!gC(e.url,t.url)||!_m(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!bte(e,t)||!_m(e.queryParams,t.queryParams);case"paramsChange":default:return!bte(e,t)}}function RR(e,t,n){let r=zA(e),i=e.value;Object.entries(r).forEach(([o,s])=>{i.component?t?RR(s,t.children.getContext(o),n):RR(s,null,n):RR(s,t,n)}),i.component?t&&t.outlet&&t.outlet.isActivated?n.canDeactivateChecks.push(new VA(t.outlet.component,i)):n.canDeactivateChecks.push(new VA(null,i)):n.canDeactivateChecks.push(new VA(null,i))}function qR(e){return typeof e=="function"}function z_t(e){return typeof e=="boolean"}function U_t(e){return e&&qR(e.canLoad)}function j_t(e){return e&&qR(e.canActivate)}function V_t(e){return e&&qR(e.canActivateChild)}function W_t(e){return e&&qR(e.canDeactivate)}function G_t(e){return e&&qR(e.canMatch)}function V2e(e){return e instanceof mEe||e?.name==="EmptyError"}var C5=Symbol("INITIAL_VALUE");function HA(){return af(e=>cR(e.map(t=>t.pipe(Yl(1),Iy(C5)))).pipe(on(t=>{for(let n of t)if(n!==!0){if(n===C5)return C5;if(n===!1||q_t(n))return n}return!0}),go(t=>t!==C5),Yl(1)))}function q_t(e){return MR(e)||e instanceof UR}function H_t(e,t){return sf(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return s.length===0&&o.length===0?Nt(Qi(Ze({},n),{guardsResult:!0})):Y_t(s,r,i,e).pipe(sf(a=>a&&z_t(a)?K_t(r,o,e,t):Nt(a)),on(a=>Qi(Ze({},n),{guardsResult:a})))})}function Y_t(e,t,n,r){return of(e).pipe(sf(i=>eSt(i.component,i.route,n,t,r)),ky(i=>i!==!0,!0))}function K_t(e,t,n,r){return of(t).pipe(sC(i=>l5(Z_t(i.route.parent,r),X_t(i.route,r),J_t(e,i.path,n),Q_t(e,i.route,n))),ky(i=>i!==!0,!0))}function X_t(e,t){return e!==null&&t&&t(new pte(e)),Nt(!0)}function Z_t(e,t){return e!==null&&t&&t(new fte(e)),Nt(!0)}function Q_t(e,t,n){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return Nt(!0);let i=r.map(o=>Aee(()=>{let s=GR(t)??n,a=YA(o,s),l=j_t(a)?a.canActivate(t,e):C0(s,()=>a(t,e));return Fy(l).pipe(ky())}));return Nt(i).pipe(HA())}function J_t(e,t,n){let r=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(s=>P_t(s)).filter(s=>s!==null).map(s=>Aee(()=>{let a=s.guards.map(l=>{let u=GR(s.node)??n,c=YA(l,u),f=V_t(c)?c.canActivateChild(r,e):C0(u,()=>c(r,e));return Fy(f).pipe(ky())});return Nt(a).pipe(HA())}));return Nt(o).pipe(HA())}function eSt(e,t,n,r,i){let o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||o.length===0)return Nt(!0);let s=o.map(a=>{let l=GR(t)??i,u=YA(a,l),c=W_t(u)?u.canDeactivate(e,t,n,r):C0(l,()=>u(e,t,n,r));return Fy(c).pipe(ky())});return Nt(s).pipe(HA())}function tSt(e,t,n,r){let i=t.canLoad;if(i===void 0||i.length===0)return Nt(!0);let o=i.map(s=>{let a=YA(s,e),l=U_t(a)?a.canLoad(t,n):C0(e,()=>a(t,n));return Fy(l)});return Nt(o).pipe(HA(),W2e(r))}function W2e(e){return pEe(xi(t=>{if(typeof t!="boolean")throw R5(e,t)}),on(t=>t===!0))}function nSt(e,t,n,r){let i=t.canMatch;if(!i||i.length===0)return Nt(!0);let o=i.map(s=>{let a=YA(s,e),l=G_t(a)?a.canMatch(t,n):C0(e,()=>a(t,n));return Fy(l)});return Nt(o).pipe(HA(),W2e(r))}var jR=class{constructor(t){this.segmentGroup=t||null}},VR=class extends Error{constructor(t){super(),this.urlTree=t}};function BA(e){return oC(new jR(e))}function rSt(e){return oC(new Fi(4e3,!1))}function iSt(e){return oC(U2e(!1,ac.GuardRejected))}var wte=class{constructor(t,n){this.urlSerializer=t,this.urlTree=n}lineralizeSegments(t,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Nt(r);if(i.numberOfChildren>1||!i.children[pn])return rSt(`${t.redirectTo}`);i=i.children[pn]}}applyRedirectCommands(t,n,r,i,o){if(typeof n!="string"){let a=n,{queryParams:l,fragment:u,routeConfig:c,url:f,outlet:d,params:p,data:m,title:h}=i,g=C0(o,()=>a({params:p,data:m,queryParams:l,fragment:u,routeConfig:c,url:f,outlet:d,title:h}));if(g instanceof Ny)throw new VR(g);n=g}let s=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),t,r);if(n[0]==="/")throw new VR(s);return s}applyRedirectCreateUrlTree(t,n,r,i){let o=this.createSegmentGroup(t,n.root,r,i);return new Ny(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){let r={};return Object.entries(t).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=n[a]}else r[i]=o}),r}createSegmentGroup(t,n,r,i){let o=this.createSegments(t,n.segments,r,i),s={};return Object.entries(n.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(t,l,r,i)}),new pr(o,s)}createSegments(t,n,r,i){return n.map(o=>o.path[0]===":"?this.findPosParam(t,o,i):this.findOrReturn(o,r))}findPosParam(t,n,r){let i=r[n.path.substring(1)];if(!i)throw new Fi(4001,!1);return i}findOrReturn(t,n){let r=0;for(let i of n){if(i.path===t.path)return n.splice(r),i;r++}return t}},Cte={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function oSt(e,t,n,r,i){let o=Nte(e,t,n);return o.matched?(r=R_t(t,r),nSt(r,t,n,i).pipe(on(s=>s===!0?o:Ze({},Cte)))):Nt(o)}function Nte(e,t,n){if(t.path==="**")return sSt(n);if(t.path==="")return t.pathMatch==="full"&&(e.hasChildren()||n.length>0)?Ze({},Cte):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(t.matcher||t_t)(n,e,t);if(!i)return Ze({},Cte);let o={};Object.entries(i.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=i.consumed.length>0?Ze(Ze({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function sSt(e){return{matched:!0,parameters:e.length>0?S2e(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function v2e(e,t,n,r){return n.length>0&&uSt(e,n,r)?{segmentGroup:new pr(t,lSt(r,new pr(n,e.children))),slicedSegments:[]}:n.length===0&&cSt(e,n,r)?{segmentGroup:new pr(e.segments,aSt(e,n,r,e.children)),slicedSegments:n}:{segmentGroup:new pr(e.segments,e.children),slicedSegments:n}}function aSt(e,t,n,r){let i={};for(let o of n)if($5(e,t,o)&&!r[Ad(o)]){let s=new pr([],{});i[Ad(o)]=s}return Ze(Ze({},r),i)}function lSt(e,t){let n={};n[pn]=t;for(let r of e)if(r.path===""&&Ad(r)!==pn){let i=new pr([],{});n[Ad(r)]=i}return n}function uSt(e,t,n){return n.some(r=>$5(e,t,r)&&Ad(r)!==pn)}function cSt(e,t,n){return n.some(r=>$5(e,t,r))}function $5(e,t,n){return(e.hasChildren()||t.length>0)&&n.pathMatch==="full"?!1:n.path===""}function fSt(e,t,n,r){return Ad(e)!==r&&(r===pn||!$5(t,n,e))?!1:Nte(t,e,n).matched}function dSt(e,t,n){return t.length===0&&!e.children[n]}var _te=class{};function pSt(e,t,n,r,i,o,s="emptyOnly"){return new Ste(e,t,n,r,i,s,o).recognize()}var mSt=31,Ste=class{constructor(t,n,r,i,o,s,a){this.injector=t,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new wte(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new Fi(4002,`'${t.segmentGroup}'`)}recognize(){let t=v2e(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(on(({children:n,rootSnapshot:r})=>{let i=new sc(r,n),o=new F5("",i),s=v_t(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(t){let n=new jA([],Object.freeze({}),Object.freeze(Ze({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),pn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,pn,n).pipe(on(r=>({children:r,rootSnapshot:n})),Ty(r=>{if(r instanceof VR)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof jR?this.noMatchError(r):r}))}processSegmentGroup(t,n,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(t,n,r,o):this.processSegment(t,n,r,r.segments,i,!0,o).pipe(on(s=>s instanceof sc?[s]:[]))}processChildren(t,n,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return of(o).pipe(sC(s=>{let a=r.children[s],l=O_t(n,s);return this.processSegmentGroup(t,l,a,s,i)}),xEe((s,a)=>(s.push(...a),s)),kee(null),gEe(),sf(s=>{if(s===null)return BA(r);let a=G2e(s);return hSt(a),Nt(a)}))}processSegment(t,n,r,i,o,s,a){return of(n).pipe(sC(l=>this.processSegmentAgainstRoute(l._injector??t,n,l,r,i,o,s,a).pipe(Ty(u=>{if(u instanceof jR)return Nt(null);throw u}))),ky(l=>!!l),Ty(l=>{if(V2e(l))return dSt(r,i,o)?Nt(new _te):BA(r);throw l}))}processSegmentAgainstRoute(t,n,r,i,o,s,a,l){return fSt(r,i,o,s)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(t,i,r,o,s,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,i,n,r,o,s,l):BA(i):BA(i)}expandSegmentAgainstRouteUsingRedirect(t,n,r,i,o,s,a){let{matched:l,parameters:u,consumedSegments:c,positionalParamSegments:f,remainingSegments:d}=Nte(n,i,o);if(!l)return BA(n);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>mSt&&(this.allowRedirects=!1));let p=new jA(o,u,Object.freeze(Ze({},this.urlTree.queryParams)),this.urlTree.fragment,w2e(i),Ad(i),i.component??i._loadedComponent??null,i,C2e(i)),m=N5(p,a,this.paramsInheritanceStrategy);p.params=Object.freeze(m.params),p.data=Object.freeze(m.data);let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f,p,t);return this.applyRedirects.lineralizeSegments(i,h).pipe(sf(g=>this.processSegment(t,r,n,g.concat(d),s,!1,a)))}matchSegmentAgainstRoute(t,n,r,i,o,s){let a=oSt(n,r,i,t,this.urlSerializer);return r.path==="**"&&(n.children={}),a.pipe(af(l=>l.matched?(t=r._injector??t,this.getChildConfig(t,r,i).pipe(af(({routes:u})=>{let c=r._loadedInjector??t,{parameters:f,consumedSegments:d,remainingSegments:p}=l,m=new jA(d,f,Object.freeze(Ze({},this.urlTree.queryParams)),this.urlTree.fragment,w2e(r),Ad(r),r.component??r._loadedComponent??null,r,C2e(r)),h=N5(m,s,this.paramsInheritanceStrategy);m.params=Object.freeze(h.params),m.data=Object.freeze(h.data);let{segmentGroup:g,slicedSegments:x}=v2e(n,d,p,u);if(x.length===0&&g.hasChildren())return this.processChildren(c,u,g,m).pipe(on(y=>new sc(m,y)));if(u.length===0&&x.length===0)return Nt(new sc(m,[]));let b=Ad(r)===o;return this.processSegment(c,u,g,x,b?pn:o,!0,m).pipe(on(y=>new sc(m,y instanceof sc?[y]:[])))}))):BA(n)))}getChildConfig(t,n,r){return n.children?Nt({routes:n.children,injector:t}):n.loadChildren?n._loadedRoutes!==void 0?Nt({routes:n._loadedRoutes,injector:n._loadedInjector}):tSt(t,n,r,this.urlSerializer).pipe(sf(i=>i?this.configLoader.loadChildren(t,n).pipe(xi(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):iSt(n))):Nt({routes:[],injector:t})}};function hSt(e){e.sort((t,n)=>t.value.outlet===pn?-1:n.value.outlet===pn?1:t.value.outlet.localeCompare(n.value.outlet))}function gSt(e){let t=e.value.routeConfig;return t&&t.path===""}function G2e(e){let t=[],n=new Set;for(let r of e){if(!gSt(r)){t.push(r);continue}let i=t.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):t.push(r)}for(let r of n){let i=G2e(r.children);t.push(new sc(r.value,i))}return t.filter(r=>!n.has(r))}function w2e(e){return e.data||{}}function C2e(e){return e.resolve||{}}function xSt(e,t,n,r,i,o){return sf(s=>pSt(e,t,n,r,s.extractedUrl,i,o).pipe(on(({state:a,tree:l})=>Qi(Ze({},s),{targetSnapshot:a,urlAfterRedirects:l}))))}function bSt(e,t){return sf(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Nt(n);let o=new Set(i.map(l=>l.route)),s=new Set;for(let l of o)if(!s.has(l))for(let u of q2e(l))s.add(u);let a=0;return of(s).pipe(sC(l=>o.has(l)?ySt(l,r,e,t):(l.data=N5(l,l.parent,e).resolve,Nt(void 0))),xi(()=>a++),Iee(1),sf(l=>a===s.size?Nt(n):Ay))})}function q2e(e){let t=e.children.map(n=>q2e(n)).flat();return[e,...t]}function ySt(e,t,n,r){let i=e.routeConfig,o=e._resolve;return i?.title!==void 0&&!B2e(i)&&(o[WR]=i.title),vSt(o,e,t,r).pipe(on(s=>(e._resolvedData=s,e.data=N5(e,e.parent,n).resolve,null)))}function vSt(e,t,n,r){let i=ete(e);if(i.length===0)return Nt({});let o={};return of(i).pipe(sf(s=>wSt(e[s],t,n,r).pipe(ky(),xi(a=>{if(a instanceof UR)throw R5(new OR,a);o[s]=a}))),Iee(1),pR(o),Ty(s=>V2e(s)?Ay:oC(s)))}function wSt(e,t,n,r){let i=GR(t)??r,o=YA(e,i),s=o.resolve?o.resolve(t,n):C0(i,()=>o(t,n));return Fy(s)}function Qee(e){return af(t=>{let n=e(t);return n?of(n).pipe(on(()=>t)):Nt(t)})}var H2e=(()=>{let t=class t{buildTitle(r){let i,o=r.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===pn);return i}getResolvedTitleForRoute(r){return r.data[WR]}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:()=>ut(CSt),providedIn:"root"});let e=t;return e})(),CSt=(()=>{let t=class t extends H2e{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};t.\u0275fac=function(i){return new(i||t)(Oe(m2e))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),Fte=new kn("",{providedIn:"root",factory:()=>({})}),Rte=new kn(""),_St=(()=>{let t=class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ut(Fee)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Nt(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Fy(r.loadComponent()).pipe(on(Y2e),xi(s=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s}),aC(()=>{this.componentLoaders.delete(r)})),o=new See(i,()=>new qn).pipe(_ee());return this.componentLoaders.set(r,o),o}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Nt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=SSt(i,this.compiler,r,this.onLoadEndListener).pipe(aC(()=>{this.childrenLoaders.delete(i)})),a=new See(s,()=>new qn).pipe(_ee());return this.childrenLoaders.set(i,a),a}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function SSt(e,t,n,r){return Fy(e.loadChildren()).pipe(on(Y2e),sf(i=>i instanceof $Ee||Array.isArray(i)?Nt(i):of(t.compileModuleAsync(i))),on(i=>{r&&r(e);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(n).injector,s=o.get(Rte,[],{optional:!0,self:!0}).flat()),{routes:s.map(Dte),injector:o}}))}function ESt(e){return e&&typeof e=="object"&&"default"in e}function Y2e(e){return ESt(e)?e.default:e}var Ote=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:()=>ut(ASt),providedIn:"root"});let e=t;return e})(),ASt=(()=>{let t=class t{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),TSt=new kn("");var kSt=new kn(""),ISt=(()=>{let t=class t{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new qn,this.transitionAbortSubject=new qn,this.configLoader=ut(_St),this.environmentInjector=ut(lC),this.urlSerializer=ut(Ate),this.rootContexts=ut(M5),this.location=ut($A),this.inputBindingEnabled=ut(Ite,{optional:!0})!==null,this.titleStrategy=ut(H2e),this.options=ut(Fte,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ut(Ote),this.createViewTransition=ut(TSt,{optional:!0}),this.navigationErrorHandler=ut(kSt,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Nt(void 0),this.rootComponentType=null;let r=o=>this.events.next(new ute(o)),i=o=>this.events.next(new cte(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Qi(Ze(Ze({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,o){return this.transitions=new os({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:FR,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(go(s=>s.id!==0),on(s=>Qi(Ze({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),af(s=>{let a=!1,l=!1;return Nt(s).pipe(af(u=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",ac.SupersededByNewNavigation),Ay;this.currentTransition=s,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?Qi(Ze({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!c&&f!=="reload"){let d="";return this.events.next(new bC(u.id,this.urlSerializer.serialize(u.rawUrl),d,ite.IgnoredSameUrlNavigation)),u.resolve(!1),Ay}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return Nt(u).pipe(af(d=>{let p=this.transitions?.getValue();return this.events.next(new PR(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),p!==this.transitions?.getValue()?Ay:Promise.resolve(d)}),xSt(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),xi(d=>{s.targetSnapshot=d.targetSnapshot,s.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=Qi(Ze({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let p=new k5(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:d,extractedUrl:p,source:m,restoredState:h,extras:g}=u,x=new PR(d,this.urlSerializer.serialize(p),m,h);this.events.next(x);let b=P2e(this.rootComponentType).snapshot;return this.currentTransition=s=Qi(Ze({},u),{targetSnapshot:b,urlAfterRedirects:p,extras:Qi(Ze({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=p,Nt(s)}else{let d="";return this.events.next(new bC(u.id,this.urlSerializer.serialize(u.extractedUrl),d,ite.IgnoredByUrlHandlingStrategy)),u.resolve(!1),Ay}}),xi(u=>{let c=new ote(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}),on(u=>(this.currentTransition=s=Qi(Ze({},u),{guards:$_t(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),s)),H_t(this.environmentInjector,u=>this.events.next(u)),xi(u=>{if(s.guardsResult=u.guardsResult,u.guardsResult&&typeof u.guardsResult!="boolean")throw R5(this.urlSerializer,u.guardsResult);let c=new ste(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(c)}),go(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",ac.GuardRejected),!1)),Qee(u=>{if(u.guards.canActivateChecks.length)return Nt(u).pipe(xi(c=>{let f=new ate(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(f)}),af(c=>{let f=!1;return Nt(c).pipe(bSt(this.paramsInheritanceStrategy,this.environmentInjector),xi({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(c,"",ac.NoDataFromResolver)}}))}),xi(c=>{let f=new lte(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(f)}))}),Qee(u=>{let c=f=>{let d=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(f.routeConfig).pipe(xi(p=>{f.component=p}),on(()=>{})));for(let p of f.children)d.push(...c(p));return d};return cR(c(u.targetSnapshot.root)).pipe(kee(null),Yl(1))}),Qee(()=>this.afterPreactivation()),af(()=>{let{currentSnapshot:u,targetSnapshot:c}=s,f=this.createViewTransition?.(this.environmentInjector,u.root,c.root);return f?of(f).pipe(on(()=>s)):Nt(s)}),on(u=>{let c=k_t(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s=Qi(Ze({},u),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,s}),xi(()=>{this.events.next(new BR)}),M_t(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Yl(1),xi({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new xC(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),Ji(this.transitionAbortSubject.pipe(xi(u=>{throw u}))),aC(()=>{!a&&!l&&this.cancelNavigationTransition(s,"",ac.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ty(u=>{if(l=!0,j2e(u))this.events.next(new N0(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),N_t(u)?this.events.next(new GA(u.url,u.navigationBehaviorOptions)):s.resolve(!1);else{let c=new LR(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0);try{let f=C0(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(f instanceof UR){let{message:d,cancellationCode:p}=R5(this.urlSerializer,f);this.events.next(new N0(s.id,this.urlSerializer.serialize(s.extractedUrl),d,p)),this.events.next(new GA(f.redirectTo,f.navigationBehaviorOptions))}else{this.events.next(c);let d=r.errorHandler(u);s.resolve(!!d)}}catch(f){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(f)}}return Ay}))}))}cancelNavigationTransition(r,i,o){let s=new N0(r.id,this.urlSerializer.serialize(r.extractedUrl),i,o);this.events.next(s),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function DSt(e){return e!==FR}var NSt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:()=>ut(FSt),providedIn:"root"});let e=t;return e})(),Ete=class{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}},FSt=(()=>{let t=class t extends Ete{};t.\u0275fac=(()=>{let r;return function(o){return(r||(r=xR(t)))(o||t)}})(),t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),K2e=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:()=>ut(RSt),providedIn:"root"});let e=t;return e})(),RSt=(()=>{let t=class t extends K2e{constructor(){super(...arguments),this.location=ut($A),this.urlSerializer=ut(Ate),this.options=ut(Fte,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ut(Ote),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ny,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=P2e(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof PR)this.stateMemento=this.createStateMemento();else if(r instanceof bC)this.rawUrlTree=i.initialUrl;else if(r instanceof k5){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(o,i)}}else r instanceof BR?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof N0&&(r.code===ac.GuardRejected||r.code===ac.NoDataFromResolver)?this.restoreHistory(i):r instanceof LR?this.restoreHistory(i,!0):r instanceof xC&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let o=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){let s=this.browserPageId,a=Ze(Ze({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(o,"",a)}else{let s=Ze(Ze({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===r.finalUrl&&s===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};t.\u0275fac=(()=>{let r;return function(o){return(r||(r=xR(t)))(o||t)}})(),t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),DR=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(DR||{});function OSt(e,t){e.events.pipe(go(n=>n instanceof xC||n instanceof N0||n instanceof LR||n instanceof bC),on(n=>n instanceof xC||n instanceof bC?DR.COMPLETE:(n instanceof N0?n.code===ac.Redirect||n.code===ac.SupersededByNewNavigation:!1)?DR.REDIRECTING:DR.FAILED),go(n=>n!==DR.REDIRECTING),Yl(1)).subscribe(()=>{t()})}function MSt(e){throw e}var $St={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},PSt={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},X2e=(()=>{let t=class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=ut(g5),this.stateManager=ut(K2e),this.options=ut(Fte,{optional:!0})||{},this.pendingTasks=ut(LEe),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ut(ISt),this.urlSerializer=ut(Ate),this.location=ut($A),this.urlHandlingStrategy=ut(Ote),this._events=new qn,this.errorHandler=this.options.errorHandler||MSt,this.navigated=!1,this.routeReuseStrategy=ut(NSt),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ut(Rte,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ut(Ite,{optional:!0}),this.eventsSubscription=new v0,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof N0&&i.code!==ac.Redirect&&i.code!==ac.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof xC)this.navigated=!0;else if(i instanceof GA){let a=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),u=Ze({info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||DSt(o.source)},a);this.scheduleNavigation(l,FR,null,u,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}BSt(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),FR,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,o){let s={replaceUrl:!0},a=o?.navigationId?o:null;if(o){let u=Ze({},o);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Dte),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:l,preserveFragment:u}=i,c=u?this.currentUrlTree.fragment:a,f=null;switch(l){case"merge":f=Ze(Ze({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let d;try{let p=o?o.snapshot:this.routerState.snapshot.root;d=R2e(p)}catch{(typeof r[0]!="string"||r[0][0]!=="/")&&(r=[]),d=this.currentUrlTree.root}return O2e(d,r,f,c??null)}navigateByUrl(r,i={skipLocationChange:!1}){let o=MR(r)?r:this.parseUrl(r),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,FR,null,i)}navigate(r,i={skipLocationChange:!1}){return LSt(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let o;if(i===!0?o=Ze({},$St):i===!1?o=Ze({},PSt):o=i,MR(r))return g2e(this.currentUrlTree,r,o);let s=this.parseUrl(r);return g2e(this.currentUrlTree,s,o)}removeEmptyProps(r){return Object.entries(r).reduce((i,[o,s])=>(s!=null&&(i[o]=s),i),{})}scheduleNavigation(r,i,o,s,a){if(this.disposed)return Promise.resolve(!1);let l,u,c;a?(l=a.resolve,u=a.reject,c=a.promise):c=new Promise((d,p)=>{l=d,u=p});let f=this.pendingTasks.add();return OSt(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:s,resolve:l,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function LSt(e){for(let t=0;t<e.length;t++)if(e[t]==null)throw new Fi(4008,!1)}function BSt(e){return!(e instanceof BR)&&!(e instanceof GA)}var zSt=new kn("");function Z2e(e,...t){return gR([{provide:Rte,multi:!0,useValue:e},[],{provide:qA,useFactory:USt,deps:[X2e]},{provide:jEe,multi:!0,useFactory:jSt},t.map(n=>n.\u0275providers)])}function USt(e){return e.routerState.root}function jSt(){let e=ut(nc);return t=>{let n=e.get(MA);if(t!==n.components[0])return;let r=e.get(X2e),i=e.get(VSt);e.get(WSt)===1&&r.initialNavigation(),e.get(GSt,null,Dee.Optional)?.setUpPreloading(),e.get(zSt,null,Dee.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var VSt=new kn("",{factory:()=>new qn}),WSt=new kn("",{providedIn:"root",factory:()=>1});var GSt=new kn("");var ywt=tc(rft());N();q();sn();ft();XT();var KX={kernelName:R0,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,vf(de(n,"float32"),-1))}}};q();sn();Ln();_o();Tr();Bd();Ui();Yn();var ift={kernelName:Tm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=jt(de(n,"float32")),i=Bn(De(Pe(1),r));return qt(Fe(e,i))}}}};q();sn();Ln();Bd();Ui();Yn();var oft={kernelName:km,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Bn(De(jt(de(n,"float32")),1));return Fe(e,r)}}}};q();hr();qe();ni();var sft={kernelName:mf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=e,l=Hn(n.shape,i);return l.length>0&&(a=Me(a,l)),V(a,n.shape)},b:()=>{let a=e,l=Hn(r.shape,i);return l.length>0&&(a=Me(a,l)),V(a,r.shape)}}}};q();var aft={kernelName:O0,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}};q();Ar();var lft={kernelName:M0,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>lt(n)}}};q();Ar();var uft={kernelName:$0,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>lt(n)}}};q();sn();Ln();Tr();Bd();Ui();Yn();var cft={kernelName:Im,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,Bn(De(Pe(1),jt(de(n,"float32")))))}}};q();Er();sn();Ln();Tr();Bd();Ui();var fft={kernelName:Dm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Bn(se(Pe(1),jt(de(n,"float32"))));return Fe(e,r)}}}};q();Er();hr();Ln();ft();_o();qe();Ui();ni();var dft={kernelName:Rm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=se(jt(n),jt(r)),l=j(e,Fe(r,a)),u=Hn(n.shape,i);return u.length>0&&(l=Me(l,u)),V(l,n.shape)},b:()=>{let a=se(jt(n),jt(r)),l=qt(j(e,Fe(n,a))),u=Hn(r.shape,i);return u.length>0&&(l=Me(l,u)),V(l,r.shape)}}}};q();Er();sn();Ln();Ui();var pft={kernelName:Nm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,se(jt(de(n,"float32")),1))}}};q();sn();Ln();Ui();Yn();Tr();var mft={kernelName:Fm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,De(Pe(1),jt(de(n,"float32"))))}}};q();ne();q();J();ae();io();X();qe();function Zvn(e,t,n,r,i,o){let s=D(e,"dy","avgPool3dGrad"),a=D(t,"input","avgPool3dGrad"),l=s,u=a,c=!1;a.rank===4&&(c=!0,l=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),L(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),L(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),ir("avgPool3dGrad",i,o);let f={dy:l,input:u},d={filterSize:n,strides:r,pad:i,dimRoundingMode:o},p=$.runKernel(EC,f,d);return c?V(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var hft=R({avgPool3dGrad_:Zvn});var gft={kernelName:L0,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:a}=n;return{x:()=>hft(e,r,i,o,s,a)}}};q();ne();q();J();ae();X();qe();function Qvn(e,t,n,r,i){let o=D(e,"dy","avgPoolGrad"),s=D(t,"input","avgPoolGrad");L(s.rank===o.rank,()=>`Rank of input (${s.rank}) does not match rank of dy (${o.rank})`);let a=s,l=o,u=!1;s.rank===3&&(u=!0,a=V(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=V(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),L(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);let c={dy:l,input:a},f={filterSize:n,strides:r,pad:i},d=$.runKernel(SC,c,f);return u?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var xft=R({avgPoolGrad_:Qvn});var bft={kernelName:P0,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:i,strides:o,pad:s}=n;return{x:()=>xft(e,r,i,o,s)}}};q();$d();var yft={kernelName:B0,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[r,i]=t,{transposeA:o,transposeB:s}=n;return!o&&!s?{a:()=>Bt(e,i,!1,!0),b:()=>Bt(r,e,!0,!1)}:!o&&s?{a:()=>Bt(e,i,!1,!1),b:()=>Bt(e,r,!0,!1)}:o&&!s?{a:()=>Bt(i,e,!1,!0),b:()=>Bt(r,e,!1,!1)}:{a:()=>Bt(i,e,!0,!0),b:()=>Bt(e,r,!0,!0)}}};q();SO();var vft={kernelName:z0,gradFunc:(e,t,n)=>{let{blockShape:r,crops:i}=n;return{x:()=>hv(e,r,i)}}};q();ni();var wft={kernelName:Wte,gradFunc:(e,t,n)=>{let r=n,i=r.inputShape,o=r.shape,s=Array.from(o);for(let l=i.length-1;l>=0;l--)if(i[l]===o[l])s[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${o}].`);let a=[];for(let l=0;l<s.length;l++)s[l]>1&&a.push(l);return{x:()=>Me(e,a,!0)}}};q();var Cft={kernelName:kd,gradFunc:e=>({x:()=>e.clone()})};q();Ar();var _ft={kernelName:Om,gradFunc:e=>({x:()=>lt(e)})};q();V_();uv();W_();pc();Ar();var Sft={kernelName:Mm,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:i,clipValueMax:o}=n;return{x:()=>or(cs(ba(r,i),eu(r,o)),e,lt(e))}}};q();var Eft={kernelName:U0,inputsToSave:["x"],gradFunc:KX.gradFunc};q();Z_();ae();var Aft={kernelName:j0,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map(l=>l.shape),{axis:i}=n,o=zi(i,t[0].shape)[0],s=r.map(l=>l[o]);return Vi(e,s,o).map(l=>()=>l)}};q();N8();E6();io();ae();var Tft={kernelName:V0,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,i]=t,{dilations:o,strides:s,pad:a,dataFormat:l}=n;return L(cc(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>AT(r.shape,e,i,s,a,l),filter:()=>tk(r,e,i.shape,s,a,l)}}};q();z_();N8();var kft={kernelName:W0,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[r,i]=t,{strides:o,pad:s,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>cl(e,i,o,s,a,1,l),filter:()=>tk(e,r,i.shape,o,s,a,l)}}};q();ne();q();ae();X();qe();function Jvn(e,t,n,r,i){let o=e;e.rank===4&&(o=V(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;s.rank===4&&(s=V(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),L(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),L(s.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`),L(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),L(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),L(s.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`);let a={x:o,dy:s},l={strides:r,pad:i,filterShape:n};return $.runKernel(DC,a,l)}var Ift=R({conv3DBackpropFilter_:Jvn});Pne();io();ae();var Dft={kernelName:G0,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:i,pad:o}=n;L(cc(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[s,a]=t;return{x:()=>T6(s.shape,e,a,i,o),filter:()=>Ift(s,e,a.shape,i,o)}}};q();sn();ft();_o();yre();var Nft={kernelName:$m,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(qt(WT(de(n,"float32"))),e)}}};q();sn();ft();vre();var Fft={kernelName:Pm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(GT(de(n,"float32")),e)}}};q();Ld();N6();Bx();var Rft={kernelName:q0,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:i,exclusive:o,reverse:s}=n;return{x:()=>{let a=qne([i],r.rank),l=IT(e,i,o,!s);return a!=null&&(l=zt(l,a)),l}}}};q();io();Dre();Nre();ae();var Oft={kernelName:H0,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:i,pad:o,dimRoundingMode:s}=n,a=r??[1,1];L(cc(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);let[l,u]=t;return L(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),L(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),L(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),L(Go(i,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`),ir("depthwiseConv2d",o,s),{x:()=>R8(l.shape,e,u,i,o,a,s),filter:()=>F8(l,e,u.shape,i,o,a,s)}}};ne();q();var Mft={kernelName:Y0,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,i]=t,o={x:r,filter:i,dy:e},s={x:r,filter:i,dy:e};return{x:()=>$.runKernel(eT,o,n),filter:()=>$.runKernel(tT,s,n)}}};ne();q();var $ft={kernelName:Bm,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>$.runKernel(zC,r)}}};q();kh();ft();_o();Ui();var Pft={kernelName:zm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=j(Jr(qt(jt(n))),2/Math.sqrt(Math.PI));return{x:()=>j(e,r)}}};q();ft();var Lft={kernelName:Um,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,n)}}};q();qe();var Bft={kernelName:K0,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>V(e,n.shape)}}};q();kh();ft();var zft={kernelName:jm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,Jr(n))}}};q();Ar();var Uft={kernelName:Vm,gradFunc:e=>({x:()=>lt(e)})};q();hr();sn();Ln();ft();_o();qe();Ui();ni();var jft={kernelName:Wm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=Fe(e,de(r,"float32")),l=Hn(n.shape,i);return l.length>0?V(Me(a,l),n.shape):a},b:()=>{let a=j(e,de(n,"float32")),l=Hn(r.shape,i);l.length>0&&(a=V(Me(a,l),r.shape));let u=jt(r);return qt(Fe(a,de(u,"float32")))}}}};q();Er();hr();ft();qe();gre();Tr();Yn();ni();RT();var Vft={kernelName:X0,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[i,o,s,a]=t,l=a??Pe(1),u=Hn(o.shape,i.shape),c=[];if(o.rank===1){for(let v=0;v<i.shape.length-1;++v)c.push(i.shape[v]);c.push(1)}let f=De(i,o),d=j(e,l),p=UT(se(s,Pe(r))),m=j(j(j(p,p),p),Pe(-.5));return{x:()=>o.rank===1?V(j(j(e,qo(V(p,[1,1,1,o.shape[0]]),c)),l),i.shape):V(j(j(e,p),l),i.shape),mean:()=>{let v=j(j(p,Pe(-1)),d);return o.rank===1&&(v=Me(v,u)),V(v,o.shape)},variance:()=>{let v=j(j(m,f),d);return o.rank===1&&(v=Me(v,u)),V(v,o.shape)},scale:()=>{let v=j(f,p),C=j(e,v);return o.rank===1&&(C=Me(C,u)),V(C,o.shape)},offset:()=>{let v=e;return o.rank===1&&(v=Me(v,u)),V(v,o.shape)}}}};q();Ld();qe();vv();Bx();T8();ae();var qft={kernelName:Z0,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[r,i]=t,{axis:o,batchDims:s}=n,a=zi(o,r.shape)[0],l=(u,c,f)=>()=>{let d=u.shape,p=c.size,m=d.slice(0,a),h=m.length,g=d.slice(o,d.length).slice(1),x=g.length,b=Wft(0,h),y=Wft(h+1,h+1+x),v=Gft([m,[p],g]),C=V(f,v),_=V(c,[p]),S=Gft([[h],b,y]),E=zt(C,S),T=JT(E,_,u.shape[a]),I=pO(S);return T=zt(T,I),T};if(s===1){let u=r.shape[0],c=r.split(u,0);return{x:()=>Ri(c.map((p,m)=>l(p,i.slice(m,1),e.slice(m,1))())).reshape(r.shape),indices:()=>i}}else return{x:l(r,i,e),indices:()=>i}}};function Wft(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function Gft(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}q();Ar();var Hft={kernelName:Gm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>lt(n),b:()=>lt(r)}}};q();sn();var Yft={kernelName:Id,gradFunc:e=>({x:()=>de(e,"float32")})};q();Ar();var Kft={kernelName:qm,gradFunc:e=>({x:()=>lt(e)})};q();Ar();var Xft={kernelName:Hm,gradFunc:e=>({x:()=>lt(e)})};q();Ar();var Zft={kernelName:Ym,gradFunc:e=>({x:()=>lt(e)})};q();Nh();ft();pc();var Qft={kernelName:Q0,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{alpha:i}=n,o=Ur(r,0);return{x:()=>or(o,e,j(e,i))}}};q();Er();Ln();var Jft={kernelName:Xm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,se(n,1))}}};q();sn();Ln();var edt={kernelName:Km,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,de(n,"float32"))}}};q();kh();ft();Yn();ni();var tdt={kernelName:Gte,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n;return{logits:()=>{let s=Jr(r);return De(e,j(Me(e,i,!0),s))}}}};q();ne();q();X();function e1n(e,t,n,r=5,i=1,o=1,s=.5){let a={x:e,y:t,dy:n},l={depthRadius:r,bias:i,alpha:o,beta:s};return $.runKernel(YC,a,l)}var ndt=R({localResponseNormalizationBackprop_:e1n});var rdt={kernelName:J0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{depthRadius:o,bias:s,alpha:a,beta:l}=n;return{x:()=>ndt(r,i,e,o,s,a,l)}}};q();ae();Ld();sn();dO();ft();qe();function XX(e,t,n,r){return t.rank<n.rank&&(t=V(t,yf(t.shape,r))),e.rank<n.rank&&(e=V(e,yf(e.shape,r))),{x:()=>j(e,de(Vs(n,t),e.dtype))}}var Swe={kernelName:ex,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{reductionIndices:i}=r,o=t[0],s=t[1],a=zi(i,o.shape),l=XX(e,s,o,a);return{x:()=>l.x()}}};q();sn();V_();xO();ft();var idt={kernelName:Zm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>j(e,de(ba(n,r),"float32")),b:()=>j(e,de(Ox(n,r),"float32"))}}};q();ne();q();J();ae();io();X();qe();function t1n(e,t,n,r,i,o,s){let a=D(e,"dy","maxPool3dGrad"),l=D(t,"input","maxPool3dGrad"),u=D(n,"output","maxPool3dGrad"),c=a,f=l,d=u,p=!1;l.rank===4&&(p=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),f=V(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=V(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),L(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),L(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),L(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),ir("maxPool3dGrad",o,s);let m={dy:c,input:f,output:d},h={filterSize:r,strides:i,pad:o,dimRoundingMode:s},g=$.runKernel(XC,m,h);return p?V(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}var odt=R({maxPool3dGrad_:t1n});var sdt={kernelName:nx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=n;return{x:()=>odt(e,r,i,o,s,a,l)}}};q();ne();q();J();ae();io();X();function n1n(e,t,n,r,i,o,s){let a=D(e,"dy","maxPoolGrad"),l=D(t,"input","maxPoolGrad"),u=D(n,"output","maxPoolGrad");L(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),L(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),L(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ir("maxPoolGrad",o,s);let c={dy:a,input:l,output:u},f={filterSize:r,strides:i,pad:o,dimRoundingMode:s};return $.runKernel(KC,c,f)}var adt=R({maxPoolGrad_:n1n});var ldt={kernelName:tx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{filterSize:o,strides:s,pad:a}=n;return{x:()=>adt(e,r,i,o,s,a)}}};q();Ld();Ln();ft();G_();qe();ae();var udt={kernelName:rx,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n,o=zi(i,r.shape),a=Gne(r.shape,o)[1],l=Zt(a);return{x:()=>{let c=r.shape.slice();o.forEach(p=>{c[p]=1});let f=V(e,c);return Fe(j(f,vi(r.shape,"float32")),l)}}}};q();ae();var cdt={kernelName:ix,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{axis:i}=r,[o,s]=t,a=zi(i,o.shape),l=XX(e,s,o,a);return{x:()=>l.x()}}};q();sn();Nh();uv();ft();var fdt={kernelName:Qm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>j(e,de(eu(n,r),"float32")),b:()=>j(e,de(Ur(n,r),"float32"))}}};q();ul();var ddt={kernelName:ox,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:i}=n,o=i.map(s=>s[0]);return{x:()=>Mt(e,o,r.shape)}}};q();hr();Ln();z6();ft();_o();qe();ni();var pdt={kernelName:Jm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=Hn(n.shape,i);return a.length>0?V(Me(e,a),n.shape):e},b:()=>{let a=j(e,qt(Ih(Fe(n,r)))),l=Hn(r.shape,i);return l.length>0?V(Me(a,l),r.shape):a}}}};q();hr();sn();ft();qe();ni();var mdt={kernelName:eh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=j(e,de(r,"float32")),l=Hn(n.shape,i);return l.length>0?V(Me(a,l),n.shape):a},b:()=>{let a=j(e,de(n,"float32")),l=Hn(r.shape,i);return l.length>0?V(Me(a,l),r.shape):a}}}};q();_o();var hdt={kernelName:sx,gradFunc:e=>({x:()=>qt(e)})};q();PT();var gdt={kernelName:lx,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>ar(n.shape,"float32")}}};q();Ar();var xdt={kernelName:ax,gradFunc:e=>({x:()=>lt(e)})};q();ek();var bdt={kernelName:ux,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return fs(e,r).map(o=>()=>o)}};q();ul();var Ewe={kernelName:cx,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:i}=n,o=i.map(s=>s[0]);return{x:()=>Mt(e,o,r.shape)}}};q();hr();sn();Nh();OT();ft();sv();qe();Tr();Yn();ni();pc();Ar();var ydt={kernelName:th,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,i]=t,o=n,s=r,a=Ft(o.shape,s.shape);return{a:()=>{let c=de(s,"float32"),f=j(e,j(c,us(o,De(c,Pe(1))))),d=Hn(o.shape,a);return d.length>0&&(f=Me(f,d)),V(f,o.shape)},b:()=>{let c=Ur(o,0),f=or(c,Co(o),lt(o)),d=j(e,j(i,f)),p=Hn(s.shape,a);return p.length>0&&(d=Me(d,p)),V(d,s.shape)}}}};q();hr();Nh();ft();qe();ni();pc();Ar();var vdt={kernelName:fx,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,r]=t,i=Ur(n,0);return{x:()=>or(i,e,j(e,r)),alpha:()=>{let o=or(i,lt(e),j(e,n)),s=Hn(r.shape,e.shape);return s.length>0&&(o=Me(o,s)),V(o,r.shape)}}}};aie();q();D6();ft();qe();Bx();function r1n(e,t,n){let r=e.shape.slice();r[n]=1;let i=V(t,r),o=U_(e,n,!0,!1),s=U_(e,n,!0,!0),a=j(o,s);return j(i,a)}function i1n(e,t,n){let r=e.shape.length,i=r-n.length,o=P.getAxesPermutation(n,r),s=e;o!=null&&(s=zt(e,o));let a=s.shape.slice(),u=a.splice(r-n.length,n.length).reduce((d,p)=>d*p,1);a.push(u);let c=s.reshape(a),f=r1n(c,t,i);if(f=f.reshape(s.shape),o!=null){let d=P.getUndoAxesPermutation(o);f=zt(f,d)}return f}var wdt={kernelName:dx,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n,o=[];return i==null?o=r.shape.map((s,a)=>a):typeof i=="number"?o=[i]:o=i,{x:()=>i1n(r,e,o)}}};q();hr();sn();Ln();ft();_o();qe();Ui();ni();var Cdt={kernelName:Lm,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=Fe(e,de(r,"float32")),l=Hn(n.shape,i);return l.length>0?V(Me(a,l),n.shape):a},b:()=>{let a=j(e,de(n,"float32")),l=Hn(r.shape,i);l.length>0&&(a=V(Me(a,l),r.shape));let u=jt(r);return qt(Fe(a,de(u,"float32")))}}}};q();Ln();_o();Ui();var _dt={kernelName:nh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,qt(jt(n)))}}};q();sn();uv();ft();XT();var Sdt={kernelName:ih,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=j(eu(n,6),vf(n));return{x:()=>j(e,de(r,"float32"))}}};q();sn();ft();XT();var Edt={kernelName:rh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,de(vf(n),"float32"))}}};q();qe();var Adt={kernelName:px,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>V(e,n.shape)}}};ne();q();var Tdt={kernelName:hx,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,i={dy:e,images:r};return{images:()=>$.runKernel(l_,i,n)}}};ne();q();var kdt={kernelName:mx,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,i={dy:e,images:r};return{images:()=>$.runKernel(a_,i,n)}}};q();Px();ae();var Idt={kernelName:gx,gradFunc:(e,t,n)=>{let{dims:r}=n,i=zi(r,e.shape);return{x:()=>ji(e,i)}}};q();Ar();var Ddt={kernelName:oh,gradFunc:e=>({x:()=>lt(e)})};q();Ln();ft();_o();sv();var Ndt={kernelName:sh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>qt(Fe(e,j(us(n,1.5),2)))}}};q();sn();yO();ft();Ar();var Fdt={kernelName:xx,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>de(lt(n),"float32"),t:()=>j(e,de(n,e.dtype)),e:()=>j(e,de(dv(n),e.dtype))}}};q();sn();kh();Nh();ft();Tr();iie();pc();var Rdt={kernelName:ah,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Ur(n,Pe(0)),i=Pe(nie),o=Pe(rie),s=j(e,o),a=j(j(e,i),Jr(de(n,"float32")));return or(r,s,a)}}}};q();ft();Tr();Yn();var Odt={kernelName:fh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,j(n,De(Pe(1),n)))}}};q();Ar();var Mdt={kernelName:ch,gradFunc:e=>({x:()=>lt(e)})};q();sn();I6();ft();var $dt={kernelName:lh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(iv(de(n,"float32")),e)}}};q();sn();Lne();ft();var Pdt={kernelName:uh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(kT(de(n,"float32")),e)}}};q();mv();J8();var Ldt={kernelName:bx,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{begin:i,size:o}=n,s=r.shape,[a,l]=Qre(r,i,o),u=[];for(let c=0;c<e.rank;c++)u.push([a[c],s[c]-a[c]-l[c]]);return{x:()=>ya(e,u)}}};q();ft();Yn();ni();var Bdt={kernelName:Cx,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:i}=n,o=!0,s=j(e,r);return{logits:()=>De(s,j(Me(s,[i],o),r))}}};q();ft();CT();var zdt={kernelName:dh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,js(n))}}};q();uO();var Awe={kernelName:vx,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:i}=n;return{x:()=>rv(e,r,i)}}};q();dc();var Twe={kernelName:wx,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>En(e,r)}}};q();sn();Ln();ft();Bd();var Udt={kernelName:ph,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,j(Bn(de(n,"float32")),2))}}};q();sn();ft();var jdt={kernelName:x_,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,j(de(n,"float32"),2))}}};q();ft();Tr();Yn();var Vdt={kernelName:mh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Pe(2);return{a:()=>j(e,j(i,De(n,r))),b:()=>j(e,j(i,De(r,n)))}}};q();Ar();var Wdt={kernelName:bh,gradFunc:e=>({x:()=>lt(e)})};q();hr();_o();qe();ni();var Gdt={kernelName:hh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,i=Ft(n.shape,r.shape);return{a:()=>{let a=e,l=Hn(n.shape,i);return l.length>0&&(a=Me(a,l)),V(a,n.shape)},b:()=>{let a=e,l=Hn(r.shape,i);return l.length>0&&(a=Me(a,l)),V(qt(a),r.shape)}}}};q();ft();G_();qe();ae();var qdt={kernelName:yx,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,i=r.shape.slice(),{axis:o}=n;zi(o,r.shape).forEach(u=>{i[u]=1});let a=V(e,i),l=j(a,vi(r.shape,"float32"));return{x:()=>l}}};q();I6();Ln();Ui();var Hdt={kernelName:gh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Fe(e,jt(iv(n)))}}};q();ft();Tr();Ui();Yn();var Ydt={kernelName:xh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(De(Pe(1),jt(n)),e)}}};q();Er();ul();Ar();var Kdt={kernelName:Dd,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{reps:i}=n;return{x:()=>{let s=lt(r);if(r.rank===1)for(let a=0;a<i[0];++a)s=se(s,Mt(e,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<i[0];++a)for(let l=0;l<i[1];++l)s=se(s,Mt(e,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<i[0];++a)for(let l=0;l<i[1];++l)for(let u=0;u<i[2];++u)s=se(s,Mt(e,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<i[0];++a)for(let l=0;l<i[1];++l)for(let u=0;u<i[2];++u)for(let c=0;c<i[3];++c)s=se(s,Mt(e,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return s}}}};q();Ld();Bx();var Xdt={kernelName:Nd,gradFunc:(e,t,n)=>{let r=n,{perm:i}=r,o=pO(i);return{x:()=>zt(e,o)}}};q();vv();var Zdt={kernelName:_x,gradFunc:(e,t,n)=>{let r=n,{axis:i}=r;return{value:()=>Ri(e,i)}}};q();FT();hO();V_();W_();wO();G_();Tr();pc();Ar();var Qdt={kernelName:Sx,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>o1n(e,n)}}};function o1n(e,t){let n=dl(t,lt(t)),r=Dh(e,n),i=ba(t,Pe(0,"int32")),o=r.rank-i.rank;for(let a=0;a<o;++a)i=ri(i,a+1);i=cs(i,vi(r.shape,"bool"));let s=lt(r);return or(i,r,s)}q();Ar();var Jdt={kernelName:Ex,gradFunc:e=>({x:()=>lt(e)})};ZR();var s1n=[KX,ift,oft,sft,aft,lft,uft,cft,fft,dft,pft,mft,gft,bft,yft,vft,wft,Cft,_ft,Sft,Eft,Aft,kft,Tft,Dft,Nft,Fft,Rft,Oft,Mft,Cdt,$ft,Pft,Lft,Bft,zft,jft,Uft,Vft,qft,Hft,Yft,Kft,Xft,Zft,Qft,Jft,edt,tdt,rdt,Swe,Swe,idt,sdt,ldt,udt,cdt,fdt,ddt,pdt,mdt,hdt,gdt,xdt,bdt,Ewe,Ewe,ydt,vdt,wdt,_dt,Sdt,Edt,Adt,Tdt,kdt,Idt,Ddt,Ndt,Fdt,Rdt,Odt,Mdt,$dt,Pdt,Ldt,Bdt,zdt,Awe,Awe,Twe,Twe,Udt,Vdt,jdt,Wdt,Gdt,qdt,Hdt,Ydt,Kdt,Xdt,Zdt,Qdt,Jdt];for(let e of s1n)qte(e);lie();N();N();N();var Jc=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},Xa=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},K=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},yt=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},ZX=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}};var p4=class{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){let r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){let r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}};N();function fd(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{let n=new Array(t);return n.fill(e),n}}function ef(e,t){if(!e)throw new ZX(t)}function Iwe(e,t){let n=0;for(let r of e)r===t&&n++;return n}function $o(e){return e.length===1?e[0]:e}function An(e){return Array.isArray(e)?e:[e]}function dd(e){let n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function oy(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}var cd={};function vF(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function kwe(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>kwe(t));else{let t=Object.keys(e);for(let n of t){let r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:kwe(r))}}}function c0(e,t={},n={},r="object",i=!1){if(typeof e=="string"){let o=e,s;if(o in n)s=n[o];else if(o in cd)s=cd[o];else if(s=t[o],s==null)throw new K(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}else{let o=e;if(o.className==null||o.config==null)throw new K(`${r}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);let s=o.className,a,l;if(s in n?[a,l]=n[s]:s in cd?[a,l]=cd.className:s in t&&([a,l]=t[s]),a==null)throw new K(`Unknown ${r}: ${s}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){let u={};for(let p of Object.keys(cd))u[p]=cd[p];for(let p of Object.keys(n))u[p]=n[p];let c=o.config;c.customObjects=u;let f=Object.assign({},cd);for(let p of Object.keys(n))cd[p]=n[p];kwe(o.config);let d=l(a,o.config,n,i);return cd=Object.assign({},f),d}else{let u=Object.assign({},cd);for(let f of Object.keys(n))cd[f]=n[f];let c=new a(o.config);return cd=Object.assign({},u),c}}}function a1n(e,t){return e<t?-1:e>t?1:0}function m4(e,t){return-1*a1n(e,t)}function pd(e){if(e==null)return e;let t=[];for(let n of e)t.indexOf(n)===-1&&t.push(n);return t}function ept(e){if(e==null)throw new K(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function f0(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new K(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function QX(e,t,n=0,r=1/0){return ef(n>=0),ef(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function mi(e,t){Array.isArray(e)?(A.assert(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>mi(n,`element ${r+1} of ${t}`))):A.assert(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${tpt(e)}.`)}function tpt(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>tpt(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function npt(e,t,n){let r=n!=null?n():A.now(),i;return(...s)=>{let a=n!=null?n():A.now();return a-r<t||(r=a,i=e(...s)),i}}function JX(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}N();var l1n=0;function tZ(){return l1n++}var eZ={};function Hw(e=""){return e in eZ||(eZ[e]=0),eZ[e]+=1,e+eZ[e].toString()}N();var rpt=["channelsFirst","channelsLast"],ipt=["nearest","bilinear"],opt=["valid","same","causal"],spt=["max","avg"],apt=["sum","mul","concat","ave"];var wF=new Map;function Mr(e){f0(rpt,"DataFormat",e)}function upt(e){f0(ipt,"InterpolationFormat",e)}function Za(e){f0(opt,"PaddingMode",e)}function Dwe(e){f0(spt,"PoolMode",e)}var h4=[],lpt="/";function cm(e,t){h4.push(e);try{let n=t();return h4.pop(),n}catch(n){throw h4.pop(),n}}function u1n(){return h4.length===0?"":h4.join(lpt)+lpt}function nZ(e){if(!cpt(e))throw new Error("Not a valid tensor name: '"+e+"'");return u1n()+e}function rZ(e){if(!cpt(e))throw new Error("Not a valid tensor name: '"+e+"'");wF.has(e)||wF.set(e,0);let t=wF.get(e);if(wF.set(e,wF.get(e)+1),t>0){let n=`${e}_${t}`;return wF.set(n,1),n}else return e}var c1n=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function cpt(e){return!!e.match(c1n)}N();N();N();function fpt(e){return e===parseInt(e.toString(),10)}function md(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function rA(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function fm(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function Qa(e,t){if(t<e)throw new K(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let r=e;r<t;++r)n.push(r);return n}N();var Nwe;function Bi(){return Nwe==null&&(Nwe=oO().epsilon()),Nwe}function Ja(){return"channelsLast"}function ua(e,t){return de(e,t)}function ay(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),V(e,n)}function dpt(e,t){return ee(()=>{if(e.shape.length!==2)throw new K(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let n=ay(e,1);return oZ(n,[1,t,1])})}function ppt(e){let t=[md(e.shape)];return V(e,t)}function mpt(e){if(e.rank<=1)throw new K(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],md(e.shape,1)];return V(e,t)}function sy(e,t,n){return ee(()=>{switch(e.rank){case 1:return qT(e,t,n);case 2:return kO(e,[t,0],[n,e.shape[1]]);case 3:return HT(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return X_(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Mt(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Mt(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new K(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function Fwe(e,t,n){return ee(()=>{switch(e.rank){case 1:return qT(e,t,n);case 2:return kO(e,[0,t],[e.shape[0],n]);case 3:return HT(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return X_(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new K(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function g4(e,t,n,r){return ee(()=>{switch(e.rank){case 1:return qT(e,t,n);case 2:switch(r){case 1:return sy(e,t,n);case 2:return Fwe(e,t,n);default:throw new K(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return sy(e,t,n);case 2:return HT(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return Fwe(e,t,n);default:throw new K(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return sy(e,t,n);case 2:return X_(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return X_(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return Fwe(e,t,n);default:throw new K(`The axis is not within the rank of the tensor ${r}`)}default:throw new K(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function CF(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),En(e,t)}function Owe(e,t){switch(e.rank){case 1:return w6([e,t]);case 2:return C6([e,t],0);case 3:return _6([e,t],0);case 4:return S6([e,t],0);default:throw new K(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function oZ(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new K(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return qo(e,t)}function _F(e,t=0,n=1,r,i){return K_(e,t,n,r,i)}function hd(e,t,n,r){if(e.rank<2||t.rank<2)throw new yt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let i=e.shape.slice(-1)[0],o=t.shape.slice(-2)[0];if(i!==o)throw new yt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return Cv.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Rwe(e.rank,r,Ja()):null,activation:n});{let i=e.shape.slice(),o=i.pop();e=V(e,[-1,o]);let s=t.shape.slice(),a=s.pop(),l=s.pop(),u=[...s,a],c=Array.from({length:t.rank},(m,h)=>h===0?t.rank-2:h<=t.rank-2?h-1:h);t=V(zt(t,c),[l,-1]);let f=[...i,...u];return V(Cv.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Rwe(e.rank,r,Ja()):null,activation:n}),f)}}function sZ(e,t,n){return ee(()=>(Array.isArray(t)?t=xr(t,"int32"):t=de(t,"int32"),Dh(e,t,n)))}function iA(e){return j(e,e)}function Rwe(e,t,n){let r=t.shape;if(t.rank!==1&&t.rank!==e)throw new K(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?V(t,[1,r[0],1,1,1]):V(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?V(t,[1,1,1,1,r[0]]):V(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?V(t,[1,r[0],1,1]):V(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?V(t,[1,1,1,r[0]]):V(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?V(t,[1,r[0],1]):V(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?V(t,[1,1,r[0]]):V(t,[1].concat(r))}else if(e<3)return t;throw new K(`Unsupported input rank by biasAdd: ${t.rank}`)}function el(e,t,n){return ee(()=>(n==null&&(n=Ja()),Mr(n),se(e,Rwe(e.rank,t,n))))}function hpt(e,t=1){if(t!==1)throw new yt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Th(e)}function gpt(e){return ee(()=>Fe(e,se(mr(e),1)))}function aZ(e,t,n,r){return ee(()=>kre(e,t,n,r))}function xpt(e){return ee(()=>{let t=se(.5,j(.2,e));return vo(t,0,1)})}function Yw(e,t,n=!1){return n?e():t()}var bpt=["fanIn","fanOut","fanAvg"],ypt=["normal","uniform","truncatedNormal"];function f1n(e){f0(bpt,"FanMode",e)}function d1n(e){f0(ypt,"Distribution",e)}var tl=class extends fe.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},Cpt=(()=>{class e extends tl{apply(n,r){return ar(n,r)}}return e.className="Zeros",e})();fe.registerClass(Cpt);var lZ=(()=>{class e extends tl{apply(n,r){return vi(n,r)}}return e.className="Ones",e})();fe.registerClass(lZ);var _pt=(()=>{class e extends tl{constructor(n){if(super(),typeof n!="object")throw new K(`Expected argument of type ConstantConfig but got ${n}`);if(n.value===void 0)throw new K(`config must have value set but got ${n}`);this.value=n.value}apply(n,r){return ee(()=>j(Pe(this.value),vi(n,r)))}getConfig(){return{value:this.value}}}return e.className="Constant",e})();fe.registerClass(_pt);var Spt=(()=>{class e extends tl{constructor(n){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=n.minval||this.DEFAULT_MINVAL,this.maxval=n.maxval||this.DEFAULT_MAXVAL,this.seed=n.seed}apply(n,r){return tu(n,this.minval,this.maxval,r,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return e.className="RandomUniform",e})();fe.registerClass(Spt);var Ept=(()=>{class e extends tl{constructor(n){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=n.mean||this.DEFAULT_MEAN,this.stddev=n.stddev||this.DEFAULT_STDDEV,this.seed=n.seed}apply(n,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new yt(`randomNormal does not support dType ${r}.`);return _F(n,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return e.className="RandomNormal",e})();fe.registerClass(Ept);var Apt=(()=>{class e extends tl{constructor(n){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=n.mean||this.DEFAULT_MEAN,this.stddev=n.stddev||this.DEFAULT_STDDEV,this.seed=n.seed}apply(n,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new yt(`truncatedNormal does not support dType ${r}.`);return QT(n,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return e.className="TruncatedNormal",e})();fe.registerClass(Apt);var Tpt=(()=>{class e extends tl{constructor(n){super(),this.gain=n.gain!=null?n.gain:1}apply(n,r){return ee(()=>{if(n.length!==2||n[0]!==n[1])throw new K("Identity matrix initializer can only be used for 2D square matrices.");return j(this.gain,j_(n[0]))})}getConfig(){return{gain:this.gain}}}return e.className="Identity",e})();fe.registerClass(Tpt);function p1n(e,t="channelsLast"){let n,r;if(Mr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){let i=md(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){let i=md(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{let i=md(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}var Ku=(()=>{class e extends tl{constructor(n){if(super(),n.scale<0)throw new K(`scale must be a positive float. Got: ${n.scale}`);this.scale=n.scale==null?1:n.scale,this.mode=n.mode==null?"fanIn":n.mode,f1n(this.mode),this.distribution=n.distribution==null?"normal":n.distribution,d1n(this.distribution),this.seed=n.seed}apply(n,r){let i=p1n(n),o=i[0],s=i[1],a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,o):this.mode==="fanOut"?a/=Math.max(1,s):a/=Math.max(1,(o+s)/2),this.distribution==="normal"){let l=Math.sqrt(a);if(r=r||"float32",r!=="float32"&&r!=="int32")throw new yt(`${this.getClassName()} does not support dType ${r}.`);return QT(n,0,l,r,this.seed)}else{let l=Math.sqrt(3*a);return tu(n,-l,l,r,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return e.className="VarianceScaling",e})();fe.registerClass(Ku);var Mwe=(()=>{class e extends Ku{constructor(n){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:n==null?null:n.seed})}getClassName(){return Ku.className}}return e.className="GlorotUniform",e})();fe.registerClass(Mwe);var $we=(()=>{class e extends Ku{constructor(n){super({scale:1,mode:"fanAvg",distribution:"normal",seed:n==null?null:n.seed})}getClassName(){return Ku.className}}return e.className="GlorotNormal",e})();fe.registerClass($we);var Pwe=(()=>{class e extends Ku{constructor(n){super({scale:2,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})}getClassName(){return Ku.className}}return e.className="HeNormal",e})();fe.registerClass(Pwe);var Lwe=(()=>{class e extends Ku{constructor(n){super({scale:2,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})}getClassName(){return Ku.className}}return e.className="HeUniform",e})();fe.registerClass(Lwe);var Bwe=(()=>{class e extends Ku{constructor(n){super({scale:1,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})}getClassName(){return Ku.className}}return e.className="LeCunNormal",e})();fe.registerClass(Bwe);var zwe=(()=>{class e extends Ku{constructor(n){super({scale:1,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})}getClassName(){return Ku.className}}return e.className="LeCunUniform",e})();fe.registerClass(zwe);var kpt=(()=>{class e extends tl{constructor(n){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=n.gain==null?this.DEFAULT_GAIN:n.gain,this.seed=n.seed}apply(n,r){return ee(()=>{if(n.length<2)throw new yt("Shape must be at least 2D.");if(r!=="int32"&&r!=="float32"&&r!==void 0)throw new TypeError(`Unsupported data type ${r}.`);r=r;let i=A.sizeFromShape(n.slice(0,-1)),o=n[n.length-1],s=i*o;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);let a=[Math.max(o,i),Math.min(o,i)],l=_F(a,0,1,r,this.seed),u=Pre.qr(l,!1),c=u[0],d=u[1].flatten().stridedSlice([0],[Math.min(o,i)*Math.min(o,i)],[Math.min(o,i)+1]);return c=j(c,d.sign()),i<o&&(c=c.transpose()),j(Pe(this.gain),c.reshape(n))})}getConfig(){return{gain:this.gain,seed:this.seed}}}return e.className="Orthogonal",e})();fe.registerClass(kpt);var vpt={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function wpt(e,t={}){return c0(e,fe.SerializationMap.getMap().classNameMap,t,"initializer")}function dr(e){return vF(e)}function Gn(e){if(typeof e=="string"){let t=e in vpt?vpt[e]:e;if(t==="GlorotNormal")return new $we;if(t==="GlorotUniform")return new Mwe;if(t==="HeNormal")return new Pwe;if(t==="HeUniform")return new Lwe;if(t==="LeCunNormal")return new Bwe;if(t==="LeCunUniform")return new zwe;{let n={};return n.className=t,n.config={},wpt(n)}}else return e instanceof tl?e:wpt(e)}function uZ(e){return Array.isArray(e)&&Array.isArray(e[0])}function SF(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function ct(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new K(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function Ut(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new K(`Expected exactly 1 Shape; got ${e.length}`)}else return e}function EF(e){let t=0;for(let n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}N();N();var Dpt="Variable",x4=class{constructor(t,n="float32",r=Dpt,i=!0,o=null){this.dtype=n??"float32",this.shape=t.shape,this.id=tZ(),r=r??Dpt,this.originalName=nZ(r),this.name=rZ(this.originalName),this.trainable_=i,this.constraint=o,this.val=k8(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),h1n(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}};function h1n(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function b4(e){return e.map(t=>t.read())}function AF(e){e.forEach(t=>{t[0].write(t[1])})}var nr=class{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}},ca=class{constructor(t,n,r,i,o,s,a){this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=o,this.outputTensorIndex=a,this.id=tZ(),s!=null&&(this.originalName=nZ(s),this.name=rZ(this.originalName)),this.rank=n.length}},g1n=0,ly=class{constructor(t,n){this.callArgs=n,this.id=g1n++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(let r of t.inboundLayers)r?.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){let t=[];for(let n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},x1n=0,xt=class extends fe.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=x1n++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){let r=this.getClassName();n=dd(r)+"_"+Hw(r)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let o=null;t.batchSize!=null&&(o=t.batchSize),r=[o].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new Xa(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new K(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return $o(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return $o(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Jc(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Jc(`Layer ${this.name} is not connected, no input to return.`);return $o(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Jc(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Jc(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return $o(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){let n=An(t);if(this.inputSpec==null||this.inputSpec.length===0)return;let r=An(this.inputSpec);if(n.length!==r.length)throw new K(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${t}`);for(let i=0;i<n.length;i++){let o=n[i],s=r[i];if(s==null)continue;let a=o.rank;if(s.ndim!=null&&a!==s.ndim)throw new K(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${a}`);if(s.maxNDim!=null&&a>s.maxNDim)throw new K(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${a}`);if(s.minNDim!=null&&a<s.minNDim)throw new K(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${a}.`);if(s.dtype!=null&&o.dtype!==s.dtype)throw new K(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${o.dtype}.`);if(s.axes){let l=o.shape;for(let u in s.axes){let c=Number(u),f=s.axes[u],d=c>=0?l[c]:l[l.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new K(`Input ${i} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${f} but got shape ${l}.`)}}if(s.shape!=null)for(let l=0;l<s.shape.length;++l){let u=s.shape[l],c=o.shape[l];if(u!=null&&c!=null&&u!==c)throw new K(`Input ${i} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${o.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();let r=An(t),i=v1n(t),o=w1n(t);if(i===o)throw new K("Arguments to apply() must be all SymbolicTensors or all Tensors");return cm(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);let s=[];for(let a of An(t))s.push(a.shape);this.build($o(s)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(t),o){let s=this.call(t,n);this.supportsMasking&&this.setMaskMetadata(t,s);let a=An(s),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(s=$o(l),this.activityRegularizer!=null)throw new yt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}else{let s=b1n(t),a=this.computeOutputShape(s),l,u=y1n(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?s[0]:s),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,f)=>new ca(u,c,this,An(t),n,this.name,f)):l=new ca(u,a,this,An(t),n,this.name),this.addInboundNode(t,l,null,null,s,a,n),this._refCount++,this.activityRegularizer!=null)throw new yt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&t[i]!=null&&t[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Jc(`The layer ${this.name} has never been called and thus has no defined output shape.`);let t=[];for(let n of this.inboundNodes){let r=JSON.stringify(n.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){let n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Jc(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Xa(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return EF(this.weights)}build(t){this.built=!0}getWeights(t=!1){return b4(t?this.trainableWeights:this.weights)}setWeights(t){ee(()=>{let n=this.weights;if(n.length!==t.length)throw new K(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;let r=[],i=b4(n);for(let o=0;o<i.length;++o){let s=i[o],a=n[o],l=t[o];if(!A.arraysEqual(s.shape,l.shape))throw new K(`Layer weight shape ${s.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}AF(r)})}addWeight(t,n,r,i,o,s,a,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new K(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():Gn("zeros"));let u=i.apply(n,r),c=new x4(u,r,t,s,a);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(c.read())),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=An(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(t,n,r){if(!this.supportsMasking)return;let i=this.computeMask(t,r),o=An(n),s=An(i);if(o.length!==s.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=s[a]}addInboundNode(t,n,r,i,o,s,a=null){let l=An(t);n=An(n),r=An(r),i=An(i),o=SF(o),s=SF(s);let u=[],c=[],f=[];for(let d of l)u.push(d.sourceLayer),c.push(d.nodeIndex),f.push(d.tensorIndex);new ly({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:f,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:o,outputShapes:s},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){let t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}};function b1n(e){e=An(e);let t=[];for(let n of e)t.push(n.shape);return $o(t)}function y1n(e){return"float32"}function Uwe(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{let r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{let i=[];for(let o=0;o<r.inboundLayers.length;o++){let s=r.inputTensors[o],a=r.inboundLayers[o],l=r.nodeIndices[o],u=Uwe(s,a,l);for(let c of u)i.indexOf(c)===-1&&i.push(c)}return i}}}function v1n(e){let t=!0;for(let n of An(e))if(!(n instanceof ca)){t=!1;break}return t}function w1n(e){let t=!0;for(let n of An(e))if(n instanceof ca){t=!1;break}return t}var Kw=(()=>{class e extends xt{constructor(n){if(super({dtype:n.dtype,name:n.name!=null?n.name:Hw("input").toString()}),n.batchSize==null&&(n.batchSize=null),n.sparse==null&&(n.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=n.sparse,n.inputShape!=null&&n.batchInputShape!=null)throw new K("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let r=n.batchInputShape;if(r==null){if(n.inputShape==null)throw new K("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[n.batchSize].concat(n.inputShape)}else if(n.batchSize!=null)throw new K("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let i=n.dtype||"float32";this.batchInputShape=r,this.dtype=i,this.inputSpec=[{shape:r}];let o=new ca(this.dtype,this.batchInputShape,this,[],{},this.name);o.nodeIndex=0,o.tensorIndex=0,new ly({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]})}apply(n,r){throw new K(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return e.className="InputLayer",e})();fe.registerClass(Kw);function cZ(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new K("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new Kw({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function C1n(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return de(t,e.dtype)}catch{throw new K(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}var d0=class e{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(let n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(let n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=C1n(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new K(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof ca){if(this.id2Value[t.id]==null)throw new K(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{let n=this.name2Id[t];if(n==null)throw new K(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof ca){if(this.id2Value[t.id]==null)throw new K(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{let n=this.name2Id[t];if(n==null)throw new K(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&_t(this.id2Mask)}},fZ=new p4,dZ=new p4;function Fpt(e){fZ?.setMaxEntries(e),dZ?.setMaxEntries(e)}function oA(e,t,n,r){let i=n==null?!1:n.training,o=Array.isArray(e),s=o?e:[e],a=s.map(m=>m.name),l=[],u=t.names();for(let m of a)u.indexOf(m)!==-1?l.push(t.getValue(m)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let c=a.join(",")+"|"+t.names().sort().join(","),f=fZ.get(c),d;if(f==null){let m=_1n(s,t);f=m.sorted,d=m.recipientCounts,fZ.put(c,f),dZ.put(c,d)}d={},i||Object.assign(d,dZ.get(c));let p=new d0(t);for(let m=0;m<f.length;++m){if(r!=null){let T=pT().numTensors;T>r.maxNumTensors&&(r.maxNumTensors=T),T<r.minNumTensors&&(r.minNumTensors=T)}let h=f[m],g=h.sourceLayer;if(g instanceof Kw)continue;let x=[],b=[],y=[],v=!1;for(let T of h.inputs){let I=p.getValue(T),k=p.getMask(T);x.push(I),b.push(k),k!=null&&(v=!0),i||(d[T.name]--,d[T.name]===0&&!t.hasKey(T)&&a.indexOf(T.name)===-1&&!I.isDisposed&&T.sourceLayer.stateful!==!0&&y.push(I))}v&&(n=n||{},n.mask=b[0]);let C=An(g.apply(x,n)),_=null;g.supportsMasking&&(_=g.computeMask(x,b));let S=E1n(h),E=Array.isArray(S)?S:[S];for(let T=0;T<E.length;++T){p.hasKey(E[T])||p.add(E[T],C[T],Array.isArray(_)?_[0]:_);let I=a.indexOf(E[T].name);I!==-1&&(l[I]=C[T])}i||_t(y)}return p.disposeMasks(),o?l:l[0]}function _1n(e,t){A.assert(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){let i=Npt(e[0],t);n=i.sorted,r=i.recipientMap}else{let i=new Set;for(let o of e){let{sorted:s,recipientMap:a}=Npt(o,t);for(let l of s)i.has(l.name)||(n.push(l),i.add(l.name));for(let l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:S1n(r)}}function S1n(e){let t={};for(let n in e)t[n]=e[n].size;return t}function Npt(e,t){let n=new Set,r=[],i={};for(let a of t.names())n.add(a);let o=[],s=[];for(o.push(e);o.length>0;){let a=o[o.length-1];if(n.has(a.name)){o.pop();continue}let l=s[s.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),r.push(a),n.add(a.name),l&&s.pop();else{s.push(o.length-1);for(let u of a.inputs)i[u.name]==null&&(i[u.name]=new Set),i[u.name].add(a.name),!n.has(u.name)&&o.push(u)}}return{sorted:r,recipientMap:i}}function E1n(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(let i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var A1n=Z();A1n.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Fpt);N();N();N();function jwe(e,t){return ee(()=>Bn(Me(j(e,e),t,!0)))}var sA=class extends fe.Serializable{getConfig(){return{}}},Mpt=(()=>{class e extends sA{constructor(n){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=n.maxValue!=null?n.maxValue:this.defaultMaxValue,this.axis=n.axis!=null?n.axis:this.defaultAxis}apply(n){return ee(()=>{let r=jwe(n,this.axis),i=vo(r,0,this.maxValue);return j(n,Fe(i,se(Bi(),r)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return e.className="MaxNorm",e})();fe.registerClass(Mpt);var $pt=(()=>{class e extends sA{constructor(n){super(),this.defaultAxis=0,this.axis=n.axis!=null?n.axis:this.defaultAxis}apply(n){return ee(()=>Fe(n,se(Bi(),jwe(n,this.axis))))}getConfig(){return{axis:this.axis}}}return e.className="UnitNorm",e})();fe.registerClass($pt);var Ppt=(()=>{class e extends sA{apply(n){return Ho(n)}}return e.className="NonNeg",e})();fe.registerClass(Ppt);var Lpt=(()=>{class e extends sA{constructor(n){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=n.minValue!=null?n.minValue:this.defaultMinValue,this.maxValue=n.maxValue!=null?n.maxValue:this.defaultMaxValue,this.rate=n.rate!=null?n.rate:this.defaultRate,this.axis=n.axis!=null?n.axis:this.defaultAxis}apply(n){return ee(()=>{let r=jwe(n,this.axis),i=se(j(this.rate,vo(r,this.minValue,this.maxValue)),j(1-this.rate,r));return j(n,Fe(i,se(Bi(),r)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return e.className="MinMaxNorm",e})();fe.registerClass(Lpt);var Rpt={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Hr(e){return vF(e)}function Opt(e,t={}){return c0(e,fe.SerializationMap.getMap().classNameMap,t,"constraint")}function Yr(e){if(e==null)return null;if(typeof e=="string"){let n={className:e in Rpt?Rpt[e]:e,config:{}};return Opt(n)}else return e instanceof sA?e:Opt(e)}var I4={};rn(I4,{Layer:()=>xt,RNN:()=>p0,RNNCell:()=>fy,activation:()=>lCn,add:()=>xCn,alphaDropout:()=>e_n,average:()=>bCn,averagePooling1d:()=>s_e,averagePooling2d:()=>a_e,averagePooling3d:()=>l_e,avgPool1d:()=>TCn,avgPool2d:()=>ICn,avgPool3d:()=>NCn,avgPooling1d:()=>kCn,avgPooling2d:()=>DCn,avgPooling3d:()=>FCn,batchNormalization:()=>SCn,bidirectional:()=>qCn,categoryEncoding:()=>o_n,centerCrop:()=>r_n,concatenate:()=>yCn,conv1d:()=>Jwn,conv2d:()=>eCn,conv2dTranspose:()=>tCn,conv3d:()=>nCn,conv3dTranspose:()=>rCn,convLstm2d:()=>jCn,convLstm2dCell:()=>VCn,cropping2D:()=>oCn,dense:()=>uCn,depthwiseConv2d:()=>aCn,dot:()=>_Cn,dropout:()=>cCn,elu:()=>Hwn,embedding:()=>gCn,flatten:()=>dCn,gaussianDropout:()=>JCn,gaussianNoise:()=>QCn,globalAveragePooling1d:()=>RCn,globalAveragePooling2d:()=>OCn,globalMaxPool1d:()=>YCn,globalMaxPool2d:()=>KCn,globalMaxPooling1d:()=>dmt,globalMaxPooling2d:()=>pmt,gru:()=>$Cn,gruCell:()=>PCn,input:()=>Qwe,inputLayer:()=>qwn,layerNormalization:()=>ECn,leakyReLU:()=>Kwn,lstm:()=>LCn,lstmCell:()=>BCn,masking:()=>t_n,maxPool1d:()=>XCn,maxPool2d:()=>ZCn,maxPooling1d:()=>mmt,maxPooling2d:()=>hmt,maxPooling3d:()=>MCn,maximum:()=>vCn,minimum:()=>wCn,multiply:()=>CCn,permute:()=>hCn,prelu:()=>Xwn,randomWidth:()=>s_n,reLU:()=>Ywn,repeatVector:()=>pCn,rescaling:()=>n_n,reshape:()=>mCn,resizing:()=>i_n,rnn:()=>WCn,separableConv2d:()=>iCn,simpleRNN:()=>zCn,simpleRNNCell:()=>UCn,softmax:()=>Zwn,spatialDropout1d:()=>fCn,stackedRNNCells:()=>GCn,thresholdedReLU:()=>Qwn,timeDistributed:()=>HCn,upSampling2d:()=>sCn,zeroPadding2d:()=>ACn});N();N();function uy(e){return te(this,null,function*(){if(e==null)return;let t=[],n=[],r=[];for(let i in e){let o=e[i];if(typeof o!="number"){let s=o;t.push(s.data()),n.push(i),r.push(s)}}if(t.length>0){let i=yield Promise.all(t);for(let o=0;o<i.length;++o)e[n[o]]=i[o][0];_t(r)}})}function pZ(e){if(e!=null)for(let t in e){let n=e[t];typeof n!="number"&&n.dispose()}}var I1n=125,Xw=class{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,n){return te(this,null,function*(){})}onEpochEnd(t,n){return te(this,null,function*(){})}onBatchBegin(t,n){return te(this,null,function*(){})}onBatchEnd(t,n){return te(this,null,function*(){})}onTrainBegin(t){return te(this,null,function*(){})}onTrainEnd(t){return te(this,null,function*(){})}setModel(t){}},mZ=class{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(let n of this.callbacks)n.setParams(t)}setModel(t){for(let n of this.callbacks)n.setModel(t)}onEpochBegin(t,n){return te(this,null,function*(){n==null&&(n={});for(let r of this.callbacks)yield r.onEpochBegin(t,n)})}onEpochEnd(t,n){return te(this,null,function*(){n==null&&(n={});for(let r of this.callbacks)yield r.onEpochEnd(t,n)})}onBatchBegin(t,n){return te(this,null,function*(){n==null&&(n={});for(let r of this.callbacks)yield r.onBatchBegin(t,n)})}onBatchEnd(t,n){return te(this,null,function*(){n==null&&(n={});for(let r of this.callbacks)yield r.onBatchEnd(t,n)})}onTrainBegin(t){return te(this,null,function*(){t==null&&(t={});for(let n of this.callbacks)yield n.onTrainBegin(t)})}onTrainEnd(t){return te(this,null,function*(){t==null&&(t={});for(let n of this.callbacks)yield n.onTrainEnd(t)})}},Vwe=class extends Xw{constructor(){super()}onEpochBegin(t){return te(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(t,n){return te(this,null,function*(){n==null&&(n={});let r=n.size==null?0:n.size;this.seen+=r;for(let i in n){let o=n[i];if(typeof o=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+o*r;else{let s;i in this.totals?s=this.totals[i]:this.totals[i]=0;let a=ee(()=>se(this.totals[i],j(o,r)));this.totals[i]=a,s?.dispose()}}})}onEpochEnd(t,n){return te(this,null,function*(){if(n!=null)for(let r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ee(()=>{let i=j(Fe(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),ro(n[r])}))})}},hZ=class extends Xw{onTrainBegin(t){return te(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(t,n){return te(this,null,function*(){n==null&&(n={}),this.epoch.push(t);for(let r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])})}syncData(){return te(this,null,function*(){let t=[],n=[],r=[];for(let o in this.history){let s=this.history[o];for(let a=0;a<s.length;++a)if(typeof s[a]!="number"){let l=s[a];t.push(l.data()),n.push(o),r.push(a)}}let i=yield Promise.all(t);for(let o=0;o<i.length;++o)this.history[n[o]][r[o]].dispose(),this.history[n[o]][r[o]]=i[o][0]})}},gZ=class extends Xw{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||ik,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=I1n),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");A.isNumber(this.yieldEvery)&&(this.maybeWait=npt(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,n,r){return te(this,null,function*(){let i=[];this.yield!=null&&(yield uy(r),i.push(this.yield(t,n,r))),i.push(this.nextFrameFunc()),yield Promise.all(i)})}onEpochBegin(t,n){return te(this,null,function*(){this.currentEpoch=t,this.epochBegin!=null&&(yield uy(n),yield this.epochBegin(t,n))})}onEpochEnd(t,n){return te(this,null,function*(){let r=[];this.epochEnd!=null&&(yield uy(n),r.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),yield Promise.all(r)})}onBatchBegin(t,n){return te(this,null,function*(){this.batchBegin!=null&&(yield uy(n),yield this.batchBegin(t,n))})}onBatchEnd(t,n){return te(this,null,function*(){let r=[];this.batchEnd!=null&&(yield uy(n),r.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):A.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),yield Promise.all(r)})}onTrainBegin(t){return te(this,null,function*(){this.trainBegin!=null&&(yield uy(t),yield this.trainBegin(t))})}onTrainEnd(t){return te(this,null,function*(){this.trainEnd!=null&&(yield uy(t),yield this.trainEnd(t))})}};function xZ(e,t){return e==null&&(e={}),e instanceof Xw?[e]:Array.isArray(e)&&e[0]instanceof Xw?e:An(e).map(r=>new gZ(r,t))}var Bpt=(()=>{class e{constructor(){}static registerCallbackConstructor(n,r){A.assert(n>=0&&Number.isInteger(n),()=>`Verbosity level is expected to be an integer >= 0, but got ${n}`),e.checkForDuplicate(r),e.constructors[n]==null&&(e.constructors[n]=[]),e.constructors[n].push(r)}static checkForDuplicate(n){for(let r in e.constructors)e.constructors[+r].forEach(o=>{if(o===n)throw new K("Duplicate callback constructor.")})}static clear(){e.constructors={}}static createCallbacks(n){let r=[];for(let i in e.constructors){let o=+i;n>=o&&r.push(...e.constructors[o])}return r.map(i=>new i)}}return e.constructors={},e})();function bZ(e,t,n,r,i,o,s,a,l){let u=new hZ,c=[new Vwe,...Bpt.createCallbacks(t)];e!=null&&c.push(...e),c.push(u);let f=new mZ(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:o,batchSize:s,verbose:t,doValidation:a,metrics:l}),{callbackList:f,history:u}}N();N();N();function Xu(e,t={},n=!1){return c0(e,fe.SerializationMap.getMap().classNameMap,t,"layer",n)}N();N();function y4(e,t){return ee(()=>{e.dtype!=="float32"&&(e=de(e,"float32"));let n=Me(iA(e),t,!0),r=bf(n.shape,Bi()),i=Bn(dl(n,r));return Fe(e,i)})}function aA(e,t){return ee(()=>sr(iA(De(t,e)),-1))}function w4(e,t){return ee(()=>sr(mr(De(t,e)),-1))}function C4(e,t){return ee(()=>{let n=De(e,t),r=vo(mr(e),Bi(),Number.MAX_VALUE),i=mr(Fe(n,r));return j(100,sr(i,-1))})}function D1n(e,t){return ee(()=>{let n=vo(t,Bi(),Number.MAX_VALUE),r=Co(se(1,n)),i=vo(e,Bi(),Number.MAX_VALUE),o=Co(se(1,i));return sr(iA(De(r,o)),-1)})}function N1n(e,t){return ee(()=>{let n=dl(0,De(1,j(e,t)));return sr(iA(n),-1)})}function F1n(e,t){return ee(()=>{let n=dl(0,De(1,j(e,t)));return sr(n,-1)})}function R1n(e,t){return ee(()=>{let n=Me(j(e,t),-1),r=wo(j(De(1,e),t),-1);return dl(0,se(1,De(r,n)))})}function O1n(e,t){return ee(()=>{let n=Math.log(2),r=De(t,e),i=De(se(r,zd(j(-2,r))),n);return sr(i,-1)})}function lA(e,t,n=!1){return ee(()=>{if(n)t=xv(t);else{let r=Me(t,t.shape.length-1,!0);t=Fe(t,r)}return t=vo(t,Bi(),1-Bi()),qt(Me(j(de(e,"float32"),Co(t)),t.shape.length-1))})}function TF(e,t,n=!1){return ee(()=>{let r=de(Ih(ppt(e)),"int32");t=vo(t,Bi(),1-Bi());let i=t.shape,o=V(Fh(r,i[i.length-1]),i);return lA(o,t,n)})}function M1n(e,t){if(!A.arraysEqual(e.shape,t.shape))throw new K(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return ee(()=>{let n=Ho(t),r=qt(mr(t));return se(De(n,j(t,e)),cv(Jr(r)))})}function kF(e,t){return ee(()=>{let n;return n=vo(t,Bi(),1-Bi()),n=Co(Fe(n,De(1,n))),sr(M1n(e,n),-1)})}function $1n(e,t){return ee(()=>{let n=vo(e,Bi(),1),r=vo(t,Bi(),1);return Me(j(e,Co(Fe(n,r))),-1)})}function P1n(e,t){return ee(()=>{let n=Co(se(Bi(),t));return sr(De(t,j(e,n)),-1)})}function yZ(e,t){return ee(()=>{let n=y4(e,-1),r=y4(t,-1),i=j(n,r);return qt(Me(i,-1))})}var v4={meanSquaredError:aA,meanAbsoluteError:w4,meanAbsolutePercentageError:C4,meanSquaredLogarithmicError:D1n,squaredHinge:N1n,hinge:F1n,categoricalHinge:R1n,logcosh:O1n,categoricalCrossentropy:lA,sparseCategoricalCrossentropy:TF,binaryCrossentropy:kF,kullbackLeiblerDivergence:$1n,poisson:P1n,cosineProximity:yZ};function vZ(e){if(typeof e=="string"){if(e in v4)return v4[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new K(t)}else return e}N();N();function CZ(e,t){return ee(()=>{let n=j(.5,oo(t)),r=ua(Ur(t,n),e.dtype);return sr(Vs(e,r),-1)})}function _Z(e,t){return ee(()=>ua(Vs(Ch(e,-1),Ch(t,-1)),"float32"))}function L1n(e,t){return ee(()=>de(Me(cs(Vs(e,1),Vs(t,1))),"float32"))}function B1n(e,t){return ee(()=>de(Me(cs(Vs(e,0),Vs(t,1))),"float32"))}function Upt(e,t){return ee(()=>{let n=L1n(e,t),r=B1n(e,t),i=se(n,r);return de(or(Ur(i,0),Fe(n,i),0),"float32")})}function Wwe(e,t){return kF(e,t)}function Gwe(e,t){return e.rank===t.rank&&(e=nu(e,[e.rank-1])),t=Ch(t,-1),t.dtype!==e.dtype&&(t=de(t,e.dtype)),de(Vs(e,t),"float32")}var z1n=aA,U1n=aA,j1n=w4,V1n=w4,W1n=C4,G1n=C4,SZ=lA,q1n=yZ,qwe=TF,wZ={binaryAccuracy:CZ,categoricalAccuracy:_Z,precision:Upt,categoricalCrossentropy:SZ,sparseCategoricalCrossentropy:qwe,mse:z1n,MSE:U1n,mae:j1n,MAE:V1n,mape:W1n,MAPE:G1n,cosine:q1n};function jpt(e){if(typeof e=="string"&&e in wZ)return wZ[e];if(typeof e!="string"&&e!=null)return e;throw new K(`Unknown metric ${e}`)}function _4(e){if(ef(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(let n of Object.keys(v4))if(v4[n]===e){t=n;break}if(t!==void 0)return t;for(let n of Object.keys(wZ))if(wZ[n]===e){t=n;break}return t!==void 0?t:e.name}}N();function Wpt(e){let t={Adagrad:()=>Cf.adagrad(.01),Adadelta:()=>Cf.adadelta(1,.95,Bi()),Adam:()=>Cf.adam(.001,.9,.999,Bi()),Adamax:()=>Cf.adamax(.002,.9,.999,Bi(),0),RMSProp:()=>Cf.rmsprop(.001,.9,0,Bi()),SGD:()=>Cf.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new K(`Unknown Optimizer ${e}`)}function Ywe(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!Hwe(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let r=JSON.stringify(e);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function Hwe(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if(typeof n!="string"||!Hwe(e[n]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!Hwe(t))return!1;return!0}else return!1;else{let t=typeof e;return t==="string"||t==="number"||t==="boolean"}}function Gpt(e,t,n,r=console.log){let i=K1n(e),o=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(t*c)));let s;if(!i){o.push("Receives inputs"),s=[];for(let c in e.nodesByDepth)s.push(...e.nodesByDepth[c])}r("_".repeat(t)),EZ(o,n,r),r("=".repeat(t));let a=e.layers;for(let c=0;c<a.length;++c)i?X1n(a[c],n,r):Z1n(a[c],n,s,r),r((c===a.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=Y1n(e),u=EF(e.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(t))}function Y1n(e){let t;return e.collectedTrainableWeights!=null?t=EF(e.collectedTrainableWeights):t=EF(e.trainableWeights),t}function K1n(e){let t=!0,n=[],r=[];for(let i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(let i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(let i of e.layers){let o=!1;for(let s of i.inboundNodes)if(r.indexOf(s)!==-1)if(o){t=!1;break}else o=!0;if(!t)break}return t}function EZ(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function X1n(e,t,n){let r,i;try{i=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}let o=e.name,s=e.getClassName(),a=[`${o} (${s})`,i,r,e.countParams().toString()];EZ(a,t,n)}function Z1n(e,t,n,r){let i,o;try{o=e.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{o="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}let s=[];for(let f of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let d=0;d<f.inboundLayers.length;++d){let p=f.inboundLayers[d].name,m=f.nodeIndices[d],h=f.tensorIndices[d];s.push(`${p}[${m}][${h}]`)}let a=e.name,l=e.getClassName(),u=s.length===0?"":s[0],c=[`${a} (${l})`,o,i,e.countParams().toString(),u];EZ(c,t,r);for(let f=1;f<s.length;++f)EZ(["","","","",s[f]],t,r)}function qpt(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function S4(e,t){if(e===null)return null;if(typeof e=="string")return oy(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let i=0;i<r;++i){let o=e[i];qpt(t,i,o)?n.push(o):n.push(S4(o,t))}return n}else{let n={};for(let r of Object.keys(e)){let i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{let o=oy(r);n[o]=S4(i,o)}}return n}}function AZ(e,t){if(e==null)return null;if(typeof e=="string")return dd(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let i=0;i<r;++i){let o=e[i];qpt(t,i,o)?n.push(o):n.push(AZ(o,t))}return n}else{let n={};for(let r of Object.keys(e)){let i=e[r],o=dd(r);(r==="name"||r==="className")&&typeof i=="string"?n[o]=i:n[o]=AZ(i,r)}return n}}var IF="4.19.0";N();var Q1n=e=>{let t=Object.keys(e);if(t.length===0)return!1;let n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))},TZ=class e extends xt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){let b=this.getClassName().toLowerCase();this.name=Hw(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],pd(this.inputs).length!==this.inputs.length)throw new K(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);pd(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let b of this.outputs){let y=b.sourceLayer,v=b.nodeIndex,C=b.tensorIndex;this.outputLayers.push(y),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(C)}for(let b of this.inputs){let y=b.sourceLayer,v=b.nodeIndex,C=b.tensorIndex;ef(v===0,"input layer has >1 nodes"),ef(C===0,"input layer has >1 tensors"),this.inputLayers.push(y),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){let y=this.inputLayers[b];if(!(y instanceof Kw))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${b} (0-based) originates from layer type ${y.getClassName()}.`);this.inputNames.push(y.name),this.feedInputShapes.push(y.batchInputShape),this.feedInputNames.push(y.name)}for(let b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);let n={},r={},i={},o={},s={},a=[],l=(b,y,v,C,_,S)=>{(C==null||_==null||S==null)&&(C=b.sourceLayer,_=b.nodeIndex,S=b.tensorIndex);let E=C.inboundNodes[_];if(v.indexOf(E)!==-1)throw new Xa(`The tensor ${b.name} at layer "${C.name}" is part of a cycle.`);if(y.indexOf(E)!==-1)return;this.containerNodes.add(e.nodeKey(C,_)),C.id in s||(s[C.id]=Object.keys(s).length),v.indexOf(E)===-1&&v.push(E);let T=E.inboundLayers.length;for(let I=0;I<T;I++){let k=E.inputTensors[I],O=E.inboundLayers[I],F=E.nodeIndices[I],B=E.tensorIndices[I];l(k,y,v,O,F,B)}for(y.push(E);v.indexOf(E)>=0;)v.splice(v.indexOf(E),1);a.push(E)},u=[],c=[];for(let b of this.outputs)l(b,u,c);let f=a.slice().reverse();for(let b of f){r[b.id]=b,b.id in n||(n[b.id]=0);let y=n[b.id],v=i[b.outboundLayer.id]==null?0:i[b.outboundLayer.id];y=Math.max(y,v),i[b.outboundLayer.id]=y,o[b.outboundLayer.id]=b.outboundLayer,n[b.id]=y;for(let C=0;C<b.inboundLayers.length;C++){let _=b.inboundLayers[C],S=b.nodeIndices[C],E=_.inboundNodes[S],T=n[E.id]==null?0:n[E.id];n[E.id]=Math.max(y+1,T),r[E.id]=E}}let d={};for(let b in n){let y=n[b];y in d||(d[y]=[]),d[y].push(r[b])}let p={};for(let b in i){let y=i[b];y in p||(p[y]=[]),p[y].push(o[b])}let m=Object.keys(p).map(b=>parseInt(b,10)).sort(m4);this.layers=[];for(let b of m){let y=p[b];y.sort((v,C)=>{let _=s[v.id],S=s[C.id];return _<S?-1:_>S?1:0});for(let v of y)v instanceof e&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=p,m=Object.keys(d).map(b=>parseInt(b,10)).sort(m4);let h=this.inputs.slice(),g=[];for(let b of m)for(let y of d[b]){let v=y.outboundLayer;if(v!=null){for(let C of y.inputTensors)if(h.indexOf(C)===-1)throw new Xa(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${v.name}". The following previous layers were accessed without issue: ${g}`);for(let C of y.outputTensors)h.push(C);g.push(v.name)}}this.nodesByDepth=d;let x=this.layers.map(b=>b.name);for(let b of x){let y=x.filter(v=>v===b).length;if(y!==1)throw new Xa(`The name "${b}" is used ${y} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new ly({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(let n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new K("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(let n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){let t=[];for(let n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){let n=[];for(let r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){let r={},i=0,o=Q1n(t);o&&this.parseWeights(t);for(let a of this.layers)for(let[l,u]of a.weights.entries()){let c=o?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[c]!=null)throw new K(`Duplicate weight name: ${c}`);r[c]=u,i++}let s=[];for(let a in t){let l=a;if(r[a]==null){let u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)s.push([r[l],t[a]]);else if(n)throw new K(`Provided weight data has no target variable: ${a}`);delete r[l]}if(n){let a=[];for(let l in r)a.push(l);if(a.length>0)throw new K(`${a.length} of ${i} weights are not set: ${a}`)}AF(s)}parseWeights(t){for(let n in Object.keys(t)){let r=n.split("/"),i=["vars","layer_checkpoint_dependencies"],o=r.map(s=>s.startsWith("_")?s.slice(1):s).filter(s=>!i.includes(s)).join("/");o!==n&&(t[o]=t[n],delete t[n])}}updatedConfig(){let t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${IF}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){let r=AZ(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return ee(()=>{t=An(t);let r=new d0;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return oA(this.outputs,r,n)})}computeMask(t,n){return ee(()=>{t=An(t);let r;return n==null?r=fd(null,t.length):r=An(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){let n=SF(t);if(n.length!==this.inputLayers.length)throw new K(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);let r={};for(let a=0;a<n.length;a++){let l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";r[c]=u}let i=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(m4);if(i.length>1)for(let a of i){let l=this.nodesByDepth[a];for(let u of l){let c=u.outboundLayer;if(this.inputLayers.map(h=>h.id).indexOf(c.id)!==-1)continue;let f=[];for(let h=0;h<u.inboundLayers.length;h++){let g=u.inboundLayers[h],x=u.nodeIndices[h],b=u.tensorIndices[h],y=`${g.name}_${x}_${b}`,v=r[y];f.push(v)}let d=c.computeOutputShape($o(f)),p=SF(d),m=c.inboundNodes.indexOf(u);for(let h=0;h<p.length;h++){let g=`${c.name}_${m}_${h}`;r[g]=p[h]}}}let o=[],s=[];for(let a=0;a<this.outputLayers.length;a++){let l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],f=`${l.name}_${u}_${c}`;s.push(f)}for(let a=0;a<s.length;a++){let l=s[a];ef(l in r),o.push(r[l])}return $o(o)}runInternalGraph(t,n){n==null&&(n=fd(null,t.length));let r={};for(let l=0;l<this.inputs.length;++l){let u=this.inputs[l],c=t[l],f=n[l];r[u.id]=[c,f]}let i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(m4);for(let l of i){let u=this.nodesByDepth[l];for(let c of u){let f=c.outboundLayer,d=c.inputTensors,p=c.outputTensors,m=new Array;for(let h of d)h.id in r&&m.push(r[h.id]);if(m.length===d.length){let h={},g,x,b,y;if(c.callArgs!=null&&(h=c.callArgs),m.length===1){let[v,C]=m[0];h.mask==null&&(h.mask=C),b=An(f.call(v,h)),y=An(f.computeMask(v,C)),g=[v],x=[C]}else g=m.map(v=>v[0]),x=m.map(v=>v[1]),h.mask==null&&(h.mask=x),b=An(f.call(g,h)),y=An(f.computeMask(g,x));if(f.activityRegularizer)throw new yt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<p.length;++v){let C=p[v],_=b[v],S=y[v];r[C.id]=[_,S]}}}}let o=[],s=[],a=[];for(let l of this.outputs){ef(l.id in r,`Could not compute output ${l.name} : ${l.id}`);let[u,c]=r[l.id];a.push(u.shape),o.push(u),s.push(c)}return[o,s,a]}buildNodeConversionMap(t){let n={},r;for(let i of this.layers){r=i instanceof e?1:0;for(let o=0;o<i.inboundNodes.length;o++){let s=e.nodeKey(i,o);this.containerNodes.has(s)&&(n[s]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new K("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(let r of this.layers)if(r.name===t)return r;throw new K(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new K(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return ee(()=>{let t=[];for(let n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){let i=e.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){let t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(let s of this.layers){let a=s.getClassName(),l=s.getConfig(),u=[];for(let f=0;f<s.inboundNodes.length;f++){let d=s.inboundNodes[f],p=e.nodeKey(s,f),m={};if(this.containerNodes.has(p)){if(d.callArgs)try{JSON.stringify(d.callArgs),m=d.callArgs}catch{console.warn(`Layer ${s.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(d.inboundLayers.length>0){let h=[];for(let g=0;g<d.inboundLayers.length;g++){let x=d.inboundLayers[g],b=d.nodeIndices[g],y=d.tensorIndices[g],v=e.nodeKey(x,b),C=n[v];C==null&&(C=0),h.push([x.name,C,y,m])}u.push(h)}}}let c={};c.name=s.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}t.layers=r;let i=[];for(let s=0;s<this.inputLayers.length;s++){let a=this.inputLayers[s],l=this.inputLayersNodeIndices[s],u=e.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);let f=this.inputLayersTensorIndices[s];i.push([a.name,c,f])}t.inputLayers=i;let o=[];for(let s=0;s<this.outputLayers.length;s++){let a=this.outputLayers[s],l=this.outputLayersNodeIndices[s],u=e.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);let f=this.outputLayersTensorIndices[s];o.push([a.name,c,f])}return t.outputLayers=o,t}static fromConfig(t,n,r={},i=!1){let o={},s={};function a(g,x){g.name in s?s[g.name].push(x):s[g.name]=[x]}function l(g,x){let b=[],y;for(let v of x){let C=v[0],_=v[1],S=v[2];if(y=v[3]==null?{}:v[3],!(C in o)){a(g,x);return}let E=o[C];if(E.inboundNodes.length<=_){a(g,x);return}let T=E.inboundNodes[_];b.push(T.outputTensors[S])}b.length>0&&g.apply($o(b),y)}function u(g){let x=g.name,b=Xu(g,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(i),o[x]=b,g.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new K(`Corrupted configuration, expected array for nodeData: ${v}`);a(b,v)})}let c=n.name,f=n.layers;for(let g of f)u(g);for(;!ept(s);)for(let g of f){let x=o[g.name];if(x.name in s){let b=s[x.name];delete s[x.name];for(let y of b)l(x,y)}}let d=[],p=[],m=n.inputLayers;for(let g of m){let x=g[0],b=g[1],y=g[2];ef(x in o);let C=o[x].inboundNodes[b].outputTensors;d.push(C[y])}let h=n.outputLayers;for(let g of h){let x=g[0],b=g[1],y=g[2];ef(x in o);let C=o[x].inboundNodes[b].outputTensors;p.push(C[y])}return new t({inputs:d,outputs:p,name:c})}get stateful(){if(this._stateful)throw new K("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let t of this.layers)if(t.stateful)return!0;return!1}resetStates(){ee(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}};N();N();N();function J1n(e,t,n){let r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){let i=[];return t.forEach(o=>{o in e?i.push(e[o]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function kZ(e,t){return J1n(e,t,"classWeight")}function IZ(e,t,n,r){return te(this,null,function*(){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){let i=ee(()=>{if(e.shape.length===1)return ll(e);if(e.shape.length===2){if(e.shape[1]>1)return Ch(e,1);if(e.shape[1]===1)return V(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(yield i.data());_t(i);let s=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);s.push(n[a])}),xr(s,"float32")}else return null})}function Hpt(e,t){return j(e,t)}var ewn=32;function Xpt(e,t){let n,r,i=t;n=i.xs,r=i.ys,A.assert(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let o=Ypt("input",e.inputNames,n),s=Ypt("output",e.outputNames,r),a=o[0].shape[0];A.assert(o.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),A.assert(s.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<o.length;l++)A.assert(o[l].shape[0]===a,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);for(let l=0;l<s.length;l++)A.assert(s[l].shape[0]===a,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);return{xs:o,ys:s}}function Ypt(e,t,n){if(n instanceof Kt)return[n];if(Array.isArray(n))return A.assert(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{let r=[];for(let i of t){if(n[i]==null)throw new K(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function twn(e){if(e.length===3)throw new yt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function Zpt(e,t,n){return te(this,null,function*(){let r=n.batchesPerEpoch!=null;if(A.assert(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),A.assert(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),A.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),A.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),A.assert(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let i=n.validationData!=null,o,s;if(i)if(Kpt(n.validationData))A.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{let g=twn(n.validationData);o=g.xs,s=g.ys}let a=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),u;i?u=l.slice().concat(l.map(g=>"val_"+g)):u=l.slice();let c=xZ(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:d,history:p}=bZ(c,f,n.epochs,null,null,nwn(t,n),null,i,u);d.setModel(e),e.history=p,yield d.onTrainBegin(),e.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,h=yield t.iterator();for(;m<n.epochs;){let g={};yield d.onEpochBegin(m);let x=0,b=0;for(r||(h=yield t.iterator());!r||x<n.batchesPerEpoch;){let y=yield h.next();if(r&&y.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(y.value!=null){let{xs:v,ys:C}=Xpt(e,y.value),_={};_.batch=b,_.size=v[0].shape[0],yield d.onBatchBegin(b,_);let S=[];if(n.classWeight!=null){let I=kZ(n.classWeight,e.outputNames);for(let k=0;k<I.length;++k)S.push(yield IZ(C[k],null,I[k]))}let E=v.concat(C).concat(S),T=a(E);_t(E);for(let I=0;I<l.length;++I){let k=l[I],O=T[I];_[k]=O,ro(O)}yield d.onBatchEnd(b,_),pZ(_),b++,x++}if(r?x>=n.batchesPerEpoch:y.done){if(i){let v;Kpt(n.validationData)?v=An(yield e.evaluateDataset(n.validationData,{batches:n.validationBatches})):v=An(e.evaluate(o,s,{batchSize:n.validationBatchSize==null?ewn:n.validationBatchSize,verbose:0}));for(let C=0;C<e.metricsNames.length;++C)g[`val_${e.metricsNames[C]}`]=v[C]}break}if(e.stopTraining_)break}if(yield d.onEpochEnd(m,g),m++,e.stopTraining_)break}return yield d.onTrainEnd(),yield e.history.syncData(),e.history}finally{e.isTraining=!1}})}function nwn(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function Kpt(e){return typeof e.iterator=="function"}function rwn(e){return typeof e.next=="function"}function Qpt(e,t,n){return te(this,null,function*(){n=n||{};let r=n.batches!=null,i=e.testFunction,o=[];if(n.verbose>0)throw new yt("Verbose mode is not implemented yet.");A.assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);let s=rwn(t)?t:yield t.iterator(),a=0,l=0;for(;!r||l<n.batches;){let u=yield s.next();if(o=ee(()=>{if(u.value){let{xs:c,ys:f}=Xpt(e,u.value),d=c.concat(f),p=ee(()=>i(d));if(_t(d),l===0)for(let h=0;h<p.length;++h)o.push(Pe(0));let m=d[0].shape[0];for(let h=0;h<p.length;++h){let g=p[h],x=o[h];o[h]=ee(()=>se(o[h],j(m,g))),l>0&&_t(x)}_t(p),a+=m,++l}return o}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){let c=o[u];o[u]=Fe(o[u],a),_t(c)}return $o(o)})}N();N();function DZ(e){A.assert(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function DF(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>sy(r,t,n-t)):sy(e,t,n-t)}function NZ(e,t){return ee(()=>e==null?null:Array.isArray(e)?e.map(n=>NZ(n,t)):sZ(e,t.dtype==="int32"?t:de(t,"int32")))}function FZ(e,t){let n=[],r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function Kwe(e){let t=[];e instanceof Kt&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(r.rank===1)t.push(ay(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function gd(e,t){if(e==null)return;let n=[];if(t instanceof Kt)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(let i in t){let o=t[i];n.push(o.id)}let r=[];if(e instanceof Kt)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(let i in e){let o=e[i];n.indexOf(o.id)===-1&&r.push(o)}r.forEach(i=>{i.isDisposed||i.dispose()})}function iwn(e){return e instanceof Kt}function Xwe(e){return Array.isArray(e)}function Jpt(e){return!iwn(e)&&!Xwe(e)}function emt(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let s=!1;if(Xwe(e)&&e.length>0)s=!0;else if(Jpt(e)){for(let a in e)if(e.hasOwnProperty(a)){s=!0;break}}else s=!0;if(s)throw new K(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(s=>null);let o;if(Jpt(e)){e=e,o=[];for(let s of t){if(e[s]==null)throw new K(`No data provided for "${s}". Need data for each key in: ${t}`);o.push(e[s])}}else if(Xwe(e)){if(e=e,e.length!==t.length)throw new K(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);o=e}else{if(e=e,t.length>1)throw new K(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);o=[e]}if(o=Kwe(o),n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let a=o[s];if(a.shape.length!==n[s].length)throw new K(`Error when checking ${i}: expected ${t[s]} to have ${n[s].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let u=a.shape[l],c=n[s][l];if(c!=null&&c>=0&&u!==c)throw new K(`${i} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${i} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function own(e,t,n){let r=pd(e.map(o=>o.shape[0]));r.sort();let i=pd(t.map(o=>o.shape[0]));if(i.sort(),r.length>1)throw new K(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(i.length>1)throw new K(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(r.length>0&&i.length>0&&!A.arraysEqual(r,i))throw new K(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function swn(e,t,n){let r=[aA,kF,lA];for(let i=0;i<e.length;++i){let o=e[i],s=t[i],a=n[i];if(s!=null){if(s===lA&&o.shape[o.shape.length-1]===1)throw new K(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(s)!==-1){let l=o.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){let f=l[c],d=u[c];if(d!=null&&f!==d)throw new K(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function tmt(e,t,n,r=!0,i=""){let o;if(Array.isArray(e)){if(e.length!==t.length)throw new K(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);o=e}else{if(t.length>1)throw new K(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);o=[e]}if(n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let a=o[s];if(a.shape.length!==n[s].length)throw new K(`Error when checking ${i}: expected ${t[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let u=a.shape[l],c=n[s][l];if(c!=null&&c!==u)throw new K(`Error when checking ${i}: expected ${t[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function awn(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{let r=[];for(let i of t){let o=n.hasOwnProperty(i)?n[i]:[];Array.isArray(o)||(o=[o]),r.push(o)}return r}}var lwn="layers-model",cy=(()=>{class e extends TZ{constructor(n){super(n),this.isTraining=!1}summary(n,r,i=console.log){if(!this.built)throw new K("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Gpt(this,n,r,i)}compile(n){if(n.loss==null&&(n.loss=[]),this.loss=n.loss,typeof n.optimizer=="string")this.optimizer_=Wpt(n.optimizer),this.isOptimizerOwned=!0;else{if(!(n.optimizer instanceof Yo))throw new K("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=n.optimizer,this.isOptimizerOwned=!1}let r=[];if(!Array.isArray(n.loss)&&typeof n.loss!="string"&&typeof n.loss!="function"){n.loss=n.loss;for(let a in n.loss)if(this.outputNames.indexOf(a)===-1)throw new K(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(let a of this.outputNames)n.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),r.push(vZ(n.loss[a]))}else if(Array.isArray(n.loss)){if(n.loss.length!==this.outputs.length)throw new K(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${n.loss}.`);r=n.loss.map(l=>vZ(l))}else{let a=vZ(n.loss);this.outputs.forEach(l=>{r.push(a)})}this.lossFunctions=r,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){let l=this.internalOutputShapes[a],u=this.outputNames[a];this.feedOutputNames.push(u),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[a])}let i=[];this.metrics=n.metrics,this.metricsNames=["loss"],this.metricsTensors=[],cm("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(i.indexOf(a)!==-1)continue;let l=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([l,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});let o=awn(n.metrics,this.outputNames),s=(a,l,u)=>{this.outputNames.length>1&&(l=this.outputNames[a]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([u,a])};cm("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(i.indexOf(a)!==-1)continue;let l=o[a];(c=>{let f="",d,p,m;for(let h of c){if(typeof h=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(h)!==-1){let x=this.internalOutputShapes[a];x[x.length-1]===1||this.lossFunctions[a]===kF?["accuracy","acc"].indexOf(h)!==-1?p=CZ:["crossentropy","ce"].indexOf(h)!==-1&&(p=Wwe):this.lossFunctions[a]===TF?["accuracy","acc"].indexOf(h)!==-1?p=Gwe:["crossentropy","ce"].indexOf(h)!==-1&&(p=qwe):["accuracy","acc"].indexOf(h)!==-1?p=_Z:["crossentropy","ce"].indexOf(h)!==-1&&(p=SZ);let b;["accuracy","acc"].indexOf(h)!==-1?b="acc":["crossentropy","ce"].indexOf(h)!==-1&&(b="ce"),m=p,d=f+b}else m=jpt(h),d=f+_4(h);let g;cm(d,()=>{g=m}),s(a,d,g)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(n,r,i={}){let o=i.batchSize==null?32:i.batchSize;DZ(o);let a=this.standardizeUserDataXY(n,r,!0,o);try{let l=a[0].concat(a[1]);this.makeTestFunction();let u=this.testFunction,c=this.testLoop(u,l,o,i.verbose,i.steps);return $o(c)}finally{gd(a[0],n),gd(a[1],r)}}evaluateDataset(n,r){return te(this,null,function*(){return this.makeTestFunction(),Qpt(this,n,r)})}checkNumSamples(n,r,i,o="steps"){let s;if(i!=null){if(s=null,r!=null)throw new K(`If ${o} is set, batchSize must be null or undefined.Got batchSize = ${r}`)}else if(n!=null)Array.isArray(n)?s=n[0].shape[0]:s=n.shape[0];else throw new K(`Either the input data should have a defined shape, or ${o} shoud be specified.`);return s}execute(n,r){if(Array.isArray(r)&&r.length===0)throw new K("`outputs` is an empty Array, which is not allowed.");let i=Array.isArray(r),o=i?r:[r],s=this.retrieveSymbolicTensors(o),a=new d0;if(n instanceof Kt&&(n=[n]),Array.isArray(n)){if(n.length!==this.inputs.length)throw new K(`The number of inputs provided (${n.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let u=0;u<this.inputs.length;++u)a.add(this.inputs[u],n[u])}else for(let u of this.inputs){let c=n[u.name];if(c==null)throw new K(`No value is provided for the model's input ${u.name}`);a.add(u,c)}let l=oA(s,a);return i?l:l[0]}retrieveSymbolicTensors(n){let r=fd(null,n.length),i=n.length;for(let o of this.layers){let s=Array.isArray(o.output)?o.output:[o.output],a=s.map(l=>l.name);for(let l=0;l<n.length;++l){let u=a.indexOf(n[l]);if(u!==-1&&(r[l]=s[u],i--),i===0)break}if(i===0)break}if(i>0){let o=[];throw r.forEach((s,a)=>{s==null&&o.push(n[a])}),new K(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(o)}`)}return r}predictLoop(n,r=32,i=!1){return ee(()=>{let o=this.checkNumSamples(n);if(i)throw new yt("Verbose predictLoop() is not implemented yet.");let s=FZ(o,r),a=this.outputs.map(l=>[]);for(let l=0;l<s.length;++l)ee(()=>{let c=s[l][0],f=s[l][1],d=DF(n,c,f),p=[];if(Array.isArray(d))for(let h=0;h<d.length;++h)p.push({key:this.inputs[h],value:d[h]});else p.push({key:this.inputs[0],value:d});let m=new d0(p);return oA(this.outputs,m)}).forEach((c,f)=>a[f].push(c));return $o(a.map(l=>En(l,0)))})}predict(n,r={}){let i=Kwe(n);tmt(i,this.inputNames,this.feedInputShapes,!1);try{let o=r.batchSize==null?32:r.batchSize;return DZ(o),this.predictLoop(i,o)}finally{gd(i,n)}}predictOnBatch(n){tmt(n,this.inputNames,this.feedInputShapes,!0);let r=(Array.isArray(n)?n[0]:n).shape[0];return this.predictLoop(n,r)}standardizeUserDataXY(n,r,i=!0,o){if(this.optimizer_==null)throw new Xa("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let s=[];for(let a=0;a<this.feedOutputShapes.length;++a){let l=this.feedOutputShapes[a];this.feedLossFns[a]===TF?s.push(l.slice(0,l.length-1).concat([1])):s.push(l)}if(n=emt(n,this.feedInputNames,this.feedInputShapes,!1,"input"),r=emt(r,this.feedOutputNames,s,!1,"target"),own(n,r,null),swn(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&n[0].shape[0]%o!==0)throw new K(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${o}. Found: ${n[0].shape[0]} sample(s).`);return[n,r]}standardizeUserData(n,r,i,o,s=!0,a){return te(this,null,function*(){let[l,u]=this.standardizeUserDataXY(n,r,s,a);if(i!=null)throw new Error("sample weight is not supported yet.");let c=null;if(o!=null){let f=kZ(o,this.outputNames);c=[];for(let d=0;d<f.length;++d)c.push(yield IZ(u[d],null,f[d]))}return[l,u,c]})}testLoop(n,r,i,o=0,s){return ee(()=>{let a=this.checkNumSamples(r,i,s,"steps"),l=[];if(o>0)throw new yt("Verbose mode is not implemented yet.");if(s!=null)throw new yt("steps mode in testLoop() is not implemented yet");{let u=FZ(a,i),c=xr(Qa(0,a));for(let f=0;f<u.length;++f){let d=u[f][0],p=u[f][1],m=sy(c,d,p-d),h=NZ(r,m),g=n(h);if(f===0)for(let x=0;x<g.length;++x)l.push(Pe(0));for(let x=0;x<g.length;++x){let b=g[x];l[x]=se(l[x],j(p-d,b))}}for(let f=0;f<l.length;++f)l[f]=Fe(l[f],a)}return l})}getDedupedMetricsNames(){let n=this.metricsNames,r=[];for(let i=0;i<n.length;++i){let o=n[i],s=o;if(Iwe(n,o)>1){let a=Iwe(n.slice(0,i),o);s+=`_${a}`}r.push(s)}return r}makeTrainFunction(){return n=>{let r=[],i=n.slice(0,this.inputs.length),o=n.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=n.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],l=()=>{let d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:i[g]});let p=new d0(d),m=oA(this.outputs,p,{training:!0}),h;for(let g=0;g<this.lossFunctions.length;++g){let x=this.lossFunctions[g],b=x(o[g],m[g]);s[g]!=null&&(b=Hpt(b,s[g]));let y=sr(b);r.push(y),g===0?h=b:h=se(h,b)}for(let g=0;g<this.metricsTensors.length;++g){let x;if(this.outputs.length>1&&g<this.outputs.length)x=r[g];else{let b=this.metricsTensors[g][0],y=this.metricsTensors[g][1];x=sr(b(o[y],m[y]))}ro(x),a.push(x)}return h=sr(h),this.calculateLosses().forEach(g=>{h=se(h,g)}),h},u=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(l,!0,u)].concat(a)}}makeTestFunction(){this.testFunction=n=>ee(()=>{let r=[],i,o=n.slice(0,this.inputs.length),s=n.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let c=0;c<this.inputs.length;++c)a.push({key:this.inputs[c],value:o[c]});let l=new d0(a),u=oA(this.outputs,l);for(let c=0;c<this.lossFunctions.length;++c){let f=this.lossFunctions[c],d=sr(f(s[c],u[c]));c===0?i=d:i=se(i,d),r.push(i)}for(let c=0;c<this.metricsTensors.length;++c){let f=this.metricsTensors[c][0],d=this.metricsTensors[c][1],p=sr(f(s[d],u[d]));r.push(p)}return r})}fit(o,s){return te(this,arguments,function*(n,r,i={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,l,u,c,f,d,p,m,h;try{let g=i.batchSize==null?32:i.batchSize;DZ(g);let b=yield this.standardizeUserData(n,r,i.sampleWeight,i.classWeight,!1,g);a=b[0],l=b[1],h=b[2];let y=!1,v;if(i.validationData!=null&&i.validationData.length>0){if(y=!0,i.validationData.length===2)f=i.validationData[0],d=i.validationData[1];else throw i.validationData.length===3?new yt("validationData including sample weights is not supported yet."):new K(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${i.validationData} is invalid.`);let F=yield this.standardizeUserData(f,d,null,null,!0,g);p=F[0],m=F[1],v=p.concat(m)}else if(i.validationSplit!=null&&i.validationSplit>0&&i.validationSplit<1){y=!0;let O=Math.floor(a[0].shape[0]*(1-i.validationSplit)),F=a[0].shape[0];p=DF(a,O,F),u=a,a=DF(a,0,O),m=DF(l,O,F),c=l,l=DF(l,0,O),v=p.concat(m)}else i.validationSteps!=null&&(y=!0);let C=a.concat(l).concat(h);this.checkTrainableWeightsConsistency();let _=this.makeTrainFunction(),S=this.getDedupedMetricsNames(),E,T;y?(this.makeTestFunction(),E=this.testFunction,T=S.slice().concat(S.map(O=>"val_"+O))):(E=null,v=[],T=S.slice());let I=xZ(i.callbacks,i.yieldEvery);return yield this.fitLoop(_,C,S,g,i.epochs,i.verbose,I,E,v,i.shuffle,T,i.initialEpoch,null,null)}finally{this.isTraining=!1,gd(a,n),gd(l,r),gd(u,n),gd(c,r),gd(p,f),gd(m,d),h!=null&&_t(h)}})}fitLoop(n,r,i,o,s,a,l,u,c,f,d,p,m,h){return te(this,null,function*(){o==null&&(o=32),s==null&&(s=1),f==null&&(f=!0),p==null&&(p=0);let g=!1;if(u!=null&&c!=null&&(g=!0),h!=null&&(g=!0,m==null))throw new K("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let x=this.checkNumSamples(r,o,m,"steps_per_epoch"),b;x!=null&&(b=Qa(0,x)),a==null&&(a=1);let{callbackList:y,history:v}=bZ(l,a,s,p,x,m,o,g,d);y.setModel(this),this.history=v,yield y.onTrainBegin(),this.stopTraining_=!1;for(let C=p;C<s;++C){yield y.onEpochBegin(C);let _={};if(m!=null)throw new yt("stepsPerEpoch mode is not implemented yet.");{if(f==="batch")throw new yt("batch shuffling is not implemneted yet");f&&A.shuffle(b);let S=xr(b),E=FZ(x,o);for(let T=0;T<E.length;++T){let I={};if(yield y.onBatchBegin(T,I),ee(()=>{let k=E[T][0],O=E[T][1],F=sy(S,k,O-k);I.batch=T,I.size=O-k;let B=NZ(r,F),M=n(B);for(let z=0;z<i.length;++z){let W=i[z],H=M[z];I[W]=H,ro(H)}if(T===E.length-1&&g){let z=this.testLoop(u,c,o);for(let W=0;W<i.length;++W){let H=i[W],Q=z[W];ro(Q),_["val_"+H]=Q}}}),yield y.onBatchEnd(T,I),pZ(I),this.stopTraining_)break}S.dispose()}if(yield y.onEpochEnd(C,_),this.stopTraining_)break}return yield y.onTrainEnd(),yield this.history.syncData(),this.history})}fitDataset(n,r){return te(this,null,function*(){return Zpt(this,n,r)})}trainOnBatch(n,r){return te(this,null,function*(){let i=yield this.standardizeUserData(n,r),o=i[0],s=i[1],l=this.makeTrainFunction()(o.concat(s)),u=[];for(let c of l){let f=yield c.data();u.push(f[0])}return _t(l),gd(i[0],n),gd(i[1],r),$o(u)})}getNamedWeights(n){let r=[],i=n!=null&&n.trainableOnly,o=i?this.trainableWeights:this.weights,s=this.getWeights(i);for(let a=0;a<o.length;++a)i&&!o[a].trainable||r.push({name:o[a].originalName,tensor:s[a]});return r}set stopTraining(n){this.stopTraining_=n}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(n){this.optimizer_!==n&&(this.optimizer_=n,this.isOptimizerOwned=!1)}dispose(){let n=super.dispose();if(n.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let r=pT().numTensors;this.optimizer_.dispose(),n.numDisposedVariables+=r-pT().numTensors}return n}getLossIdentifiers(){let n;if(typeof this.loss=="string")n=dd(this.loss);else if(Array.isArray(this.loss)){for(let r of this.loss)if(typeof r!="string")throw new Error("Serialization of non-string loss is not supported.");n=this.loss.map(r=>dd(r))}else{let r=Object.keys(this.loss);n={};let i=this.loss;for(let o of r)if(typeof i[o]=="string")n[o]=dd(i[o]);else throw new Error("Serialization of non-string loss is not supported.")}return n}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[dd(_4(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(n=>dd(_4(n)));{let n={};for(let r in this.metrics)n[r]=dd(_4(this.metrics[r]));return n}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(n){if(n.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(n.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(n.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let r=S4(n.optimizer_config),i=Xu(r),o;if(typeof n.loss=="string")o=oy(n.loss);else if(Array.isArray(n.loss))o=n.loss.map(a=>oy(a));else if(n.loss!=null){o={};for(let a in n.loss)o[a]=oy(n.loss[a])}let s;if(Array.isArray(n.metrics))s=n.metrics.map(a=>oy(a));else if(n.metrics!=null){s={};for(let a in n.metrics)s[a]=oy(n.metrics[a])}this.compile({loss:o,metrics:s,optimizer:i})}save(n,r){return te(this,null,function*(){if(typeof n=="string"){let c=$h.getSaveHandlers(n);if(c.length===0)throw new K(`Cannot find any save handlers for URL '${n}'`);if(c.length>1)throw new K(`Found more than one (${c.length}) save handlers for URL '${n}'`);n=c[0]}if(n.save==null)throw new K("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let i=yield $h.encodeWeights(this.getNamedWeights(r)),l={modelTopology:this.toJSON(null,!1),format:lwn,generatedBy:`TensorFlow.js tfjs-layers v${IF}`,convertedBy:null};if((r==null?!1:r.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();let c="optimizer",{data:f,specs:d}=yield $h.encodeWeights(yield this.optimizer.getWeights(),c);i.specs.push(...d),i.data=$h.concatenateArrayBuffers([i.data,f])}return this.userDefinedMetadata!=null&&(Ywe(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=i.data,l.weightSpecs=i.specs,n.save(l)})}setUserDefinedMetadata(n){Ywe(n,this.name),this.userDefinedMetadata=n}getUserDefinedMetadata(){return this.userDefinedMetadata}}return e.className="Model",e})();fe.registerClass(cy);var uwn=(()=>{class e extends cy{}return e.className="Functional",e})();fe.registerClass(uwn);N();var RZ=(()=>{class e extends cy{constructor(n){if(super({inputs:[],outputs:[]}),n=n||{},this.trainable=!0,this.built=!1,this.name=n.name!=null?n.name:Hw("sequential_"),n.layers!=null)for(let r of n.layers)this.add(r)}checkShape(n){if(n.inboundNodes[0].outputTensors[0].shape.some(i=>i<0))throw new K(`Negative dimension size caused by adding layer ${n.name} with input shape [${n.inboundNodes[0].inputTensors[0].shape}]`)}add(n){let r=n instanceof e||n instanceof cy,i;if(r){if(i=n,i.outputs.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(i.inputs.length!==1)throw new K("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(n.inboundNodes.length===0){if(n.batchInputShape==null)throw new K("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let o=cZ({batchShape:n.batchInputShape,dtype:n.dtype,name:n.name+"_input"});n.apply(o)}if(r)this.outputs=i.outputs,this.inputs=i.inputs;else{if(n.inboundNodes.length!==1)throw new K(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${n.name} which has ${n.inboundNodes.length} pre-existing inbound connections.`);if(n.inboundNodes[0].outputTensors.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[n.inboundNodes[0].outputTensors[0]],this.inputs=Uwe(this.outputs[0])}this.inboundNodes=[],new ly({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:fd(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(o=>o.shape),outputShapes:this.outputs[0].shape})}else{let o=n.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(n),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let n=this.layers.length-1;this.layers[n].outboundNodes=[],this.outputs=[this.layers[n].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(n,r){return this.model==null&&this.build(),this.model.call(n,r)}build(n){if(Ut(n),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new cy({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(n,r,i=console.log){this.built||this.build(),super.summary(n,r,i)}setWeights(n){this.model==null&&this.build(),this.model.setWeights(n)}evaluate(n,r,i={}){if(!this.built)throw new Xa("The model needs to be compiled before being used.");return this.model.evaluate(n,r,i)}evaluateDataset(n,r){return te(this,null,function*(){if(!this.built)throw new Xa("The model needs to be compiled before being used.");return this.model.evaluateDataset(n,r)})}predict(n,r={}){return this.model==null&&this.build(),this.model.predict(n,r)}predictOnBatch(n){return this.model==null&&this.build(),this.model.predictOnBatch(n)}compile(n){this.build(),this.model.compile(n),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(n){this.model.optimizer=n}fit(o,s){return te(this,arguments,function*(n,r,i={}){if(!this.built)throw new Xa("The model needs to be compiled before being used.");return this.model.fit(n,r,i)})}fitDataset(n,r){return te(this,null,function*(){if(!this.built)throw new Xa("The model needs to be compiled before being used.");return this.model.fitDataset(n,r)})}trainOnBatch(n,r){return te(this,null,function*(){return this.model.trainOnBatch(n,r)})}static fromConfig(n,r,i={},o=!1){let s,a={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new K("Legacy serialization format not supported yet.");s=r}else A.assert(r.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=r.layers,delete r.layers,a=r;let l=new n(a);if(!(l instanceof e))throw new yt(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(let u of s){let f=Xu(u,void 0,o);o&&f.setFastWeightInitDuringBuild(!0),l.add(f)}return l}set stopTraining(n){if(this.model==null)throw new K("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=n}get stopTraining(){if(this.model==null)throw new K("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let n=[];for(let r of this.layers){let i={};i.className=r.getClassName(),i.config=r.getConfig(),n.push(i)}return{name:this.name,layers:n}}}return e.className="Sequential",e})();fe.registerClass(RZ);function Zwe(e){return new RZ(e)}function Qwe(e){return cZ(e)}N();N();N();var rs=class extends fe.Serializable{getConfig(){return{}}},fwn=(()=>{class e extends rs{apply(n,r=1){return hpt(n,r)}}return e.className="elu",e})();fe.registerClass(fwn);var dwn=(()=>{class e extends rs{apply(n){return jT(n)}}return e.className="selu",e})();fe.registerClass(dwn);var pwn=(()=>{class e extends rs{apply(n){return Ho(n)}}return e.className="relu",e})();fe.registerClass(pwn);var mwn=(()=>{class e extends rs{apply(n){return ee(()=>mc(6,Ho(n)))}}return e.className="relu6",e})();fe.registerClass(mwn);var hwn=(()=>{class e extends rs{apply(n){return n}}return e.className="linear",e})();fe.registerClass(hwn);var gwn=(()=>{class e extends rs{apply(n){return js(n)}}return e.className="sigmoid",e})();fe.registerClass(gwn);var xwn=(()=>{class e extends rs{apply(n){return xpt(n)}}return e.className="hardSigmoid",e})();fe.registerClass(xwn);var bwn=(()=>{class e extends rs{apply(n){return zd(n)}}return e.className="softplus",e})();fe.registerClass(bwn);var ywn=(()=>{class e extends rs{apply(n){return gpt(n)}}return e.className="softsign",e})();fe.registerClass(ywn);var vwn=(()=>{class e extends rs{apply(n){return Pd(n)}}return e.className="tanh",e})();fe.registerClass(vwn);var eCe=(()=>{class e extends rs{apply(n,r=-1){return xv(n,r)}}return e.className="softmax",e})();fe.registerClass(eCe);var wwn=(()=>{class e extends rs{apply(n,r=-1){return MT(n,r)}}return e.className="logSoftmax",e})();fe.registerClass(wwn);var Cwn=(()=>{class e extends rs{apply(n){return ee(()=>ee(()=>{let r=Math.sqrt(2),i=j(.5,se(1,DT(Fe(n,r))));return j(n,i)}))}}return e.className="gelu",e})();fe.registerClass(Cwn);var _wn=(()=>{class e extends rs{apply(n){return ee(()=>j(.5,j(n,se(1,Pd(j(Bn(Fe(2,Math.PI)),se(n,j(.044715,us(n,3)))))))))}}return e.className="gelu_new",e})();fe.registerClass(_wn);var Swn=(()=>{class e extends rs{apply(n){return ee(()=>j(n,Pd(zd(n))))}}return e.className="mish",e})();fe.registerClass(Swn);var Ewn=(()=>{class e extends rs{apply(n,r=1){return ee(()=>j(js(j(n,r)),n))}}return e.className="swish",e})();fe.registerClass(Ewn);function dm(e){return e.getClassName()}function Jwe(e,t={}){return c0(e,fe.SerializationMap.getMap().classNameMap,t,"activation")}function pm(e){if(e==null){let t={};return t.className="linear",t.config={},Jwe(t)}if(typeof e=="string"){let t={};return t.className=e,t.config={},Jwe(t)}else return e instanceof rs?e:Jwe(e)}N();N();function Awn(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}var OZ=class extends fe.Serializable{},imt=(()=>{class e extends OZ{constructor(n){super(),Awn(n),this.l1=n==null||n.l1==null?.01:n.l1,this.l2=n==null||n.l2==null?.01:n.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(n){return ee(()=>{let r=ar([1]);return this.hasL1&&(r=se(r,Me(j(this.l1,mr(n))))),this.hasL2&&(r=se(r,Me(j(this.l2,iA(n))))),V(r,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(n,r){return new n({l1:r.l1,l2:r.l2})}}return e.className="L1L2",e})();fe.registerClass(imt);var nmt={l1l2:"L1L2"};function In(e){return vF(e)}function rmt(e,t={}){return c0(e,fe.SerializationMap.getMap().classNameMap,t,"regularizer")}function rr(e){if(e==null)return null;if(typeof e=="string"){let n={className:e in nmt?nmt[e]:e,config:{}};return rmt(n)}else return e instanceof OZ?e:rmt(e)}var tCe=(()=>{class e extends xt{constructor(n){super(n??{}),this.supportsMasking=!0,n!=null&&(this.maxValue=n.maxValue)}call(n,r){n=ct(n);let i=Ho(n);return this.maxValue!=null&&(i=vo(i,0,this.maxValue)),i}computeOutputShape(n){return n}getConfig(){let n={maxValue:this.maxValue},r=super.getConfig();return Object.assign(n,r),n}}return e.className="ReLU",e})();fe.registerClass(tCe);var nCe=(()=>{class e extends xt{constructor(n){super(n??{}),this.DEFAULT_ALPHA=.3,n==null&&(n={}),this.alpha=n.alpha==null?this.DEFAULT_ALPHA:n.alpha}call(n,r){let i=ct(n);return lv(i,this.alpha)}computeOutputShape(n){return n}getConfig(){let n={alpha:this.alpha},r=super.getConfig();return Object.assign(n,r),n}}return e.className="LeakyReLU",e})();fe.registerClass(nCe);var rCe=(()=>{class e extends xt{constructor(n){if(super(n??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",n==null&&(n={}),this.supportsMasking=!0,this.alphaInitializer=Gn(n.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=rr(n.alphaRegularizer),this.alphaConstraint=Yr(n.alphaConstraint),n.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(n.sharedAxes))this.sharedAxes=n.sharedAxes;else if(typeof n.sharedAxes=="number")this.sharedAxes=[n.sharedAxes];else throw new K(`Expected sharedAxes to be a number or an array of numbers, but got ${n.sharedAxes}`)}build(n){n=Ut(n);let r=n.slice(1);if(this.sharedAxes!=null)for(let o of this.sharedAxes)r[o-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let i={};if(this.sharedAxes!=null)for(let o=1;o<n.length;++o)i[o]=n[o];this.inputSpec=[new nr({ndim:n.length,axes:i})],this.built=!0}call(n,r){return n=ct(n),gv(n,this.alpha.read())}getConfig(){let n={alphaInitializer:dr(this.alphaInitializer),alphaRegularizer:In(this.alphaRegularizer),alphaConstraint:Hr(this.alphaConstraint),sharedAxes:this.sharedAxes},r=super.getConfig();return Object.assign(n,r),n}}return e.className="PReLU",e})();fe.registerClass(rCe);var iCe=(()=>{class e extends xt{constructor(n){if(super(n??{}),this.DEFAULT_ALPHA=1,n==null&&(n={}),n.alpha!=null&&n.alpha!==this.DEFAULT_ALPHA)throw new yt(`Non-default alpha value (${n.alpha}) is not supported by the ELU layer yet.`);this.alpha=n.alpha==null?this.DEFAULT_ALPHA:n.alpha}call(n,r){let i=ct(n);return Th(i)}computeOutputShape(n){return n}getConfig(){let n={alpha:this.alpha},r=super.getConfig();return Object.assign(n,r),n}}return e.className="ELU",e})();fe.registerClass(iCe);var oCe=(()=>{class e extends xt{constructor(n){super(n??{}),this.DEFAULT_THETA=1,n==null&&(n={}),this.theta=n.theta==null?this.DEFAULT_THETA:n.theta}call(n,r){let i=ct(n);return j(i,de(Ur(i,this.theta),"float32"))}computeOutputShape(n){return n}getConfig(){let n={theta:this.theta},r=super.getConfig();return Object.assign(n,r),n}}return e.className="ThresholdedReLU",e})();fe.registerClass(oCe);var sCe=(()=>{class e extends xt{constructor(n){super(n??{}),this.DEFAULT_AXIS=1,n==null&&(n={}),this.softmax=new eCe().apply,this.axis=n.axis==null?this.DEFAULT_AXIS:n.axis}call(n,r){return ee(()=>{let i=ct(n),o=r.mask;if(o!=null){let s=j(De(vi(i.shape),de(o,i.dtype)),Pe(-1e9));i=se(i,s)}return this.axis instanceof Array?this.axis.length>1?Jr(De(i,fv(i,this.axis,!0))):this.softmax(i,this.axis[0]):this.softmax(i,this.axis)})}computeOutputShape(n){return n}getConfig(){let n={axis:this.axis},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Softmax",e})();fe.registerClass(sCe);N();N();function Zw(e,t,n){if(typeof e=="number")return fd(e,t);if(e.length!==t)throw new K(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){let i=e[r];if(!fpt(i))throw new K(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function Vl(e,t,n,r,i=1){if(e==null)return e;let o=t+(t-1)*(i-1),s;return n==="same"?s=e:s=e-o+1,Math.floor((s+r-1)/r)}function mm(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+fm([n-t,0]);else if(r==="same")e=e*t;else throw new K(`Unsupport padding mode: ${r}.`);return e}function A4(e,t){return ee(()=>(Mr(t),t==="channelsFirst"?zt(e,[0,2,3,1]):e))}function aCe(e,t){return ee(()=>(Mr(t),t==="channelsFirst"?zt(e,[0,2,3,4,1]):e))}function kwn(e,t,n,r=1,i="valid",o,s=1){return ee(()=>{if(o==null&&(o=Ja()),Mr(o),e.shape.length!==3)throw new K(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new K(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new K(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(e=zt(e,[0,2,1])),i==="causal")throw new yt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=ET(e,t,r,i==="same"?"same":"valid","NWC",s);return n!=null&&(a=el(a,n)),a})}function omt(e,t,n,r=[1,1],i="valid",o,s,a=null){return ee(()=>{if(o==null&&(o=Ja()),Mr(o),e.rank!==3&&e.rank!==4)throw new K(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new K(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=A4(e,o);if(i==="causal")throw new yt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Cv.conv2d({x:l,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=zt(l,[0,3,1,2])),l})}function Iwn(e,t,n,r=[1,1,1],i="valid",o,s){return ee(()=>{if(o==null&&(o=Ja()),Mr(o),e.rank!==4&&e.rank!==5)throw new K(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new K(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let a=aCe(e,o);if(i==="causal")throw new yt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=A6(a,t,r,i==="same"?"same":"valid","NDHWC",s),n!=null&&(a=el(a,n)),o==="channelsFirst"&&(a=zt(a,[0,4,1,2,3])),a})}var E4=class e extends xt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(n),this.rank=t,mi(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new yt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Zw(n.kernelSize,t,"kernelSize"),this.strides=Zw(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Za(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Mr(this.dataFormat),this.activation=pm(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Gn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Yr(n.biasConstraint),this.biasRegularizer=rr(n.biasRegularizer),this.activityRegularizer=rr(n.activityRegularizer),this.dilationRate=Zw(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new K(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new K(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new K(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(ef("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!QX(t.kernelSize,"number",1,3))throw new K(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){let t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:dm(this.activation),useBias:this.useBias,biasInitializer:dr(this.biasInitializer),biasRegularizer:In(this.biasRegularizer),activityRegularizer:In(this.activityRegularizer),biasConstraint:Hr(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}},NF=class e extends E4{constructor(t,n){super(t,n),this.kernel=null,e.verifyArgs(n),this.filters=n.filters,mi(this.filters,"filters"),this.kernelInitializer=Gn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Yr(n.kernelConstraint),this.kernelRegularizer=rr(n.kernelRegularizer)}build(t){t=Ut(t);let n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new K(`The channel dimension of the input should be defined. Found ${t[n]}`);let r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return ee(()=>{t=ct(t);let r,i=this.bias==null?null:this.bias.read(),o=JX(this.activation.getClassName());if(o!=null&&this.rank===2)r=omt(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)r=kwn(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=omt(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=Iwn(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new yt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=Ut(t);let n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let o=0;o<r.length;++o){let s=Vl(r[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(s)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){let t={filters:this.filters,kernelInitializer:dr(this.kernelInitializer),kernelRegularizer:In(this.kernelRegularizer),kernelConstraint:Hr(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new K(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}},MZ=(()=>{class e extends NF{constructor(n){super(2,n),e.verifyArgs(n)}getConfig(){let n=super.getConfig();return delete n.rank,n}static verifyArgs(n){if(typeof n.kernelSize!="number"&&!QX(n.kernelSize,"number",1,2))throw new K(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(n.kernelSize)}.`)}}return e.className="Conv2D",e})();fe.registerClass(MZ);var $Z=(()=>{class e extends NF{constructor(n){super(3,n),e.verifyArgs(n)}getConfig(){let n=super.getConfig();return delete n.rank,n}static verifyArgs(n){if(typeof n.kernelSize!="number"&&!(Array.isArray(n.kernelSize)&&(n.kernelSize.length===1||n.kernelSize.length===3)))throw new K(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(n.kernelSize)}.`)}}return e.className="Conv3D",e})();fe.registerClass($Z);var lCe=(()=>{class e extends MZ{constructor(n){if(super(n),this.inputSpec=[new nr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new K(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(n){if(n=Ut(n),n.length!==4)throw new K("Input should have rank 4; Received input shape: "+JSON.stringify(n));let r=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[r]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");let i=n[r],o=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nr({ndim:4,axes:{[r]:i}})],this.built=!0}call(n,r){return ee(()=>{let i=ct(n);if(i.shape.length!==4)throw new K(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${i.shape.length}`);let o=i.shape,s=o[0],a,l;this.dataFormat==="channelsFirst"?(a=2,l=3):(a=1,l=2);let u=o[a],c=o[l],f=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],m=this.strides[1],h=mm(u,p,f,this.padding),g=mm(c,m,d,this.padding),x=[s,h,g,this.filters];this.dataFormat!=="channelsLast"&&(i=zt(i,[0,2,3,1]));let b=TT(i,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(b=zt(b,[0,3,1,2])),this.bias!=null&&(b=el(b,this.bias.read(),this.dataFormat)),this.activation!=null&&(b=this.activation.apply(b)),b})}computeOutputShape(n){n=Ut(n);let r=n.slice(),i,o,s;this.dataFormat==="channelsFirst"?(i=1,o=2,s=3):(i=3,o=1,s=2);let a=this.kernelSize[0],l=this.kernelSize[1],u=this.strides[0],c=this.strides[1];return r[i]=this.filters,r[o]=mm(r[o],u,a,this.padding),r[s]=mm(r[s],c,l,this.padding),r}getConfig(){let n=super.getConfig();return delete n.dilationRate,n}}return e.className="Conv2DTranspose",e})();fe.registerClass(lCe);var uCe=(()=>{class e extends $Z{constructor(n){if(super(n),this.inputSpec=[new nr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new K(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(n){if(n=Ut(n),n.length!==5)throw new K("Input should have rank 5; Received input shape: "+JSON.stringify(n));let r=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[r]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");let i=n[r],o=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nr({ndim:5,axes:{[r]:i}})],this.built=!0}call(n,r){return ee(()=>{let i=ct(n);if(i.shape.length!==5)throw new K(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${i.shape.length}`);let o=i.shape,s=o[0],a,l,u;this.dataFormat==="channelsFirst"?(u=2,a=3,l=4):(u=1,a=2,l=3);let c=o[u],f=o[a],d=o[l],p=this.kernelSize[0],m=this.kernelSize[1],h=this.kernelSize[2],g=this.strides[0],x=this.strides[1],b=this.strides[2],y=mm(c,g,p,this.padding),v=mm(f,x,m,this.padding),C=mm(d,b,h,this.padding),_=[s,y,v,C,this.filters];this.dataFormat!=="channelsLast"&&(i=zt(i,[0,2,3,4,1]));let S=k6(i,this.kernel.read(),_,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=zt(S,[0,4,1,2,3])),this.bias!==null&&(S=el(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(n){n=Ut(n);let r=n.slice(),i,o,s,a;this.dataFormat==="channelsFirst"?(i=1,o=2,s=3,a=4):(i=4,o=1,s=2,a=3);let l=this.kernelSize[0],u=this.kernelSize[1],c=this.kernelSize[2],f=this.strides[0],d=this.strides[1],p=this.strides[2];return r[i]=this.filters,r[o]=mm(r[o],f,l,this.padding),r[s]=mm(r[s],d,u,this.padding),r[a]=mm(r[a],p,c,this.padding),r}getConfig(){let n=super.getConfig();return delete n.dilationRate,n}}return e.className="Conv3DTranspose",e})();fe.registerClass(uCe);var Dwn=(()=>{class e extends NF{constructor(n,r){if(super(n,r),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,r.filters==null)throw new K("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new K("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new K(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(r.padding)}`);this.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,this.depthwiseInitializer=Gn(r.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=rr(r.depthwiseRegularizer),this.depthwiseConstraint=Yr(r.depthwiseConstraint),this.pointwiseInitializer=Gn(r.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=rr(r.pointwiseRegularizer),this.pointwiseConstraint=Yr(r.pointwiseConstraint)}build(n){if(n=Ut(n),n.length<this.rank+2)throw new K(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(n)}`);let r=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[r]==null||n[r]<0)throw new K(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(n[r])}`);let i=n[r],o=this.kernelSize.concat([i,this.depthMultiplier]),s=[];for(let l=0;l<this.rank;++l)s.push(1);s.push(i*this.depthMultiplier,this.filters);let a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new nr({ndim:this.rank+2,axes:{[r]:i}})],this.built=!0}call(n,r){return ee(()=>{n=ct(n);let i;if(this.rank===1)throw new yt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(n=zt(n,[0,2,3,1])),i=VT(n,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(i=el(i,this.bias.read(),this.dataFormat)),this.activation!=null&&(i=this.activation.apply(i)),this.dataFormat==="channelsFirst"&&(i=zt(i,[0,3,1,2])),i})}getConfig(){let n=super.getConfig();return delete n.rank,delete n.kernelInitializer,delete n.kernelRegularizer,delete n.kernelConstraint,n.depthwiseInitializer=dr(this.depthwiseInitializer),n.pointwiseInitializer=dr(this.pointwiseInitializer),n.depthwiseRegularizer=In(this.depthwiseRegularizer),n.pointwiseRegularizer=In(this.pointwiseRegularizer),n.depthwiseConstraint=Hr(this.depthwiseConstraint),n.pointwiseConstraint=Hr(this.pointwiseConstraint),n}}return e.className="SeparableConv",e})();var cCe=(()=>{class e extends Dwn{constructor(n){super(2,n)}}return e.className="SeparableConv2D",e})();fe.registerClass(cCe);var fCe=(()=>{class e extends NF{constructor(n){super(1,n),e.verifyArgs(n),this.inputSpec=[{ndim:3}]}getConfig(){let n=super.getConfig();return delete n.rank,delete n.dataFormat,n}static verifyArgs(n){if(typeof n.kernelSize!="number"&&!QX(n.kernelSize,"number",1,1))throw new K(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(n.kernelSize)}.`)}}return e.className="Conv1D",e})();fe.registerClass(fCe);var dCe=(()=>{class e extends xt{constructor(n){super(n),typeof n.cropping=="number"?this.cropping=[[n.cropping,n.cropping],[n.cropping,n.cropping]]:typeof n.cropping[0]=="number"?this.cropping=[[n.cropping[0],n.cropping[0]],[n.cropping[1],n.cropping[1]]]:this.cropping=n.cropping,this.dataFormat=n.dataFormat===void 0?"channelsLast":n.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(n){return this.dataFormat==="channelsFirst"?[n[0],n[1],n[2]-this.cropping[0][0]-this.cropping[0][1],n[3]-this.cropping[1][0]-this.cropping[1][1]]:[n[0],n[1]-this.cropping[0][0]-this.cropping[0][1],n[2]-this.cropping[1][0]-this.cropping[1][1],n[3]]}call(n,r){return ee(()=>{if(n=ct(n),this.dataFormat==="channelsLast"){let i=g4(n,this.cropping[0][0],n.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return g4(i,this.cropping[1][0],n.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let i=g4(n,this.cropping[0][0],n.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return g4(i,this.cropping[1][0],n.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let n={cropping:this.cropping,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Cropping2D",e})();fe.registerClass(dCe);var pCe=(()=>{class e extends xt{constructor(n){super(n),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=n.size==null?this.DEFAULT_SIZE:n.size,this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Mr(this.dataFormat),this.interpolation=n.interpolation==null?"nearest":n.interpolation,upt(this.interpolation)}computeOutputShape(n){if(this.dataFormat==="channelsFirst"){let r=n[2]==null?null:this.size[0]*n[2],i=n[3]==null?null:this.size[1]*n[3];return[n[0],n[1],r,i]}else{let r=n[1]==null?null:this.size[0]*n[1],i=n[2]==null?null:this.size[1]*n[2];return[n[0],r,i,n[3]]}}call(n,r){return ee(()=>{let i=ct(n),o=i.shape;if(this.dataFormat==="channelsFirst"){i=zt(i,[0,2,3,1]);let s=this.size[0]*o[2],a=this.size[1]*o[3],l=this.interpolation==="nearest"?pl.resizeNearestNeighbor(i,[s,a]):pl.resizeBilinear(i,[s,a]);return zt(l,[0,3,1,2])}else{let s=this.size[0]*o[1],a=this.size[1]*o[2];return this.interpolation==="nearest"?pl.resizeNearestNeighbor(i,[s,a]):pl.resizeBilinear(i,[s,a])}})}getConfig(){let n={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},r=super.getConfig();return Object.assign(n,r),n}}return e.className="UpSampling2D",e})();fe.registerClass(pCe);N();N();function Nwn(e,t,n=[1,1],r="valid",i,o){return ee(()=>{i==null&&(i=Ja()),Mr(i);let s=A4(e,i);if(e.rank!==4)throw new K(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new K(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return s=Ah(s,t,n,r==="same"?"same":"valid","NHWC",o),i==="channelsFirst"&&(s=zt(s,[0,3,1,2])),s})}var mCe=(()=>{class e extends E4{constructor(n){super(2,n),this.depthwiseKernel=null,this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Gn(n.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Yr(n.depthwiseConstraint),this.depthwiseRegularizer=rr(n.depthwiseRegularizer)}build(n){if(n=Ut(n),n.length<4)throw new K(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(n)}.`);let r=this.dataFormat==="channelsFirst"?1:3;if(n[r]==null||n[r]<0)throw new K(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${n[r]}).`);let i=n[r],o=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(n,r){return ee(()=>{n=ct(n);let i=Nwn(n,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(i=el(i,this.bias.read(),this.dataFormat)),this.activation!=null&&(i=this.activation.apply(i)),i})}computeOutputShape(n){n=Ut(n);let r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],o=this.dataFormat==="channelsFirst"?n[1]*this.depthMultiplier:n[3]*this.depthMultiplier,s=Vl(r,this.kernelSize[0],this.padding,this.strides[0]),a=Vl(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[n[0],o,s,a]:[n[0],s,a,o]}getConfig(){let n=super.getConfig();return n.depthMultiplier=this.depthMultiplier,n.depthwiseInitializer=dr(this.depthwiseInitializer),n.depthwiseRegularizer=In(this.depthwiseRegularizer),n.depthwiseConstraint=Hr(this.depthwiseRegularizer),n}}return e.className="DepthwiseConv2D",e})();fe.registerClass(mCe);N();N();N();N();function hCe(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new K("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(o){return o==null||Array.isArray(o)?o:[o]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function gCe(e,t,n,r=!1,i,o,s=!1,a=!1){return ee(()=>{let l=t.shape.length;if(l<3)throw new K(`Input should be at least 3D, but is ${l}D.`);let u=[1,0].concat(Qa(2,l));if(t=zt(t,u),o!=null)throw new yt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=de(de(i,"bool"),"float32"),i.rank===l-1&&(i=ri(i,-1)),i=zt(i,u)),r&&(t=ji(t,0),i!=null&&(i=ji(i,0)));let c=[],f,d=n,p=t.shape[0],m=fs(t),h;i!=null&&(h=fs(i));for(let x=0;x<p;++x){let b=m[x],y=ee(()=>e(b,d));if(i==null)f=y[0],d=y[1];else{let v=ee(()=>{let C=h[x],_=De(oo(C),C),S=se(j(y[0],C),j(d[0],_)),E=d.map((T,I)=>se(j(y[1][I],C),j(T,_)));return{output:S,newStates:E}});f=v.output,d=v.newStates}a&&c.push(f)}let g;return a&&(g=Ri(c,1)),[f,g,d]})}var p0=(()=>{class e extends xt{constructor(n){super(n);let r;if(n.cell==null)throw new K("cell property is missing for the constructor of RNN.");if(Array.isArray(n.cell)?r=new BZ({cells:n.cell}):r=n.cell,r.stateSize==null)throw new K("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=n.returnSequences==null?!1:n.returnSequences,this.returnState=n.returnState==null?!1:n.returnState,this.goBackwards=n.goBackwards==null?!1:n.goBackwards,this._stateful=n.stateful==null?!1:n.stateful,this.unroll=n.unroll==null?!1:n.unroll,this.supportsMasking=!0,this.inputSpec=[new nr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Qa(0,n).map(r=>null)}else return this.states_}setStates(n){this.states_=n}computeOutputShape(n){uZ(n)&&(n=n[0]),n=n;let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);let i=r[0],o;if(this.returnSequences?o=[n[0],n[1],i]:o=[n[0],i],this.returnState){let s=[];for(let a of r)s.push([n[0],a]);return[o].concat(s)}else return o}computeMask(n,r){return ee(()=>{Array.isArray(r)&&(r=r[0]);let i=this.returnSequences?r:null;if(this.returnState){let o=this.states.map(s=>null);return[i].concat(o)}else return i})}get states(){if(this.states_==null){let n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let i=0;i<n;++i)r.push(null);return r}else return this.states_}set states(n){this.states_=n}build(n){if(this.numConstants!=null)throw new yt("Constants support is not implemented in RNN yet.");uZ(n)&&(n=n[0]),n=n;let i=this.stateful?n[0]:null,o=n.slice(2);this.inputSpec[0]=new nr({shape:[i,null,...o]});let s=[n[0]].concat(n.slice(2));this.cell.build(s);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!A.arraysEqual(this.stateSpec.map(l=>l.shape[l.shape.length-1]),a))throw new K(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(l=>new nr({shape:[null,l]}));this.stateful&&this.resetStates()}resetStates(n,r=!1){ee(()=>{if(!this.stateful)throw new Jc("Cannot call resetStates() on an RNN Layer that is not stateful.");let i=this.inputSpec[0].shape[0];if(i==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>ar([i,o])):this.states_=[ar([i,this.cell.stateSize])];else if(n==null)_t(this.states_),this.keptStates!=null&&(_t(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>ar([i,o])):this.states_[0]=ar([i,this.cell.stateSize]);else{if(Array.isArray(n)||(n=[n]),n.length!==this.states_.length)throw new K(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${n.length} state value(s). Input received: ${n}`);r===!0?this.keptStates.push(this.states_.slice()):_t(this.states_);for(let o=0;o<this.states_.length;++o){let s=n[o],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[o]:this.cell.stateSize,l=[i,a];if(!A.arraysEqual(s.shape,l))throw new K(`State ${o} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${s.shape}`);this.states_[o]=s}}this.states_=this.states_.map(o=>ro(o.clone()))})}apply(n,r){let i=r==null?null:r.initialState,o=r==null?null:r.constants;r==null&&(r={});let s=hCe(n,i,o,this.numConstants);n=s.inputs,i=s.initialState,o=s.constants;let a=[],l=[];if(i!=null){r.initialState=i,a=a.concat(i),this.stateSpec=[];for(let c of i)this.stateSpec.push(new nr({shape:c.shape}));l=l.concat(this.stateSpec)}if(o!=null&&(r.constants=o,a=a.concat(o),this.numConstants=o.length),a[0]instanceof ca){let c=[n].concat(a),f=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=f;let p=super.apply(c,r);return this.inputSpec=d,p}else return super.apply(n,r)}call(n,r){return ee(()=>{let i=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;n=ct(n),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(n));let a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==a)throw new K(`RNN Layer has ${a} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let l={training:o},c=gCe((h,g)=>{let x=this.cell.call([h].concat(g),l);return[x[0],x.slice(1)]},n,s,this.goBackwards,i,null,this.unroll,this.returnSequences),f=c[0],d=c[1],p=c[2];this.stateful&&this.resetStates(p,o);let m=this.returnSequences?d:f;return this.returnState?[m].concat(p):m})}getInitialState(n){return ee(()=>{let r=ar(n.shape);return r=Me(r,[1,2]),r=ay(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(i=>i>1?oZ(r,[1,i]):r):this.cell.stateSize>1?[oZ(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(n){super.setFastWeightInitDuringBuild(n),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(n)}getConfig(){let n=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(r.numConstants=this.numConstants);let i=this.cell.getConfig();return this.getClassName()===e.className&&(r.cell={className:this.cell.getClassName(),config:i}),Object.assign(Object.assign(Object.assign({},i),n),r)}static fromConfig(n,r,i={}){let o=r.cell,s=Xu(o,i);return new n(Object.assign(r,{cell:s}))}}return e.className="RNN",e})();fe.registerClass(p0);var fy=class extends xt{},PZ=(()=>{class e extends fy{constructor(n){super(n),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=n.units,mi(this.units,"units"),this.activation=pm(n.activation==null?this.DEFAULT_ACTIVATION:n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.kernelInitializer=Gn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Gn(n.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Gn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=rr(n.kernelRegularizer),this.recurrentRegularizer=rr(n.recurrentRegularizer),this.biasRegularizer=rr(n.biasRegularizer),this.kernelConstraint=Yr(n.kernelConstraint),this.recurrentConstraint=Yr(n.recurrentConstraint),this.biasConstraint=Yr(n.biasConstraint),this.dropout=rA([1,fm([0,n.dropout==null?0:n.dropout])]),this.recurrentDropout=rA([1,fm([0,n.recurrentDropout==null?0:n.recurrentDropout])]),this.dropoutFunc=n.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(n){n=Ut(n),this.kernel=this.addWeight("kernel",[n[n.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(n,r){return ee(()=>{if(n=n,n.length!==2)throw new K(`SimpleRNNCell expects 2 input Tensors, got ${n.length}.`);let i=n[1];n=n[0];let o=r.training==null?!1:r.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=dy({ones:()=>oo(n),rate:this.dropout,training:o,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=dy({ones:()=>oo(i),rate:this.recurrentDropout,training:o,dropoutFunc:this.dropoutFunc}));let s,a=this.dropoutMask,l=this.recurrentDropoutMask;a!=null?s=hd(j(n,a),this.kernel.read()):s=hd(n,this.kernel.read()),this.bias!=null&&(s=el(s,this.bias.read())),l!=null&&(i=j(i,l));let u=se(s,hd(i,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){let n=super.getConfig(),r={units:this.units,activation:dm(this.activation),useBias:this.useBias,kernelInitializer:dr(this.kernelInitializer),recurrentInitializer:dr(this.recurrentInitializer),biasInitializer:dr(this.biasInitializer),kernelRegularizer:In(this.kernelRegularizer),recurrentRegularizer:In(this.recurrentRegularizer),biasRegularizer:In(this.biasRegularizer),activityRegularizer:In(this.activityRegularizer),kernelConstraint:Hr(this.kernelConstraint),recurrentConstraint:Hr(this.recurrentConstraint),biasConstraint:Hr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},n),r)}}return e.className="SimpleRNNCell",e})();fe.registerClass(PZ);var xCe=(()=>{class e extends p0{constructor(n){n.cell=new PZ(n),super(n)}call(n,r){return ee(()=>{this.cell.dropoutMask!=null&&(_t(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_t(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let i=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return super.call(n,{mask:i,training:o,initialState:s})})}static fromConfig(n,r){return new n(r)}}return e.className="SimpleRNN",e})();fe.registerClass(xCe);var LZ=(()=>{class e extends fy{constructor(n){if(super(n),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",n.resetAfter)throw new K("GRUCell does not support reset_after parameter set to true.");this.units=n.units,mi(this.units,"units"),this.activation=pm(n.activation===void 0?this.DEFAULT_ACTIVATION:n.activation),this.recurrentActivation=pm(n.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),this.useBias=n.useBias==null?!0:n.useBias,this.kernelInitializer=Gn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Gn(n.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Gn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=rr(n.kernelRegularizer),this.recurrentRegularizer=rr(n.recurrentRegularizer),this.biasRegularizer=rr(n.biasRegularizer),this.kernelConstraint=Yr(n.kernelConstraint),this.recurrentConstraint=Yr(n.recurrentConstraint),this.biasConstraint=Yr(n.biasConstraint),this.dropout=rA([1,fm([0,n.dropout==null?0:n.dropout])]),this.recurrentDropout=rA([1,fm([0,n.recurrentDropout==null?0:n.recurrentDropout])]),this.dropoutFunc=n.dropoutFunc,this.implementation=n.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(n){n=Ut(n);let r=n[n.length-1];this.kernel=this.addWeight("kernel",[r,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(n,r){return ee(()=>{if(n=n,n.length!==2)throw new K(`GRUCell expects 2 input Tensors (inputs, h, c), got ${n.length}.`);let i=r.training==null?!1:r.training,o=n[1];n=n[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=dy({ones:()=>oo(n),rate:this.dropout,training:i,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=dy({ones:()=>oo(o),rate:this.recurrentDropout,training:i,count:3,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,a=this.recurrentDropoutMask,l,u,c;0<this.dropout&&this.dropout<1&&(n=j(n,s[0]));let f=hd(n,this.kernel.read());this.useBias&&(f=el(f,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(o=j(o,a[0]));let d=this.recurrentKernel.read(),[p,m]=Vi(d,[2*this.units,this.units],d.rank-1),h=hd(o,p),[g,x,b]=Vi(f,3,f.rank-1),[y,v]=Vi(h,2,h.rank-1);l=this.recurrentActivation.apply(se(g,y)),u=this.recurrentActivation.apply(se(x,v));let C=hd(j(u,o),m);c=this.activation.apply(se(b,C));let _=se(j(l,o),j(se(1,qt(l)),c));return[_,_]})}getConfig(){let n=super.getConfig(),r={units:this.units,activation:dm(this.activation),recurrentActivation:dm(this.recurrentActivation),useBias:this.useBias,kernelInitializer:dr(this.kernelInitializer),recurrentInitializer:dr(this.recurrentInitializer),biasInitializer:dr(this.biasInitializer),kernelRegularizer:In(this.kernelRegularizer),recurrentRegularizer:In(this.recurrentRegularizer),biasRegularizer:In(this.biasRegularizer),activityRegularizer:In(this.activityRegularizer),kernelConstraint:Hr(this.kernelConstraint),recurrentConstraint:Hr(this.recurrentConstraint),biasConstraint:Hr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},n),r)}}return e.className="GRUCell",e})();fe.registerClass(LZ);var bCe=(()=>{class e extends p0{constructor(n){n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new LZ(n),super(n)}call(n,r){return ee(()=>{this.cell.dropoutMask!=null&&(_t(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_t(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let i=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return super.call(n,{mask:i,training:o,initialState:s})})}static fromConfig(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)}}return e.className="GRU",e})();fe.registerClass(bCe);var FF=(()=>{class e extends fy{constructor(n){super(n),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=n.units,mi(this.units,"units"),this.activation=pm(n.activation===void 0?this.DEFAULT_ACTIVATION:n.activation),this.recurrentActivation=pm(n.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),this.useBias=n.useBias==null?!0:n.useBias,this.kernelInitializer=Gn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Gn(n.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Gn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=n.unitForgetBias,this.kernelRegularizer=rr(n.kernelRegularizer),this.recurrentRegularizer=rr(n.recurrentRegularizer),this.biasRegularizer=rr(n.biasRegularizer),this.kernelConstraint=Yr(n.kernelConstraint),this.recurrentConstraint=Yr(n.recurrentConstraint),this.biasConstraint=Yr(n.biasConstraint),this.dropout=rA([1,fm([0,n.dropout==null?0:n.dropout])]),this.recurrentDropout=rA([1,fm([0,n.recurrentDropout==null?0:n.recurrentDropout])]),this.dropoutFunc=n.dropoutFunc,this.implementation=n.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(n){var r;n=Ut(n);let i=n[n.length-1];this.kernel=this.addWeight("kernel",[i,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let o;if(this.useBias){if(this.unitForgetBias){let s=this.biasInitializer,a=this.units;o=new(r=class extends tl{apply(u,c){let f=s.apply([a]),d=new lZ().apply([a]),p=s.apply([a*2]);return Owe(Owe(f,d),p)}},r.className="CustomInit",r)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,o,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(n,r){return ee(()=>{let i=r.training==null?!1:r.training;if(n=n,n.length!==3)throw new K(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${n.length}.`);let o=n[1],s=n[2];n=n[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=dy({ones:()=>oo(n),rate:this.dropout,training:i,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=dy({ones:()=>oo(o),rate:this.recurrentDropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,l=this.recurrentDropoutMask,u,c,f,d;0<this.dropout&&this.dropout<1&&(n=j(n,a[0]));let p=hd(n,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(o=j(o,l[0])),p=se(p,hd(o,this.recurrentKernel.read())),this.useBias&&(p=el(p,this.bias.read()));let[m,h,g,x]=Vi(p,4,p.rank-1);u=this.recurrentActivation.apply(m),c=this.recurrentActivation.apply(h),f=se(j(c,s),j(u,this.activation.apply(g))),d=this.recurrentActivation.apply(x);let b=j(d,this.activation.apply(f));return[b,b,f]})}getConfig(){let n=super.getConfig(),r={units:this.units,activation:dm(this.activation),recurrentActivation:dm(this.recurrentActivation),useBias:this.useBias,kernelInitializer:dr(this.kernelInitializer),recurrentInitializer:dr(this.recurrentInitializer),biasInitializer:dr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:In(this.kernelRegularizer),recurrentRegularizer:In(this.recurrentRegularizer),biasRegularizer:In(this.biasRegularizer),activityRegularizer:In(this.activityRegularizer),kernelConstraint:Hr(this.kernelConstraint),recurrentConstraint:Hr(this.recurrentConstraint),biasConstraint:Hr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},n),r)}}return e.className="LSTMCell",e})();fe.registerClass(FF);var yCe=(()=>{class e extends p0{constructor(n){n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new FF(n),super(n)}call(n,r){return ee(()=>{this.cell.dropoutMask!=null&&(_t(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_t(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let i=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return super.call(n,{mask:i,training:o,initialState:s})})}static fromConfig(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)}}return e.className="LSTM",e})();fe.registerClass(yCe);var BZ=(()=>{class e extends fy{constructor(n){super(n),this.cells=n.cells}get stateSize(){let n=[];for(let r of this.cells.slice().reverse())Array.isArray(r.stateSize)?n.push(...r.stateSize):n.push(r.stateSize);return n}call(n,r){return ee(()=>{n=n;let i=n.slice(1),o=[];for(let l of this.cells.slice().reverse())Array.isArray(l.stateSize)?o.push(i.splice(0,l.stateSize.length)):o.push(i.splice(0,1));o.reverse();let s=[],a;for(let l=0;l<this.cells.length;++l){let u=this.cells[l];i=o[l],l===0?a=[n[0]].concat(i):a=[a[0]].concat(i),a=u.call(a,r),s.push(a.slice(1))}i=[];for(let l of s.slice().reverse())i.push(...l);return[a[0]].concat(i)})}build(n){uZ(n)&&(n=n[0]),n=n;let r;this.cells.forEach((i,o)=>{cm(`RNNCell_${o}`,()=>{i.build(n),Array.isArray(i.stateSize)?r=i.stateSize[0]:r=i.stateSize,n=[n[0],r]})}),this.built=!0}getConfig(){let n=super.getConfig(),r=s=>({className:s.getClassName(),config:s.getConfig()}),o={cells:this.cells.map(r)};return Object.assign(Object.assign({},n),o)}static fromConfig(n,r,i={}){let o=[];for(let s of r.cells)o.push(Xu(s,i));return new n({cells:o})}get trainableWeights(){if(!this.trainable)return[];let n=[];for(let r of this.cells)n.push(...r.trainableWeights);return n}get nonTrainableWeights(){let n=[];for(let r of this.cells)n.push(...r.nonTrainableWeights);if(!this.trainable){let r=[];for(let i of this.cells)r.push(...i.trainableWeights);return r.concat(n)}return n}getWeights(){let n=[];for(let r of this.cells)n.push(...r.weights);return b4(n)}setWeights(n){let r=[];for(let i of this.cells){let o=i.weights.length,s=n.splice(o);for(let a=0;a<i.weights.length;++a)r.push([i.weights[a],s[a]])}AF(r)}}return e.className="StackedRNNCells",e})();fe.registerClass(BZ);function dy(e){let{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:o}=e,s=()=>o!=null?o(t(),n):aZ(t(),n),a=()=>Yw(s,t,r);return!i||i<=1?ro(a().clone()):Array(i).fill(void 0).map(a).map(u=>ro(u.clone()))}var Fwn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};var Rwn=(()=>{class e extends p0{constructor(n){if(n.unroll)throw new yt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(n.cell))throw new yt("It is not possible at the moment to stack convolutional cells.");super(n),this.inputSpec=[new nr({ndim:5})]}call(n,r){return ee(()=>{if(this.cell.dropoutMask!=null&&(_t(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_t(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),r&&r.constants)throw new K("ConvRNN2D cell does not support constants");let i=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return super.call(n,{mask:i,training:o,initialState:s})})}computeOutputShape(n){let r=this.computeSingleOutputShape(n);return this.returnSequences||(r=[r[0],...r.slice(2)]),this.returnState&&(r=[r,...Array(2).fill([n[0],...r.slice(-3)])]),r}getInitialState(n){return ee(()=>{let{stateSize:r}=this.cell,i=n.shape,o=this.computeSingleOutputShape(i),s=[o[0],...o.slice(2)],a=ar(s);return Array.isArray(r)?Array(r.length).fill(a):[a]})}resetStates(n,r=!1){ee(()=>{if(!this.stateful)throw new Jc("Cannot call resetStates() on an RNN Layer that is not stateful.");let i=this.inputSpec[0].shape,o=this.computeSingleOutputShape(i),s=[o[0],...o.slice(2)];if(i[0]==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>ar(s)):this.states_=[ar(s)];else if(n==null)_t(this.states_),this.keptStates!=null&&(_t(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>ar(s)):this.states_[0]=ar(s);else{if(Array.isArray(n)||(n=[n]),n.length!==this.states_.length)throw new K(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${n.length} state value(s). Input received: ${n}`);r?this.keptStates.push(this.states_.slice()):_t(this.states_);for(let l=0;l<this.states_.length;++l){let u=n[l],c=s;if(!A.arraysEqual(u.shape,c))throw new K(`State ${l} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${u.shape}`);this.states_[l]=u}}this.states_=this.states_.map(l=>ro(l.clone()))})}computeSingleOutputShape(n){let{dataFormat:r,filters:i,kernelSize:o,padding:s,strides:a,dilationRate:l}=this.cell,u=r==="channelsFirst",c=n[u?3:2],f=n[u?4:3],d=Vl(c,o[0],s,a[0],l[0]),p=Vl(f,o[1],s,a[1],l[1]);return[...n.slice(0,2),...u?[i,d,p]:[d,p,i]]}}return e.className="ConvRNN2D",e})(),zZ=(()=>{class e extends FF{constructor(n){let{filters:r,kernelSize:i,strides:o,padding:s,dataFormat:a,dilationRate:l}=n;super(Object.assign(Object.assign({},n),{units:r})),this.filters=r,mi(this.filters,"filters"),this.kernelSize=Zw(i,2,"kernelSize"),this.kernelSize.forEach(u=>mi(u,"kernelSize")),this.strides=Zw(o||1,2,"strides"),this.strides.forEach(u=>mi(u,"strides")),this.padding=s||"valid",Za(this.padding),this.dataFormat=a||"channelsLast",Mr(this.dataFormat),this.dilationRate=Zw(l||1,2,"dilationRate"),this.dilationRate.forEach(u=>mi(u,"dilationRate"))}build(n){var r;n=Ut(n);let i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new K(`The channel dimension of the input should be defined. Found ${n[i]}`);let o=n[i],s=4,a=this.kernelSize.concat([o,this.filters*s]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let l=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){let c=this.biasInitializer,f=this.filters;u=new(r=class extends tl{apply(p,m){let h=c.apply([f]),g=vi([f]),x=c.apply([f*2]);return CF([h,g,x])}},r.className="CustomInit",r)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(n,r){return ee(()=>{if(n.length!==3)throw new K(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${n.length}.`);let i=r.training||!1,o=n[0],s=n[1],a=n[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=dy({ones:()=>oo(o),rate:this.dropout,training:i,count:l,dropoutFunc:this.dropoutFunc}));let u=this.dropoutMask,c=(oe,me,ge)=>!me||!me[ge]?oe:j(me[ge],oe),f=c(o,u,0),d=c(o,u,1),p=c(o,u,2),m=c(o,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=dy({ones:()=>oo(s),rate:this.recurrentDropout,training:i,count:l,dropoutFunc:this.dropoutFunc}));let h=this.recurrentDropoutMask,g=c(s,h,0),x=c(s,h,1),b=c(s,h,2),y=c(s,h,3),v=3,[C,_,S,E]=Vi(this.kernel.read(),l,v),[T,I,k,O]=this.useBias?Vi(this.bias.read(),l):[null,null,null,null];f=this.inputConv(f,C,T,this.padding),d=this.inputConv(d,_,I,this.padding),p=this.inputConv(p,S,k,this.padding),m=this.inputConv(m,E,O,this.padding);let[F,B,M,z]=Vi(this.recurrentKernel.read(),l,v);g=this.recurrentConv(g,F),x=this.recurrentConv(x,B),b=this.recurrentConv(b,M),y=this.recurrentConv(y,z);let W=this.recurrentActivation.apply(se(f,g)),H=this.recurrentActivation.apply(se(d,x)),Q=se(j(H,a),j(W,this.activation.apply(se(p,b)))),re=j(this.recurrentActivation.apply(se(m,y)),this.activation.apply(Q));return[re,re,Q]})}getConfig(){let n=super.getConfig(),{units:r}=n,i=Fwn(n,["units"]),o={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},i),o)}inputConv(n,r,i,o){let s=cl(n,r,this.strides,o||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return i?el(s,i,this.dataFormat):s}recurrentConv(n,r){return cl(n,r,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}return e.className="ConvLSTM2DCell",e})();fe.registerClass(zZ);var vCe=(()=>{class e extends Rwn{constructor(n){let r=new zZ(n);super(Object.assign(Object.assign({},n),{cell:r}))}static fromConfig(n,r){return new n(r)}}return e.className="ConvLSTM2D",e})();fe.registerClass(vCe);N();var UZ=(()=>{class e extends xt{constructor(n){super(n),this.rate=Math.max(Math.min(n.rate,1),0),this.noiseShape=n.noiseShape,this.seed=n.seed,this.supportsMasking=!0}getNoiseShape(n){if(this.noiseShape==null)return this.noiseShape;let r=n.shape,i=[];for(let o=0;o<this.noiseShape.length;++o)i.push(this.noiseShape[o]==null?r[o]:this.noiseShape[o]);return i}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n);if(0<this.rate&&this.rate<1){let o=r.training==null?!1:r.training,s=this.getNoiseShape(i);return Yw(()=>aZ(i,this.rate,s,this.seed),()=>i,o)}return n})}getConfig(){let n={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=super.getConfig();return Object.assign(n,r),n}dispose(){return super.dispose()}}return e.className="Dropout",e})();fe.registerClass(UZ);var wCe=(()=>{class e extends UZ{constructor(n){super(n),this.inputSpec=[{ndim:3}]}getNoiseShape(n){let r=n.shape;return[r[0],1,r[2]]}}return e.className="SpatialDropout1D",e})();fe.registerClass(wCe);var CCe=(()=>{class e extends xt{constructor(n){if(super(n),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",n.batchInputShape==null&&n.inputShape==null&&n.inputDim!=null){let r=null;n.batchSize!=null&&(r=n.batchSize),this.batchInputShape=[r,n.inputDim]}this.units=n.units,mi(this.units,"units"),this.activation=pm(n.activation),n.useBias!=null&&(this.useBias=n.useBias),this.kernelInitializer=Gn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Gn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Yr(n.kernelConstraint),this.biasConstraint=Yr(n.biasConstraint),this.kernelRegularizer=rr(n.kernelRegularizer),this.biasRegularizer=rr(n.biasRegularizer),this.activityRegularizer=rr(n.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(n){n=Ut(n);let r=n[n.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[r,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:r}}],this.built=!0}computeOutputShape(n){n=Ut(n);let r=n.slice();return r[r.length-1]=this.units,r}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n),o=JX(this.activation.getClassName()),s;return o!=null?s=hd(i,this.kernel.read(),o,this.bias?this.bias.read():null):(s=hd(i,this.kernel.read()),this.bias!=null&&(s=el(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){let n={units:this.units,activation:dm(this.activation),useBias:this.useBias,kernelInitializer:dr(this.kernelInitializer),biasInitializer:dr(this.biasInitializer),kernelRegularizer:In(this.kernelRegularizer),biasRegularizer:In(this.biasRegularizer),activityRegularizer:In(this.activityRegularizer),kernelConstraint:Hr(this.kernelConstraint),biasConstraint:Hr(this.biasConstraint)},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Dense",e})();fe.registerClass(CCe);var _Ce=(()=>{class e extends xt{constructor(n){n=n||{},super(n),this.inputSpec=[{minNDim:3}],this.dataFormat=n.dataFormat}computeOutputShape(n){n=Ut(n);for(let r of n.slice(1))if(r==null)throw new K(`The shape of the input to "Flatten" is not fully defined (got ${n.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[n[0],md(n,1)]}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n);if(this.dataFormat==="channelsFirst"&&i.rank>1){let o=[0];for(let s=2;s<i.rank;++s)o.push(s);o.push(1),i=zt(i,o)}return mpt(i)})}getConfig(){let n={};this.dataFormat!=null&&(n.dataFormat=this.dataFormat);let r=super.getConfig();return Object.assign(n,r),n}}return e.className="Flatten",e})();fe.registerClass(_Ce);var SCe=(()=>{class e extends xt{constructor(n){super(n),this.supportsMasking=!0,this.activation=pm(n.activation)}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n);return this.activation.apply(i)})}getConfig(){let n={activation:dm(this.activation)},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Activation",e})();fe.registerClass(SCe);var ECe=(()=>{class e extends xt{constructor(n){super(n),this.n=n.n,this.inputSpec=[{ndim:2}]}computeOutputShape(n){return[n[0],this.n,n[1]]}call(n,r){return ee(()=>(n=ct(n),dpt(n,this.n)))}getConfig(){let n={n:this.n},r=super.getConfig();return Object.assign(n,r),n}}return e.className="RepeatVector",e})();fe.registerClass(ECe);var ACe=(()=>{class e extends xt{constructor(n){super(n),this.targetShape=n.targetShape;for(let r=0;r<this.targetShape.length;++r)this.isUnknown(this.targetShape[r])&&(this.targetShape[r]=null)}isUnknown(n){return n<0||n==null}fixUnknownDimension(n,r){let i="Total size of new array must be unchanged.",o=r.slice(),s=1,a=null;for(let u=0;u<o.length;++u){let c=o[u];if(this.isUnknown(c))if(a===null)a=u;else throw new K("Can only specifiy one unknown dimension.");else s*=c}let l=md(n);if(a!==null){if(s===0||l%s!==0)throw new K(i);o[a]=l/s}else if(l!==s)throw new K(i);return o}computeOutputShape(n){let r=!1;for(let i=0;i<n.length;++i)if(this.isUnknown(n[i])){r=!0;break}return r?n.slice(0,1).concat(this.targetShape):n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape))}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n),o=i.shape,s=o.slice(0,1).concat(this.fixUnknownDimension(o.slice(1),this.targetShape));return V(i,s)})}getConfig(){let n={targetShape:this.targetShape},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Reshape",e})();fe.registerClass(ACe);var TCe=(()=>{class e extends xt{constructor(n){if(super(n),n.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(n.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${n.dims} instead.`);let r=Qa(1,n.dims.length+1);if(!A.arraysEqual(n.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(n.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=n.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new nr({ndim:this.dims.length+1})]}computeOutputShape(n){n=Ut(n);let r=n.slice();return this.dims.forEach((i,o)=>{r[o+1]=n[i]}),r}call(n,r){return zt(ct(n),this.dimsIncludingBatch)}getConfig(){let n={dims:this.dims},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Permute",e})();fe.registerClass(TCe);var kCe=(()=>{class e extends xt{constructor(n){super(n??{}),this.supportsMasking=!0,n!=null?this.maskValue=n.maskValue==null?0:n.maskValue:this.maskValue=0}computeOutputShape(n){return n}getConfig(){let n=super.getConfig(),r={maskValue:this.maskValue};return Object.assign(r,n),r}computeMask(n,r){let i=ct(n);return L_(Ud(i,this.maskValue),-1)}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n),a=L_(Ud(i,this.maskValue),-1,!0);return j(i,de(a,i.dtype))})}}return e.className="Masking",e})();fe.registerClass(kCe);N();var ICe=(()=>{class e extends xt{constructor(n){if(super(n),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",n.batchInputShape==null&&n.inputShape==null){let r=null;n.batchSize!=null&&(r=n.batchSize),n.inputLength==null?this.batchInputShape=[r,null]:this.batchInputShape=[r].concat(An(n.inputLength))}this.inputDim=n.inputDim,mi(this.inputDim,"inputDim"),this.outputDim=n.outputDim,mi(this.outputDim,"outputDim"),this.embeddingsInitializer=Gn(n.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=rr(n.embeddingsRegularizer),this.activityRegularizer=rr(n.activityRegularizer),this.embeddingsConstraint=Yr(n.embeddingsConstraint),this.maskZero=n.maskZero,this.supportsMasking=n.maskZero,this.inputLength=n.inputLength}build(n){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(n){}computeMask(n,r){return ee(()=>this.maskZero?(n=ct(n),Ud(n,lt(n))):null)}computeOutputShape(n){if(n=Ut(n),this.inputLength==null)return[...n,this.outputDim];let r=An(this.inputLength);if(r.length!==n.length-1)throw new K(`"inputLength" is ${this.inputLength}, but received input shape has shape ${n}`);{let i=0;for(let o=0;o<r.length;++o){let s=r[o],a=n[o+1];if(s!=null&&a!=null&&s!==a)throw new K(`"inputLength" is ${this.inputLength}, but received input shape has shape ${n}`);s==null&&(r[i]=a),i++}}return[n[0],...r,this.outputDim]}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n);i.dtype!=="int32"&&(i=ua(i,"int32"));let o=sZ(this.embeddings.read(),V(i,[i.size]));return V(o,Ut(this.computeOutputShape(i.shape)))})}getConfig(){let n={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:dr(this.embeddingsInitializer),embeddingsRegularizer:In(this.embeddingsRegularizer),activityRegularizer:In(this.activityRegularizer),embeddingsConstraint:Hr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Embedding",e})();fe.registerClass(ICe);N();N();var py=class extends xt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new yt}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;let r=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){let o=t[t.length-n.length+i],s=n[i];if(o==null||s==null||o<0||s<0)r.push(null);else if(o===1)r.push(s);else if(s===1)r.push(o);else{if(o!==s)throw new K("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));r.push(o)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Ut(t)]),t=t,t.length<2)throw new K(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(let o of t)o!=null&&o[0]!==null&&n.push(o[0]);if(n=pd(n),n.length>1)throw new K(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let o=1;o<t.length;++o){let s=t[o]==null?null:t[o].slice(1);r=this.computeElementwiseOpOutputShape(r,s)}let i=t.map(o=>o.length);t.indexOf(null)===-1&&pd(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return ee(()=>{if(t=t,this.reshapeRequired){let r=[],i=t.map(o=>o.rank);if(i.indexOf(null)===-1){let o=fm(i);for(let s of t){let a=s.rank;for(let l=0;l<o-a;++l)s=ay(s,1);r.push(s)}return this.mergeFunction(r)}else{let o=!1;for(let l of t){let u=l.rank;if(u==null){let c=l.shape,f=c[0],d=c.slice(1).concat([f]),p=V(l,[f].concat(md(c.slice(1))));p=zt(p,[1,0]),p=V(p,d),r.push(p),o=!0}else if(u>1){let c=Qa(1,u).concat([0]);r.push(zt(l,c)),o=!0}else r.push(l)}let s=this.mergeFunction(r),a=s.rank;if(o){if(a==null){let l=s.shape,u=l.length,c=l[u-1],f=[c].concat(l.slice(0,l.length-1));s=V(zt(V(s,[-1,c]),[1,0]),f)}else if(a>1){let l=[a-1].concat(Qa(0,a-1));s=zt(s,l)}}return s}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){let o=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let r=[];for(let i of t)i!=null&&i[0]!==null&&r.push(i[0]);return r=pd(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(t,n){return ee(()=>{if(n==null)return null;if(!Array.isArray(n))throw new K("`mask` should be an Array");if(!Array.isArray(t))throw new K("`inputs` should be an Array");if(n.length!==t.length)throw new K(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:ri(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=cs(r,n[i]);return r})}},DCe=(()=>{class e extends py{constructor(n){super(n)}mergeFunction(n){return ee(()=>{let r=n[0].clone();for(let i=1;i<n.length;++i)r=se(r,n[i]);return r})}}return e.className="Add",e})();fe.registerClass(DCe);var NCe=(()=>{class e extends py{constructor(n){super(n)}mergeFunction(n){return ee(()=>{let r=n[0].clone();for(let i=1;i<n.length;++i)r=j(r,n[i]);return r})}}return e.className="Multiply",e})();fe.registerClass(NCe);var FCe=(()=>{class e extends py{constructor(n){super(n)}mergeFunction(n){return ee(()=>{let r=n[0].clone();for(let i=1;i<n.length;++i)r=se(r,n[i]);return j(1/n.length,r)})}}return e.className="Average",e})();fe.registerClass(FCe);var RCe=(()=>{class e extends py{constructor(n){super(n)}mergeFunction(n){return ee(()=>{let r=n[0];for(let i=1;i<n.length;++i)r=dl(r,n[i]);return r})}}return e.className="Maximum",e})();fe.registerClass(RCe);var OCe=(()=>{class e extends py{constructor(n){super(n)}mergeFunction(n){return ee(()=>{let r=n[0];for(let i=1;i<n.length;++i)r=mc(r,n[i]);return r})}}return e.className="Minimum",e})();fe.registerClass(OCe);var MCe=(()=>{class e extends py{constructor(n){super(n),this.DEFAULT_AXIS=-1,n==null&&(n={}),this.axis=n.axis==null?this.DEFAULT_AXIS:n.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(n){if(!(Array.isArray(n)&&Array.isArray(n[0]))||n.length===1)throw new K("A `Concatenate` layer should be called on a list of at least 2 inputs");n=n;let r=!0;for(let o of n)if(o!=null){r=!1;break}if(r)return;let i=[];for(let o=0;o<n.length;++o){let s=n[o].slice();s.splice(this.axis,1);let a=!1;for(let l of i)if(A.arraysEqual(l,s)){a=!0;break}a||i.push(s)}if(i.length>1)throw new K("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(n))}mergeFunction(n){return ee(()=>CF(n,this.axis))}computeOutputShape(n){if(!(Array.isArray(n)&&Array.isArray(n[0])))throw new K("A `Concatenate` layer should be called on a list of inputs.");let r=n,i=r[0].slice(),o=this.axis<0?i.length+this.axis:this.axis;for(let s of r.slice(1)){if(i[o]==null||s[o]==null){i[o]=null;break}i[o]+=s[o]}return i}computeMask(n,r){if(r==null)return null;if(!Array.isArray(r))throw new K("`mask` should be an array for Concatenate");if(!Array.isArray(n))throw new K("`inputs` should be an array for Concatenate");if(r.length!==n.length)throw new K(`Mismatch in the length of mask (${r.length}) and the legnth of inputs (${n.length})`);return ee(()=>{let i=!0;if(r.forEach(a=>{if(a!=null){i=!1;return}}),i)return null;let o=[];for(let a=0;a<n.length;++a)r[a]==null?o.push(de(oo(n[a]),"bool")):r[a].rank<n[a].rank?o.push(ri(r[a],-1)):o.push(r[a]);let s=En(o,this.axis);return vT(s,-1,!1)})}getConfig(){let n={axis:this.axis},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Concatenate",e})();fe.registerClass(MCe);function T4(e,t){for(;e<0;)e+=t;return e}function Own(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new yt("batchDot is not implemented for tensors of 4D or higher rank yet");if(A.assert(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),A.assert(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new yt("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);let o=n;return ee(()=>{let s;if(r>i){s=r-i;let l=[];for(let u=0;u<s;++u)l.push(1);t=V(t,t.shape.concat(l))}else if(i>r){s=i-r;let l=[];for(let u=0;u<s;++u)l.push(1);e=V(e,e.shape.concat(l))}else s=0;let a;if(e.shape.length===2&&t.shape.length===2)o[0]===o[1]?a=Me(j(e,t),o[0]):a=Me(j(zt(e,[1,0]),t),o[1]);else{let l=o[0]!==e.shape.length-1,u=o[1]===t.shape.length-1;a=Bt(e,t,l,u)}if(s>0){let l;r>i?l=r+i-3:l=r-1;let u=[];for(let c=l;c<l+s;++c)u.push(c);a=nu(a,u)}return a.shape.length===1&&(a=ri(a,1)),a})}var $Ce=(()=>{class e extends py{constructor(n){super(n),this.axes=n.axes,this.normalize=n.normalize==null?!1:n.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(n){A.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=n[0],i=n[1];if(r.length>3||i.length>3)throw new yt("Dot layer does not support tensors of 4D or higher rank yet.");let o=this.interpretAxes(r,i);if(r[o[0]]!==i[o[1]])throw new K(`Dimension incompatibility: ${r[o[0]]} !== ${i[o[1]]}`)}mergeFunction(n){if(n.length!==2)throw new K(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${n.length} input(s).`);let r=n[0],i=n[1],o;return Array.isArray(this.axes)?o=this.axes.map((s,a)=>T4(s,n[a].shape.length)):o=[T4(this.axes,r.shape.length),T4(this.axes,i.shape.length)],this.normalize&&(r=y4(r,o[0]),i=y4(i,o[1])),Own(r,i,o)}interpretAxes(n,r){let i;return Array.isArray(this.axes)?i=this.axes:i=[T4(this.axes,n.length),T4(this.axes,r.length)],i}computeOutputShape(n){A.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=n[0].slice(),i=n[1].slice();if(r.length>3||i.length>3)throw new yt("Dot layer does not support tensors of 4D or higher rank yet.");let o=this.interpretAxes(r,i);r.splice(o[0],1),i.splice(o[1],1),i.splice(0,1);let s=r.concat(i);return s.length===1&&s.push(1),s}computeMask(n,r){return null}getConfig(){let n={axes:this.axes,normalize:this.normalize},r=super.getConfig();return Object.assign(n,r),n}}return e.className="Dot",e})();fe.registerClass($Ce);N();var PCe=(()=>{class e extends xt{constructor(n){super(n),this.supportsMasking=!0,this.stddev=n.stddev}computeOutputShape(n){return n}getConfig(){let n=super.getConfig(),r={stddev:this.stddev};return Object.assign(r,n),r}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n);return Yw(()=>se(_F(i.shape,0,this.stddev),i),()=>i,r.training||!1)})}}return e.className="GaussianNoise",e})();fe.registerClass(PCe);var LCe=(()=>{class e extends xt{constructor(n){super(n),this.supportsMasking=!0,this.rate=n.rate}computeOutputShape(n){return n}getConfig(){let n=super.getConfig(),r={rate:this.rate};return Object.assign(r,n),r}call(n,r){return ee(()=>{this.invokeCallHook(n,r);let i=ct(n);return this.rate>0&&this.rate<1?Yw(()=>{let s=Math.sqrt(this.rate/(1-this.rate));return j(i,_F(i.shape,1,s))},()=>i,r.training||!1):i})}}return e.className="GaussianDropout",e})();fe.registerClass(LCe);var BCe=(()=>{class e extends xt{constructor(n){super(n),this.supportsMasking=!0,this.rate=n.rate,this.noiseShape=n.noiseShape}_getNoiseShape(n){return this.noiseShape||ct(n).shape}computeOutputShape(n){return n}getConfig(){let n=super.getConfig(),r={rate:this.rate};return Object.assign(r,n),r}call(n,r){return ee(()=>{if(this.rate<1&&this.rate>0){let i=this._getNoiseShape(n);return Yw(()=>{let s=ct(n),u=-1.6732632423543772*1.0507009873554805,c=ba(tu(i),this.rate);c=ua(c,"float32");let f=((1-this.rate)*(1+this.rate*u**2))**-.5,d=-f*u*this.rate,p=se(j(s,c),j(se(c,-1),u));return se(j(p,f),d)},()=>ct(n),r.training||!1)}return n})}}return e.className="AlphaDropout",e})();fe.registerClass(BCe);N();N();function k4(e,t,n,r,i,o=.001){let s;if(e.rank===2)s=h6(e,t,n,r,i,o);else if(e.rank===3)s=g6(e,t,n,r,i,o);else if(e.rank===4)s=x6(e,t,n,r,i,o);else throw new yt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return s}function Mwn(e,t,n,r,i=.001){return ee(()=>{let o=q_(e,r),s=o.mean,a=o.variance;return[k4(e,s,a,n,t,i),s,a]})}function $wn(e,t,n,r,i=.001){return ee(()=>{let o=q_(e,r),s=o.mean,a=o.variance,l=[];for(let m of Qa(0,e.rank))r.indexOf(m)!==-1?l.push(1):l.push(e.shape[m]);let u=V(s,l),c=V(a,l),f=t==null?null:V(t,l),d=n==null?null:V(n,l);return[k4(e,u,c,d,f,i),s,a]})}function Pwn(e,t,n,r,i=.001){return A.arraysEqual(r.slice().sort(),Qa(0,e.rank-1))?Mwn(e,t,n,r,i):$wn(e,t,n,r,i)}var zCe=(()=>{class e extends xt{constructor(n){n==null&&(n={}),super(n),this.supportsMasking=!0,this.axis=n.axis==null?-1:n.axis,this.momentum=n.momentum==null?.99:n.momentum,this.epsilon=n.epsilon==null?.001:n.epsilon,this.center=n.center==null?!0:n.center,this.scale=n.scale==null?!0:n.scale,this.betaInitializer=Gn(n.betaInitializer||"zeros"),this.gammaInitializer=Gn(n.gammaInitializer||"ones"),this.movingMeanInitializer=Gn(n.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Gn(n.movingVarianceInitializer||"ones"),this.betaConstraint=Yr(n.betaConstraint),this.gammaConstraint=Yr(n.gammaConstraint),this.betaRegularizer=rr(n.betaRegularizer),this.gammaRegularizer=rr(n.gammaRegularizer)}build(n){n=Ut(n);let r=this.axis>=0?this.axis:this.axis+n.length,i=n[r];if(i==null)throw new K(`Axis ${r} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(n)}.`);this.inputSpec=[new nr({ndim:n.length,axes:{[r]:i}})];let o=[i];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(n,r){return ee(()=>{let i=r.training==null?!1:r.training,o=ct(n),s=o.shape,a=s.length,l=Qa(0,a),u=this.axis>=0?this.axis:this.axis+a;l.splice(u,1);let c=fd(1,a);c[u]=s[u];let f=l.slice();f.sort();let d=!A.arraysEqual(f,Qa(0,a).slice(0,a-1)),p=()=>{if(d){let y=V(this.movingMean.read(),c),v=V(this.movingVariance.read(),c),C=this.center?V(this.beta.read(),c):null,_=this.scale?V(this.gamma.read(),c):null;return k4(o,y,v,C,_,this.epsilon)}else return k4(o,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!i)return p();let[m,h,g]=Pwn(o,this.gamma.read(),this.beta.read(),l,this.epsilon),x=(y,v,C)=>{ee(()=>{let _=1-C,S=y.read(),E=j(De(S,v),_);y.write(De(S,E))})};return(()=>{x(this.movingMean,h,this.momentum),x(this.movingVariance,g,this.momentum)})(),m})}getConfig(){let n={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:dr(this.betaInitializer),gammaInitializer:dr(this.gammaInitializer),movingMeanInitializer:dr(this.movingMeanInitializer),movingVarianceInitializer:dr(this.movingVarianceInitializer),betaRegularizer:In(this.betaRegularizer),gammaRegularizer:In(this.gammaRegularizer),betaConstraint:Hr(this.betaConstraint),gammaConstraint:Hr(this.gammaConstraint)},r=super.getConfig();return Object.assign(n,r),n}}return e.className="BatchNormalization",e})();fe.registerClass(zCe);var UCe=(()=>{class e extends xt{constructor(n){if(n==null&&(n={}),super(n),this.axis=n.axis==null?-1:n.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let r of this.axis)if(!Number.isInteger(r))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=n.epsilon==null?.001:n.epsilon,this.center=n.center==null?!0:n.center,this.scale=n.scale==null?!0:n.scale,this.betaInitializer=Gn(n.betaInitializer||"zeros"),this.gammaInitializer=Gn(n.gammaInitializer||"ones"),this.betaRegularizer=rr(n.betaRegularizer),this.gammaRegularizer=rr(n.gammaRegularizer),this.supportsMasking=!0}build(n){n=Ut(n);let r=n.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=r);for(let s of this.axis)if(s<0||s>=r)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==pd(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let i=this.axis.map(s=>n[s]),o=!0;this.scale?this.gamma=this.addWeight("gamma",i,"float32",this.gammaInitializer,this.gammaRegularizer,o):this.gamma=null,this.center?this.beta=this.addWeight("beta",i,"float32",this.betaInitializer,this.betaRegularizer,o):this.beta=null,this.built=!0}call(n,r){let i=ct(n),o=i.shape,s=o.length;return ee(()=>{let{mean:l,variance:u}=q_(i,this.axis,!0),c=fd(1,s);for(let g of this.axis)c[g]=o[g];let f=g=>g!=null&&g.shape.length!==s?V(g,c):g,d=this.scale?f(this.gamma.read()):null,p=this.center?f(this.beta.read()):null,m=[],h=[];for(let g=0;g<s;++g)this.axis.indexOf(g)!==-1?(m.push(o[g]),h.push(1)):(m.push(1),h.push(o[g]));return l=qo(l,m),u=qo(u,m),d!=null&&(d=qo(d,h)),p!=null&&(p=qo(p,h)),k4(i,l,u,p,d,this.epsilon)})}getConfig(){let n={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:dr(this.betaInitializer),gammaInitializer:dr(this.gammaInitializer),betaRegularizer:In(this.betaRegularizer),gammaRegularizer:In(this.gammaRegularizer)},r=super.getConfig();return Object.assign(n,r),n}}return e.className="LayerNormalization",e})();fe.registerClass(UCe);N();N();function Lwn(e,t,n){return ee(()=>{if(e.rank!==4)throw new K(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new K("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ja()),n!=="channelsLast"&&n!=="channelsFirst")throw new K(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],ya(e,r)})}var jCe=(()=>{class e extends xt{constructor(n){if(n==null&&(n={}),super(n),this.dataFormat=n.dataFormat==null?Ja():n.dataFormat,n.padding==null)this.padding=[[1,1],[1,1]];else if(typeof n.padding=="number")this.padding=[[n.padding,n.padding],[n.padding,n.padding]];else{if(n.padding=n.padding,n.padding.length!==2)throw new K(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${n.padding.length} array.`);let r,i;if(typeof n.padding[0]=="number")r=[n.padding[0],n.padding[0]],i=[n.padding[1],n.padding[1]];else{if(n.padding=n.padding,n.padding[0].length!==2)throw new K(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${n.padding[0].length} array.`);if(r=n.padding[0],n.padding[1].length!==2)throw new K(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${n.padding[1].length} array.`);i=n.padding[1]}this.padding=[r,i]}this.inputSpec=[new nr({ndim:4})]}computeOutputShape(n){n=Ut(n);let r,i;return this.dataFormat==="channelsFirst"?(n[2]!=null&&n[2]>=0?r=n[2]+this.padding[0][0]+this.padding[0][1]:r=null,n[3]!=null&&n[3]>=0?i=n[3]+this.padding[1][0]+this.padding[1][1]:i=null,[n[0],n[1],r,i]):(n[1]!=null&&n[1]>=0?r=n[1]+this.padding[0][0]+this.padding[0][1]:r=null,n[2]!=null&&n[2]>=0?i=n[2]+this.padding[1][0]+this.padding[1][1]:i=null,[n[0],r,i,n[3]])}call(n,r){return ee(()=>Lwn(ct(n),this.padding,this.dataFormat))}getConfig(){let n={padding:this.padding,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(n,r),n}}return e.className="ZeroPadding2D",e})();fe.registerClass(jCe);N();N();function HZ(e,t,n,r,i,o){return ee(()=>{Mr(i),Dwe(o),Za(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Ja()),o==null&&(o="max"),e=A4(e,i);let s,a=r==="same"?"same":"valid";return o==="max"?s=pv(e,t,n,a):s=nv(e,t,n,a),i==="channelsFirst"&&(s=zt(s,[0,3,1,2])),s})}function smt(e,t,n,r,i,o){return ee(()=>{Mr(i),Dwe(o),Za(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Ja()),o==null&&(o="max"),e=aCe(e,i);let s,a=r==="same"?"same":"valid";return o==="max"?s=e8(e,t,n,a):s=m6(e,t,n,a),i==="channelsFirst"&&(s=zt(s,[0,4,1,2,3])),s})}var jZ=class extends xt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new K(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(mi(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new K(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);mi(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,Za(this.padding),this.inputSpec=[new nr({ndim:3})]}computeOutputShape(t){t=Ut(t);let n=Vl(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return ee(()=>{this.invokeCallHook(t,n),t=ay(ct(t),2);let r=this.poolingFunction(ct(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return nu(r,[2])})}getConfig(){let t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}},VCe=(()=>{class e extends jZ{constructor(n){super(n)}poolingFunction(n,r,i,o,s){return Mr(s),Za(o),HZ(n,r,i,o,s,"max")}}return e.className="MaxPooling1D",e})();fe.registerClass(VCe);var WCe=(()=>{class e extends jZ{constructor(n){super(n)}poolingFunction(n,r,i,o,s){return Mr(s),Za(o),HZ(n,r,i,o,s,"avg")}}return e.className="AveragePooling1D",e})();fe.registerClass(WCe);var VZ=class extends xt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new K(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];mi(this.poolSize,"poolSize"),mi(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Mr(this.dataFormat),Za(this.padding),this.inputSpec=[new nr({ndim:4})]}computeOutputShape(t){t=Ut(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Vl(n,this.poolSize[0],this.padding,this.strides[0]),r=Vl(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r]:[t[0],n,r,t[3]]}call(t,n){return ee(()=>(this.invokeCallHook(t,n),this.poolingFunction(ct(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}},GCe=(()=>{class e extends VZ{constructor(n){super(n)}poolingFunction(n,r,i,o,s){return Mr(s),Za(o),HZ(n,r,i,o,s,"max")}}return e.className="MaxPooling2D",e})();fe.registerClass(GCe);var qCe=(()=>{class e extends VZ{constructor(n){super(n)}poolingFunction(n,r,i,o,s){return Mr(s),Za(o),HZ(n,r,i,o,s,"avg")}}return e.className="AveragePooling2D",e})();fe.registerClass(qCe);var WZ=class extends xt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new K(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];mi(this.poolSize,"poolSize"),mi(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Mr(this.dataFormat),Za(this.padding),this.inputSpec=[new nr({ndim:5})]}computeOutputShape(t){t=Ut(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Vl(n,this.poolSize[0],this.padding,this.strides[0]),r=Vl(r,this.poolSize[1],this.padding,this.strides[1]),i=Vl(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r,i]:[t[0],n,r,i,t[4]]}call(t,n){return ee(()=>(this.invokeCallHook(t,n),this.poolingFunction(ct(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}},HCe=(()=>{class e extends WZ{constructor(n){super(n)}poolingFunction(n,r,i,o,s){return Mr(s),Za(o),smt(n,r,i,o,s,"max")}}return e.className="MaxPooling3D",e})();fe.registerClass(HCe);var YCe=(()=>{class e extends WZ{constructor(n){super(n)}poolingFunction(n,r,i,o,s){return Mr(s),Za(o),smt(n,r,i,o,s,"avg")}}return e.className="AveragePooling3D",e})();fe.registerClass(YCe);var GZ=class extends xt{constructor(t){super(t),this.inputSpec=[new nr({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new yt}},KCe=(()=>{class e extends GZ{constructor(n){super(n||{})}call(n,r){return ee(()=>{let i=ct(n);return sr(i,1)})}}return e.className="GlobalAveragePooling1D",e})();fe.registerClass(KCe);var XCe=(()=>{class e extends GZ{constructor(n){super(n||{})}call(n,r){return ee(()=>{let i=ct(n);return wo(i,1)})}}return e.className="GlobalMaxPooling1D",e})();fe.registerClass(XCe);var qZ=class extends xt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Mr(this.dataFormat),this.inputSpec=[new nr({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new yt}getConfig(){let t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}},ZCe=(()=>{class e extends qZ{call(n,r){return ee(()=>{let i=ct(n);return this.dataFormat==="channelsLast"?sr(i,[1,2]):sr(i,[2,3])})}}return e.className="GlobalAveragePooling2D",e})();fe.registerClass(ZCe);var QCe=(()=>{class e extends qZ{call(n,r){return ee(()=>{let i=ct(n);return this.dataFormat==="channelsLast"?wo(i,[1,2]):wo(i,[2,3])})}}return e.className="GlobalMaxPooling2D",e})();fe.registerClass(QCe);N();N();var YZ=class extends xt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){let t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,r={}){let i=n.layer,o=Xu(i,r);delete n.layer;let s={layer:o};return Object.assign(s,n),new t(s)}},JCe=(()=>{class e extends YZ{constructor(n){super(n),this.supportsMasking=!0}build(n){if(n=Ut(n),n.length<3)throw new K(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(n)}`);this.inputSpec=[{shape:n}];let r=[n[0]].concat(n.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),super.build(n)}computeOutputShape(n){n=Ut(n);let r=[n[0]].concat(n.slice(2)),i=this.layer.computeOutputShape(r),o=n[1];return[i[0],o].concat(i.slice(1))}call(n,r){return ee(()=>(n=ct(n),gCe((a,l)=>[ct(this.layer.call(a,r)),[]],n,[],!1,null,null,!1,!0)[1]))}}return e.className="TimeDistributed",e})();fe.registerClass(JCe);function Bwn(e){f0(apt,"BidirectionalMergeMode",e)}var zwn="concat",e_e=(()=>{class e extends YZ{constructor(n){super(n);let r=n.layer.getConfig(),i={};i.className=n.layer.getClassName(),i.config=r,this.forwardLayer=Xu(i),r.goBackwards=r.goBackwards!==!0;let o={};if(o.className=n.layer.getClassName(),o.config=r,this.backwardLayer=Xu(o),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=n.mergeMode===void 0?zwn:n.mergeMode,Bwn(this.mergeMode),n.weights)throw new yt("weights support is not implemented for Bidirectional layer yet.");this._stateful=n.layer.stateful,this.returnSequences=n.layer.returnSequences,this.returnState=n.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=n.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(n){this._trainable=n,this.forwardLayer!=null&&(this.forwardLayer.trainable=n),this.backwardLayer!=null&&(this.backwardLayer.trainable=n)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(n){let r=n.length,i=Math.floor(r/2);this.forwardLayer.setWeights(n.slice(0,i)),this.backwardLayer.setWeights(n.slice(i))}computeOutputShape(n){let r=this.forwardLayer.computeOutputShape(n);Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),r=r;let i,o,s;return this.returnState&&(s=r.slice(1)),i=r[0],i=i,this.mergeMode==="concat"?(i[i.length-1]*=2,o=[i]):this.mergeMode==null?o=[i,i.slice()]:o=[i],this.returnState?this.mergeMode==null?o.concat(s).concat(s.slice()):[i].concat(s).concat(s.slice()):$o(o)}apply(n,r){let i=r==null?null:r.initialState,o=r==null?null:r.constants;r==null&&(r={});let s=hCe(n,i,o,this.numConstants);if(n=s.inputs,i=s.initialState,o=s.constants,Array.isArray(n)&&(i=n.slice(1),n=n[0]),(i==null||i.length===0)&&o==null)return super.apply(n,r);let a=[],l=[];if(i!=null){let c=i.length;if(c%2>0)throw new K("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,a.push(...i);let f=i.map(d=>new nr({shape:d.shape}));this.forwardLayer.stateSpec=f.slice(0,c/2),this.backwardLayer.stateSpec=f.slice(c/2),l.push(...f)}if(o!=null)throw new yt("Support for constants in Bidirectional layers is not implemented yet.");let u=a[0]instanceof ca;for(let c of a)if(c instanceof ca!==u)throw new K("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){let c=[n].concat(a),f=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=f;let p=super.apply(c,r);return this.inputSpec=d,p}else return super.apply(n,r)}call(n,r){return ee(()=>{let i=r.initialState,o,s;if(i==null)o=this.forwardLayer.call(n,r),s=this.backwardLayer.call(n,r);else{let u=i.slice(0,i.length/2),c=i.slice(i.length/2);o=this.forwardLayer.call(n,Object.assign(r,{initialState:u})),s=this.backwardLayer.call(n,Object.assign(r,{initialState:c}))}let a;this.returnState&&(Array.isArray(o)&&(a=o.slice(1).concat(s.slice(1))),o=o[0],s=s[0]),this.returnSequences&&(s=ji(s,1));let l;return this.mergeMode==="concat"?l=CF([o,s]):this.mergeMode==="sum"?l=se(o,s):this.mergeMode==="ave"?l=j(.5,se(o,s)):this.mergeMode==="mul"?l=j(o,s):this.mergeMode==null&&(l=[o,s]),this.returnState?this.mergeMode==null?l.concat(a):[l].concat(a):l})}resetStates(n){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(n){cm(this.forwardLayer.name,()=>{this.forwardLayer.build(n)}),cm(this.backwardLayer.name,()=>{this.backwardLayer.build(n)}),this.built=!0}computeMask(n,r){Array.isArray(r)&&(r=r[0]);let i;if(this.returnSequences?this.mergeMode==null?i=[r,r]:i=r:this.mergeMode==null?i=[null,null]:i=null,this.returnState){let s=this.forwardLayer.states.map(a=>null);return Array.isArray(i)?i.concat(s).concat(s):[i].concat(s).concat(s)}else return i}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(n){super.setFastWeightInitDuringBuild(n),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(n),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(n)}getConfig(){let n={mergeMode:this.mergeMode},r=super.getConfig();return Object.assign(n,r),n}static fromConfig(n,r){let i=Xu(r.layer);if(delete r.layer,r.numConstants!=null)throw new yt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let o=r;return o.layer=i,new n(o)}}return e.className="Bidirectional",e})();fe.registerClass(e_e);N();var t_e=(()=>{class e extends xt{constructor(n){super(n),this.scale=n.scale,n.offset?this.offset=n.offset:this.offset=0}getConfig(){let n={scale:this.scale,offset:this.offset},r=super.getConfig();return Object.assign(n,r),n}call(n,r){return ee(()=>(n=ct(n),n.dtype!=="float32"&&(n=ua(n,"float32")),se(j(n,this.scale),this.offset)))}}return e.className="Rescaling",e})();fe.registerClass(t_e);N();var{resizeBilinear:Uwn,cropAndResize:jwn}=pl,n_e=(()=>{class e extends xt{constructor(n){super(n),this.height=n.height,this.width=n.width}centerCrop(n,r,i,o,s,a,l,u){return ee(()=>{let c,f=!1,d=r/a,p=i/l,m=(o+r)/a,h=(s+i)/l,g=[d,p,m,h],x=[];n.rank===3?(f=!0,c=Ri([n])):c=n;for(let _=0;_<c.shape[0];_++)x.push(g);let b=as(x,[x.length,4]),y=Rh(0,x.length,1,"int32"),C=jwn(c,b,y,[o,s],"nearest");return f?ua(ct(fs(C)),u):ua(C,u)})}upsize(n,r,i,o){return ee(()=>{let s=Uwn(n,[r,i]);return ua(s,o)})}call(n,r){return ee(()=>{let i=ct(n),o=i.dtype,s=i.shape,a=s[s.length-3],l=s[s.length-2],u=0;a!==this.height&&(u=Math.floor((a-this.height)/2));let c=0;return l!==this.width&&(c=Math.floor((l-this.width)/2),c===0&&(c=1)),u>=0&&c>=0?this.centerCrop(i,u,c,this.height,this.width,a,l,o):this.upsize(n,this.height,this.width,o)})}getConfig(){let n={height:this.height,width:this.width},r=super.getConfig();return Object.assign(n,r),n}computeOutputShape(n){n=Ut(n);let r=n.length-3,i=n.length-2;return n[r]=this.height,n[i]=this.width,n}}return e.className="CenterCrop",e})();fe.registerClass(n_e);N();N();N();N();function amt(e,t,n,r){let i=ct(e);if(i.dtype!=="int32"&&(i=ua(i,"int32")),t==="int")return i;let o=i.shape;if(i.rank===0&&(i=ri(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=ri(i,-1)),i.rank>2)throw new K(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${o} which would result in output rank ${i.rank}.`);let s=["multiHot","oneHot"].includes(t),a=i,l;if(typeof r<"u"&&t==="count"?l=cO(a,r,n,s):l=cO(a,[],n,s),t!=="tfIdf")return l;if(r)return j(l,r);throw new K("When outputMode is 'tfIdf', weights must be provided.")}var r_e=(()=>{class e extends xt{constructor(n){super(n),this.numTokens=n.numTokens,n.outputMode?this.outputMode=n.outputMode:this.outputMode="multiHot"}getConfig(){let n={numTokens:this.numTokens,outputMode:this.outputMode},r=super.getConfig();return Object.assign(n,r),n}computeOutputShape(n){return n=Ut(n),n==null?[this.numTokens]:this.outputMode==="oneHot"&&n[n.length-1]!==1?(n.push(this.numTokens),n):(n[n.length-1]=this.numTokens,n)}call(n,r){return ee(()=>{n=ct(n),n.dtype!=="int32"&&(n=ua(n,"int32"));let i;if(typeof r.countWeights<"u"){if(this.outputMode!=="count")throw new K(`countWeights is not used when outputMode !== count.
              Received countWeights=${r.countWeights}`);i=ct(r.countWeights)}let o=wo(n),s=Fx(n),a=Ur(this.numTokens,o).bufferSync().get(0),l=ba(s,0).bufferSync().get(0);if(!(a&&l))throw new K(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return amt(n,this.outputMode,this.numTokens,i)})}}return e.className="CategoryEncoding",e})();fe.registerClass(r_e);N();var Wwn=["bilinear","nearest"],lmt=new Set(Wwn),i_e=(()=>{class e extends xt{constructor(n){if(super(n),this.height=n.height,this.width=n.width,n.interpolation)if(lmt.has(n.interpolation))this.interpolation=n.interpolation;else throw new K(`Invalid interpolation parameter: ${n.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!n.cropToAspectRatio}computeOutputShape(n){n=Ut(n);let r=n[2];return[this.height,this.width,r]}getConfig(){let n={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},r=super.getConfig();return Object.assign(n,r),n}call(n,r){return ee(()=>{let i=[this.height,this.width];if(this.interpolation==="bilinear")return pl.resizeBilinear(n,i,!this.cropToAspectRatio);if(this.interpolation==="nearest")return pl.resizeNearestNeighbor(n,i,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...lmt]} are supported`)})}}return e.className="Resizing",e})();fe.registerClass(i_e);N();var umt=(()=>{class e{constructor(n){this.seed=n}next(){if(this.seed!==void 0)return this.seed++}}return e.className="RandomSeed",e})();var cmt=(()=>{class e extends xt{constructor(n){super(n),this.randomGenerator=new umt(n.seed)}getConfig(){let n={seed:this.randomGenerator.seed},r=super.getConfig();return Object.assign(n,r),n}}return e.className="BaseRandomLayer",e})();N();var Gwn=["bilinear","nearest"],fmt=new Set(Gwn),o_e=(()=>{class e extends cmt{constructor(n){super(n);let{factor:r,interpolation:i="bilinear"}=n;if(this.factor=r,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new K(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new K(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new K(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(i)if(fmt.has(i))this.interpolation=i;else throw new K(`Invalid interpolation parameter: ${i} is not implemented`)}getConfig(){let n={factor:this.factor,interpolation:this.interpolation},r=super.getConfig();return Object.assign(n,r),n}computeOutputShape(n){n=Ut(n);let r=n[2];return[this.imgHeight,-1,r]}call(n,r){return ee(()=>{let i=ct(n);this.imgHeight=i.shape[i.shape.length-3];let o=i.shape[i.shape.length-2];this.widthFactor=tu([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let s=this.widthFactor.dataSync()[0]*o;s=Math.round(s);let a=[this.imgHeight,s];switch(this.interpolation){case"bilinear":return pl.resizeBilinear(n,a);case"nearest":return pl.resizeNearestNeighbor(n,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...fmt]} are supported`)}})}}return e.className="RandomWidth",e})();fe.registerClass(o_e);function qwn(e){return new Kw(e)}function Hwn(e){return new iCe(e)}function Ywn(e){return new tCe(e)}function Kwn(e){return new nCe(e)}function Xwn(e){return new rCe(e)}function Zwn(e){return new sCe(e)}function Qwn(e){return new oCe(e)}function Jwn(e){return new fCe(e)}function eCn(e){return new MZ(e)}function tCn(e){return new lCe(e)}function nCn(e){return new $Z(e)}function rCn(e){return new uCe(e)}function iCn(e){return new cCe(e)}function oCn(e){return new dCe(e)}function sCn(e){return new pCe(e)}function aCn(e){return new mCe(e)}function lCn(e){return new SCe(e)}function uCn(e){return new CCe(e)}function cCn(e){return new UZ(e)}function fCn(e){return new wCe(e)}function dCn(e){return new _Ce(e)}function pCn(e){return new ECe(e)}function mCn(e){return new ACe(e)}function hCn(e){return new TCe(e)}function gCn(e){return new ICe(e)}function xCn(e){return new DCe(e)}function bCn(e){return new FCe(e)}function yCn(e){return new MCe(e)}function vCn(e){return new RCe(e)}function wCn(e){return new OCe(e)}function CCn(e){return new NCe(e)}function _Cn(e){return new $Ce(e)}function SCn(e){return new zCe(e)}function ECn(e){return new UCe(e)}function ACn(e){return new jCe(e)}function s_e(e){return new WCe(e)}function TCn(e){return s_e(e)}function kCn(e){return s_e(e)}function a_e(e){return new qCe(e)}function ICn(e){return a_e(e)}function DCn(e){return a_e(e)}function l_e(e){return new YCe(e)}function NCn(e){return l_e(e)}function FCn(e){return l_e(e)}function RCn(e){return new KCe(e)}function OCn(e){return new ZCe(e)}function dmt(e){return new XCe(e)}function pmt(e){return new QCe(e)}function mmt(e){return new VCe(e)}function hmt(e){return new GCe(e)}function MCn(e){return new HCe(e)}function $Cn(e){return new bCe(e)}function PCn(e){return new LZ(e)}function LCn(e){return new yCe(e)}function BCn(e){return new FF(e)}function zCn(e){return new xCe(e)}function UCn(e){return new PZ(e)}function jCn(e){return new vCe(e)}function VCn(e){return new zZ(e)}function WCn(e){return new p0(e)}function GCn(e){return new BZ(e)}function qCn(e){return new e_e(e)}function HCn(e){return new JCe(e)}var YCn=dmt,KCn=pmt,XCn=mmt,ZCn=hmt;function QCn(e){return new PCe(e)}function JCn(e){return new LCe(e)}function e_n(e){return new BCe(e)}function t_n(e){return new kCe(e)}function n_n(e){return new t_e(e)}function r_n(e){return new n_e(e)}function i_n(e){return new i_e(e)}function o_n(e){return new r_e(e)}function s_n(e){return new o_e(e)}N();var c_n=Z();c_n.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});N();N();var gmt;(function(e){let t;(function(n){n[n.LEGACY=0]="LEGACY",n[n.V1=1]="V1",n[n.V2=2]="V2"})(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(gmt||(gmt={}));N();N();N();N();N();N();N();N();N();ev();N();var lSn=tc(EO());N();var sSn=tc(EO());N();N();N();var _Li=Symbol("out"),SLi=Symbol("field"),ELi=Symbol("quote"),ALi=Symbol("quoteafterquote"),TLi=Symbol("quoteinquote");N();N();N();N();N();N();N();N();N();function be(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&A.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var ySn=Ko.whereImpl,bmt=(()=>{class e extends Sm{nextDataId(){return e.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Ry(this,uc())}write(n,r,i){this.firstUse&&(this.firstUse=!1,Z().get("IS_NODE")&&P.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let o={id:this.nextDataId()};return this.data.set(o,{values:n,dtype:i,refCount:1}),o}makeTensorInfo(n,r,i){let o;if(r==="string"&&i!=null&&i.length>0&&A.isString(i[0])){let s=i.map(a=>A.encodeString(a));o=this.write(s,n,r)}else o=this.write(i,n,r);return{dataId:o,shape:n,dtype:r}}refCount(n){return this.data.has(n)?this.data.get(n).refCount:0}incRef(n){let r=this.data.get(n);r.refCount++}decRef(n){if(this.data.has(n)){let r=this.data.get(n);r.refCount--}}move(n,r,i,o,s){this.data.set(n,{values:r,dtype:o,refCount:s})}numDataIds(){return this.data.numDataIds()}read(n){return te(this,null,function*(){return this.readSync(n)})}readSync(n){let{dtype:r,complexTensorInfos:i}=this.data.get(n);if(r==="complex64"){let o=this.readSync(i.real.dataId),s=this.readSync(i.imag.dataId);return P.mergeRealAndImagArrays(o,s)}return A.convertBackendValuesAndArrayBuffer(this.data.get(n).values,r)}bufferSync(n){let r=this.readSync(n.dataId);if(n.dtype==="string")try{let i=r.map(o=>A.decodeString(o));return et(n.shape,n.dtype,i)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return et(n.shape,n.dtype,r)}makeOutput(n,r,i){return uc().makeTensorFromTensorInfo(this.makeTensorInfo(r,i,n),this)}disposeData(n,r=!1){if(this.data.has(n)){if(this.data.get(n).refCount--,!r&&this.data.get(n).refCount>0)return!1;let{complexTensorInfos:i}=this.data.get(n);i!=null&&(this.disposeData(i.real.dataId,!0),this.disposeData(i.imag.dataId,!0)),this.data.delete(n)}return!0}disposeIntermediateTensorInfo(n){this.disposeData(n.dataId)}time(n){return te(this,null,function*(){let r=A.now();return n(),{kernelMs:A.now()-r}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(n){be([n],"where");let r=this.readSync(n.dataId);return ySn(n.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}return e.nextDataId=0,e})();var z_e={};rn(z_e,{addImpl:()=>d_e,bincountImpl:()=>MF,bincountReduceImpl:()=>XZ,bitwiseAndImpl:()=>p_e,castImpl:()=>f_e,ceilImpl:()=>m_e,concatImpl:()=>ZZ,equalImpl:()=>h_e,expImpl:()=>x_e,expm1Impl:()=>y_e,floorDivImpl:()=>w_e,floorImpl:()=>v_e,gatherNdImpl:()=>QZ,gatherV2Impl:()=>JZ,greaterEqualImpl:()=>__e,greaterImpl:()=>C_e,lessEqualImpl:()=>E_e,lessImpl:()=>S_e,linSpaceImpl:()=>eQ,logImpl:()=>A_e,maxImpl:()=>tQ,maximumImpl:()=>T_e,minimumImpl:()=>k_e,multiplyImpl:()=>D4,negImpl:()=>I_e,notEqualImpl:()=>D_e,prodImpl:()=>N_e,raggedGatherImpl:()=>nQ,raggedRangeImpl:()=>rQ,raggedTensorToTensorImpl:()=>iQ,rangeImpl:()=>oQ,rsqrtImpl:()=>R_e,scatterImpl:()=>hm,sigmoidImpl:()=>Kmt,simpleAbsImpl:()=>c_e,sliceImpl:()=>M_e,sparseFillEmptyRowsImpl:()=>sQ,sparseReshapeImpl:()=>aQ,sparseSegmentReductionImpl:()=>PF,sqrtImpl:()=>Qmt,squaredDifferenceImpl:()=>$_e,staticRegexReplaceImpl:()=>P_e,stridedSliceImpl:()=>lQ,stringNGramsImpl:()=>uQ,stringSplitImpl:()=>cQ,stringToHashBucketFastImpl:()=>fQ,subImpl:()=>B_e,tileImpl:()=>dQ,topKImpl:()=>pQ,transposeImpl:()=>$F,uniqueImpl:()=>mQ});N();function c_e(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var vSn=e=>{let{x:t}=e.inputs,n=e.backend;be(t,"abs");let r=new Float32Array(A.sizeFromShape(t.shape)),i=n.data.get(t.dataId).values;return r=c_e(i),n.makeOutput(r,t.shape,t.dtype)},ymt={kernelName:R0,backendName:"cpu",kernelFunc:vSn};N();N();function an(e){return(t,n,r,i,o)=>{let s=P.assertAndGetBroadcastShape(t,n),a=s.length,l=A.computeStrides(s),u=A.sizeFromShape(s),c=A.getTypedArrayFromDType(o,u),f=t.length,d=n.length,p=A.computeStrides(t),m=A.computeStrides(n),h=P.getBroadcastDims(t,s),g=P.getBroadcastDims(n,s);if(h.length+g.length===0)for(let x=0;x<c.length;++x)c[x]=e(r[x%r.length],i[x%i.length]);else for(let x=0;x<c.length;++x){let b=A.indexToLoc(x,a,l),y=b.slice(-f);h.forEach(S=>y[S]=0);let v=A.locToIndex(y,f,p),C=b.slice(-d);g.forEach(S=>C[S]=0);let _=A.locToIndex(C,d,m);c[x]=e(r[v],i[_])}return[c,s]}}N();N();N();N();function mo(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(i.shape,"float32",s)},a}var vmt={kernelName:kC,backendName:"cpu",kernelFunc:mo};function RF(e,t,n="float32"){if(n==="complex64"){let i=RF(e,t,"float32"),o=RF(e,t,"float32");return mo({inputs:{real:i,imag:o},backend:e})}let r=A.makeZerosTypedArray(A.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}N();function Ls(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var wmt={kernelName:Id,backendName:"cpu",kernelFunc:Ls};N();function xd(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}var Cmt={kernelName:s_,backendName:"cpu",kernelFunc:xd};function f_e(e,t,n,r){if(r==="int32"){let i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){let i=A.toTypedArray([0],n),[o,s]=an((a,l)=>a!==l?1:0)(t,[],e,i,"bool");return[s,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function bd(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:o}=r;if(o==="complex64"){if(i.dtype==="complex64")return Ls({inputs:{x:i},backend:n});let c=RF(n,i.shape,i.dtype),f=bd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),d=mo({inputs:{real:f,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),d}if(i.dtype==="complex64"){let c=xd({inputs:{input:i},backend:n}),f=bd({inputs:{x:c},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(c),f}if(!A.hasEncodingLoss(i.dtype,o)){let c=Ls({inputs:{x:i},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:o}}let s=n.data.get(i.dataId).values,[a,l,u]=f_e(s,i.shape,i.dtype,o);return n.makeTensorInfo(a,l,u)}var _mt={kernelName:kd,backendName:"cpu",kernelFunc:bd};function hn(e,t,n,r){return n==null?({inputs:i,backend:o})=>{let{a:s,b:a}=i,l=o;be([s,a],e);let u=l.data.get(s.dataId).values,c=l.data.get(a.dataId).values,f=s.dtype==="string"?P.fromUint8ToStringArray(u):u,d=s.dtype==="string"?P.fromUint8ToStringArray(c):c,p=r||s.dtype,[m,h]=t(s.shape,a.shape,f,d,p);return l.makeTensorInfo(h,p,m)}:({inputs:i,backend:o})=>{let{a:s,b:a}=i,l=o;if(s.dtype==="complex64"||a.dtype==="complex64"){let u=bd({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),f=c.complexTensorInfos.real,d=c.complexTensorInfos.imag,p=l.data.get(f.dataId).values,m=l.data.get(d.dataId).values,h=bd({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(h.dataId),x=g.complexTensorInfos.real,b=g.complexTensorInfos.imag,y=l.data.get(x.dataId).values,v=l.data.get(b.dataId).values,[C,_,S]=n(s.shape,a.shape,p,m,y,v),E=l.makeTensorInfo(S,"float32",C),T=l.makeTensorInfo(S,"float32",_),I=mo({inputs:{real:E,imag:T},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(h),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo(T),I}else{let u=l.data.get(s.dataId).values,c=l.data.get(a.dataId).values,f=r||s.dtype,[d,p]=t(s.shape,a.shape,u,c,f);return l.makeTensorInfo(p,f,d)}}}function OF(e){return(t,n,r,i,o,s)=>{let a=P.assertAndGetBroadcastShape(t,n),l=A.sizeFromShape(a),u=a.length,c=A.computeStrides(a),f=A.getTypedArrayFromDType("float32",l),d=A.getTypedArrayFromDType("float32",l),p=P.getBroadcastDims(t,a),m=P.getBroadcastDims(n,a),h=P.mergeRealAndImagArrays(r,i),g=P.mergeRealAndImagArrays(o,s),x=t.length,b=A.computeStrides(t),y=n.length,v=A.computeStrides(n);if(p.length+m.length===0)for(let C=0;C<f.length;C++){let _=C%h.length,S=C%g.length,E=e(h[_*2],h[_*2+1],g[S*2],g[S*2+1]);f[C]=E.real,d[C]=E.imag}else for(let C=0;C<f.length;C++){let _=A.indexToLoc(C,u,c),S=_.slice(-x);p.forEach(O=>S[O]=0);let E=A.locToIndex(S,x,b),T=_.slice(-y);m.forEach(O=>T[O]=0);let I=A.locToIndex(T,y,v),k=e(h[E*2],h[E*2+1],g[I*2],g[I*2+1]);f[C]=k.real,d[C]=k.imag}return[f,d,a]}}var d_e=an((e,t)=>e+t),wSn=OF((e,t,n,r)=>({real:e+n,imag:t+r})),m0=hn(mf,d_e,wSn),Smt={kernelName:mf,backendName:"cpu",kernelFunc:m0};N();function MF(e,t,n,r,i){let o=A.sizeFromShape(r),s=A.makeZerosTypedArray(i,n);for(let a=0;a<e.length;a++){let l=e[a];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(o>0?s[l]+=t[a]:s[l]+=1)}return s}function XZ(e,t,n,r=!1){let i=e.shape[0],o=e.shape[1],s=et([i,n],t.dtype);for(let a=0;a<i;a++)for(let l=0;l<o;l++){let u=e.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?s.set(1,a,u):t.size>0?s.set(s.get(a,u)+t.get(a,l),a,u):s.set(s.get(a,u)+1,a,u))}return s}N();var p_e=an((e,t)=>e&t),CSn=hn(My,p_e),Emt={kernelName:My,backendName:"cpu",kernelFunc:CSn};N();N();function Bo(e){return(t,n,r)=>{let i=A.getArrayFromDType(n,t.length);for(let o=0;o<t.length;++o)i[o]=e(t[o],r);return i}}N();function wt(e,t,n){let r=Bo(t);return Wl(e,r,n)}function Wl(e,t,n){return({inputs:r,attrs:i,backend:o})=>{let{x:s}=r;be(s,e);let a=o,l=a.data.get(s.dataId).values,u;if(s.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=P.fromUint8ToStringArray(l)}else u=l;let c=n||s.dtype,f=t(u,c,i);return a.makeTensorInfo(s.shape,c,f)}}var m_e=Bo(e=>Math.ceil(e)),_Sn=Wl(Om,m_e),Amt={kernelName:Om,backendName:"cpu",kernelFunc:_Sn};N();function ZZ(e,t,n,r){let i=A.getArrayFromDType(n,A.sizeFromShape(t));if(r&&n!=="string"){let o=0;e.forEach(s=>{let a=A.sizeFromShape(s.shape);i.set(s.vals,o),o+=a})}else{let o=0;e.forEach(s=>{let a=n==="string"?P.fromUint8ToStringArray(s.vals):s.vals,l=0;for(let u=0;u<s.shape[0];++u){let c=u*t[1]+o;for(let f=0;f<s.shape[1];++f)i[c+f]=a[l++]}o+=s.shape[1]})}return i}N();var h_e=an((e,t)=>e===t?1:0),g_e=hn($y,h_e,null,"bool"),Tmt={kernelName:$y,backendName:"cpu",kernelFunc:g_e};N();var x_e=Bo(e=>Math.exp(e)),b_e=Wl(Um,x_e,"float32"),kmt={kernelName:Um,backendName:"cpu",kernelFunc:b_e};N();var y_e=Bo(e=>Math.expm1(e)),SSn=Wl(jm,y_e),Imt={kernelName:jm,backendName:"cpu",kernelFunc:SSn};N();var v_e=Bo(e=>Math.floor(e)),ESn=Wl(Vm,v_e),Dmt={kernelName:Vm,backendName:"cpu",kernelFunc:ESn};N();var w_e=an((e,t)=>Math.floor(e/t)),ASn=hn(Wm,w_e,null,"int32"),Nmt={kernelName:Wm,backendName:"cpu",kernelFunc:ASn};N();function QZ(e,t,n,r,i,o,s,a,l){let u=et([r,o],n);for(let c=0;c<r;c++){let f=[],d=0;for(let p=0;p<i;p++){let m=e[c*i+p];d+=m*s[p],f.push(m)}if(d<0||d>=l/o)throw new Error(`Invalid indices: ${f} does not index into ${a}`);for(let p=0;p<o;p++)u.values[c*o+p]=t.get(...t.indexToLoc(d*o+p))}return u}N();function JZ(e,t,n){let r=et(n,e.dtype);for(let i=0;i<r.size;++i){let s=r.indexToLoc(i).slice(),a=s[0],l=s[2],u=t.locToIndex([a,l]);s[2]=t.values[u];let c=e.locToIndex(s);0<=c&&c<e.values.length&&(r.values[i]=e.values[c])}return r}N();var C_e=an((e,t)=>e>t?1:0),TSn=hn(Py,C_e,null,"bool"),Fmt={kernelName:Py,backendName:"cpu",kernelFunc:TSn};N();var __e=an((e,t)=>e>=t?1:0),kSn=hn(Gm,__e,null,"bool"),Rmt={kernelName:Gm,backendName:"cpu",kernelFunc:kSn};N();var S_e=an((e,t)=>e<t?1:0),ISn=hn(Ly,S_e,null,"bool"),Omt={kernelName:Ly,backendName:"cpu",kernelFunc:ISn};N();var E_e=an((e,t)=>e<=t?1:0),DSn=hn(By,E_e,null,"bool"),Mmt={kernelName:By,backendName:"cpu",kernelFunc:DSn};N();function eQ(e,t,n){let r=(t-e)/(n-1),i=A.makeZerosTypedArray(n,"float32");i[0]=e;for(let o=1;o<i.length;o++)i[o]=i[o-1]+r;return i}N();var A_e=Bo(e=>Math.log(e)),NSn=Wl(Km,A_e),$mt={kernelName:Km,backendName:"cpu",kernelFunc:NSn};N();function tQ(e,t,n,r){let i=A.getTypedArrayFromDType(r,A.sizeFromShape(n));for(let o=0;o<i.length;++o){let s=o*t,a=e[s];for(let l=0;l<t;++l){let u=e[s+l];(Number.isNaN(u)||u>a)&&(a=u)}i[o]=a}return i}N();var T_e=an((e,t)=>Math.max(e,t)),FSn=hn(Zm,T_e),Pmt={kernelName:Zm,backendName:"cpu",kernelFunc:FSn};N();var k_e=an((e,t)=>Math.min(e,t)),RSn=hn(Qm,k_e),Lmt={kernelName:Qm,backendName:"cpu",kernelFunc:RSn};N();var D4=an((e,t)=>e*t),OSn=OF((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),uA=hn(eh,D4,OSn),Bmt={kernelName:eh,backendName:"cpu",kernelFunc:uA};N();function I_e(e,t,n){let r=A.createScalarValue(-1,n);return D4([],t,r,e,n)}function MSn(e){let{inputs:t,backend:n}=e,{x:r}=t;be(r,"neg");let i=n.data.get(r.dataId).values,[o,s]=I_e(i,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,o)}var zmt={kernelName:sx,backendName:"cpu",kernelFunc:MSn};N();var D_e=an((e,t)=>e!==t?1:0),$Sn=hn(Vy,D_e,null,"bool"),Umt={kernelName:Vy,backendName:"cpu",kernelFunc:$Sn};N();N();N();function $F(e,t,n,r,i){let o=t.length,s=A.sizeFromShape(t),a=A.computeStrides(t),l=A.computeStrides(i),u=A.getTypedArrayFromDType(n,A.sizeFromShape(i));for(let c=0;c<s;++c){let f=A.indexToLoc(c,o,a),d=new Array(f.length);for(let m=0;m<d.length;m++)d[m]=f[r[m]];let p=A.locToIndex(d,o,l);u[p]=e[c]}return u}function Kr(e){let{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:o}=n;be(i,"transpose");let s=i.shape.length,a=new Array(s);for(let f=0;f<a.length;f++)a[f]=i.shape[o[f]];let l=r.data.get(i.dataId).values,u=$F(l,i.shape,i.dtype,o,a);return{dataId:r.write(u,a,i.dtype),shape:a,dtype:i.dtype}}var jmt={kernelName:Nd,backendName:"cpu",kernelFunc:Kr};function N_e(e,t,n,r){let[i,o]=P.computeOutAndReduceShapes(e,r),s=yi(t,"int32"),a=A.makeZerosTypedArray(A.sizeFromShape(i),s),l=A.sizeFromShape(o);for(let u=0;u<a.length;++u){let c=u*l,f=1;for(let d=0;d<l;++d)f*=n[c+d];a[u]=f}return{outVals:a,outShape:i,outDtype:s}}function PSn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;be(i,"prod");let a=i.shape.length,l=A.parseAxisParam(o,i.shape),u=P.getAxesPermutation(l,a),c=l,f=i,d=[];u!=null&&(f=Kr({inputs:{x:i},backend:n,attrs:{perm:u}}),d.push(f),c=P.getInnerMostAxes(c.length,a));let p=n.data.get(f.dataId).values,{outVals:m,outShape:h,outDtype:g}=N_e(f.shape,f.dtype,p,c),x=h;return s&&(x=P.expandShapeToKeepDim(h,l)),d.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(x,g,m)}var Vmt={kernelName:dx,backendName:"cpu",kernelFunc:PSn};N();function LSn(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){let o=A.indexToLoc(i,t.length,A.computeStrides(t)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function BSn(e,t){for(let n=0;n<e.length;++n){let r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function zSn(e,t,n,r){let i=[],o=0,s=t.length-1+n.length,a=new Array(s).fill(null).map(()=>[0]);BSn(n,r);let l=1;for(let u=0;u<t.length-1;++u){l*=t[u];let c=t[u+1];for(let f=1;f<l+1;++f)a[u].push(f*c)}for(let u=0;u<e.length;++u){let c=e[u],f=e[u]+1;for(let d=0;d<n.length;++d){let p=n[d],m=d+t.length-1;if(m>=0){let h=a[m],g=h[h.length-1]-p[c];for(let x=c;x<f;++x)a[m].push(p[x+1]+g)}c=p[c],f=p[f]}f!==c&&(i.push([c,f]),o+=f-c)}return{outSplits:a,valueSlices:i,numValues:o}}function USn(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,i=A.getArrayFromDType("int32",r);t.push(i),e[n].forEach((o,s)=>i[s]=o)}return t}function Wmt(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function jSn(e,t,n,r,i,o){let s=Wmt(t,2)[1],a=Wmt(o,2)[1],l=0;for(let u of n)for(let c=u[0];c<u[1];++c){for(let f=0;f<r;++f)i[l*a+f]=e[c*s+f];++l}}function VSn(e,t,n,r,i){let o=t.slice();o[0]=i;let s=A.getArrayFromDType(n,A.sizeFromShape(o)),a=e.length,l=a===0?0:a/t[0];return jSn(e,t,r,l,s,o),[s,o]}function nQ(e,t,n,r,i,o,s,a){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");let l=t[0][0]-1;if(LSn(o,s,l),r.length===0)throw new Error("params.rank must be nonzero");let u=r[0],{outSplits:c,valueSlices:f,numValues:d}=zSn(o,s,e,u),p=USn(c),m=VSn(n,r,i,f,d);return[p,m[0],m[1]]}N();var Gmt=2147483647;function rQ(e,t,n,r,i,o,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");let a=t.length===0,l=i.length===0,u=s.length===0,c=[];a||c.push(t[0]),l||c.push(i[0]),u||c.push(s[0]);for(let g=1;g<c.length;++g)if(c[g]!==c[g-1])throw new Error("starts, limits, and deltas must have the same shape");let f=c.length===0?1:c[0],d=A.getArrayFromDType("int32",f+1);d[0]=0;for(let g=0;g<f;++g){let x=a?e[0]:e[g],b=l?r[0]:r[g],y=u?o[0]:o[g];if(y===0)throw new Error("Requires delta != 0");let v;if(y>0&&b<x||y<0&&b>x)v=0;else if(v=Math.ceil(Math.abs((b-x)/y)),v>Gmt)throw new Error(`Requires ((limit - start) / delta) <= ${Gmt}`);d[g+1]=d[g]+v}let p=d[f],m=A.getArrayFromDType(n,p),h=0;for(let g=0;g<f;++g){let x=d[g+1]-d[g],b=a?e[0]:e[g],y=u?o[0]:o[g];for(let v=0;v<x;++v)m[h++]=b,b+=y}return[d,m]}N();var yd=P.RowPartitionType,F_e=class e{constructor(t,n,r,i,o,s,a,l,u,c){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=o,this.defaultValue=s,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=P.getRowPartitionTypesHelper(c),this.raggedRank=P.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===yd.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===yd.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){let n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case yd.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case yd.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${yd[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){let n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){let o=t[i+1]-t[i];o>r&&(r=o)}return r}static getMaxWidthValueRowID(t){let n=t.length;if(n===0)return 0;let r=0,i=t[0],o=0;for(let s=1;s<n;++s){let a=t[s];a!==i&&(i=a,o=Math.max(s-r,o),r=s)}return Math.max(n-r,o)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Hmt(t,r)}calculateOutputSize(t){let n=this.valuesShape,r=this.defaultValueShape;P.validateDefaultValueShape(r,n);let i=this.tensorShapeFromTensor(this.shape,this.shapeShape),s=P.combineRaggedTensorToTensorShapes(this.raggedRank,i,n);s[0]<0&&(s[0]=t);for(let a=1;a<=this.raggedRank;++a)s[a]<0&&(s[a]=this.getMaxWidth(a));return s}calculateFirstParentOutputIndex(t,n,r){let i=Math.min(t,r),o=[],s=0;for(let a=0;a<i;++a,s+=n)o.push(s);for(let a=i;a<t;++a)o.push(-1);return A.assert(o.length===t,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(t,n,r,i){let o=t.length,s=[];for(let a=0;a<o-1;++a){let l=t[a+1]-t[a],u=Math.min(i,l),c=n[a];c===-1&&(u=0);for(let f=0;f<u;++f)s.push(c),c+=r;for(let f=0;f<l-u;++f)s.push(-1)}if(o>0&&s.length!==t[o-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(t,n,r,i){let o=t.length,s=[];if(o===0)return[];let a=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];s.push(u);for(let c=1;c<o;++c){let f=t[c];if(f===l)u>=0&&(++a,a<i?u+=r:u=-1);else{if(a=0,l=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);u=n[f]}s.push(u)}if(s.length!==t.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(t,n,r,i){let o=this.getRowPartitionTensor(t),s=this.getRowPartitionTypeByDimension(t);switch(s){case yd.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,i);case yd.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,i);default:throw new Error(`Unsupported partition type: ${yd[s]}`)}}getFirstDimensionSize(){let t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let n=this.rowPartitionTypes[0];switch(n){case yd.FIRST_DIM_SIZE:return t[0];case yd.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case yd.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${yd[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];let o=Hmt(r,!1),s=A.getArrayFromDType(this.valuesDType,A.sizeFromShape(o));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,i[u],r[u]);this.setOutput(this.raggedRank,l,s,o)}return[o,s]}setOutput(t,n,r,i){if(r.length===0)return;let o=this.values,s=r,a=i.slice();a=a.slice(t+1);let l=A.sizeFromShape(a),u=n.length,c=this.defaultValue;if(c.length!==l&&c.length!==1){let m=this.defaultValueShape;ee(()=>{let h=V(c,m);c=Eh(h,a).dataSync()})}let f=0,d=0,p=0;for(let m=0;m<=u;++m){let h=m<u?n[m]:-1;if(h===p){++p;continue}if(d<p){let g=o.subarray(f*l),x=s.subarray(d*l),b=(p-d)*l;qmt(x,g,b)}if(m>=u){let g=r.length;h=Math.floor(g/l)}if(h>p)if(this.defaultValue.length===1)s.subarray(p*l,h*l).fill(this.defaultValue[0]),p=h;else for(;h>p;){let g=s.slice(p*l);qmt(g,c,l),++p}h<0?(f=m+1,d=p):(f=m,d=p,p=d+1)}}};function qmt(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function Hmt(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function iQ(e,t,n,r,i,o,s,a,l,u){return new F_e(e,t,n,r,i,o,s,a,l,u).compute()}N();function oQ(e,t,n,r){let i=e===t,o=e<t&&n<0,s=t<e&&n>1;if(i||o||s)return A.makeZerosTypedArray(0,r);let a=Math.abs(Math.ceil((t-e)/n)),l=A.makeZerosTypedArray(a,r);t<e&&n===1&&(n=-1),l[0]=e;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}N();var R_e=Bo(e=>1/Math.sqrt(e)),WSn=Wl(sh,R_e),Ymt={kernelName:sh,backendName:"cpu",kernelFunc:WSn};N();function hm(e,t,n,r,i,o,s,a,l,u){let c=[r/i,i],f=e.values,d=t.values;if(r===0)return et(n,t.dtype);let p=l instanceof gn?l:et(c,t.dtype);typeof l=="string"||typeof l=="number"?p.values.fill(l):typeof l=="boolean"&&p.values.fill(+l);for(let m=0;m<o;m++){let h=[],g=0;for(let x=0;x<s;x++){let b=f[m*s+x];h.push(b),g+=b*a[x]}if(g<0||g>=r/i)throw new Error(`Invalid indices: ${h} does not index into ${n}`);for(let x=0;x<i;x++)u?p.values[g*i+x]+=d[m*i+x]:p.values[g*i+x]=t.rank===0?d[0]:d[m*i+x]}return p}N();var Kmt=Bo(e=>1/(1+Math.exp(-e))),O_e=wt(fh,e=>1/(1+Math.exp(-e))),Xmt={kernelName:fh,backendName:"cpu",kernelFunc:O_e};N();function M_e(e,t,n,r,i){let o=so.isSliceContinous(r,t,n),s=A.sizeFromShape(n),a=A.computeStrides(r);if(o){let f=so.computeFlatOffset(t,a);return i==="string"?e.slice(f,f+s):e.subarray(f,f+s)}let l=i==="string"?P.fromUint8ToStringArray(e):e,u=et(r,i,l),c=et(n,i);for(let f=0;f<c.size;++f){let d=c.indexToLoc(f),p=d.map((m,h)=>m+t[h]);c.set(u.get(...p),...d)}return i==="string"?P.fromStringArrayToUint8(c.values):c.values}function vd(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,size:s}=r;be(i,"slice");let[a,l]=so.parseSliceParams(i,o,s);so.assertParamsValid(i,a,l);let u=n.data.get(i.dataId).values,c=M_e(u,a,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,c)}var Zmt={kernelName:bx,backendName:"cpu",kernelFunc:vd};N();function sQ(e,t,n,r,i,o,s){let a=t[0],l=o[0],u=new Array(l),c=new Array(a),f=t[1];if(l===0){if(a!==0)throw new Error(P.getSparseFillEmptyRowsIndicesDenseShapeMismatch(a));let g=A.getArrayFromDType(n,0),x=A.getArrayFromDType(i,0);return[g,[0,f],x,u,c]}let d=!0,p=0,m=new Array(l).fill(0);for(let g=0;g<a;++g){let x=e[g*f];if(x<0)throw new Error(P.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,x));if(x>=l)throw new Error(P.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,x,l));++m[x],d=d&&x>=p,p=x}let h=!0;for(let g=0;g<l;++g){let x=m[g]===0;u[g]=x,h=h&&!x,m[g]=Math.max(m[g],1),g>0&&(m[g]+=m[g-1])}if(h&&d){let g=e,x=r;for(let b=0;b<a;++b)c[b]=b;return[g,[a,f],x,u,c]}else{let g=m[l-1],x=A.getArrayFromDType(n,g*f),b=A.getArrayFromDType(i,g),y=new Array(l).fill(0);for(let v=0;v<a;++v){let C=e[v*f],_=y[C],S=(C===0?0:m[C-1])+_;y[C]++;for(let E=0;E<f;++E)x[S*f+E]=e[v*f+E];b[S]=r[v],c[v]=S}for(let v=0;v<l;++v)if(y[v]===0){let _=v===0?0:m[v-1];x[_*f+0]=v;for(let S=1;S<f;++S)x[_*f+S]=0;b[_]=s}return[x,[g,f],b,u,c]}}N();function aQ(e,t,n,r,i){let o=A.sizeFromShape(r),s=t[0],a=i.length,l=[],u=1,c=-1;for(let g=0;g<a;++g){let x=i[g];if(x===-1){if(c!==-1)throw new Error(P.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(c,g));c=g,l.push(1)}else{if(x<0)throw new Error(P.getSparseReshapeNegativeOutputDimErrorMessage(g,x));u*=x,l.push(x)}}if(c!==-1){if(u<=0)throw new Error(P.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let g=Math.trunc(o/u);if(u*g!==o)throw new Error(P.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[c]=g}if(A.sizeFromShape(l)!==o)throw new Error(P.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let d=r.length,p=[];if(d>0){p[d-1]=1;for(let g=d-2;g>=0;--g)p[g]=p[g+1]*r[g+1]}let m=[];if(a>0){m[a-1]=1;for(let g=a-2;g>=0;--g)m[g]=m[g+1]*l[g+1]}let h=A.getArrayFromDType(n,s*a);for(let g=0;g<s;++g){let x=0;for(let b=0;b<d;++b)x+=e[g*d+b]*p[b];for(let b=0;b<a;++b)h[g*a+b]=Math.trunc(x/m[b]),x%=m[b]}return[h,[s,a],l]}N();function PF(e,t,n,r,i,o=!1,s=0){let a=r.length,l=[t[0],e.length/t[0]],u=l[1],f=a>0?i[a-1]+1:0;if(f<0)throw new Error(P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=t.slice();d[0]=f;let p=d.reduce((y,v)=>y*v,1),m=A.getArrayFromDType(n,p);if(a===0)return f>0&&m.fill(s),[m,d];if(f<=0)throw new Error(P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let h=0,g=1,x=0,b=i[h];for(;;){let y=0;if(g<a){if(y=i[g],b===y){++g;continue}if(b>=y)throw new Error(P.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(b<0||b>=f)throw new Error(P.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(b,f));b>x&&m.fill(s,x*u,b*u);for(let v=h;v<g;++v){let C=r[v];if(C<0||C>=l[0])throw new Error(P.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v,r[v],l[0]));for(let _=0;_<u;_++)m[b*u+_]+=e[C*u+_]}if(o)for(let v=0;v<u;v++)m[b*u+v]/=g-h;if(h=g,++g,x=b+1,b=y,g>a)break}return x<f&&m.fill(s,x*u,f*u),[m,d]}N();var Qmt=Bo(e=>Math.sqrt(e)),GSn=wt(ph,e=>Math.sqrt(e)),Jmt={kernelName:ph,backendName:"cpu",kernelFunc:GSn};N();var $_e=an((e,t)=>{let n=e-t;return n*n}),qSn=hn(mh,$_e),eht={kernelName:mh,backendName:"cpu",kernelFunc:qSn};N();var P_e=Bo((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),HSn=Wl(Wy,P_e),tht={kernelName:Wy,backendName:"cpu",kernelFunc:HSn};N();function lQ(e,t,n,r){let i=et(e,t.dtype);for(let o=0;o<i.size;o++){let s=i.indexToLoc(o),a=new Array(s.length);for(let l=0;l<a.length;l++)a[l]=s[l]*n[l]+r[l];i.set(t.get(...a),...s)}return i}N();var L_e=class{constructor(t,n,r,i,o,s){this.separator=A.encodeString(t),this.nGramWidths=n,this.leftPad=A.encodeString(r),this.rightPad=A.encodeString(i),this.padWidth=o,this.preserveShort=s}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){let r=this.getPadWidth(n);return Math.max(0,t+2*r-n+1)}createNGrams(t,n,r,i,o,s){for(let a=0;a<o;++a){let l=this.getPadWidth(s),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),f=s-(u+c),d=n+(u>0?0:a-l),p=0;p+=u*this.leftPad.length;for(let b=0;b<f;++b)p+=t[d+b].length;p+=c*this.rightPad.length;let m=u+c+f-1;p+=m*this.separator.length,r[i+a]=new Uint8Array(p);let h=r[i+a],g=0,x=b=>b.forEach(y=>h[g++]=y);for(let b=0;b<u;++b)x(this.leftPad),x(this.separator);for(let b=0;b<f-1;++b)x(t[d+b]),x(this.separator);if(f>0){x(t[d+f-1]);for(let b=0;b<c;++b)x(this.separator),x(this.rightPad)}else{for(let b=0;b<c-1;++b)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(t,n){let r=t.length,i=n.length;if(i>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<i;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}let o=i-1,s=A.getArrayFromDType("int32",i);if(r===0||i===0){let l=new Array(r);for(let u=0;u<=o;++u)s[u]=0;return[l,s]}s[0]=0;for(let l=1;l<=o;++l){let u=n[l]-n[l-1],c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&c===0&&(c=1),s[l]=s[l-1]+c}let a=new Array(s[o]);for(let l=0;l<o;++l){let u=n[l],c=s[l];if(this.nGramWidths.forEach(f=>{let d=n[l+1]-n[l],p=this.getNumNGrams(d,f);this.createNGrams(t,u,a,c,p,f),c+=p}),this.preserveShort&&c===s[l]){let f=n[l+1]-n[l];if(f===0)continue;let d=f+2*this.padWidth;this.createNGrams(t,u,a,c,1,d)}}return[a,s]}};function uQ(e,t,n,r,i,o,s,a){return new L_e(n,r,i,o,s,a).compute(e,t)}N();function YSn(e,t,n,r){if(!e.length)return;if(t.length===0){for(let o=0;o<e.length;++o)r.push(e.subarray(o,o+1));return}if(t.length===1){let o=t[0],s=e.indexOf(o);for(;s!==-1;){let a=e.subarray(0,s);(!n||a.length!==0)&&r.push(a),e=e.subarray(s+1),s=e.indexOf(o)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let o=0;o<e.length+1;o++)if(o===e.length||t.indexOf(e[o])!==-1){let s=e.subarray(i,o);(!n||s.length!==0)&&r.push(s),i=o+1}}function cQ(e,t,n){let r=e.length,i=[],o=0,s=0,a=new Array(r);for(let d=0;d<r;++d){let p=i.length;YSn(e[d],t,n,i);let m=i.length-p;a[d]=m,o+=m,s=Math.max(s,m)}let l=A.getArrayFromDType("int32",o*2),u=new Array(o),c=[r,s],f=0;for(let d=0;d<r;++d)for(let p=0;p<a[d];++p)l[f*2]=d,l[f*2+1]=p,u[f]=i[f],++f;return[l,u,c]}N();function fQ(e,t){let n=A.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=A.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}N();var B_e=an((e,t)=>e-t),KSn=OF((e,t,n,r)=>({real:e-n,imag:t-r})),N4=hn(hh,B_e,KSn),nht={kernelName:hh,backendName:"cpu",kernelFunc:N4};N();function dQ(e,t){let n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];let r=et(n,e.dtype);for(let i=0;i<r.values.length;++i){let o=r.indexToLoc(i),s=new Array(e.rank);for(let l=0;l<s.length;l++)s[l]=o[l]%e.shape[l];let a=e.locToIndex(s);r.values[i]=e.values[a]}return r}N();var F4=(e,t)=>{let n=t.value-e.value;return n===0?e.index-t.index:n};function rht(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let a=r-n+1,l=t-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(t-l*c/a+f)),p=Math.min(r,Math.floor(t+(a-l)*c/a+f));rht(e,t,d,p)}let i=e[t],o=n,s=r;for(A.swap(e,n,t),F4(e[r],i)>0&&A.swap(e,n,r);o<s;){for(A.swap(e,o,s),o++,s--;F4(e[o],i)<0;)o=o+1;for(;F4(e[s],i)>0;)s=s-1}F4(e[n],i)===0?A.swap(e,n,s):(s=s+1,A.swap(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function pQ(e,t,n,r,i){let o=t[t.length-1],[s,a]=[e.length/o,o],l=A.getTypedArrayFromDType(n,s*r),u=A.getTypedArrayFromDType("int32",s*r);for(let f=0;f<s;f++){let d=f*a,p=e.subarray(d,d+a),m=new Array(p.length);p.forEach((b,y)=>m[y]={value:b,index:y}),r<m.length&&(rht(m,r),m=m.slice(0,r)),i&&m.sort(F4);let h=f*r,g=l.subarray(h,h+r),x=u.subarray(h,h+r);for(let b=0;b<r;b++)g[b]=m[b].value,x[b]=m[b].index}let c=t.slice();return c[c.length-1]=r,[et(c,n,l),et(c,"int32",u)]}N();function mQ(e,t,n,r){let i=A.parseAxisParam(t,n)[0],o=[1,n[0],1];for(let m=0;m<i;m++)o[0]*=n[m];o[1]=n[i];for(let m=i+1;m<n.length;m++)o[2]*=n[m];let s=new Map,a=new Int32Array(n[i]),l=new gn(o,r,e),u=[],c=o[0]===1&&o[2]===1;for(let m=0;m<n[i];m++){let h;if(c)h=e[m].toString();else{let x=[];for(let b=0;b<o[0];b++)for(let y=0;y<o[2];y++)x.push(l.get(b,m,y));h=x.join(",")}let g=s.get(h);if(g!=null)a[m]=g;else{let x=s.size;s.set(h,x),a[m]=x,u.push(m)}}let f=o.slice();f[1]=s.size;let d=new gn(f,r);u.forEach((m,h)=>{for(let g=0;g<o[0];g++)for(let x=0;x<o[2];x++)d.set(l.get(g,m,x),g,h,x)});let p=n.slice();return p[i]=f[1],{outputValues:d.values,outputShape:p,indices:a}}iO("cpu",()=>new bmt,1);N();N();N();var U_e=wt(Bm,e=>e>=0?e:Math.exp(e)-1),iht={kernelName:Bm,backendName:"cpu",kernelFunc:U_e};N();function j_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:o}=r;be([i],"leakyRelu");let s=A.sizeFromShape(i.shape),a=n.data.get(i.dataId).values,l=A.getTypedArrayFromDType("float32",s);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return n.makeTensorInfo(i.shape,"float32",l)}var oht={kernelName:Q0,backendName:"cpu",kernelFunc:j_e};N();var XSn=an((e,t)=>e<0?t*e:e);function V_e(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t;be([r,i],"prelu");let o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,[a,l]=XSn(r.shape,i.shape,o,s,"float32");return n.makeTensorInfo(l,"float32",a)}var sht={kernelName:fx,backendName:"cpu",kernelFunc:V_e};N();var W_e=wt(rh,e=>Math.max(0,e)),aht={kernelName:rh,backendName:"cpu",kernelFunc:W_e};N();var G_e=wt(ih,e=>Math.min(Math.max(0,e),6)),lht={kernelName:ih,backendName:"cpu",kernelFunc:G_e};function cA(e,t,n,r,i){if(n==="linear")return Ls({inputs:{x:t},backend:e});if(n==="relu")return W_e({inputs:{x:t},backend:e});if(n==="elu")return U_e({inputs:{x:t},backend:e});if(n==="relu6")return G_e({inputs:{x:t},backend:e});if(n==="prelu")return V_e({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return j_e({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return O_e({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}N();N();function ln(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:o}=r,s=A.sizeFromShape(i.shape),a=A.inferFromImplicitShape(o,s),l=A.sizeFromShape(a);A.assert(s===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);let u=n.data.get(i.dataId);if(u.complexTensorInfos!=null){let c=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;c.shape=a,f.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}var uht={kernelName:px,backendName:"cpu",kernelFunc:ln};function q_e(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:o}=t,{transposeA:s,transposeB:a}=r;be([i,o],"matMul");let l=i.shape.length,u=o.shape.length,c=s?i.shape[l-2]:i.shape[l-1],f=a?o.shape[u-1]:o.shape[u-2],d=s?i.shape[l-1]:i.shape[l-2],p=a?o.shape[u-2]:o.shape[u-1],m=i.shape.slice(0,-2),h=o.shape.slice(0,-2),g=A.sizeFromShape(m),x=A.sizeFromShape(h),y=fl.assertAndGetBroadcastShape(i.shape.slice(0,-2),o.shape.slice(0,-2)).concat([d,p]);A.assert(c===f,()=>`Error in matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${i.shape} and ${o.shape} and transposeA=${s} and transposeB=${a} must match.`);let v=s?[g,c,d]:[g,d,c],C=a?[x,p,f]:[x,f,p],_=ln({inputs:{x:i},backend:n,attrs:{shape:v}}),S=ln({inputs:{x:o},backend:n,attrs:{shape:C}}),E=s?_.shape[1]:_.shape[2],T=s?_.shape[2]:_.shape[1],I=a?S.shape[1]:S.shape[2],k=Math.max(g,x),O=n.data.get(_.dataId).values,F=n.data.get(S.dataId).values,B=A.computeStrides(_.shape),M=A.computeStrides(S.shape),[z,W,H]=s?[B[0],1,B[1]]:[B[0],B[1],1],[Q,re,oe]=a?[1,M[1],M[0]]:[M[1],1,M[0]],me=T*I,ge=et([k,T,I],_.dtype),ye=ge.values,ve=n.blockSize;for(let Ne=0;Ne<k;Ne++){let Ge=Ne%g,nt=Ne%x;for(let Y=0;Y<T;Y+=ve){let ie=Math.min(Y+ve,T);for(let ue=0;ue<I;ue+=ve){let U=Math.min(ue+ve,I);for(let Ue=0;Ue<E;Ue+=ve){let ke=Math.min(Ue+ve,E);for(let Xe=Y;Xe<ie;Xe++)for(let Ye=ue;Ye<U;Ye++){let Pt=0;for(let yn=Ue;yn<ke;yn++){let nf=O[Ge*z+Xe*W+yn*H],Ni=F[yn*Q+Ye*re+nt*oe];Pt+=nf*Ni}ye[Ne*me+(Xe*I+Ye)]+=Pt}}}}}return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(S),n.makeTensorInfo(y,ge.dtype,ge.values)}var cht={kernelName:B0,backendName:"cpu",kernelFunc:q_e};function ZSn(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:o,bias:s,preluActivationWeights:a}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r,d,p,m,h=[];d=q_e({inputs:{a:i,b:o},attrs:{transposeA:l,transposeB:u},backend:n}),s&&(p=m0({inputs:{a:d,b:s},backend:n}),h.push(d),d=p),c&&(m=cA(n,d,c,a,f),h.push(d),d=m);for(let x of h)n.disposeIntermediateTensorInfo(x);return d}var fht={kernelName:Gy,backendName:"cpu",kernelFunc:ZSn};N();var QSn=wt(Tm,e=>Math.acos(e)),dht={kernelName:Tm,backendName:"cpu",kernelFunc:QSn};N();var JSn=wt(km,e=>Math.acosh(e)),pht={kernelName:km,backendName:"cpu",kernelFunc:JSn};N();function eEn(e){let{inputs:t,backend:n}=e,r=t;be(t,"addN");let i=r.map(a=>n.data.get(a.dataId).values),o=et(r[0].shape,r[0].dtype),s=o.values;for(let a=0;a<r.length;a++){let l=i[a];for(let u=0;u<s.length;u++)s[u]+=l[u]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}var mht={kernelName:O0,backendName:"cpu",kernelFunc:eEn};N();function tEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;be(i,"all");let a=A.parseAxisParam(o,i.shape),l=a,u=P.getAxesPermutation(l,i.shape.length),c=i;u!=null&&(c=Kr({inputs:{x:i},backend:n,attrs:{perm:u}}),l=P.getInnerMostAxes(l.length,i.shape.length)),P.assertAxesAreInnerMostDims("all",l,c.shape.length);let[f,d]=P.computeOutAndReduceShapes(c.shape,l),p=A.sizeFromShape(d),m=A.makeZerosTypedArray(A.sizeFromShape(f),c.dtype),h=n.data.get(c.dataId).values;for(let x=0;x<m.length;++x){let b=x*p,y=h[b];for(let v=0;v<p;++v){let C=h[b+v];y=y&&C}m[x]=y}u!=null&&n.disposeIntermediateTensorInfo(c);let g=n.makeTensorInfo(f,c.dtype,m);if(s){let x=P.expandShapeToKeepDim(f,a),b=ln({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),b}return g}var hht={kernelName:CC,backendName:"cpu",kernelFunc:tEn};N();function nEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;be(i,"any");let a=A.parseAxisParam(o,i.shape),l=a,u=P.getAxesPermutation(l,i.shape.length),c=i;u!=null&&(c=Kr({inputs:{x:i},backend:n,attrs:{perm:u}}),l=P.getInnerMostAxes(l.length,i.shape.length)),P.assertAxesAreInnerMostDims("any",l,c.shape.length);let[f,d]=P.computeOutAndReduceShapes(c.shape,l),p=A.sizeFromShape(d),m=A.makeZerosTypedArray(A.sizeFromShape(f),c.dtype),h=n.data.get(c.dataId).values;for(let x=0;x<m.length;++x){let b=x*p,y=h[b];for(let v=0;v<p;++v){let C=h[b+v];y=y||C}m[x]=y}u!=null&&n.disposeIntermediateTensorInfo(c);let g=n.makeTensorInfo(f,c.dtype,m);if(s){let x=P.expandShapeToKeepDim(f,a),b=ln({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),b}return g}var ght={kernelName:_C,backendName:"cpu",kernelFunc:nEn};N();function rEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;be(i,"argMax");let s=A.parseAxisParam(o,i.shape),a=P.getAxesPermutation(s,i.shape.length),l=i,u=[];a!=null&&(l=Kr({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=P.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],P.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[c,f]=P.computeOutAndReduceShapes(l.shape,s),d=A.sizeFromShape(c),p=A.makeZerosTypedArray(d,"int32"),m=A.sizeFromShape(f),h=n.data.get(l.dataId).values;for(let g=0;g<p.length;++g){let x=g*m,b=h[x],y=0;for(let v=0;v<m;++v){let C=h[x+v];C>b&&(b=C,y=v)}p[g]=y}return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",p)}var xht={kernelName:M0,backendName:"cpu",kernelFunc:rEn};N();function iEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;be(i,"argMin");let s=A.parseAxisParam(o,i.shape),a=P.getAxesPermutation(s,i.shape.length),l=i,u=[];a!=null&&(l=Kr({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=P.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],P.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[c,f]=P.computeOutAndReduceShapes(l.shape,s),d=A.sizeFromShape(c),p=A.makeZerosTypedArray(d,"int32"),m=A.sizeFromShape(f),h=n.data.get(l.dataId).values;for(let g=0;g<p.length;++g){let x=g*m,b=h[x],y=0;for(let v=0;v<m;++v){let C=h[x+v];C<b&&(b=C,y=v)}p[g]=y}return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",p)}var bht={kernelName:$0,backendName:"cpu",kernelFunc:iEn};N();var oEn=wt(Im,e=>Math.asin(e)),yht={kernelName:Im,backendName:"cpu",kernelFunc:oEn};N();var sEn=wt(Dm,e=>Math.asinh(e)),vht={kernelName:Dm,backendName:"cpu",kernelFunc:sEn};N();var aEn=wt(Nm,e=>Math.atan(e)),wht={kernelName:Nm,backendName:"cpu",kernelFunc:aEn};N();var lEn=an((e,t)=>Math.atan2(e,t)),uEn=hn(Rm,lEn),Cht={kernelName:Rm,backendName:"cpu",kernelFunc:uEn};N();var cEn=wt(Fm,e=>Math.atanh(e)),_ht={kernelName:Fm,backendName:"cpu",kernelFunc:cEn};N();N();function LF(e,t,n,r,i,o){let s=i.strideHeight,a=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,p=i.padInfo.left,m=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,h=et(i.outShape,n),g=h.values,x=i.outShape[1]*i.outShape[2]*i.outShape[3],b=i.outShape[2]*i.outShape[3],y=i.outShape[3];for(let v=0;v<i.batchSize;++v){let C=v*x,_=v*r[0];for(let S=0;S<i.inChannels;++S)for(let E=0;E<i.outHeight;++E){let T=E*s-d,I=Math.max(0,T),k=Math.min(i.inHeight,c+T),O=C+E*b;for(let F=0;F<i.outWidth;++F){let B=F*a-p,M=Math.max(0,B),z=Math.min(i.inWidth,f+B),W=m,H=0,Q=0;for(let oe=I;oe<k;oe+=l){let me=_+oe*r[1];for(let ge=M;ge<z;ge+=u){let ye=me+ge*r[2],ve=e[ye+S];o==="max"&&ve>W?W=ve:o==="avg"&&(H+=ve,Q++)}if(isNaN(W))break}let re=O+F*y+S;g[re]=o==="avg"?H/Q:W}}}return h}function hQ(e,t,n,r,i=!1,o=!1){let s=et(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,h=et(t,n,e);for(let g=0;g<r.batchSize;++g)for(let x=0;x<r.inChannels;++x)for(let b=0;b<r.outHeight;++b){let y=b*a-p,v=y;for(;v<0;)v+=u;let C=Math.min(r.inHeight,f+y);for(let _=0;_<r.outWidth;++_){let S=_*l-m,E=S;for(;E<0;)E+=c;let T=Math.min(r.inWidth,d+S),I=Number.NEGATIVE_INFINITY,k=-1;for(let O=v;O<C;O+=u){let F=O-y;for(let B=E;B<T;B+=c){let M=B-S,z=h.get(g,O,B,x);z>I&&(I=z,i?k=o?((g*r.inHeight+O)*r.inWidth+B)*r.inChannels+x:(O*r.inWidth+B)*r.inChannels+x:k=F*d+M)}}s.set(k,g,b,_,x)}}return s}function gQ(e,t,n,r,i,o){let s=i.strideDepth,a=i.strideHeight,l=i.strideWidth,u=i.dilationDepth,c=i.dilationHeight,f=i.dilationWidth,d=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,h=i.padInfo.front,g=i.padInfo.top,x=i.padInfo.left,b=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=et(i.outShape,n),v=y.values,C=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],_=i.outShape[2]*i.outShape[3]*i.outShape[4],S=i.outShape[3]*i.outShape[4],E=i.outShape[4];for(let T=0;T<i.batchSize;++T){let I=T*C,k=T*r[0];for(let O=0;O<i.inChannels;++O)for(let F=0;F<i.outDepth;++F){let B=F*s-h,M=B;for(;M<0;)M+=u;let z=Math.min(i.inDepth,d+B),W=I+F*_;for(let H=0;H<i.outHeight;++H){let Q=H*a-g,re=Q;for(;re<0;)re+=c;let oe=Math.min(i.inHeight,p+Q),me=W+H*S;for(let ge=0;ge<i.outWidth;++ge){let ye=ge*l-x,ve=ye;for(;ve<0;)ve+=f;let Ne=Math.min(i.inWidth,m+ye),Ge=me+ge*E,nt=b,Y=0,ie=0;for(let U=M;U<z;U+=u){let Ue=k+U*r[1];for(let ke=re;ke<oe;ke+=c){let Xe=Ue+ke*r[2];for(let Ye=ve;Ye<Ne;Ye+=f){let Pt=Xe+Ye*r[3],yn=e[Pt+O];if(o==="max"&&yn>nt?nt=yn:o==="avg"&&(Y+=yn,ie++),isNaN(nt))break}if(isNaN(nt))break}if(isNaN(nt))break}let ue=Ge+O;v[ue]=o==="avg"?Y/Math.max(ie,1):nt}}}}return y}function Sht(e,t){let n=et(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,a=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,m=t.padInfo.left;for(let h=0;h<t.batchSize;++h)for(let g=0;g<t.inChannels;++g)for(let x=0;x<t.outDepth;++x){let b=x*r-d,y=b;for(;y<0;)y+=s;let v=Math.min(t.inDepth,u+b);for(let C=0;C<t.outHeight;++C){let _=C*i-p,S=_;for(;S<0;)S+=a;let E=Math.min(t.inHeight,c+_);for(let T=0;T<t.outWidth;++T){let I=T*o-m,k=I;for(;k<0;)k+=l;let O=Math.min(t.inWidth,f+I),F=Number.NEGATIVE_INFINITY,B=-1;for(let M=y;M<v;M+=s){let z=M-b;for(let W=S;W<E;W+=a){let H=W-_;for(let Q=k;Q<O;Q+=l){let re=Q-I,oe=e.get(h,M,W,Q,g);oe>=F&&(F=oe,B=z*c*f+H*c+re)}}}n.set(B,h,x,C,T,g)}}}return n}function fEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;be(i,"avgPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;A.assert(P.eitherStridesOrDilationsAreOne(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=P.computePool2DInfo(i.shape,o,s,u,a,l),f;if(c.filterWidth===1&&c.filterHeight===1&&A.arraysEqual(c.inShape,c.outShape))f=Ls({inputs:{x:i},backend:n});else{let d=n.data.get(i.dataId).values,p=A.computeStrides(i.shape),m=LF(d,i.shape,i.dtype,p,c,"avg");f=n.makeTensorInfo(c.outShape,i.dtype,m.values)}return f}var Eht={kernelName:P0,backendName:"cpu",kernelFunc:fEn};N();function dEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r;be(i,"avgPool3d");let c=P.computePool3DInfo(i.shape,o,s,1,a,l,u),f=n.data.get(i.dataId).values,d=gQ(f,i.shape,i.dtype,A.computeStrides(i.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}var Aht={kernelName:L0,backendName:"cpu",kernelFunc:dEn};N();function pEn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,{filterSize:s,strides:a,pad:l,dimRoundingMode:u}=r;be([i,o],"avgPool3DGrad");let c=P.computePool3DInfo(o.shape,s,a,1,l,u),f=c.strideDepth,d=c.strideHeight,p=c.strideWidth,m=c.filterDepth,h=c.filterHeight,g=c.filterWidth,x=c.dilationDepth,b=c.dilationHeight,y=c.dilationWidth,v=c.effectiveFilterDepth,C=c.effectiveFilterHeight,_=c.effectiveFilterWidth,S=v-1-c.padInfo.front,E=_-1-c.padInfo.left,T=C-1-c.padInfo.top,I=et(o.shape,"float32"),k=1/(m*h*g),O=n.bufferSync(i);for(let F=0;F<c.batchSize;++F)for(let B=0;B<c.inChannels;++B)for(let M=0;M<c.inDepth;++M)for(let z=0;z<c.inHeight;++z)for(let W=0;W<c.inWidth;++W){let H=M-S,Q=z-T,re=W-E,oe=0;for(let me=0;me<v;me+=x){let ge=(H+me)/f;if(!(ge<0||ge>=c.outDepth||Math.floor(ge)!==ge))for(let ye=0;ye<C;ye+=b){let ve=(Q+ye)/d;if(!(ve<0||ve>=c.outHeight||Math.floor(ve)!==ve))for(let Ne=0;Ne<_;Ne+=y){let Ge=(re+Ne)/p;if(Ge<0||Ge>=c.outWidth||Math.floor(Ge)!==Ge)continue;let nt=O.get(F,ge,ve,Ge,B);oe+=nt}}}I.set(oe*k,F,M,z,W,B)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}var Tht={kernelName:EC,backendName:"cpu",kernelFunc:pEn};N();function mEn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,s=o;be([i,o],"avgPoolGrad");let{filterSize:a,strides:l,pad:u}=r,c=P.computePool2DInfo(s.shape,a,l,1,u),f=c.strideHeight,d=c.strideWidth,p=c.filterHeight,m=c.filterWidth,h=c.dilationHeight,g=c.dilationWidth,x=c.effectiveFilterHeight,b=c.effectiveFilterWidth,y=b-1-c.padInfo.left,v=x-1-c.padInfo.top,C=et(s.shape,"float32"),_=1/(p*m),S=n.data.get(i.dataId).values,E=et(i.shape,"float32",S);for(let T=0;T<c.batchSize;++T)for(let I=0;I<c.inChannels;++I)for(let k=0;k<c.inHeight;++k)for(let O=0;O<c.inWidth;++O){let F=k-v,B=O-y,M=0;for(let z=0;z<x;z+=h){let W=(F+z)/f;if(!(W<0||W>=c.outHeight||Math.floor(W)!==W))for(let H=0;H<b;H+=g){let Q=(B+H)/d;if(Q<0||Q>=c.outWidth||Math.floor(Q)!==Q)continue;let re=E.get(T,W,Q,I);M+=re}}C.set(M*_,T,k,O,I)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}var kht={kernelName:SC,backendName:"cpu",kernelFunc:mEn};N();function hEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,scale:o,offset:s,mean:a,variance:l}=t;A.assert(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A.assert(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),be([i,a,l,o,s],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);let c=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,p=o?n.data.get(o.dataId).values:new Float32Array([1]),m=s?n.data.get(s.dataId).values:new Float32Array([0]),h=new Float32Array(c.length),g=m.length,x=p.length,b=d.length,y=f.length,v=0,C=0,_=0,S=0;for(let E=0;E<c.length;++E)h[E]=m[v++]+(c[E]-f[C++])*p[_++]/Math.sqrt(d[S++]+u),v>=g&&(v=0),C>=y&&(C=0),_>=x&&(_=0),S>=b&&(S=0);return n.makeTensorInfo(i.shape,i.dtype,h)}var Iht={kernelName:X0,backendName:"cpu",kernelFunc:hEn};N();function gEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,crops:s}=r;be([i],"batchToSpaceND");let a=o.reduce((x,b)=>x*b),l=P.getReshaped(i.shape,o,a),u=P.getPermuted(l.length,o.length),c=P.getReshapedPermuted(i.shape,o,a),f=P.getSliceBeginCoords(s,o.length),d=P.getSliceSize(c,s,o.length),p=ln({inputs:{x:i},backend:n,attrs:{shape:l}}),m=Kr({inputs:{x:p},backend:n,attrs:{perm:u}}),h=ln({inputs:{x:m},backend:n,attrs:{shape:c}}),g=vd({inputs:{x:h},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),g}var Dht={kernelName:z0,backendName:"cpu",kernelFunc:gEn};N();function xEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:s}=r,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,u=MF(a,l,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,u)}var Nht={kernelName:AC,backendName:"cpu",kernelFunc:xEn};N();function bEn(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,a=P.assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}var Fht={kernelName:TC,backendName:"cpu",kernelFunc:bEn};N();var yEn=wt(Mm,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Rht={kernelName:Mm,backendName:"cpu",kernelFunc:yEn};N();var vEn=e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(A.sizeFromShape(t.shape)),i=n.data.get(t.dataId),o=i.complexTensorInfos.real,s=i.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<a.length;u++){let c=a[u],f=l[u];r[u]=Math.hypot(c,f)}return n.makeOutput(r,t.shape,"float32")},Oht={kernelName:U0,backendName:"cpu",kernelFunc:vEn};N();N();function h0(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}var Mht={kernelName:qC,backendName:"cpu",kernelFunc:h0};function Qw(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,o=A.parseAxisParam(i,t[0].shape)[0],s=t.map(h=>h.shape);P.assertParamsConsistent(s,o);let a=P.computeOutShape(t.map(h=>h.shape),o);if(A.sizeFromShape(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);let l=t.filter(h=>A.sizeFromShape(h.shape)>0);if(l.length===1)return Ls({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){let h=l.map(v=>xd({inputs:{input:v},backend:n})),g=l.map(v=>h0({inputs:{input:v},backend:n})),x=Qw({inputs:h,backend:n,attrs:{axis:o}}),b=Qw({inputs:g,backend:n,attrs:{axis:o}}),y=mo({inputs:{real:x,imag:b},backend:n});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),g.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),y}let u=l.map(h=>{let x=[-1,A.sizeFromShape(h.shape.slice(o))];return ln({inputs:{x:h},backend:n,attrs:{shape:x}})}),c=u.map(h=>({vals:n.data.get(h.dataId).values,shape:h.shape}));a=P.computeOutShape(u.map(h=>h.shape),1);let f=u[0].shape[0]===1,d=ZZ(c,a,t[0].dtype,f),p=P.computeOutShape(l.map(h=>h.shape),o),m=n.makeTensorInfo(p,t[0].dtype,d);return u.forEach(h=>n.disposeIntermediateTensorInfo(h)),m}var $ht={kernelName:j0,backendName:"cpu",kernelFunc:Qw};N();function H_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;be([i,o],"conv2d");let f=P.convertConv2DDataFormat(l),d=P.computeConv2DInfo(i.shape,o.shape,s,u,a,c,!1,f),p=d.filterHeight,m=d.filterWidth,h=d.dilationHeight,g=d.dilationWidth,x=d.padInfo.left,b=d.padInfo.top,y=d.dataFormat==="channelsLast",v=new gn(d.outShape,i.dtype),C=A.computeStrides(i.shape),_=A.computeStrides(o.shape),S=C[0],E=y?C[1]:C[2],T=y?C[2]:1,I=y?1:C[1],k=v.strides[0],O=y?v.strides[1]:v.strides[2],F=y?v.strides[2]:1,B=y?1:v.strides[1],M=n.data.get(i.dataId).values,z=n.data.get(o.dataId).values,W=v.values;for(let H=0;H<d.batchSize;++H){let Q=H*S,re=H*k;for(let oe=0;oe<d.outHeight;++oe){let me=re+oe*O,ge=oe*d.strideHeight-b;for(let ye=0;ye<p;++ye){let ve=ge+ye*h;if(ve<0||ve>=d.inHeight)continue;let Ne=ye*_[0],Ge=Q+ve*E;for(let nt=0;nt<d.outWidth;++nt){let Y=me+nt*F,ie=nt*d.strideWidth-x;for(let ue=0;ue<m;++ue){let U=ie+ue*g;if(U<0||U>=d.inWidth)continue;let Ue=Ne+ue*_[1],ke=Ge+U*T,Xe=Ue;for(let Ye=0;Ye<d.inChannels;++Ye){let Pt=M[ke+Ye*I];for(let yn=0;yn<d.outChannels;++yn)W[Y+yn*B]+=Pt*z[Xe+yn];Xe+=d.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,W)}var Pht={kernelName:V0,backendName:"cpu",kernelFunc:H_e};N();function wEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:s,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;be([i,o],"conv2dBackpropFilter");let f=P.convertConv2DDataFormat(l),d=P.computeConv2DInfo(i.shape,c,s,1,a,u,!1,f),{strideHeight:p,strideWidth:m,filterHeight:h,filterWidth:g}=d,x=d.dataFormat==="channelsLast",b=new gn(d.filterShape,"float32"),y=d.padInfo.left,v=d.padInfo.top,C=n.data.get(i.dataId).values,_=n.data.get(o.dataId).values,S=new gn(i.shape,i.dtype,C),E=new gn(o.shape,o.dtype,_);for(let T=0;T<h;++T){let I=Math.max(0,Math.ceil((v-T)/p)),k=Math.min(d.outHeight,(d.inHeight+v-T)/p);for(let O=0;O<g;++O){let F=Math.max(0,Math.ceil((y-O)/m)),B=Math.min(d.outWidth,(d.inWidth+y-O)/m);for(let M=0;M<d.inChannels;++M)for(let z=0;z<d.outChannels;++z){let W=0;for(let H=0;H<d.batchSize;++H)for(let Q=I;Q<k;++Q){let re=T+Q*p-v;for(let oe=F;oe<B;++oe){let me=O+oe*m-y;x?W+=S.get(H,re,me,M)*E.get(H,Q,oe,z):W+=S.get(H,M,re,me)*E.get(H,z,Q,oe)}}b.set(W,T,O,M,z)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var Lht={kernelName:IC,backendName:"cpu",kernelFunc:wEn};N();function CEn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{inputShape:s,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;be([i,o],"conv2dBackpropInput");let f=A.computeStrides(o.shape),d=A.computeStrides(i.shape),p=P.convertConv2DDataFormat(u),m=P.computeConv2DInfo(s,o.shape,a,1,l,c,!1,p),h=new gn(m.inShape,"float32"),g=h.values,x=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,[y,v,C]=f,{batchSize:_,filterHeight:S,filterWidth:E,inChannels:T,inHeight:I,inWidth:k,outChannels:O,outHeight:F,outWidth:B,strideHeight:M,strideWidth:z}=m;p=m.dataFormat;let W=S-1-m.padInfo.top,H=E-1-m.padInfo.left,Q=p==="channelsLast",re=h.strides[0],oe=Q?h.strides[1]:h.strides[2],me=Q?h.strides[2]:1,ge=Q?1:h.strides[1],ye=d[0],ve=Q?d[1]:d[2],Ne=Q?d[2]:1,Ge=Q?1:d[1];for(let nt=0;nt<_;++nt)for(let Y=0;Y<T;++Y)for(let ie=0;ie<I;++ie){let ue=ie-W,U=Math.max(0,Math.ceil(ue/M)),Ue=Math.min(F,(S+ue)/M);for(let ke=0;ke<k;++ke){let Xe=ke-H,Ye=Math.max(0,Math.ceil(Xe/z)),Pt=Math.min(B,(E+Xe)/z),yn=0;for(let Ni=U;Ni<Ue;++Ni){let vm=Ni*M-ue;for(let nl=Ye;nl<Pt;++nl){let rf=nl*z-Xe,da=ye*nt+ve*Ni+Ne*nl,y0=y*(S-1-vm)+v*(E-1-rf)+C*Y;for(let _y=0;_y<O;++_y){let Sy=x[da+Ge*_y],Ey=b[y0+_y];yn+=Sy*Ey}}}let nf=re*nt+oe*ie+me*ke+ge*Y;g[nf]=yn}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}var Bht={kernelName:W0,backendName:"cpu",kernelFunc:CEn};N();function _En(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:l}=r;be([i,o],"conv3d");let u=P.computeConv3DInfo(i.shape,o.shape,s,l,a),{filterDepth:c,filterHeight:f,filterWidth:d,dilationDepth:p,dilationHeight:m,dilationWidth:h,padInfo:g}=u,x=g.front,b=g.left,y=g.top,v=new gn(u.outShape,i.dtype),C=n.data.get(i.dataId).values,_=n.data.get(o.dataId).values,S=v.values,E=A.computeStrides(i.shape),T=A.computeStrides(o.shape);for(let I=0;I<u.batchSize;++I){let k=I*E[0],O=I*v.strides[0];for(let F=0;F<u.outDepth;++F){let B=O+F*v.strides[1],M=F*u.strideDepth-x;for(let z=0;z<c;++z){let W=M+z*p;if(W<0||W>=u.inDepth)continue;let H=z*T[0],Q=k+W*E[1];for(let re=0;re<u.outHeight;++re){let oe=B+re*v.strides[2],me=re*u.strideHeight-y;for(let ge=0;ge<f;++ge){let ye=me+ge*m;if(ye<0||ye>=u.inHeight)continue;let ve=H+ge*T[1],Ne=Q+ye*E[2];for(let Ge=0;Ge<u.outWidth;++Ge){let nt=oe+Ge*u.outChannels,Y=Ge*u.strideWidth-b;for(let ie=0;ie<d;++ie){let ue=Y+ie*h;if(ue<0||ue>=u.inWidth)continue;let U=ve+ie*T[2],Ue=Ne+ue*u.inChannels,ke=U;for(let Xe=0;Xe<u.inChannels;++Xe){let Ye=C[Ue+Xe];for(let Pt=0;Pt<u.outChannels;++Pt)S[nt+Pt]+=Ye*_[ke+Pt];ke+=u.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}var zht={kernelName:G0,backendName:"cpu",kernelFunc:_En};N();function SEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:s,pad:a,filterShape:l}=r;be([i,o],"conv3dBackpropFilterV2");let u=A.computeStrides(i.shape),c=A.computeStrides(o.shape),f=P.computeConv3DInfo(i.shape,l,s,1,a),d=f.strideDepth,p=f.strideHeight,m=f.strideWidth,h=f.filterDepth,g=f.filterHeight,x=f.filterWidth,b=new gn(f.filterShape,"float32"),y=b.values,[v,C,_,S]=b.strides,E=n.data.get(o.dataId).values,[T,I,k,O]=c,F=n.data.get(i.dataId).values,[B,M,z,W]=u,H=f.padInfo.front,Q=f.padInfo.left,re=f.padInfo.top;for(let oe=0;oe<h;++oe){let me=Math.max(0,Math.ceil((H-oe)/d)),ge=Math.min(f.outDepth,(f.inDepth+H-oe)/d),ye=oe*v;for(let ve=0;ve<g;++ve){let Ne=Math.max(0,Math.ceil((re-ve)/p)),Ge=Math.min(f.outHeight,(f.inHeight+re-ve)/p),nt=ve*C+ye;for(let Y=0;Y<x;++Y){let ie=Math.max(0,Math.ceil((Q-Y)/m)),ue=Math.min(f.outWidth,(f.inWidth+Q-Y)/m),U=Y*_+nt;for(let Ue=0;Ue<f.inChannels;++Ue){let ke=Ue*S+U;for(let Xe=0;Xe<f.outChannels;++Xe){let Ye=0;for(let Pt=0;Pt<f.batchSize;++Pt){let yn=Pt*B,nf=Pt*T;for(let Ni=me;Ni<ge;++Ni){let nl=(oe+Ni*d-H)*M+yn,rf=Ni*I+nf;for(let da=Ne;da<Ge;++da){let _y=(ve+da*p-re)*z+nl,Sy=da*k+rf;for(let Ey=ie;Ey<ue;++Ey){let wee=(Y+Ey*m-Q)*W+_y,Cee=Ey*O+Sy;Ye+=F[wee+Ue]*E[Cee+Xe]}}}}y[ke+Xe]=Ye}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var Uht={kernelName:DC,backendName:"cpu",kernelFunc:SEn};N();function EEn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{pad:s,strides:a,inputShape:l}=r;be([i],"conv3dBackpropInputV2");let u=A.computeStrides(i.shape),c=A.computeStrides(o.shape),f=P.computeConv3DInfo(l,o.shape,a,1,s),d=new gn(f.inShape,"float32"),p=d.values,[m,h,g,x]=d.strides,b=n.data.get(i.dataId).values,[y,v,C,_]=u,S=n.data.get(o.dataId).values,[E,T,I,k]=c,{batchSize:O,filterDepth:F,filterHeight:B,filterWidth:M,inChannels:z,inDepth:W,inHeight:H,inWidth:Q,outChannels:re,outDepth:oe,outHeight:me,outWidth:ge,strideDepth:ye,strideHeight:ve,strideWidth:Ne}=f,Ge=F-1-f.padInfo.front,nt=B-1-f.padInfo.top,Y=M-1-f.padInfo.left;for(let ie=0;ie<O;++ie)for(let ue=0;ue<z;++ue)for(let U=0;U<W;++U){let Ue=U-Ge,ke=Math.max(0,Math.ceil(Ue/ye)),Xe=Math.min(oe,(F+Ue)/ye);for(let Ye=0;Ye<H;++Ye){let Pt=Ye-nt,yn=Math.max(0,Math.ceil(Pt/ve)),nf=Math.min(me,(B+Pt)/ve);for(let Ni=0;Ni<Q;++Ni){let vm=Ni-Y,nl=Math.max(0,Math.ceil(vm/Ne)),rf=Math.min(ge,(M+vm)/Ne),da=0;for(let y0=ke;y0<Xe;++y0){let _y=y0*ye-Ue;for(let Sy=yn;Sy<nf;++Sy){let Ey=Sy*ve-Pt;for(let uR=nl;uR<rf;++uR){let wee=uR*Ne-vm,Cee=y*ie+v*y0+C*Sy+_*uR,SCt=E*(F-1-_y)+T*(B-1-Ey)+I*(M-1-wee)+k*ue;for(let a5=0;a5<re;++a5){let ECt=b[Cee+a5],ACt=S[SCt+a5];da+=ECt*ACt}}}}p[m*ie+h*U+g*Ye+x*Ni+ue]=da}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}var jht={kernelName:NC,backendName:"cpu",kernelFunc:EEn};N();var AEn=wt($m,e=>Math.cos(e)),Vht={kernelName:$m,backendName:"cpu",kernelFunc:AEn};N();var TEn=wt(Pm,e=>Math.cosh(e)),Wht={kernelName:Pm,backendName:"cpu",kernelFunc:TEn};N();function kEn(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:o,boxInd:s}=t,{cropSize:a,method:l,extrapolationValue:u}=r,[c,f,d,p]=i.shape,m=o.shape[0],[h,g]=a,x=et([m,h,g,p],"float32"),b=n.data.get(o.dataId).values,y=n.data.get(s.dataId).values,v=n.data.get(i.dataId).values,C=A.computeStrides(i.shape),_=A.computeStrides(x.shape);for(let S=0;S<m;S++){let E=S*4,T=b[E],I=b[E+1],k=b[E+2],O=b[E+3],F=y[S];if(F>=c)continue;let B=h>1?(k-T)*(f-1)/(h-1):0,M=g>1?(O-I)*(d-1)/(g-1):0;for(let z=0;z<h;z++){let W=h>1?T*(f-1)+z*B:.5*(T+k)*(f-1);if(W<0||W>f-1){for(let H=0;H<g;H++)for(let Q=0;Q<p;Q++){let re=Q+H*_[2]+z*_[1]+S*_[0];x.values[re]=u}continue}if(l==="bilinear"){let H=Math.floor(W),Q=Math.ceil(W),re=W-H;for(let oe=0;oe<g;oe++){let me=g>1?I*(d-1)+oe*M:.5*(I+O)*(d-1);if(me<0||me>d-1){for(let Ne=0;Ne<p;Ne++){let Ge=Ne+oe*_[2]+z*_[1]+S*_[0];x.values[Ge]=u}continue}let ge=Math.floor(me),ye=Math.ceil(me),ve=me-ge;for(let Ne=0;Ne<p;Ne++){let Ge=Ne+ge*C[2]+H*C[1]+F*C[0],nt=v[Ge];Ge=Ne+ye*C[2]+H*C[1]+F*C[0];let Y=v[Ge];Ge=Ne+ge*C[2]+Q*C[1]+F*C[0];let ie=v[Ge];Ge=Ne+ye*C[2]+Q*C[1]+F*C[0];let ue=v[Ge],U=nt+(Y-nt)*ve,Ue=ie+(ue-ie)*ve;Ge=Ne+oe*_[2]+z*_[1]+S*_[0],x.values[Ge]=U+(Ue-U)*re}}}else for(let H=0;H<g;++H){let Q=g>1?I*(d-1)+H*M:.5*(I+O)*(d-1);if(Q<0||Q>d-1){for(let me=0;me<p;me++){let ge=me+H*_[2]+z*_[1]+S*_[0];x.values[ge]=u}continue}let re=Math.round(Q),oe=Math.round(W);for(let me=0;me<p;me++){let ge=me+re*C[2]+oe*C[1]+F*C[0],ye=me+H*_[2]+z*_[1]+S*_[0];x.values[ye]=v[ge]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}var Ght={kernelName:RC,backendName:"cpu",kernelFunc:kEn};N();function IEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:s,reverse:a}=r;be(i,"cumprod");let l=P.getAxesPermutation([o],i.shape.length),u=i;l!=null&&(u=Kr({inputs:{x:i},backend:n,attrs:{perm:l}}));let c=P.getInnerMostAxes(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);let f=yi(u.dtype,"int32"),d=A.makeOnesTypedArray(A.sizeFromShape(u.shape),f),p=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],h=a?(x,b)=>x+m-b-1:(x,b)=>x+b;for(let x=0;x<p.length;x+=m)for(let b=0;b<m;b++){let y=h(x,b);if(b===0)d[y]=s?1:p[y];else{let v=h(x,b-1);d[y]=s?p[v]*d[v]:p[y]*d[v]}}let g=n.makeTensorInfo(u.shape,f,d);if(l!=null){let x=P.getUndoAxesPermutation(l),b=Kr({inputs:{x:g},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),b}return g}var qht={kernelName:FC,backendName:"cpu",kernelFunc:IEn};N();function DEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:s,reverse:a}=r;be(i,"cumsum");let l=P.getAxesPermutation([o],i.shape.length),u=i;l!=null&&(u=Kr({inputs:{x:i},backend:n,attrs:{perm:l}}));let c=P.getInnerMostAxes(1,i.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);let f=yi(u.dtype,"int32"),d=A.makeZerosTypedArray(A.sizeFromShape(u.shape),f),p=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],h=a?(x,b)=>x+m-b-1:(x,b)=>x+b;for(let x=0;x<p.length;x+=m)for(let b=0;b<m;b++){let y=h(x,b);if(b===0)d[y]=s?0:p[y];else{let v=h(x,b-1);d[y]=s?p[v]+d[v]:p[y]+d[v]}}let g=n.makeTensorInfo(u.shape,f,d);if(l!=null){let x=P.getUndoAxesPermutation(l),b=Kr({inputs:{x:g},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),b}return g}var Hht={kernelName:q0,backendName:"cpu",kernelFunc:DEn};N();function NEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:s,binaryOutput:a}=r;if(i.shape.length===1){let l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=MF(l,u,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,c)}else if(i.shape.length===2){let l=n.bufferSync(i),u=n.bufferSync(o),c=XZ(l,u,s,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}var Yht={kernelName:OC,backendName:"cpu",kernelFunc:NEn};N();function FEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:o,dataFormat:s}=r;A.assert(s==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`);let a=i.shape[0],l=i.shape[1],u=i.shape[2],c=i.shape[3],f=l*o,d=u*o,p=c/(o*o),m=n.data.get(i.dataId).values,h=new Float32Array(a*f*d*p),g=0;for(let x=0;x<a;++x)for(let b=0;b<f;++b){let y=Math.floor(b/o),v=b%o;for(let C=0;C<d;++C){let _=Math.floor(C/o),S=C%o,E=(v*o+S)*p;for(let T=0;T<p;++T){let k=T+E+c*(_+u*(y+l*x));h[g++]=m[k]}}}return n.makeTensorInfo([a,f,d,p],i.dtype,h)}var Kht={kernelName:MC,backendName:"cpu",kernelFunc:FEn};N();function Y_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:l,dimRoundingMode:u}=r;be([i,o],"depthwiseConv2DNative");let c=A.computeStrides(i.shape),f=A.computeStrides(o.shape),d=l;d==null&&(d=[1,1]),A.assert(P.eitherStridesOrDilationsAreOne(s,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`);let p=P.computeConv2DInfo(i.shape,o.shape,s,d,a,u,!0),{filterHeight:m,filterWidth:h,dilationHeight:g,dilationWidth:x,padInfo:b}=p,y=b.left,v=b.top,C=p.outChannels/p.inChannels,_=new gn(p.outShape,i.dtype),S=n.data.get(i.dataId).values,E=n.data.get(o.dataId).values,T=_.values;for(let I=0;I<p.batchSize;++I){let k=I*c[0],O=I*_.strides[0];for(let F=0;F<p.outHeight;++F){let B=O+F*_.strides[1],M=F*p.strideHeight-v;for(let z=0;z<m;++z){let W=M+z*g;if(W<0||W>=p.inHeight)continue;let H=z*f[0],Q=k+W*c[1];for(let re=0;re<p.outWidth;++re){let oe=B+re*_.strides[2],me=re*p.strideWidth-y;for(let ge=0;ge<h;++ge){let ye=me+ge*x;if(ye<0||ye>=p.inWidth)continue;let ve=H+ge*f[1],Ne=Q+ye*p.inChannels,Ge=oe,nt=ve;for(let Y=0;Y<p.inChannels;++Y){let ie=S[Ne+Y];for(let ue=0;ue<C;++ue)T[Ge+ue]+=ie*E[nt+ue];Ge+=C,nt+=C}}}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}var Xht={kernelName:H0,backendName:"cpu",kernelFunc:Y_e};N();function REn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;be([i,o],"depthwiseConv2dNativeBackpropFilter");let f=P.computeConv2DInfo(i.shape,c,s,a,l,u,!0),{strideHeight:d,strideWidth:p,filterHeight:m,filterWidth:h}=f,g=new gn(f.filterShape,"float32"),x=f.padInfo.left,b=f.padInfo.top,y=f.outChannels/f.inChannels,v=n.data.get(i.dataId).values,C=new gn(i.shape,i.dtype,v),_=n.data.get(o.dataId).values,S=new gn(o.shape,o.dtype,_);for(let E=0;E<m;++E){let T=Math.max(0,Math.ceil((b-E)/d)),I=Math.min(f.outHeight,(f.inHeight+b-E)/d);for(let k=0;k<h;++k){let O=Math.max(0,Math.ceil((x-k)/p)),F=Math.min(f.outWidth,(f.inWidth+x-k)/p);for(let B=0;B<f.outChannels;++B){let M=Math.trunc(B/y),z=B%y,W=0;for(let H=0;H<f.batchSize;++H)for(let Q=T;Q<I;++Q){let re=E+Q*d-b;for(let oe=O;oe<F;++oe){let me=k+oe*p-x;W+=C.get(H,re,me,M)*S.get(H,Q,oe,B)}}g.set(W,E,k,M,z)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}var Zht={kernelName:$C,backendName:"cpu",kernelFunc:REn};N();function OEn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;be([i,o],"depthwiseConv2DNativeBackpropInput");let f=A.computeStrides(i.shape),d=A.computeStrides(o.shape),p=P.computeConv2DInfo(c,o.shape,s,a,l,u,!0),m=new gn(p.inShape,"float32"),h=m.values,[g,x,b]=m.strides,y=n.data.get(i.dataId).values,[v,C,_]=f,S=n.data.get(o.dataId).values,[E,T,I]=d,{batchSize:k,filterHeight:O,filterWidth:F,inChannels:B,inHeight:M,inWidth:z,outChannels:W,outHeight:H,outWidth:Q,strideHeight:re,strideWidth:oe}=p,me=O-1-p.padInfo.top,ge=F-1-p.padInfo.left,ye=W/B;for(let ve=0;ve<k;++ve)for(let Ne=0;Ne<B;++Ne)for(let Ge=0;Ge<M;++Ge){let nt=Ge-me,Y=Math.max(0,Math.ceil(nt/re)),ie=Math.min(H,(O+nt)/re);for(let ue=0;ue<z;++ue){let U=ue-ge,Ue=Math.max(0,Math.ceil(U/oe)),ke=Math.min(Q,(F+U)/oe),Xe=0;for(let Ye=Y;Ye<ie;++Ye){let Pt=Ye*re-nt;for(let yn=Ue;yn<ke;++yn){let nf=yn*oe-U,Ni=v*ve+C*Ye+_*yn,vm=E*(O-1-Pt)+T*(F-1-nf)+I*Ne;for(let nl=0;nl<ye;++nl){let rf=Ne*ye+nl,da=y[Ni+rf],y0=S[vm+nl];Xe+=da*y0}}}h[g*ve+x*Ge+b*ue+Ne]=Xe}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}var Qht={kernelName:PC,backendName:"cpu",kernelFunc:OEn};N();function MEn(e){let{inputs:t,backend:n}=e,{x:r}=t,i=A.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,s=et([i,i],r.dtype),a=s.values;for(let u=0;u<o.length;u++)a[u*i+u]=o[u];let l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}var Jht={kernelName:LC,backendName:"cpu",kernelFunc:MEn};N();var egt={kernelName:Y0,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i}=e,{strides:o,pad:s,dilations:a}=n,l=t,u=l.data.get(r.dataId).values,c=r.shape.length,f=l.data.get(i.dataId).values,d=i.shape.length,{batchSize:p,inHeight:m,inWidth:h,inChannels:g,outHeight:x,outWidth:b,padInfo:y,strideHeight:v,strideWidth:C,filterHeight:_,filterWidth:S,dilationHeight:E,dilationWidth:T,outShape:I}=P.computeDilation2DInfo(r.shape,i.shape,o,s,"NHWC",a),k=A.sizeFromShape(I),O=I.length,F=A.getArrayFromDType(r.dtype,k);for(let M=0;M<p;++M)for(let z=0;z<x;++z){let W=z*v-y.top;for(let H=0;H<b;++H){let Q=H*C-y.left;for(let re=0;re<g;++re){let oe=Number.MIN_SAFE_INTEGER;for(let ge=0;ge<_;++ge){let ye=W+ge*E;if(ye>=0&&ye<m)for(let ve=0;ve<S;++ve){let Ne=Q+ve*T;if(Ne>=0&&Ne<h){let Ge=A.locToIndex([M,ye,Ne,re],c,A.computeStrides(r.shape)),nt=A.locToIndex([ge,ve,re],d,A.computeStrides(i.shape)),Y=u[Ge]+f[nt];Y>oe&&(oe=Y)}}}let me=A.locToIndex([M,z,H,re],O,A.computeStrides(I));F[me]=oe}}}return{dataId:l.write(A.toTypedArray(F,r.dtype),I,r.dtype),shape:I,dtype:r.dtype}}};N();var tgt={kernelName:tT,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i,dy:o}=e,{strides:s,pad:a,dilations:l}=n,u=t,c=A.toNestedArray(r.shape,u.data.get(r.dataId).values),f=A.toNestedArray(i.shape,u.data.get(i.dataId).values),{batchSize:d,inHeight:p,inWidth:m,inChannels:h,outHeight:g,outWidth:x,padInfo:b,strideHeight:y,strideWidth:v,filterHeight:C,filterWidth:_,dilationHeight:S,dilationWidth:E,outShape:T}=P.computeDilation2DInfo(r.shape,i.shape,s,a,"NHWC",l);A.assert(o.rank===T.length,()=>`Error in ${tT}, dy must have the same rank as output ${T.length}, but got ${o.rank}`);let I=A.toNestedArray(T,u.data.get(o.dataId).values),k=A.makeZerosNestedTypedArray(i.shape,i.dtype);for(let F=0;F<d;++F)for(let B=0;B<g;++B){let M=B*y-b.top;for(let z=0;z<x;++z){let W=z*v-b.left;for(let H=0;H<h;++H){let Q=Number.MIN_SAFE_INTEGER,re=0,oe=0;for(let me=0;me<C;++me){let ge=M+me*S;if(ge>=0&&ge<p)for(let ye=0;ye<_;++ye){let ve=W+ye*E;if(ve>=0&&ve<m){let Ne=c[F][ge][ve][H]+f[me][ye][H];Ne>Q&&(Q=Ne,re=me,oe=ye)}}}k[re][oe][H]+=I[F][B][z][H]}}}return{dataId:u.write(A.toTypedArray(k,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};N();var ngt={kernelName:eT,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i,dy:o}=e,{strides:s,pad:a,dilations:l}=n,u=t,c=A.toNestedArray(r.shape,u.data.get(r.dataId).values),f=A.toNestedArray(i.shape,u.data.get(i.dataId).values),{batchSize:d,inHeight:p,inWidth:m,inChannels:h,outHeight:g,outWidth:x,padInfo:b,strideHeight:y,strideWidth:v,filterHeight:C,filterWidth:_,dilationHeight:S,dilationWidth:E,outShape:T}=P.computeDilation2DInfo(r.shape,i.shape,s,a,"NHWC",l);A.assert(o.rank===T.length,()=>`Error in ${eT}, dy must have the same rank as output ${T.length}, but got ${o.rank}`);let I=A.toNestedArray(T,u.data.get(o.dataId).values),k=A.makeZerosNestedTypedArray(r.shape,r.dtype);for(let F=0;F<d;++F)for(let B=0;B<g;++B){let M=B*y-b.top;for(let z=0;z<x;++z){let W=z*v-b.left;for(let H=0;H<h;++H){let Q=Number.MIN_SAFE_INTEGER,re=M<0?0:M,oe=W<0?0:W;for(let me=0;me<C;++me){let ge=M+me*S;if(ge>=0&&ge<p)for(let ye=0;ye<_;++ye){let ve=W+ye*E;if(ve>=0&&ve<m){let Ne=c[F][ge][ve][H]+f[me][ye][H];Ne>Q&&(Q=Ne,re=ge,oe=ve)}}}k[F][re][oe][H]+=I[F][B][z][H]}}}return{dataId:u.write(A.toTypedArray(k,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};N();function $En(e){let{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:o,options:s}=r,{contextOptions:a,imageOptions:l}=s||{},u=l?.alpha||1,c=a?.contextType||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);let f=o.getContext(c,a?.contextAttributes||{});if(f==null)throw new Error(`Could not get the context with ${c} type.`);let[d,p]=i.shape.slice(0,2),m=i.shape.length===2?1:i.shape[2],h=n.data.get(i.dataId).values,g=i.dtype==="float32"?255:1,x=new Uint8ClampedArray(p*d*4);for(let y=0;y<d*p;++y){let v=[0,0,0,255*u];for(let _=0;_<m;_++){let S=h[y*m+_];if(i.dtype==="float32"){if(S<0||S>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${S}.`)}else if(i.dtype==="int32"&&(S<0||S>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${S}.`);m===1?(v[0]=S*g,v[1]=S*g,v[2]=S*g):v[_]=S*g}let C=y*4;x[C+0]=Math.round(v[0]),x[C+1]=Math.round(v[1]),x[C+2]=Math.round(v[2]),x[C+3]=Math.round(v[3])}o.width=p,o.height=d;let b=new ImageData(x,p,d);return f.putImageData(b,0,0),i}var rgt={kernelName:nT,backendName:"cpu",kernelFunc:$En};N();N();function my(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;be(i,"sum");let a;i.dtype==="bool"?a=bd({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):a=Ls({inputs:{x:i},backend:n});let l=a.shape.length,u=A.parseAxisParam(o,a.shape),c=P.getAxesPermutation(u,l),f=u,d=a;c!=null&&(d=Kr({inputs:{x:a},backend:n,attrs:{perm:c}}),f=P.getInnerMostAxes(f.length,l)),P.assertAxesAreInnerMostDims("sum",f,d.shape.length);let[p,m]=P.computeOutAndReduceShapes(d.shape,f),h=P.upcastType(d.dtype,"int32"),g=RF(n,p,h),x=A.sizeFromShape(m),b=n.data.get(g.dataId).values,y=n.data.get(d.dataId).values;for(let v=0;v<b.length;++v){let C=v*x,_=0;for(let S=0;S<x;++S)_+=y[C+S];b[v]=_}if(s){let v=P.expandShapeToKeepDim(g.shape,u),C=g;g=ln({inputs:{x:g},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(d),g}var igt={kernelName:yx,backendName:"cpu",kernelFunc:my};function PEn(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,o=t,{allDims:s,summedDims:a,idDims:l}=P.decodeEinsumEquation(i,o.length);P.checkEinsumDimSizes(s.length,l,o);let{path:u,steps:c}=P.getEinsumComputePath(a,l),f=c.length,d=null,p=s.length,m=[];for(let h=0;h<f;++h){for(let g of c[h]){let{permutationIndices:x,expandDims:b}=P.getEinsumPermutation(p,l[g]),y;P.isIdentityPermutation(x)?y=o[g]:(y=Kr({inputs:{x:o[g]},backend:n,attrs:{perm:x}}),m.push(y));let v=y.shape.slice();for(let C=0;C<b.length;++C)v.splice(b[C],0,1);A.arraysEqual(y.shape,v)||(y=ln({inputs:{x:y},backend:n,attrs:{shape:v}}),m.push(y)),d===null?d=y:(d=uA({inputs:{a:y,b:d},backend:n}),m.push(d))}h<f-1&&(u[h]>=0&&(d=my({inputs:{x:d},backend:n,attrs:{axis:u[h]-(s.length-p),keepDims:!1}}),m.push(d)),p--)}for(let h of m)h!==d&&n.disposeIntermediateTensorInfo(h);return d}var ogt={kernelName:BC,backendName:"cpu",kernelFunc:PEn};N();function LEn(e){let{inputs:t,backend:n}=e,{dy:r,y:i}=t;be([r,i],"eluGrad");let o=new Float32Array(A.sizeFromShape(i.shape)),s=n.data.get(i.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){let u=s[l];u>=0?o[l]=a[l]:o[l]=a[l]*(u+1)}return n.makeTensorInfo(i.shape,"float32",o)}var sgt={kernelName:zC,backendName:"cpu",kernelFunc:LEn};N();var BEn=P.ERF_P,zEn=P.ERF_A1,UEn=P.ERF_A2,jEn=P.ERF_A3,VEn=P.ERF_A4,WEn=P.ERF_A5,GEn=wt(zm,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+BEn*n);return t*(1-((((WEn*r+VEn)*r+jEn)*r+UEn)*r+zEn)*r*Math.exp(-n*n))}),agt={kernelName:zm,backendName:"cpu",kernelFunc:GEn};N();function BF(e){let{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:o}=r,s=i.shape.length,a=i.shape.slice(),l=o;return o<0&&(A.assert(-(s+1)<=o,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+o+1),a.splice(l,0,1),ln({inputs:{x:i},backend:n,attrs:{shape:a}})}var lgt={kernelName:K0,backendName:"cpu",kernelFunc:BF};N();N();N();var qEn=an((e,t)=>e/t),R4=hn(Lm,qEn),O4={kernelName:Lm,backendName:"cpu",kernelFunc:R4};function xQ(e,t,n){let r=e.shape,i=r[0],o=r[1],s=n.data.get(e.dataId),a=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[i,o],c=A.sizeFromShape(u),f=A.getTypedArrayFromDType("float32",c),d=A.getTypedArrayFromDType("float32",c);for(let g=0;g<i;g++){let x=vd({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,o]}}),b=vd({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,o]}}),y=mo({inputs:{real:x,imag:b},backend:n}),{real:v,imag:C}=HEn(y,t,n),_=P.mergeRealAndImagArrays(v,C);for(let S=0;S<o;S++){let E=P.getComplexWithIndex(_,S);f[g*o+S]=E.real,d[g*o+S]=E.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(y)}let p=n.makeTensorInfo(u,"float32",f),m=n.makeTensorInfo(u,"float32",d),h=mo({inputs:{real:p,imag:m},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),h}function HEn(e,t,n){let r=A.sizeFromShape(e.shape),i=n.data.get(e.dataId),o=n.data.get(i.complexTensorInfos.real.dataId).values,s=n.data.get(i.complexTensorInfos.imag.dataId).values;if(YEn(r)){let a=K_e(o,s,r,t,n),l=[e.shape[0],e.shape[1]];if(t){let u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),f=n.makeTensorInfo([],"float32",A.createScalarValue(r,"float32")),d=Ls({inputs:{x:f},backend:n}),p=O4.kernelFunc({inputs:{a:u,b:f},backend:n}),m=O4.kernelFunc({inputs:{a:c,b:d},backend:n}),h=n.data.get(p.dataId).values,g=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),{real:h,imag:g}}return a}else{let a=P.mergeRealAndImagArrays(o,s),l=KEn(a,r,t);return P.splitRealAndImagArrays(l)}}function YEn(e){return(e&e-1)===0}function K_e(e,t,n,r,i){if(n===1)return{real:e,imag:t};let o=P.mergeRealAndImagArrays(e,t),s=n/2,a=P.complexWithEvenIndex(o),l=a.real,u=a.imag,c=[l.length],f=i.makeTensorInfo(c,"float32",l),d=i.makeTensorInfo(c,"float32",u),p=mo({inputs:{real:f,imag:d},backend:i}),m=P.complexWithOddIndex(o),h=m.real,g=m.imag,x=[h.length],b=i.makeTensorInfo(x,"float32",h),y=i.makeTensorInfo(x,"float32",g),v=mo({inputs:{real:b,imag:y},backend:i}),C=K_e(l,u,s,r,i),_=C.real,S=C.imag,E=[_.length],T=i.makeTensorInfo(E,"float32",_),I=i.makeTensorInfo(E,"float32",S),k=mo({inputs:{real:T,imag:I},backend:i}),O=K_e(h,g,s,r,i),F=O.real,B=O.imag,M=[F.length],z=i.makeTensorInfo(M,"float32",F),W=i.makeTensorInfo(M,"float32",B),H=mo({inputs:{real:z,imag:W},backend:i}),Q=P.exponents(n,r),re=[Q.real.length],oe=i.makeTensorInfo(re,"float32",Q.real),me=i.makeTensorInfo(re,"float32",Q.imag),ge=mo({inputs:{real:oe,imag:me},backend:i}),ye=uA({inputs:{a:ge,b:H},backend:i}),ve=m0({inputs:{a:k,b:ye},backend:i}),Ne=N4({inputs:{a:k,b:ye},backend:i}),Ge=xd({inputs:{input:ve},backend:i}),nt=xd({inputs:{input:Ne},backend:i}),Y=h0({inputs:{input:ve},backend:i}),ie=h0({inputs:{input:Ne},backend:i}),ue=Qw({inputs:[Ge,nt],backend:i,attrs:{axis:0}}),U=Qw({inputs:[Y,ie],backend:i,attrs:{axis:0}}),Ue=i.data.get(ue.dataId).values,ke=i.data.get(U.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(oe),i.disposeIntermediateTensorInfo(me),i.disposeIntermediateTensorInfo(ge),i.disposeIntermediateTensorInfo(ye),i.disposeIntermediateTensorInfo(ve),i.disposeIntermediateTensorInfo(Ne),i.disposeIntermediateTensorInfo(Ge),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(nt),i.disposeIntermediateTensorInfo(ie),i.disposeIntermediateTensorInfo(ue),i.disposeIntermediateTensorInfo(U),{real:Ue,imag:ke}}function KEn(e,t,n){let r=new Float32Array(t*2);for(let i=0;i<t;i++){let o=0,s=0;for(let a=0;a<t;a++){let l=P.exponent(i*a,t,n),u=P.getComplexWithIndex(e,a);o+=u.real*l.real-u.imag*l.imag,s+=u.real*l.imag+u.imag*l.real}n&&(o/=t,s/=t),P.assignToTypedArray(r,o,s,i)}return r}function XEn(e){let{inputs:t,backend:n}=e,{input:r}=t,i=A.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],s=i/o,a=ln({inputs:{x:r},backend:n,attrs:{shape:[s,o]}}),l=xQ(a,!1,n),u=ln({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}var ugt={kernelName:UC,backendName:"cpu",kernelFunc:XEn};N();function M4(e){let{backend:t,attrs:n}=e,{shape:r,value:i,dtype:o}=n,s=o||A.inferDtype(i),a=A.getArrayFromDType(s,A.sizeFromShape(r));return ZEn(a,i,s),t.makeTensorInfo(r,s,a)}var cgt={kernelName:jC,backendName:"cpu",kernelFunc:M4};function ZEn(e,t,n){e.fill(t)}N();var fgt={kernelName:VC,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,i=n,o=A.getTypedArrayFromDType(r.dtype,A.sizeFromShape(r.shape)),[s,a,l,u]=r.shape,c=i.data.get(r.dataId).values;for(let d=0;d<s;d++){let p=d*l*a*u;for(let m=0;m<a;m++){let h=m*(l*u);for(let g=0;g<l;g++){let x=g*u;for(let b=0;b<u;b++){let y=Math.round(l-g-1),v=p+h+x+b,C=c[v];if(y>=0&&y<l){let _=y*u,S=p+h+_+b;C=c[S]}o[v]=C}}}}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};N();function QEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:m}=r,h=H_e({inputs:{x:i,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:d}});if(s){let g=h;if(c==="NCHW"&&s.shape.length===1&&s.shape[0]!==1){let x=ln({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});h=m0({inputs:{a:h,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else h=m0({inputs:{a:h,b:s},backend:n});n.disposeIntermediateTensorInfo(g)}if(p){let g=h;if(c==="NCHW"&&p==="prelu"&&a.shape.length===1&&a.shape[0]!==1){let x=ln({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});h=cA(n,h,p,x,m),n.disposeIntermediateTensorInfo(x)}else h=cA(n,h,p,a,m);n.disposeIntermediateTensorInfo(g)}return h}var dgt={kernelName:qy,backendName:"cpu",kernelFunc:QEn};N();function JEn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:m}=r,h=Y_e({inputs:{x:i,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:d}});if(s){let g=h;h=m0({inputs:{a:h,b:s},backend:n}),n.disposeIntermediateTensorInfo(g)}if(p){let g=h;h=cA(n,h,p,a,m),n.disposeIntermediateTensorInfo(g)}return h}var pgt={kernelName:Hy,backendName:"cpu",kernelFunc:JEn};N();function e2n(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,o=A.sizeFromShape(r.shape),s=i.shape,a=s[s.length-1],[l,u,c,f]=P.prepareAndValidate(r,i);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);let d=n.data.get(i.dataId).values,p=n.bufferSync(r),m=QZ(d,p,r.dtype,u,a,c,f,r.shape,o);return n.makeTensorInfo(l,r.dtype,m.values)}var mgt={kernelName:WC,backendName:"cpu",kernelFunc:e2n};N();function t2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:o}=t,{axis:s,batchDims:a}=r;be([i,o],"gatherV2");let l=A.parseAxisParam(s,i.shape)[0],u=n.data.get(o.dataId).values,c=i.shape[l];for(let v=0;v<u.length;++v){let C=u[v];A.assert(C<=c-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${c-1}]`)}let f=a;a==null&&(f=0);let d=A.sizeFromShape(o.shape),p=P.segment_util.collectGatherOpShapeInfo(i,o,l,f),m=ln({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),h=ln({inputs:{x:o},backend:n,attrs:{shape:[p.batchSize,d/p.batchSize]}}),g=[p.batchSize,p.outerSize,d/p.batchSize,p.sliceSize],x=n.bufferSync(h),b=n.bufferSync(m),y=JZ(b,x,g);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.makeTensorInfo(p.outputShape,y.dtype,y.values)}var hgt={kernelName:Z0,backendName:"cpu",kernelFunc:t2n};N();function n2n(e){let{inputs:t,backend:n}=e,{input:r}=t,i=A.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],s=i/o,a=ln({inputs:{x:r},backend:n,attrs:{shape:[s,o]}}),l=xQ(a,!0,n),u=ln({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}var ggt={kernelName:GC,backendName:"cpu",kernelFunc:n2n};N();var r2n=wt(qm,e=>Number.isFinite(e)?1:0,"bool"),xgt={kernelName:qm,backendName:"cpu",kernelFunc:r2n};N();var i2n=wt(Hm,e=>Math.abs(e)===1/0?1:0,"bool"),bgt={kernelName:Hm,backendName:"cpu",kernelFunc:i2n};N();var o2n=wt(Ym,e=>Number.isNaN(e)?1:0,"bool"),ygt={kernelName:Ym,backendName:"cpu",kernelFunc:o2n};N();function s2n(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:o}=n,s=eQ(r,i,o);return t.makeTensorInfo([s.length],"float32",s)}var vgt={kernelName:HC,backendName:"cpu",kernelFunc:s2n};N();var a2n=wt(Xm,e=>Math.log1p(e)),wgt={kernelName:Xm,backendName:"cpu",kernelFunc:a2n};N();var l2n=an((e,t)=>e&&t),u2n=hn(zy,l2n,null,"bool"),Cgt={kernelName:zy,backendName:"cpu",kernelFunc:u2n};N();var c2n=wt(Uy,e=>e?0:1,"bool"),_gt={kernelName:Uy,backendName:"cpu",kernelFunc:c2n};N();var f2n=an((e,t)=>e||t),d2n=hn(jy,f2n,null,"bool"),Sgt={kernelName:jy,backendName:"cpu",kernelFunc:d2n};N();function p2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:o,bias:s,alpha:a,beta:l}=r;be(i,"LRN");let u=i.shape[3],c=u-1,f=n.data.get(i.dataId).values,d=A.sizeFromShape(i.shape),p=new Float32Array(d);function m(h){let g=h%u,x=h-g+Math.max(0,g-o),b=h-g+Math.min(g+o,c),y=0;for(;x<=b;x++){let v=f[x];y+=v*v}return y}for(let h=0;h<d;h++){let g=m(h),x=f[h]*Math.pow(s+a*g,-l);p[h]=x}return n.makeTensorInfo(i.shape,i.dtype,p)}var Egt={kernelName:J0,backendName:"cpu",kernelFunc:p2n};N();function m2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,y:o,dy:s}=t,{depthRadius:a,bias:l,alpha:u,beta:c}=r;be(s,"LRNGrad");let f=A.sizeFromShape(s.shape),d=s.shape[3],p=n.data.get(s.dataId).values,m=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,g=new Float32Array(f),x=f;for(let b=0;b<x;b++){let y=b%d,v=b-y+Math.max(0,y-a),C=b-y+Math.min(d,y+a+1),_=0;for(let S=v;S<C;S++)_+=Math.pow(m[S],2);_=u*_+l;for(let S=v;S<C;S++){let E=-2*u*c*m[S]*h[b]/_;b===S&&(E+=Math.pow(_,-c)),E*=p[b],g[S]+=E}}return n.makeTensorInfo(s.shape,i.dtype,g)}var Agt={kernelName:YC,backendName:"cpu",kernelFunc:m2n};N();N();N();function X_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:o,keepDims:s}=r,a=n,l=i.shape,u=l.length,c=A.parseAxisParam(o,l),f=c,d=P.getAxesPermutation(f,u),p=a.data.get(i.dataId).values;if(d!=null){let v=new Array(u);for(let C=0;C<v.length;C++)v[C]=l[d[C]];p=$F(p,l,i.dtype,d,v),f=P.getInnerMostAxes(f.length,u),l=v}be(i,"max"),P.assertAxesAreInnerMostDims("max",f,u);let[m,h]=P.computeOutAndReduceShapes(l,f),g=A.sizeFromShape(h),x=tQ(p,g,m,i.dtype),b=a.write(x,m,i.dtype),y=m;return s&&(y=P.expandShapeToKeepDim(m,c)),{dataId:b,shape:y,dtype:i.dtype}}var Tgt={kernelName:ex,backendName:"cpu",kernelFunc:X_e};N();function h2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;be(i,"maxPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;A.assert(P.eitherStridesOrDilationsAreOne(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=P.computePool2DInfo(i.shape,o,s,u,a,l),f;if(c.filterWidth===1&&c.filterHeight===1&&A.arraysEqual(c.inShape,c.outShape))f=Ls({inputs:{x:i},backend:n});else{let d=n.data.get(i.dataId).values,p=A.computeStrides(i.shape),m=LF(d,i.shape,i.dtype,p,c,"max");f=n.makeTensorInfo(c.outShape,i.dtype,m.values)}return f}var kgt={kernelName:tx,backendName:"cpu",kernelFunc:h2n};N();function g2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r;be(i,"maxPool3d");let c=P.computePool3DInfo(i.shape,o,s,1,a,l,u),f=n.data.get(i.dataId).values,d=gQ(f,i.shape,i.dtype,A.computeStrides(i.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}var Igt={kernelName:nx,backendName:"cpu",kernelFunc:g2n};N();function x2n(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,{filterSize:s,strides:a,pad:l,dimRoundingMode:u}=r;be([i,o],"maxPool3DGrad");let c=P.computePool3DInfo(o.shape,s,a,1,l,u),f=n.bufferSync(o),d=Sht(f,c),p=c.strideDepth,m=c.strideHeight,h=c.strideWidth,g=c.dilationDepth,x=c.dilationHeight,b=c.dilationWidth,y=c.effectiveFilterDepth,v=c.effectiveFilterHeight,C=c.effectiveFilterWidth,_=y-1-c.padInfo.front,S=C-1-c.padInfo.left,E=v-1-c.padInfo.top,T=et(o.shape,"float32"),I=n.bufferSync(i);for(let k=0;k<c.batchSize;++k)for(let O=0;O<c.inChannels;++O)for(let F=0;F<c.inDepth;++F)for(let B=0;B<c.inHeight;++B)for(let M=0;M<c.inWidth;++M){let z=F-_,W=B-E,H=M-S,Q=0;for(let re=0;re<y;re+=g){let oe=(z+re)/p;if(!(oe<0||oe>=c.outDepth||Math.floor(oe)!==oe))for(let me=0;me<v;me+=x){let ge=(W+me)/m;if(!(ge<0||ge>=c.outHeight||Math.floor(ge)!==ge))for(let ye=0;ye<C;ye+=b){let ve=(H+ye)/h;if(ve<0||ve>=c.outWidth||Math.floor(ve)!==ve)continue;let Ne=y*v*C-1-d.get(k,oe,ge,ve,O),Ge=re*v*C+me*C+ye,nt=Ne===Ge?1:0;if(nt===0)continue;let Y=I.get(k,oe,ge,ve,O);Q+=Y*nt}}}T.set(Q,k,F,B,M,O)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}var Dgt={kernelName:XC,backendName:"cpu",kernelFunc:x2n};N();function b2n(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o,output:s}=t,a=o;be([o,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,d=P.computePool2DInfo(a.shape,l,u,1,c,f),p=n.data.get(a.dataId).values,m=et(d.outShape,a.dtype,hQ(p,a.shape,a.dtype,d).values),h=d.strideHeight,g=d.strideWidth,x=d.dilationHeight,b=d.dilationWidth,y=d.effectiveFilterHeight,v=d.effectiveFilterWidth,C=v-1-d.padInfo.left,_=y-1-d.padInfo.top,S=et(a.shape,"float32"),E=n.data.get(i.dataId).values,T=et(i.shape,"float32",E);for(let I=0;I<d.batchSize;++I)for(let k=0;k<d.inChannels;++k)for(let O=0;O<d.inHeight;++O)for(let F=0;F<d.inWidth;++F){let B=O-_,M=F-C,z=0;for(let W=0;W<y;W+=x){let H=(B+W)/h;if(!(H<0||H>=d.outHeight||Math.floor(H)!==H))for(let Q=0;Q<v;Q+=b){let re=(M+Q)/g;if(re<0||re>=d.outWidth||Math.floor(re)!==re)continue;let oe=y*v-1-m.get(I,H,re,k),me=W*v+Q,ge=oe===me?1:0;if(ge===0)continue;let ye=T.get(I,H,re,k);z+=ye*ge}}S.set(z,I,O,F,k)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}var Ngt={kernelName:KC,backendName:"cpu",kernelFunc:b2n};N();N();N();function Fgt(e,t,n,r,i){let o=A.computeStrides(t),s=LF(e,t,n,o,i,"max"),a=hQ(e,t,n,i,!0,r);return[s.values,a.values]}var Rgt={kernelName:ZC,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:o,pad:s,includeBatchInIndex:a}=t,l=n;be(r,"MaxPoolWithArgmax");let u=l.data.get(r.dataId).values,c=P.computePool2DInfo(r.shape,i,o,[1,1],s),[f,d]=Fgt(u,r.shape,r.dtype,a,c),p=l.write(f,c.outShape,r.dtype),m=l.write(d,c.outShape,r.dtype);return[{dataId:p,shape:c.outShape,dtype:r.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};N();function y2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r,a=A.parseAxisParam(o,i.shape),u=P.computeOutAndReduceShapes(i.shape,a)[1],c=A.sizeFromShape(u),f=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));f.push(d);let p=bd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(p);let m=R4({inputs:{a:p,b:d},backend:n});f.push(m);let h=my({inputs:{x:m},backend:n,attrs:{axis:o,keepDims:s}});return f.forEach(g=>n.disposeIntermediateTensorInfo(g)),h}var Ogt={kernelName:rx,backendName:"cpu",kernelFunc:y2n};N();function v2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;be(i,"min");let a=A.parseAxisParam(o,i.shape),l=a,u=P.getAxesPermutation(l,i.shape.length),c=i;u!=null&&(c=Kr({inputs:{x:i},backend:n,attrs:{perm:u}}),l=P.getInnerMostAxes(l.length,i.shape.length)),P.assertAxesAreInnerMostDims("min",l,c.shape.length);let[f,d]=P.computeOutAndReduceShapes(c.shape,l),p=A.sizeFromShape(d),m=A.makeZerosTypedArray(A.sizeFromShape(f),c.dtype),h=n.data.get(c.dataId).values;for(let x=0;x<m.length;++x){let b=x*p,y=h[b];for(let v=0;v<p;++v){let C=h[b+v];(Number.isNaN(C)||C<y)&&(y=C)}m[x]=y}u!=null&&n.disposeIntermediateTensorInfo(c);let g=n.makeTensorInfo(f,c.dtype,m);if(s){let x=P.expandShapeToKeepDim(f,a),b=ln({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),b}return g}var Mgt={kernelName:ix,backendName:"cpu",kernelFunc:v2n};N();function w2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,mode:s}=r;be(i,"mirrorPad");let a=o.map((y,v)=>y[0]+i.shape[v]+y[1]),l=o.map(y=>y[0]),u=o.map((y,v)=>y[0]+i.shape[v]),c=s==="reflect"?0:1,f=n.data.get(i.dataId).values,d=i.shape.length,p=A.computeStrides(i.shape),m=A.sizeFromShape(a),h=a.length,g=A.computeStrides(a),x=A.getTypedArrayFromDType(i.dtype,m);for(let y=0;y<m;y++){let v=A.indexToLoc(y,h,g);for(let _=0;_<h;_++)v[_]<l[_]?v[_]=l[_]*2-v[_]-c:v[_]>=u[_]&&(v[_]=(u[_]-1)*2-v[_]+c);v=v.map((_,S)=>_-l[S]);let C=A.locToIndex(v,d,p);x[y]=f[C]}return{dataId:n.write(x,a,i.dtype),shape:a,dtype:i.dtype}}var $gt={kernelName:ox,backendName:"cpu",kernelFunc:w2n};N();var C2n=an((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),_2n=hn(Jm,C2n),Pgt={kernelName:Jm,backendName:"cpu",kernelFunc:_2n};N();var Bgt=tc(EO());N();function Z_e(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:o}=r,s=i.shape.length,a=o;if(a===-1&&(a=s-1),a!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${a}`);let l=A.parseAxisParam([a],i.shape),u=X_e({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=P.expandShapeToKeepDim(u.shape,l),f=ln({inputs:{x:u},backend:n,attrs:{shape:c}}),d=N4({inputs:{a:i,b:f},backend:n}),p=b_e({inputs:{x:d},backend:n}),m=my({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),h=ln({inputs:{x:m},backend:n,attrs:{shape:c}}),g=R4({inputs:{a:p,b:h},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),g}var Lgt={kernelName:Cx,backendName:"cpu",kernelFunc:Z_e};function S2n(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:o,seed:s,normalized:a}=r;be(i,"multinomial");let l=a?i:Z_e({inputs:{logits:i},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],f=n.data.get(l.dataId).values,d=[u,o],p=A.makeZerosTypedArray(A.sizeFromShape(d),"int32");for(let m=0;m<u;++m){let h=m*c,g=new Float32Array(c-1);g[0]=f[h];for(let y=1;y<g.length;++y)g[y]=g[y-1]+f[h+y];let x=Bgt.alea(s.toString()),b=m*o;for(let y=0;y<o;++y){let v=x();p[b+y]=g.length;for(let C=0;C<g.length;C++)if(v<g[C]){p[b+y]=C;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",p)}var zgt={kernelName:QC,backendName:"cpu",kernelFunc:S2n};N();var E2n=Ko.nonMaxSuppressionV3Impl;function A2n(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=r;be(i,"NonMaxSuppression");let u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,{selectedIndices:f}=E2n(u,c,s,a,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}var Ugt={kernelName:JC,backendName:"cpu",kernelFunc:A2n};N();var T2n=Ko.nonMaxSuppressionV4Impl;function k2n(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;be(i,"NonMaxSuppressionPadded");let c=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,{selectedIndices:d,validOutputs:p}=T2n(c,f,s,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}var jgt={kernelName:e_,backendName:"cpu",kernelFunc:k2n};N();var I2n=Ko.nonMaxSuppressionV5Impl;function D2n(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;be(i,"NonMaxSuppressionWithScore");let c=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,d=s,p=a,m=l,h=u,{selectedIndices:g,selectedScores:x}=I2n(c,f,d,p,m,h);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}var Vgt={kernelName:t_,backendName:"cpu",kernelFunc:D2n};N();function N2n(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:o,depth:s,onValue:a,offValue:l}=r;be(i,"oneHot");let u=A.sizeFromShape(i.shape),c=new Float32Array(u*s);c.fill(l);let f=n.data.get(i.dataId).values;for(let d=0;d<u;++d)f[d]>=0&&f[d]<s&&(c[d*s+f[d]]=a);return n.makeTensorInfo([...i.shape,s],o,c)}var Wgt={kernelName:lx,backendName:"cpu",kernelFunc:N2n};N();N();function $4(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let i=xd({inputs:{input:r},backend:n}),o=$4({inputs:{x:i},backend:n}),s=h0({inputs:{input:r},backend:n}),a=$4({inputs:{x:s},backend:n}),l=mo({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return M4({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Ggt={kernelName:Ex,backendName:"cpu",kernelFunc:$4};function qgt(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let i=xd({inputs:{input:r},backend:n}),o=qgt({inputs:{x:i},backend:n}),s=h0({inputs:{input:r},backend:n}),a=$4({inputs:{x:s},backend:n}),l=mo({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return M4({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var Hgt={kernelName:ax,backendName:"cpu",kernelFunc:qgt};N();function Q_e(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return BF({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let o=t[0].shape,s=t[0].dtype;t.forEach(c=>{A.assertShapesMatch(o,c.shape,"All tensors passed to stack must have matching shapes"),A.assert(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=t.map(c=>{let f=BF({inputs:{input:c},backend:n,attrs:{dim:i}});return a.push(f),f}),u=Qw({inputs:l,backend:n,attrs:{axis:i}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}var Ygt={kernelName:ux,backendName:"cpu",kernelFunc:Q_e};N();function F2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,constantValue:s}=r;be(i,"pad");let a=o.map((b,y)=>b[0]+i.shape[y]+b[1]),l=o.map(b=>b[0]),u=n.data.get(i.dataId).values,c=A.sizeFromShape(i.shape),f=i.shape.length,d=A.computeStrides(i.shape),p=A.sizeFromShape(a),m=a.length,h=A.computeStrides(a),g=A.getTypedArrayFromDType(i.dtype,p);s!==0&&g.fill(s);for(let b=0;b<c;b++){let v=A.indexToLoc(b,f,d).map((_,S)=>_+l[S]),C=A.locToIndex(v,m,h);g[C]=u[b]}return{dataId:n.write(g,a,i.dtype),shape:a,dtype:i.dtype}}var bQ={kernelName:cx,backendName:"cpu",kernelFunc:F2n};N();var R2n=an((e,t)=>Math.pow(e,t)),O2n=hn(th,R2n),Kgt={kernelName:th,backendName:"cpu",kernelFunc:O2n};N();function M2n(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:o,indices:s}=t,{outputRaggedRank:a}=r,l=i.map(x=>n.data.get(x.dataId).values),u=i.map(x=>x.shape),c=n.data.get(o.dataId).values,f=n.data.get(s.dataId).values,[d,p,m]=nQ(l,u,c,o.shape,o.dtype,f,s.shape,a),h=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),g=n.makeTensorInfo(m,o.dtype,p);return h.concat([g])}var Xgt={kernelName:n_,backendName:"cpu",kernelFunc:M2n};N();function $2n(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:o}=t,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,[u,c]=rQ(s,r.shape,r.dtype,a,i.shape,l,o.shape),f=n.makeTensorInfo([u.length],"int32",u),d=n.makeTensorInfo([c.length],r.dtype,c);return[f,d]}var Zgt={kernelName:r_,backendName:"cpu",kernelFunc:$2n};N();function P2n(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:o,defaultValue:s,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=r,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,f=n.data.get(s.dataId).values,d=a.map(g=>n.data.get(g.dataId).values),p=a.map(g=>g.shape),[m,h]=iQ(u,i.shape,c,o.shape,o.dtype,f,s.shape,d,p,l);return n.makeTensorInfo(m,o.dtype,h)}var Qgt={kernelName:i_,backendName:"cpu",kernelFunc:P2n};N();function L2n(e){let{backend:t,attrs:n}=e,{start:r,stop:i,dtype:o,step:s}=n,a=oQ(r,i,s,o);return t.makeTensorInfo([a.length],o,a)}var Jgt={kernelName:o_,backendName:"cpu",kernelFunc:L2n};N();var B2n=wt(nh,e=>1/e),e0t={kernelName:nh,backendName:"cpu",kernelFunc:B2n};N();function z2n(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:s,size:a}=r;be(i,"resizeBilinear");let l=A.computeStrides(i.shape),[u,c]=a,[f,d,p,m]=i.shape,h=n.data.get(i.dataId).values,g=new Float32Array(A.sizeFromShape([f,u,c,m])),x=[o&&u>1?d-1:d,o&&c>1?p-1:p],b=[o&&u>1?u-1:u,o&&c>1?c-1:c],y=0,v=x[0]/b[0],C=x[1]/b[1];for(let _=0;_<f;_++)for(let S=0;S<u;S++){let E;s?E=v*(S+.5)-.5:E=v*S;let T=Math.max(0,Math.floor(E)),I=E-T,k=Math.min(d-1,Math.ceil(E)),O=_*l[0]+T*l[1],F=_*l[0]+k*l[1];for(let B=0;B<c;B++){let M;s?M=C*(B+.5)-.5:M=C*B;let z=Math.max(0,Math.floor(M)),W=M-z,H=Math.min(p-1,Math.ceil(M)),Q=O+z*l[2],re=F+z*l[2],oe=O+H*l[2],me=F+H*l[2];for(let ge=0;ge<m;ge++){let ye=h[Q+ge],ve=h[re+ge],Ne=h[oe+ge],Ge=h[me+ge],nt=ye+(Ne-ye)*W,Y=ve+(Ge-ve)*W,ie=nt+(Y-nt)*I;g[y++]=ie}}}return n.makeTensorInfo([f,u,c,m],"float32",g)}var t0t={kernelName:hx,backendName:"cpu",kernelFunc:z2n};N();function U2n(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:s}=r;be([o,i],"resizeBilinearGrad");let a=A.computeStrides(i.shape),[l,u,c,f]=i.shape,[,d,p]=o.shape,m=new Float32Array(l*u*c*f),h=[s&&d>1?u-1:u,s&&p>1?c-1:c],g=[s&&d>1?d-1:d,s&&p>1?p-1:p],x=h[0]/g[0],b=h[1]/g[1],y=n.data.get(o.dataId).values,v=0;for(let C=0;C<l;C++){let _=C*a[0];for(let S=0;S<d;S++){let E=S*x,T=Math.floor(E),I=Math.min(Math.ceil(E),u-1),k=_+T*a[1],O=_+I*a[1],F=E-T,B=1-F;for(let M=0;M<p;M++){let z=M*b,W=Math.floor(z),H=Math.min(Math.ceil(z),c-1),Q=z-W,re=1-Q,oe=k+W*a[2],me=k+H*a[2],ge=O+W*a[2],ye=O+H*a[2],ve=B*re,Ne=B*Q,Ge=F*re,nt=F*Q;for(let Y=0;Y<f;Y++){let ie=y[v++];m[oe+Y]+=ie*ve,m[me+Y]+=ie*Ne,m[ge+Y]+=ie*Ge,m[ye+Y]+=ie*nt}}}}return n.makeTensorInfo([l,c,u,f],"float32",m)}var n0t={kernelName:l_,backendName:"cpu",kernelFunc:U2n};N();function j2n(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:s,size:a}=r;be(i,"resizeNearestNeighbor");let l=A.computeStrides(i.shape),[u,c]=a,[f,d,p,m]=i.shape,h=n.data.get(i.dataId).values,g=new Float32Array(f*u*c*m),x=[o&&u>1?d-1:d,o&&c>1?p-1:p],b=[o&&u>1?u-1:u,o&&c>1?c-1:c],y=x[0]/b[0],v=x[1]/b[1],C=0;for(let _=0;_<f;_++){let S=_*l[0];for(let E=0;E<u;E++){let T=s?y*(E+.5):y*E,I=Math.min(d-1,o?Math.round(T):Math.floor(T));s&&(I=Math.max(0,I));let k=S+I*l[1];for(let O=0;O<c;O++){let F=s?v*(O+.5):v*O,B=Math.min(p-1,o?Math.round(F):Math.floor(F));s&&(B=Math.max(0,B));let M=k+B*l[2];for(let z=0;z<m;z++){let W=h[M+z];g[C++]=W}}}}return n.makeTensorInfo([f,u,c,m],i.dtype,g)}var r0t={kernelName:mx,backendName:"cpu",kernelFunc:j2n};N();function V2n(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:s}=r;be([o,i],"resizeNearestNeighborGrad");let a=A.computeStrides(i.shape),l=A.computeStrides(o.shape),[u,c,f,d]=i.shape,[,p,m]=o.shape,h=new Float32Array(u*c*f*d),g=n.data.get(o.dataId).values,x=[s&&p>1?c-1:c,s&&m>1?f-1:f],b=[s&&p>1?p-1:p,s&&m>1?m-1:m],y=x[0]/b[0],v=x[1]/b[1],C=1/y,_=1/v,S=Math.ceil(C)*2+2,E=Math.ceil(_)*2+2;for(let T=0;T<u;T++){let I=T*a[0];for(let k=0;k<c;k++){let O=I+k*a[1],F=Math.floor(k*C),B=Math.floor(F-S/2);for(let M=0;M<f;M++){let z=O+M*a[2],W=Math.floor(M*_),H=Math.floor(W-E/2);for(let Q=0;Q<d;Q++){let re=0;for(let oe=0;oe<S;oe++){let me=oe+B;if(me<0||me>=p)continue;let ge=I+me*l[1],ye=me*y,ve=Math.min(c-1,s?Math.round(ye):Math.floor(ye));if(k===ve)for(let Ne=0;Ne<E;Ne++){let Ge=Ne+H;if(Ge<0||Ge>=m)continue;let nt=ge+Ge*l[2],Y=Ge*v,ie=Math.min(f-1,s?Math.round(Y):Math.floor(Y));M===ie&&(re+=g[nt+Q])}}h[z+Q]=re}}}}return n.makeTensorInfo(i.shape,i.dtype,h)}var i0t={kernelName:a_,backendName:"cpu",kernelFunc:V2n};N();function W2n(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:o}=r;be(i,"reverse");let s=i.shape.length,a=A.parseAxisParam(o,i.shape);if(s===0)return Ls({inputs:{x:i},backend:n});let l=new gn(i.shape,i.dtype),u=n.bufferSync(i);for(let c=0;c<l.size;c++){let f=l.indexToLoc(c),d=f.slice();a.forEach(p=>d[p]=i.shape[p]-1-d[p]),l.set(u.get(...d),...f)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}var o0t={kernelName:gx,backendName:"cpu",kernelFunc:W2n};N();var s0t={kernelName:E_,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:o,center:s}=t,a=n,l=A.getTypedArrayFromDType(r.dtype,A.sizeFromShape(r.shape)),[u,c,f,d]=r.shape,[p,m]=P.getImageCenter(s,c,f),h=255,g=Math.sin(i),x=Math.cos(i),b=a.data.get(r.dataId).values;for(let v=0;v<u;v++){let C=v*f*c*d;for(let _=0;_<c;_++){let S=_*(f*d);for(let E=0;E<f;E++){let T=E*d;for(let I=0;I<d;I++){let k=[u,_,E,I],O=k[2],F=k[1],B=(O-p)*x-(F-m)*g,M=(O-p)*g+(F-m)*x;B=Math.round(B+p),M=Math.round(M+m);let z=o;if(typeof o!="number"&&(I===3?z=h:z=o[I]),B>=0&&B<f&&M>=0&&M<c){let H=M*(f*d),Q=B*d,re=C+H+Q+I;z=b[re]}let W=C+S+T+I;l[W]=z}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};N();var G2n=wt(oh,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),a0t={kernelName:oh,backendName:"cpu",kernelFunc:G2n};N();function q2n(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:o}=t,{shape:s}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=P.calculateShapes(o,i,s),d=!0,p=n.bufferSync(i),m=n.bufferSync(o),h=hm(p,m,s,f,u,l,a,c,0,d);return n.makeTensorInfo(s,h.dtype,h.values)}var l0t={kernelName:u_,backendName:"cpu",kernelFunc:q2n};N();N();function H2n(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function Y2n(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function u0t(e,t,n,r,i,o){let s=A.getArrayFromDType("int32",n*i);for(let a=0;a<n;++a){let l=e.slice(a*r,(a+1)*r),u=a*i;for(let c=0;c<i;++c)s[u+c]=o==="left"?H2n(l,t[c+u]):Y2n(l,t[c+u])}return s}function K2n(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:o}=t,{side:s}=r,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,u=u0t(a,l,i.shape[0],i.shape[1],o.shape[1],s);return n.makeTensorInfo(o.shape,"int32",u)}var c0t={kernelName:f_,backendName:"cpu",kernelFunc:K2n};N();function X2n(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:o}=t;be([r,i,o],"select");let s=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=yi(i.dtype,o.dtype),f=A.makeZerosTypedArray(A.sizeFromShape(i.shape),c),d=0,p=s===0||s>1||i.shape.length===1?1:A.sizeFromShape(i.shape.slice(1));for(let m=0;m<a.length;m++)for(let h=0;h<p;h++)a[m]===1?f[d++]=l[m]:f[d++]=u[m];return n.makeTensorInfo(i.shape,c,f)}var f0t={kernelName:xx,backendName:"cpu",kernelFunc:X2n};N();var Z2n=P.SELU_SCALEALPHA,Q2n=P.SELU_SCALE,J2n=wt(ah,e=>e>=0?Q2n*e:Z2n*(Math.exp(e)-1)),d0t={kernelName:ah,backendName:"cpu",kernelFunc:J2n};N();var eAn=wt(ch,e=>e<0?-1:e>0?1:0),p0t={kernelName:ch,backendName:"cpu",kernelFunc:eAn};N();var tAn=wt(lh,e=>Math.sin(e)),m0t={kernelName:lh,backendName:"cpu",kernelFunc:tAn};N();var nAn=wt(uh,e=>Math.sinh(e)),h0t={kernelName:uh,backendName:"cpu",kernelFunc:nAn};N();var rAn=11920928955078125e-23,g0t=Math.log(rAn)+2,iAn=wt(dh,e=>{let t=e>-g0t,n=e<g0t,r=Math.exp(e),i;return n?i=r:t?i=e:i=Math.log(1+r),i}),x0t={kernelName:dh,backendName:"cpu",kernelFunc:iAn};N();function oAn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,paddings:s}=r;be([i],"spaceToBatchND");let a=A.sizeFromShape(o),l=[[0,0]];l.push(...s);for(let _=1+o.length;_<i.shape.length;++_)l.push([0,0]);let u=bQ.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),c=P.getReshaped(u.shape,o,a,!1),f=P.getPermuted(c.length,o.length,!1),d=P.getReshapedPermuted(u.shape,o,a,!1),h=ln({inputs:{x:u},backend:n,attrs:{shape:c}}),b=Kr({inputs:{x:h},backend:n,attrs:{perm:f}}),C=ln({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(b),C}var b0t={kernelName:vx,backendName:"cpu",kernelFunc:oAn};N();function sAn(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:o,defaultValue:s}=t;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);let a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values[0],[f,d,p,m,h]=sQ(a,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(g=>Number(g)))),n.makeTensorInfo([h.length],r.dtype,new Int32Array(h))]}var y0t={kernelName:d_,backendName:"cpu",kernelFunc:sAn};N();function aAn(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:o}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);let s=Array.from(n.data.get(i.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(o.dataId).values),[u,c,f]=aQ(a,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}var v0t={kernelName:p_,backendName:"cpu",kernelFunc:aAn};N();function lAn(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,[u,c]=PF(s,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}var w0t={kernelName:m_,backendName:"cpu",kernelFunc:lAn};N();function uAn(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,[u,c]=PF(s,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}var C0t={kernelName:h_,backendName:"cpu",kernelFunc:uAn};N();function cAn(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:o,defaultValue:s}=t,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:d}=P.calculateShapes(o,i,a),p=!1,m=n.bufferSync(i),h;switch(o.dtype){case"bool":{let g=n.bufferSync(o),x=!!n.data.get(s.dataId).values[0];h=hm(m,g,a,d,c,u,l,f,x,p);break}case"float32":{let g=n.bufferSync(o),x=n.data.get(s.dataId).values[0];h=hm(m,g,a,d,c,u,l,f,x,p);break}case"int32":{let g=n.bufferSync(o),x=n.data.get(s.dataId).values[0];h=hm(m,g,a,d,c,u,l,f,x,p);break}case"string":{let g=n.bufferSync(o),x=A.decodeString(n.data.get(s.dataId).values[0]);h=hm(m,g,a,d,c,u,l,f,x,p);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,h.dtype,h.values)}var _0t={kernelName:g_,backendName:"cpu",kernelFunc:cAn};N();N();function fAn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:o,axis:s}=r,a=A.parseAxisParam(s,i.shape)[0],l=P.prepareSplitSize(i,o,a),u=new Array(i.shape.length).fill(0),c=i.shape.slice();return l.map(f=>{let d=[...c];d[a]=f;let p=vd({inputs:{x:i},backend:n,attrs:{begin:u,size:d}});return u[a]+=f,p})}var S0t={kernelName:wx,backendName:"cpu",kernelFunc:fAn};N();var E0t={kernelName:x_,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;be(n,"square");let i=r.data.get(n.dataId).values,o=new Float32Array(i.length);for(let a=0;a<i.length;++a){let l=i[a];o[a]=l*l}return{dataId:r.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};N();var dAn=wt(bh,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),A0t={kernelName:bh,backendName:"cpu",kernelFunc:dAn};N();function pAn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,end:s,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:d}=r;be(i,"stridedSlice");let{finalShapeSparse:p,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:x,begin:b,end:y,strides:v}=so.sliceInfo(i.shape,o,s,a,l,u,c,f,d),C;if(h)C=ln({inputs:{x:i},backend:n,attrs:{shape:m}});else if(g||x){A.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let _=so.computeOutShape(b,y,v),S=vd({inputs:{x:i},backend:n,attrs:{begin:b,size:_}});C=ln({inputs:{x:S},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(S)}else{let _=n.bufferSync(i),S=lQ(p,_,v,b);C=n.makeTensorInfo(m,S.dtype,S.values)}return C}var T0t={kernelName:b_,backendName:"cpu",kernelFunc:pAn};N();function mAn(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:o,leftPad:s,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=t,d=n.data.get(c.dataId).values,p=n.data.get(f.dataId).values,[m,h]=uQ(d,p,i,o,s,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(f.shape,"int32",h)]}var k0t={kernelName:y_,backendName:"cpu",kernelFunc:mAn};N();function hAn(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:o,delimiter:s}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let a=n.data.get(o.dataId).values,l=n.data.get(s.dataId).values[0],[u,c,f]=cQ(a,l,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}var I0t={kernelName:v_,backendName:"cpu",kernelFunc:hAn};N();function gAn(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:o}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");let s=n.data.get(o.dataId).values,a=fQ(s,i);return n.makeTensorInfo(o.shape,"int32",a)}var D0t={kernelName:w_,backendName:"cpu",kernelFunc:gAn};N();var xAn=wt(gh,e=>Math.tan(e)),N0t={kernelName:gh,backendName:"cpu",kernelFunc:xAn};N();var bAn=wt(xh,e=>Math.tanh(e)),F0t={kernelName:xh,backendName:"cpu",kernelFunc:bAn};N();function yAn(e){let{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:o}=t,{sliceRank:s,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=P.calculateShapes(o,i,r.shape),f=!1,d=n.bufferSync(i),p=n.bufferSync(o),m=n.bufferSync(r),h=hm(d,p,r.shape,c,l,a,s,u,m,f);return n.makeTensorInfo(r.shape,h.dtype,h.values)}var R0t={kernelName:c_,backendName:"cpu",kernelFunc:yAn};N();function vAn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:o}=r;be(i,"tile");let s=dQ(n.bufferSync(i),o);return n.makeTensorInfo(s.shape,s.dtype,s.values)}var O0t={kernelName:Dd,backendName:"cpu",kernelFunc:vAn};N();function wAn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:o,sorted:s}=r;be(i,"topk");let a=n.data.get(i.dataId).values,[l,u]=pQ(a,i.shape,i.dtype,o,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}var M0t={kernelName:C_,backendName:"cpu",kernelFunc:wAn};N();function CAn(e){let{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:o}=t,{interpolation:s,fillMode:a,fillValue:l,outputShape:u}=n,[c,f,d,p]=i.shape,[m,h]=u??[f,d],g=[c,m,h,p],x=A.computeStrides(i.shape),b=x[0],y=x[1],v=x[2],C=A.computeStrides(g),_=C[0],S=C[1],E=C[2],T=A.getTypedArrayFromDType(i.dtype,A.sizeFromShape(g));T.fill(l);let I=r.data.get(i.dataId).values,k=r.data.get(o.dataId).values;for(let F=0;F<c;++F){let B=o.shape[0]===1?k:k.subarray(F*8,F*8+8);for(let M=0;M<m;++M)for(let z=0;z<h;++z)for(let W=0;W<p;++W){let H,Q=B[6]*z+B[7]*M+1;if(Q===0)continue;let re=(B[0]*z+B[1]*M+B[2])/Q,oe=(B[3]*z+B[4]*M+B[5])/Q,me=$0t(re,d,a),ge=$0t(oe,f,a);switch(s){case"nearest":H=TAn(I,f,d,b,y,v,F,ge,me,W,l);break;case"bilinear":H=kAn(I,f,d,b,y,v,F,ge,me,W,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}let ye=F*_+M*S+z*E+W;T[ye]=H}return r.makeTensorInfo(g,i.dtype,T)}return{dataId:r.write(T,g,i.dtype),shape:i.shape,dtype:i.dtype}}var P0t={kernelName:__,backendName:"cpu",kernelFunc:CAn};function $0t(e,t,n){switch(n){case"reflect":return _An(e,t);case"wrap":return SAn(e,t);case"nearest":return AAn(e,t);case"constant":default:return EAn(e,t)}}function _An(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{let r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return A.clamp(0,n,t-1)}function SAn(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{let r=t-1;n-=t*Math.trunc(n/r)}return A.clamp(0,n,t-1)}function EAn(e,t){return e}function AAn(e,t){return A.clamp(0,e,t-1)}function P4(e,t,n,r,i,o,s,a,l,u,c){let f=s*r+a*i+l*o+u;return 0<=a&&a<t&&0<=l&&l<n?e[f]:c}function TAn(e,t,n,r,i,o,s,a,l,u,c){let f=Math.round(a),d=Math.round(l);return P4(e,t,n,r,i,o,s,f,d,u,c)}function kAn(e,t,n,r,i,o,s,a,l,u,c){let f=Math.floor(a),d=Math.floor(l),p=f+1,m=d+1,h=(m-l)*P4(e,t,n,r,i,o,s,f,d,u,c)+(l-d)*P4(e,t,n,r,i,o,s,f,m,u,c),g=(m-l)*P4(e,t,n,r,i,o,s,p,d,u,c)+(l-d)*P4(e,t,n,r,i,o,s,p,m,u,c);return(p-a)*h+(a-f)*g}N();function IAn(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:o}=t;be(o,"unique");let s=r.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=mQ(s,i,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}var L0t={kernelName:S_,backendName:"cpu",kernelFunc:IAn};N();function DAn(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:o}=r;o<0&&(o+=i.shape.length);let s=i.shape.length,a=i.shape[o],l=new Array(s-1),u=0;for(let p=0;p<s;p++)p!==o&&(l[u++]=i.shape[p]);let c=new Array(s).fill(0),f=i.shape.slice();f[o]=1;let d=new Array(a);for(let p=0;p<d.length;p++){c[o]=p;let m=vd({inputs:{x:i},backend:n,attrs:{begin:c,size:f}});d[p]=ln({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return d}var B0t={kernelName:_x,backendName:"cpu",kernelFunc:DAn};N();function NAn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:o}=t,{numSegments:s}=r;be(i,"unsortedSegmentSum");let a=i.shape.length,l=o.shape.length,u=[],c=[],f=a-l,d=o;for(let m=0;m<f;++m){let h=BF({inputs:{input:d},backend:n,attrs:{dim:m+1}});d=h,c.push(h)}for(let m=0;m<s;++m){let h=A.createScalarValue(m,"int32"),g=n.makeTensorInfo([],"int32",h),x=g_e({inputs:{a:g,b:d},backend:n}),b=bd({inputs:{x},backend:n,attrs:{dtype:"float32"}}),y=uA({inputs:{a:b,b:i},backend:n}),v=my({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});u.push(v),c.push(g),c.push(x),c.push(b),c.push(y),c.push(v)}let p=Q_e({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}var z0t={kernelName:Sx,backendName:"cpu",kernelFunc:NAn};var FAn=[fht,ymt,dht,pht,Smt,mht,hht,ght,xht,bht,yht,vht,wht,Cht,_ht,Eht,Aht,Tht,kht,cht,Iht,Dht,Nht,Emt,Fht,_mt,Amt,Rht,vmt,Oht,$ht,Pht,Lht,Bht,zht,Uht,jht,Vht,Wht,Ght,qht,Hht,Yht,Kht,Xht,Zht,Qht,Jht,egt,tgt,ngt,rgt,ogt,iht,sgt,Tmt,agt,kmt,lgt,Imt,ugt,cgt,fgt,Dmt,Nmt,dgt,pgt,mgt,hgt,Fmt,Rmt,wmt,ggt,Mht,xgt,bgt,ygt,oht,Omt,Mmt,vgt,$mt,wgt,Cgt,_gt,Sgt,Egt,Agt,Tgt,Pmt,kgt,Igt,Dgt,Ngt,Rgt,Ogt,Mgt,Lmt,$gt,Pgt,zgt,Bmt,zmt,Ugt,jgt,Vgt,Umt,Wgt,Hgt,Ygt,bQ,Kgt,sht,Vmt,Xgt,Zgt,Qgt,Jgt,Cmt,O4,e0t,aht,lht,uht,t0t,n0t,r0t,i0t,o0t,s0t,a0t,Ymt,l0t,c0t,f0t,d0t,Xmt,p0t,m0t,h0t,Zmt,Lgt,x0t,b0t,y0t,v0t,w0t,C0t,_0t,S0t,Jmt,E0t,eht,tht,A0t,T0t,k0t,I0t,D0t,nht,igt,N0t,F0t,R0t,O0t,M0t,P0t,jmt,L0t,B0t,z0t,Ggt];for(let e of FAn)oT(e);N();N();N();N();var fA={},yQ={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function U0t(e,t){fA[e]=t}function Zu(e,t){if(!(e in fA)||t!=null){let r=OAn(e,t);if(r!==null)fA[e]=r;else return console.log("Could not get context for WebGL version",e),null}let n=fA[e];return n==null||n.isContextLost()?(delete fA[e],Zu(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),fA[e])}function RAn(e){if(!Z().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function OAn(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=t??RAn(e);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete fA[e]},!1),Z().getBool("SOFTWARE_WEBGL_ENABLED")&&(yQ.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",yQ)||n.getContext("experimental-webgl",yQ):n.getContext("webgl2",yQ)}N();var dA=function(e){return e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH",e}(dA||{}),fa=function(e){return e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD",e}(fa||{}),Bs=function(e){return e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16",e}(Bs||{});function pA(e,t){return[t,e]}function j0t(e,t){return e*t}function L4(e){let t=A.sizeFromShape(e),n=Math.ceil(t/4);return A.sizeToSquarishShape(n)}function g0(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function V0t(e,t){let[n,r]=g0(e,t);return n*r*4}function B4(e,t){let n=e,r,i,o,s,a,l,u,c,f,d;return Z().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,o=n.RGBA16F,s=n.RGBA32F,a=n.RED,u=4,c=1,f=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=e.RGBA,i=e.RGBA,o=e.RGBA,s=n.RGBA,a=e.RGBA,u=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:s,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}function We(e,t){let n=t();return Z().getBool("DEBUG")&&MAn(e),n}function MAn(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+LAn(e,t))}var $An=596e-10,PAn=65504;function W0t(e){return!!(Z().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||$An<Math.abs(e)&&Math.abs(e)<PAn)}function LAn(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function z4(e,t){return hy(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function G0t(e,t){let n=hy(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(We(e,()=>e.shaderSource(n,t)),We(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function q0t(e,t){let n=hy(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(We(e,()=>e.shaderSource(n,t)),We(e,()=>e.compileShader(n)),Z().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw rSe(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var BAn=/ERROR: [0-9]+:([0-9]+):/g;function rSe(e,t){let n=BAn.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],i=e.split(`
`),o=i.length.toString().length+2,s=i.map((f,d)=>A.rightPad((d+1).toString(),o)+f),a=0;for(let f=0;f<s.length;f++)a=Math.max(s[f].length,a);let l=s.slice(0,r-1),u=s.slice(r-1,r),c=s.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${A.rightPad(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function H0t(e){return hy(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function Y0t(e,t){if(We(e,()=>e.linkProgram(t)),!Z().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function wQ(e,t){if(We(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function K0t(e,t){let n=hy(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),We(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function X0t(e,t){let n=hy(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return We(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),We(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function Z0t(e){return hy(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function Q0t(e,t){let n=Z().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){let r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function J0t(e){return hy(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function iSe(e,t,n,r,i,o,s){let a=e.getAttribLocation(t,n);return a===-1?!1:(We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),We(e,()=>e.vertexAttribPointer(a,i,e.FLOAT,!1,o,s)),We(e,()=>e.enableVertexAttribArray(a)),!0)}function zAn(e,t,n){jAn(e,n),We(e,()=>e.activeTexture(e.TEXTURE0+n)),We(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function ext(e,t,n){return hy(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function txt(e,t,n){return e.getUniformLocation(t,n)}function nxt(e,t,n,r){We(e,()=>zAn(e,t,r)),We(e,()=>e.uniform1i(n,r))}function CQ(e,t,n){We(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),We(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function oSe(e,t){We(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),We(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function U4(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+UAn(e,t))}function UAn(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function hy(e,t,n){let r=We(e,()=>t());if(r==null)throw new Error(n);return r}function jAn(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Jw(e,t=2){return A.sizeFromShape(e.slice(0,e.length-t))}function eC(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function j4(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Jw(e),...eC(e)]),t}function rxt(e,t=!1){let n=Z().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Z().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Z().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((a,l)=>l>=e.length-2?A.nearestLargerEven(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=A.squeezeShape(e).newShape);let i=A.sizeFromShape(e),o=null;e.length<=1&&i<=n?o=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?o=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);let s=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(t?2:1)&&Math.min(...o)>0;if(o==null||s)if(t){let a=Jw(e),l=2,u=2;e.length&&([l,u]=eC(e)),i=a*(l/2)*(u/2),o=A.sizeToSquarishShape(i).map(c=>c*2)}else o=A.sizeToSquarishShape(i);return o}function vQ(e){return e%2===0}function mA(e,t){if(e=e.slice(-2),t=t.slice(-2),A.arraysEqual(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||vQ(n)&&vQ(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&vQ(e[0])&&vQ(t[0])}var eSe,tSe;function ixt(e){if(eSe==null){let t=Zu(e);eSe=t.getParameter(t.MAX_TEXTURE_SIZE)}return eSe}function oxt(e){if(tSe==null){let t=Zu(e);tSe=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,tSe)}function sxt(e){if(e===0)return 0;let t,n=Zu(e);return tf(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:tf(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function tf(e,t){return e.getExtension(t)!=null}function sSe(e){try{if(Zu(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function axt(e){if(e===0)return!1;let t=Zu(e);if(e===1){if(!tf(t,"OES_texture_float"))return!1}else if(!tf(t,"EXT_color_buffer_float"))return!1;return nSe(t)}function lxt(e){if(e===0)return!1;let t=Zu(e);if(e===1){if(!tf(t,"OES_texture_float")||!tf(t,"WEBGL_color_buffer_float"))return!1}else{if(tf(t,"EXT_color_buffer_float"))return nSe(t);let r="EXT_color_buffer_half_float";if(tf(t,r)){let i=t.getExtension(r);return VAn(t,i)}return!1}return nSe(t)}function nSe(e){let t=B4(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(o),s}function VAn(e,t){let n=B4(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(s),a}function uxt(e){return e!==2?!1:Zu(e).fenceSync!=null}function x0(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&A.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var pt=Z();pt.registerFlag("HAS_WEBGL",()=>pt.getNumber("WEBGL_VERSION")>0);pt.registerFlag("WEBGL_VERSION",()=>sSe(2)?2:sSe(1)?1:0);pt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);pt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>pt.get("WEBGL_VERSION")===2);pt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);pt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);pt.registerFlag("WEBGL_PACK",()=>pt.getBool("HAS_WEBGL"));pt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_CLIP",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_REDUCE",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_LAZILY_UNPACK",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_CONV_IM2COL",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>pt.getBool("WEBGL_PACK"));pt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>ixt(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>oxt(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=pt.getNumber("WEBGL_VERSION");return e===0?0:sxt(e)});pt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>pt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Ax.isMobile());pt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>axt(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>pt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:pt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));pt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>lxt(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>uxt(pt.getNumber("WEBGL_VERSION")));pt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>pt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);pt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});pt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Ax.isMobile()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});pt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);pt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);pt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);pt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);pt.registerFlag("WEBGL_EXP_CONV",()=>!1);pt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>pt.getBool("IS_TEST"));pt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);pt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);pt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);pt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);N();N();function Xr(){let e,t,n,r,i,o,s,a,l,u;return Z().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a=Z().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}N();N();N();function gm(e,t,n="index"){let r=A.computeStrides(t);return r.map((i,o)=>{let s=`int ${e[o]} = ${n} / ${i}`,a=o===r.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * ${i}`:`index -= ${e[o]} * ${i}`;return`${s}; ${a};`}).join("")}function hA(e,t,n="index"){let r=A.computeStrides(t);return r.map((i,o)=>{let s=`int ${e[o]} = ${n} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * outShapeStrides[${o}]`:`index -= ${e[o]} * outShapeStrides[${o}]`;return`${s}; ${a};`}).join("")}function WAn(e,t){let n=e.length,r=e.map(o=>`${t}[${o}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let o=n-3;o>=0;--o)i[o]=`(${i[o+1]} * ${r[o+1]})`;return i}function cxt(e,t,n="index"){let r=e.map((o,s)=>s),i=WAn(r,t);return i.map((o,s)=>{let a=`int ${e[s]} = ${n} / ${i[s]}`,l=s===i.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i[s]}`:`index -= ${e[s]} * ${i[s]}`;return`${a}; ${l};`}).join("")}function zF(e){let t=A.computeStrides(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function UF(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var SQ=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;var{getBroadcastDims:fxt}=P;function dxt(e,t,n){let r=[];if(e.forEach(p=>{let m=A.sizeFromShape(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){let{uniformShape:h}=EQ(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(h.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break;default:break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break;default:break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});let i=r.join(`
`),o=e.map(p=>GAn(p,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),s=t.texShape,a=Xr(),l=YAn(a),u,c,f=ZAn(a);return t.isPacked?(u=qAn(t.logicalShape,s,n.enableShapeUniforms),c=XAn(a)):(u=HAn(t.logicalShape,s,n.enableShapeUniforms),c=KAn(a)),n.packedInputs&&(f+=tTn),[f,l,c,i,u,o,n.userCode].join(`
`)}function VF(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return pTn(e,t);case 1:return hTn(e,t);case 2:return xTn(e,t);case 3:return yTn(e,t);case 4:return wTn(e,t);case 5:return CTn(e);case 6:return _Tn(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function pxt(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return dTn(e);case 1:return mTn(e,t);case 2:return gTn(e,t);case 3:return bTn(e,t);default:return vTn(e,t)}}function GAn(e,t,n=!1,r){let i="";n?i+=pxt(e,r):i+=VF(e,r);let o=e.shapeInfo.logicalShape,s=t.logicalShape;return o.length<=s.length&&(n?i+=STn(e,t):i+=ETn(e,t)),i}function qAn(e,t,n){switch(e.length){case 0:return mxt();case 1:return nTn(e,t,n);case 2:return cTn(e,t,n);case 3:return iTn(e,t,n);default:return sTn(e,t,n)}}function HAn(e,t,n){switch(e.length){case 0:return mxt();case 1:return rTn(e,t,n);case 2:return fTn(e,t,n);case 3:return oTn(e,t,n);case 4:return aTn(e,t,n);case 5:return lTn(e,t);case 6:return uTn(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function YAn(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function KAn(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function XAn(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function ZAn(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${QAn}
    ${JAn}
    ${eTn}
  `}var QAn=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,JAn=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,eTn=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tTn=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function mxt(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function nTn(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function rTn(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function iTn(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),o=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function oTn(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${hA(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;let r=gm(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function sTn(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),o=i*Math.ceil(e[e.length-2]/2),s=o,a="",l="b, r, c";for(let u=2;u<e.length-1;u++)s*=e[e.length-u-1],a=`
      int b${u} = index / ${s};
      index -= b${u} * ${s};
    `+a,l=`b${u}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${l});
    }
  `}function aTn(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${hA(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;let r=gm(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function lTn(e,t){let n=gm(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function uTn(e,t){let n=gm(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function cTn(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(A.arraysEqual(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function fTn(e,t,n){return A.arraysEqual(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function gA(e){return`offset${e}`}function dTn(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Xr();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function pTn(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;let[i,o]=e.shapeInfo.texShape;if(i===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;let s=gA(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});
      return sampleTexture(${n}, uv);
    }
  `;let[a,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${s});
      return sampleTexture(${n}, uv);
    }
  `}function mTn(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=Xr();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;let s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${s[0]}, ${s[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function hTn(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${WF(e)}
      }
    `;let i=e.shapeInfo.texShape,o=i[0],s=i[1];if(s===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;let a=gA(n);return s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${s}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function gTn(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=o[0],a=o[1],l=Xr();if(o!=null&&A.arraysEqual(n,o))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${s}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;let u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function xTn(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(o!=null&&A.arraysEqual(n,o)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let d=o[0],p=o[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:s,keptDims:a}=A.squeezeShape(n),l=s;if(l.length<n.length){let d=GF(e,l),p=["row","col"];return`
      ${VF(d,t)}
      float ${i}(int row, int col) {
        return ${i}(${qF(p,a)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${WF(e)}
      }
    `;let u=o[0],c=o[1],f=gA(r);return c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function bTn(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){let d=n.slice(1),p=[1,2],m=GF(e,d),h=["b","row","col"];return`
        ${pxt(m,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${qF(h,p)});
        }
      `}let a=Xr();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;let l=s[0],u=s[1],c=Math.ceil(n[2]/2),f=c*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function yTn(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],{newShape:a,keptDims:l}=A.squeezeShape(n),u=a;if(u.length<n.length){let h=GF(e,u),g=["row","col","depth"];return`
        ${VF(h,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${qF(g,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${s}, 1)));
        ${WF(e)}
      }
    `;let c=e.shapeInfo.texShape,f=c[0],d=c[1],p=e.shapeInfo.flatOffset;if(d===o&&p==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===s&&p==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;let m=gA(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${s} + depth + ${m};
        vec2 uv = uvFromFlat(${f}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function vTn(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=Xr();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;let o=e.shapeInfo.logicalShape,s=o.length,a=e.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],f=Math.ceil(o[s-1]/2),d=f*Math.ceil(o[s-2]/2),p="int b, int row, int col",m=`b * ${d} + (row / 2) * ${f} + (col / 2)`;for(let h=2;h<s-1;h++)p=`int b${h}, `+p,d*=o[s-h-1],m=`b${h} * ${d} + `+m;return`
    vec4 ${r}(${p}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${i.texture2D}(${n}, uv);
    }
  `}function wTn(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,a=n[1]*s,{newShape:l,keptDims:u}=A.squeezeShape(n);if(l.length<n.length){let b=GF(e,l),y=["row","col","depth","depth2"];return`
      ${VF(b,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${qF(y,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${s}, ${o}, 1)));
        ${WF(e)}
      }
    `;let c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],p=f[1],m=`int stride2 = ${r}Shape[3];`,h=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${m}
        ${h}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(p===o&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;let x=gA(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${h}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${x});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${s} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${d}, ${p}, index + ${x});
      return sampleTexture(${r}, uv);
    }
  `}function CTn(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],o=t[3]*i,s=t[2]*o,a=t[1]*s,{newShape:l,keptDims:u}=A.squeezeShape(t);if(l.length<t.length){let h=GF(e,l),g=["row","col","depth","depth2","depth3"];return`
      ${VF(h)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${qF(g,u)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${s}, ${o}, ${i})) +
          depth3;
        ${WF(e)}
      }
    `;let c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],p=f[1];if(p===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;let m=gA(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${s} + depth * ${o} +
          depth2 * ${i} + depth3 + ${m};
      vec2 uv = uvFromFlat(${d}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function _Tn(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:o}=A.squeezeShape(t);if(i.length<t.length){let g=GF(e,i),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${VF(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${qF(x,o)});
      }
    `}let s=t[5],a=t[4]*s,l=t[3]*a,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${WF(e)}
      }
    `;let f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],m=d[1];if(m===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===s&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;let h=gA(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${s} + depth4 + ${h};
      vec2 uv = uvFromFlat(${p}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function WF(e){let t=e.name,n=A.sizeFromShape(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function STn(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,a=fxt(e.shapeInfo.logicalShape,t.logicalShape),l=$t(s),u=s-o,c,f=["x","y","z","w","u","v"];o===0?c="":s<2&&a.length>=1?c="coords = 0;":c=a.map(b=>`coords.${f[b+u]} = 0;`).join(`
`);let d="";s<2&&o>0?d="coords":d=e.shapeInfo.logicalShape.map((b,y)=>`coords.${f[y+u]}`).join(", ");let p="return outputValue;",h=A.sizeFromShape(e.shapeInfo.logicalShape)===1,x=A.sizeFromShape(t.logicalShape)===1;if(o===1&&!h&&!x)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(h&&!x)s===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(a.length){let b=o-2,y=o-1;a.indexOf(b)>-1&&a.indexOf(y)>-1?p="return vec4(outputValue.x);":a.indexOf(b)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(y)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${d});
      ${p}
    }
  `}function ETn(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.texShape,s=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===l&&e.shapeInfo.flatOffset==null&&A.arraysEqual(s,o))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;let u=$t(l),c=fxt(e.shapeInfo.logicalShape,t.logicalShape),f=l-a,d,p=["x","y","z","w","u","v"];a===0?d="":l<2&&c.length>=1?d="coords = 0;":d=c.map(h=>`coords.${p[h+f]} = 0;`).join(`
`);let m="";return l<2&&a>0?m="coords":m=e.shapeInfo.logicalShape.map((h,g)=>`coords.${p[g+f]}`).join(", "),`
    float ${i}() {
      ${u} coords = getOutputCoords();
      ${d}
      return get${r}(${m});
    }
  `}function $t(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function EQ(e,t,n){let{newShape:r,keptDims:i}=A.squeezeShape(t),o=t.length,s=e&&o===3&&t[0]===1,a=s?t.slice(1):r,l=!e&&o>1&&!A.arraysEqual(t,n)&&r.length<o||s;return{useSqueezeShape:l,uniformShape:l?a:t,keptDims:i}}function GF(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function qF(e,t){return t.map(n=>e[n]).join(", ")}function gxt(e,t,n,r){let i=n.map((c,f)=>{let d={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(d.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:d}}),o=i.map(c=>c.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=dxt(i,s,t),l=q0t(e.gl,a),u=e.createProgram(l);return Z().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(u),Object.assign({program:t,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:s},aSe(e,t,u)))}function aSe(e,t,n){let r=[],i=[],o,s,a,l=null,u=null;u=e.getUniformLocation(n,"NAN",!1),Z().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));let c=!1;for(let f of t.variableNames){let d={name:f,uniform:e.getUniformLocation(n,f,c),offset:e.getUniformLocation(n,`offset${f}`,c)};t.enableShapeUniforms&&(d.shape=e.getUniformLocation(n,`${f}Shape`,c),d.texShape=e.getUniformLocation(n,`${f}TexShape`,c)),r.push(d)}if(t.enableShapeUniforms&&(o=e.getUniformLocation(n,"outShape",c),a=e.getUniformLocation(n,"outShapeStrides",c),s=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(let f of t.customUniforms)i.push(e.getUniformLocation(n,f.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:s}}function hxt(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{let i=n.logicalShape,o=t[r],s=o.shape;if(!A.arraysEqual(i,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${s} must match`);if(n.isUniform&&o.isUniform)return;let a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!A.arraysEqual(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function xxt(e,t,n,r,i){t.program.enableShapeUniforms||(hxt(t.inShapeInfos,n),hxt([t.outShapeInfo],[r]));let o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o.texture,s[0],s[1]):e.setOutputMatrixTexture(o.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),Z().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let u=n[l],{uniform:c,offset:f,shape:d,texShape:p}=t.variablesLocations[l];if(d){let{uniformShape:m}=EQ(t.program.packedInputs,u.shape,u.texData.texShape);switch(m.length){case 1:e.gl.uniform1iv(d,new Int32Array(m));break;case 2:e.gl.uniform2iv(d,new Int32Array(m));break;case 3:e.gl.uniform3iv(d,new Int32Array(m));break;case 4:e.gl.uniform4iv(d,new Int32Array(m));break;default:break}}if(p&&e.gl.uniform2i(p,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(A.sizeFromShape(u.shape)<2)e.gl.uniform1f(c,u.uniformValues[0]);else{let m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),e.gl.uniform1fv(c,m)}continue}u.texData.slice!=null&&f!=null&&e.gl.uniform1i(f,u.texData.slice.flatOffset),e.setInputMatrixTexture(u.texData.texture.texture,c,l)}}let a=t.outShapeLocation;if(a)switch(r.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(r.shape));break;default:break}if(t.outShapeStridesLocation){let l=A.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break;default:break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let l=0;l<t.program.customUniforms.length;++l){let u=t.program.customUniforms[l],c=t.customUniformLocations[l],f=i[l];if(u.type==="float")e.gl.uniform1fv(c,f);else if(u.type==="vec2")e.gl.uniform2fv(c,f);else if(u.type==="vec3")e.gl.uniform3fv(c,f);else if(u.type==="vec4")e.gl.uniform4fv(c,f);else if(u.type==="int")e.gl.uniform1iv(c,f);else if(u.type==="ivec2")e.gl.uniform2iv(c,f);else if(u.type==="ivec3")e.gl.uniform3iv(c,f);else if(u.type==="ivec4")e.gl.uniform4iv(c,f);else throw Error(`uniform type ${u.type} is not supported yet.`)}e.executeProgram()}function bxt(e,t,n){let r="";t.concat(n).forEach(s=>{let a=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!s.isUniform){let l=s.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:f}=EQ(e.packedInputs,s.shape,l),d="",p="",m="";if(c.length===1&&e.packedInputs){let C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!e.packedInputs)p=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){let C=A.computeStrides(c);m=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}let h=s.shape.length,g=c.length===2&&A.arraysEqual(s.shape,l),x=A.sizeFromShape(s.shape)===1,b=P.getBroadcastDims(s.shape,n.shape),y=!e.packedInputs&&h===n.shape.length&&A.arraysEqual(l,n.texData.texShape),v=e.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${h}_${y}_${u?f:""}_${c.length}_${x}_${b}_${g}_${d}_${p}_${m}_${v}_${a}`}else{let l=s.isUniform?"uniform":s.texData.texShape;r+=`${s.shape}_${l}_${a}`}});let i=e.userCode,o=e.constructor.name;return o+="_"+r+"_"+i+`${Z().getNumber("WEBGL_VERSION")}`,o}function Pn(e){return Z().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var AQ=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=dA.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=Xr();this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?hA(["r","c","d"],t):gm(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}};var TQ=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=dA.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=Xr();this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?hA(["r","c","d"],t):gm(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}};var kQ=class{constructor(t){this.variableNames=["A"],this.outTexUsage=fa.DOWNLOAD;let n=Xr();this.outputShape=t,this.userCode=`
      ${SQ}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}};var IQ=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=fa.DOWNLOAD;let n=Xr();this.outputShape=t,this.userCode=`
      ${SQ}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}};var kTn={R:0,G:1,B:2,A:3},V4=class{constructor(t,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let i=Xr();this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let s="";for(let a=0;a<r.length;a++){let l=r[a];s+=`
          if(offset == ${a}) {
            result = values[${kTn[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?UF():zF(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${s}
        }
        ${i.output} = vec4(${o}, 0., 0., 0.);
      }
    `}};var DQ=class{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=Xr();this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length);let i="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let a=0;a<=1;a++){let l=s*2+a;i+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${s};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?UF():zF(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${o};
        }
    `}};N();N();function yxt(e){let t=Xr(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return G0t(e,n)}function vxt(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return K0t(e,t)}function wxt(e){let t=new Uint16Array([0,1,2,2,1,3]);return X0t(e,t)}function W4(e,t,n,r,i,o){Q0t(t,n);let s=Z0t(e),a=e.TEXTURE_2D;return We(e,()=>e.bindTexture(a,s)),We(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),We(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),We(e,()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)),We(e,()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST)),Z().getNumber("WEBGL_VERSION")===1?We(e,()=>e.texImage2D(a,0,r,t,n,0,i,o,null)):We(e,()=>e.texStorage2D(a,1,r,t,n)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function lSe(e){return e.internalFormatFloat}function Cxt(e,t,n,r){let[i,o]=pA(t,n);return W4(e,i,o,lSe(r),r.textureFormatFloat,e.FLOAT)}function uSe(e){return e.internalFormatHalfFloat}function _xt(e,t,n,r){let[i,o]=pA(t,n);return W4(e,i,o,uSe(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function cSe(e){return e.downloadTextureFormat}function Sxt(e,t,n,r){let[i,o]=pA(t,n);return W4(e,i,o,cSe(r),e.RGBA,e.UNSIGNED_BYTE)}function fSe(e){return e.internalFormatPackedFloat}function Ext(e,t,n,r){let[i,o]=g0(t,n);return W4(e,i,o,fSe(r),e.RGBA,e.FLOAT)}function dSe(e){return e.internalFormatPackedHalfFloat}function Axt(e,t,n,r){let[i,o]=g0(t,n);return W4(e,i,o,dSe(r),e.RGBA,r.textureTypeHalfFloat)}function Txt(e,t,n){return We(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),iSe(e,t,"clipSpacePos",n,3,20,0)&&iSe(e,t,"uv",n,2,20,12)}function kxt(e,t,n,r,i,o){We(e,()=>e.bindTexture(e.TEXTURE_2D,t));let s,a,l;i instanceof Uint8Array?(s=new Uint8Array(n*r*4),a=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*r*4),a=e.FLOAT,l=o.internalFormatPackedFloat),s.set(i),Z().getNumber("WEBGL_VERSION")===2?We(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,a,s)):We(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,a,s)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function Ixt(e,t,n){We(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?Z().getNumber("WEBGL_VERSION")===2?We(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):We(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):Z().getNumber("WEBGL_VERSION")===2?We(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):We(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),We(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function Dxt(e,t,n,r){let i=e.createBuffer();We(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));let a=4*4*t*n;return We(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),We(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),We(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function Nxt(e,t,n){let r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function Fxt(e,t,n,r){let[i,o]=pA(t,n),s=4,a=new Uint8Array(j0t(t*n,s));return We(e,()=>e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Rxt(e,t,n,r,i,o,s,a){let l=e,u=new Float32Array(V0t(o,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Oxt(e,t,n){let r=new Float32Array(t*n*4);return We(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}var HF=class{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let n=Z().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,U0t(n,t)):this.gl=Zu(n),t=this.gl,Z().getNumber("WEBGL_VERSION")===2){let o=t;this.createVertexArray=()=>We(o,()=>o.createVertexArray()),this.bindVertexArray=s=>We(o,()=>o.bindVertexArray(s)),this.deleteVertexArray=s=>We(o,()=>o.deleteVertexArray(s)),this.getVertexArray=()=>We(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(t!=null){let o=t.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>We(t,()=>o.createVertexArrayOES()),this.bindVertexArray=s=>We(t,()=>o.bindVertexArrayOES(s)),this.deleteVertexArray=s=>We(t,()=>o.deleteVertexArrayOES(s)),this.getVertexArray=()=>We(t,()=>t.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float",i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Z().getNumber("WEBGL_VERSION")===1){let o="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=z4(this.gl,o),tf(this.gl,s))this.textureHalfFloatExtension=z4(this.gl,s);else if(Z().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),tf(this.gl,i))this.colorBufferHalfFloatExtension=z4(this.gl,i);else if(Z().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",tf(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(tf(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=vxt(this.gl),this.indexBuffer=wxt(this.gl),this.framebuffer=J0t(this.gl),this.textureConfig=B4(this.gl,this.textureHalfFloatExtension)}get debug(){return Z().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let t=this.gl;We(t,()=>t.finish()),We(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),We(t,()=>t.deleteFramebuffer(this.framebuffer)),We(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),We(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),We(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),Cxt(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),_xt(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),Sxt(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),Ixt(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,r,i){this.throwIfDisposed(),kxt(this.gl,t,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),Axt(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),Ext(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(oSe(this.gl,this.framebuffer),this.outputTexture=null),We(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,r){return this.downloadMatrixDriver(t,()=>Fxt(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,r,i,o,s){return Rxt(this.gl,t,n,r,i,o,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return Nxt(this.gl,t,n)}createBufferFromTexture(t,n,r){this.bindTextureToFrameBuffer(t);let i=Dxt(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){let t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,r;if(Z().getBool("WEBGL_FENCE_API_ENABLED")){let i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{let s=i.clientWaitSync(o,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=o}else Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(t,n,r){return this.downloadMatrixDriver(t,()=>Oxt(this.gl,n,r))}createProgram(t){this.throwIfDisposed();let n=this.gl;this.vertexShader==null&&(this.vertexShader=yxt(n));let r=H0t(n);We(n,()=>n.attachShader(r,this.vertexShader)),We(n,()=>n.attachShader(r,t)),Y0t(n,r);let i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&wQ(n,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);let n=this.gl;We(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Txt(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(We(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&wQ(this.gl,this.program),We(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,r=!0){return this.throwIfDisposed(),r?ext(this.gl,t,n):txt(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),We(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),nxt(this.gl,t,n,r)}setOutputMatrixTexture(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)}setOutputPackedMatrixTexture(t,n,r){this.throwIfDisposed();let[i,o]=g0(n,r);this.setOutputMatrixTextureDriver(t,i,o)}setOutputMatrixWriteRegion(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&wQ(this.gl,this.program),U4(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let t=this.gl;if(this.debug){let n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}We(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),We(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=z4(this.gl,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,o),o}let t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}let t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){return te(this,null,function*(){return yield A.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(t,n){if(n===0)return null;if(n===2){let r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{let r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){let r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{let r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){let t=DTn(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){let{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Z().platform&&(r=Z().platform.setTimeoutCustom.bind(Z().platform)),A.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),CQ(this.gl,t,this.framebuffer),this.debug&&U4(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(CQ(this.gl,this.outputTexture,this.framebuffer),this.debug&&U4(this.gl)):oSe(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);let r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,n,r){this.throwIfDisposed();let i=this.gl;CQ(i,t,this.framebuffer),this.debug&&U4(i),this.outputTexture=t,We(i,()=>i.viewport(0,0,n,r)),We(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(t,n,r,i){this.throwIfDisposed(),We(this.gl,()=>this.gl.scissor(t,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function DTn(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:Mxt,bincountImpl:NQ,bincountReduceImpl:$xt,bitwiseAndImpl:Pxt,castImpl:Lxt,ceilImpl:Bxt,concatImpl:zxt,equalImpl:Uxt,expImpl:jxt,expm1Impl:Vxt,floorImpl:Wxt,gatherNdImpl:Gxt,gatherV2Impl:qxt,greaterImpl:Hxt,greaterEqualImpl:Yxt,lessImpl:Kxt,lessEqualImpl:Xxt,linSpaceImpl:Zxt,logImpl:Qxt,maxImpl:Jxt,maximumImpl:ebt,minimumImpl:tbt,multiplyImpl:nbt,negImpl:rbt,notEqualImpl:ibt,prodImpl:obt,raggedGatherImpl:sbt,raggedRangeImpl:abt,raggedTensorToTensorImpl:lbt,rangeImpl:ubt,rsqrtImpl:cbt,scatterImpl:fbt,sigmoidImpl:dbt,simpleAbsImpl:FQ,sliceImpl:pbt,sparseFillEmptyRowsImpl:mbt,sparseReshapeImpl:hbt,sparseSegmentReductionImpl:RQ,sqrtImpl:gbt,staticRegexReplaceImpl:xbt,stridedSliceImpl:bbt,stringNGramsImpl:ybt,stringSplitImpl:vbt,stringToHashBucketFastImpl:wbt,subImpl:Cbt,tileImpl:_bt,topKImpl:Sbt,transposeImpl:xA,uniqueImpl:Ebt}=z_e;function pSe(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function hi(e,t){return t===1?[e]:pSe(e,t)}function Abt(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}var OQ=class{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Pn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let n=hi("rc",this.rank),r=$t(this.rank),i=this.getOutOfBoundsCondition(n),o=this.getSetup(n),s=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${s}));
          }
        }
      `}}getSourceCoordsArr(t){let n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let o=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let s=2;s<this.rank;s++)o=`${t[t.length-1-s]},`+o;n.push(o)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";let n=t.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){let n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}};var YF=class{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length);let r="";for(let i=0;i<4;i++){let o="thisRC = rc;";i%2===1&&(o+="thisRC.z += 1;"),i>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${NTn(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?UF():zF(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${r}

        setOutput(result);
      }
    `}};function NTn(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?cxt(["r","c","d"],"inputShape"):gm(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}N();var MQ=class{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,r){let i=kbt(n,r),o=Ibt(t,i,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);let s=Tbt(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return i===Bs.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Bs.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Bs.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Bs.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Bs.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),a}releaseTexture(t,n,r,i){if(this.freeTextures==null)return;let o=kbt(r,i),s=Ibt(n,o,i);s in this.freeTextures||(this.freeTextures[s]=[]);let a=Tbt(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=Z().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[s].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;let u=this.usedTextures[s],c=u&&u.indexOf(t);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;let t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);let n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(let t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function FTn(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function Tbt(e,t,n,r,i){let o=RTn(t,r),s;if(i){let[l,u]=g0(e[0],e[1]);s=l*u}else{let[l,u]=pA(e[0],e[1]);s=l*u}let a=FTn(n,o);return s*a}function RTn(e,t){switch(e){case Bs.PACKED_2X2_FLOAT32:return fSe(t);case Bs.PACKED_2X2_FLOAT16:return dSe(t);case Bs.UNPACKED_FLOAT32:return lSe(t);case Bs.UNPACKED_FLOAT16:return uSe(t);case Bs.PACKED_4X1_UNSIGNED_BYTE:return cSe(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function OTn(e){return Z().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Bs.PACKED_2X2_FLOAT32:Bs.UNPACKED_FLOAT32:e?Bs.PACKED_2X2_FLOAT16:Bs.UNPACKED_FLOAT16}function kbt(e,t){if(e===fa.UPLOAD)return Bs.PACKED_2X2_FLOAT32;if(e===fa.RENDER||e==null)return OTn(t);if(e===fa.DOWNLOAD||e===fa.PIXELS)return Bs.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function Ibt(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}var is=class{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},Xi="if (isnan(x)) return x;",Dbt="return x;",mSe="return abs(x);";var Nbt="return (x >= 0.0) ? x : (exp(x) - 1.0);",Fbt=Xi+`
  return (x < 0.0) ? 0.0 : x;
`,Rbt=Xi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,b0="return x;",Obt="return 1.0 / (1.0 + exp(-1.0 * x));";var $bt="return x;",Pbt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Lbt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Bbt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zbt="return 1.0 / (1.0 + exp(-1.0 * x));",Gl=class{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}};var $Q=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length);let n=t.length,r=hi("rc",n),i=$t(n),o=Abt(n,r),s=r.slice(-2),a=n<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}};var $Tn=Ko.whereImpl,PTn=1e-7,LTn=1e-4,PQ={};function BTn(e){return e in PQ||(PQ[e]={}),PQ[e]}var zTn=Z().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),UTn=600;function jTn(){return Z().global.screen==null?1024:Z().global.screen.height*Z().global.screen.width*window.devicePixelRatio*UTn/1024/1024}var Ubt=(()=>{class e extends Sm{nextDataId(){return e.nextDataId++}constructor(n){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Z().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let r;if(n!=null){if(n instanceof HF)r=n;else{let i=Zu(Z().getNumber("WEBGL_VERSION"),n);r=new HF(i)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let i=Zu(Z().getNumber("WEBGL_VERSION"));r=new HF(i),this.binaryCache=BTn(Z().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=r,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new MQ(this.gpgpu),this.numMBBeforeWarning=jTn(),this.texData=new Ry(this,uc())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(n,r,i,o,s,a){let l=this.makeTensorInfo(r,i),u=this.texData.get(l.dataId);u.isPacked=!1,u.texture={texture:n,texShape:[o,s]},u.texShape=[o,s];let c=j4(r),f=new V4(c,!1,a),d=this.runWebGLProgram(f,[l],i,[[o,s]]);return d.shape=r,u.texture=null,this.disposeIntermediateTensorInfo(l),d.dataId}write(n,r,i){if((Z().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Z().getBool("DEBUG"))&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let o={id:this.nextDataId()};return this.texData.set(o,{shape:r,dtype:i,values:n,usage:fa.UPLOAD,refCount:1}),o}refCount(n){return this.texData.has(n)?this.texData.get(n).refCount:0}incRef(n){let r=this.texData.get(n);r.refCount++}decRef(n){if(this.texData.has(n)){let r=this.texData.get(n);r.refCount--}}move(n,r,i,o,s){if(Z().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:o,values:r,usage:fa.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(n){this.disposeData(n.dataId)}readSync(n){let r=this.texData.get(n),{values:i,dtype:o,complexTensorInfos:s,slice:a,shape:l,isPacked:u}=r;if(a!=null){let p;u?p=new Gl(l,b0):p=new is(l,b0);let m=this.runWebGLProgram(p,[{dataId:n,shape:l,dtype:o}],o),h=this.readSync(m.dataId);return this.disposeIntermediateTensorInfo(m),h}if(i!=null)return this.convertAndCacheOnCPU(n);if(o==="string")return i;let c=this.activeTimers!=null,f;c&&(f=A.now());let d;if(o==="complex64"){let p=this.readSync(s.real.dataId),m=this.readSync(s.imag.dataId);d=P.mergeRealAndImagArrays(p,m)}else d=this.getValuesFromTexture(n);return c&&(this.downloadWaitMs+=A.now()-f),this.convertAndCacheOnCPU(n,d)}read(n){return te(this,null,function*(){if(this.pendingRead.has(n)){let h=this.pendingRead.get(n);return new Promise(g=>h.push(g))}let r=this.texData.get(n),{values:i,shape:o,slice:s,dtype:a,complexTensorInfos:l,isPacked:u}=r;if(s!=null){let h;u?h=new Gl(o,b0):h=new is(o,b0);let g=this.runWebGLProgram(h,[{dataId:n,shape:o,dtype:a}],a),x=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),x}if(i!=null)return this.convertAndCacheOnCPU(n);if(Z().getBool("DEBUG")&&!Z().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Z().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,f;if(a!=="complex64"&&Z().get("WEBGL_BUFFER_SUPPORTED")){f=this.decode(n);let h=this.texData.get(f.dataId);c=this.gpgpu.createBufferFromTexture(h.texture.texture,...L4(o))}this.pendingRead.set(n,[]),a!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let d;if(a==="complex64"){let h=yield Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),g=h[0],x=h[1];d=P.mergeRealAndImagArrays(g,x)}else if(c==null)d=this.getValuesFromTexture(n);else{let h=A.sizeFromShape(o);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,h)}if(f!=null&&this.disposeIntermediateTensorInfo(f),c!=null){let h=this.gpgpu.gl;We(h,()=>h.deleteBuffer(c))}let p=this.convertAndCacheOnCPU(n,d),m=this.pendingRead.get(n);return this.pendingRead.delete(n),m.forEach(h=>h(p)),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n)&&uc().removeDataId(n,this),this.pendingDeletes--),p})}readToGPU(n,r={}){let i=this.texData.get(n),{values:o,shape:s,slice:a,dtype:l,isPacked:u,texture:c}=i;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let m;u?m=new Gl(s,b0):m=new is(s,b0);let h=this.runWebGLProgram(m,[{dataId:n,shape:s,dtype:l}],l),g=this.readToGPU(h,r);return this.disposeIntermediateTensorInfo(h),g}if(c==null)throw o!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let f=this.decode(n,r.customTexShape),d=uc().makeTensorFromTensorInfo(f),p=this.texData.get(f.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(n){let r=this.readSync(n.dataId);if(n.dtype==="string")try{let i=r.map(o=>A.decodeString(o));return et(n.shape,n.dtype,i)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return et(n.shape,n.dtype,r)}checkNumericalProblems(n){if(n!=null)for(let r=0;r<n.length;r++){let i=n[r];if(!W0t(i))throw Z().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${i} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${i} cannot be represented on this device.`)}}getValuesFromTexture(n){let{shape:r,dtype:i,isPacked:o}=this.texData.get(n),s=A.sizeFromShape(r);if(Z().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let p=this.decode(n),m=this.texData.get(p.dataId),h=this.gpgpu.downloadMatrixFromPackedTexture(m.texture.texture,...L4(r)).subarray(0,s);return this.disposeIntermediateTensorInfo(p),h}let a=Z().getBool("WEBGL_PACK")&&o===!0,l=a?j4(r):r,u=a?new IQ(l):new kQ(l),c=this.runWebGLProgram(u,[{shape:l,dtype:i,dataId:n}],"float32"),f=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture.texture,f.texShape[0],f.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(n){let r=this.activeTimers,i=[],o=!1;this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,n();let s=A.flatten(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),a=A.flatten(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=r,o&&(this.programTimersStack=null);let l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return te(this,null,function*(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let u=yield Promise.all(s);l.kernelMs=A.sum(u),l.getExtraProfileInfo=()=>u.map((c,f)=>({name:a[f],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:A.now(),endMs:null}}endTimer(n){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=A.now(),n)}getQueryTime(n){return te(this,null,function*(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(n);let r=n;return r.endMs-r.startMs})}disposeData(n,r=!1){if(this.pendingDisposal.has(n))return!1;if(!this.texData.has(n))return!0;if(r?this.texData.get(n).refCount=0:this.texData.get(n).refCount--,!r&&this.texData.get(n).refCount>0)return!1;if(this.pendingRead.has(n))return this.pendingDisposal.add(n),this.pendingDeletes++,!1;this.releaseGPUData(n);let{complexTensorInfos:i}=this.texData.get(n);return i!=null&&(this.disposeData(i.real.dataId,r),this.disposeData(i.imag.dataId,r)),this.texData.delete(n),!0}releaseGPUData(n){let{texture:r,dtype:i,texShape:o,usage:s,isPacked:a,slice:l}=this.texData.get(n),u=l&&l.origDataId||n,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),r!=null&&(this.numBytesInGPU-=this.computeBytes(o,i),this.textureManager.releaseTexture(r,o,s,a)));let f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null}getTexture(n){return this.uploadToGPU(n),this.texData.get(n).texture.texture}getDataInfo(n){return this.texData.get(n)}shouldExecuteOnCPU(n,r=zTn){return Z().getBool("WEBGL_CPU_FORWARD")&&n.every(i=>this.texData.get(i.dataId).texture==null&&A.sizeFromShape(i.shape)<r)}getGPGPUContext(){return this.gpgpu}where(n){P.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let r=n.dataSync();return $Tn(n.shape,r)}packedUnaryOp(n,r,i){let o=new Gl(n.shape,r),s=this.compileAndRun(o,[n],i);return uc().makeTensorFromTensorInfo(s)}abs(n){if(this.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){let o=FQ(this.texData.get(n.dataId).values);return this.makeOutput(n.shape,n.dtype,o)}if(Z().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,mSe,n.dtype);let r=new is(n.shape,mSe),i=this.compileAndRun(r,[n]);return uc().makeTensorFromTensorInfo(i)}makeTensorInfo(n,r,i){let o;if(r==="string"&&i!=null&&i.length>0&&A.isString(i[0])){let s=i.map(a=>A.encodeString(a));o=this.write(s,n,r)}else o=this.write(i,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}}makeOutput(n,r,i){return uc().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,i),this)}unpackTensor(n){let r=new $Q(n.shape);return this.runWebGLProgram(r,[n],n.dtype)}packTensor(n){let r=new OQ(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)}packedReshape(n,r){let i=[Jw(n.shape),...eC(n.shape)],o={dtype:n.dtype,shape:i,dataId:n.dataId},s=[Jw(r),...eC(r)],a=new YF(s,i),l=!0,u=[i],c=this.runWebGLProgram(a,[o],n.dtype,u,l);return{dataId:c.dataId,shape:r,dtype:c.dtype}}decode(n,r){let i=this.texData.get(n),{isPacked:o,shape:s,dtype:a}=i;if(r!=null){let p=A.sizeFromShape(s),m=r[0]*r[1]*4;A.assert(p<=m,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let l=j4(s),u;o?u=new TQ(l):u=new AQ(l);let c=!0,f=[r??L4(l)],d=this.runWebGLProgram(u,[{shape:l,dtype:a,dataId:n}],a,f,c,r);return{dtype:a,shape:s,dataId:d.dataId}}runWebGLProgram(n,r,i,o,s=!1,a){let l=this.makeTensorInfo(n.outputShape,i),u=this.texData.get(l.dataId);if(n.packedOutput&&(u.isPacked=!0),n.outPackingScheme===dA.DENSE){let b=a??L4(n.outputShape);u.texShape=b.map(y=>y*2)}if(n.outTexUsage!=null&&(u.usage=n.outTexUsage),A.sizeFromShape(l.shape)===0)return u.values=A.getTypedArrayFromDType(l.dtype,0),l;let c=[],f=r.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(b.dataId);if(y.texture==null){if(!n.packedInputs&&A.sizeFromShape(b.shape)<=Z().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:y.values};n.packedInputs&&(y.isPacked=!0,y.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!y.isPacked!=!!n.packedInputs)b=y.isPacked?this.unpackTensor(b):this.packTensor(b),c.push(b),y=this.texData.get(b.dataId);else if(y.isPacked&&!mA(y.shape,b.shape)){let v=b,C=b.shape;b.shape=y.shape,b=this.packedReshape(b,C),c.push(b),y=this.texData.get(b.dataId),v.shape=C}return{shape:b.shape,texData:y,isUniform:!1}});this.uploadToGPU(l.dataId);let d={shape:l.shape,texData:u,isUniform:!1},p=bxt(n,f,d),m=this.getAndSaveBinary(p,()=>gxt(this.gpgpu,n,f,d)),h=this.activeTimers!=null,g;h&&(g=this.startTimer()),Z().get("ENGINE_COMPILE_ONLY")||xxt(this.gpgpu,m,f,d,o),c.forEach(b=>this.disposeIntermediateTensorInfo(b)),h&&(g=this.endTimer(g),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(g)}));let x=Z().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){let b=A.now();b-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!Z().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&s===!1){let b=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),b}return l}compileAndRun(n,r,i,o,s=!1){return i=i||r[0].dtype,this.runWebGLProgram(n,r,i,o,s)}getAndSaveBinary(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Z().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(r=>{this.gpgpu.deleteProgram(this.binaryCache[r].webGLProgram),delete this.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ee(()=>{if(!Z().get("WEBGL_RENDER_FLOAT32_ENABLED")){let n=Z().getBool("DEBUG");Z().set("DEBUG",!1);let r=this.abs(Pe(1e-8)).dataSync()[0];if(Z().set("DEBUG",n),r>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?PTn:LTn}uploadToGPU(n){let r=this.texData.get(n),{shape:i,dtype:o,values:s,texture:a,usage:l,isPacked:u}=r;if(a!=null)return;let c=this.activeTimers!=null,f;c&&(f=A.now());let d=r.texShape;if(d==null&&(d=rxt(i,u),r.texShape=d),s!=null){let p=j4(i),m,h=d[1],g=d[0],x=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(u||!x)&&([h,g]=g0(d[0],d[1])),u?m=new DQ(p,x):m=new V4(p,x);let b=x?[g,h]:d,y=this.makeTensorInfo(b,o),v=this.texData.get(y.dataId);x?v.usage=fa.PIXELS:v.usage=fa.UPLOAD,v.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),h,g,s);let C=[[g,h]],S=this.runWebGLProgram(m,[y],o,C,!0),E=this.texData.get(S.dataId);r.texShape=E.texShape,r.isPacked=E.isPacked,r.usage=E.usage,Z().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(r.texture=E.texture,r.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=A.now()-f)}else{let p=this.acquireTexture(d,l,o,u);r.texture=p}}convertAndCacheOnCPU(n,r){let i=this.texData.get(n),{dtype:o}=i;return r!=null&&(i.values=VTn(r,o)),i.values}acquireTexture(n,r,i,o){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(n,r,o)}computeBytes(n,r){return n[0]*n[1]*A.bytesPerElement(r)}checkCompileCompletion(){for(let[,n]of Object.entries(this.binaryCache))this.checkCompletion_(n)}checkCompileCompletionAsync(){return te(this,null,function*(){let n=[];if(this.gpgpu.parallelCompilationExtension){for(let[,r]of Object.entries(this.binaryCache))n.push(this.checkCompletionAsync_(r));return Promise.all(n)}else{for(let[,r]of Object.entries(this.binaryCache)){let i=new Promise(o=>{try{this.checkCompletion_(r),o(!0)}catch(s){throw s}});n.push(i)}return Promise.all(n)}})}checkCompletionAsync_(n){return te(this,null,function*(){return this.gpgpu.gl.getProgramParameter(n.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(n):(yield ik(),this.checkCompletionAsync_(n))})}checkCompletion_(n){if(this.gpgpu.gl.getProgramParameter(n.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(n.webGLProgram)),this.gpgpu.gl.getShaderParameter(n.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(rSe(n.source,this.gpgpu.gl.getShaderInfoLog(n.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let n of Object.values(this.binaryCache)){this.gpgpu.buildVao(n.webGLProgram);let{variablesLocations:r,customUniformLocations:i,infLoc:o,nanLoc:s,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:u}=aSe(this.gpgpu,n.program,n.webGLProgram);n.variablesLocations=r,n.customUniformLocations=i,n.infLoc=o,n.nanLoc=s,n.outShapeLocation=a,n.outShapeStridesLocation=l,n.outTexShapeLocation=u}}createTensorFromGPUData(n,r,i){n.channels=n.channels||"RGBA";let{texture:o,height:s,width:a,channels:l}=n,u=uc().backend;if(!u.gpgpu.gl.isTexture(o))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let c=u.writeTexture(o,r,i,s,a,l);return uc().makeTensorFromDataId(c,r,i,u)}}return e.nextDataId=0,e})();function VTn(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){let n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}Ax.isBrowser()&&iO("webgl",()=>new Ubt,2);N();N();N();N();N();var KF=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;var ql=class{constructor(t,n,r){this.variableNames=["A","B"],this.outputShape=P.assertAndGetBroadcastShape(n,r),this.enableShapeUniforms=Pn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}};N();var Ju=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;var Qu=class{constructor(t,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=P.assertAndGetBroadcastShape(n,r);let o=this.outputShape.length;this.enableShapeUniforms=Pn(o);let s="";if(i)if(o===0||A.sizeFromShape(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${$t(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?s+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let l=hi("coords",o);this.enableShapeUniforms?s+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:s+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}};N();N();function gi(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var jbt={kernelName:Id,backendName:"webgl",kernelFunc:gi};function Hl(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,o=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(o.dataId),a=gi({inputs:{x:r},backend:n}),l=gi({inputs:{x:i},backend:n});return s.complexTensorInfos={real:a,imag:l},o}var Vbt={kernelName:kC,backendName:"webgl",kernelFunc:Hl};N();var hSe="return (a < 0.) ? b * a : a;",gSe=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function WTn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:o}=r,s=n.makeTensorInfo([],"float32",A.createScalarValue(o,"float32")),a=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qu(gSe,i.shape,s.shape):new ql(hSe,i.shape,s.shape),l=n.runWebGLProgram(a,[i,s],"float32");return n.disposeIntermediateTensorInfo(s),l}var Wbt={kernelName:Q0,backendName:"webgl",kernelFunc:WTn};N();var xSe="return (a < 0.) ? b * a : a;",bSe=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function GTn(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t,o=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qu(bSe,r.shape,i.shape):new ql(xSe,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],"float32")}var Gbt={kernelName:fx,backendName:"webgl",kernelFunc:GTn};var wd="if (isnan(x)) return x;";function tt({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:o})=>{let{x:s}=i,a=o,l=r||s.dtype;if(a.shouldExecuteOnCPU([s])&&n!=null){let f=a.texData.get(s.dataId),d=n(f.values,l);return a.makeTensorInfo(s.shape,l,d)}let u=Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,c;return u?c=new Gl(s.shape,t):c=new is(s.shape,e),a.runWebGLProgram(c,[s],l)}}function Tn({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:o}){return({inputs:s,backend:a})=>{let{a:l,b:u}=s,c=a;if(r&&l.dtype==="complex64"){let m=c.texData.get(l.dataId),h=c.texData.get(u.dataId),[g,x]=[[m.complexTensorInfos.real,h.complexTensorInfos.real],[m.complexTensorInfos.imag,h.complexTensorInfos.imag]].map(y=>{let[v,C]=y,_={dataId:v.dataId,dtype:v.dtype,shape:l.shape},S={dataId:C.dataId,dtype:C.dtype,shape:u.shape},E=new ql(e,l.shape,u.shape);return c.runWebGLProgram(E,[_,S],yi(v.dtype,C.dtype))}),b=Hl({inputs:{real:g,imag:x},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(x),b}let f=o||yi(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&i!=null){let m=c.texData.get(l.dataId).values,h=c.texData.get(u.dataId).values,g=l.dtype==="string"?P.fromUint8ToStringArray(m):m,x=l.dtype==="string"?P.fromUint8ToStringArray(h):h,[b,y]=i(l.shape,u.shape,g,x,f),v=c.makeTensorInfo(y,f),C=c.texData.get(v.dataId);return C.values=b,v}let d=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,p;return d?p=new Qu(t,l.shape,u.shape,n):p=new ql(e,l.shape,u.shape),c.runWebGLProgram(p,[l,u],f)}}function gy(e,t=!1){if(e==="linear")return t?$bt:Dbt;if(e==="relu")return t?Lbt:Fbt;if(e==="elu")return t?Pbt:Nbt;if(e==="relu6")return t?Bbt:Rbt;if(e==="prelu")return t?bSe:xSe;if(e==="leakyrelu")return t?gSe:hSe;if(e==="sigmoid")return t?zbt:Obt;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var XF=class{constructor(t,n,r,i=!1,o=!1,s=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Pn(this.outputShape.length);let c=i?t[1]:t[2],f=Math.ceil(c/2),d=i?"i * 2, rc.y":"rc.y, i * 2",p=o?"rc.z, i * 2":"i * 2, rc.z",m=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",x="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");let b=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let y="rc.x",v="rc.x";t[0]<n[0]?y=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(v=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${y};
        int batchB = ${v};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${h[0]});
          result += (${m[1]} * ${h[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${x}

        setOutput(result);
      }
    `}};N();N();var ySe={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},G4=class{constructor(t,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=P.assertAndGetBroadcastShape(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}};var qbt="return a * b;";function q4(e){let{inputs:t,backend:n}=e,{a:r,b:i}=t,o=P.upcastType(r.dtype,i.dtype);if(r.dtype==="complex64"){let a=n.texData.get(r.dataId),l=n.texData.get(i.dataId),u=new G4(ySe.REAL,r.shape,i.shape),c=new G4(ySe.IMAG,r.shape,i.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],d=n.runWebGLProgram(u,f,"float32"),p=n.runWebGLProgram(c,f,"float32"),m=Hl({inputs:{real:d,imag:p},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),m}if(n.shouldExecuteOnCPU([r,i])){let a=n.texData.get(r.dataId),l=n.texData.get(i.dataId),[u,c]=nbt(r.shape,i.shape,a.values,l.values,o),f=n.makeTensorInfo(c,o),d=n.texData.get(f.dataId);return d.values=u,f}let s;return Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new Qu(qbt,r.shape,i.shape):s=new ql(qbt,r.shape,i.shape),n.runWebGLProgram(s,[r,i],o)}var Hbt={kernelName:eh,backendName:"webgl",kernelFunc:q4};N();function Ybt(e,t,n){let r=[Jw(e.shape),...eC(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},o=[Jw(t),...eC(t)],s=new YF(o,r),a=!0,l=[r],u=n.runWebGLProgram(s,[i],e.dtype,l,a);return{dataId:u.dataId,shape:t,dtype:u.dtype}}function Ae(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:o}=r,s=n,a=A.sizeFromShape(i.shape),l=A.inferFromImplicitShape(o,a),u=A.sizeFromShape(l);A.assert(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);let c=s.texData.get(i.dataId);return c.isPacked&&!mA(i.shape,l)&&!(c.texture!==null&&mA(c.shape,l))?Ybt(i,l,s):(s.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}var Kbt={kernelName:px,backendName:"webgl",kernelFunc:Ae};N();N();N();N();var H4=class{constructor(t,n){this.variableNames=["x"];let{windowSize:r,batchSize:i,inSize:o,outSize:s}=t;this.outputShape=[i,s];let a=Math.floor(r/4)*4,l=r%4,u="sumValue += dot(values, ones);";if(n!=null){let f=1/n;u=`sumValue += dot(values * ${A.isInt(f)?f.toPrecision(2):f}, ones);`}let c="";o%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}};var LQ=class{constructor(t,n){this.variableNames=["x"];let{windowSize:r,batchSize:i,inSize:o,outSize:s}=t;this.outputShape=[i,s];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");let c=Math.floor(r/4)*4,f=r%4,d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let m="";o%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${u});
      }
    `}};function HTn(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let n=t.length?t[t.length-1].outSize:e[1],r=P.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function ec(e,t,n,r){let i=HTn(e.shape),o=e;for(let s=0;s<i.length;s++){let{inSize:a,windowSize:l,outSize:u}=i[s],c,f;n==="mean"?c=s===0?new H4({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:u},a):new H4({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:u}):c=new LQ({windowSize:l,inSize:a,batchSize:e.shape[0],outSize:u},n),f=o,o=r.runWebGLProgram(c,[o],t),f.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(f)}return o}N();var BQ=class{constructor(t,n){this.variableNames=["A"];let r=new Array(t.length);for(let s=0;s<r.length;s++)r[s]=t[n[s]];this.outputShape=r,this.rank=r.length;let i=$t(this.rank),o=YTn(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}};function YTn(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}var zQ=class{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let r=new Array(t.length);for(let c=0;c<r.length;c++)r[c]=t[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let i=$t(this.rank),o=pSe("rc",this.rank),s=new Array(this.rank);for(let c=0;c<n.length;c++)s[n[c]]=o[c];let a=`vec2(${s.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${s.join()}), ${a})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}};function tC(e,t,n){let r=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zQ(e.shape,t):new BQ(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function Xbt(e,t,n,r){let i=t,o=e.shape.length,s=A.parseAxisParam(i,e.shape),a=s,l=P.getAxesPermutation(a,o),u=l!=null,c=e;u&&(c=tC(e,l,r),a=P.getInnerMostAxes(a.length,o)),P.assertAxesAreInnerMostDims("sum",a,o);let[f,d]=P.computeOutAndReduceShapes(c.shape,a),p=f;n&&(p=P.expandShapeToKeepDim(f,s));let m=A.sizeFromShape(d),g=A.sizeFromShape(e.shape)/m,x=Ae({inputs:{x:c},attrs:{shape:[g,m]},backend:r}),b=Xy(e.dtype),y=ec(x,b,"sum",r),v=Ae({inputs:{x:y},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(y),u&&r.disposeIntermediateTensorInfo(c),v}function bA(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;return Xbt(i,o,s,n)}var Zbt={kernelName:yx,backendName:"webgl",kernelFunc:bA};N();function $r(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:o}=r,s=n,a=i.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=i.shape[o[c]];let u;if(s.shouldExecuteOnCPU([i])){let f=s.texData.get(i.dataId).values,d=xA(f,i.shape,i.dtype,o,l);u=s.makeTensorInfo(l,i.dtype);let p=s.texData.get(u.dataId);p.values=d}else u=tC(i,o,s);return u}var Qbt={kernelName:Nd,backendName:"webgl",kernelFunc:$r};var vSe=1e3;function yA({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:l=null}){let u=e.shape.length,c=t.shape.length,f=n?e.shape[u-2]:e.shape[u-1],d=r?t.shape[c-1]:t.shape[c-2],p=n?e.shape[u-1]:e.shape[u-2],m=r?t.shape[c-2]:t.shape[c-1],h=e.shape.slice(0,-2),g=t.shape.slice(0,-2),x=A.sizeFromShape(h),b=A.sizeFromShape(g),v=fl.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([p,m]);A.assert(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let C=n?[x,f,p]:[x,p,f],_=r?[b,m,d]:[b,d,m],S=Ae({inputs:{x:e},backend:i,attrs:{shape:C}}),E=Ae({inputs:{x:t},backend:i,attrs:{shape:_}}),T=[S,E],I=Math.max(x,b),k=n?S.shape[1]:S.shape[2],O=o!=null,F=s!=null,B=l==="leakyrelu",M=l!=null?gy(l,!0):null,z=O||F||B||M!=null,W;if((p===1||m===1)&&k>vSe&&z===!1){let Q=S,re=E;n&&(Q=$r({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),T.push(Q)),r&&(re=$r({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),T.push(re));let oe=m!==1,me=m===1,ge=Q;oe&&(ge=Ae({inputs:{x:Q},backend:i,attrs:{shape:[I,k,1]}}),T.push(ge));let ye=m===1?2:1,ve=re;me&&(ve=Ae({inputs:{x:re},backend:i,attrs:{shape:[I,1,k]}}),T.push(ve));let Ne=q4({inputs:{a:ge,b:ve},backend:i});W=bA({inputs:{x:Ne},backend:i,attrs:{axis:ye,keepDims:!0}}),T.push(Ne)}else{let Q=yi(e.dtype,t.dtype),re=new XF(C,_,[I,p,m],n,r,O,M,F,B),oe=[S,E];if(o!=null&&oe.push(o),F&&oe.push(s),B){let me=i.makeTensorInfo([],"float32",A.createScalarValue(a,"float32"));oe.push(me),T.push(me)}W=i.runWebGLProgram(re,oe,Q)}let H=Ae({inputs:{x:W},backend:i,attrs:{shape:v}});T.push(W);for(let Q of T)i.disposeIntermediateTensorInfo(Q);return H}function KTn(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:o,bias:s,preluActivationWeights:a}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;return yA({a:i,b:o,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:a,leakyreluAlpha:f,activation:c})}var Jbt={kernelName:Gy,backendName:"webgl",kernelFunc:KTn};N();var eyt="return abs(x);";function XTn(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let o=n.texData.get(r.dataId),s=FQ(o.values);return n.makeTensorInfo(r.shape,r.dtype,s)}let i;return Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Gl(r.shape,eyt):i=new is(r.shape,eyt),n.runWebGLProgram(i,[r],r.dtype)}var tyt={kernelName:R0,backendName:"webgl",kernelFunc:XTn};N();var ZTn=Xi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,QTn=tt({opSnippet:ZTn}),nyt={kernelName:Tm,backendName:"webgl",kernelFunc:QTn};N();var JTn=Xi+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,ekn=tt({opSnippet:JTn}),ryt={kernelName:km,backendName:"webgl",kernelFunc:ekn};N();var iyt="return a + b;",tkn=Tn({opSnippet:iyt,packedOpSnippet:iyt,supportsComplex:!0,cpuKernelImpl:Mxt}),oyt={kernelName:mf,backendName:"webgl",kernelFunc:tkn};N();var UQ=class{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((o,s)=>`T${s}`);let r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});let i=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}};var jQ=class{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((o,s)=>`T${s}`);let r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});let i=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}};function VQ(e){let{inputs:t,backend:n}=e,r=t;if(r.length===1)return gi({inputs:{x:r[0]},backend:n});if(r.length>Z().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let l=Math.floor(r.length/2),u=VQ({inputs:r.slice(0,l),backend:n}),c=VQ({inputs:r.slice(l),backend:n});return VQ({inputs:[u,c],backend:n})}let i=r.map(l=>l.dtype).reduce((l,u)=>yi(l,u)),o=r.map(l=>l.shape),a=Z().getBool("WEBGL_PACK")?new jQ(r[0].shape,o):new UQ(r[0].shape,o);return n.runWebGLProgram(a,r,i)}var syt={kernelName:O0,backendName:"webgl",kernelFunc:VQ};N();function nkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r,a=i.shape.length,l=A.parseAxisParam(o,i.shape),u=l,c=P.getAxesPermutation(u,a),f=i;c!=null&&(f=$r({inputs:{x:i},backend:n,attrs:{perm:c}}),u=P.getInnerMostAxes(u.length,a)),P.assertAxesAreInnerMostDims("all",u,a);let[d,p]=P.computeOutAndReduceShapes(f.shape,u),m=A.sizeFromShape(p),h=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,m]}}),g=ec(h,h.dtype,"all",n),x;if(s){let b=P.expandShapeToKeepDim(d,l);x=Ae({inputs:{x:g},backend:n,attrs:{shape:b}})}else x=Ae({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),x}var ayt={kernelName:CC,backendName:"webgl",kernelFunc:nkn};N();function rkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r,a=i.shape.length,l=A.parseAxisParam(o,i.shape),u=l,c=P.getAxesPermutation(u,a),f=i;c!=null&&(f=$r({inputs:{x:i},backend:n,attrs:{perm:c}}),u=P.getInnerMostAxes(u.length,a)),P.assertAxesAreInnerMostDims("any",u,a);let[d,p]=P.computeOutAndReduceShapes(f.shape,u),m=A.sizeFromShape(p),h=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,m]}}),g=ec(h,h.dtype,"any",n),x;if(s){let b=P.expandShapeToKeepDim(d,l);x=Ae({inputs:{x:g},backend:n,attrs:{shape:b}})}else x=Ae({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),x}var lyt={kernelName:_C,backendName:"webgl",kernelFunc:rkn};N();N();var WQ=class{constructor(t,n,r){this.variableNames=["A"];let{windowSize:i,batchSize:o,outSize:s}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,s];let a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}};N();var GQ=class{constructor(t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A.assert(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);let o=t[t.length-1],s=Math.ceil(o/n);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),i||this.variableNames.push("bestIndicesA");let a=this.outputShape,l=a.length,u=$t(l),c=hi("coords",l),f,d;if(s===1){d=l+1;let E=$t(d);f=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else d=l,f=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;let p=["x","y","z","w","u","v"].slice(0,d),m="."+p[d-1],h=p.map(E=>"int "+E),g=hi("sourceLocR",d-1).concat("inIdx.r"),x=hi("sourceLocG",d-1).concat("inIdx.g"),b=hi("sourceLocB",d-1).concat("inIdx.b"),y=hi("sourceLocA",d-1).concat("inIdx.a"),v=r==="max"?"greaterThan":"lessThan",C=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${y.join()})));`,_=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${y.join()}) : 0.)`,S=i?"":`
      float getBestIndicesAChannel(${h.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${h.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${S}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${_};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${_};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function uyt(e,t,n,r=null){let i=t.shape[0],o=t.shape[1];r!=null&&(i=r.shape[0],o=r.shape[1]);let s=P.computeOptimalWindowSize(o),a={windowSize:s,inSize:o,batchSize:i,outSize:Math.ceil(o/s)},l=new WQ(a,n,r==null),u=[t];r!=null&&u.push(r);let c=e.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;let f=uyt(e,t,n,c);return e.disposeIntermediateTensorInfo(c),f}function cyt(e,t,n,r=null){let i=r!=null?r.shape:t.shape,o=i[i.length-1],s=P.computeOptimalWindowSize(o),a=new GQ(i,s,n,r==null),l=r==null?[t]:[t,r],u=e.runWebGLProgram(a,l,"int32");if(u.shape.length===t.shape.length){let c=cyt(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function qQ(e,t,n,r){let i=[n];if(P.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!Z().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let o=[],s=e.texData.get(t.dataId),a=s!==null&&s.isPacked,l=t;a&&(l=e.unpackTensor(t),o.push(l));let[u,c]=P.computeOutAndReduceShapes(l.shape,i),f=A.sizeFromShape(c),d=Ae({inputs:{x:l},backend:e,attrs:{shape:[-1,f]}});o.push(d);let p=uyt(e,d,r);o.push(p);let m=Ae({inputs:{x:p},backend:e,attrs:{shape:u}});return o.forEach(h=>e.disposeIntermediateTensorInfo(h)),m}return cyt(e,t,r)}function ikn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r,s=A.parseAxisParam(o,i.shape),a=P.getAxesPermutation(s,i.shape.length),l=i,u=[];a!=null&&(l=$r({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=P.getInnerMostAxes(s.length,l.shape.length)),P.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let c=qQ(n,l,s[0],"max");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}var fyt={kernelName:M0,backendName:"webgl",kernelFunc:ikn};N();function okn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r,s=A.parseAxisParam(o,i.shape),a=P.getAxesPermutation(s,i.shape.length),l=i,u=[];a!=null&&(l=$r({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(l),s=P.getInnerMostAxes(s.length,l.shape.length)),P.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let c=qQ(n,l,s[0],"min");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}var dyt={kernelName:$0,backendName:"webgl",kernelFunc:okn};N();var skn=Xi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,akn=tt({opSnippet:skn}),pyt={kernelName:Im,backendName:"webgl",kernelFunc:akn};N();var lkn=Xi+"return log(x + sqrt(x * x + 1.0));",ukn=tt({opSnippet:lkn}),myt={kernelName:Dm,backendName:"webgl",kernelFunc:ukn};N();var ckn=Xi+`
  return atan(x);
`,fkn=tt({opSnippet:ckn}),hyt={kernelName:Nm,backendName:"webgl",kernelFunc:fkn};N();var dkn=KF+`
  return atan(a, b);
`,pkn=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ju+`
  return result;
`,mkn=Tn({opSnippet:dkn,packedOpSnippet:pkn}),gyt={kernelName:Rm,backendName:"webgl",kernelFunc:mkn};N();var hkn=Xi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,gkn=tt({opSnippet:hkn}),xyt={kernelName:Fm,backendName:"webgl",kernelFunc:gkn};N();var xm=class{constructor(t,n,r,i=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let s=t.filterWidth,a=t.strideHeight,l=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;let h=n==="avg",g=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,x=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`,b="0.0";if(h||(b="-1.0 / 1e-20"),r){let E=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${p}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?o?g:x:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let y="max",v=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(v="avgValue / max(count, 1.0)");let C=Math.floor(s/4)*4,_=s%4,S=`
      if (${h}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${y}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${p}, ${m});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${S}
          }

          int xC = xCCorner + ${C};
          if (${_===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${_===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${_===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${S}
          }
        }
        setOutput(${v});
      }
    `}},nC=class{constructor(t,n,r,i=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let s=t.filterWidth,a=t.strideDepth,l=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,f=t.dilationHeight,d=t.dilationWidth,p=t.effectiveFilterDepth,m=t.effectiveFilterHeight,h=t.effectiveFilterWidth,g=t.padInfo.front,x=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;let y=n==="avg",v="0.0";if(y||(v="-1.0 / 1e-20"),r){let I=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${g}, ${x}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${h};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${I} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?o?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${m} * ${h} +
                      wR * ${h} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let C="max",_=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(_="avgValue / max(count, 1.0)");let S=Math.floor(s/4)*4,E=s%4,T=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${g}, ${x}, ${b});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${S}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${T}
            }

            int xC = xCCorner + ${S};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${T}
            }
          }
        }
        setOutput(${_});
      }
    `}};function xkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;x0(i,"avgPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;A.assert(P.eitherStridesOrDilationsAreOne(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=P.computePool2DInfo(i.shape,o,s,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&A.arraysEqual(c.inShape,c.outShape))return gi({inputs:{x:i},backend:n});let f=new xm(c,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}var byt={kernelName:P0,backendName:"webgl",kernelFunc:xkn};N();function bkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],f=P.computePool3DInfo(i.shape,o,s,c,a,l,u),d=new nC(f,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}var yyt={kernelName:L0,backendName:"webgl",kernelFunc:bkn};N();var HQ=class{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;let n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,s=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=l-1-t.padInfo.top,f=u-1-t.padInfo.left,d=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},YQ=class{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;let n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,o=t.strideDepth,s=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,m=f-1-t.padInfo.front,h=d-1-t.padInfo.top,g=p-1-t.padInfo.left,x=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${h}, ${g});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function ykn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,s=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],d=P.computePool3DInfo(s.shape,a,l,f,u,c),p=new YQ(d);return n.runWebGLProgram(p,[i],s.dtype)}var vyt={kernelName:EC,backendName:"webgl",kernelFunc:ykn};N();function vkn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,s=o;x0([i,o],"avgPoolGrad");let{filterSize:a,strides:l,pad:u}=r,c=P.computePool2DInfo(s.shape,a,l,1,u),f=new HQ(c);return n.runWebGLProgram(f,[i],s.dtype)}var wyt={kernelName:SC,backendName:"webgl",kernelFunc:vkn};N();function wkn(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:o}=t,{transposeA:s,transposeB:a}=r;return yA({a:i,b:o,transposeA:s,transposeB:a,backend:n})}var Cyt={kernelName:B0,backendName:"webgl",kernelFunc:wkn};N();N();var KQ=class{constructor(t,n,r,i,o,s){this.outputShape=[],this.variableNames=["x","mean","variance"],P.assertAndGetBroadcastShape(t,n),P.assertAndGetBroadcastShape(t,r);let a="0.0";i!=null&&(P.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(P.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}};N();var XQ=class{constructor(t,n,r,i,o,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],P.assertAndGetBroadcastShape(t,n),P.assertAndGetBroadcastShape(t,r);let a="vec4(0.0)";i!=null&&(P.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(P.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}};var Ckn=({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:i,variance:o,offset:s,scale:a}=e;A.assert(i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A.assert(s==null||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A.assert(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);let u=[r,i,o],c=null;s!=null&&(c=s.shape,u.push(s));let f=null;a!=null&&(f=a.shape,u.push(a));let d=Z().getBool("WEBGL_PACK_NORMALIZATION")?new XQ(r.shape,i.shape,o.shape,c,f,l):new KQ(r.shape,i.shape,o.shape,c,f,l);return t.runWebGLProgram(d,u,u[0].dtype)},_yt={kernelName:X0,backendName:"webgl",kernelFunc:Ckn};N();N();var ZQ=class{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;let n=$t(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let r=_kn(this.rank),i,o=t.map((s,a)=>`sourceLoc.${wSe[a]} = start[${a}] + coords.${wSe[a]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}},wSe=["x","y","z","w","u","v"];function _kn(e){if(e===1)return"sourceLoc";if(e<=6)return wSe.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}var QQ=class{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n=$t(this.rank),r=hi("coords",this.rank),i=hi("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,s=`getChannel(getSource(${i.join()}), ${o})`,a=`
      result.x = ${s};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${s};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${s};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${s};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((c,f)=>`start[${f}]`).join()});`:t.map((c,f)=>`${i[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}};function Skn(e,t,n,r){let i=r.texData.get(e.dataId),o=r.makeTensorInfo(n,e.dtype),s=r.texData.get(o.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=e.dtype;let a=so.computeFlatOffset(t,A.computeStrides(e.shape));i.slice&&(a+=i.slice.flatOffset),s.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),o}function bm(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,size:s}=r,[a,l]=so.parseSliceParams(i,o,s);if(so.assertParamsValid(i,a,l),A.sizeFromShape(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){let f=n.texData.get(i.dataId),d=pbt(f.values,a,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,d)}let{isPacked:u}=n.texData.get(i.dataId),c=so.isSliceContinous(i.shape,a,l);if(u||!c){let f=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new QQ(l):new ZQ(l),d=[a];return n.runWebGLProgram(f,[i],i.dtype,d)}return n.uploadToGPU(i.dataId),Skn(i,a,l,n)}var Syt={kernelName:bx,backendName:"webgl",kernelFunc:bm};var Ekn=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,crops:s}=r;A.assert(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let a=o.reduce((b,y)=>b*y),l=P.getReshaped(i.shape,o,a),u=P.getPermuted(l.length,o.length),c=P.getReshapedPermuted(i.shape,o,a),f=P.getSliceBeginCoords(s,o.length),d=P.getSliceSize(c,s,o.length),p=[],m=Ae({inputs:{x:i},backend:n,attrs:{shape:l}}),h=$r({inputs:{x:m},backend:n,attrs:{perm:u}}),g=Ae({inputs:{x:h},backend:n,attrs:{shape:c}}),x=bm({inputs:{x:g},backend:n,attrs:{begin:f,size:d}});return p.push(m),p.push(h),p.push(g),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),x},Eyt={kernelName:z0,backendName:"webgl",kernelFunc:Ekn};N();function Akn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:s}=r,a=n.readSync(i.dataId),l=n.readSync(o.dataId),u=NQ(a,l,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,u)}var Ayt={kernelName:AC,backendName:"webgl",kernelFunc:Akn};N();var Tkn=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,kkn=`
  return float(int(a.r) & int(b.r));
`;function Ikn(e){let{inputs:t,backend:n}=e,{a:r,b:i}=t,o=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=Z().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||s===1){let l=n.texData.get(r.dataId).values,u=n.texData.get(i.dataId).values,[c,f]=Pxt(r.shape,i.shape,l,u,r.dtype),d=n.makeTensorInfo(f,r.dtype),p=n.texData.get(d.dataId);return p.values=c,d}let a;return o?a=new Qu(Tkn,r.shape,i.shape,!1):a=new ql(kkn,r.shape,i.shape),n.runWebGLProgram(a,[r,i],r.dtype)}var Tyt={kernelName:My,backendName:"webgl",kernelFunc:Ikn};N();function Dkn(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,o=n.readSync(r.dataId),s=n.readSync(i.dataId),a=P.assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}var kyt={kernelName:TC,backendName:"webgl",kernelFunc:Dkn};N();N();N();var Nkn="return float(a != b);",CSe=Tn({opSnippet:Nkn,cpuKernelImpl:ibt,dtype:"bool"}),Iyt={kernelName:Vy,backendName:"webgl",kernelFunc:CSe};N();function xy(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return gi({inputs:{x:i.complexTensorInfos.real},backend:n})}var Dyt={kernelName:s_,backendName:"webgl",kernelFunc:xy};var Fkn="return float(int(x));";function Nyt(e,t){let n=new is(e.shape,Fkn),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function _Se(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:o}=r;if(o==="complex64"){if(i.dtype==="complex64")return gi({inputs:{x:i},backend:n});let s=ar(i.shape),a=_Se({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=Hl({inputs:{real:a,imag:s},backend:n});return s.dispose(),n.disposeIntermediateTensorInfo(a),l}if(i.dtype==="complex64"){let s=xy({inputs:{input:i},backend:n}),a=_Se({inputs:{x:s},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(s),a}if(!A.hasEncodingLoss(i.dtype,o)){let s=gi({inputs:{x:i},backend:n});return{dataId:s.dataId,shape:s.shape,dtype:o}}if(n.shouldExecuteOnCPU([i])){let s=n.texData.get(i.dataId).values,[a,l,u]=Lxt(s,i.shape,i.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return Nyt(i,n);if(o==="bool"){let s=n.makeTensorInfo([],"bool",A.getTypedArrayFromDType("bool",1)),l=CSe({inputs:{a:i,b:s},backend:n});return n.disposeIntermediateTensorInfo(s),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${o}`)}var Fyt={kernelName:kd,backendName:"webgl",kernelFunc:_Se};N();var Ryt="return ceil(x);",Rkn=tt({opSnippet:Ryt,packedOpSnippet:Ryt,cpuKernelImpl:Bxt}),Oyt={kernelName:Om,backendName:"webgl",kernelFunc:Rkn};N();var JQ=class{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}};var eJ=class{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function Okn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:o,clipValueMax:s}=r,a;Z().getBool("WEBGL_PACK_CLIP")?a=new eJ(i.shape):a=new JQ(i.shape);let l=[[o],[s]];return n.runWebGLProgram(a,[i],i.dtype,l)}var Myt={kernelName:Mm,backendName:"webgl",kernelFunc:Okn};N();var tJ=class{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function $yt(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function Mkn(e){let{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),o=new tJ(r.shape),s=[$yt(r,i.complexTensorInfos.real),$yt(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(o,s,s[0].dtype)}var Pyt={kernelName:U0,backendName:"webgl",kernelFunc:Mkn};N();N();N();var nJ=class{constructor(t){this.outputShape=[],this.outputShape=P.computeOutShape(t,1),this.variableNames=t.map((s,a)=>`T${a}`);let n=new Array(t.length-1);n[0]=t[0][1];for(let s=1;s<n.length;s++)n[s]=n[s-1]+t[s][1];let r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<n.length;s++){let a=n[s-1];r.push(`else if (yC < ${n[s]}) setOutput(getT${s}(yR, yC-${a}));`)}let i=n.length,o=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}};N();var iJ=class{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=P.computeOutShape(t,n);let r=this.outputShape,i=r.length,o=$t(i),s=hi("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((h,g)=>`T${g}`);let l=new Array(t.length-1);l[0]=t[0][n];for(let h=1;h<l.length;h++)l[h]=l[h-1]+t[h][n];let u=a[n],c=a.slice(-2),f=a.join(),d=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let h=1;h<l.length;h++){let g=l[h-1];d+=`
        if (${u} < ${l[h]}  && ${u} >= ${l[h-1]}) {
          return getChannel(
            getT${h}(${rJ(a,u,g)}),
            vec2(${rJ(c,u,g)}));
        }`}let p=l.length,m=l[l.length-1];d+=`
        return getChannel(
          getT${p}(${rJ(a,u,m)}),
          vec2(${rJ(c,u,m)}));`,this.userCode=`
      float getValue(${a.map(h=>"int "+h)}) {
        ${d}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[i-1]} = ${s[i-1]} + 1;
        if (${s[i-1]} < ${r[i-1]}) {
          result.g = getValue(${s});
        }

        ${s[i-2]} = ${s[i-2]} + 1;
        if (${s[i-2]} < ${r[i-2]}) {
          result.a = getValue(${s});
        }

        ${s[i-1]} = ${s[i-1]} - 1;
        if (${s[i-2]} < ${r[i-2]} &&
            ${s[i-1]} < ${r[i-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}};function rJ(e,t,n){let r=e.indexOf(t);return e.map((o,s)=>s===r?`${o} - ${n}`:o).join()}N();function vA(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return gi({inputs:{x:i.complexTensorInfos.imag},backend:n})}var Lyt={kernelName:qC,backendName:"webgl",kernelFunc:vA};function ZF(e,t,n){let r=e[0].dtype;if(r==="complex64"){let p=e.map(b=>xy({inputs:{input:b},backend:n})),m=e.map(b=>vA({inputs:{input:b},backend:n})),h=ZF(p,t,n),g=ZF(m,t,n),x=Hl({inputs:{real:h,imag:g},backend:n});return p.forEach(b=>n.disposeIntermediateTensorInfo(b)),m.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),x}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){let p=e.map(v=>{let _=[-1,A.sizeFromShape(v.shape.slice(t))];return Ae({inputs:{x:v},backend:n,attrs:{shape:_}})}),m=p.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),h=P.computeOutShape(p.map(v=>v.shape),1),g=p[0].shape[0]===1,x=zxt(m,h,r,g),b=P.computeOutShape(e.map(v=>v.shape),t),y=n.makeTensorInfo(b,r,x);return p.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}let o=e.filter(p=>A.sizeFromShape(p.shape)>0),s=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){let p=s?new is(e[0].shape,b0):new Gl(e[0].shape,b0);return n.runWebGLProgram(p,e,r)}let a=Z().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){let p=[];for(let h=0;h<o.length;h+=a){let g=o.slice(h,h+a);p.push(ZF(g,t,n))}let m=ZF(p,t,n);for(let h of p)n.disposeIntermediateTensorInfo(h);return m}if(s){let p=new iJ(o.map(m=>m.shape),t);return n.runWebGLProgram(p,o,r)}let{tensors2D:l,outShape:u}=$kn(o,t,n),c=new nJ(l.map(p=>p.shape)),f=n.runWebGLProgram(c,l,r);l.forEach(p=>n.disposeIntermediateTensorInfo(p));let d=Ae({inputs:{x:f},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(f),d}function $kn(e,t,n){let r=P.computeOutShape(e.map(o=>o.shape),t);return{tensors2D:e.map(o=>Ae({inputs:{x:o},attrs:{shape:[-1,A.sizeFromShape(o.shape.slice(t))]},backend:n})),outShape:r}}function SSe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,o=A.parseAxisParam(i,t[0].shape)[0],s=t.map(u=>u.shape);P.assertParamsConsistent(s,o);let a=P.computeOutShape(t.map(u=>u.shape),o);if(A.sizeFromShape(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);let l=t.filter(u=>A.sizeFromShape(u.shape)>0);return l.length===1?gi({inputs:{x:l[0]},backend:n}):ZF(l,o,n)}var Byt={kernelName:j0,backendName:"webgl",kernelFunc:SSe};N();var QF=class{constructor(t,n=!1,r=null,i=!1,o=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;let s=t.padInfo.top,a=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,m=Math.floor(t.inChannels/4)*4,h=t.inChannels%4,g=t.dataFormat==="channelsLast",x=g?1:2,b=g?2:3,y=g?3:1,v="",C="";r&&(i?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:v=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");let _=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${y}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${h===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${h===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${h===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${_}
        ${C}
        setOutput(result);
      }
    `}},oJ=class{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;let n=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,o=t.strideDepth,s=t.strideHeight,a=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,p=t.filterWidth,m=Math.floor(t.inChannels/4)*4,h=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${s}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${h===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${h===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${h===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};N();var JF=class{constructor(t,n=!1,r=null,i=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Pn(this.outputShape.length);let s=t.padInfo.left,a=t.strideWidth,l=t.dilationWidth,u=t.filterHeight,c=t.filterWidth,f=c,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<c;g++)d+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;d+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let g=0;g<c;g++)d+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(f+1)/2;g++){let x=g*2;if(d+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<c&&(s%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?d+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<c)){let b=s%2===0?A.nearestLargerEven(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:d+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):b===1?d+=`
                     xC${x+1} = xTexelC${x};
                     `:d+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<c&&(s%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<c&&(d+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<c&&(d+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<c&&(d+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let p="",m="";r&&(i?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:p=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");let h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${h}
         ${m}
         setOutput(result);
       }
     `}};N();var sJ=class{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Pn(this.outputShape.length);let{dataFormat:r}=n,i=Xr(),o=r==="channelsLast",s=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`,u="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${s}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${i.output} = result;
      }
    `}};function aJ(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function lJ({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){let l=e.shape,u=r.texData.get(e.dataId),c=n.inChannels,f=l[0]*l[1]*l[2],d=n.outChannels,p=n.dataFormat==="channelsLast",m=!1,h=!1,g,x=[];if(o!=null){let v=aJ(o.shape,p);v!=null&&(o=Ae({inputs:{x:o},backend:r,attrs:{shape:v}}),x.push(o))}if(i!=null){let v=aJ(i.shape,p);v!=null&&(i=Ae({inputs:{x:i},backend:r,attrs:{shape:v}}),x.push(i))}if(!((f===1||d===1)&&c>vSe)&&u.isPacked&&p&&u.texture!=null&&l[2]%2!==0&&A.arraysEqual(u.shape.slice(-3),l.slice(-3))){let v=l[0]*l[1]*(l[2]+1),C={dataId:e.dataId,shape:[1,v,n.inChannels],dtype:e.dtype},_=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,A.assert(mA(u.shape,C.shape),()=>`packed reshape ${u.shape} to ${C.shape} isn't free`);let S=Ae({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(S);let E=yA({a:C,b:S,backend:r,transposeA:m,transposeB:h,bias:i,activation:a,preluActivationWeights:o,leakyreluAlpha:s}),T=r.texData.get(E.dataId);A.assert(T.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=_,T.shape=n.outShape,g=gi({inputs:{x:E},backend:r}),g.shape=n.outShape,x.push(E)}else{let v=n.outHeight*n.outWidth,C=Ae({inputs:{x:e},backend:r,attrs:{shape:p?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),_=Ae({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),S=yA({a:p?C:_,b:p?_:C,transposeA:!p,transposeB:h,backend:r,bias:i,activation:a,preluActivationWeights:o,leakyreluAlpha:s});g=Ae({inputs:{x:S},backend:r,attrs:{shape:n.outShape}}),x.push(C),x.push(_),x.push(S)}for(let v of x)r.disposeIntermediateTensorInfo(v);return g}function uJ({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){let{filterWidth:l,filterHeight:u,inChannels:c,outWidth:f,outHeight:d,dataFormat:p}=n,m=p==="channelsLast",h=l*u*c,g=d*f,x=[n.batchSize,h,g],b=!0,y=!1,v=[];if(o!=null){let H=aJ(o.shape,m);H!=null&&(o=Ae({inputs:{x:o},backend:r,attrs:{shape:H}}),v.push(o))}if(i!=null){let H=aJ(i.shape,m);H!=null&&(i=Ae({inputs:{x:i},backend:r,attrs:{shape:H}}),v.push(i))}let C=Ae({inputs:{x:t},backend:r,attrs:{shape:[1,h,A.sizeFromShape(t.shape)/h]}});v.push(C);let _=new sJ(x,n),S=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram(_,[e],"float32",S),T=Ae({inputs:{x:E},backend:r,attrs:{shape:x}});v.push(E),v.push(T);let I=i!=null,k=o!=null,O=a==="leakyrelu",F=a?gy(a,!0):null,B=new XF(m?T.shape:C.shape,m?C.shape:T.shape,m?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],b,y,I,F,k,O),M=m?[T,C]:[C,T];if(i&&M.push(i),k&&M.push(o),O){let H=r.makeTensorInfo([],"float32",A.createScalarValue(s,"float32"));M.push(H),v.push(H)}let z=r.runWebGLProgram(B,M,"float32"),W=Ae({inputs:{x:z},backend:r,attrs:{shape:n.outShape}});v.push(z);for(let H of v)r.disposeIntermediateTensorInfo(H);return W}function Pkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,f=P.convertConv2DDataFormat(l),d=P.computeConv2DInfo(i.shape,o.shape,s,u,a,c,!1,f),p;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))p=lJ({x:i,filter:o,convInfo:d,backend:n});else if(d.strideWidth<=2&&f==="channelsLast"&&Z().getBool("WEBGL_EXP_CONV")){let h=new JF(d),g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];p=n.runWebGLProgram(h,[i,o],"float32",g)}else if(Z().getBool("WEBGL_CONV_IM2COL"))p=uJ({x:i,filter:o,convInfo:d,backend:n});else{let h=new QF(d);p=n.runWebGLProgram(h,[i,o],"float32")}let m=Ae({inputs:{x:p},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(p),m}var zyt={kernelName:V0,backendName:"webgl",kernelFunc:Pkn};N();var cJ=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,o=t.padInfo.left,s=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${s?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},fJ=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,s=t.dataFormat==="channelsLast",a=n-1-t.padInfo.top,l=r-1-t.padInfo.left,u=s?1:2,c=s?2:3,f=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},dJ=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,o=t.padInfo.front,s=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${s};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},pJ=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,o=t.strideDepth,s=t.strideHeight,a=t.strideWidth,l=n-1-t.padInfo.front,u=r-1-t.padInfo.top,c=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Lkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:s,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,f=P.convertConv2DDataFormat(l),d=P.computeConv2DInfo(i.shape,c,s,1,a,u,!1,f),p=new cJ(d);return n.runWebGLProgram(p,[i,o],"float32")}var Uyt={kernelName:IC,backendName:"webgl",kernelFunc:Lkn};N();var mJ=class{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Pn(this.outputShape.length);let n=t.filterHeight,r=t.filterWidth,i=n-1-t.padInfo.top,o=r-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function Bkn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{inputShape:s,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,f=P.convertConv2DDataFormat(u),d=P.computeConv2DInfo(s,o.shape,a,1,l,c,!1,f);if(Z().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){let p=[[d.strideHeight,d.strideWidth]],m=new mJ(d);return n.runWebGLProgram(m,[i,o],"float32",p)}else{let p=new fJ(d);return n.runWebGLProgram(p,[i,o],"float32")}}var jyt={kernelName:W0,backendName:"webgl",kernelFunc:Bkn};N();function zkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:l}=r,u=P.computeConv3DInfo(i.shape,o.shape,s,l,a),c=new oJ(u);return n.runWebGLProgram(c,[i,o],"float32")}var Vyt={kernelName:G0,backendName:"webgl",kernelFunc:zkn};N();function Ukn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:s,pad:a,filterShape:l}=r,u=P.computeConv3DInfo(i.shape,l,s,1,a),c=new dJ(u);return n.runWebGLProgram(c,[i,o],"float32")}var Wyt={kernelName:DC,backendName:"webgl",kernelFunc:Ukn};N();function jkn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{pad:s,strides:a,inputShape:l}=r,u=P.computeConv3DInfo(l,o.shape,a,1,s),c=new pJ(u);return n.runWebGLProgram(c,[i,o],"float32")}var Gyt={kernelName:NC,backendName:"webgl",kernelFunc:jkn};N();var Vkn=wd+`
  return cos(x);
`,Wkn=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Ju}
  return result;
`,Gkn=tt({opSnippet:Vkn,packedOpSnippet:Wkn}),qyt={kernelName:$m,backendName:"webgl",kernelFunc:Gkn};N();var qkn=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Hkn=tt({opSnippet:qkn}),Hyt={kernelName:Pm,backendName:"webgl",kernelFunc:Hkn};N();var hJ=class{constructor(t,n,r,i,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[s,a,l,u]=t,[c]=n,[f,d]=r;this.outputShape=[c,f,d,u];let p=i==="bilinear"?1:0,[m,h]=[`${a-1}.0`,`${l-1}.0`],[g,x,b]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[y,v,C]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${h} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${h}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${y});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${v};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${h} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}};var Ykn=e=>{let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:o,boxInd:s}=t,{cropSize:a,method:l,extrapolationValue:u}=r,c=new hJ(i.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[i,o,s],"float32")},Yyt={kernelName:RC,backendName:"webgl",kernelFunc:Ykn};N();var eR=function(e){return e.Prod="*",e.Sum="+",e}(eR||{}),Y4=class{constructor(t,n,r,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let o=this.outputShape.length,s=this.op===eR.Prod?"1.0":"0.0",a=r?s:`getX(${Kyt(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1],u="",c="";r?(u=i?`end != ${l-1}`:"end != 0",c=i?"end + 1":"end - 1"):(u=i?`end + pow2 < ${l}`:"end >= pow2",c=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${$t(o)} coords = getOutputCoords();
        int end = ${Xyt(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${Xyt(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${Kyt(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function Kyt(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function Xyt(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}N();function gJ(e,t,n,r,i,o){let s=t.shape.length,a=P.getAxesPermutation([r],s),l=t;a!=null&&(l=$r({inputs:{x:t},backend:n,attrs:{perm:a}}));let u=P.getInnerMostAxes(1,s)[0];if(u!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let c=l.shape[u],f=gi({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){let p=new Y4(e,l.shape,!1,o),m=[[d]],h=f;f=n.runWebGLProgram(p,[f],f.dtype,m),n.disposeIntermediateTensorInfo(h)}if(i){let d=new Y4(e,l.shape,i,o),p=f;f=n.runWebGLProgram(d,[f],f.dtype),n.disposeIntermediateTensorInfo(p)}if(a!=null){let d=P.getUndoAxesPermutation(a),p=$r({inputs:{x:f},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(l),p}return f}function Kkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:s,reverse:a}=r;return gJ(eR.Prod,i,n,o,s,a)}var Zyt={kernelName:FC,backendName:"webgl",kernelFunc:Kkn};N();function Xkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:s,reverse:a}=r;return gJ(eR.Sum,i,n,o,s,a)}var Qyt={kernelName:q0,backendName:"webgl",kernelFunc:Xkn};N();function Zkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:o}=t,{size:s,binaryOutput:a}=r;if(i.shape.length===1){let l=n.readSync(i.dataId),u=n.readSync(o.dataId),c=NQ(l,u,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,c)}else if(i.shape.length===2){let l=n.bufferSync(i),u=n.bufferSync(o),c=$xt(l,u,s,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}var Jyt={kernelName:OC,backendName:"webgl",kernelFunc:Zkn};N();var xJ=class{constructor(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function Qkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:o,dataFormat:s}=r,a=i.shape[0],l=s==="NHWC"?i.shape[1]:i.shape[2],u=s==="NHWC"?i.shape[2]:i.shape[3],c=s==="NHWC"?i.shape[3]:i.shape[1],f=l*o,d=u*o,p=c/(o*o),m=s==="NHWC"?[a,f,d,p]:[a,p,f,d],h=new xJ(m,o,s);return n.runWebGLProgram(h,[i],i.dtype)}var evt={kernelName:MC,backendName:"webgl",kernelFunc:Qkn};N();var tR=class{constructor(t,n=!1,r=null,i=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Pn(this.outputShape.length);let s=t.filterHeight,a=t.filterWidth,l=t.outChannels/t.inChannels,u="",c="";r&&(i?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");let f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${s}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}};N();var nR=class{constructor(t,n=!1,r=null,i=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Pn(this.outputShape.length);let s=t.outChannels/t.inChannels,a=t.padInfo.left,l=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,f=t.filterWidth,d=f,p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<f;x++)p+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;p+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let x=0;x<f;x++)p+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(d+1)/2;x++){let b=x*2;if(p+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<f&&(a%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?p+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<f)){let y=a%2===0?A.nearestLargerEven(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${y};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:p+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):y===1?p+=`
                    xC${b+1} = xTexelC${b};
                    `:p+=`
                    xCOffset = xC + ${y};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<f&&(a%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<f&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<f&&(p+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<f&&(p+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<f&&(p+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let m="",h="";r&&(i?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,h="result = activation(result);");let g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${h}
        setOutput(result);
      }
    `}};function Jkn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:l,dimRoundingMode:u}=r,c=l;c==null&&(c=[1,1]),A.assert(P.eitherStridesOrDilationsAreOne(s,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let f=P.computeConv2DInfo(i.shape,o.shape,s,c,a,u,!0),d;Z().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?d=new nR(f):d=new tR(f);let p=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(d,[i,o],"float32",p)}var tvt={kernelName:H0,backendName:"webgl",kernelFunc:Jkn};N();var bJ=class{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;let n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,o=t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},yJ=class{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;let n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,s=n-1-t.padInfo.top,a=r-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function eIn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,f=P.computeConv2DInfo(i.shape,c,s,a,l,u,!0),d=new bJ(f);return n.runWebGLProgram(d,[i,o],"float32")}var nvt={kernelName:$C,backendName:"webgl",kernelFunc:eIn};N();function tIn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{strides:s,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,f=P.computeConv2DInfo(c,o.shape,s,a,l,u,!0),d=new yJ(f);return n.runWebGLProgram(d,[i,o],"float32")}var rvt={kernelName:PC,backendName:"webgl",kernelFunc:tIn};N();var vJ=class{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function nIn(e){let{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],o=A.sizeFromShape(r.shape),s=Ae({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new vJ(o),l=n.runWebGLProgram(a,[s],s.dtype),u=Ae({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}var ivt={kernelName:LC,backendName:"webgl",kernelFunc:nIn};N();var wJ=class{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;let{inHeight:n,inWidth:r,padInfo:i,strideHeight:o,strideWidth:s,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=t,{top:f,left:d}=i;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${s});
      const ivec2 pads = ivec2(${f}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function rIn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:l}=r,u=P.computeDilation2DInfo(i.shape,o.shape,s,a,"NHWC",l),c,f=new wJ(u);c=n.runWebGLProgram(f,[i,o],"float32");let d=Ae({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),d}var ovt={kernelName:Y0,backendName:"webgl",kernelFunc:rIn};N();function iIn(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,o=t,{allDims:s,summedDims:a,idDims:l}=P.decodeEinsumEquation(i,o.length);P.checkEinsumDimSizes(s.length,l,o);let{path:u,steps:c}=P.getEinsumComputePath(a,l),f=c.length,d=null,p=s.length,m=[];for(let h=0;h<f;++h){for(let g of c[h]){let{permutationIndices:x,expandDims:b}=P.getEinsumPermutation(p,l[g]),y;P.isIdentityPermutation(x)?y=o[g]:(y=$r({inputs:{x:o[g]},backend:n,attrs:{perm:x}}),m.push(y));let v=y.shape.slice();for(let C=0;C<b.length;++C)v.splice(b[C],0,1);A.arraysEqual(y.shape,v)||(y=Ae({inputs:{x:y},backend:n,attrs:{shape:v}}),m.push(y)),d===null?d=y:(d=q4({inputs:{a:y,b:d},backend:n}),m.push(d))}h<f-1&&(u[h]>=0&&(d=bA({inputs:{x:d},backend:n,attrs:{axis:u[h]-(s.length-p),keepDims:!1}}),m.push(d)),p--)}for(let h of m)h!==d&&n.disposeIntermediateTensorInfo(h);return d}var svt={kernelName:BC,backendName:"webgl",kernelFunc:iIn};N();var oIn="return (x >= 0.0) ? x : (exp(x) - 1.0);",sIn=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,aIn=tt({opSnippet:oIn,packedOpSnippet:sIn}),avt={kernelName:Bm,backendName:"webgl",kernelFunc:aIn};N();var lIn="return (b >= 0.0) ? a : a * (b + 1.0);",uIn=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,cIn=e=>{let{inputs:t,backend:n}=e,{dy:r,y:i}=t,o=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qu(uIn,r.shape,i.shape):new ql(lIn,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],r.dtype)},lvt={kernelName:zC,backendName:"webgl",kernelFunc:cIn};N();var fIn=`
  return vec4(equal(a, b));
`,dIn="return float(a == b);",pIn=Tn({opSnippet:dIn,packedOpSnippet:fIn,dtype:"bool",cpuKernelImpl:Uxt}),uvt={kernelName:$y,backendName:"webgl",kernelFunc:pIn};N();var mIn=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${P.ERF_P};
  float a1 = ${P.ERF_A1};
  float a2 = ${P.ERF_A2};
  float a3 = ${P.ERF_A3};
  float a4 = ${P.ERF_A4};
  float a5 = ${P.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,hIn=tt({opSnippet:mIn}),cvt={kernelName:zm,backendName:"webgl",kernelFunc:hIn};N();var gIn=wd+`
  return exp(x);
`,xIn=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ESe=tt({opSnippet:gIn,packedOpSnippet:xIn,cpuKernelImpl:jxt,dtype:"float32"}),fvt={kernelName:Um,backendName:"webgl",kernelFunc:ESe};N();function CJ(e){let{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:o}=t,s=o.shape.length,a=o.shape.slice(),l=i;return i<0&&(A.assert(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),a.splice(l,0,1),Ae({inputs:{x:o},backend:r,attrs:{shape:a}})}var dvt={kernelName:K0,backendName:"webgl",kernelFunc:CJ};N();var pvt="return exp(x) - 1.0;",bIn=tt({opSnippet:pvt,packedOpSnippet:pvt,cpuKernelImpl:Vxt}),mvt={kernelName:jm,backendName:"webgl",kernelFunc:bIn};N();N();var K4=class{constructor(t,n,r){this.variableNames=["real","imag"];let i=n[1];this.outputShape=n;let o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${i}.0`:"1.0",a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function _J(e,t,n){let r=n.texData.get(e.dataId),i=A.sizeFromShape(e.shape),o=e.shape[e.shape.length-1],s=i/o,a=Ae({inputs:{x:e},backend:n,attrs:{shape:[s,o]}}),l=a.shape,u=new K4("real",l,t),c=new K4("imag",l,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(u,f,"float32"),p=n.runWebGLProgram(c,f,"float32"),m=Hl({inputs:{real:d,imag:p},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p);let h=Ae({inputs:{x:m},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(m),h}function yIn(e){let{inputs:t,backend:n}=e,{input:r}=t;return _J(r,!1,n)}var hvt={kernelName:UC,backendName:"webgl",kernelFunc:yIn};N();var SJ=class{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function by(e){let{backend:t,attrs:n}=e,{shape:r,value:i}=n,{dtype:o}=n;if(o=o||A.inferDtype(i),o==="string"){let s=A.getArrayFromDType(o,A.sizeFromShape(r));return s.fill(i),t.makeTensorInfo(r,o,s)}else{let s=new SJ(r,i),a=[[i]];return t.runWebGLProgram(s,[],o,a)}}var gvt={kernelName:jC,backendName:"webgl",kernelFunc:by};N();var EJ=class{constructor(t){this.variableNames=["Image"],this.outputShape=[];let n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var xvt={kernelName:VC,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,i=new EJ(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};N();var bvt="return floor(x);",vIn=tt({opSnippet:bvt,packedOpSnippet:bvt,cpuKernelImpl:Wxt}),yvt={kernelName:Vm,backendName:"webgl",kernelFunc:vIn};N();var wIn=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,CIn=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,_In=Tn({opSnippet:wIn,packedOpSnippet:CIn,dtype:"int32"}),vvt={kernelName:Wm,backendName:"webgl",kernelFunc:_In};N();N();var AJ=class{constructor(t){this.variableNames=["A"];let n=Xr(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}};var TJ=class{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let n=Xr(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}};var wvt={kernelName:rT,backendName:"webgl",kernelFunc:SIn},rR,ASe=Z().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function SIn(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:i}=t,{numChannels:o}=r,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,u]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],f=[u,l,o];if(a||s){let h=Z().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(rR==null||h!==ASe)&&(ASe=h,rR=document.createElement("canvas").getContext("2d",{willReadFrequently:ASe})),rR.canvas.width=l,rR.canvas.height=u,rR.drawImage(i,0,0,l,u),i=rR.canvas}let d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=fa.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);let p=Z().getBool("WEBGL_PACK")?new TJ(f):new AJ(f),m=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),m}N();function EIn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:m}=r,h=P.convertConv2DDataFormat(c),g=P.computeConv2DInfo(i.shape,o.shape,l,f,u,d,!1,h),x,b=[],y=s!=null,v=a!=null,C=p==="leakyrelu",_=()=>{let E=[i,o],T=(I,k)=>{if(k==="NCHW"&&I.shape.length===1&&I.shape[0]!==1){let O=Ae({inputs:{x:I},backend:n,attrs:{shape:[I.shape[0],1,1]}});return b.push(O),O}return I};if(y&&E.push(T(s,c)),v&&E.push(T(a,c)),C){let I=n.makeTensorInfo([],"float32",A.createScalarValue(m,"float32"));E.push(I),b.push(I)}return E};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))x=lJ({x:i,filter:o,convInfo:g,backend:n,bias:s,activation:p,preluActivationWeights:a,leakyreluAlpha:m});else if(g.strideWidth<=2&&h==="channelsLast"&&Z().getBool("WEBGL_EXP_CONV")){let E=p?gy(p,!0):null,T=new JF(g,y,E,v,C),I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],k=_();x=n.runWebGLProgram(T,k,"float32",I)}else if(Z().getBool("WEBGL_CONV_IM2COL"))x=uJ({x:i,filter:o,convInfo:g,backend:n,bias:s,activation:p,preluActivationWeights:a,leakyreluAlpha:m});else{let E=p?gy(p,!1):null,T=new QF(g,y,E,v,C),I=_();x=n.runWebGLProgram(T,I,"float32")}let S=Ae({inputs:{x},backend:n,attrs:{shape:g.outShape}});return b.push(x),b.forEach(E=>n.disposeIntermediateTensorInfo(E)),S}var Cvt={kernelName:qy,backendName:"webgl",kernelFunc:EIn};N();function AIn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:f,activation:d,leakyreluAlpha:p}=r,m=[],h=c;h==null&&(h=[1,1]),A.assert(P.eitherStridesOrDilationsAreOne(l,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${h}'`);let g=P.computeConv2DInfo(i.shape,o.shape,l,h,u,f,!0),x=Z().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=d?gy(d,x):null,y=[i,o],v=s!=null,C=a!=null,_=d==="leakyrelu";if(v&&y.push(s),C&&y.push(a),_){let I=n.makeTensorInfo([],"float32",A.createScalarValue(p,"float32"));y.push(I),m.push(I)}let S;x?S=new nR(g,v,b,C,_):S=new tR(g,v,b,C,_);let E=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=n.runWebGLProgram(S,y,"float32",E);return m.forEach(I=>n.disposeIntermediateTensorInfo(I)),T}var _vt={kernelName:Hy,backendName:"webgl",kernelFunc:AIn};N();var kJ=class{constructor(t,n,r,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;let o=$t(r.length),s=`
    int index;`;for(let a=0;a<this.sliceDim;a++)s+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${s}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function TIn(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,o=i.shape,s=o[o.length-1],a=A.sizeFromShape(r.shape),[l,u,c,f]=P.prepareAndValidate(r,i),d=Ae({inputs:{x:i},backend:n,attrs:{shape:[u,s]}}),p=Ae({inputs:{x:r},backend:n,attrs:{shape:[A.sizeFromShape(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){let x=n.readSync(i.dataId),b=n.bufferSync(r),y=Gxt(x,b,r.dtype,u,s,c,f,r.shape,a);return n.makeTensorInfo(l,r.dtype,y.values)}let m=new kJ(s,f,[u,c],r.shape),h=n.runWebGLProgram(m,[p,d],p.dtype),g=Ae({inputs:{x:h},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),g}var Svt={kernelName:WC,backendName:"webgl",kernelFunc:TIn};N();var IJ=class{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;let r=$t(this.rank),i=kIn(t,2);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}};function kIn(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}function TSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:o}=t,{axis:s,batchDims:a}=r,l=A.parseAxisParam(s,i.shape)[0];if(Z().get("DEBUG")){let b=n.readSync(o.dataId),y=i.shape[l];for(let v=0;v<b.length;++v){let C=b[v];A.assert(C<=y-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${y-1}]`)}}let u=P.segment_util.collectGatherOpShapeInfo(i,o,l,a),c=A.sizeFromShape(o.shape),f=[],d=Ae({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=Ae({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});f.push(d),f.push(p);let m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([i,o])||i.dtype==="string"){let b=n.bufferSync(p),y=n.bufferSync(d),v=qxt(y,b,m);return f.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(u.outputShape,v.dtype,v.values)}let h=new IJ(d.shape,m),g=n.runWebGLProgram(h,[d,p],d.dtype);f.push(g);let x=Ae({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}var Evt={kernelName:Z0,backendName:"webgl",kernelFunc:TSe};N();var IIn="return float(a > b);",DIn=`
  return vec4(greaterThan(a, b));
`,NIn=Tn({opSnippet:IIn,packedOpSnippet:DIn,cpuKernelImpl:Hxt,dtype:"bool"}),Avt={kernelName:Py,backendName:"webgl",kernelFunc:NIn};N();var FIn="return float(a >= b);",RIn=`
  return vec4(greaterThanEqual(a, b));
`,OIn=Tn({opSnippet:FIn,packedOpSnippet:RIn,dtype:"bool",cpuKernelImpl:Yxt}),Tvt={kernelName:Gm,backendName:"webgl",kernelFunc:OIn};N();function MIn(e){let{inputs:t,backend:n}=e,{input:r}=t;return _J(r,!0,n)}var kvt={kernelName:GC,backendName:"webgl",kernelFunc:MIn};N();var $In="return float(!isnan(x) && !isinf(x));",PIn=tt({opSnippet:$In,dtype:"bool"}),Ivt={kernelName:qm,backendName:"webgl",kernelFunc:PIn};N();var LIn="return float(isinf(x));",BIn=tt({opSnippet:LIn,dtype:"bool"}),Dvt={kernelName:Hm,backendName:"webgl",kernelFunc:BIn};N();var zIn="return float(isnan(x));",UIn=tt({opSnippet:zIn,dtype:"bool"}),Nvt={kernelName:Ym,backendName:"webgl",kernelFunc:UIn};N();var jIn="return float(a < b);",VIn=`
  return vec4(lessThan(a, b));
`,WIn=Tn({opSnippet:jIn,packedOpSnippet:VIn,cpuKernelImpl:Kxt,dtype:"bool"}),Fvt={kernelName:Ly,backendName:"webgl",kernelFunc:WIn};N();var GIn="return float(a <= b);",qIn=`
  return vec4(lessThanEqual(a, b));
`,HIn=Tn({opSnippet:GIn,packedOpSnippet:qIn,cpuKernelImpl:Xxt,dtype:"bool"}),Rvt={kernelName:By,backendName:"webgl",kernelFunc:HIn};N();function YIn(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:o}=n,s=Zxt(r,i,o);return t.makeTensorInfo([s.length],"float32",s)}var Ovt={kernelName:HC,backendName:"webgl",kernelFunc:YIn};N();var KIn=wd+`
  return x < 0.0 ? 0./0. : log(x);
`,XIn=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,ZIn=tt({opSnippet:KIn,packedOpSnippet:XIn,cpuKernelImpl:Qxt}),Mvt={kernelName:Km,backendName:"webgl",kernelFunc:ZIn};N();var QIn=wd+`
  return log(1.0 + x);
`,JIn=tt({opSnippet:QIn}),$vt={kernelName:Xm,backendName:"webgl",kernelFunc:JIn};N();var eDn="return float(a >= 1.0 && b >= 1.0);",tDn=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,nDn=Tn({opSnippet:eDn,packedOpSnippet:tDn,dtype:"bool"}),Pvt={kernelName:zy,backendName:"webgl",kernelFunc:nDn};N();var rDn="return float(!(x >= 1.0));",iDn=tt({opSnippet:rDn}),Lvt={kernelName:Uy,backendName:"webgl",kernelFunc:iDn};N();var oDn="return float(a >= 1.0 || b >= 1.0);",sDn=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,aDn=Tn({opSnippet:oDn,packedOpSnippet:sDn,dtype:"bool"}),Bvt={kernelName:jy,backendName:"webgl",kernelFunc:aDn};N();var DJ=class{constructor(t,n,r,i,o){this.variableNames=["x"],this.outputShape=[];let s=n,a=t[3]-1;this.outputShape=t;let l,u=`float(${r}) + float(${i}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}};var NJ=class{constructor(t,n,r,i,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=n,a=t[3]-1;this.outputShape=t;let l,u=`float(${r}) + float(${i}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}};var lDn=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:o,bias:s,alpha:a,beta:l}=r,u=Z().getBool("WEBGL_PACK_NORMALIZATION")?new NJ(i.shape,o,s,a,l):new DJ(i.shape,o,s,a,l);return n.runWebGLProgram(u,[i],i.dtype)},zvt={kernelName:J0,backendName:"webgl",kernelFunc:lDn};N();var FJ=class{constructor(t,n,r,i,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}};var uDn=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i,y:o,dy:s}=t,{depthRadius:a,bias:l,alpha:u,beta:c}=r,f=new FJ(i.shape,a,l,u,c);return n.runWebGLProgram(f,[i,o,s],i.dtype)},Uvt={kernelName:YC,backendName:"webgl",kernelFunc:uDn};N();N();N();function jvt(e,t,n,r){let i=A.sizeFromShape(t),s=A.sizeFromShape(e.shape)/i,a=Ae({inputs:{x:e},attrs:{shape:[s,i]},backend:r}),l=ec(a,e.dtype,"max",r),u=Ae({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}function kSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:o,keepDims:s}=r,a=i.shape.length,l=A.parseAxisParam(o,i.shape),u=l,c=P.getAxesPermutation(u,a),f=c!=null,d=n.shouldExecuteOnCPU([i]),p=i;if(f){if(d){let y=n.texData.get(p.dataId).values,v=new Array(a);for(let S=0;S<v.length;S++)v[S]=i.shape[c[S]];let C=xA(y,i.shape,i.dtype,c,v);p=n.makeTensorInfo(v,i.dtype);let _=n.texData.get(p.dataId);_.values=C}else p=tC(i,c,n);u=P.getInnerMostAxes(u.length,a)}P.assertAxesAreInnerMostDims("max",u,a);let[m,h]=P.computeOutAndReduceShapes(p.shape,u),g=m;s&&(g=P.expandShapeToKeepDim(m,l));let x;if(d){let y=n.texData.get(p.dataId).values,v=Jxt(y,A.sizeFromShape(h),g,i.dtype);x=n.makeTensorInfo(g,i.dtype);let C=n.texData.get(x.dataId);C.values=v}else x=jvt(p,h,g,n);return f&&n.disposeIntermediateTensorInfo(p),x}var Vvt={kernelName:ex,backendName:"webgl",kernelFunc:kSe};N();var cDn=KF+`
  return max(a, b);
`,fDn=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ju+`
  return result;
`,dDn=Tn({opSnippet:cDn,packedOpSnippet:fDn,cpuKernelImpl:ebt}),Wvt={kernelName:Zm,backendName:"webgl",kernelFunc:dDn};N();function pDn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;x0(i,"maxPool");let{filterSize:o,strides:s,pad:a,dimRoundingMode:l}=r,u=1;A.assert(P.eitherStridesOrDilationsAreOne(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let c=P.computePool2DInfo(i.shape,o,s,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&A.arraysEqual(c.inShape,c.outShape))return gi({inputs:{x:i},backend:n});let f=new xm(c,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}var Gvt={kernelName:tx,backendName:"webgl",kernelFunc:pDn};N();function mDn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:o,strides:s,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],f=P.computePool3DInfo(i.shape,o,s,c,a,u,l),d=new nC(f,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}var qvt={kernelName:nx,backendName:"webgl",kernelFunc:mDn};N();var RJ=class{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;let n=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,o=t.effectiveFilterHeight,s=t.effectiveFilterWidth,a=o-1-t.padInfo.top,l=s-1-t.padInfo.left,u=o*s-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},OJ=class{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;let n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,a=t.dilationWidth,l=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,f=l-1-t.padInfo.front,d=u-1-t.padInfo.top,p=c-1-t.padInfo.left,m=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${d}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function hDn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o}=t,s=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],d=P.computePool3DInfo(s.shape,a,l,f,u,c),p=new nC(d,"max",!0),m=n.runWebGLProgram(p,[s],s.dtype),h=new OJ(d),g=n.runWebGLProgram(h,[i,m],s.dtype);return n.disposeIntermediateTensorInfo(m),g}var Hvt={kernelName:XC,backendName:"webgl",kernelFunc:hDn};N();function gDn(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:o,output:s}=t,a=o;x0([o,s],"maxPoolGrad");let{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,d=P.computePool2DInfo(a.shape,l,u,1,c,f),p=!0,m=new xm(d,"max",p),h=n.runWebGLProgram(m,[a],a.dtype),g=new RJ(d),x=n.runWebGLProgram(g,[i,h],a.dtype);return n.disposeIntermediateTensorInfo(h),x}var Yvt={kernelName:KC,backendName:"webgl",kernelFunc:gDn};N();N();function Kvt(e,t,n,r){let i=new xm(n,"max",!1),o=r.runWebGLProgram(i,[e],"float32");i=new xm(n,"max",!0,!0,t);let s=r.runWebGLProgram(i,[e],"float32");return[o,s]}var Xvt={kernelName:ZC,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:o,pad:s,includeBatchInIndex:a}=t,l=n;A.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let u=[1,1];A.assert(P.eitherStridesOrDilationsAreOne(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);let c=P.computePool2DInfo(r.shape,i,o,u,s),[f,d]=Kvt(r,a,c,l);return[f,d]}};N();N();function Zvt(e,t,n,r){let i=A.sizeFromShape(t),s=A.sizeFromShape(e.shape)/i,a=Ae({inputs:{x:e},attrs:{shape:[s,i]},backend:r}),l=ec(a,"float32","mean",r),u=Ae({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}var Qvt={kernelName:rx,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:i,axis:o}=t,s=n,a=r.shape.length,l=A.parseAxisParam(o,r.shape),u=l,c=P.getAxesPermutation(u,a),f=c!=null,d=s.shouldExecuteOnCPU([r]),p=[],m=r;if(f){if(d){let v=s.texData.get(m.dataId).values,C=new Array(a);for(let E=0;E<C.length;E++)C[E]=r.shape[c[E]];let _=xA(v,r.shape,r.dtype,c,C);m=s.makeTensorInfo(C,r.dtype);let S=s.texData.get(m.dataId);S.values=_}else m=tC(r,c,s);p.push(m),u=P.getInnerMostAxes(u.length,a)}P.assertAxesAreInnerMostDims("sum",u,a);let[h,g]=P.computeOutAndReduceShapes(m.shape,u),x=h;i&&(x=P.expandShapeToKeepDim(h,l));let b=Zvt(m,g,x,s);for(let y of p)s.disposeIntermediateTensorInfo(y);return b}};N();function xDn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r,a=i.shape.length,l=A.parseAxisParam(o,i.shape),u=l,c=P.getAxesPermutation(u,a),f=i;c!=null&&(f=$r({inputs:{x:i},backend:n,attrs:{perm:c}}),u=P.getInnerMostAxes(u.length,i.shape.length)),P.assertAxesAreInnerMostDims("min",u,a);let[d,p]=P.computeOutAndReduceShapes(f.shape,u),m=A.sizeFromShape(p),h=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,m]}}),g=ec(h,h.dtype,"min",n),x;if(s){let b=P.expandShapeToKeepDim(d,l);x=Ae({inputs:{x:g},backend:n,attrs:{shape:b}})}else x=Ae({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),x}var Jvt={kernelName:ix,backendName:"webgl",kernelFunc:xDn};N();var bDn=KF+`
  return min(a, b);
`,yDn=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ju+`
  return result;
`,vDn=Tn({opSnippet:bDn,packedOpSnippet:yDn,cpuKernelImpl:tbt}),e1t={kernelName:Qm,backendName:"webgl",kernelFunc:vDn};N();var MJ=class{constructor(t,n,r){this.variableNames=["x"],this.outputShape=n.map((c,f)=>c[0]+t[f]+c[1]);let i=t.length,o=$t(i),s=n.map(c=>c[0]).join(","),a=n.map((c,f)=>c[0]+t[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),u=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${s};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${s});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}};var $J=class{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((m,h)=>m[0]+t[h]+m[1]);let i=t.length,o=$t(i),s=n.map(m=>m[0]).join(","),a=n.map((m,h)=>m[0]+t[h]).join(","),l=hi("rc",i),u=hi("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,d=r==="reflect"?0:1,p="";if(i===1){let m=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;p=`
        ${o} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{let m=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;p=`
        ${o} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${m}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[i-1]} += 1;
          if(${c}) {
            ${m}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${s});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}};var wDn=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:i,mode:o}=n,s=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $J(r.shape,i,o):new MJ(r.shape,i,o);return t.runWebGLProgram(s,[r],r.dtype)},t1t={kernelName:ox,backendName:"webgl",kernelFunc:wDn};N();var CDn=`if (b == 0.0) return NAN;
  return mod(a, b);`,_Dn=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Ju+`
  return result;
`,SDn=Tn({opSnippet:CDn,packedOpSnippet:_Dn}),n1t={kernelName:Jm,backendName:"webgl",kernelFunc:SDn};N();var PJ=class{constructor(t,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}};N();N();var EDn=`
if (a == b) {
  return 1.0;
};
return a / b;`,ADn=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,ISe=Tn({opSnippet:EDn,packedOpSnippet:ADn,checkOutOfBounds:!0}),r1t={kernelName:Lm,backendName:"webgl",kernelFunc:ISe};N();var i1t="return a - b;",DSe=Tn({opSnippet:i1t,packedOpSnippet:i1t,supportsComplex:!0,cpuKernelImpl:Cbt}),o1t={kernelName:hh,backendName:"webgl",kernelFunc:DSe};function NSe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:o}=r,s=A.parseAxisParam([o],i.shape),a=kSe({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=P.expandShapeToKeepDim(a.shape,s),u=Ae({inputs:{x:a},backend:n,attrs:{shape:l}}),c=DSe({inputs:{a:i,b:u},backend:n}),f=ESe({inputs:{x:c},backend:n}),d=bA({inputs:{x:f},backend:n,attrs:{axis:s,keepDims:!1}}),p=Ae({inputs:{x:d},backend:n,attrs:{shape:l}}),m=ISe({inputs:{a:f,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),m}var s1t={kernelName:Cx,backendName:"webgl",kernelFunc:NSe};function TDn(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:o,seed:s,normalized:a}=r,l=a?i:NSe({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],f=new PJ(u,c,o),d=[[s]],p=n.runWebGLProgram(f,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),p}var a1t={kernelName:QC,backendName:"webgl",kernelFunc:TDn};N();var kDn=Xi+`
  return -x;
`,IDn=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function DDn(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){let o=n.texData.get(r.dataId),[s,a]=rbt(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,s)}let i;return Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Gl(r.shape,IDn):i=new is(r.shape,kDn),n.runWebGLProgram(i,[r],r.dtype)}var l1t={kernelName:sx,backendName:"webgl",kernelFunc:DDn};N();var NDn=Ko.nonMaxSuppressionV3Impl;function FDn(e){P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(i.dataId),c=n.readSync(o.dataId),{selectedIndices:f}=NDn(u,c,s,a,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}var u1t={kernelName:JC,backendName:"webgl",kernelFunc:FDn};N();var RDn=Ko.nonMaxSuppressionV4Impl;function ODn(e){P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(i.dataId),f=n.readSync(o.dataId),{selectedIndices:d,validOutputs:p}=RDn(c,f,s,a,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}var c1t={kernelName:e_,backendName:"webgl",kernelFunc:ODn};N();var MDn=Ko.nonMaxSuppressionV5Impl;function $Dn(e){P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:o}=t,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(i.dataId),f=n.readSync(o.dataId),d=s,p=a,m=l,h=u,{selectedIndices:g,selectedScores:x}=MDn(c,f,d,p,m,h);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}var f1t={kernelName:t_,backendName:"webgl",kernelFunc:$Dn};N();var LJ=class{constructor(t,n,r,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}};var PDn=e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:o,depth:s,onValue:a,offValue:l}=r,u=A.sizeFromShape(i.shape),c=new LJ(u,s,a,l),f=Ae({inputs:{x:i},backend:n,attrs:{shape:[u]}}),d=n.runWebGLProgram(c,[f],o);n.disposeIntermediateTensorInfo(f);let p=[...i.shape,s],m=Ae({inputs:{x:d},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(d),m},d1t={kernelName:lx,backendName:"webgl",kernelFunc:PDn};N();N();function X4(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){let i=xy({inputs:{input:r},backend:n}),o=X4({inputs:{x:i},backend:n}),s=vA({inputs:{input:r},backend:n}),a=X4({inputs:{x:s},backend:n}),l=Hl({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return by({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}var p1t={kernelName:Ex,backendName:"webgl",kernelFunc:X4};function m1t(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let i=xy({inputs:{input:r},backend:n}),o=m1t({inputs:{x:i},backend:n}),s=vA({inputs:{input:r},backend:n}),a=X4({inputs:{x:s},backend:n}),l=Hl({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return by({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}var h1t={kernelName:ax,backendName:"webgl",kernelFunc:m1t};N();function LDn(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return CJ({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let o=t[0].shape,s=t[0].dtype;t.forEach(c=>{A.assertShapesMatch(o,c.shape,"All tensors passed to stack must have matching shapes"),A.assert(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=t.map(c=>{let f=CJ({inputs:{input:c},backend:n,attrs:{dim:i}});return a.push(f),f}),u=SSe({inputs:l,backend:n,attrs:{axis:i}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}var g1t={kernelName:ux,backendName:"webgl",kernelFunc:LDn};N();var BJ=class{constructor(t,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+t[c]+u[1]);let i=t.length,o=$t(i),s=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+t[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${s};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${s});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}};var zJ=class{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((h,g)=>h[0]+t[g]+h[1]);let i=t.length,o=$t(i),s=n.map(h=>h[0]).join(","),a=n.map((h,g)=>h[0]+t[g]).join(","),l=hi("rc",i),u=hi("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,d=[`${o} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${c}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${c}) {`],p=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",m="";for(let h=0,g=i===1?2:4;h<g;h++)m+=`
        ${d[h]}
        if (${p}) {
          result[${h}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${h}] = getChannel(getX(${u.join()}), ${f});
        }
      `;m+=i===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${s});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}};var FSe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,constantValue:s}=r;if(A.sizeFromShape(i.shape)===0){let u=o.map((c,f)=>c[0]+i.shape[f]+c[1]);return by({backend:n,attrs:{shape:u,value:s,dtype:i.dtype}})}let a=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zJ(i.shape,o,s):new BJ(i.shape,o,s),l=[[s]];return n.runWebGLProgram(a,[i],i.dtype,l)},x1t={kernelName:cx,backendName:"webgl",kernelFunc:FSe};N();var BDn=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,zDn=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Ju+`
  return result;
`,UDn=Tn({opSnippet:BDn,packedOpSnippet:zDn}),b1t={kernelName:th,backendName:"webgl",kernelFunc:UDn};N();function jDn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r,a=i.shape.length,l=[],u=A.parseAxisParam(o,i.shape),c=u,f=P.getAxesPermutation(c,a),d=i;f!=null&&(d=$r({inputs:{x:i},backend:n,attrs:{perm:f}}),c=P.getInnerMostAxes(c.length,a),l.push(d)),P.assertAxesAreInnerMostDims("prod",c,a);let p;if(n.shouldExecuteOnCPU([d])){let m=n.texData.get(d.dataId).values,{outVals:h,outShape:g,outDtype:x}=obt(d.shape,d.dtype,m,c);p=n.makeTensorInfo(g,x,h)}else{let[m,h]=P.computeOutAndReduceShapes(d.shape,c),g=A.sizeFromShape(h),x=Ae({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),b=Xy(i.dtype),y=ec(x,b,"prod",n);p=Ae({inputs:{x:y},backend:n,attrs:{shape:m}}),l.push(x),l.push(y)}if(s){l.push(p);let m=P.expandShapeToKeepDim(p.shape,u);p=Ae({inputs:{x:p},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}var y1t={kernelName:dx,backendName:"webgl",kernelFunc:jDn};N();function VDn(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:o,indices:s}=t,{outputRaggedRank:a}=r,l=i.map(x=>n.readSync(x.dataId)),u=i.map(x=>x.shape),c=n.readSync(o.dataId),f=n.readSync(s.dataId),[d,p,m]=sbt(l,u,c,o.shape,o.dtype,f,s.shape,a),h=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),g=n.makeTensorInfo(m,o.dtype,p);return h.concat([g])}var v1t={kernelName:n_,backendName:"webgl",kernelFunc:VDn};N();function WDn(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:o}=t,s=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(o.dataId),[u,c]=abt(s,r.shape,r.dtype,a,i.shape,l,o.shape),f=n.makeTensorInfo([u.length],"int32",u),d=n.makeTensorInfo([c.length],r.dtype,c);return[f,d]}var w1t={kernelName:r_,backendName:"webgl",kernelFunc:WDn};N();function GDn(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:o,defaultValue:s,rowPartitionTensors:a}=t,{rowPartitionTypes:l}=r,u=n.readSync(i.dataId),c=n.readSync(o.dataId),f=n.readSync(s.dataId),d=a.map(g=>n.readSync(g.dataId)),p=a.map(g=>g.shape),[m,h]=lbt(u,i.shape,c,o.shape,o.dtype,f,s.shape,d,p,l);return n.makeTensorInfo(m,o.dtype,h)}var C1t={kernelName:i_,backendName:"webgl",kernelFunc:GDn};N();var RSe=e=>{let{backend:t,attrs:n}=e,{start:r,stop:i,step:o,dtype:s}=n,a=ubt(r,i,o,s);return t.makeTensorInfo([a.length],s,a)},_1t={kernelName:o_,backendName:"webgl",kernelFunc:RSe};N();var qDn="return 1.0 / x;",HDn=tt({opSnippet:qDn}),S1t={kernelName:nh,backendName:"webgl",kernelFunc:HDn};N();var YDn=Xi+`
  return (x < 0.0) ? 0.0 : x;
`,KDn=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XDn=tt({opSnippet:YDn,packedOpSnippet:KDn}),E1t={kernelName:rh,backendName:"webgl",kernelFunc:XDn};N();var ZDn=Xi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,QDn=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,JDn=tt({opSnippet:ZDn,packedOpSnippet:QDn}),A1t={kernelName:ih,backendName:"webgl",kernelFunc:JDn};N();var UJ=class{constructor(t,n,r,i,o){this.variableNames=["A"],this.outputShape=[];let[s,a,l,u]=t;this.outputShape=[s,n,r,u];let c=[i&&n>1?a-1:a,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d;o?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}};var jJ=class{constructor(t,n,r,i,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,a,l,u]=t;this.outputShape=[s,n,r,u];let c=[i&&n>1?a-1:a,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d;o?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function eNn(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:s,size:a}=r,[l,u]=a,c=Z().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new jJ(i.shape,l,u,o,s):new UJ(i.shape,l,u,o,s);return n.runWebGLProgram(c,[i],"float32")}var T1t={kernelName:hx,backendName:"webgl",kernelFunc:eNn};N();var VJ=class{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;let[,i,o]=n,[,s,a]=t,l=[r&&s>1?i-1:i,r&&a>1?o-1:o],u=[r&&s>1?s-1:s,r&&a>1?a-1:a],c=l[0]/u[0],f=l[1]/u[1],d=1/c,p=1/f,m=Math.ceil(d)*2+2,h=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${m});
        const int winWidth = int(${h});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function tNn(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:s}=r,a=new VJ(o.shape,i.shape,s);return n.runWebGLProgram(a,[o],o.dtype)}var k1t={kernelName:l_,backendName:"webgl",kernelFunc:tNn};N();var WJ=class{constructor(t,n,r,i,o){this.variableNames=["A"],this.outputShape=[];let[s,a,l,u]=t;this.outputShape=[s,n,r,u];let c=[i&&n>1?a-1:a,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d=i?"0.5":"0.0",p;o?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}};var GJ=class{constructor(t,n,r,i,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,a,l,u]=t;this.outputShape=[s,n,r,u];let c=[i&&n>1?a-1:a,i&&r>1?l-1:l],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d=i?"0.5":"0.0",p;o?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function nNn(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:s,size:a}=r,[l,u]=a,c=Z().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new GJ(i.shape,l,u,o,s):new WJ(i.shape,l,u,o,s);return n.runWebGLProgram(c,[i],i.dtype)}var I1t={kernelName:mx,backendName:"webgl",kernelFunc:nNn};N();var qJ=class{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;let[,i,o]=n,[,s,a]=t,l=[r&&s>1?i-1:i,r&&a>1?o-1:o],u=[r&&s>1?s-1:s,r&&a>1?a-1:a],c=l[0]/u[0],f=l[1]/u[1],d=1/c,p=1/f,m=Math.ceil(d)*2+2,h=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${m});
        const int winWidth = int(${h});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function rNn(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:o}=t,{alignCorners:s}=r,a=new qJ(o.shape,i.shape,s);return n.runWebGLProgram(a,[o],o.dtype)}var D1t={kernelName:a_,backendName:"webgl",kernelFunc:rNn};N();var HJ=class{constructor(t,n){this.variableNames=["x"];let r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}let i=a=>n.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,o=t.map((a,l)=>i(l)).join(","),s=$t(r);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}};var YJ=class{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;let i=hi("rc",r),o=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,a=$t(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${o}){
            result.g = ${u(i.slice())};
          }
          if(${s}) {
            result.b = ${c(i.slice())};
            if(${o}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return d(m)}function u(m){return m[r-1]="("+m[r-1]+" + 1)",d(m)}function c(m){return m[r-2]="("+m[r-2]+" + 1)",d(m)}function f(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",d(m)}function d(m){let h=t.map((b,y)=>p(y,m)),g=h.join(","),x=h.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${x}))`}function p(m,h){return n.indexOf(m)!==-1&&t[m]!==1?`${t[m]} - ${h[m]} - 1`:`${h[m]}`}}};function iNn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:o}=r,s=i.shape.length,a=A.parseAxisParam(o,i.shape);if(s===0)return gi({inputs:{x:i},backend:n});let l=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new YJ(i.shape,a):new HJ(i.shape,a);return n.runWebGLProgram(l,[i],i.dtype)}var N1t={kernelName:gx,backendName:"webgl",kernelFunc:iNn};N();N();var KJ=class{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let r=t[1],i=t[2];this.outputShape=t;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var F1t={kernelName:E_,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:o,center:s}=t,a=n,l=new KJ(r.shape,o),[u,c]=P.getImageCenter(s,r.shape[1],r.shape[2]),f=[[u,c,Math.sin(i),Math.cos(i)]];return a.runWebGLProgram(l,[r],r.dtype,f)}};N();var oNn=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,sNn=tt({opSnippet:oNn}),R1t={kernelName:oh,backendName:"webgl",kernelFunc:sNn};N();var aNn="return inversesqrt(x);",lNn=tt({opSnippet:aNn,cpuKernelImpl:cbt}),O1t={kernelName:sh,backendName:"webgl",kernelFunc:lNn};N();var rC=class{constructor(t,n,r,i,o,s,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;let u=$t(o.length),c=$t(s.length),f="";r===1?f="i":r===2&&(f="i, j");let d=`getIndices(${f})`,p="";i===1?p="i":i===2&&(p="i, coords[1]");let m=`getUpdates(${p})`,h="";l&&(h="coords[0], coords[1]");let g=`getDefaultValue(${h})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}};var XJ=class{constructor(t,n,r,i,o,s,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;let u=$t(o.length),c=$t(s.length),f="";r===1?f="i":r===2&&(f="i, j");let d=`getIndices(${f})`,p="";i===1?p="i":i===2&&(p="i, coords[1]");let m=`getUpdates(${p})`,h="";l&&(h="coords[0], coords[1]");let g=`getDefaultValue(${h})`,x=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}};function uNn(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:o}=t,{shape:s}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=P.calculateShapes(o,i,s),d=[f/u,u];if(f===0)return n.makeTensorInfo(s,i.dtype);let p=Ae({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),m=Ae({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),h=n.makeTensorInfo([],"float32",new Float32Array([0])),g;Z().getBool("WEBGL_PACK")?g=new XJ(l,a,p.shape.length,m.shape.length,c,d):g=new rC(l,a,p.shape.length,m.shape.length,c,d);let x=n.runWebGLProgram(g,[m,p,h],m.dtype),b=Ae({inputs:{x},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(h),b}var M1t={kernelName:u_,backendName:"webgl",kernelFunc:uNn};N();N();var ZJ=class{constructor(t,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];let o="while (left < right) {",s=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=Z().getNumber("WEBGL_VERSION")===2?o:s,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function cNn(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:o}=t,{side:s}=r,a=new ZJ(i.shape[0],i.shape[1],o.shape[1],s),l=[[i.shape[1]]];return n.runWebGLProgram(a,[i,o],"int32",l)}var $1t={kernelName:f_,backendName:"webgl",kernelFunc:cNn};N();var QJ=class{constructor(t,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",i="resRC";else{let a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<t&&l.push(`${a[c]}`);i=l.join(),o=u.join()}let s=$t(r);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}};function fNn(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:o}=t,s=new QJ(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(s,[r,i,o],yi(i.dtype,o.dtype))}var P1t={kernelName:xx,backendName:"webgl",kernelFunc:fNn};N();var dNn=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${P.SELU_SCALEALPHA};
  float scale = ${P.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,pNn=tt({opSnippet:dNn}),L1t={kernelName:ah,backendName:"webgl",kernelFunc:pNn};N();var mNn=wd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,hNn=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,gNn=tt({opSnippet:mNn,packedOpSnippet:hNn,cpuKernelImpl:dbt}),B1t={kernelName:fh,backendName:"webgl",kernelFunc:gNn};N();var xNn=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,bNn=tt({opSnippet:xNn}),z1t={kernelName:ch,backendName:"webgl",kernelFunc:bNn};N();var yNn=wd+`
  return sin(x);
`,vNn=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Ju}
  return result;
`,wNn=tt({opSnippet:yNn,packedOpSnippet:vNn}),U1t={kernelName:lh,backendName:"webgl",kernelFunc:wNn};N();var CNn=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,_Nn=tt({opSnippet:CNn}),j1t={kernelName:uh,backendName:"webgl",kernelFunc:_Nn};N();var SNn=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,ENn=tt({opSnippet:SNn}),V1t={kernelName:dh,backendName:"webgl",kernelFunc:ENn};N();var ANn=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,paddings:s}=r;A.assert(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let a=o.reduce((x,b)=>x*b),l=[[0,0]];l.push(...s);for(let x=1+o.length;x<i.shape.length;++x)l.push([0,0]);let u=[],c=FSe({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),f=P.getReshaped(c.shape,o,a,!1),d=P.getPermuted(f.length,o.length,!1),p=P.getReshapedPermuted(c.shape,o,a,!1),m=Ae({inputs:{x:c},backend:n,attrs:{shape:f}}),h=$r({inputs:{x:m},backend:n,attrs:{perm:d}}),g=Ae({inputs:{x:h},backend:n,attrs:{shape:p}});return u.push(c),u.push(m),u.push(h),u.forEach(x=>n.disposeIntermediateTensorInfo(x)),g},W1t={kernelName:vx,backendName:"webgl",kernelFunc:ANn};N();function TNn(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:o,defaultValue:s}=t;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);let a=n.readSync(r.dataId),l=n.readSync(i.dataId),u=n.readSync(o.dataId),c=n.readSync(s.dataId)[0],[f,d,p,m,h]=mbt(a,r.shape,r.dtype,l,i.dtype,u,c);return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(g=>Number(g)))),n.makeTensorInfo([h.length],r.dtype,new Int32Array(h))]}var G1t={kernelName:d_,backendName:"webgl",kernelFunc:TNn};N();function kNn(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:o}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);let s=Array.from(n.readSync(i.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,f]=hbt(a,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}var q1t={kernelName:p_,backendName:"webgl",kernelFunc:kNn};N();function INn(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);let s=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(o.dataId),[u,c]=RQ(s,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}var H1t={kernelName:m_,backendName:"webgl",kernelFunc:INn};N();function DNn(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);let s=n.readSync(r.dataId),a=n.readSync(i.dataId),l=n.readSync(o.dataId),[u,c]=RQ(s,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}var Y1t={kernelName:h_,backendName:"webgl",kernelFunc:DNn};N();function NNn(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:o,defaultValue:s}=t,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:d}=P.calculateShapes(o,i,a),p=!1;if(o.dtype==="string"){let x=n.bufferSync(i),b=n.bufferSync(o),y=A.decodeString(n.readSync(s.dataId)[0]),v=fbt(x,b,a,d,c,u,l,f,y,p);return n.makeTensorInfo(a,v.dtype,v.values)}let m=new rC(u,l,i.shape.length,o.shape.length,f,[d,1],p),h=n.runWebGLProgram(m,[o,i,s],o.dtype),g=Ae({inputs:{x:h},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(h),g}var K1t={kernelName:g_,backendName:"webgl",kernelFunc:NNn};N();function FNn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:o,axis:s}=r,a=A.parseAxisParam(s,i.shape)[0],l=P.prepareSplitSize(i,o,a),u=i.shape.length,c=new Array(u).fill(0),f=i.shape.slice();return l.map(d=>{let p=[...f];p[a]=d;let m=bm({inputs:{x:i},backend:n,attrs:{begin:c,size:p}});return c[a]+=d,m})}var X1t={kernelName:wx,backendName:"webgl",kernelFunc:FNn};N();var Z1t="return sqrt(x);",RNn=tt({opSnippet:Z1t,packedOpSnippet:Z1t,cpuKernelImpl:gbt}),Q1t={kernelName:ph,backendName:"webgl",kernelFunc:RNn};N();var ONn="return x * x;",MNn=tt({opSnippet:ONn}),J1t={kernelName:x_,backendName:"webgl",kernelFunc:MNn};N();var ewt="return (a - b) * (a - b);",$Nn=Tn({opSnippet:ewt,packedOpSnippet:ewt}),twt={kernelName:mh,backendName:"webgl",kernelFunc:$Nn};N();function PNn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");let o=n.readSync(i.dataId),s=P.fromUint8ToStringArray(o),a=xbt(s,"string",r);return n.makeTensorInfo(i.shape,"string",a)}var nwt={kernelName:Wy,backendName:"webgl",kernelFunc:PNn};N();function LNn({inputs:e,attrs:t,backend:n}){let{x:r}=e,i=Xi+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,o=new is(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}var rwt={kernelName:bh,backendName:"webgl",kernelFunc:LNn};N();var JJ=class{constructor(t,n,r){this.variableNames=["x"],this.outputShape=r;let i=r.length,o=$t(r.length),s=$t(r.length),a="";if(i===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${t});
      ${o} strides = ${o}(${n});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}};function BNn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,end:s,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:d}=r,{finalShapeSparse:p,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:x,begin:b,end:y,strides:v}=so.sliceInfo(i.shape,o,s,a,l,u,c,f,d),C;if(h)C=Ae({inputs:{x:i},backend:n,attrs:{shape:m}});else if(g||x){A.assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let S=so.computeOutShape(b,y,v),E=bm({inputs:{x:i},backend:n,attrs:{begin:b,size:S}});C=Ae({inputs:{x:E},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([i])){let E=n.readSync(i.dataId),T=et(i.shape,i.dtype,E),I=bbt(p,T,v,b);C=n.makeTensorInfo(m,i.dtype,I.values)}else{let E=new JJ(b,v,p);C=n.runWebGLProgram(E,[i],i.dtype)}let _=Ae({inputs:{x:C},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(C),_}var iwt={kernelName:b_,backendName:"webgl",kernelFunc:BNn};N();function zNn(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:o,leftPad:s,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=t,d=n.readSync(c.dataId),p=n.readSync(f.dataId),[m,h]=ybt(d,p,i,o,s,a,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(f.shape,"int32",h)]}var owt={kernelName:y_,backendName:"webgl",kernelFunc:zNn};N();function UNn(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:o,delimiter:s}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let a=n.readSync(o.dataId),l=n.readSync(s.dataId)[0],[u,c,f]=vbt(a,l,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}var swt={kernelName:v_,backendName:"webgl",kernelFunc:UNn};N();function jNn(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:o}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");let s=n.readSync(o.dataId),a=wbt(s,i);return n.makeTensorInfo(o.shape,"int32",a)}var awt={kernelName:w_,backendName:"webgl",kernelFunc:jNn};N();var VNn="return tan(x);",WNn=tt({opSnippet:VNn}),lwt={kernelName:gh,backendName:"webgl",kernelFunc:WNn};N();var GNn=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,qNn=tt({opSnippet:GNn}),uwt={kernelName:xh,backendName:"webgl",kernelFunc:qNn};N();function HNn(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:o,updates:s}=t,{}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=P.calculateShapes(s,o,i.shape),d=[f/u,u];if(f===0)return n.makeTensorInfo(i.shape,o.dtype);let p=Ae({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),m=Ae({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),h=Ae({inputs:{x:i},backend:n,attrs:{shape:d}}),g=new rC(l,a,p.shape.length,m.shape.length,c,d,!1,!0),x=n.runWebGLProgram(g,[m,p,h],h.dtype),b=Ae({inputs:{x},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(x),b}var cwt={kernelName:c_,backendName:"webgl",kernelFunc:HNn};N();var eee=class{constructor(t,n){this.variableNames=["A"];let r=new Array(t.length);for(let s=0;s<r.length;s++)r[s]=t[s]*n[s];this.outputShape=r,this.rank=r.length;let i=$t(this.rank),o=YNn(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}};function YNn(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}function OSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:o}=r;if(i.dtype==="string"||i.shape.length>5){let l=n.readSync(i.dataId),u=i.dtype==="string"?l.map(d=>A.decodeString(d)):l,c=et(i.shape,i.dtype,u),f=_bt(c,o);return n.makeTensorInfo(f.shape,f.dtype,f.values)}let s=new eee(i.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}var fwt={kernelName:Dd,backendName:"webgl",kernelFunc:OSe};N();var tee=class{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},nee=class{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function wA(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function dwt(e){let t=1;for(;t<e;)t*=2;return t}function KNn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:o,sorted:s}=r,a=Z().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Z().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([i])||c<a||o>l){let I=n.readSync(i.dataId),[k,O]=Sbt(I,u,i.dtype,o,s);return[n.makeTensorInfo(k.shape,k.dtype,k.values),n.makeTensorInfo(O.shape,O.dtype,O.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,i.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[i,by({attrs:{shape:u,dtype:"int32",value:0},backend:n})];let f=n.texData.get(i.dataId),d=f!==null&&f.isPacked,p=d?n.unpackTensor(i):i,h=A.sizeFromShape(u)/c,g=Ae({inputs:{x:p},attrs:{shape:[h,c]},backend:n});d&&wA(n,p);let x=dwt(o),b=dwt(c),y=null,v=()=>y===null?[g,g]:[g,y],C=(I,k,O)=>{let F=v(),B=new tee(O),z=[[c],[y===null?1:0],[Number.NEGATIVE_INFINITY],[I],[k]],W=y;y=n.runWebGLProgram(B,F,"int32",z),wA(n,W)};for(let I=1;I<x;I*=2){let k=I*2;for(let O=I;O>=1;O/=2)C(k,O,[h,b])}for(let I=b;I>x;I/=2){let k=v(),O=new nee([h,I/2]),B=[[c],[y===null?1:0],[x]],M=y;y=n.runWebGLProgram(O,k,"int32",B),wA(n,M);let z=x/2,W=z*2;for(let H=z;H>=1;H/=2)C(W,H,y.shape)}let _=y;y=bm({inputs:{x:y},backend:n,attrs:{begin:0,size:[h,o]}}),wA(n,_);let S=TSe({inputs:{x:g,indices:y},backend:n,attrs:{axis:1,batchDims:1}});wA(n,g);let E=u.slice(0,-1);E.push(o),_=y,y=Ae({inputs:{x:y},attrs:{shape:E},backend:n}),wA(n,_);let T=S;return S=Ae({inputs:{x:S},attrs:{shape:E},backend:n}),wA(n,T),[S,y]}var pwt={kernelName:C_,backendName:"webgl",kernelFunc:KNn};N();var ree=class{constructor(t,n,r,i,o,s){this.variableNames=["Image","Transforms"],this.outputShape=s;let a=r==="nearest"?1:2,l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function XNn(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:o}=t,{interpolation:s,fillMode:a,fillValue:l,outputShape:u}=r,[c,f,d,p]=i.shape,[m,h]=u??[f,d],g=[c,m,h,p],x=new ree(f,d,s,a,l,g);return n.runWebGLProgram(x,[i,o],"float32")}var mwt={kernelName:__,backendName:"webgl",kernelFunc:XNn};N();function ZNn(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:o}=t;x0(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=Ebt(s,i,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}var hwt={kernelName:S_,backendName:"webgl",kernelFunc:ZNn};N();function QNn(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:o}=r;o<0&&(o+=i.shape.length);let s=i,a=s.shape.length,l=i.shape[o],u=new Array(a-1),c=0;for(let h=0;h<a;h++)h!==o&&(u[c++]=s.shape[h]);let f=[],d=new Array(a).fill(0),p=s.shape.slice();p[o]=1;let m=new Array(l);for(let h=0;h<m.length;h++){d[o]=h;let g=bm({inputs:{x:s},backend:n,attrs:{begin:d,size:p}}),x=Ae({inputs:{x:g},backend:n,attrs:{shape:u}});m[h]=x,f.push(g)}return f.forEach(h=>n.disposeIntermediateTensorInfo(h)),m}var gwt={kernelName:_x,backendName:"webgl",kernelFunc:QNn};N();var iee=class{constructor(t,n){this.variableNames=["x","segmentIds"];let r=t.windowSize,i=t.batchSize,o=t.inSize,s=t.numSegments,a=s*Math.ceil(o/r);this.outputShape=[i,a];let l="0.0",u="sumValue",c=Math.floor(r/4)*4,f=r%4,d=`
        sumValue += dot(values, segFilter);
    `,p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let m="";o%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${u});
      }
    `}};function JNn(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:o}=t,{numSegments:s}=r,a=i.shape.length,l=[],u=0,c=P.getAxesPermutation([u],a),f=i;c!=null&&(f=$r({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(f),u=P.getInnerMostAxes(1,a)[0]);let d=P.segment_util.computeOutShape(f.shape,u,s),p=A.sizeFromShape([f.shape[u]]),m=Ae({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}});l.push(m);let h=Xy(i.dtype),g=(v,C,_,S,E)=>{let T=v.shape[0],I=v.shape[1],k=P.segment_util.segOpComputeOptimalWindowSize(I,E),O={windowSize:k,inSize:I,batchSize:T,numSegments:E},F=new iee(O,C),B=n.compileAndRun(F,[v,_],S);if(l.push(B),B.shape[1]===E)return B;let M=RSe({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),z=OSe({inputs:{x:M},backend:n,attrs:{reps:[I/k]}});return l.push(M),l.push(z),g(B,C,z,S,E)},x=g(m,"unsortedSegmentSum",o,h,s),b=Ae({inputs:{x},backend:n,attrs:{shape:d}}),y=b;if(c!=null){l.push(b);let v=P.getUndoAxesPermutation(c);y=$r({inputs:{x:y},backend:n,attrs:{perm:v}})}return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}var xwt={kernelName:Sx,backendName:"webgl",kernelFunc:JNn};var eFn=[Jbt,tyt,nyt,ryt,oyt,syt,ayt,lyt,fyt,dyt,pyt,myt,hyt,gyt,xyt,byt,yyt,vyt,wyt,Cyt,_yt,Eyt,Ayt,Tyt,kyt,Fyt,Oyt,Myt,Vbt,Pyt,Byt,zyt,Uyt,jyt,Vyt,Wyt,Gyt,qyt,Hyt,Yyt,Zyt,Qyt,Jyt,evt,tvt,nvt,rvt,ivt,ovt,svt,avt,lvt,uvt,cvt,fvt,dvt,mvt,hvt,gvt,xvt,yvt,vvt,wvt,Cvt,_vt,Svt,Evt,Avt,Tvt,jbt,kvt,Lyt,Ivt,Dvt,Nvt,Wbt,Fvt,Rvt,Ovt,Mvt,$vt,Pvt,Lvt,Bvt,zvt,Uvt,Vvt,Wvt,Gvt,qvt,Hvt,Yvt,Xvt,Qvt,Jvt,e1t,t1t,n1t,a1t,Hbt,l1t,u1t,c1t,f1t,Iyt,d1t,h1t,g1t,x1t,b1t,Gbt,y1t,v1t,w1t,C1t,_1t,Dyt,r1t,S1t,E1t,A1t,Kbt,T1t,k1t,I1t,D1t,N1t,F1t,R1t,O1t,M1t,$1t,P1t,L1t,B1t,z1t,U1t,j1t,Syt,s1t,V1t,W1t,G1t,q1t,H1t,Y1t,K1t,X1t,Q1t,J1t,twt,nwt,rwt,iwt,owt,swt,awt,o1t,Zbt,lwt,uwt,cwt,fwt,pwt,mwt,Qbt,hwt,gwt,xwt,p1t];for(let e of eFn)oT(e);N();var tFn=["vis"],vwt=(()=>{let t=class t{get settings(){return this._tensorflowSettings.getValue()}set settings(r){this._tensorflowSettings.getValue()!==r&&this._tensorflowSettings.next(r)}constructor(){this.modelTrainned=new Uo,this._tensorflowSettings=new os(null),this.settings$=this._tensorflowSettings.asObservable().pipe(w0(),mR({bufferSize:1,refCount:!0})),this.settings$.pipe(xi(r=>te(this,null,function*(){if(r){let{inputs:i,labels:o,mainLayers:s,finalLayer:a}=r,l=jd(i,[i.length,2],"float32"),u=xr(o);this.model=Zwe(),s.forEach(p=>this.model.add(p)),this.model.add(a),this.model.compile(r.compiler),this.model.compile({optimizer:Cf.adam(),loss:"sparseCategoricalCrossentropy",metrics:["accuracy"]});let c={name:"show.fitCallbacks",tab:"Training",drawArea:this.container?.nativeElement},f={onTrainEnd:()=>{alert("Training complete!"),this.modelTrainned.emit(this.model)}},d=Qi(Ze({},r.fit),{callbacks:[ywt.show.fitCallbacks(c,["loss","acc"]),f]});yield this.model.fit(l,u,d)}}))).subscribe()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=eo({type:t,selectors:[["app-tensorflow-visualization"]],viewQuery:function(i,o){if(i&1&&ff(tFn,7),i&2){let s;il(s=ol())&&(o.container=s.first)}},inputs:{settings:"settings"},outputs:{modelTrainned:"modelTrainned"},standalone:!0,features:[to],decls:3,vars:0,consts:[["vis",""],[1,"container"]],template:function(i,o){i&1&&(xo(0,"div",1),ma(1,"div",null,0),jo())},styles:[".container[_ngcontent-%COMP%]{background:#fff;width:100%;height:100%;margin-top:40px}"]});let e=t;return e})();var zo=tc(wwt());var rFn=["canvas"];function iFn(e,t){if(e&1){let n=k0();xo(0,"app-tensorflow-visualization",3),cf("modelTrainned",function(i){_0(n);let o=wm();return S0(o.modelTrainned(i))}),jo()}if(e&2){let n=wm();T0("settings",n.settings)}}var $Se=function(e){return e[e.Nothing=0]="Nothing",e[e.Jump=1]="Jump",e}($Se||{}),Cwt=(()=>{let t=class t{get model(){return this._model.getValue()}set model(r){this._model.getValue()!==r&&this._model.next(r)}constructor(){this.screenYSize=window.innerHeight,this.data=[],this.inputs=[],this.labels=[],this._model=new os(null),this.model$=this._model.asObservable().pipe(w0(),mR({bufferSize:1,refCount:!0})),this.obstacles=[],this.target=[],this.obstacleFrequency=1500,this.nextYellowPointX=0,this.birdX=0;let r=this.creatingDataToTraining();this.settingTensorflow()}ngOnInit(){this.canvas,this._model.subscribe(r=>{r&&(this.initMatterJS(),this.createBird(),this.createGround(),this.createObstacles(),this.startGame())})}initMatterJS(){this.engine=zo.default.Engine.create(),this.render=zo.default.Render.create({canvas:this.canvas.nativeElement,engine:this.engine,options:{width:window.innerWidth,height:window.innerHeight,wireframes:!1,background:"#87CEEB"}}),zo.default.Render.run(this.render);let r=zo.default.Runner.create();zo.default.Runner.run(r,this.engine)}createBird(){this.bird=zo.default.Bodies.rectangle(100,window.innerHeight/2,40,40,{render:{fillStyle:"yellow"}}),zo.default.World.add(this.engine.world,this.bird)}createGround(){this.ground=zo.default.Bodies.rectangle(window.innerWidth/2,window.innerHeight-20,window.innerWidth,40,{isStatic:!0,render:{fillStyle:"green"}}),zo.default.World.add(this.engine.world,this.ground)}createObstacles(){let r=window.innerWidth+100,i=200,o=80,s=120,a=Math.random()*(window.innerHeight-s),l=window.innerHeight-a-s,u=zo.default.Bodies.rectangle(r,a/2,o,a,{isStatic:!0,render:{fillStyle:"brown"}}),c=zo.default.Bodies.rectangle(r,window.innerHeight-l/2,o,l,{isStatic:!0,render:{fillStyle:"brown"}}),f=a+100,d=zo.default.Bodies.circle(r,f,5,{isStatic:!0,render:{fillStyle:"yellow"}});this.obstacles.push(u),this.obstacles.push(c),this.obstacles.push(d),this.target.push(d),zo.default.World.add(this.engine.world,this.obstacles)}startGame(){zo.default.Events.on(this.engine,"collisionStart",r=>{r.pairs.forEach(o=>{o.bodyA===this.bird&&o.bodyB===this.obstacles[2]||o.bodyB===this.bird&&o.bodyA===this.obstacles[2]?o.isActive=!1:(o.bodyA===this.bird||o.bodyB===this.bird)&&(alert("Game over"),window.location.reload())})}),zo.default.Events.on(this.engine,"beforeUpdate",()=>{this.obstacles.forEach(r=>{zo.default.Body.translate(r,{x:-2,y:0}),r.position.x<-80&&zo.default.Composite.remove(this.engine.world,r),this.birdX=this.bird.position.y,this.nextYellowPointX=r.position.y;let i=as([[this.birdX,this.nextYellowPointX]]),o=["Nothing","JUMP"],a=(this.model?.predict(i)).argMax(1).arraySync()[0],l=o[a];l==="JUMP"&&zo.default.Body.setVelocity(this.bird,{x:0,y:-4}),console.log(l)}),this.obstacles[this.obstacles.length-1].position.x<window.innerWidth-400&&this.createObstacles()})}handleSpace(r){r.code==="Space"&&zo.default.Body.setVelocity(this.bird,{x:0,y:-4})}settingTensorflow(){this.inputs=this.data.map(r=>[r.yAgent,r.yTarget]),this.labels=this.data.map(r=>Number(r.action)),this.settings={compiler:{optimizer:Cf.adam(),loss:"sparseCategoricalCrossentropy",metrics:["accuracy"]},fit:{batchSize:128,epochs:10},inputs:this.inputs,labels:this.labels,mainLayers:[I4.dense({units:10,activation:"relu",inputShape:[2]})],finalLayer:I4.dense({units:2,activation:"softmax"})}}creatingDataToTraining(){for(let r=0;r<this.screenYSize;r+=10)for(let i=0;i<this.screenYSize;i+=10)i<r?this.data.push({yAgent:i,yTarget:r,action:$Se.Nothing}):this.data.push({yAgent:i,yTarget:r,action:$Se.Jump});return JSON.stringify(this.data)}modelTrainned(r){this.model=r}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=eo({type:t,selectors:[["app-flappy-bird-supervised"]],viewQuery:function(i,o){if(i&1&&ff(rFn,7),i&2){let s;il(s=ol())&&(o.canvas=s.first)}},hostBindings:function(i,o){i&1&&cf("keydown.space",function(a){return o.handleSpace(a)},!1,NEe)},standalone:!0,features:[to],decls:4,vars:1,consts:[["canvas",""],["ngi","",3,"settings","modelTrainned",4,"ngIf"],[2,"background","white","margin-top","200px"],["ngi","",3,"modelTrainned","settings"]],template:function(i,o){i&1&&(xo(0,"div"),A0(1,iFn,1,1,"app-tensorflow-visualization",1),ma(2,"canvas",2,0),jo()),i&2&&(Ed(),T0("ngIf",o.model===null))},dependencies:[I0,KEe,vwt],styles:["canvas[_ngcontent-%COMP%]{display:block;width:100%;height:100%}"]});let e=t;return e})();var _wt=[{path:"",component:Cwt}];var oFn="@",sFn=(()=>{let t=class t{constructor(r,i,o,s,a){this.doc=r,this.delegate=i,this.zone=o,this.animationType=s,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=ut(FEe,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-TFQ2HNKN.js").then(i=>i)).catch(i=>{throw new Fi(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:o})=>{this._engine=i(this.animationType,this.doc);let s=new o(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(r,i){let o=this.delegate.createRenderer(r,i);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let s=new PSe(o);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let l=a.createRenderer(r,i);s.use(l),this.scheduler?.notify(9)}).catch(a=>{s.use(o)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};t.\u0275fac=function(i){wR()},t.\u0275prov=Ct({token:t,factory:t.\u0275fac});let e=t;return e})(),PSe=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let n of this.replay)n(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,n){this.delegate.appendChild(t,n)}insertBefore(t,n,r,i){this.delegate.insertBefore(t,n,r,i)}removeChild(t,n,r){this.delegate.removeChild(t,n,r)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,r,i){this.delegate.setAttribute(t,n,r,i)}removeAttribute(t,n,r){this.delegate.removeAttribute(t,n,r)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,r,i){this.delegate.setStyle(t,n,r,i)}removeStyle(t,n,r){this.delegate.removeStyle(t,n,r)}setProperty(t,n,r){this.shouldReplay(n)&&this.replay.push(i=>i.setProperty(t,n,r)),this.delegate.setProperty(t,n,r)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,r){return this.shouldReplay(n)&&this.replay.push(i=>i.listen(t,n,r)),this.delegate.listen(t,n,r)}shouldReplay(t){return this.replay!==null&&t.startsWith(oFn)}};function Swt(e="animations"){return REe("NgAsyncAnimations"),gR([{provide:m5,useFactory:(t,n,r)=>new sFn(t,n,r,e),deps:[dn,y5,vn]},{provide:Sd,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Ewt={providers:[VEe({eventCoalescing:!0}),Z2e(_wt),Swt()]};var BSe;try{BSe=typeof Intl<"u"&&Intl.v8BreakIterator}catch{BSe=!1}var Di=(()=>{let t=class t{constructor(r){this._platformId=r,this.isBrowser=this._platformId?ZEe(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||BSe)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};t.\u0275fac=function(i){return new(i||t)(Oe(cC))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Q4;function aFn(){if(Q4==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Q4=!0}))}finally{Q4=Q4||!1}return Q4}function iR(e){return aFn()?e:!!e.capture}var ym=function(e){return e[e.NORMAL=0]="NORMAL",e[e.NEGATED=1]="NEGATED",e[e.INVERTED=2]="INVERTED",e}(ym||{}),oee,CA;function see(){if(CA==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return CA=!1,CA;if("scrollBehavior"in document.documentElement.style)CA=!0;else{let e=Element.prototype.scrollTo;e?CA=!/\{\s*\[native code\]\s*\}/.test(e.toString()):CA=!1}}return CA}function oR(){if(typeof document!="object"||!document)return ym.NORMAL;if(oee==null){let e=document.createElement("div"),t=e.style;e.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";let n=document.createElement("div"),r=n.style;r.width="2px",r.height="1px",e.appendChild(n),document.body.appendChild(e),oee=ym.NORMAL,e.scrollLeft===0&&(e.scrollLeft=1,oee=e.scrollLeft===0?ym.NEGATED:ym.INVERTED),e.remove()}return oee}var LSe;function lFn(){if(LSe==null){let e=typeof document<"u"?document.head:null;LSe=!!(e&&(e.createShadowRoot||e.attachShadow))}return LSe}function Awt(e){if(lFn()){let t=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Cd(e){return e.composedPath?e.composedPath()[0]:e.target}function J4(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Twt(e,...t){return t.length?t.some(n=>e[n]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function SA(e){return e!=null&&`${e}`!="false"}function sR(e){return Array.isArray(e)?e:[e]}function ho(e){return e==null?"":typeof e=="string"?e:`${e}px`}function yy(e){return e instanceof Pr?e.nativeElement:e}var uFn=(()=>{let t=class t{create(r){return typeof MutationObserver>"u"?null:new MutationObserver(r)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var kwt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({providers:[uFn]});let e=t;return e})();var Iwt=new Set,EA,cFn=(()=>{let t=class t{constructor(r,i){this._platform=r,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):dFn}matchMedia(r){return(this._platform.WEBKIT||this._platform.BLINK)&&fFn(r,this._nonce),this._matchMedia(r)}};t.\u0275fac=function(i){return new(i||t)(Oe(Di),Oe(yR,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function fFn(e,t){if(!Iwt.has(e))try{EA||(EA=document.createElement("style"),t&&EA.setAttribute("nonce",t),EA.setAttribute("type","text/css"),document.head.appendChild(EA)),EA.sheet&&(EA.sheet.insertRule(`@media ${e} {body{ }}`,0),Iwt.add(e))}catch(n){console.error(n)}}function dFn(e){return{matches:e==="all"||e==="",media:e,addListener:()=>{},removeListener:()=>{}}}var Nwt=(()=>{let t=class t{constructor(r,i){this._mediaMatcher=r,this._zone=i,this._queries=new Map,this._destroySubject=new qn}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(r){return Dwt(sR(r)).some(o=>this._registerQuery(o).mql.matches)}observe(r){let o=Dwt(sR(r)).map(a=>this._registerQuery(a).observable),s=cR(o);return s=l5(s.pipe(Yl(1)),s.pipe(c5(1),dR(0))),s.pipe(on(a=>{let l={matches:!1,breakpoints:{}};return a.forEach(({matches:u,query:c})=>{l.matches=l.matches||u,l.breakpoints[c]=u}),l}))}_registerQuery(r){if(this._queries.has(r))return this._queries.get(r);let i=this._mediaMatcher.matchMedia(r),s={observable:new kA(a=>{let l=u=>this._zone.run(()=>a.next(u));return i.addListener(l),()=>{i.removeListener(l)}}).pipe(Iy(i),on(({matches:a})=>({query:r,matches:a})),Ji(this._destroySubject)),mql:i};return this._queries.set(r,s),s}};t.\u0275fac=function(i){return new(i||t)(Oe(cFn),Oe(vn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Dwt(e){return e.map(t=>t.split(",")).reduce((t,n)=>t.concat(n)).map(t=>t.trim())}var jSe=(()=>{let t=class t{constructor(r){this._platform=r}isDisabled(r){return r.hasAttribute("disabled")}isVisible(r){return mFn(r)&&getComputedStyle(r).visibility==="visible"}isTabbable(r){if(!this._platform.isBrowser)return!1;let i=pFn(CFn(r));if(i&&(Fwt(i)===-1||!this.isVisible(i)))return!1;let o=r.nodeName.toLowerCase(),s=Fwt(r);return r.hasAttribute("contenteditable")?s!==-1:o==="iframe"||o==="object"||this._platform.WEBKIT&&this._platform.IOS&&!vFn(r)?!1:o==="audio"?r.hasAttribute("controls")?s!==-1:!1:o==="video"?s===-1?!1:s!==null?!0:this._platform.FIREFOX||r.hasAttribute("controls"):r.tabIndex>=0}isFocusable(r,i){return wFn(r)&&!this.isDisabled(r)&&(i?.ignoreVisibility||this.isVisible(r))}};t.\u0275fac=function(i){return new(i||t)(Oe(Di))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function pFn(e){try{return e.frameElement}catch{return null}}function mFn(e){return!!(e.offsetWidth||e.offsetHeight||typeof e.getClientRects=="function"&&e.getClientRects().length)}function hFn(e){let t=e.nodeName.toLowerCase();return t==="input"||t==="select"||t==="button"||t==="textarea"}function gFn(e){return bFn(e)&&e.type=="hidden"}function xFn(e){return yFn(e)&&e.hasAttribute("href")}function bFn(e){return e.nodeName.toLowerCase()=="input"}function yFn(e){return e.nodeName.toLowerCase()=="a"}function Mwt(e){if(!e.hasAttribute("tabindex")||e.tabIndex===void 0)return!1;let t=e.getAttribute("tabindex");return!!(t&&!isNaN(parseInt(t,10)))}function Fwt(e){if(!Mwt(e))return null;let t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}function vFn(e){let t=e.nodeName.toLowerCase(),n=t==="input"&&e.type;return n==="text"||n==="password"||t==="select"||t==="textarea"}function wFn(e){return gFn(e)?!1:hFn(e)||xFn(e)||e.hasAttribute("contenteditable")||Mwt(e)}function CFn(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}var USe=class{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,n,r,i,o=!1,s){this._element=t,this._checker=n,this._ngZone=r,this._document=i,this._injector=s,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}destroy(){let t=this._startAnchor,n=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),n&&(n.removeEventListener("focus",this.endAnchorListener),n.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(n=>{this._executeOnStable(()=>n(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(n=>{this._executeOnStable(()=>n(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(n=>{this._executeOnStable(()=>n(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){let n=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return t=="start"?n.length?n[0]:this._getFirstTabbableElement(this._element):n.length?n[n.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){let n=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(n){if(!this._checker.isFocusable(n)){let r=this._getFirstTabbableElement(n);return r?.focus(t),!!r}return n.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){let n=this._getRegionBoundary("start");return n&&n.focus(t),!!n}focusLastTabbableElement(t){let n=this._getRegionBoundary("end");return n&&n.focus(t),!!n}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let n=t.children;for(let r=0;r<n.length;r++){let i=n[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(n[r]):null;if(i)return i}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let n=t.children;for(let r=n.length-1;r>=0;r--){let i=n[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(n[r]):null;if(i)return i}return null}_createAnchor(){let t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,n){t?n.setAttribute("tabindex","0"):n.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?this._injector?E0(t,{injector:this._injector}):t():this._ngZone.onStable.pipe(Yl(1)).subscribe(t)}},$wt=(()=>{let t=class t{constructor(r,i,o){this._checker=r,this._ngZone=i,this._injector=ut(nc),this._document=o}create(r,i=!1){return new USe(r,this._checker,this._ngZone,this._document,i,this._injector)}};t.\u0275fac=function(i){return new(i||t)(Oe(jSe),Oe(vn),Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function VSe(e){return e.buttons===0||e.detail===0}function WSe(e){let t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}var _Fn=new kn("cdk-input-modality-detector-options"),SFn={ignoreKeys:[18,17,224,91,16]},Pwt=650,aR=iR({passive:!0,capture:!0}),EFn=(()=>{let t=class t{get mostRecentModality(){return this._modality.value}constructor(r,i,o,s){this._platform=r,this._mostRecentTarget=null,this._modality=new os(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(l=>l===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Cd(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<Pwt||(this._modality.next(VSe(a)?"keyboard":"mouse"),this._mostRecentTarget=Cd(a))},this._onTouchstart=a=>{if(WSe(a)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Cd(a)},this._options=Ze(Ze({},SFn),s),this.modalityDetected=this._modality.pipe(c5(1)),this.modalityChanged=this.modalityDetected.pipe(w0()),r.isBrowser&&i.runOutsideAngular(()=>{o.addEventListener("keydown",this._onKeydown,aR),o.addEventListener("mousedown",this._onMousedown,aR),o.addEventListener("touchstart",this._onTouchstart,aR)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,aR),document.removeEventListener("mousedown",this._onMousedown,aR),document.removeEventListener("touchstart",this._onTouchstart,aR))}};t.\u0275fac=function(i){return new(i||t)(Oe(Di),Oe(vn),Oe(dn),Oe(_Fn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var lee=function(e){return e[e.IMMEDIATE=0]="IMMEDIATE",e[e.EVENTUAL=1]="EVENTUAL",e}(lee||{}),AFn=new kn("cdk-focus-monitor-default-options"),aee=iR({passive:!0,capture:!0}),uee=(()=>{let t=class t{constructor(r,i,o,s,a){this._ngZone=r,this._platform=i,this._inputModalityDetector=o,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new qn,this._rootNodeFocusAndBlurListener=l=>{let u=Cd(l);for(let c=u;c;c=c.parentElement)l.type==="focus"?this._onFocus(l,c):this._onBlur(l,c)},this._document=s,this._detectionMode=a?.detectionMode||lee.IMMEDIATE}monitor(r,i=!1){let o=yy(r);if(!this._platform.isBrowser||o.nodeType!==1)return Nt();let s=Awt(o)||this._getDocument(),a=this._elementInfo.get(o);if(a)return i&&(a.checkChildren=!0),a.subject;let l={checkChildren:i,subject:new qn,rootNode:s};return this._elementInfo.set(o,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(r){let i=yy(r),o=this._elementInfo.get(i);o&&(o.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(o))}focusVia(r,i,o){let s=yy(r),a=this._getDocument().activeElement;s===a?this._getClosestElementsInfo(s).forEach(([l,u])=>this._originChanged(l,i,u)):(this._setOrigin(i),typeof s.focus=="function"&&s.focus(o))}ngOnDestroy(){this._elementInfo.forEach((r,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(r){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(r)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:r&&this._isLastInteractionFromInputLabel(r)?"mouse":"program"}_shouldBeAttributedToTouch(r){return this._detectionMode===lee.EVENTUAL||!!r?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(r,i){r.classList.toggle("cdk-focused",!!i),r.classList.toggle("cdk-touch-focused",i==="touch"),r.classList.toggle("cdk-keyboard-focused",i==="keyboard"),r.classList.toggle("cdk-mouse-focused",i==="mouse"),r.classList.toggle("cdk-program-focused",i==="program")}_setOrigin(r,i=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=r,this._originFromTouchInteraction=r==="touch"&&i,this._detectionMode===lee.IMMEDIATE){clearTimeout(this._originTimeoutId);let o=this._originFromTouchInteraction?Pwt:1;this._originTimeoutId=setTimeout(()=>this._origin=null,o)}})}_onFocus(r,i){let o=this._elementInfo.get(i),s=Cd(r);!o||!o.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),o)}_onBlur(r,i){let o=this._elementInfo.get(i);!o||o.checkChildren&&r.relatedTarget instanceof Node&&i.contains(r.relatedTarget)||(this._setClasses(i),this._emitOrigin(o,null))}_emitOrigin(r,i){r.subject.observers.length&&this._ngZone.run(()=>r.subject.next(i))}_registerGlobalListeners(r){if(!this._platform.isBrowser)return;let i=r.rootNode,o=this._rootNodeFocusListenerCount.get(i)||0;o||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,aee),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,aee)}),this._rootNodeFocusListenerCount.set(i,o+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Ji(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(r){let i=r.rootNode;if(this._rootNodeFocusListenerCount.has(i)){let o=this._rootNodeFocusListenerCount.get(i);o>1?this._rootNodeFocusListenerCount.set(i,o-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,aee),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,aee),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(r,i,o){this._setClasses(r,i),this._emitOrigin(o,i),this._lastFocusOrigin=i}_getClosestElementsInfo(r){let i=[];return this._elementInfo.forEach((o,s)=>{(s===r||o.checkChildren&&s.contains(r))&&i.push([s,o])}),i}_isLastInteractionFromInputLabel(r){let{_mostRecentTarget:i,mostRecentModality:o}=this._inputModalityDetector;if(o!=="mouse"||!i||i===r||r.nodeName!=="INPUT"&&r.nodeName!=="TEXTAREA"||r.disabled)return!1;let s=r.labels;if(s){for(let a=0;a<s.length;a++)if(s[a].contains(i))return!0}return!1}};t.\u0275fac=function(i){return new(i||t)(Oe(vn),Oe(Di),Oe(EFn),Oe(dn,8),Oe(AFn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var AA=function(e){return e[e.NONE=0]="NONE",e[e.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",e[e.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",e}(AA||{}),Rwt="cdk-high-contrast-black-on-white",Owt="cdk-high-contrast-white-on-black",zSe="cdk-high-contrast-active",Lwt=(()=>{let t=class t{constructor(r,i){this._platform=r,this._document=i,this._breakpointSubscription=ut(Nwt).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return AA.NONE;let r=this._document.createElement("div");r.style.backgroundColor="rgb(1,2,3)",r.style.position="absolute",this._document.body.appendChild(r);let i=this._document.defaultView||window,o=i&&i.getComputedStyle?i.getComputedStyle(r):null,s=(o&&o.backgroundColor||"").replace(/ /g,"");switch(r.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return AA.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return AA.BLACK_ON_WHITE}return AA.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let r=this._document.body.classList;r.remove(zSe,Rwt,Owt),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===AA.BLACK_ON_WHITE?r.add(zSe,Rwt):i===AA.WHITE_ON_BLACK&&r.add(zSe,Owt)}}};t.\u0275fac=function(i){return new(i||t)(Oe(Di),Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var TFn=new kn("cdk-dir-doc",{providedIn:"root",factory:kFn});function kFn(){return ut(dn)}var IFn=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function DFn(e){let t=e?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?IFn.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var lR=(()=>{let t=class t{constructor(r){if(this.value="ltr",this.change=new Uo,r){let i=r.body?r.body.dir:null,o=r.documentElement?r.documentElement.dir:null;this.value=DFn(i||o||"ltr")}}ngOnDestroy(){this.change.complete()}};t.\u0275fac=function(i){return new(i||t)(Oe(TFn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var iC=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({});let e=t;return e})();function FFn(){return!0}var RFn=new kn("mat-sanity-checks",{providedIn:"root",factory:FFn}),Zi=(()=>{let t=class t{constructor(r,i,o){this._sanityChecks=i,this._document=o,this._hasDoneGlobalChecks=!1,r._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(r){return J4()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[r]}};t.\u0275fac=function(i){return new(i||t)(Oe(Lwt),Oe(RFn,8),Oe(dn))},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[iC,iC]});let e=t;return e})();var _d=function(e){return e[e.FADING_IN=0]="FADING_IN",e[e.VISIBLE=1]="VISIBLE",e[e.FADING_OUT=2]="FADING_OUT",e[e.HIDDEN=3]="HIDDEN",e}(_d||{}),YSe=class{constructor(t,n,r,i=!1){this._renderer=t,this.element=n,this.config=r,this._animationForciblyDisabledThroughCss=i,this.state=_d.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},zwt=iR({passive:!0,capture:!0}),KSe=class{constructor(){this._events=new Map,this._delegateEventHandler=t=>{let n=Cd(t);n&&this._events.get(t.type)?.forEach((r,i)=>{(i===n||i.contains(n))&&r.forEach(o=>o.handleEvent(t))})}}addHandler(t,n,r,i){let o=this._events.get(n);if(o){let s=o.get(r);s?s.add(i):o.set(r,new Set([i]))}else this._events.set(n,new Map([[r,new Set([i])]])),t.runOutsideAngular(()=>{document.addEventListener(n,this._delegateEventHandler,zwt)})}removeHandler(t,n,r){let i=this._events.get(t);if(!i)return;let o=i.get(n);o&&(o.delete(r),o.size===0&&i.delete(n),i.size===0&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,zwt)))}},Uwt={enterDuration:225,exitDuration:150},OFn=800,jwt=iR({passive:!0,capture:!0}),Vwt=["mousedown","touchstart"],Wwt=["mouseup","mouseleave","touchend","touchcancel"],e5=class e5{constructor(t,n,r,i){this._target=t,this._ngZone=n,this._platform=i,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=yy(r))}fadeInRipple(t,n,r={}){let i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o=Ze(Ze({},Uwt),r.animation);r.centered&&(t=i.left+i.width/2,n=i.top+i.height/2);let s=r.radius||MFn(t,n,i),a=t-i.left,l=n-i.top,u=o.enterDuration,c=document.createElement("div");c.classList.add("mat-ripple-element"),c.style.left=`${a-s}px`,c.style.top=`${l-s}px`,c.style.height=`${s*2}px`,c.style.width=`${s*2}px`,r.color!=null&&(c.style.backgroundColor=r.color),c.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(c);let f=window.getComputedStyle(c),d=f.transitionProperty,p=f.transitionDuration,m=d==="none"||p==="0s"||p==="0s, 0s"||i.width===0&&i.height===0,h=new YSe(this,c,r,m);c.style.transform="scale3d(1, 1, 1)",h.state=_d.FADING_IN,r.persistent||(this._mostRecentTransientRipple=h);let g=null;return!m&&(u||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let x=()=>this._finishRippleTransition(h),b=()=>this._destroyRipple(h);c.addEventListener("transitionend",x),c.addEventListener("transitioncancel",b),g={onTransitionEnd:x,onTransitionCancel:b}}),this._activeRipples.set(h,g),(m||!u)&&this._finishRippleTransition(h),h}fadeOutRipple(t){if(t.state===_d.FADING_OUT||t.state===_d.HIDDEN)return;let n=t.element,r=Ze(Ze({},Uwt),t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=_d.FADING_OUT,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){let n=yy(t);!this._platform.isBrowser||!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,Vwt.forEach(r=>{e5._eventManager.addHandler(this._ngZone,r,n,this)}))}handleEvent(t){t.type==="mousedown"?this._onMousedown(t):t.type==="touchstart"?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Wwt.forEach(n=>{this._triggerElement.addEventListener(n,this,jwt)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===_d.FADING_IN?this._startFadeOutTransition(t):t.state===_d.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){let n=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=_d.VISIBLE,!r&&(!n||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){let n=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=_d.HIDDEN,n!==null&&(t.element.removeEventListener("transitionend",n.onTransitionEnd),t.element.removeEventListener("transitioncancel",n.onTransitionCancel)),t.element.remove()}_onMousedown(t){let n=VSe(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+OFn;!this._target.rippleDisabled&&!n&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!WSe(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let n=t.changedTouches;if(n)for(let r=0;r<n.length;r++)this.fadeInRipple(n[r].clientX,n[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{let n=t.state===_d.VISIBLE||t.config.terminateOnPointerUp&&t.state===_d.FADING_IN;!t.config.persistent&&n&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let t=this._triggerElement;t&&(Vwt.forEach(n=>e5._eventManager.removeHandler(n,t,this)),this._pointerUpEventsRegistered&&(Wwt.forEach(n=>t.removeEventListener(n,this,jwt)),this._pointerUpEventsRegistered=!1))}};e5._eventManager=new KSe;var XSe=e5;function MFn(e,t,n){let r=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),i=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(r*r+i*i)}var Kwt=new kn("mat-ripple-global-options"),Xwt=(()=>{let t=class t{get disabled(){return this._disabled}set disabled(r){r&&this.fadeOutAllNonPersistent(),this._disabled=r,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(r){this._trigger=r,this._setupTriggerEventsIfEnabled()}constructor(r,i,o,s,a){this._elementRef=r,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new XSe(this,i,r,o)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Ze(Ze(Ze({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(r,i=0,o){return typeof r=="number"?this._rippleRenderer.fadeInRipple(r,i,Ze(Ze({},this.rippleConfig),o)):this._rippleRenderer.fadeInRipple(0,0,Ze(Ze({},this.rippleConfig),r))}};t.\u0275fac=function(i){return new(i||t)(Lt(Pr),Lt(vn),Lt(Di),Lt(Kwt,8),Lt(Sd,8))},t.\u0275dir=pa({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,o){i&2&&Kl("mat-ripple-unbounded",o.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0});let e=t;return e})(),t5=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[Zi,Zi]});let e=t;return e})();var $Fn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[Zi]});let e=t;return e})();var ZSe=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[t5,Zi,$Fn]});let e=t;return e})(),Gwt={capture:!0},qwt=["focus","mousedown","mouseenter","touchstart"],qSe="mat-ripple-loader-uninitialized",HSe="mat-ripple-loader-class-name",Hwt="mat-ripple-loader-centered",cee="mat-ripple-loader-disabled",Zwt=(()=>{let t=class t{constructor(){this._document=ut(dn,{optional:!0}),this._animationMode=ut(Sd,{optional:!0}),this._globalRippleOptions=ut(Kwt,{optional:!0}),this._platform=ut(Di),this._ngZone=ut(vn),this._hosts=new Map,this._onInteraction=r=>{let i=Cd(r);if(i instanceof HTMLElement){let o=i.closest(`[${qSe}="${this._globalRippleOptions?.namespace??""}"]`);o&&this._createRipple(o)}},this._ngZone.runOutsideAngular(()=>{for(let r of qwt)this._document?.addEventListener(r,this._onInteraction,Gwt)})}ngOnDestroy(){let r=this._hosts.keys();for(let i of r)this.destroyRipple(i);for(let i of qwt)this._document?.removeEventListener(i,this._onInteraction,Gwt)}configureRipple(r,i){r.setAttribute(qSe,this._globalRippleOptions?.namespace??""),(i.className||!r.hasAttribute(HSe))&&r.setAttribute(HSe,i.className||""),i.centered&&r.setAttribute(Hwt,""),i.disabled&&r.setAttribute(cee,"")}getRipple(r){return this._hosts.get(r)||this._createRipple(r)}setDisabled(r,i){let o=this._hosts.get(r);if(o){o.disabled=i;return}i?r.setAttribute(cee,""):r.removeAttribute(cee)}_createRipple(r){if(!this._document)return;let i=this._hosts.get(r);if(i)return i;r.querySelector(".mat-ripple")?.remove();let o=this._document.createElement("span");o.classList.add("mat-ripple",r.getAttribute(HSe)),r.append(o);let s=new Xwt(new Pr(o),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return s._isInitialized=!0,s.trigger=r,s.centered=r.hasAttribute(Hwt),s.disabled=r.hasAttribute(cee),this.attachRipple(r,s),s}attachRipple(r,i){r.removeAttribute(qSe),this._hosts.set(r,i)}destroyRipple(r){let i=this._hosts.get(r);i&&(i.ngOnDestroy(),this._hosts.delete(r))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var LFn=".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}";var BFn=["mat-icon-button",""],zFn=["*"];var UFn=new kn("MAT_BUTTON_CONFIG");var jFn=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],VFn=(()=>{let t=class t{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(r){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,r)}get disableRipple(){return this._disableRipple}set disableRipple(r){this._disableRipple=r,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(r){this._disabled=r,this._updateRippleDisabled()}constructor(r,i,o,s){this._elementRef=r,this._platform=i,this._ngZone=o,this._animationMode=s,this._focusMonitor=ut(uee),this._rippleLoader=ut(Zwt),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let a=ut(UFn,{optional:!0}),l=r.nativeElement,u=l.classList;this.disabledInteractive=a?.disabledInteractive??!1,this._rippleLoader?.configureRipple(l,{className:"mat-mdc-button-ripple"});for(let{attribute:c,mdcClasses:f}of jFn)l.hasAttribute(c)&&u.add(...f)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(r="program",i){r?this._focusMonitor.focusVia(this._elementRef.nativeElement,r,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};t.\u0275fac=function(i){wR()},t.\u0275dir=pa({type:t,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",oc],disabled:[2,"disabled","disabled",oc],ariaDisabled:[2,"aria-disabled","ariaDisabled",oc],disabledInteractive:[2,"disabledInteractive","disabledInteractive",oc]},features:[lf]});let e=t;return e})();var Qwt=(()=>{let t=class t extends VFn{constructor(r,i,o,s){super(r,i,o,s),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}};t.\u0275fac=function(i){return new(i||t)(Lt(Pr),Lt(Di),Lt(vn),Lt(Sd,8))},t.\u0275cmp=eo({type:t,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(i,o){i&2&&(uf("disabled",o._getDisabledAttribute())("aria-disabled",o._getAriaDisabled()),CR(o.color?"mat-"+o.color:""),Kl("mat-mdc-button-disabled",o.disabled)("mat-mdc-button-disabled-interactive",o.disabledInteractive)("_mat-animation-noopable",o._animationMode==="NoopAnimations")("mat-unthemed",!o.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[RA,to],attrs:BFn,ngContentSelectors:zFn,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,o){i&1&&(ic(),ma(0,"span",0),rl(1),ma(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{color:var(--mdc-icon-button-icon-color)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color)}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color)}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity)}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity)}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity)}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',LFn],encapsulation:2,changeDetection:0});let e=t;return e})();var Jwt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[Zi,t5,Zi]});let e=t;return e})();var GFn=20,n5=(()=>{let t=class t{constructor(r,i,o){this._ngZone=r,this._platform=i,this._scrolled=new qn,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=o}register(r){this.scrollContainers.has(r)||this.scrollContainers.set(r,r.elementScrolled().subscribe(()=>this._scrolled.next(r)))}deregister(r){let i=this.scrollContainers.get(r);i&&(i.unsubscribe(),this.scrollContainers.delete(r))}scrolled(r=GFn){return this._platform.isBrowser?new kA(i=>{this._globalSubscription||this._addGlobalListener();let o=r>0?this._scrolled.pipe(Tee(r)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Nt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((r,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(r,i){let o=this.getAncestorScrollContainers(r);return this.scrolled(i).pipe(go(s=>!s||o.indexOf(s)>-1))}getAncestorScrollContainers(r){let i=[];return this.scrollContainers.forEach((o,s)=>{this._scrollableContainsElement(s,r)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(r,i){let o=yy(i),s=r.getElementRef().nativeElement;do if(o==s)return!0;while(o=o.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let r=this._getWindow();return fR(r.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};t.\u0275fac=function(i){return new(i||t)(Oe(vn),Oe(Di),Oe(dn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),dee=(()=>{let t=class t{constructor(r,i,o,s){this.elementRef=r,this.scrollDispatcher=i,this.ngZone=o,this.dir=s,this._destroyed=new qn,this._elementScrolled=new kA(a=>this.ngZone.runOutsideAngular(()=>fR(this.elementRef.nativeElement,"scroll").pipe(Ji(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(r){let i=this.elementRef.nativeElement,o=this.dir&&this.dir.value=="rtl";r.left==null&&(r.left=o?r.end:r.start),r.right==null&&(r.right=o?r.start:r.end),r.bottom!=null&&(r.top=i.scrollHeight-i.clientHeight-r.bottom),o&&oR()!=ym.NORMAL?(r.left!=null&&(r.right=i.scrollWidth-i.clientWidth-r.left),oR()==ym.INVERTED?r.left=r.right:oR()==ym.NEGATED&&(r.left=r.right?-r.right:r.right)):r.right!=null&&(r.left=i.scrollWidth-i.clientWidth-r.right),this._applyScrollToOptions(r)}_applyScrollToOptions(r){let i=this.elementRef.nativeElement;see()?i.scrollTo(r):(r.top!=null&&(i.scrollTop=r.top),r.left!=null&&(i.scrollLeft=r.left))}measureScrollOffset(r){let i="left",o="right",s=this.elementRef.nativeElement;if(r=="top")return s.scrollTop;if(r=="bottom")return s.scrollHeight-s.clientHeight-s.scrollTop;let a=this.dir&&this.dir.value=="rtl";return r=="start"?r=a?o:i:r=="end"&&(r=a?i:o),a&&oR()==ym.INVERTED?r==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:a&&oR()==ym.NEGATED?r==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:r==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}};t.\u0275fac=function(i){return new(i||t)(Lt(Pr),Lt(n5),Lt(vn),Lt(lR,8))},t.\u0275dir=pa({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0});let e=t;return e})(),qFn=20,r5=(()=>{let t=class t{constructor(r,i,o){this._platform=r,this._change=new qn,this._changeListener=s=>{this._change.next(s)},this._document=o,i.runOutsideAngular(()=>{if(r.isBrowser){let s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let r=this._getWindow();r.removeEventListener("resize",this._changeListener),r.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let r={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),r}getViewportRect(){let r=this.getViewportScrollPosition(),{width:i,height:o}=this.getViewportSize();return{top:r.top,left:r.left,bottom:r.top+o,right:r.left+i,height:o,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let r=this._document,i=this._getWindow(),o=r.documentElement,s=o.getBoundingClientRect(),a=-s.top||r.body.scrollTop||i.scrollY||o.scrollTop||0,l=-s.left||r.body.scrollLeft||i.scrollX||o.scrollLeft||0;return{top:a,left:l}}change(r=qFn){return r>0?this._change.pipe(Tee(r)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let r=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:r.innerWidth,height:r.innerHeight}:{width:0,height:0}}};t.\u0275fac=function(i){return new(i||t)(Oe(Di),Oe(vn),Oe(dn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var vy=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({});let e=t;return e})(),QSe=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[iC,vy,iC,vy]});let e=t;return e})();var i5=class{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;t!=null&&(this._attachedHost=null,t.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},JSe=class extends i5{constructor(t,n,r,i,o){super(),this.component=t,this.viewContainerRef=n,this.injector=r,this.componentFactoryResolver=i,this.projectableNodes=o}},pee=class extends i5{constructor(t,n,r,i){super(),this.templateRef=t,this.viewContainerRef=n,this.context=r,this.injector=i}get origin(){return this.templateRef.elementRef}attach(t,n=this.context){return this.context=n,super.attach(t)}detach(){return this.context=void 0,super.detach()}},eEe=class extends i5{constructor(t){super(),this.element=t instanceof Pr?t.nativeElement:t}},tEe=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){if(t instanceof JSe)return this._attachedPortal=t,this.attachComponentPortal(t);if(t instanceof pee)return this._attachedPortal=t,this.attachTemplatePortal(t);if(this.attachDomPortal&&t instanceof eEe)return this._attachedPortal=t,this.attachDomPortal(t)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var mee=class extends tEe{constructor(t,n,r,i,o){super(),this.outletElement=t,this._componentFactoryResolver=n,this._appRef=r,this._defaultInjector=i,this.attachDomPortal=s=>{this._document;let a=s.element;a.parentNode;let l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=s,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=o}attachComponentPortal(t){let r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),i;return t.viewContainerRef?(i=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>i.destroy())):(i=r.create(t.injector||this._defaultInjector||nc.NULL),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=t,i}attachTemplatePortal(t){let n=t.viewContainerRef,r=n.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=n.indexOf(r);i!==-1&&n.remove(i)}),this._attachedPortal=t,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}};var tCt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({});let e=t;return e})();var nCt=see(),nEe=class{constructor(t,n){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=n}attach(){}enable(){if(this._canBeEnabled()){let t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=ho(-this._previousScrollPosition.left),t.style.top=ho(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let t=this._document.documentElement,n=this._document.body,r=t.style,i=n.style,o=r.scrollBehavior||"",s=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),nCt&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),nCt&&(r.scrollBehavior=o,i.scrollBehavior=s)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let n=this._document.body,r=this._viewportRuler.getViewportSize();return n.scrollHeight>r.height||n.scrollWidth>r.width}};var rEe=class{constructor(t,n,r,i){this._scrollDispatcher=t,this._ngZone=n,this._viewportRuler=r,this._config=i,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(this._scrollSubscription)return;let t=this._scrollDispatcher.scrolled(0).pipe(go(n=>!n||!this._overlayRef.overlayElement.contains(n.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{let n=this._viewportRuler.getViewportScrollPosition().top;Math.abs(n-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},hee=class{enable(){}disable(){}attach(){}};function iEe(e,t){return t.some(n=>{let r=e.bottom<n.top,i=e.top>n.bottom,o=e.right<n.left,s=e.left>n.right;return r||i||o||s})}function rCt(e,t){return t.some(n=>{let r=e.top<n.top,i=e.bottom>n.bottom,o=e.left<n.left,s=e.right>n.right;return r||i||o||s})}var oEe=class{constructor(t,n,r,i){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this._config=i,this._scrollSubscription=null}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(!this._scrollSubscription){let t=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(t).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let n=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();iEe(n,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},HFn=(()=>{let t=class t{constructor(r,i,o,s){this._scrollDispatcher=r,this._viewportRuler=i,this._ngZone=o,this.noop=()=>new hee,this.close=a=>new rEe(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new nEe(this._viewportRuler,this._document),this.reposition=a=>new oEe(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=s}};t.\u0275fac=function(i){return new(i||t)(Oe(n5),Oe(r5),Oe(vn),Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),gee=class{constructor(t){if(this.scrollStrategy=new hee,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){let n=Object.keys(t);for(let r of n)t[r]!==void 0&&(this[r]=t[r])}}};var sEe=class{constructor(t,n){this.connectionPair=t,this.scrollableViewProperties=n}};var lCt=(()=>{let t=class t{constructor(r){this._attachedOverlays=[],this._document=r}ngOnDestroy(){this.detach()}add(r){this.remove(r),this._attachedOverlays.push(r)}remove(r){let i=this._attachedOverlays.indexOf(r);i>-1&&this._attachedOverlays.splice(i,1),this._attachedOverlays.length===0&&this.detach()}};t.\u0275fac=function(i){return new(i||t)(Oe(dn))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),YFn=(()=>{let t=class t extends lCt{constructor(r,i){super(r),this._ngZone=i,this._keydownListener=o=>{let s=this._attachedOverlays;for(let a=s.length-1;a>-1;a--)if(s[a]._keydownEvents.observers.length>0){let l=s[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(o)):l.next(o);break}}}add(r){super.add(r),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}};t.\u0275fac=function(i){return new(i||t)(Oe(dn),Oe(vn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),KFn=(()=>{let t=class t extends lCt{constructor(r,i,o){super(r),this._platform=i,this._ngZone=o,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Cd(s)},this._clickListener=s=>{let a=Cd(s),l=s.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;let u=this._attachedOverlays.slice();for(let c=u.length-1;c>-1;c--){let f=u[c];if(f._outsidePointerEvents.observers.length<1||!f.hasAttached())continue;if(f.overlayElement.contains(a)||f.overlayElement.contains(l))break;let d=f._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(s)):d.next(s)}}}add(r){if(super.add(r),!this._isAttached){let i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let r=this._document.body;r.removeEventListener("pointerdown",this._pointerDownListener,!0),r.removeEventListener("click",this._clickListener,!0),r.removeEventListener("auxclick",this._clickListener,!0),r.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(r.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(r){r.addEventListener("pointerdown",this._pointerDownListener,!0),r.addEventListener("click",this._clickListener,!0),r.addEventListener("auxclick",this._clickListener,!0),r.addEventListener("contextmenu",this._clickListener,!0)}};t.\u0275fac=function(i){return new(i||t)(Oe(dn),Oe(Di),Oe(vn,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),uCt=(()=>{let t=class t{constructor(r,i){this._platform=i,this._document=r}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let r="cdk-overlay-container";if(this._platform.isBrowser||J4()){let o=this._document.querySelectorAll(`.${r}[platform="server"], .${r}[platform="test"]`);for(let s=0;s<o.length;s++)o[s].remove()}let i=this._document.createElement("div");i.classList.add(r),J4()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}};t.\u0275fac=function(i){return new(i||t)(Oe(dn),Oe(Di))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),aEe=class{constructor(t,n,r,i,o,s,a,l,u,c=!1,f){this._portalOutlet=t,this._host=n,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=s,this._document=a,this._location=l,this._outsideClickDispatcher=u,this._animationsDisabled=c,this._injector=f,this._backdropElement=null,this._backdropClick=new qn,this._attachments=new qn,this._detachments=new qn,this._locationChanges=v0.EMPTY,this._backdropClickHandler=d=>this._backdropClick.next(d),this._backdropTransitionendHandler=d=>{this._disposeBackdrop(d.target)},this._keydownEvents=new qn,this._outsidePointerEvents=new qn,this._renders=new qn,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy,this._afterRenderRef=GEe(()=>MEe(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let n=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),E0(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof n?.onDestroy=="function"&&n.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),n}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){let t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Ze(Ze({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Qi(Ze({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){let t=this._config.direction;return t?typeof t=="string"?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let t=this._pane.style;t.width=ho(this._config.width),t.height=ho(this._config.height),t.minWidth=ho(this._config.minWidth),t.minHeight=ho(this._config.minHeight),t.maxWidth=ho(this._config.maxWidth),t.maxHeight=ho(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){let t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t=this._backdropElement;if(t){if(this._animationsDisabled){this._disposeBackdrop(t);return}t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,n,r){let i=sR(n||[]).filter(o=>!!o);i.length&&(r?t.classList.add(...i):t.classList.remove(...i))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let t=this._renders.pipe(Ji(u5(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){let t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},iCt="cdk-overlay-connected-position-bounding-box",XFn=/([A-Za-z%]+)$/,lEe=class{get positions(){return this._preferredPositions}constructor(t,n,r,i,o){this._viewportRuler=n,this._document=r,this._platform=i,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new qn,this._resizeSubscription=v0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._overlayRef&&this._overlayRef,this._validatePositions(),t.hostElement.classList.add(iCt),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._originRect,n=this._overlayRect,r=this._viewportRect,i=this._containerRect,o=[],s;for(let a of this._preferredPositions){let l=this._getOriginPoint(t,i,a),u=this._getOverlayPoint(l,n,a),c=this._getOverlayFit(u,n,r,a);if(c.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,l);return}if(this._canFitWithFlexibleDimensions(c,u,r)){o.push({position:a,origin:l,overlayRect:n,boundingBoxRect:this._calculateBoundingBoxRect(l,a)});continue}(!s||s.overlayFit.visibleArea<c.visibleArea)&&(s={overlayFit:c,overlayPoint:u,originPoint:l,position:a,overlayRect:n})}if(o.length){let a=null,l=-1;for(let u of o){let c=u.boundingBoxRect.width*u.boundingBoxRect.height*(u.position.weight||1);c>l&&(l=c,a=u)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(s.position,s.originPoint);return}this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&TA(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(iCt),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let n=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,n)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,t.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,n,r){let i;if(r.originX=="center")i=t.left+t.width/2;else{let s=this._isRtl()?t.right:t.left,a=this._isRtl()?t.left:t.right;i=r.originX=="start"?s:a}n.left<0&&(i-=n.left);let o;return r.originY=="center"?o=t.top+t.height/2:o=r.originY=="top"?t.top:t.bottom,n.top<0&&(o-=n.top),{x:i,y:o}}_getOverlayPoint(t,n,r){let i;r.overlayX=="center"?i=-n.width/2:r.overlayX==="start"?i=this._isRtl()?-n.width:0:i=this._isRtl()?0:-n.width;let o;return r.overlayY=="center"?o=-n.height/2:o=r.overlayY=="top"?0:-n.height,{x:t.x+i,y:t.y+o}}_getOverlayFit(t,n,r,i){let o=sCt(n),{x:s,y:a}=t,l=this._getOffset(i,"x"),u=this._getOffset(i,"y");l&&(s+=l),u&&(a+=u);let c=0-s,f=s+o.width-r.width,d=0-a,p=a+o.height-r.height,m=this._subtractOverflows(o.width,c,f),h=this._subtractOverflows(o.height,d,p),g=m*h;return{visibleArea:g,isCompletelyWithinViewport:o.width*o.height===g,fitsInViewportVertically:h===o.height,fitsInViewportHorizontally:m==o.width}}_canFitWithFlexibleDimensions(t,n,r){if(this._hasFlexibleDimensions){let i=r.bottom-n.y,o=r.right-n.x,s=oCt(this._overlayRef.getConfig().minHeight),a=oCt(this._overlayRef.getConfig().minWidth),l=t.fitsInViewportVertically||s!=null&&s<=i,u=t.fitsInViewportHorizontally||a!=null&&a<=o;return l&&u}return!1}_pushOverlayOnScreen(t,n,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};let i=sCt(n),o=this._viewportRect,s=Math.max(t.x+i.width-o.width,0),a=Math.max(t.y+i.height-o.height,0),l=Math.max(o.top-r.top-t.y,0),u=Math.max(o.left-r.left-t.x,0),c=0,f=0;return i.width<=o.width?c=u||-s:c=t.x<this._viewportMargin?o.left-r.left-t.x:0,i.height<=o.height?f=l||-a:f=t.y<this._viewportMargin?o.top-r.top-t.y:0,this._previousPushAmount={x:c,y:f},{x:t.x+c,y:t.y+f}}_applyPosition(t,n){if(this._setTransformOrigin(t),this._setOverlayElementStyles(n,t),this._setBoundingBoxStyles(n,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){let r=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!ZFn(this._lastScrollVisibility,r)){let i=new sEe(t,r);this._positionChanges.next(i)}this._lastScrollVisibility=r}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;let n=this._boundingBox.querySelectorAll(this._transformOriginSelector),r,i=t.overlayY;t.overlayX==="center"?r="center":this._isRtl()?r=t.overlayX==="start"?"right":"left":r=t.overlayX==="start"?"left":"right";for(let o=0;o<n.length;o++)n[o].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(t,n){let r=this._viewportRect,i=this._isRtl(),o,s,a;if(n.overlayY==="top")s=t.y,o=r.height-s+this._viewportMargin;else if(n.overlayY==="bottom")a=r.height-t.y+this._viewportMargin*2,o=r.height-a+this._viewportMargin;else{let p=Math.min(r.bottom-t.y+r.top,t.y),m=this._lastBoundingBoxSize.height;o=p*2,s=t.y-p,o>m&&!this._isInitialRender&&!this._growAfterOpen&&(s=t.y-m/2)}let l=n.overlayX==="start"&&!i||n.overlayX==="end"&&i,u=n.overlayX==="end"&&!i||n.overlayX==="start"&&i,c,f,d;if(u)d=r.width-t.x+this._viewportMargin*2,c=t.x-this._viewportMargin;else if(l)f=t.x,c=r.right-t.x;else{let p=Math.min(r.right-t.x+r.left,t.x),m=this._lastBoundingBoxSize.width;c=p*2,f=t.x-p,c>m&&!this._isInitialRender&&!this._growAfterOpen&&(f=t.x-m/2)}return{top:s,left:f,bottom:a,right:d,width:c,height:o}}_setBoundingBoxStyles(t,n){let r=this._calculateBoundingBoxRect(t,n);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));let i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{let o=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;i.height=ho(r.height),i.top=ho(r.top),i.bottom=ho(r.bottom),i.width=ho(r.width),i.left=ho(r.left),i.right=ho(r.right),n.overlayX==="center"?i.alignItems="center":i.alignItems=n.overlayX==="end"?"flex-end":"flex-start",n.overlayY==="center"?i.justifyContent="center":i.justifyContent=n.overlayY==="bottom"?"flex-end":"flex-start",o&&(i.maxHeight=ho(o)),s&&(i.maxWidth=ho(s))}this._lastBoundingBoxSize=r,TA(this._boundingBox.style,i)}_resetBoundingBoxStyles(){TA(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){TA(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,n){let r={},i=this._hasExactPosition(),o=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(i){let c=this._viewportRuler.getViewportScrollPosition();TA(r,this._getExactOverlayY(n,t,c)),TA(r,this._getExactOverlayX(n,t,c))}else r.position="static";let a="",l=this._getOffset(n,"x"),u=this._getOffset(n,"y");l&&(a+=`translateX(${l}px) `),u&&(a+=`translateY(${u}px)`),r.transform=a.trim(),s.maxHeight&&(i?r.maxHeight=ho(s.maxHeight):o&&(r.maxHeight="")),s.maxWidth&&(i?r.maxWidth=ho(s.maxWidth):o&&(r.maxWidth="")),TA(this._pane.style,r)}_getExactOverlayY(t,n,r){let i={top:"",bottom:""},o=this._getOverlayPoint(n,this._overlayRect,t);if(this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),t.overlayY==="bottom"){let s=this._document.documentElement.clientHeight;i.bottom=`${s-(o.y+this._overlayRect.height)}px`}else i.top=ho(o.y);return i}_getExactOverlayX(t,n,r){let i={left:"",right:""},o=this._getOverlayPoint(n,this._overlayRect,t);this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r));let s;if(this._isRtl()?s=t.overlayX==="end"?"left":"right":s=t.overlayX==="end"?"right":"left",s==="right"){let a=this._document.documentElement.clientWidth;i.right=`${a-(o.x+this._overlayRect.width)}px`}else i.left=ho(o.x);return i}_getScrollVisibility(){let t=this._getOriginRect(),n=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:rCt(t,r),isOriginOutsideView:iEe(t,r),isOverlayClipped:rCt(n,r),isOverlayOutsideView:iEe(n,r)}}_subtractOverflows(t,...n){return n.reduce((r,i)=>r-Math.max(i,0),t)}_getNarrowedViewportRect(){let t=this._document.documentElement.clientWidth,n=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+t-this._viewportMargin,bottom:r.top+n-this._viewportMargin,width:t-2*this._viewportMargin,height:n-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,n){return n==="x"?t.offsetX==null?this._offsetX:t.offsetX:t.offsetY==null?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&sR(t).forEach(n=>{n!==""&&this._appliedPanelClasses.indexOf(n)===-1&&(this._appliedPanelClasses.push(n),this._pane.classList.add(n))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){let t=this._origin;if(t instanceof Pr)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();let n=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+n,height:r,width:n}}};function TA(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function oCt(e){if(typeof e!="number"&&e!=null){let[t,n]=e.split(XFn);return!n||n==="px"?parseFloat(t):null}return e||null}function sCt(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}function ZFn(e,t){return e===t?!0:e.isOriginClipped===t.isOriginClipped&&e.isOriginOutsideView===t.isOriginOutsideView&&e.isOverlayClipped===t.isOverlayClipped&&e.isOverlayOutsideView===t.isOverlayOutsideView}var aCt="cdk-global-overlay-wrapper",uEe=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){let n=t.getConfig();this._overlayRef=t,this._width&&!n.width&&t.updateSize({width:this._width}),this._height&&!n.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(aCt),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let t=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:o,maxWidth:s,maxHeight:a}=r,l=(i==="100%"||i==="100vw")&&(!s||s==="100%"||s==="100vw"),u=(o==="100%"||o==="100vh")&&(!a||a==="100%"||a==="100vh"),c=this._xPosition,f=this._xOffset,d=this._overlayRef.getConfig().direction==="rtl",p="",m="",h="";l?h="flex-start":c==="center"?(h="center",d?m=f:p=f):d?c==="left"||c==="end"?(h="flex-end",p=f):(c==="right"||c==="start")&&(h="flex-start",m=f):c==="left"||c==="start"?(h="flex-start",p=f):(c==="right"||c==="end")&&(h="flex-end",m=f),t.position=this._cssPosition,t.marginLeft=l?"0":p,t.marginTop=u?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=l?"0":m,n.justifyContent=h,n.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let t=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement,r=n.style;n.classList.remove(aCt),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}},QFn=(()=>{let t=class t{constructor(r,i,o,s){this._viewportRuler=r,this._document=i,this._platform=o,this._overlayContainer=s}global(){return new uEe}flexibleConnectedTo(r){return new lEe(r,this._viewportRuler,this._document,this._platform,this._overlayContainer)}};t.\u0275fac=function(i){return new(i||t)(Oe(r5),Oe(dn),Oe(Di),Oe(uCt))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})(),JFn=0,wy=(()=>{let t=class t{constructor(r,i,o,s,a,l,u,c,f,d,p,m){this.scrollStrategies=r,this._overlayContainer=i,this._componentFactoryResolver=o,this._positionBuilder=s,this._keyboardDispatcher=a,this._injector=l,this._ngZone=u,this._document=c,this._directionality=f,this._location=d,this._outsideClickDispatcher=p,this._animationsModuleType=m}create(r){let i=this._createHostElement(),o=this._createPaneElement(i),s=this._createPortalOutlet(o),a=new gee(r);return a.direction=a.direction||this._directionality.value,new aEe(s,i,o,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(lC))}position(){return this._positionBuilder}_createPaneElement(r){let i=this._document.createElement("div");return i.id=`cdk-overlay-${JFn++}`,i.classList.add("cdk-overlay-pane"),r.appendChild(i),i}_createHostElement(){let r=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(r),r}_createPortalOutlet(r){return this._appRef||(this._appRef=this._injector.get(MA)),new mee(r,this._componentFactoryResolver,this._appRef,this._injector,this._document)}};t.\u0275fac=function(i){return new(i||t)(Oe(HFn),Oe(uCt),Oe(p5),Oe(QFn),Oe(YFn),Oe(nc),Oe(vn),Oe(dn),Oe(lR),Oe($A),Oe(KFn),Oe(Sd,8))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var eRn=new kn("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let e=ut(wy);return()=>e.scrollStrategies.reposition()}});function tRn(e){return()=>e.scrollStrategies.reposition()}var nRn={provide:eRn,deps:[wy],useFactory:tRn},xee=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({providers:[wy,nRn],imports:[iC,tCt,QSe,QSe]});let e=t;return e})();var bee=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[Zi,I0,kwt,Zi]});let e=t;return e})();var oRn=new kn("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let e=ut(wy);return()=>e.scrollStrategies.reposition()}});function sRn(e){return()=>e.scrollStrategies.reposition()}var aRn={provide:oRn,deps:[wy],useFactory:sRn};var cCt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({providers:[aRn],imports:[I0,xee,ZSe,Zi,vy,bee,ZSe,Zi]});let e=t;return e})();var fCt=["*"],uRn=["content"],cRn=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],fRn=["mat-drawer","mat-drawer-content","*"];function dRn(e,t){if(e&1){let n=k0();xo(0,"div",1),cf("click",function(){_0(n);let i=wm();return S0(i._onBackdropClicked())}),jo()}if(e&2){let n=wm();Kl("mat-drawer-shown",n._isShowingBackdrop())}}function pRn(e,t){e&1&&(xo(0,"mat-drawer-content"),rl(1,2),jo())}var mRn={transformDrawer:_R("transform",[PA("open, open-instant",D0({transform:"none",visibility:"visible"})),PA("void",D0({"box-shadow":"none",visibility:"hidden"})),mC("void => open-instant",pC("0ms")),mC("void <=> open, open-instant => void",pC("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])};var hRn=new kn("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:gRn}),dCt=new kn("MAT_DRAWER_CONTAINER");function gRn(){return!1}var o5=(()=>{let t=class t extends dee{constructor(r,i,o,s,a){super(o,s,a),this._changeDetectorRef=r,this._container=i}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}};t.\u0275fac=function(i){return new(i||t)(Lt(df),Lt(yEe(()=>fEe)),Lt(Pr),Lt(n5),Lt(vn))},t.\u0275cmp=eo({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(i,o){i&2&&Nee("margin-left",o._container._contentMargins.left,"px")("margin-right",o._container._contentMargins.right,"px")},standalone:!0,features:[Cm([{provide:dee,useExisting:t}]),RA,to],ngContentSelectors:fCt,decls:1,vars:0,template:function(i,o){i&1&&(ic(),rl(0))},encapsulation:2,changeDetection:0});let e=t;return e})(),cEe=(()=>{let t=class t{get position(){return this._position}set position(r){r=r==="end"?"end":"start",r!==this._position&&(this._isAttached&&this._updatePositionInParent(r),this._position=r,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(r){this._mode=r,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(r){this._disableClose=SA(r)}get autoFocus(){let r=this._autoFocus;return r??(this.mode==="side"?"dialog":"first-tabbable")}set autoFocus(r){(r==="true"||r==="false"||r==null)&&(r=SA(r)),this._autoFocus=r}get opened(){return this._opened}set opened(r){this.toggle(SA(r))}constructor(r,i,o,s,a,l,u,c){this._elementRef=r,this._focusTrapFactory=i,this._focusMonitor=o,this._platform=s,this._ngZone=a,this._interactivityChecker=l,this._doc=u,this._container=c,this._focusTrap=null,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new qn,this._animationEnd=new qn,this._animationState="void",this.openedChange=new Uo(!0),this._openedStream=this.openedChange.pipe(go(f=>f),on(()=>{})),this.openedStart=this._animationStarted.pipe(go(f=>f.fromState!==f.toState&&f.toState.indexOf("open")===0),pR(void 0)),this._closedStream=this.openedChange.pipe(go(f=>!f),on(()=>{})),this.closedStart=this._animationStarted.pipe(go(f=>f.fromState!==f.toState&&f.toState==="void"),pR(void 0)),this._destroyed=new qn,this.onPositionChanged=new Uo,this._modeChanged=new qn,this._injector=ut(nc),this.openedChange.pipe(Ji(this._destroyed)).subscribe(f=>{f?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{fR(this._elementRef.nativeElement,"keydown").pipe(go(f=>f.keyCode===27&&!this.disableClose&&!Twt(f)),Ji(this._destroyed)).subscribe(f=>this._ngZone.run(()=>{this.close(),f.stopPropagation(),f.preventDefault()}))}),this._animationEnd.pipe(w0((f,d)=>f.fromState===d.fromState&&f.toState===d.toState)).subscribe(f=>{let{fromState:d,toState:p}=f;(p.indexOf("open")===0&&d==="void"||p==="void"&&d.indexOf("open")===0)&&this.openedChange.emit(this._opened)})}_forceFocus(r,i){this._interactivityChecker.isFocusable(r)||(r.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let o=()=>{r.removeEventListener("blur",o),r.removeEventListener("mousedown",o),r.removeAttribute("tabindex")};r.addEventListener("blur",o),r.addEventListener("mousedown",o)})),r.focus(i)}_focusByCssSelector(r,i){let o=this._elementRef.nativeElement.querySelector(r);o&&this._forceFocus(o,i)}_takeFocus(){if(!this._focusTrap)return;let r=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":E0(()=>{!this._focusTrap.focusInitialElement()&&typeof r.focus=="function"&&r.focus()},{injector:this._injector});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus);break}}_restoreFocus(r){this.autoFocus!=="dialog"&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,r):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){let r=this._doc.activeElement;return!!r&&this._elementRef.nativeElement.contains(r)}ngAfterViewInit(){this._isAttached=!0,this._position==="end"&&this._updatePositionInParent("end"),this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState())}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap?.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(r){return this.toggle(!0,r)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(r=!this.opened,i){r&&i&&(this._openedVia=i);let o=this._setOpen(r,!r&&this._isFocusWithinDrawer(),this._openedVia||"program");return r||(this._openedVia=null),o}_setOpen(r,i,o){return this._opened=r,r?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",i&&this._restoreFocus(o)),this._updateFocusTrapState(),new Promise(s=>{this.openedChange.pipe(Yl(1)).subscribe(a=>s(a?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop)}_updatePositionInParent(r){if(!this._platform.isBrowser)return;let i=this._elementRef.nativeElement,o=i.parentNode;r==="end"?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),o.insertBefore(this._anchor,i)),o.appendChild(i)):this._anchor&&this._anchor.parentNode.insertBefore(i,this._anchor)}};t.\u0275fac=function(i){return new(i||t)(Lt(Pr),Lt($wt),Lt(uee),Lt(Di),Lt(vn),Lt(jSe),Lt(dn,8),Lt(dCt,8))},t.\u0275cmp=eo({type:t,selectors:[["mat-drawer"]],viewQuery:function(i,o){if(i&1&&ff(uRn,5),i&2){let s;il(s=ol())&&(o._content=s.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(i,o){i&1&&zEe("@transform.start",function(a){return o._animationStarted.next(a)})("@transform.done",function(a){return o._animationEnd.next(a)}),i&2&&(BEe("@transform",o._animationState),uf("align",null),Kl("mat-drawer-end",o.position==="end")("mat-drawer-over",o.mode==="over")("mat-drawer-push",o.mode==="push")("mat-drawer-side",o.mode==="side")("mat-drawer-opened",o.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],standalone:!0,features:[to],ngContentSelectors:fCt,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(i,o){i&1&&(ic(),xo(0,"div",1,0),rl(2),jo())},dependencies:[dee],encapsulation:2,data:{animation:[mRn.transformDrawer]},changeDetection:0});let e=t;return e})(),fEe=(()=>{let t=class t{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(r){this._autosize=SA(r)}get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(r){this._backdropOverride=r==null?null:SA(r)}get scrollable(){return this._userContent||this._content}constructor(r,i,o,s,a,l=!1,u){this._dir=r,this._element=i,this._ngZone=o,this._changeDetectorRef=s,this._animationMode=u,this._drawers=new f5,this.backdropClick=new Uo,this._destroyed=new qn,this._doCheckSubject=new qn,this._contentMargins={left:null,right:null},this._contentMarginChanges=new qn,this._injector=ut(nc),r&&r.change.pipe(Ji(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),a.change().pipe(Ji(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=l}ngAfterContentInit(){this._allDrawers.changes.pipe(Iy(this._allDrawers),Ji(this._destroyed)).subscribe(r=>{this._drawers.reset(r.filter(i=>!i._container||i._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Iy(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(r=>{this._watchDrawerToggle(r),this._watchDrawerPosition(r),this._watchDrawerMode(r)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(dR(10),Ji(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(r=>r.open())}close(){this._drawers.forEach(r=>r.close())}updateContentMargins(){let r=0,i=0;if(this._left&&this._left.opened){if(this._left.mode=="side")r+=this._left._getWidth();else if(this._left.mode=="push"){let o=this._left._getWidth();r+=o,i-=o}}if(this._right&&this._right.opened){if(this._right.mode=="side")i+=this._right._getWidth();else if(this._right.mode=="push"){let o=this._right._getWidth();i+=o,r-=o}}r=r||null,i=i||null,(r!==this._contentMargins.left||i!==this._contentMargins.right)&&(this._contentMargins={left:r,right:i},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(r){r._animationStarted.pipe(go(i=>i.fromState!==i.toState),Ji(this._drawers.changes)).subscribe(i=>{i.toState!=="open-instant"&&this._animationMode!=="NoopAnimations"&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),r.mode!=="side"&&r.openedChange.pipe(Ji(this._drawers.changes)).subscribe(()=>this._setContainerClass(r.opened))}_watchDrawerPosition(r){r&&r.onPositionChanged.pipe(Ji(this._drawers.changes)).subscribe(()=>{E0(()=>{this._validateDrawers()},{injector:this._injector,phase:OEe.Read})})}_watchDrawerMode(r){r&&r._modeChanged.pipe(Ji(u5(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(r){let i=this._element.nativeElement.classList,o="mat-drawer-container-has-open";r?i.add(o):i.remove(o)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(r=>{r.position=="end"?(this._end!=null,this._end=r):(this._start!=null,this._start=r)}),this._right=this._left=null,this._dir&&this._dir.value==="rtl"?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&this._start.mode!="over"||this._isDrawerOpen(this._end)&&this._end.mode!="over"}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(r=>r&&!r.disableClose&&this._drawerHasBackdrop(r)).forEach(r=>r._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(r){return r!=null&&r.opened}_drawerHasBackdrop(r){return this._backdropOverride==null?!!r&&r.mode!=="side":this._backdropOverride}};t.\u0275fac=function(i){return new(i||t)(Lt(lR,8),Lt(Pr),Lt(vn),Lt(df),Lt(r5),Lt(hRn),Lt(Sd,8))},t.\u0275cmp=eo({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(i,o,s){if(i&1&&(dC(s,o5,5),dC(s,cEe,5)),i&2){let a;il(a=ol())&&(o._content=a.first),il(a=ol())&&(o._allDrawers=a)}},viewQuery:function(i,o){if(i&1&&ff(o5,5),i&2){let s;il(s=ol())&&(o._userContent=s.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(i,o){i&2&&Kl("mat-drawer-container-explicit-backdrop",o._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],standalone:!0,features:[Cm([{provide:dCt,useExisting:t}]),to],ngContentSelectors:fRn,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(i,o){i&1&&(ic(cRn),A0(0,dRn,1,2,"div",0),rl(1),rl(2,1),A0(3,pRn,2,0,"mat-drawer-content")),i&2&&(fC(o.hasBackdrop?0:-1),Ed(3),fC(o._content?-1:3))},dependencies:[o5],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color);box-shadow:var(--mat-sidenav-container-elevation-shadow);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);width:var(--mat-sidenav-container-width);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0});let e=t;return e})();var pCt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[Zi,vy,vy,Zi]});let e=t;return e})();var bRn=["*"],yee;function yRn(){if(yee===void 0&&(yee=null,typeof window<"u")){let e=window;e.trustedTypes!==void 0&&(yee=e.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return yee}function s5(e){return yRn()?.createHTML(e)||e}function mCt(e){return Error(`Unable to find icon with the name "${e}"`)}function vRn(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function hCt(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function gCt(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}var Cy=class{constructor(t,n,r){this.url=t,this.svgText=n,this.options=r}},wRn=(()=>{let t=class t{constructor(r,i,o,s){this._httpClient=r,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=o}addSvgIcon(r,i,o){return this.addSvgIconInNamespace("",r,i,o)}addSvgIconLiteral(r,i,o){return this.addSvgIconLiteralInNamespace("",r,i,o)}addSvgIconInNamespace(r,i,o,s){return this._addSvgIconConfig(r,i,new Cy(o,null,s))}addSvgIconResolver(r){return this._resolvers.push(r),this}addSvgIconLiteralInNamespace(r,i,o,s){let a=this._sanitizer.sanitize(rc.HTML,o);if(!a)throw gCt(o);let l=s5(a);return this._addSvgIconConfig(r,i,new Cy("",l,s))}addSvgIconSet(r,i){return this.addSvgIconSetInNamespace("",r,i)}addSvgIconSetLiteral(r,i){return this.addSvgIconSetLiteralInNamespace("",r,i)}addSvgIconSetInNamespace(r,i,o){return this._addSvgIconSetConfig(r,new Cy(i,null,o))}addSvgIconSetLiteralInNamespace(r,i,o){let s=this._sanitizer.sanitize(rc.HTML,i);if(!s)throw gCt(i);let a=s5(s);return this._addSvgIconSetConfig(r,new Cy("",a,o))}registerFontClassAlias(r,i=r){return this._fontCssClassesByAlias.set(r,i),this}classNameForFontAlias(r){return this._fontCssClassesByAlias.get(r)||r}setDefaultFontSetClass(...r){return this._defaultFontSetClass=r,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(r){let i=this._sanitizer.sanitize(rc.RESOURCE_URL,r);if(!i)throw hCt(r);let o=this._cachedIconsByUrl.get(i);return o?Nt(vee(o)):this._loadSvgIconFromConfig(new Cy(r,null)).pipe(xi(s=>this._cachedIconsByUrl.set(i,s)),on(s=>vee(s)))}getNamedSvgIcon(r,i=""){let o=xCt(i,r),s=this._svgIconConfigs.get(o);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,r),s)return this._svgIconConfigs.set(o,s),this._getSvgFromConfig(s);let a=this._iconSetConfigs.get(i);return a?this._getSvgFromIconSetConfigs(r,a):oC(mCt(o))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(r){return r.svgText?Nt(vee(this._svgElementFromConfig(r))):this._loadSvgIconFromConfig(r).pipe(on(i=>vee(i)))}_getSvgFromIconSetConfigs(r,i){let o=this._extractIconWithNameFromAnySet(r,i);if(o)return Nt(o);let s=i.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(Ty(l=>{let c=`Loading icon set URL: ${this._sanitizer.sanitize(rc.RESOURCE_URL,a.url)} failed: ${l.message}`;return this._errorHandler.handleError(new Error(c)),Nt(null)})));return hEe(s).pipe(on(()=>{let a=this._extractIconWithNameFromAnySet(r,i);if(!a)throw mCt(r);return a}))}_extractIconWithNameFromAnySet(r,i){for(let o=i.length-1;o>=0;o--){let s=i[o];if(s.svgText&&s.svgText.toString().indexOf(r)>-1){let a=this._svgElementFromConfig(s),l=this._extractSvgIconFromSet(a,r,s.options);if(l)return l}}return null}_loadSvgIconFromConfig(r){return this._fetchIcon(r).pipe(xi(i=>r.svgText=i),on(()=>this._svgElementFromConfig(r)))}_loadSvgIconSetFromConfig(r){return r.svgText?Nt(null):this._fetchIcon(r).pipe(xi(i=>r.svgText=i))}_extractSvgIconFromSet(r,i,o){let s=r.querySelector(`[id="${i}"]`);if(!s)return null;let a=s.cloneNode(!0);if(a.removeAttribute("id"),a.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(a,o);if(a.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(a),o);let l=this._svgElementFromString(s5("<svg></svg>"));return l.appendChild(a),this._setSvgAttributes(l,o)}_svgElementFromString(r){let i=this._document.createElement("DIV");i.innerHTML=r;let o=i.querySelector("svg");if(!o)throw Error("<svg> tag not found");return o}_toSvgElement(r){let i=this._svgElementFromString(s5("<svg></svg>")),o=r.attributes;for(let s=0;s<o.length;s++){let{name:a,value:l}=o[s];a!=="id"&&i.setAttribute(a,l)}for(let s=0;s<r.childNodes.length;s++)r.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(r.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(r,i){return r.setAttribute("fit",""),r.setAttribute("height","100%"),r.setAttribute("width","100%"),r.setAttribute("preserveAspectRatio","xMidYMid meet"),r.setAttribute("focusable","false"),i&&i.viewBox&&r.setAttribute("viewBox",i.viewBox),r}_fetchIcon(r){let{url:i,options:o}=r,s=o?.withCredentials??!1;if(!this._httpClient)throw vRn();if(i==null)throw Error(`Cannot fetch icon from URL "${i}".`);let a=this._sanitizer.sanitize(rc.RESOURCE_URL,i);if(!a)throw hCt(i);let l=this._inProgressUrlFetches.get(a);if(l)return l;let u=this._httpClient.get(a,{responseType:"text",withCredentials:s}).pipe(on(c=>s5(c)),aC(()=>this._inProgressUrlFetches.delete(a)),bEe());return this._inProgressUrlFetches.set(a,u),u}_addSvgIconConfig(r,i,o){return this._svgIconConfigs.set(xCt(r,i),o),this}_addSvgIconSetConfig(r,i){let o=this._iconSetConfigs.get(r);return o?o.push(i):this._iconSetConfigs.set(r,[i]),this}_svgElementFromConfig(r){if(!r.svgElement){let i=this._svgElementFromString(r.svgText);this._setSvgAttributes(i,r.options),r.svgElement=i}return r.svgElement}_getIconConfigFromResolvers(r,i){for(let o=0;o<this._resolvers.length;o++){let s=this._resolvers[o](i,r);if(s)return CRn(s)?new Cy(s.url,null,s.options):new Cy(s,null)}}};t.\u0275fac=function(i){return new(i||t)(Oe(i2e,8),Oe(Yee),Oe(dn,8),Oe(uC))},t.\u0275prov=Ct({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function vee(e){return e.cloneNode(!0)}function xCt(e,t){return e+":"+t}function CRn(e){return!!(e.url&&e.options)}var _Rn=new kn("MAT_ICON_DEFAULT_OPTIONS"),SRn=new kn("mat-icon-location",{providedIn:"root",factory:ERn});function ERn(){let e=ut(dn),t=e?e.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}var bCt=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],ARn=bCt.map(e=>`[${e}]`).join(", "),TRn=/^url\(['"]?#(.*?)['"]?\)$/,yCt=(()=>{let t=class t{get color(){return this._color||this._defaultColor}set color(r){this._color=r}get svgIcon(){return this._svgIcon}set svgIcon(r){r!==this._svgIcon&&(r?this._updateSvgIcon(r):this._svgIcon&&this._clearSvgElement(),this._svgIcon=r)}get fontSet(){return this._fontSet}set fontSet(r){let i=this._cleanupFontValue(r);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(r){let i=this._cleanupFontValue(r);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(r,i,o,s,a,l){this._elementRef=r,this._iconRegistry=i,this._location=s,this._errorHandler=a,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=v0.EMPTY,l&&(l.color&&(this.color=this._defaultColor=l.color),l.fontSet&&(this.fontSet=l.fontSet)),o||r.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(r){if(!r)return["",""];let i=r.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${r}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let r=this._elementsWithExternalReferences;if(r&&r.size){let i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(r){this._clearSvgElement();let i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(r),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(r)}_clearSvgElement(){let r=this._elementRef.nativeElement,i=r.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){let o=r.childNodes[i];(o.nodeType!==1||o.nodeName.toLowerCase()==="svg")&&o.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let r=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(o=>o.length>0);this._previousFontSetClass.forEach(o=>r.classList.remove(o)),i.forEach(o=>r.classList.add(o)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&r.classList.remove(this._previousFontIconClass),this.fontIcon&&r.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(r){return typeof r=="string"?r.trim().split(" ")[0]:r}_prependPathToReferences(r){let i=this._elementsWithExternalReferences;i&&i.forEach((o,s)=>{o.forEach(a=>{s.setAttribute(a.name,`url('${r}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(r){let i=r.querySelectorAll(ARn),o=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)bCt.forEach(a=>{let l=i[s],u=l.getAttribute(a),c=u?u.match(TRn):null;if(c){let f=o.get(l);f||(f=[],o.set(l,f)),f.push({name:a,value:c[1]})}})}_updateSvgIcon(r){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),r){let[i,o]=this._splitIconName(r);i&&(this._svgNamespace=i),o&&(this._svgName=o),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(o,i).pipe(Yl(1)).subscribe(s=>this._setSvgElement(s),s=>{let a=`Error retrieving icon ${i}:${o}! ${s.message}`;this._errorHandler.handleError(new Error(a))})}}};t.\u0275fac=function(i){return new(i||t)(Lt(Pr),Lt(wRn),bR("aria-hidden"),Lt(SRn),Lt(uC),Lt(_Rn,8))},t.\u0275cmp=eo({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(i,o){i&2&&(uf("data-mat-icon-type",o._usingFontIcon()?"font":"svg")("data-mat-icon-name",o._svgName||o.fontIcon)("data-mat-icon-namespace",o._svgNamespace||o.fontSet)("fontIcon",o._usingFontIcon()?o.fontIcon:null),CR(o.color?"mat-"+o.color:""),Kl("mat-icon-inline",o.inline)("mat-icon-no-color",o.color!=="primary"&&o.color!=="accent"&&o.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",oc],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[lf,to],ngContentSelectors:bRn,decls:1,vars:0,template:function(i,o){i&1&&(ic(),rl(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0});let e=t;return e})(),vCt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({imports:[Zi,Zi]});let e=t;return e})();var wCt={transformMenu:_R("transformMenu",[PA("void",D0({opacity:0,transform:"scale(0.8)"})),mC("void => enter",pC("120ms cubic-bezier(0, 0, 0.2, 1)",D0({opacity:1,transform:"scale(1)"}))),mC("* => void",pC("100ms 25ms linear",D0({opacity:0})))]),fadeInItems:_R("fadeInItems",[PA("showing",D0({opacity:1})),mC("void => *",[D0({opacity:0}),pC("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},V1o=wCt.fadeInItems,W1o=wCt.transformMenu;var IRn=new kn("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{let e=ut(wy);return()=>e.scrollStrategies.reposition()}});function DRn(e){return()=>e.scrollStrategies.reposition()}var NRn={provide:IRn,deps:[wy],useFactory:DRn};var CCt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Nn({type:t}),t.\u0275inj=Dn({providers:[NRn],imports:[I0,t5,Zi,xee,vy,Zi]});let e=t;return e})();var _Ct=(()=>{let t=class t{constructor(){this.title="victorbarbosa"}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=eo({type:t,selectors:[["app-root"]],standalone:!0,features:[to],decls:11,vars:1,consts:[["drawer",""],[1,"example-container"],[3,"mode"],[1,"top-bar"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"click"]],template:function(i,o){if(i&1){let s=k0();xo(0,"mat-drawer-container",1)(1,"mat-drawer",2,0),OA(3,"I'm a drawer"),jo(),xo(4,"mat-drawer-content")(5,"div",3)(6,"button",4),cf("click",function(){_0(s);let l=h5(2);return S0(l.toggle())}),xo(7,"mat-icon"),OA(8,"more_vert"),jo()()(),xo(9,"div"),ma(10,"router-outlet"),jo()()()}i&2&&(Ed(),T0("mode","over"))},dependencies:[kte,pCt,cEe,fEe,o5,bee,cCt,Jwt,Qwt,CCt,vCt,yCt],styles:['.top-bar[_ngcontent-%COMP%]{float:right;width:100%;display:flex;align-items:flex-end;justify-content:flex-end;position:fixed;background:#000}.top-bar[_ngcontent-%COMP%]:after{content:"";background:#fff;position:absolute;width:100vw;height:1px}mat-drawer-content[_ngcontent-%COMP%]{height:100vh}']});let e=t;return e})();p2e(_Ct,Ewt).catch(e=>console.error(e));
